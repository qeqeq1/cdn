"use strict";var messagePort=null,portMessageHandlerFuncs=[],isDebug=!1,isDebugFrame=!1,isDebugPopout="?popout"===window.location.search,xfreleaseNum=0,debugWindowData={xfreleaseNum:10400,isDebug:!0,type:"boot"},iframeData={xfreleaseNum:10400,isDebug:!0,isDebugFrame:!0,port:(new MessageChannel).port1,type:"boot-debug-frame"};function OnBootMessage(t){var e=t.data,i=e.type;if("messageport-init"===i)OnMessagePortInit(e);else if("boot"===i||"boot-debug-frame"===i)OnBoot(e);else if("register-sw"===i)OnRegisterSW();else console.warn("Unexpected message type '"+i+"'")}function OnMessagePortInit(t){if(!messagePort)(messagePort=t.port).onmessage=OnMessageFromPort,messagePort.postMessage({type:"messageport-received"})}function OnBoot(t){if(t.port&&!messagePort)(messagePort=t.port).onmessage=OnMessageFromPort;if(isDebug=!!t.isDebug,isDebugFrame=!!t.isDebugFrame,window.xf_isDebugFrame=isDebugFrame,xfreleaseNum=t.xfreleaseNum,isDebug)t.port=null,window.xf_debugBootMessage=t;if(window.initDebugger)window.initDebugger();var e="ready";if(isDebugFrame)e="boot-debug-ready";else if(isDebugPopout)e="debug-popout-ready";window.xf_postToMessagePort({type:e})}function OnMessageFromPort(t){if(portMessageHandlerFuncs.length)for(var e=0;e<portMessageHandlerFuncs.length;e++){(0,portMessageHandlerFuncs[e])(t.data)}else console.warn("[Preview] No message handler functions for port message: ",t.data)}function OnRegisterSW(){}function OnReady(){var t=window.opener||window.parent;if(t&&t!==window)t.postMessage({type:"boot-ready"},"*");var e=location.pathname;if(-1<e.indexOf("debug.html")||-1<e.indexOf("debugTest.html"))OnBoot(debugWindowData)}if(window.addEventListener("message",OnBootMessage),window.xf_addPortMessageHandler=function(t){portMessageHandlerFuncs.push(t)},window.xf_postToMessagePort=function(t){if(messagePort)messagePort.postMessage(t);else console.warn("[Preview] No message port to post data down: ",t)},"loading"===document.readyState)document.addEventListener("DOMContentLoaded",OnReady);else OnReady();function _slicedToArray(t,e){return _arrayWithHoles(t)||_iterableToArrayLimit(t,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(t,e){var i=[],n=!0,r=!1,o=void 0;try{for(var s,a=t[Symbol.iterator]();!(n=(s=a.next()).done)&&(i.push(s.value),!e||i.length!==e);n=!0);}catch(t){r=!0,o=t}finally{try{if(!n&&null!=a.return)a.return()}finally{if(r)throw o}}return i}function _arrayWithHoles(t){if(Array.isArray(t))return t}var ife=!0,m=[],n=[],o=[],p="",q=!1,r=!1,s=!!window.xf_isDebugFrame;function postPreviewWindow(t){window.xf_postToMessagePort(t)}function b(t){r||(postPreviewWindow({from:"runtime",type:"closed",screenX:window.screenX,screenY:window.screenY}),t&&window.nw.Window.get().close(!0))}function c(n){return new Promise(function(t,e){var i=document.createElement("script");i.onload=t,i.onerror=e,i.async=!1,i.src=n,document.head.appendChild(i)})}function d(n){return new Promise(function(t,e){var i=document.createElement("link");i.onload=t,i.onerror=e,i.rel="stylesheet",i.href=n,document.head.appendChild(i)})}function e(t){if(p=t.runtime,(q=t.useWorker)&&"undefined"==typeof OffscreenCanvas&&(console.log("Ignored setting to use worker since OffscreenCanvas is not supported"),q=!1),document.title=t.title,ife=!!t.ife,"c3"===p&&(document.title+=" (C3 runtime)"+(q?" [worker]":"")),document.body.style.backgroundColor=t.backgroundColor,document.documentElement.style.backgroundColor=t.backgroundColor,t.icon){var e=document.createElement("link");e.rel="icon",e.type="image/png",e.href=URL.createObjectURL(t.icon),document.head.appendChild(e)}}function f(t){var e=t.projectFiles;window.cr_previewProjectFileBlobs=e;for(var i={},n=Object.entries(e),r=0;r<n.length;r++){var o=_slicedToArray(n[r],2),s=o[0],a=o[1];i[s]=URL.createObjectURL(a)}window.cr_previewProjectFiles=i;var l=g(t.webFonts,i);if(l){var c=new Blob([l],{type:"text/css"});m.push(d(URL.createObjectURL(c)))}}function g(t,e){for(var i="",n=Object.entries(t),r=0;r<n.length;r++){var o=_slicedToArray(n[r],2),s=o[0],a=o[1];i+="@font-face {\nfont-family: '".concat(s,"';\nsrc: ");for(var l,c=0,u=a.length;c<u;++c)if(l=a[c].url,e.hasOwnProperty(l)){l=e[l];var h=a[c].format;i+="url('".concat(l,"')"),h&&(i+=" format('".concat(h,"')")),i+=c===u-1?";":", "}i+="\n}\n\n"}return i}function h(t){var e=t.imageFiles;window.cr_previewImageBlobs=e;for(var i={},n=Object.entries(e),r=0;r<n.length;r++){var o=_slicedToArray(n[r],2),s=o[0],a=o[1];i[s]=URL.createObjectURL(a)}window.cr_remotePreviewImageFiles=i}function i(t){}function j(t){for(var e=0;e<n.length;e++){var i=n[e];if("<script-dependencies>"===i){var r=!0,o=!1,s=void 0;try{for(var a,l=t.dependencyScripts[Symbol.iterator]();!(r=(a=l.next()).done);r=!0){var u=a.value,h=u;u instanceof Blob&&(h=URL.createObjectURL(u)),m.push(c(h))}}catch(t){o=!0,s=t}finally{try{if(!r&&null!=l.return)l.return()}finally{if(o)throw s}}}else if("<shaders>"===i)m.push(c(URL.createObjectURL(t.shaders)));else if("<plugin-and-behavior-scripts>"===i){var d=!0,p=!1,f=void 0;try{for(var g,y=t.pluginScripts[Symbol.iterator]();!(d=(g=y.next()).done);d=!0){var v=g.value;v instanceof Blob&&(v=URL.createObjectURL(v)),m.push(c(v))}}catch(t){p=!0,f=t}finally{try{if(!d&&null!=y.return)y.return()}finally{if(p)throw f}}var b=!0,_=!1,w=void 0;try{for(var x,S=t.behaviorScripts[Symbol.iterator]();!(b=(x=S.next()).done);b=!0){var I=x.value;I instanceof Blob&&(I=URL.createObjectURL(I)),m.push(c(I))}}catch(t){_=!0,w=t}finally{try{if(!b&&null!=S.return)S.return()}finally{if(_)throw w}}}else"<objrefs>"===i?m.push(c(URL.createObjectURL(t.objRefTable))):m.push(c(i))}return Promise.all(m).then(function(){return c("c2/start-preview.js")})}function k(t){for(var e=[],i=0;i<n.length;i++){var r=n[i];if("<script-dependencies>"===r){if(!q){var s=!0,a=!1,l=void 0;try{for(var u,h=t.dependencyScripts[Symbol.iterator]();!(s=(u=h.next()).done);s=!0){var d=u.value,p=d;d instanceof Blob&&(p=URL.createObjectURL(d)),m.push(c(p))}}catch(t){a=!0,l=t}finally{try{if(!s&&null!=h.return)h.return()}finally{if(a)throw l}}}}else if("<objrefs>"===r)e.push(URL.createObjectURL(t.objRefTable)),e.push(URL.createObjectURL(t.expFuncTable));else if("<shaders>"===r)m.push(c(URL.createObjectURL(t.shaders)));else if("<plugin-and-behavior-scripts>"===r){var f=!0,g=!1,y=void 0;try{for(var v,b=t.pluginScripts[Symbol.iterator]();!(f=(v=b.next()).done);f=!0){var _=v.value;_ instanceof Blob&&(_=URL.createObjectURL(_)),e.push(_)}}catch(t){g=!0,y=t}finally{try{if(!f&&null!=b.return)b.return()}finally{if(g)throw y}}var w=!0,x=!1,S=void 0;try{for(var I,T=t.behaviorScripts[Symbol.iterator]();!(w=(I=T.next()).done);w=!0){var C=I.value;C instanceof Blob&&(C=URL.createObjectURL(C)),e.push(C)}}catch(t){x=!0,S=t}finally{try{if(!w&&null!=T.return)T.return()}finally{if(x)throw S}}}else e.push(r)}window.cr_allEngineScripts=e,window.cr_useWorker=q,window.cr_workerDependencyScripts=q?t.dependencyScripts:[];for(var O=[],P=0;P<o.length;P++){var E=o[P];"<domside-scripts>"===E?t.domSideScripts.forEach(function(t){var e=t;e instanceof Blob&&(e=URL.createObjectURL(e)),O.push(c(e))}):O.push(c(E))}return Promise.all(O)}function l(t){r=!0,t.isDebug?location.href=t.url:location.reload(!1)}function _typeof(t){if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator)_typeof=function(t){return typeof t};else _typeof=function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};return _typeof(t)}window.xf_addPortMessageHandler(function(t){var n=t.type;"meta"===n?e(t):"data"===n?f(t):"images"===n?h(t):"scripts"===n?i(t):"reload"===n?l(t):"close-window"===n?window.close():!s&&console.warn("[Preview] Unknown message: "+n)}),window.addEventListener("resize",function(){postPreviewWindow({from:"runtime",type:"resize",width:window.innerWidth,height:window.innerHeight})}),window.nw&&window.nw.Window?window.nw.Window.get().on("close",function(){return b(!0)}):window.addEventListener("unload",function(){return b(!1)}),window.addEventListener("wheel",function(t){t.ctrlKey&&t.preventDefault()});var Sentry=function(h){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};function i(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}var t,e,r,o,s,a,f=function(){return(f=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var r in e=arguments[i])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)};function l(o,s,a,l){return new(a||(a=Promise))(function(t,e){function i(t){try{r(l.next(t))}catch(t){e(t)}}function n(t){try{r(l.throw(t))}catch(t){e(t)}}function r(e){e.done?t(e.value):new a(function(t){t(e.value)}).then(i,n)}r((l=l.apply(o,s||[])).next())})}function c(i,n){var r,o,s,t,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return a.label++,{value:e[1],done:!1};case 5:a.label++,o=e[1],e=[0];continue;case 7:e=a.ops.pop(),a.trys.pop();continue;default:if(!(s=0<(s=a.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){a=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){a.label=e[1];break}if(6===e[0]&&a.label<s[1]){a.label=s[1],s=e;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(e);break}s[2]&&a.ops.pop(),a.trys.pop();continue}e=n.call(i,a)}catch(t){e=[6,t],o=0}finally{r=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function p(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var n,r,o=i.call(t),s=[];try{for(;(void 0===e||0<e--)&&!(n=o.next()).done;)s.push(n.value)}catch(t){r={error:t}}finally{try{n&&!n.done&&(i=o.return)&&i.call(o)}finally{if(r)throw r.error}}return s}function u(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(p(arguments[e]));return t}(a=t||(t={}))[a.None=0]="None",a[a.Error=1]="Error",a[a.Debug=2]="Debug",a[a.Verbose=3]="Verbose",(e=h.Severity||(h.Severity={})).Fatal="fatal",e.Error="error",e.Warning="warning",e.Log="log",e.Info="info",e.Debug="debug",e.Critical="critical",(s=h.Severity||(h.Severity={})).fromString=function(t){switch(t){case"debug":return s.Debug;case"info":return s.Info;case"warn":case"warning":return s.Warning;case"error":return s.Error;case"fatal":return s.Fatal;case"critical":return s.Critical;case"log":default:return s.Log}},(r=h.Status||(h.Status={})).Unknown="unknown",r.Skipped="skipped",r.Success="success",r.RateLimit="rate_limit",r.Invalid="invalid",r.Failed="failed",(o=h.Status||(h.Status={})).fromHttpCode=function(t){return 200<=t&&t<300?o.Success:429===t?o.RateLimit:400<=t&&t<500?o.Invalid:500<=t?o.Failed:o.Unknown};var m=function(n){function t(t){var e=this.constructor,i=n.call(this,t)||this;return i.message=t,i.name=e.prototype.constructor.name,Object.setPrototypeOf(i,e.prototype),i}return i(t,n),t}(Error);function g(t){switch(Object.prototype.toString.call(t)){case"[object Error]":case"[object Exception]":case"[object DOMException]":return!0;default:return t instanceof Error}}function y(t){return"[object ErrorEvent]"===Object.prototype.toString.call(t)}function d(t){return"[object DOMError]"===Object.prototype.toString.call(t)}function v(t){return"[object String]"===Object.prototype.toString.call(t)}function b(t){return null===t||"object"!=_typeof(t)&&"function"!=typeof t}function _(t){return"[object Object]"===Object.prototype.toString.call(t)}function w(t){return Boolean(t&&t.then&&"function"==typeof t.then)}var x={};function S(){return"[object process]"===Object.prototype.toString.call("undefined"!=typeof process?process:0)?global:void 0!==window?window:"undefined"!=typeof self?self:x}function I(){var t=S(),e=t.crypto||t.msCrypto;if(void 0!==e&&e.getRandomValues){var i=new Uint16Array(8);e.getRandomValues(i),i[3]=4095&i[3]|16384,i[4]=16383&i[4]|32768;var n=function(t){for(var e=t.toString(16);e.length<4;)e="0"+e;return e};return n(i[0])+n(i[1])+n(i[2])+n(i[3])+n(i[4])+n(i[5])+n(i[6])+n(i[7])}return"xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)})}function T(t){if(!t)return{};var e=t.match(/^(([^:\/?#]+):)?(\/\/([^\/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/);if(!e)return{};var i=e[6]||"",n=e[8]||"";return{host:e[4],path:e[5],protocol:e[2],relative:e[5]+i+n}}function C(t){if(t.message)return t.message;if(t.exception&&t.exception.values&&t.exception.values[0]){var e=t.exception.values[0];return e.type&&e.value?e.type+": "+e.value:e.type||e.value||t.event_id||"<unknown>"}return t.event_id||"<unknown>"}function O(t){var e=S();if(!("console"in e))return t();var i=e.console,n={};["debug","info","warn","error","log","assert"].forEach(function(t){t in e.console&&i[t].__sentry__&&(n[t]=i[t].__sentry_wrapped__,i[t]=i[t].__sentry_original__)});var r=t();return Object.keys(n).forEach(function(t){i[t]=n[t]}),r}function P(t,e,i,n){void 0===n&&(n={handled:!0,type:"generic"}),t.exception=t.exception||{},t.exception.values=t.exception.values||[],t.exception.values[0]=t.exception.values[0]||{},t.exception.values[0].value=t.exception.values[0].value||e||"",t.exception.values[0].type=t.exception.values[0].type||i||"Error",t.exception.values[0].mechanism=t.exception.values[0].mechanism||n}var E=S(),A="Sentry Logger ",k=function(){function t(){this.t=!1}return t.prototype.disable=function(){this.t=!1},t.prototype.enable=function(){this.t=!0},t.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.t&&O(function(){E.console.log(A+"[Log]: "+t.join(" "))})},t.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.t&&O(function(){E.console.warn(A+"[Warn]: "+t.join(" "))})},t.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.t&&O(function(){E.console.error(A+"[Error]: "+t.join(" "))})},t}();E.__SENTRY__=E.__SENTRY__||{};var M=E.__SENTRY__.logger||(E.__SENTRY__.logger=new k),R=function(){function t(){this.i="function"==typeof WeakSet,this.o=this.i?new WeakSet:[]}return t.prototype.memoize=function(t){if(this.i)return!!this.o.has(t)||(this.o.add(t),!1);for(var e=0;e<this.o.length;e++)if(this.o[e]===t)return!0;return this.o.push(t),!1},t.prototype.unmemoize=function(t){if(this.i)this.o.delete(t);else for(var e=0;e<this.o.length;e++)if(this.o[e]===t){this.o.splice(e,1);break}},t}();function L(t,e,i){if(e in t){var n=t[e],r=i(n);"function"==typeof r&&(r.prototype=r.prototype||{},Object.defineProperties(r,{__sentry__:{enumerable:!1,value:!0},__sentry_original__:{enumerable:!1,value:n},__sentry_wrapped__:{enumerable:!1,value:r}})),t[e]=r}}function D(t,e,i){void 0===e&&(e=3),void 0===i&&(i=102400);var n,r,o=B(t,e);return(n=o,r=JSON.stringify(n),~-encodeURI(r).split(/%..|./).length>i)?D(t,e-1,i):o}function N(t,e){return"domain"===e&&"object"==_typeof(t)&&t.u?"[Domain]":"domainEmitter"===e?"[DomainEmitter]":"undefined"!=typeof global&&t===global?"[Global]":void 0!==window&&t===window?"[Window]":"undefined"!=typeof document&&t===document?"[Document]":"undefined"!=typeof Event&&t instanceof Event?Object.getPrototypeOf(t)?t.constructor.name:"Event":_(i=t)&&"nativeEvent"in i&&"preventDefault"in i&&"stopPropagation"in i?"[SyntheticEvent]":Number.isNaN(t)?"[NaN]":void 0===t?"[undefined]":"function"==typeof t?"[Function: "+(t.name||"<unknown-function-name>")+"]":t;var i}function B(t,i){try{return JSON.parse(JSON.stringify(t,function(t,e){return function t(e,i,n,r){if(void 0===n&&(n=1/0),void 0===r&&(r=new R),0===n)return function(t){var e=Object.prototype.toString.call(t);if("string"==typeof t)return t;if("[object Object]"===e)return"[Object]";if("[object Array]"===e)return"[Array]";var i=N(t);return b(i)?i:e}(i);if(null!=i&&"function"==typeof i.toJSON)return i.toJSON();var o=N(i,e);if(b(o))return o;var s=g(i)?function(t){var e={message:t.message,name:t.name,stack:t.stack};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}(i):i,a=Array.isArray(i)?[]:{};if(r.memoize(i))return"[Circular ~]";for(var l in s)Object.prototype.hasOwnProperty.call(s,l)&&(a[l]=t(l,s[l],n-1,r));return r.unmemoize(i),a}(t,e,i)}))}catch(t){return"**non-serializable**"}}var F,j,G=function(){function t(t){this.s=t,this.h=[]}return t.prototype.isReady=function(){return void 0===this.s||this.length()<this.s},t.prototype.add=function(i){return l(this,void 0,void 0,function(){var e=this;return c(this,function(t){return this.isReady()?(-1===this.h.indexOf(i)&&this.h.push(i),i.then(function(){return l(e,void 0,void 0,function(){return c(this,function(t){return[2,this.remove(i)]})})}).catch(function(){return l(e,void 0,void 0,function(){return c(this,function(t){return[2,this.remove(i).catch(function(){})]})})}),[2,i]):[2,Promise.reject(new m("Not adding Promise due to buffer limit reached."))]})})},t.prototype.remove=function(e){return l(this,void 0,void 0,function(){return c(this,function(t){return[2,this.h.splice(this.h.indexOf(e),1)[0]]})})},t.prototype.length=function(){return this.h.length},t.prototype.drain=function(n){return l(this,void 0,void 0,function(){var i=this;return c(this,function(t){return[2,new Promise(function(t){var e=setTimeout(function(){n&&0<n&&t(!1)},n);Promise.all(i.h).then(function(){clearTimeout(e),t(!0)}).catch(function(){t(!0)})})]})})},t}();function V(t,e){return void 0===e&&(e=0),0===e?t:t.length<=e?t:t.substr(0,e)+"..."}function U(t,e){if(!Array.isArray(t))return"";for(var i=[],n=0;n<t.length;n++){var r=t[n];try{i.push(String(r))}catch(t){i.push("[value cannot be serialized]")}}return i.join(e)}function W(){if(!("fetch"in S()))return!1;try{return new Headers,new Request(""),new Response,!0}catch(t){return!1}}(j=F||(F={})).PENDING="PENDING",j.RESOLVED="RESOLVED",j.REJECTED="REJECTED";var $=function(){function o(t){var i=this;this.v=F.PENDING,this.l=[],this.p=function(t){i.m(t,F.RESOLVED)},this.g=function(t){i.m(t,F.REJECTED)},this.m=function(t,e){i.v===F.PENDING&&(w(t)?t.then(i.p,i.g):(i.j=t,i.v=e,i.S()))},this.S=function(){i.v!==F.PENDING&&(i.v===F.REJECTED?i.l.forEach(function(t){return t.onFail&&t.onFail(i.j)}):i.l.forEach(function(t){return t.onSuccess&&t.onSuccess(i.j)}),i.l=[])},this.O=function(t){i.l=i.l.concat(t),i.S()};try{t(this.p,this.g)}catch(t){this.g(t)}}return o.prototype.then=function(n,r){var t=this;return new o(function(e,i){t.O({onFail:function(t){if(r)try{return void e(r(t))}catch(t){return void i(t)}else i(t)},onSuccess:function(t){if(n)try{return void e(n(t))}catch(t){return void i(t)}else e(t)}})})},o.prototype.catch=function(t){return this.then(function(t){return t},t)},o.prototype.toString=function(){return"[object SyncPromise]"},o.resolve=function(e){return new o(function(t){t(e)})},o.reject=function(i){return new o(function(t,e){e(i)})},o}(),H=function(){function i(){this._=!1,this.k=[],this.T=[],this.R=[],this.D={},this.I={},this.A={},this.C={}}return i.prototype.addScopeListener=function(t){this.k.push(t)},i.prototype.addEventProcessor=function(t){return this.T.push(t),this},i.prototype.L=function(){var e=this;this._||(this._=!0,setTimeout(function(){e.k.forEach(function(t){t(e)}),e._=!1}))},i.prototype.M=function(r,o,s,a){var l=this;return void 0===a&&(a=0),new $(function(e,t){var i=r[a];if(null===o||"function"!=typeof i)e(o);else{var n=i(f({},o),s);w(n)?n.then(function(t){return l.M(r,t,s,a+1).then(e)}).catch(t):l.M(r,n,s,a+1).then(e).catch(t)}})},i.prototype.setUser=function(t){return this.D=B(t),this.L(),this},i.prototype.setTags=function(t){return this.I=f({},this.I,B(t)),this.L(),this},i.prototype.setTag=function(t,e){var i;return this.I=f({},this.I,((i={})[t]=B(e),i)),this.L(),this},i.prototype.setExtras=function(t){return this.A=f({},this.A,B(t)),this.L(),this},i.prototype.setExtra=function(t,e){var i;return this.A=f({},this.A,((i={})[t]=B(e),i)),this.L(),this},i.prototype.setFingerprint=function(t){return this.N=B(t),this.L(),this},i.prototype.setLevel=function(t){return this.F=B(t),this.L(),this},i.prototype.setContext=function(t,e){return this.C[t]=e?B(e):void 0,this.L(),this},i.clone=function(t){var e=new i;return Object.assign(e,t,{k:[]}),t&&(e.R=u(t.R),e.I=f({},t.I),e.A=f({},t.A),e.C=f({},t.C),e.D=t.D,e.F=t.F,e.N=t.N,e.T=u(t.T)),e},i.prototype.clear=function(){return this.R=[],this.I={},this.A={},this.D={},this.C={},this.F=void 0,this.N=void 0,this.L(),this},i.prototype.addBreadcrumb=function(t,e){var i=(new Date).getTime()/1e3,n=f({timestamp:i},t);return this.R=void 0!==e&&0<=e?u(this.R,[B(n)]).slice(-e):u(this.R,[B(n)]),this.L(),this},i.prototype.clearBreadcrumbs=function(){return this.R=[],this.L(),this},i.prototype.U=function(t){t.fingerprint=t.fingerprint?Array.isArray(t.fingerprint)?t.fingerprint:[t.fingerprint]:[],this.N&&(t.fingerprint=t.fingerprint.concat(this.N)),t.fingerprint&&!t.fingerprint.length&&delete t.fingerprint},i.prototype.applyToEvent=function(t,e){return this.A&&Object.keys(this.A).length&&(t.extra=f({},this.A,t.extra)),this.I&&Object.keys(this.I).length&&(t.tags=f({},this.I,t.tags)),this.D&&Object.keys(this.D).length&&(t.user=f({},this.D,t.user)),this.C&&Object.keys(this.C).length&&(t.contexts=f({},this.C,t.contexts)),this.F&&(t.level=this.F),this.U(t),t.breadcrumbs=u(t.breadcrumbs||[],this.R),t.breadcrumbs=0<t.breadcrumbs.length?t.breadcrumbs:void 0,this.M(u(J(),this.T),t,e)},i}();function J(){var t=S();return t.__SENTRY__=t.__SENTRY__||{},t.__SENTRY__.globalEventProcessors=t.__SENTRY__.globalEventProcessors||[],t.__SENTRY__.globalEventProcessors}function K(t){J().push(t)}var q=3,z=function(){function t(t,e,i){void 0===e&&(e=new H),void 0===i&&(i=q),this.P=i,this.$=[],this.$.push({client:t,scope:e})}return t.prototype.q=function(t){for(var e,i=[],n=1;n<arguments.length;n++)i[n-1]=arguments[n];var r=this.getStackTop();r&&r.client&&r.client[t]&&(e=r.client)[t].apply(e,u(i,[r.scope]))},t.prototype.isOlderThan=function(t){return this.P<t},t.prototype.bindClient=function(t){this.getStackTop().client=t},t.prototype.pushScope=function(){var t=this.getStack(),e=0<t.length?t[t.length-1].scope:void 0,i=H.clone(e);return this.getStack().push({client:this.getClient(),scope:i}),i},t.prototype.popScope=function(){return void 0!==this.getStack().pop()},t.prototype.withScope=function(t){var e=this.pushScope();try{t(e)}finally{this.popScope()}},t.prototype.getClient=function(){return this.getStackTop().client},t.prototype.getScope=function(){return this.getStackTop().scope},t.prototype.getStack=function(){return this.$},t.prototype.getStackTop=function(){return this.$[this.$.length-1]},t.prototype.captureException=function(t,e){var i=this.H=I();return this.q("captureException",t,f({},e,{event_id:i})),i},t.prototype.captureMessage=function(t,e,i){var n=this.H=I();return this.q("captureMessage",t,e,f({},i,{event_id:n})),n},t.prototype.captureEvent=function(t,e){var i=this.H=I();return this.q("captureEvent",t,f({},e,{event_id:i})),i},t.prototype.lastEventId=function(){return this.H},t.prototype.addBreadcrumb=function(t,e){var i=this.getStackTop();if(i.scope&&i.client){var n=i.client.getOptions&&i.client.getOptions()||{},r=n.beforeBreadcrumb,o=void 0===r?null:r,s=n.maxBreadcrumbs,a=void 0===s?30:s;if(!(a<=0)){var l=(new Date).getTime()/1e3,c=f({timestamp:l},t),u=o?O(function(){return o(c,e)}):c;null!==u&&i.scope.addBreadcrumb(u,Math.min(a,100))}}},t.prototype.configureScope=function(t){var e=this.getStackTop();e.scope&&e.client&&t(e.scope)},t.prototype.run=function(t){var e=Y(this);try{t(this)}finally{Y(e)}},t.prototype.getIntegration=function(t){var e=this.getClient();if(!e)return null;try{return e.getIntegration(t)}catch(e){return M.warn("Cannot retrieve integration "+t.id+" from the current Hub"),null}},t}();function X(){var t=S();return t.__SENTRY__=t.__SENTRY__||{hub:void 0},t}function Y(t){var e=X(),i=tt(e);return et(e,t),i}function Q(){var t,e=X();Z(e)&&!tt(e).isOlderThan(q)||et(e,new z);try{var i=(t=module,"domain",t.require("domain")).active;if(!i)return tt(e);if(!Z(i)||tt(i).isOlderThan(q)){var n=tt(e).getStackTop();et(i,new z(n.client,H.clone(n.scope)))}return tt(i)}catch(t){return tt(e)}}function Z(t){return!!(t&&t.__SENTRY__&&t.__SENTRY__.hub)}function tt(t){return t&&t.__SENTRY__&&t.__SENTRY__.hub?t.__SENTRY__.hub:(t.__SENTRY__=t.__SENTRY__||{},t.__SENTRY__.hub=new z,t.__SENTRY__.hub)}function et(t,e){return!!t&&(t.__SENTRY__=t.__SENTRY__||{},t.__SENTRY__.hub=e,!0)}function it(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];var n=Q();if(n&&n[t])return n[t].apply(n,u(e));throw new Error("No hub defined or "+t+" was not found on the hub, please open a bug report.")}function nt(t){var e;try{throw new Error("Sentry syntheticException")}catch(t){e=t}return it("captureException",t,{originalException:t,syntheticException:e})}function rt(t){it("withScope",t)}var ot=/^(?:(\w+):)\/\/(?:(\w+)(?::(\w+))?@)([\w\.-]+)(?::(\d+))?\/(.+)/,st=function(){function t(t){"string"==typeof t?this.W(t):this.B(t),this.G()}return t.prototype.toString=function(t){void 0===t&&(t=!1);var e=this,i=e.host,n=e.path,r=e.pass,o=e.port,s=e.projectId;return e.protocol+"://"+e.user+(t&&r?":"+r:"")+"@"+i+(o?":"+o:"")+"/"+(n?n+"/":n)+s},t.prototype.W=function(t){var e=ot.exec(t);if(!e)throw new m("Invalid Dsn");var i=p(e.slice(1),6),n=i[0],r=i[1],o=i[2],s=void 0===o?"":o,a=i[3],l=i[4],c=void 0===l?"":l,u="",h=i[5],d=h.split("/");1<d.length&&(u=d.slice(0,-1).join("/"),h=d.pop()),Object.assign(this,{host:a,pass:s,path:u,projectId:h,port:c,protocol:n,user:r})},t.prototype.B=function(t){this.protocol=t.protocol,this.user=t.user,this.pass=t.pass||"",this.host=t.host,this.port=t.port||"",this.path=t.path||"",this.projectId=t.projectId},t.prototype.G=function(){var e=this;if(["protocol","user","host","projectId"].forEach(function(t){if(!e[t])throw new m("Invalid Dsn")}),"http"!==this.protocol&&"https"!==this.protocol)throw new m("Invalid Dsn");if(this.port&&Number.isNaN(parseInt(this.port,10)))throw new m("Invalid Dsn")},t}(),at=function(){function t(t){this.dsn=t,this.J=new st(t)}return t.prototype.getDsn=function(){return this.J},t.prototype.getStoreEndpoint=function(){return""+this.X()+this.getStoreEndpointPath()},t.prototype.getStoreEndpointWithUrlEncodedAuth=function(){var e,t={sentry_key:this.J.user,sentry_version:"7"};return this.getStoreEndpoint()+"?"+(e=t,Object.keys(e).map(function(t){return encodeURIComponent(t)+"="+encodeURIComponent(e[t])}).join("&"))},t.prototype.X=function(){var t=this.J,e=t.protocol?t.protocol+":":"",i=t.port?":"+t.port:"";return e+"//"+t.host+i},t.prototype.getStoreEndpointPath=function(){var t=this.J;return(t.path?"/"+t.path:"")+"/api/"+t.projectId+"/store/"},t.prototype.getRequestHeaders=function(t,e){var i=this.J,n=["Sentry sentry_version=7"];return n.push("sentry_timestamp="+(new Date).getTime()),n.push("sentry_client="+t+"/"+e),n.push("sentry_key="+i.user),i.pass&&n.push("sentry_secret="+i.pass),{"Content-Type":"application/json","X-Sentry-Auth":n.join(", ")}},t.prototype.getReportDialogEndpoint=function(t){void 0===t&&(t={});var e=this.J,i=this.X()+(e.path?"/"+e.path:"")+"/api/embed/error-page/",n=[];for(var r in n.push("dsn="+e.toString()),t)if("user"===r){if(!t.user)continue;t.user.name&&n.push("name="+encodeURIComponent(t.user.name)),t.user.email&&n.push("email="+encodeURIComponent(t.user.email))}else n.push(encodeURIComponent(r)+"="+encodeURIComponent(t[r]));return n.length?i+"?"+n.join("&"):i},t}(),lt=[];var ct,ut=function(){function t(t,e){var i,n;this.V=!1,this.K=new t(e),(this.Z=e).dsn&&(this.Y=new st(e.dsn)),this.nn=(i=this.Z,n={},function(t){var e=t.defaultIntegrations&&u(t.defaultIntegrations)||[],i=t.integrations,n=[];if(Array.isArray(i)){var r=i.map(function(t){return t.name}),o=[];e.forEach(function(t){-1===r.indexOf(t.name)&&-1===o.indexOf(t.name)&&(n.push(t),o.push(t.name))}),i.forEach(function(t){-1===o.indexOf(t.name)&&(n.push(t),o.push(t.name))})}else{if("function"!=typeof i)return u(e);n=i(e),n=Array.isArray(n)?n:[n]}return n}(i).forEach(function(t){var e;n[t.name]=t,e=t,-1===lt.indexOf(e.name)&&(e.setupOnce(K,Q),lt.push(e.name),M.log("Integration installed: "+e.name))}),n)}return t.prototype.captureException=function(t,e,i){var n=this,r=e&&e.event_id;return this.V=!0,this.tn().eventFromException(t,e).then(function(t){return n.rn(t,e,i)}).then(function(t){r=t&&t.event_id,n.V=!1}).catch(function(t){M.error(t),n.V=!1}),r},t.prototype.captureMessage=function(t,e,i,n){var r=this,o=i&&i.event_id;return this.V=!0,(b(t)?this.tn().eventFromMessage(""+t,e,i):this.tn().eventFromException(t,i)).then(function(t){return r.rn(t,i,n)}).then(function(t){o=t&&t.event_id,r.V=!1}).catch(function(t){M.error(t),r.V=!1}),o},t.prototype.captureEvent=function(t,e,i){var n=this,r=e&&e.event_id;return this.V=!0,this.rn(t,e,i).then(function(t){r=t&&t.event_id,n.V=!1}).catch(function(t){M.error(t),n.V=!1}),r},t.prototype.getDsn=function(){return this.Y},t.prototype.getOptions=function(){return this.Z},t.prototype.flush=function(n){return l(this,void 0,void 0,function(){var e,i;return c(this,function(t){switch(t.label){case 0:return[4,this.en(n)];case 1:return e=t.sent(),this.in&&clearInterval(this.in),[4,this.tn().getTransport().close(n)];case 2:return i=t.sent(),[2,e&&i]}})})},t.prototype.close=function(i){return l(this,void 0,void 0,function(){var e;return c(this,function(t){switch(t.label){case 0:return[4,this.flush(i)];case 1:return e=t.sent(),this.getOptions().enabled=!1,[2,e]}})})},t.prototype.getIntegrations=function(){return this.nn||{}},t.prototype.getIntegration=function(e){try{return this.nn[e.id]||null}catch(t){return M.warn("Cannot retrieve integration "+e.id+" from the current Client"),null}},t.prototype.en=function(n){return l(this,void 0,void 0,function(){var i=this;return c(this,function(t){return[2,new Promise(function(t){var e=0;i.in&&clearInterval(i.in),i.in=setInterval(function(){i.V?(e+=1,n&&n<=e&&t(!1)):t(!0)},1)})]})})},t.prototype.tn=function(){return this.K},t.prototype.on=function(){return!1!==this.getOptions().enabled&&void 0!==this.Y},t.prototype.un=function(t,e,i){var n=this.getOptions(),r=n.environment,o=n.release,s=n.dist,a=n.maxValueLength,l=void 0===a?250:a,c=f({},t);void 0===c.environment&&void 0!==r&&(c.environment=r),void 0===c.release&&void 0!==o&&(c.release=o),void 0===c.dist&&void 0!==s&&(c.dist=s),c.message&&(c.message=V(c.message,l));var u=c.exception&&c.exception.values&&c.exception.values[0];u&&u.value&&(u.value=V(u.value,l));var h=c.request;h&&h.url&&(h.url=V(h.url,l)),void 0===c.event_id&&(c.event_id=I()),this.cn(c.sdk);var d=$.resolve(c);return e&&(d=e.applyToEvent(c,i)),d},t.prototype.cn=function(t){var e=Object.keys(this.nn);t&&0<e.length&&(t.integrations=e)},t.prototype.rn=function(t,o,e){var s=this,i=this.getOptions(),a=i.beforeSend,n=i.sampleRate;return this.on()?"number"==typeof n&&Math.random()>n?$.reject("This event has been sampled, will not send event."):new $(function(n,r){s.un(t,e,o).then(function(t){if(null!==t){var e=t;try{if(o&&o.data&&!0===o.data.__sentry__||!a)return s.tn().sendEvent(e),void n(e);var i=a(t,o);if(void 0===i)M.error("`beforeSend` method has to return `null` or a valid event.");else if(w(i))s.sn(i,n,r);else{if(null===(e=i))return M.log("`beforeSend` returned `null`, will not send event."),void n(null);s.tn().sendEvent(e),n(e)}}catch(t){s.captureException(t,{data:{__sentry__:!0},originalException:t}),r("`beforeSend` throw an error, will not send event.")}}else r("An event processor returned null, will not send event.")})}):$.reject("SDK not enabled, will not send event.")},t.prototype.sn=function(t,e,i){var n=this;t.then(function(t){null!==t?(n.tn().sendEvent(t),e(t)):i("`beforeSend` returned `null`, will not send event.")}).catch(function(t){i("beforeSend rejected with "+t)})},t}(),ht=function(){function t(){}return t.prototype.sendEvent=function(t){return l(this,void 0,void 0,function(){return c(this,function(t){return[2,Promise.resolve({reason:"NoopTransport: Event has been skipped because no Dsn is configured.",status:h.Status.Skipped})]})})},t.prototype.close=function(t){return l(this,void 0,void 0,function(){return c(this,function(t){return[2,Promise.resolve(!0)]})})},t}(),dt=function(){function t(t){this.Z=t,this.Z.dsn||M.warn("No DSN provided, backend will not do anything."),this.an=this.fn()}return t.prototype.fn=function(){return new ht},t.prototype.eventFromException=function(t,e){throw new m("Backend has to implement `eventFromException` method")},t.prototype.eventFromMessage=function(t,e,i){throw new m("Backend has to implement `eventFromMessage` method")},t.prototype.sendEvent=function(t){this.an.sendEvent(t).catch(function(t){M.error("Error while sending event: "+t)})},t.prototype.getTransport=function(){return this.an},t}(),pt=function(){function t(){this.name=t.id}return t.prototype.setupOnce=function(){ct=Function.prototype.toString,Function.prototype.toString=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=this.__sentry__?this.__sentry_original__:this;return ct.apply(i,t)}},t.id="FunctionToString",t}(),ft=[/^Script error\.?$/,/^Javascript error: Script error\.? on line 0$/],mt=function(){function s(t){void 0===t&&(t={}),this.Z=t,this.name=s.id}return s.prototype.setupOnce=function(){K(function(t){var e=Q();if(!e)return t;var i=e.getIntegration(s);if(i){var n=e.getClient(),r=n?n.getOptions():{},o=i.hn(r);if(i.vn(t,o))return null}return t})},s.prototype.vn=function(t,e){return this.ln(t,e)?(M.warn("Event dropped due to being internal Sentry Error.\nEvent: "+C(t)),!0):this.dn(t,e)?(M.warn("Event dropped due to being matched by `ignoreErrors` option.\nEvent: "+C(t)),!0):this.pn(t,e)?(M.warn("Event dropped due to being matched by `blacklistUrls` option.\nEvent: "+C(t)+".\nUrl: "+this.mn(t)),!0):!this.yn(t,e)&&(M.warn("Event dropped due to not being matched by `whitelistUrls` option.\nEvent: "+C(t)+".\nUrl: "+this.mn(t)),!0)},s.prototype.ln=function(t,e){if(void 0===e&&(e={}),!e.ignoreInternal)return!1;try{return"SentryError"===t.exception.values[0].type}catch(t){return!1}},s.prototype.dn=function(t,i){var n=this;return void 0===i&&(i={}),!(!i.ignoreErrors||!i.ignoreErrors.length)&&this.bn(t).some(function(e){return i.ignoreErrors.some(function(t){return n.wn(e,t)})})},s.prototype.pn=function(t,e){var i=this;if(void 0===e&&(e={}),!e.blacklistUrls||!e.blacklistUrls.length)return!1;var n=this.mn(t);return!!n&&e.blacklistUrls.some(function(t){return i.wn(n,t)})},s.prototype.yn=function(t,e){var i=this;if(void 0===e&&(e={}),!e.whitelistUrls||!e.whitelistUrls.length)return!0;var n=this.mn(t);return!n||e.whitelistUrls.some(function(t){return i.wn(n,t)})},s.prototype.hn=function(t){return void 0===t&&(t={}),{blacklistUrls:u(this.Z.blacklistUrls||[],t.blacklistUrls||[]),ignoreErrors:u(this.Z.ignoreErrors||[],t.ignoreErrors||[],ft),ignoreInternal:void 0===this.Z.ignoreInternal||this.Z.ignoreInternal,whitelistUrls:u(this.Z.whitelistUrls||[],t.whitelistUrls||[])}},s.prototype.wn=function(t,e){return i=e,"[object RegExp]"===Object.prototype.toString.call(i)?e.test(t):"string"==typeof e&&t.includes(e);var i},s.prototype.bn=function(t){if(t.message)return[t.message];if(t.exception)try{var e=t.exception.values[0],i=e.type,n=e.value;return[""+n,i+": "+n]}catch(e){return M.error("Cannot extract message for event "+C(t)),[]}return[]},s.prototype.mn=function(t){try{if(t.stacktrace){var e=t.stacktrace.frames;return e[e.length-1].filename}if(t.exception){var i=t.exception.values[0].stacktrace.frames;return i[i.length-1].filename}return null}catch(e){return M.error("Cannot extract url for event "+C(t)),null}},s.id="InboundFilters",s}(),gt=Object.freeze({FunctionToString:pt,InboundFilters:mt}),yt=S(),vt={report:!1,collectWindowErrors:!1,computeStackTrace:!1,linesOfContext:!1},bt="?",_t=/^(?:[Uu]ncaught (?:exception: )?)?(?:((?:Eval|Internal|Range|Reference|Syntax|Type|URI|)Error): )?(.*)$/;function wt(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function xt(){return"undefined"==typeof document||null==document.location?"":document.location.href}vt.report=function(){var u,t,o=[],i=null,h=null;function d(t,e,i){var n=null;if(!e||vt.collectWindowErrors){for(var r in o)if(wt(o,r))try{o[r](t,e,i)}catch(t){n=t}if(n)throw n}}function e(t,e,i,n,r){var o=null;if(r=y(r)?r.error:r,t=y(t)?t.message:t,h)vt.computeStackTrace.augmentStackTraceWithInitialElement(h,e,i,t),p();else if(r&&g(r))(o=vt.computeStackTrace(r)).mechanism="onerror",d(o,!0,r);else{var s,a={url:e,line:i,column:n},l=t;if("[object String]"==={}.toString.call(t)){var c=t.match(_t);c&&(s=c[1],l=c[2])}a.func=bt,a.context=null,d(o={name:s,message:l,mode:"onerror",mechanism:"onerror",stack:[f({},a,{url:a.url||xt()})]},!0,null)}return!!u&&u.apply(this,arguments)}function n(t){var e=t&&(t.detail?t.detail.reason:t.reason)||t,i=vt.computeStackTrace(e);i.mechanism="onunhandledrejection",d(i,!0,e)}function p(){var t=h,e=i;i=h=null,d(t,!1,e)}function r(t){if(h){if(i===t)return;p()}var e=vt.computeStackTrace(t);throw h=e,i=t,setTimeout(function(){i===t&&p()},e.incomplete?2e3:0),t}return r.subscribe=function(t){o.push(t)},r.installGlobalHandler=function(){!0!==t&&(u=yt.onerror,yt.onerror=e,t=!0)},r.installGlobalUnhandledRejectionHandler=function(){yt.onunhandledrejection=n},r}(),vt.computeStackTrace=function(){function n(t){if(!t.stack)return null;for(var e,i,n,r=/^\s*at (?:(.*?) ?\()?((?:file|https?|blob|chrome-extension|native|eval|webpack|<anonymous>|[a-z]:|\/).*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,o=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)((?:file|https?|blob|chrome|webpack|resource|moz-extension).*?:\/.*?|\[native code\]|[^@]*bundle)(?::(\d+))?(?::(\d+))?\s*$/i,s=/^\s*at (?:((?:\[object object\])?.+) )?\(?((?:file|ms-appx|https?|webpack|blob):.*?):(\d+)(?::(\d+))?\)?\s*$/i,a=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,l=/\((\S*)(?::(\d+))(?::(\d+))\)/,c=t.stack.split("\n"),u=[],h=/^(.*) is undefined$/.exec(t.message),d=0,p=c.length;d<p;++d){if(i=r.exec(c[d])){var f=i[2]&&0===i[2].indexOf("native");i[2]&&0===i[2].indexOf("eval")&&(e=l.exec(i[2]))&&(i[2]=e[1]),n={url:f?null:i[2],func:i[1]||bt,args:f?[i[2]]:[],line:i[3]?+i[3]:null,column:i[4]?+i[4]:null}}else if(i=s.exec(c[d]))n={url:i[2],func:i[1]||bt,args:[],line:+i[3],column:i[4]?+i[4]:null};else{if(!(i=o.exec(c[d])))continue;i[3]&&-1<i[3].indexOf(" > eval")&&(e=a.exec(i[3]))?i[3]=e[1]:0!==d||i[5]||void 0===t.columnNumber||(u[0].column=t.columnNumber+1),n={url:i[3],func:i[1]||bt,args:i[2]?i[2].split(","):[],line:i[4]?+i[4]:null,column:i[5]?+i[5]:null}}!n.func&&n.line&&(n.func=bt),n.context=null,u.push(n)}return u.length?(u[0]&&u[0].line&&!u[0].column&&h&&(u[0].column=null),{mode:"stack",name:t.name,message:t.message,stack:u}):null}function u(t,e,i,n){var r={url:e,line:i};if(r.url&&r.line){if(t.incomplete=!1,r.func||(r.func=bt),r.context||(r.context=null),/ '([^']+)' /.exec(n)&&(r.column=null),0<t.stack.length&&t.stack[0].url===r.url){if(t.stack[0].line===r.line)return!1;if(!t.stack[0].line&&t.stack[0].func===r.func)return t.stack[0].line=r.line,t.stack[0].context=r.context,!1}return t.stack.unshift(r),t.partial=!0}return!(t.incomplete=!0)}function h(t,e){for(var i,n,r=/function\s+([_$a-zA-Z\xA0-\uFFFF][_$a-zA-Z0-9\xA0-\uFFFF]*)?\s*\(/i,o=[],s={},a=!1,l=h.caller;l&&!a;l=l.caller)if(l!==d&&l!==vt.report){if(n={url:null,func:bt,args:[],line:null,column:null},l.name?n.func=l.name:(i=r.exec(l.toString()))&&(n.func=i[1]),void 0===n.func)try{n.func=i.input.substring(0,i.input.indexOf("{"))}catch(t){}s[""+l]?a=!0:s[""+l]=!0,o.push(n)}e&&o.splice(0,e);var c={mode:"callers",name:t.name,message:t.message,stack:o};return u(c,t.sourceURL||t.fileName,t.line||t.lineNumber,t.message||t.description),c}function d(t,e){var i=null;e=null==e?0:+e;try{if(i=function(t){var e=t.stacktrace;if(e){for(var i,n=/ line (\d+).*script (?:in )?(\S+)(?:: in function (\S+))?$/i,r=/ line (\d+), column (\d+)\s*(?:in (?:<anonymous function: ([^>]+)>|([^\)]+))\((.*)\))? in (.*):\s*$/i,o=e.split("\n"),s=[],a=0;a<o.length;a+=2){var l=null;(i=n.exec(o[a]))?l={url:i[2],line:+i[1],column:null,func:i[3],args:[]}:(i=r.exec(o[a]))&&(l={url:i[6],line:+i[1],column:+i[2],func:i[3]||i[4],args:i[5]?i[5].split(","):[]}),l&&(!l.func&&l.line&&(l.func=bt),l.line&&(l.context=null),l.context||(l.context=[o[a+1]]),s.push(l))}return s.length?{mode:"stacktrace",name:t.name,message:t.message,stack:s}:null}}(t))return i}catch(t){}try{if(i=n(t))return i}catch(t){}try{if(i=function(t){var e=t.message.split("\n");if(e.length<4)return null;var i,n=/^\s*Line (\d+) of linked script ((?:file|https?|blob)\S+)(?:: in function (\S+))?\s*$/i,r=/^\s*Line (\d+) of inline#(\d+) script in ((?:file|https?|blob)\S+)(?:: in function (\S+))?\s*$/i,o=/^\s*Line (\d+) of function script\s*$/i,s=[],a=yt&&yt.document&&yt.document.getElementsByTagName("script"),l=[];for(var c in a)wt(a,c)&&!a[c].src&&l.push(a[c]);for(var u=2;u<e.length;u+=2){var h=null;(i=n.exec(e[u]))?h={url:i[2],func:i[3],args:[],line:+i[1],column:null}:(i=r.exec(e[u]))?h={url:i[3],func:i[4],args:[],line:+i[1],column:null}:(i=o.exec(e[u]))&&(h={url:xt().replace(/#.*$/,""),func:"",args:[],line:i[1],column:null}),h&&(h.func||(h.func=bt),h.context=[e[u+1]],s.push(h))}return s.length?{mode:"multiline",name:t.name,message:e[0],stack:s}:null}(t))return i}catch(t){}try{if(i=h(t,e+1))return i}catch(t){}return{original:t,name:t.name,message:t.message,mode:"failed"}}return d.augmentStackTraceWithInitialElement=u,d.computeStackTraceFromStackProp=n,d}(),vt.collectWindowErrors=!0,vt.linesOfContext=11;var St=vt.report.subscribe,It=vt.report.installGlobalHandler,Tt=vt.report.installGlobalUnhandledRejectionHandler,Ct=vt.computeStackTrace,Ot=50;function Pt(t){var e=At(t.stack),i={type:t.name,value:t.message};return e&&e.length&&(i.stacktrace={frames:e}),void 0===i.type&&""===i.value&&(i.value="Unrecoverable error caught"),i}function Et(t){return{exception:{values:[Pt(t)]}}}function At(t){if(!t||!t.length)return[];var e=t,i=e[0].func||"",n=e[e.length-1].func||"";return(i.includes("captureMessage")||i.includes("captureException"))&&(e=e.slice(1)),n.includes("sentryWrapped")&&(e=e.slice(0,-1)),e.map(function(t){return{colno:t.column,filename:t.url||e[0].url,function:t.func||"?",in_app:!0,lineno:t.line}}).slice(0,Ot).reverse()}var kt,Mt,Rt=function(){function t(t){this.options=t,this.h=new G(30),this.url=new at(this.options.dsn).getStoreEndpointWithUrlEncodedAuth()}return t.prototype.sendEvent=function(t){return l(this,void 0,void 0,function(){return c(this,function(t){throw new m("Transport Class has to implement `sendEvent` method")})})},t.prototype.close=function(e){return l(this,void 0,void 0,function(){return c(this,function(t){return[2,this.h.drain(e)]})})},t}(),Lt=S(),Dt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.sendEvent=function(i){return l(this,void 0,void 0,function(){var e;return c(this,function(t){return e={body:JSON.stringify(i),method:"POST",referrerPolicy:function(){if(!W())return!1;try{return new Request("_",{referrerPolicy:"origin"}),!0}catch(t){return!1}}()?"origin":""},[2,this.h.add(Lt.fetch(this.url,e).then(function(t){return{status:h.Status.fromHttpCode(t.status)}}))]})})},e}(Rt),Nt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.sendEvent=function(r){return l(this,void 0,void 0,function(){var n=this;return c(this,function(t){return[2,this.h.add(new Promise(function(t,e){var i=new XMLHttpRequest;i.onreadystatechange=function(){4===i.readyState&&(200===i.status&&t({status:h.Status.fromHttpCode(i.status)}),e(i))},i.open("POST",n.url),i.send(JSON.stringify(r))}))]})})},e}(Rt),Bt=Object.freeze({BaseTransport:Rt,FetchTransport:Dt,XHRTransport:Nt}),Ft=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.fn=function(){if(!this.Z.dsn)return e.prototype.fn.call(this);var t=this.Z.transportOptions?this.Z.transportOptions:{dsn:this.Z.dsn};return this.Z.transport?new this.Z.transport(t):W()?new Dt(t):new Nt(t)},t.prototype.eventFromException=function(t,e){var i,n,r=this;if(y(t)&&t.error)return t=t.error,i=Et(Ct(t)),$.resolve(this.gn(i,e));if(d(t)||(n=t,"[object DOMException]"===Object.prototype.toString.call(n))){var o=t,s=o.name||(d(o)?"DOMError":"DOMException"),a=o.message?s+": "+o.message:s;return this.eventFromMessage(a,h.Severity.Error,e).then(function(t){return P(t,a),$.resolve(r.gn(t,e))})}if(g(t))return i=Et(Ct(t)),$.resolve(this.gn(i,e));if(_(t)&&e&&e.syntheticException)return P(i=function(t,e){var i=Object.keys(t).sort(),n={extra:{__serialized__:D(t)},message:"Non-Error exception captured with keys: "+function(t,e){if(void 0===e&&(e=40),!t.length)return"[object has no keys]";if(t[0].length>=e)return V(t[0],e);for(var i=t.length;0<i;i--){var n=t.slice(0,i).join(", ");if(!(n.length>e))return i===t.length?n:V(n,e)}return""}(i)};if(e){var r=At(Ct(e).stack);n.stacktrace={frames:r}}return n}(t,e.syntheticException),"Custom Object",void 0,{handled:!0,synthetic:!0,type:"generic"}),i.level=h.Severity.Error,$.resolve(this.gn(i,e));var l=t;return this.eventFromMessage(l,void 0,e).then(function(t){return P(t,""+l,void 0,{handled:!0,synthetic:!0,type:"generic"}),t.level=h.Severity.Error,$.resolve(r.gn(t,e))})},t.prototype.gn=function(t,e){return f({},t,{event_id:e&&e.event_id})},t.prototype.eventFromMessage=function(t,e,i){void 0===e&&(e=h.Severity.Info);var n={event_id:i&&i.event_id,level:e,message:t};if(this.Z.attachStacktrace&&i&&i.syntheticException){var r=At(Ct(i.syntheticException).stack);n.stacktrace={frames:r}}return $.resolve(n)},t}(dt),jt="sentry.javascript.browser",Gt=function(n){function t(t){return void 0===t&&(t={}),n.call(this,Ft,t)||this}return i(t,n),t.prototype.un=function(t,e,i){return t.platform=t.platform||"javascript",t.sdk=f({},t.sdk,{name:jt,packages:u(t.sdk&&t.sdk.packages||[],[{name:"npm:@sentry/browser",version:"5.1.0"}]),version:"5.1.0"}),n.prototype.un.call(this,t,e,i)},t.prototype.showReportDialog=function(t){void 0===t&&(t={});var e=S().document;if(e)if(this.on()){var i=t.dsn||this.getDsn();if(t.eventId)if(i){var n=e.createElement("script");n.async=!0,n.src=new at(i).getReportDialogEndpoint(t),(e.head||e.body).appendChild(n)}else M.error("Missing `Dsn` option in showReportDialog call");else M.error("Missing `eventId` option in showReportDialog call")}else M.error("Trying to call showReportDialog with Sentry Client is disabled")},t}(ut),Vt=0;function Ut(e,n,r){if(void 0===n&&(n={}),"function"!=typeof e)return e;try{if(e.__sentry__)return e;if(e.__sentry_wrapped__)return e.__sentry_wrapped__}catch(n){return e}var t=function(){r&&"function"==typeof r&&r.apply(this,arguments);var i=Array.prototype.slice.call(arguments);try{var t=i.map(function(t){return Ut(t,n)});return e.handleEvent?e.handleEvent.apply(this,t):e.apply(this,t)}catch(e){throw Vt+=1,setTimeout(function(){Vt-=1}),rt(function(t){t.addEventProcessor(function(t){var e=f({},t);return n.mechanism&&P(e,void 0,void 0,n.mechanism),e.extra=f({},e.extra,{arguments:B(i,3)}),e}),nt(e)}),e}};try{for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}catch(e){}e.prototype=e.prototype||{},t.prototype=e.prototype,Object.defineProperty(e,"__sentry_wrapped__",{enumerable:!1,value:t}),Object.defineProperties(t,{__sentry__:{enumerable:!1,value:!0},__sentry_original__:{enumerable:!1,value:e}});try{Object.defineProperty(t,"name",{get:function(){return e.name}})}catch(e){}return t}var Wt=0;function $t(i,n){return void 0===n&&(n=!1),function(t){if(kt=void 0,t&&Mt!==t){Mt=t;var e=function(){var e;try{e=t.target?Jt(t.target):Jt(t)}catch(t){e="<unknown>"}0!==e.length&&Q().addBreadcrumb({category:"ui."+i,message:e},{event:t,name:i})};Wt&&clearTimeout(Wt),n?Wt=setTimeout(e):e()}}}function Ht(){return function(t){var e;try{e=t.target}catch(t){return}var i=e&&e.tagName;i&&("INPUT"===i||"TEXTAREA"===i||e.isContentEditable)&&(kt||$t("input")(t),clearTimeout(kt),kt=setTimeout(function(){kt=void 0},1e3))}}function Jt(t){for(var e,i=t,n=[],r=0,o=0,s=" > ".length;i&&r++<5&&!("html"===(e=Kt(i))||1<r&&80<=o+n.length*s+e.length);)n.push(e),o+=e.length,i=i.parentNode;return n.reverse().join(" > ")}function Kt(t){var e,i,n,r,o,s=[];if(!t||!t.tagName)return"";if(s.push(t.tagName.toLowerCase()),t.id&&s.push("#"+t.id),(e=t.className)&&v(e))for(i=e.split(/\s+/),o=0;o<i.length;o++)s.push("."+i[o]);var a=["type","name","title","alt"];for(o=0;o<a.length;o++)n=a[o],(r=t.getAttribute(n))&&s.push("["+n+'="'+r+'"]');return s.join("")}var qt=function(){function r(t){this.name=r.id,this.Z=f({onerror:!0,onunhandledrejection:!0},t)}return r.prototype.setupOnce=function(){Error.stackTraceLimit=50,St(function(t,e,i){if(!(0<Vt)){var n=Q().getIntegration(r);n&&Q().captureEvent(n.En(t),{data:{stack:t},originalException:i})}}),this.Z.onerror&&(M.log("Global Handler attached: onerror"),It()),this.Z.onunhandledrejection&&(M.log("Global Handler attached: onunhandledrejection"),Tt())},r.prototype.En=function(t){var e=Et(t),i={mode:t.mode};t.message&&(i.message=t.message),t.name&&(i.name=t.name);var n=Q().getClient(),r=n&&n.getOptions().maxValueLength||250;return P(e,t.original?V(JSON.stringify(B(t.original)),r):"","onunhandledrejection"===t.mechanism?"UnhandledRejection":"Error",{data:i,handled:!1,type:t.mechanism}),e},r.id="GlobalHandlers",r}(),zt=function(){function t(){this.jn=0,this.name=t.id}return t.prototype.xn=function(n){return function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=t[0];return t[0]=Ut(i,{mechanism:{data:{function:Xt(n)},handled:!0,type:"instrument"}}),n.apply(this,t)}},t.prototype.Sn=function(e){return function(t){return e(Ut(t,{mechanism:{data:{function:"requestAnimationFrame",handler:Xt(e)},handled:!0,type:"instrument"}}))}},t.prototype.On=function(r){var t=S(),e=t[r]&&t[r].prototype;e&&e.hasOwnProperty&&e.hasOwnProperty("addEventListener")&&(L(e,"addEventListener",function(n){return function(t,e,i){try{e.handleEvent=Ut(e.handleEvent.bind(e),{mechanism:{data:{function:"handleEvent",handler:Xt(e),target:r},handled:!0,type:"instrument"}})}catch(t){}return n.call(this,t,Ut(e,{mechanism:{data:{function:"addEventListener",handler:Xt(e),target:r},handled:!0,type:"instrument"}}),i)}}),L(e,"removeEventListener",function(r){return function(t,e,i){var n=e;try{n=n&&(n.__sentry_wrapped__||n)}catch(t){}return r.call(this,t,n,i)}}))},t.prototype.setupOnce=function(){this.jn=this.jn;var t=S();L(t,"setTimeout",this.xn.bind(this)),L(t,"setInterval",this.xn.bind(this)),L(t,"requestAnimationFrame",this.Sn.bind(this)),["EventTarget","Window","Node","ApplicationCache","AudioTrackList","ChannelMergerNode","CryptoOperation","EventSource","FileReader","HTMLUnknownElement","IDBDatabase","IDBRequest","IDBTransaction","KeyOperation","MediaController","MessagePort","ModalWindow","Notification","SVGElementInstance","Screen","TextTrack","TextTrackCue","TextTrackList","WebSocket","WebSocketWorker","Worker","XMLHttpRequest","XMLHttpRequestEventTarget","XMLHttpRequestUpload"].forEach(this.On.bind(this))},t.id="TryCatch",t}();function Xt(t){try{return t&&t.name||"<anonymous>"}catch(t){return"<anonymous>"}}var Yt,Qt=S(),Zt=function(){function u(t){this.name=u.id,this.Z=f({console:!0,dom:!0,fetch:!0,history:!0,sentry:!0,xhr:!0},t)}return u.prototype._n=function(){"console"in Qt&&["debug","info","warn","error","log","assert"].forEach(function(r){r in Qt.console&&L(Qt.console,r,function(n){return function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i={category:"console",data:{extra:{arguments:B(t,3)},logger:"console"},level:h.Severity.fromString(r),message:U(t," ")};"assert"===r&&!1===t[0]&&(i.message="Assertion failed: "+(U(t.slice(1)," ")||"console.assert"),i.data.extra.arguments=B(t.slice(1),3)),u.addBreadcrumb(i,{input:t,level:r}),n&&Function.prototype.apply.call(n,Qt.console,t)}})})},u.prototype.kn=function(){"document"in Qt&&(Qt.document.addEventListener("click",$t("click"),!1),Qt.document.addEventListener("keypress",Ht(),!1),["EventTarget","Node"].forEach(function(t){var e=Qt[t]&&Qt[t].prototype;e&&e.hasOwnProperty&&e.hasOwnProperty("addEventListener")&&(L(e,"addEventListener",function(n){return function(t,e,i){return e.handleEvent?("click"===t&&L(e,"handleEvent",function(e){return function(t){return $t("click")(t),e.call(this,t)}}),"keypress"===t&&L(e,"handleEvent",Ht())):("click"===t&&$t("click",!0)(this),"keypress"===t&&Ht()(this)),n.call(this,t,e,i)}}),L(e,"removeEventListener",function(r){return function(t,e,i){var n=e;try{n=n&&(n.__sentry_wrapped__||n)}catch(t){}return r.call(this,t,n,i)}}))}))},u.prototype.Tn=function(){W()&&-1!==S().fetch.toString().indexOf("native")&&L(Qt,"fetch",function(c){return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i,n=e[0],r="GET";"string"==typeof n?i=n:"Request"in Qt&&n instanceof Request?(i=n.url,n.method&&(r=n.method)):i=String(n),e[1]&&e[1].method&&(r=e[1].method);var o=Q().getClient(),s=o&&o.getDsn();if(s){var a=new at(s).getStoreEndpoint();if(a&&i.includes(a))return"POST"===r&&e[1]&&e[1].body&&te(e[1].body),c.apply(Qt,e)}var l={method:r,url:i};return c.apply(Qt,e).then(function(t){return l.status_code=t.status,u.addBreadcrumb({category:"fetch",data:l,type:"http"},{input:e,response:t}),t}).catch(function(t){throw u.addBreadcrumb({category:"fetch",data:l,level:h.Severity.Error,type:"http"},{error:t,input:e}),t})}})},u.prototype.Rn=function(){var n=this;if(i=(e=(t=S()).chrome)&&e.app&&e.app.runtime,r="history"in t&&!!t.history.pushState&&!!t.history.replaceState,!i&&r){var t,e,i,r,o=function(t,e){var i=T(Qt.location.href),n=T(e),r=T(t);r.path||(r=i),Yt=e,i.protocol===n.protocol&&i.host===n.host&&(e=n.relative),i.protocol===r.protocol&&i.host===r.host&&(t=r.relative),u.addBreadcrumb({category:"navigation",data:{from:t,to:e}})},s=Qt.onpopstate;Qt.onpopstate=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=Qt.location.href;if(o(Yt,i),s)return s.apply(n,t)},L(Qt.history,"pushState",a),L(Qt.history,"replaceState",a)}function a(n){return function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=2<t.length?t[2]:void 0;return i&&o(Yt,String(i)),n.apply(this,t)}}},u.prototype.Dn=function(){if("XMLHttpRequest"in Qt){var t=XMLHttpRequest.prototype;L(t,"open",function(s){return function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=t[1];this.__sentry_xhr__={method:t[0],url:t[1]};var n=Q().getClient(),r=n&&n.getDsn();if(r){var o=new at(r).getStoreEndpoint();v(i)&&o&&i.includes(o)&&(this.__sentry_own_request__=!0)}return s.apply(this,t)}}),L(t,"send",function(r){return function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=this;function i(){if(4===n.readyState){if(n.__sentry_own_request__)return;try{n.__sentry_xhr__&&(n.__sentry_xhr__.status_code=n.status)}catch(t){}u.addBreadcrumb({category:"xhr",data:n.__sentry_xhr__,type:"http"},{xhr:n})}}return n.__sentry_own_request__&&te(t[0]),["onload","onerror","onprogress"].forEach(function(t){var e,i;(e=t)in(i=n)&&"function"==typeof i[e]&&L(i,e,function(t){return Ut(t,{mechanism:{data:{function:e,handler:t&&t.name||"<anonymous>"},handled:!0,type:"instrument"}})})}),"onreadystatechange"in n&&"function"==typeof n.onreadystatechange?L(n,"onreadystatechange",function(t){return Ut(t,{mechanism:{data:{function:"onreadystatechange",handler:t&&t.name||"<anonymous>"},handled:!0,type:"instrument"}},i)}):n.onreadystatechange=i,r.apply(this,t)}})}},u.addBreadcrumb=function(t,e){Q().getIntegration(u)&&Q().addBreadcrumb(t,e)},u.prototype.setupOnce=function(){this.Z.console&&this._n(),this.Z.dom&&this.kn(),this.Z.xhr&&this.Dn(),this.Z.fetch&&this.Tn(),this.Z.history&&this.Rn()},u.id="Breadcrumbs",u}();function te(t){try{var e=JSON.parse(t);Zt.addBreadcrumb({category:"sentry",event_id:e.event_id,level:e.level||h.Severity.fromString("error"),message:C(e)},{event:e})}catch(t){M.error("Error while adding sentry type breadcrumb")}}var ee=function(){function n(t){void 0===t&&(t={}),this.name=n.id,this.In=t.key||"cause",this.s=t.limit||5}return n.prototype.setupOnce=function(){K(function(t,e){var i=Q().getIntegration(n);return i?i.handler(t,e):t})},n.prototype.handler=function(t,e){if(!(t.exception&&t.exception.values&&e&&e.originalException instanceof Error))return t;var i=this.walkErrorTree(e.originalException,this.In);return t.exception.values=u(i,t.exception.values),t},n.prototype.walkErrorTree=function(t,e,i){if(void 0===i&&(i=[]),!(t[e]instanceof Error)||i.length+1>=this.s)return i;var n=Pt(Ct(t[e]));return this.walkErrorTree(t[e],e,u([n],i))},n.id="LinkedErrors",n}(),ie=S(),ne=function(){function i(){this.name=i.id}return i.prototype.setupOnce=function(){K(function(t){if(Q().getIntegration(i)){if(!ie.navigator||!ie.location)return t;var e=t.request||{};return e.url=e.url||ie.location.href,e.headers=e.headers||{},e.headers["User-Agent"]=ie.navigator.userAgent,f({},t,{request:e})}return t})},i.id="UserAgent",i}(),re=Object.freeze({GlobalHandlers:qt,TryCatch:zt,Breadcrumbs:Zt,LinkedErrors:ee,UserAgent:ne}),oe=[new mt,new pt,new zt,new Zt,new qt,new ee,new ne],se={},ae=S();ae.Sentry&&ae.Sentry.Integrations&&(se=ae.Sentry.Integrations);var le=f({},se,gt,re);return h.Integrations=le,h.Transports=Bt,h.addGlobalEventProcessor=K,h.addBreadcrumb=function(t){it("addBreadcrumb",t)},h.captureException=nt,h.captureEvent=function(t){return it("captureEvent",t)},h.captureMessage=function(t,e){var i;try{throw new Error(t)}catch(t){i=t}return it("captureMessage",t,e,{originalException:t,syntheticException:i})},h.configureScope=function(t){it("configureScope",t)},h.withScope=rt,h.getHubFromCarrier=tt,h.getCurrentHub=Q,h.Hub=z,h.Scope=H,h.BrowserClient=Gt,h.defaultIntegrations=oe,h.forceLoad=function(){},h.init=function(t){var e,i;void 0===t&&(t={}),void 0===t.defaultIntegrations&&(t.defaultIntegrations=oe),e=Gt,!0===(i=t).debug&&M.enable(),Q().bindClient(new e(i))},h.lastEventId=function(){return Q().lastEventId()},h.onLoad=function(t){t()},h.showReportDialog=function(t){void 0===t&&(t={}),t.eventId||(t.eventId=Q().lastEventId());var e=Q().getClient();e&&e.showReportDialog(t)},h.flush=function(i){return l(this,void 0,void 0,function(){var e;return c(this,function(t){return(e=Q().getClient())?[2,e.flush(i)]:[2,Promise.reject(!1)]})})},h.close=function(i){return l(this,void 0,void 0,function(){var e;return c(this,function(t){return(e=Q().getClient())?[2,e.close(i)]:[2,Promise.reject(!1)]})})},h.SDK_NAME=jt,h.SDK_VERSION="5.1.0",h}({});function _typeof(t){if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator)_typeof=function(t){return typeof t};else _typeof=function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};return _typeof(t)}!function(o,t,e){if("development"!==xfConfig.environment){var i=function(t){var e={};if("string"!=typeof t)t=o.location.search;if(!(t=t.replace(/^\?/g,"")))return{};for(var i,n=t.split("&"),r=0;r<n.length;++r){if((i=n[r].indexOf("="))<0)i=n[r].length;e[decodeURIComponent(n[r].slice(0,i))]=decodeURIComponent(n[r].slice(i+1))}return e}(o.localStorage.getItem("xf_debugger_search"));Sentry.init({dsn:o.xfConfig.sentry.dsn,release:o.xfConfig.editorVersion||i.editorVersion,environment:o.xfConfig.environment,attachStacktrace:!0,beforeSend:function(t,e){if(t.exception)try{if(t.exception.values[0].stacktrace.frames){var i=(n=t.exception.values[0].stacktrace,(r=n.frames[n.frames.length-1]).filename+r.lineno+":"+r.colno);if(sessionStorage.getItem(i))return null;else sessionStorage.setItem(i,t.event_id)}}catch(t){}var n,r;return t}}),Sentry.configureScope(function(t){t.setUser({id:xfConfig.devid}),t.setTag("gameVersion",xfConfig.version),t.setTag("gameId",xfConfig.appId),t.setTag("gameName",xfConfig.appName),t.setTag("platform",xfConfig.exportType)})}}(window,document,JSON);var drama={};if(window.drama=drama,window.xf={},drama.plugins_={},drama.behaviors={},"function"!=typeof Object.getPrototypeOf)if("object"===_typeof("test".__proto__))Object.getPrototypeOf=function(t){return t.__proto__};else Object.getPrototypeOf=function(t){return t.constructor.prototype};!function(){function t(t,e){this.x=t,this.y=e,drama.seal(this)}function e(t,e,i,n){this.set(t,e,i,n),drama.seal(this)}function i(){this.tlx=0,this.tly=0,this.trx=0,this.try_=0,this.brx=0,this.bry=0,this.blx=0,this.bly=0,drama.seal(this)}drama.logexport=function(t){if(window.console&&window.console.log)window.console.log(t)},drama.logerror=function(t){if(window.console&&window.console.error)window.console.error(t)},drama.seal=function(t){return t},drama.freeze=function(t){return t},drama.is_undefined=function(t){return void 0===t},drama.is_number=function(t){return"number"==typeof t},drama.is_string=function(t){return"string"==typeof t},drama.isPOT=function(t){return 0<t&&0==(t-1&t)},drama.nextHighestPowerOfTwo=function(t){--t;for(var e=1;e<32;e<<=1)t|=t>>e;return t+1},drama.abs=function(t){return t<0?-t:t},drama.max=function(t,e){return e<t?t:e},drama.min=function(t,e){return t<e?t:e},drama.PI=Math.PI,drama.round=function(t){return t+.5|0},drama.floor=function(t){if(0<=t)return 0|t;else return(0|t)-1},drama.ceil=function(t){var e=0|t;return e===t?e:e+1},t.prototype.offset=function(t,e){return this.x+=t,this.y+=e,this},t.prototype.mul=function(t,e){return this.x*=t,this.y*=e,this},drama.vector2=t,drama.segments_intersect=function(t,e,i,n,r,o,s,a){var l,c,u,h,d,p,f,m;if(t<i)c=t,l=i;else c=i,l=t;if(r<s)p=r,d=s;else p=s,d=r;if(l<p||d<c)return!1;if(e<n)h=e,u=n;else h=n,u=e;if(o<a)m=o,f=a;else m=a,f=o;if(u<m||f<h)return!1;var g=r-t+s-i,y=o-e+a-n,v=i-t,b=n-e,_=s-r,w=a-o,x=drama.abs(b*_-w*v),S=_*y-w*g;if(drama.abs(S)>x)return!1;var I=v*y-b*g;return drama.abs(I)<=x},drama.segments_intersect_point=function(t,e,i,n){var r=e.y-t.y,o=t.x-e.x,s=e.x*t.y-t.x*e.y,a=n.y-i.y,l=i.x-n.x,c=n.x*i.y-i.x*n.y,u=r*l-a*o;if(0===u)return!1;var h=(c*o-s*l)/u>>0,d=(s*a-c*r)/u>>0,p=(t.x>e.x?e.x:t.x)>>0,f=(t.x>e.x?t.x:e.x)>>0,m=(t.y>e.y?e.y:t.y)>>0,g=(t.y>e.y?t.y:e.y)>>0,y=(i.x>n.x?n.x:i.x)>>0,v=(i.x>n.x?i.x:n.x)>>0,b=(i.y>n.y?n.y:i.y)>>0,_=(i.y>n.y?i.y:n.y)>>0;if(h<p||h<y||f<h||v<h||d<m||d<b||g<d||_<d)return!1;else return xf.Point.create(h,d)},drama.circle_intersect=function(t,e,i,n,r,o){return(t-n)*(t-n)+(e-r)*(e-r)<=(i+o)*(i+o)},drama.circle_segments_intersect=function(t,e,i,n,r,o,s){var a,l,c,u,h=s*s;if((t-r)*(t-r)+(e-o)*(e-o)<=h||(i-r)*(i-r)+(n-o)*(n-o)<=h)return!0;if(t==i)a=1,l=0,c=-t;else if(e==n)a=0,l=1,c=-e;else a=e-n,l=i-t,c=t*n-e*i;if(u=a*r+l*o+c,(a*a+l*l)*s*s<(u*=u))return!1;if(0<(r-t)*(i-t)+(o-e)*(n-e)&&0<(r-i)*(t-i)+(o-n)*(e-n))return!0;else return!1},e.prototype.set=function(t,e,i,n){this.left=t,this.top=e,this.right=i,this.bottom=n},e.prototype.copy=function(t){this.left=t.left,this.top=t.top,this.right=t.right,this.bottom=t.bottom},e.prototype.width=function(){return this.right-this.left},e.prototype.height=function(){return this.bottom-this.top},e.prototype.offset=function(t,e){return this.left+=t,this.top+=e,this.right+=t,this.bottom+=e,this},e.prototype.normalize=function(){var t=0;if(this.left>this.right)t=this.left,this.left=this.right,this.right=t;if(this.top>this.bottom)t=this.top,this.top=this.bottom,this.bottom=t},e.prototype.intersects_rect=function(t){return!(t.right<this.left||t.bottom<this.top||t.left>this.right||t.top>this.bottom)},e.prototype.intersects_rect_off=function(t,e,i){return!(t.right+e<this.left||t.bottom+i<this.top||t.left+e>this.right||t.top+i>this.bottom)},e.prototype.contains_pt=function(t,e){return t>=this.left&&t<=this.right&&e>=this.top&&e<=this.bottom},e.prototype.equals=function(t){return this.left===t.left&&this.top===t.top&&this.right===t.right&&this.bottom===t.bottom},drama.rect=e,i.prototype.set_from_rect=function(t){this.tlx=t.left,this.tly=t.top,this.trx=t.right,this.try_=t.top,this.brx=t.right,this.bry=t.bottom,this.blx=t.left,this.bly=t.bottom},i.prototype.set_from_rotated_rect=function(t,e){if(0===e)this.set_from_rect(t);else{var i=Math.sin(e),n=Math.cos(e),r=t.left*i,o=t.top*i,s=t.right*i,a=t.bottom*i,l=t.left*n,c=t.top*n,u=t.right*n,h=t.bottom*n;this.tlx=l-o,this.tly=c+r,this.trx=u-o,this.try_=c+s,this.brx=u-a,this.bry=h+s,this.blx=l-a,this.bly=h+r}},i.prototype.offset=function(t,e){return this.tlx+=t,this.tly+=e,this.trx+=t,this.try_+=e,this.brx+=t,this.bry+=e,this.blx+=t,this.bly+=e,this};var r=0,o=0;function n(t,e,i,n){if(t<e)if(i<n){if(t<i)r=t;else r=i;if(n<e)o=e;else o=n}else{if(t<n)r=t;else r=n;if(i<e)o=e;else o=i}else if(i<n){if(e<i)r=e;else r=i;if(n<t)o=t;else o=n}else{if(e<n)r=e;else r=n;if(i<t)o=t;else o=i}}i.prototype.bounding_box=function(t){n(this.tlx,this.trx,this.brx,this.blx),t.left=r,t.right=o,n(this.tly,this.try_,this.bry,this.bly),t.top=r,t.bottom=o},i.prototype.contains_pt=function(t,e){var i=this.tlx,n=this.tly,r=this.trx-i,o=this.try_-n,s=this.brx-i,a=this.bry-n,l=t-i,c=e-n,u=r*r+o*o,h=r*s+o*a,d=r*l+o*c,p=s*s+a*a,f=s*l+a*c,m=1/(u*p-h*h),g=(p*d-h*f)*m,y=(u*f-h*d)*m;if(0<=g&&0<y&&g+y<1)return!0;else return y=((u=(r=this.blx-i)*r+(o=this.bly-n)*o)*f-(h=r*s+o*a)*(d=r*l+o*c))*(m=1/(u*p-h*h)),0<=(g=(p*d-h*f)*m)&&0<y&&g+y<1},i.prototype.at=function(t,e){if(e)switch(t){case 0:return this.tlx;case 1:return this.trx;case 2:return this.brx;case 3:return this.blx;case 4:default:return this.tlx}else switch(t){case 0:return this.tly;case 1:return this.try_;case 2:return this.bry;case 3:return this.bly;case 4:default:return this.tly}},i.prototype.midX=function(){return(this.tlx+this.trx+this.brx+this.blx)/4},i.prototype.midY=function(){return(this.tly+this.try_+this.bry+this.bly)/4},i.prototype.intersects_segment=function(t,e,i,n){if(this.contains_pt(t,e)||this.contains_pt(i,n))return!0;var r,o,s,a,l;for(l=0;l<4;l++)if(r=this.at(l,!0),o=this.at(l,!1),s=this.at(l+1,!0),a=this.at(l+1,!1),drama.segments_intersect(t,e,i,n,r,o,s,a))return!0;return!1},i.prototype.intersects_quad=function(t){var e,i,n,r,o,s,a,l,c,u,h=t.midX(),d=t.midY();if(this.contains_pt(h,d))return!0;if(h=this.midX(),d=this.midY(),t.contains_pt(h,d))return!0;for(c=0;c<4;c++)for(u=0;u<4;u++)if(e=this.at(c,!0),i=this.at(c,!1),n=this.at(c+1,!0),r=this.at(c+1,!1),o=t.at(u,!0),s=t.at(u,!1),a=t.at(u+1,!0),l=t.at(u+1,!1),drama.segments_intersect(e,i,n,r,o,s,a,l))return!0;return!1},drama.quad=i,drama.RGB=function(t,e,i){return Math.max(Math.min(i,255),0)|Math.max(Math.min(e,255),0)<<8|Math.max(Math.min(t,255),0)<<16};var s=131072,a=65535,l=-65536;drama.RGBEx=function(t,e,i){if(t=drama.clamp(Math.floor(1024*t),l,a),e=drama.clamp(Math.floor(1024*e),l,a),i=drama.clamp(Math.floor(1024*i),l,a),t<0)t+=s;if(e<0)e+=s;if(i<0)i+=s;return-(t*s*s+e*s+i)},drama.GetBValue=function(t){if(0<=t)return(255&t)/255;else{var e=Math.floor(-t/(s*s));if(a<e)e-=s;return e/1024}},drama.GetGValue=function(t){if(0<=t)return((65280&t)>>8)/255;else{var e=Math.floor(-t%(s*s)/s);if(a<e)e-=s;return e/1024}},drama.GetRValue=function(t){if(0<=t)return((16711680&t)>>16)/255;else{var e=Math.floor(-t%s);if(a<e)e-=s;return e/1024}},drama.GetAValue=function(t){if(0<=t)return((4278190080&t)>>24&255)/255;else return 1},drama.shallowCopy=function(t,e,i){var n;for(n in e)if(e.hasOwnProperty(n))assert2(i||drama.is_undefined(t[n]),"shallowCopy() overwriting property '"+n+"', is this intended?"),t[n]=e[n];return t},drama.arrayRemove=function(t,e){var i,n;if(!((e=drama.floor(e))<0||e>=t.length)){for(i=e,n=t.length-1;i<n;i++)t[i]=t[i+1];drama.truncateArray(t,n)}},drama.truncateArray=function(t,e){t.length=e},drama.clearArray=function(t){drama.truncateArray(t,0)},drama.shallowAssignArray=function(t,e){var i,n;for(drama.clearArray(t),i=0,n=e.length;i<n;++i)t[i]=e[i]},drama.appendArray=function(t,e){t.push.apply(t,e)},drama.fastIndexOf=function(t,e){var i,n;for(i=0,n=t.length;i<n;++i)if(t[i]===e)return i;return-1},drama.arrayFindRemove=function(t,e){var i=drama.fastIndexOf(t,e);if(-1!==i)drama.arrayRemove(t,i)},drama.clamp=function(t,e,i){if(t<e)return e;else if(i<t)return i;else return t},drama.to_radians=function(t){return t/(180/drama.PI)},drama.to_degrees=function(t){return t*(180/drama.PI)},drama.clamp_angle_degrees=function(t){if((t%=360)<0)t+=360;return t},drama.clamp_angle=function(t){if((t%=2*drama.PI)<0)t+=2*drama.PI;return t},drama.to_clamped_degrees=function(t){return drama.clamp_angle_degrees(drama.to_degrees(t))},drama.to_clamped_radians=function(t){return drama.clamp_angle(drama.to_radians(t))},drama.angleTo=function(t,e,i,n){var r=i-t,o=n-e;return Math.atan2(o,r)},drama.angleDiff=function(t,e){if(t===e)return 0;var i=Math.sin(t),n=Math.cos(t),r=i*Math.sin(e)+n*Math.cos(e);if(1<=r)return 0;if(r<=-1)return drama.PI;else return Math.acos(r)},drama.angleRotate=function(t,e,i){var n=Math.sin(t),r=Math.cos(t),o=Math.sin(e),s=Math.cos(e);if(Math.acos(n*o+r*s)>i)if(0<r*o-n*s)return drama.clamp_angle(t+i);else return drama.clamp_angle(t-i);else return drama.clamp_angle(e)},drama.angleClockwise=function(t,e){var i=Math.sin(t);return Math.cos(t)*Math.sin(e)-i*Math.cos(e)<=0},drama.rotatePtAround=function(t,e,i,n,r,o){if(0===i)return o?t:e;var s=Math.sin(i),a=Math.cos(i),l=(t-=n)*s;return t=t*a-(e-=r)*s,e=e*a+l,t+=n,e+=r,o?t:e},drama.distanceTo=function(t,e,i,n){var r=i-t,o=n-e;return Math.sqrt(r*r+o*o)},drama.xor=function(t,e){return!t!=!e},drama.lerp=function(t,e,i){return t+(e-t)*i},drama.unlerp=function(t,e,i){if(t===e)return 0;else return(i-t)/(e-t)},drama.anglelerp=function(t,e,i){var n=drama.angleDiff(t,e);if(drama.angleClockwise(e,t))return t+n*i;else return t-n*i},drama.qarp=function(t,e,i,n){return drama.lerp(drama.lerp(t,e,n),drama.lerp(e,i,n),n)},drama.cubic=function(t,e,i,n,r){return drama.lerp(drama.qarp(t,e,i,r),drama.qarp(e,i,n,r),r)},drama.cosp=function(t,e,i){return(t+e+(t-e)*Math.cos(i*Math.PI))/2},drama.hasAnyOwnProperty=function(t){var e;for(e in t)if(t.hasOwnProperty(e))return!0;return!1},drama.wipe=function(t){var e;for(e in t)if(t.hasOwnProperty(e))delete t[e]};var c=+new Date;drama.performance_now=function(){if("undefined"!=typeof wx||"undefined"!=typeof tt)return Date.now()-c;if(void 0!==window.performance){var t=window.performance;if(void 0!==t.now)return t.now();else if(void 0!==t.webkitNow)return t.webkitNow();else if(void 0!==t.mozNow)return t.mozNow();else if(void 0!==t.msNow)return t.msNow()}return Date.now()-c};var u="undefined"!=typeof Set&&void 0!==Set.prototype.forEach;function h(){if(this.s=null,this.items=null,this.item_count=0,u)this.s=new Set;this.values_cache=[],this.cache_valid=!0,drama.seal(this)}h.prototype.contains=function(t){if(this.isEmpty())return!1;if(u)return this.s.has(t);else return this.items&&this.items.hasOwnProperty(t)},h.prototype.add=function(t){if(u){if(!this.s.has(t))this.s.add(t),this.cache_valid=!1}else{var e=t.toString(),i=this.items;if(!i)this.items={},this.items[e]=t,this.item_count=1,this.cache_valid=!1;else if(!i.hasOwnProperty(e))i[e]=t,this.item_count++,this.cache_valid=!1}},h.prototype.remove=function(t){if(!this.isEmpty())if(u){if(this.s.has(t))this.s.delete(t),this.cache_valid=!1}else if(this.items){var e=t.toString(),i=this.items;if(i.hasOwnProperty(e))delete i[e],this.item_count--,this.cache_valid=!1}},h.prototype.clear=function(){if(!this.isEmpty()){if(u)this.s.clear();else this.items=null,this.item_count=0;drama.clearArray(this.values_cache),this.cache_valid=!0}},h.prototype.isEmpty=function(){return 0===this.count()},h.prototype.count=function(){if(u)return this.s.size;else return this.item_count};var d=null,p=0;function f(t){d[p++]=t}h.prototype.update_cache=function(){if(!this.cache_valid){if(u)drama.clearArray(this.values_cache),d=this.values_cache,p=0,this.s.forEach(f),assert2(p===this.s.size,"ObjectSet cache mismatch: "+p+" iterations for set size "+this.s.size),d=null,p=0;else{var t,e=this.values_cache;drama.clearArray(e);var i=0,n=this.items;if(n)for(t in n)if(n.hasOwnProperty(t))e[i++]=n[t];assert2(i===this.item_count,"ObjectSet cache mismatch")}this.cache_valid=!0}},h.prototype.valuesRef=function(){return this.update_cache(),this.values_cache},drama.ObjectSet=h;var m=new drama.ObjectSet;function g(){this.c=0,this.y=0,this.t=0,this.sum=0,drama.seal(this)}function y(t){this.pts_cache=[],this.bboxLeft=0,this.bboxTop=0,this.bboxRight=0,this.bboxBottom=0,this.convexpolys=null,this.set_pts(t),drama.seal(this)}function v(t){this.pts_cache=[],this.set_pts(t),drama.seal(this)}function b(t,e){this.cellwidth=t,this.cellheight=e,this.cells={}}function _(t,e){this.cellwidth=t,this.cellheight=e,this.cells={}}drama.removeArrayDuplicates=function(t){var e,i;for(e=0,i=t.length;e<i;++e)m.add(t[e]);drama.shallowAssignArray(t,m.valuesRef()),m.clear()},drama.arrayRemoveAllFromObjectSet=function(t,e){if(u)drama.arrayRemoveAll_set(t,e.s);else drama.arrayRemoveAll_arr(t,e.valuesRef())},drama.arrayRemoveAll_set=function(t,e){var i,n,r,o;for(n=i=0,r=t.length;i<r;++i)if(o=t[i],!e.has(o))t[n++]=o;drama.truncateArray(t,n)},drama.arrayRemoveAll_arr=function(t,e){var i,n,r,o;for(n=i=0,r=t.length;i<r;++i)if(o=t[i],-1===drama.fastIndexOf(e,o))t[n++]=o;drama.truncateArray(t,n)},g.prototype.add=function(t){this.y=t-this.c,this.t=this.sum+this.y,this.c=this.t-this.sum-this.y,this.sum=this.t},g.prototype.reset=function(){this.c=0,this.y=0,this.t=0,this.sum=0},drama.KahanAdder=g,drama.regexp_escape=function(t){return t.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")},y.prototype.set_pts=function(t){this.pts_array=t,this.pts_count=t.length/2,this.pts_cache.length=t.length,this.cache_width=-1,this.cache_height=-1,this.cache_angle=0},y.prototype.is_empty=function(){return!this.pts_array.length},y.prototype.update_bbox=function(){for(var t,e,i,n=this.pts_cache,r=n[0],o=r,s=n[1],a=s,l=1,c=this.pts_count;l<c;++l){if((t=n[i=2*l])<r)r=t;if(o<t)o=t;if((e=n[i+1])<s)s=e;if(a<e)a=e}this.bboxLeft=r,this.bboxRight=o,this.bboxTop=s,this.bboxBottom=a},y.prototype.set_from_rect=function(t,e,i){this.pts_cache.length=8,this.pts_count=4;var n=this.pts_cache;n[0]=t.left-e,n[1]=t.top-i,n[2]=t.right-e,n[3]=t.top-i,n[4]=t.right-e,n[5]=t.bottom-i,n[6]=t.left-e,n[7]=t.bottom-i,this.cache_width=t.right-t.left,this.cache_height=t.bottom-t.top,this.update_bbox()},y.prototype.set_from_quad=function(t,e,i,n,r){this.pts_cache.length=8,this.pts_count=4;var o=this.pts_cache;o[0]=t.tlx-e,o[1]=t.tly-i,o[2]=t.trx-e,o[3]=t.try_-i,o[4]=t.brx-e,o[5]=t.bry-i,o[6]=t.blx-e,o[7]=t.bly-i,this.cache_width=n,this.cache_height=r,this.update_bbox()},y.prototype.set_from_poly=function(t){this.pts_count=t.pts_count,drama.shallowAssignArray(this.pts_cache,t.pts_cache),this.bboxLeft=t.bboxLeft,this.bboxTop,t.bboxTop,this.bboxRight=t.bboxRight,this.bboxBottom=t.bboxBottom},y.prototype.cache_poly=function(t,e,i){if(this.cache_width!==t||this.cache_height!==e||this.cache_angle!==i){var n,r,o,s,a,l;this.cache_width=t,this.cache_height=e,this.cache_angle=i;var c=0,u=1,h=this.pts_array,d=this.pts_cache;if(0!==i)c=Math.sin(i),u=Math.cos(i);for(n=0,s=this.pts_count;n<s;n++)o=(r=2*n)+1,a=h[r]*t,l=h[o]*e,d[r]=a*u-l*c,d[o]=l*u+a*c;this.update_bbox()}},y.prototype.contains_pt=function(t,e){var i,n,r,o=this.pts_cache;if(t===o[0]&&e===o[1])return!0;var s,a,l,c,u=this.pts_count,h=this.bboxLeft-110,d=this.bboxTop-101,p=this.bboxRight+131,f=this.bboxBottom+120,m=0,g=0;for(i=0;i<u;i++){if(r=(i+1)%u*2,s=o[n=2*i],a=o[n+1],l=o[r],c=o[r+1],drama.segments_intersect(h,d,t,e,s,a,l,c))m++;if(drama.segments_intersect(p,f,t,e,s,a,l,c))g++}return m%2==1||g%2==1},y.prototype.intersects_poly=function(t,e,i){var n,r,o,s,a,l,c,u,h,d,p,f,m,g,y,v,b=t.pts_cache,_=this.pts_cache;if(this.contains_pt(b[0]+e,b[1]+i))return!0;if(t.contains_pt(_[0]-e,_[1]-i))return!0;for(n=0,s=this.pts_count;n<s;n++)for(o=(n+1)%s*2,h=_[r=2*n],d=_[r+1],p=_[o],f=_[o+1],a=0,u=t.pts_count;a<u;a++)if(c=(a+1)%u*2,m=b[l=2*a]+e,g=b[l+1]+i,y=b[c]+e,v=b[c+1]+i,drama.segments_intersect(h,d,p,f,m,g,y,v))return!0;return!1},y.prototype.contains_pt_circle=function(t,e){var i,n,r,o,s,a,l,c,u=this.pts_cache,h=0;for(i=0,o=this.pts_count;i<o;i++)if(r=(i+1)%o*2,s=u[n=2*i],a=u[n+1],l=u[r],c=u[r+1],t>Math.min(s,l)&&t<=Math.max(s,l))if(e<=Math.max(a,c))if(s!=l)if(a==c||e<=(t-s)*(c-a)/(l-s)+a)h++;if(h%2==0)return!1;else return!0},y.prototype.intersects_poly_circle=function(t,e,i){var n,r,o,s,a,l,c,u,h=this.pts_cache,d=t.pts_cache;if(this.contains_pt_circle(d[0]+e,d[1]+i))return!0;var p=d[2];for(n=0,s=this.pts_count;n<s;n++)if(o=(n+1)%s*2,a=h[r=2*n],l=h[r+1],c=h[o],u=h[o+1],drama.circle_segments_intersect(a,l,c,u,d[0]+e,d[1]+i,p))return!0;return!1},y.prototype.intersects_segment=function(t,e,i,n,r,o){var s,a,l,c,u,h,d,p,f=this.pts_cache;if(this.contains_pt(i-t,n-e))return!0;for(s=0,a=this.pts_count;s<a;s++)if(c=(s+1)%a*2,u=f[l=2*s]+t,h=f[l+1]+e,d=f[c]+t,p=f[c+1]+e,drama.segments_intersect(i,n,r,o,u,h,d,p))return!0;return!1},y.prototype.mirror=function(t){var e,i,n;for(e=0,i=this.pts_count;e<i;++e)n=2*e,this.pts_cache[n]=2*t-this.pts_cache[n]},y.prototype.flip=function(t){var e,i,n;for(e=0,i=this.pts_count;e<i;++e)n=2*e+1,this.pts_cache[n]=2*t-this.pts_cache[n]},y.prototype.diag=function(){var t,e,i,n,r;for(t=0,e=this.pts_count;t<e;++t)n=(i=2*t)+1,r=this.pts_cache[i],this.pts_cache[i]=this.pts_cache[n],this.pts_cache[n]=r},drama.CollisionPoly=y,v.prototype.set_pts=function(t){this.pts_array=t,this.pts_cache.length=t.length,this.cache_width=-1,this.cache_height=-1,this.cache_angle=0},v.prototype.cache_circle=function(t,e,i){this.cache_width=t,this.cache_height=e,this.cache_angle=i;var n=this.pts_array,r=this.pts_cache,o=n[0]*t,s=n[1]*e;r[0]=o,r[1]=s,r[2]=n[2]*t/n[3]},v.prototype.intersects_circle=function(t,e,i){var n=this.pts_cache,r=t.pts_cache,o=n[0],s=n[1],a=r[0]+e,l=r[1]+i,c=n[2],u=r[2];if(drama.circle_intersect(o,s,c,a,l,u))return!0;else return!1},drama.CollisionCircle=v,b.prototype.totalCellCount=0,b.prototype.getCell=function(t,e,i){var n,r=this.cells[t];if(!r)if(i)return n=x(this,t,e),this.cells[t]={},this.cells[t][e]=n;else return null;if(n=r[e])return n;else if(i)return n=x(this,t,e),this.cells[t][e]=n;else return null},b.prototype.XToCell=function(t){return drama.floor(t/this.cellwidth)},b.prototype.YToCell=function(t){return drama.floor(t/this.cellheight)},b.prototype.update=function(t,e,i){var n,r,o,s,a;if(e)for(n=e.left,r=e.right;n<=r;++n)for(o=e.top,s=e.bottom;o<=s;++o)if(!i||!i.contains_pt(n,o))if(a=this.getCell(n,o,!1))if(a.remove(t),a.isEmpty())S(a),this.cells[n][o]=null;if(i)for(n=i.left,r=i.right;n<=r;++n)for(o=i.top,s=i.bottom;o<=s;++o)if(!e||!e.contains_pt(n,o))this.getCell(n,o,!0).insert(t)},b.prototype.queryRange=function(t,e){var i,n,r,o,s,a;for(i=this.XToCell(t.left),r=this.YToCell(t.top),n=this.XToCell(t.right),s=this.YToCell(t.bottom);i<=n;++i)for(o=r;o<=s;++o)if(a=this.getCell(i,o,!1))a.dump(e)},drama.SparseGrid=b,_.prototype.totalCellCount=0,_.prototype.getCell=function(t,e,i){var n,r=this.cells[t];if(!r)if(i)return n=C(this,t,e),this.cells[t]={},this.cells[t][e]=n;else return null;if(n=r[e])return n;else if(i)return n=C(this,t,e),this.cells[t][e]=n;else return null},_.prototype.XToCell=function(t){return drama.floor(t/this.cellwidth)},_.prototype.YToCell=function(t){return drama.floor(t/this.cellheight)},_.prototype.update=function(t,e,i){var n,r,o,s,a;if(e)for(n=e.left,r=e.right;n<=r;++n)for(o=e.top,s=e.bottom;o<=s;++o)if(!i||!i.contains_pt(n,o))if(a=this.getCell(n,o,!1))if(a.remove(t),a.isEmpty())O(a),this.cells[n][o]=null;if(i)for(n=i.left,r=i.right;n<=r;++n)for(o=i.top,s=i.bottom;o<=s;++o)if(!e||!e.contains_pt(n,o))this.getCell(n,o,!0).insert(t)},_.prototype.queryRange=function(t,e,i,n,r){var o,s,a,l,c,u;for(o=this.XToCell(t),a=this.YToCell(e),s=this.XToCell(i),c=this.YToCell(n);o<=s;++o)for(l=a;l<=c;++l)if(u=this.getCell(o,l,!1))u.dump(r)},_.prototype.markRangeChanged=function(t){var e,i,n,r,o,s;for(e=t.left,n=t.top,i=t.right,o=t.bottom;e<=i;++e)for(r=n;r<=o;++r)if(s=this.getCell(e,r,!1))s.is_sorted=!1},drama.RenderGrid=_;var w=[];function x(t,e,i){var n;if(b.prototype.totalCellCount++,w.length)return(n=w.pop()).grid=t,n.x=e,n.y=i,n;else return new drama.GridCell(t,e,i)}function S(t){if(b.prototype.totalCellCount--,t.objects.clear(),w.length<1e3)w.push(t)}function I(t,e,i){this.grid=t,this.x=e,this.y=i,this.objects=new drama.ObjectSet}I.prototype.isEmpty=function(){return this.objects.isEmpty()},I.prototype.insert=function(t){this.objects.add(t)},I.prototype.remove=function(t){this.objects.remove(t)},I.prototype.dump=function(t){drama.appendArray(t,this.objects.valuesRef())},drama.GridCell=I;var T=[];function C(t,e,i){var n;if(_.prototype.totalCellCount++,T.length)return(n=T.pop()).grid=t,n.x=e,n.y=i,n;else return new drama.RenderCell(t,e,i)}function O(t){if(_.prototype.totalCellCount--,t.reset(),T.length<1e3)T.push(t)}function P(t,e,i){this.grid=t,this.x=e,this.y=i,this.objects=[],this.is_sorted=!0,this.pending_removal=new drama.ObjectSet,this.any_pending_removal=!1}function E(t,e){return t.zindex-e.zindex}P.prototype.isEmpty=function(){if(!this.objects.length)return assert2(this.pending_removal.isEmpty(),"expected empty pending removal list"),assert2(!this.any_pending_removal,"expected no pending removal state"),!0;if(this.objects.length>this.pending_removal.count())return!1;else return assert2(this.objects.length===this.pending_removal.count(),"expected pending queue to be same size as object list"),this.flush_pending(),!0},P.prototype.insert=function(t){if(!this.pending_removal.contains(t)){if(this.objects.length){if(this.objects[this.objects.length-1].get_zindex()>t.get_zindex())this.is_sorted=!1;this.objects.push(t)}else this.objects.push(t),this.is_sorted=!0;assert2(this.objects.length,"render cell is empty")}else if(this.pending_removal.remove(t),this.pending_removal.isEmpty())this.any_pending_removal=!1},P.prototype.remove=function(t){if(this.pending_removal.add(t),this.any_pending_removal=!0,30<=this.pending_removal.count())this.flush_pending()},P.prototype.flush_pending=function(){if(assert2(this.objects.length,"render cell is empty"),this.any_pending_removal)if(this.pending_removal.count()!==this.objects.length)drama.arrayRemoveAllFromObjectSet(this.objects,this.pending_removal),this.pending_removal.clear(),this.any_pending_removal=!1;else this.reset()},P.prototype.ensure_sorted=function(){if(!this.is_sorted)this.objects.sort(E),this.is_sorted=!0},P.prototype.reset=function(){drama.clearArray(this.objects),this.is_sorted=!0,this.pending_removal.clear(),this.any_pending_removal=!1},P.prototype.dump=function(t){if(this.flush_pending(),this.ensure_sorted(),this.objects.length)t.push(this.objects)},drama.RenderCell=P;var A=["lighter","xor","copy","destination-over","source-in","destination-in","source-out","destination-out","source-atop","destination-atop"];drama.effectToCompositeOp=function(t){if(t<=0||11<=t)return"source-over";else return A[t-1]},drama.setGLBlend=function(t,e,i){if(i)switch(t.srcBlend=i.ONE,t.destBlend=i.ONE_MINUS_SRC_ALPHA,e){case 1:t.srcBlend=i.ONE,t.destBlend=i.ONE;break;case 2:break;case 3:t.srcBlend=i.ONE,t.destBlend=i.ZERO;break;case 4:t.srcBlend=i.ONE_MINUS_DST_ALPHA,t.destBlend=i.ONE;break;case 5:t.srcBlend=i.DST_ALPHA,t.destBlend=i.ZERO;break;case 6:t.srcBlend=i.ZERO,t.destBlend=i.SRC_ALPHA;break;case 7:t.srcBlend=i.ONE_MINUS_DST_ALPHA,t.destBlend=i.ZERO;break;case 8:t.srcBlend=i.ZERO,t.destBlend=i.ONE_MINUS_SRC_ALPHA;break;case 9:t.srcBlend=i.DST_ALPHA,t.destBlend=i.ONE_MINUS_SRC_ALPHA;break;case 10:t.srcBlend=i.ONE_MINUS_DST_ALPHA,t.destBlend=i.SRC_ALPHA}},drama.round6dp=function(t){return Math.round(1e6*t)/1e6},drama.equals_nocase=function(t,e){if("string"!=typeof t||"string"!=typeof e)return!1;if(t.length!==e.length)return!1;if(t===e)return!0;else return t.toLowerCase()===e.toLowerCase()},drama.cssToCamelCase=function(t){var e,i,n,r="",o=!1;for(e=0,i=t.length;e<i;++e)if("-"===(n=t.charAt(e)))o=!0;else if(o)r+=n.toUpperCase(),o=!1;else r+=n;return r},drama.isCanvasInputEvent=function(t){var e=t.target;if(!e)return!0;if(e===document||e===window)return!0;if(document&&document.body&&e===document.body)return!0;if(drama.equals_nocase(e.tagName,"canvas"))return!0;else return!1},drama.convertPageXY=function(t,e){var i=xfruntime.lastWindowWidth,n=xfruntime.lastWindowHeight,r=t||0,o=e||0,s=0,a=0;if(xfruntime.isForceLandScape&&2==xfruntime.orientations)r=t-i/2,o=e-n/2,s=Math.atan2(o,r),a=Math.sqrt(r*r+o*o),r=-(Math.round(a*Math.cos(s+Math.PI/2))-i/2),o=-(Math.round(a*Math.sin(s+Math.PI/2))-n/2);else if(xfruntime.isForcePortrait&&1==xfruntime.orientations)r=i/2-t,o=n/2-e,s=Math.atan2(o,r),a=Math.sqrt(r*r+o*o),r=-(Math.round(a*Math.cos(s+Math.PI/2))-i/2),o=-(Math.round(a*Math.sin(s+Math.PI/2))-n/2);return{pageX:r,pageY:o}},drama.getMoveDistance=function(t,e,i,n){var r,o;if(n=void 0!==n?n:!0,(i=drama.formatAngle(i))<90)r=i;else if(90<=i&&i<=270)r=Math.abs(180-i);else r=360-i;if(i<180)o=Math.abs(90-i);else o=Math.abs(270-i);var s,a=n&&r<=45||!n&&45<=o,l=a?90<=i&&i<=270:180<i;if(a)s=(e.x-t.x)/Math.cos(drama.to_radians(r));else s=(e.y-t.y)/Math.cos(drama.to_radians(o));return s*(l?-1:1)},drama.formatAngle=function(t){return t=360*Math.ceil(Math.abs(t)/360)+t,t%=360}}();var shownAssertAlert=!1;function assert2(t,e){if(!t){var i;try{throw Error(e)}catch(t){i=t.stack,window.Sentry&&Sentry.captureException(t)}var n="Assertion failure: "+e+"\n\nStack trace: \n"+i;if(shownAssertAlert)alert(n+"\n\nSubsequent failures will now be logged to the console.");if(console.error)console.error(n)}}function log(t,e){if("undefined"!=typeof console&&console.log&&-1===navigator.userAgent.indexOf("MSIE"))if("warn"===e&&console.warn)console.warn(t);else console.log(t)}function localStorage_getItem(t){try{return localStorage.getItem(t)}catch(t){return null}}function localStorage_setItem(t,e){try{localStorage.setItem(t,e)}catch(t){}}window.assert2=assert2,window.onerror=function(t,e,i,n){},window.log=log;var watch={};function LoadWatchItems(){watch=JSON.parse(localStorage_getItem("__watch")||"{}")}if("loading"===document.readyState)document.addEventListener("DOMContentLoaded",LoadWatchItems);else LoadWatchItems();function PostToDebugger(t){if(window.xf_postToMessagePort)t.from="runtime",window.xf_postToMessagePort(t)}var inspectInst=null,inspectSystem=!1,highlightEnabled=!0,currentMode="inspect";function IsDebuggerProfiling(){return"profile"===currentMode}function OnMessageFromDebugger(t){var e=t.type,i=window.xfruntime;if("inspectinstance"===e)OnInspectInstanceMessage(t);else if("add-watch"===e)OnAddWatchMessage(t);else if("add-watch-header"===e)OnAddWatchHeaderMessage(t);else if("remove-watch"===e)OnRemoveWatchMessage(t);else if("remove-watch-header"===e)OnRemoveWatchHeaderMessage(t);else if("editvalue"===e)OnEditValueMessage(t);else if("pause"===e)i.setSuspended(!0),UpdateInspectedInstance();else if("resume"===e)i.setSuspended(!1);else if("resumebreakpoint"===e)i.step_break=!1,i.debugResume();else if("step"===e)OnStep();else if("save"===e)OnSaveMessage();else if("load"===e)OnLoadMessage();else if("highlight"===e)highlightEnabled=t.enabled;else if("switchtab"===e)OnSwitchTabMessage(t);else if("restart"===e)window.location.reload(!0);else if("destroy-inspect-inst"===e){if(inspectInst)i.DestroyInstance(inspectInst)}else if("update-breakpoint"===e)OnBreakpointUpdate(t);else if("repostinit"===e)DebuggerInit(i);else console.warn("[Runtime] Unknown message from debugger: '"+e+"'")}if(window.xf_addPortMessageHandler)window.xf_addPortMessageHandler(OnMessageFromDebugger);function OnInspectInstanceMessage(t){currentMode="inspect";var e=window.xfruntime,i=t.typename;if("System"===i)inspectSystem=!(inspectInst=null);else if(highlightEnabled=!0,t.hasOwnProperty("uid"))inspectInst=e.getObjectByUID(t.uid),inspectSystem=!1;else{var n=e.types[i],r=t.iid;if(n&&0<=r&&r<n.instances.length)inspectInst=n.instances[r],inspectSystem=!1}UpdateInspectedInstance()}function OnAddWatchMessage(t){OnAddToWatch(t.headerTitle,t.propertyName),UpdateInspectedInstance(),localStorage_setItem("__watch",JSON.stringify(watch))}function OnAddWatchHeaderMessage(t){OnAddToWatchHeader(t.headerTitle,t.propertyNames),UpdateInspectedInstance(),localStorage_setItem("__watch",JSON.stringify(watch))}function OnRemoveWatchMessage(t){OnRemoveFromWatch(t.headerTitle,t.displayTitle,t.propertyName),UpdateInspectedInstance(),localStorage_setItem("__watch",JSON.stringify(watch))}function OnRemoveWatchHeaderMessage(t){OnRemoveFromWatchHeader(t.headerTitle,t.displayTitle),UpdateInspectedInstance(),localStorage_setItem("__watch",JSON.stringify(watch))}function OnEditValueMessage(t){OnDebugValueEdited(t.header,t.displayHeader,t.name,t.value),UpdateInspectedInstance()}function OnSaveMessage(){var t=window.xfruntime;if(t.saveToSlot="___debuggerslot",t.isSuspended)t.last_tick_time=drama.performance_now(),t.tick(!1)}function OnLoadMessage(){var t=window.xfruntime;if(t.loadFromSlot="___debuggerslot",t.isSuspended)t.last_tick_time=drama.performance_now(),t.tick(!1)}function OnSwitchTabMessage(t){currentMode=t.mode}function GetDebuggerPropertiesForUID(t,e){var i=window.xfruntime;if(i){var n,r,o,s=[],a=[];for(drama.shallowAssignArray(a,i.all_global_vars),n=0,r=a.length;n<r;++n)o=a[n],s.push({name:o.name,value:o.data});if(s.length)e.push({title:["system.global-variables"],properties:s});if(-1===t)i.system.getDebuggerValues(e);else{var l=i.getObjectByUID(t);if(!l)return;if(e.push({title:["common-props.common.title"],properties:[{name:["common-props.common.name"],value:l.type.name,readonly:!0},{name:["common-props.common.uid"],value:l.uid,readonly:!0},{name:["common-props.common.iid"],value:l.get_iid(),readonly:!0}]}),l.type.plugin.is_world)e.push({title:["common-props.layout.title"],properties:[{name:["common-props.layout.x"],value:~~l.x},{name:["common-props.layout.y"],value:~~l.y},{name:["common-props.layout.width"],value:~~l.width},{name:["common-props.layout.height"],value:~~l.height},{name:["common-props.layout.angle"],value:~~drama.to_degrees(l.angle)},{name:["common-props.layout.opacity"],value:100*l.opacity},{name:["common-props.layout.visible"],value:l.visible},{name:["common-props.layout.layer"],value:l.layer.name,readonly:!0},{name:["common-props.layout.z-index"],value:l.get_zindex(),readonly:!0},{name:["common-props.layout.collisions-enabled"],value:l.collisionsEnabled}]});if(l.type.plugin.is_slide)e.push({title:["common-props.layout.title"],properties:[{name:["common-props.layout.MovingTargetX"],value:~~(l.slideTargetX?l.slideTargetX:l.x)},{name:["common-props.layout.MovingTargetY"],value:~~(l.slideTargetY?l.slideTargetY:l.y)},{name:["common-props.layout.MovingSpeed"],value:~~(l.speed?l.speed:0)},{name:["common-props.layout.MovingAngle"],value:~~l.slideAngle}]});var c=[];if(l.instance_vars&&l.instance_vars.length){for(var u=0,h=l.instance_vars.length;u<h;++u)c.push({name:l.instance_var_names[u],value:l.instance_vars[u]});e.push({title:["common-props.instance-variables"],properties:c})}if(l.behavior_insts&&l.behavior_insts.length)for(var d=0,p=l.behavior_insts.length;d<p;++d){var f=l.behavior_insts[d];if(f.getDebuggerValues)f.getDebuggerValues(e)}if(l.getDebuggerValues)l.getDebuggerValues(e)}}}function UpdateInspectedInstance(){if(DebuggerShowInspectInstance(),"inspect"===currentMode){var t=[];if(inspectSystem)GetDebuggerPropertiesForUID(-1,t),PostToDebugger({type:"inst-inspect",is_world:!1,sections:t});else if(inspectInst){GetDebuggerPropertiesForUID(inspectInst.uid,t);var e=[];if(inspectInst.siblings)for(var i=0,n=inspectInst.siblings.length;i<n;++i)e.push({typename:inspectInst.siblings[i].type.name,uid:inspectInst.siblings[i].uid});PostToDebugger({type:"inst-inspect",is_world:inspectInst.type.plugin.is_world,siblings:e,sections:t})}}else if("watch"===currentMode){var r=[],o=window.xfruntime;if(!o)return;for(var s in watch){var a=null;if("-1"!==s)if(!(a=o.getObjectByUID(parseInt(s,10)))){delete watch[s];continue}var l=[];GetDebuggerPropertiesForUID(parseInt(s,10),l);for(var c=watch[s],u=0,h=l.length;u<h;++u){var d=l[u],p=d.title;if(Array.isArray(p))p="$"+p.join(",");if(c.hasOwnProperty(p)){for(var f=c[p],m=[],g=0,y=d.properties.length;g<y;++g){var v=d.properties[g],b=v.name;if(Array.isArray(b))b=b.join(",");if(-1<f.indexOf(b))m.push(v)}if(m.length){var _={title:["-1"===s?"$system-object-name":"$watch.instance-uid,"+a.type.name+","+s,": ",p],originalTitle:p,properties:m};r.push(_)}}}}PostToDebugger({type:"watch-inspect",sections:r})}}function OnDebugValueEdited(t,e,i,n){if("$"===t.charAt(0))t=t.substr(1);var r=window.xfruntime,o=inspectSystem,s=inspectInst;if("watch"===currentMode){var a=GetUidFromTitle(e);if(-1===a)o=!0,s=null;else if(r){if(o=!1,!(s=r.getObjectByUID(a)))return}else return}if(r)r.redraw=!0;if(o){if(r)r.system.onDebugValueEdited(t,i,n)}else if(s){if("common-props.layout.title"===t)switch(i){case"common-props.layout.x":return s.x=n,void s.set_bbox_changed();case"common-props.layout.y":return s.y=n,void s.set_bbox_changed();case"common-props.layout.slideTargetX":return s.slideTargetX=n,void s.set_bbox_changed();case"common-props.layout.slideTargetY":return s.slideTargetY=n,void s.set_bbox_changed();case"common-props.layout.width":return s.width=n,void s.set_bbox_changed();case"common-props.layout.height":return s.height=n,void s.set_bbox_changed();case"common-props.layout.angle":return s.angle=drama.to_radians(n),void s.set_bbox_changed();case"common-props.layout.opacity":return void(s.opacity=drama.clamp(n/100,0,1));case"common-props.layout.visible":return s.visible=n,void(s.runtime.redraw=!0);case"common-props.layout.collisions-enabled":return void(s.collisionsEnabled=n)}else if("common-props.instance-variables"===t)for(var l=0,c=s.instance_var_names.length;l<c;++l){if(s.instance_var_names[l]===i)return void(s.instance_vars[l]=n)}if(s.behavior_insts)for(var u=0,h=s.behavior_insts.length;u<h;++u){var d=s.behavior_insts[u];if(d.type.name===t)if(d.onDebugValueEdited)return void d.onDebugValueEdited(t,i,n)}if(s.onDebugValueEdited)s.onDebugValueEdited(t,i,n)}}function SortNameAZ(t,e){var i=t.name.toLowerCase(),n=e.name.toLowerCase();if(n<i)return 1;if(i<n)return-1;else return 0}function DebuggerLoadingProgress(t){PostToDebugger({type:"loadingprogress",progress:t})}function DebuggerInit(t){var e,i,n,r=[],o=[];for(drama.shallowAssignArray(o,t.types_by_index),o.sort(SortNameAZ),e=0,i=o.length;e<i;++e)n=o[e],r.push({name:n.name,world:n.plugin.is_world,singleglobal:n.plugin.singleglobal,instances:n.instances.length});if(PostToDebugger({type:"init",paused:t.isSuspended,objects:r}),!inspectInst)inspectSystem=!0}function DebuggerOnHitBreakpoint(t){PostToDebugger(Object.assign({type:"hit-breakpoint"},t))}function DebuggerOnResume(t){PostToDebugger(Object.assign({type:"debug-resume"},t))}function DebuggerSuspended(t,e,i){PostToDebugger({type:"suspend",suspended:t,hit_breakpoint:e,hit_event:i})}function DebuggerFullscreen(t){PostToDebugger({type:"fullscreen",enabled:t})}function DebuggerPerfStats(t,e,i,n,r,o,s,a,l,c){PostToDebugger({type:"perfstats",fps:t,cpu:e,gpu:i,mem:n,renderer:r,objectcount:o,rendercpu:s,eventscpu:a,physicscpu:l,sheets_perf:c})}function DebuggerInstanceCreated(t){for(var e=[t.type.name],i=0,n=t.type.families.length;i<n;++i)e.push(t.type.families[i].name);PostToDebugger({type:"inst-create",uid:t.uid,names:e})}function DebuggerInstanceDestroyed(t){var e=!1;if(inspectInst&&inspectInst.uid===t.uid)e=!(inspectInst=null);for(var i=[t.type.name],n=0,r=t.type.families.length;n<r;++n)i.push(t.type.families[n].name);PostToDebugger({type:"inst-destroy",names:i,uid:t.uid,"was-inspecting":e})}window.setInterval(UpdateInspectedInstance,100);var inspectOutlineElem=null;function DebuggerShowInspectInstance(){if(inspectInst&&highlightEnabled&&"inspect"===currentMode&&inspectInst.type.plugin.is_world){if(!inspectOutlineElem)(inspectOutlineElem=document.createElement("div")).id="inspect-outline",document.body.appendChild(inspectOutlineElem);inspectInst.update_bbox();var t=inspectInst.layer,e=inspectInst.bbox,i=t.layerToCanvas(e.left,e.top,!0),n=t.layerToCanvas(e.left,e.top,!1),r=t.layerToCanvas(e.right,e.bottom,!0),o=t.layerToCanvas(e.right,e.bottom,!1),s=drama.min(i,r)-2,a=drama.min(n,o)-2,l=drama.max(i,r)-s-2,c=drama.max(n,o)-a-2,u=window.xfcanvas.getBoundingClientRect();inspectOutlineElem.style.display="",inspectOutlineElem.style.left=s+u.left+"px",inspectOutlineElem.style.top=a+u.top+"px",inspectOutlineElem.style.width=l+"px",inspectOutlineElem.style.height=c+"px",inspectOutlineElem.textContent=inspectInst.type.name+" #"+inspectInst.get_iid()}else if(inspectOutlineElem)inspectOutlineElem.style.display="none"}function OnAddToWatch(t,e){if(inspectInst||inspectSystem){var i=inspectInst?inspectInst.uid:-1;if(watch.hasOwnProperty(i.toString())){var n=watch[i.toString()];if(n.hasOwnProperty(t)){var r=n[t];if(-1===r.indexOf(e))r.push(e)}else n[t]=[e]}else{var o=[e],s={};s[t]=o,watch[i.toString()]=s}}}function OnAddToWatchHeader(t,e){if(inspectInst||inspectSystem){var i=inspectInst?inspectInst.uid:-1;if(watch.hasOwnProperty(i.toString())){watch[i.toString()][t]=e}else{var n={};n[t]=e,watch[i.toString()]=n}}}function GetUidFromTitle(t){var e=t.indexOf(": "),i=t.substr(0,e).split(" ");if(i.length<=1)return-1;else return parseInt(i[i.length-1],10)}function OnRemoveFromWatch(t,e,i){var n=GetUidFromTitle(e);if(watch.hasOwnProperty(n.toString())){var r=watch[n.toString()];if(r.hasOwnProperty(t)){var o=r[t];if(drama.arrayFindRemove(o,i),!o.length)if(delete r[t],!drama.hasAnyOwnProperty(r))delete watch[n.toString()]}}}function OnRemoveFromWatchHeader(t,e){var i=GetUidFromTitle(e);if(watch.hasOwnProperty(i.toString())){var n=watch[i.toString()];if("$"===t.charAt(0))t=t.substr(1);if(n.hasOwnProperty(t))delete n[t]}}function OnBreakpointUpdate(t){var e=t.sheet,i=t.eventNumber,n=t.cndIndex,r=t.actIndex,o=t.isBreakpoint,s=window.xfruntime;if(s&&s.isDebug){var a=s.eventsheets[e];if(a){var l=a.events_by_number[i];if(l&&l.is_breakable)if(-1<n){if(l.conditions&&n<l.conditions.length)l.conditions[n].is_breakpoint=o,console.log((o?"Set":"Unset")+" breakpoint at '"+e+"' event "+i+" condition "+(n+1))}else if(-1<r){if(l.actions&&r<l.actions.length)l.actions[r].is_breakpoint=o,console.log((o?"Set":"Unset")+" breakpoint at '"+e+"' event "+i+" action "+(r+1))}else l.is_breakpoint=o,console.log((o?"Set":"Unset")+" breakpoint at '"+e+"' event "+i)}}}function OnStep(){var t=window.xfruntime;if(t)if(t.hit_breakpoint)t.step_break=!0,t.debugResume();else if(t.isSuspended)t.last_tick_time=drama.performance_now()-1e3/60,t.tick(!1,null,!0)}document.addEventListener("keydown",function(t){if(121===t.which)OnStep(),t.preventDefault()});var MatrixArray="undefined"!=typeof Float32Array?Float32Array:Array,glMatrixArrayType=MatrixArray,vec3={},mat3={},mat4={},quat4={};function _typeof(t){if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator)_typeof=function(t){return typeof t};else _typeof=function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};return _typeof(t)}function _typeof(t){if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator)_typeof=function(t){return typeof t};else _typeof=function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};return _typeof(t)}vec3.create=function(t){var e=new MatrixArray(3);return t&&(e[0]=t[0],e[1]=t[1],e[2]=t[2]),e},vec3.set=function(t,e){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},vec3.add=function(t,e,i){if(!i||t===i)return t[0]+=e[0],t[1]+=e[1],t[2]+=e[2],t;else return i[0]=t[0]+e[0],i[1]=t[1]+e[1],i[2]=t[2]+e[2],i},vec3.subtract=function(t,e,i){if(!i||t===i)return t[0]-=e[0],t[1]-=e[1],t[2]-=e[2],t;else return i[0]=t[0]-e[0],i[1]=t[1]-e[1],i[2]=t[2]-e[2],i},vec3.negate=function(t,e){return e||(e=t),e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e},vec3.scale=function(t,e,i){if(!i||t===i)return t[0]*=e,t[1]*=e,t[2]*=e,t;else return i[0]=t[0]*e,i[1]=t[1]*e,i[2]=t[2]*e,i},vec3.normalize=function(t,e){e||(e=t);var i=t[0],n=t[1],r=t[2],o=Math.sqrt(i*i+n*n+r*r);if(o){if(1===o)return e[0]=i,e[1]=n,e[2]=r,e}else return e[0]=0,e[1]=0,e[2]=0,e;return o=1/o,e[0]=i*o,e[1]=n*o,e[2]=r*o,e},vec3.cross=function(t,e,i){i||(i=t);var n=t[0],r=t[1],o=(t=t[2],e[0]),s=e[1];e=e[2];return i[0]=r*e-t*s,i[1]=t*o-n*e,i[2]=n*s-r*o,i},vec3.length=function(t){var e=t[0],i=t[1];t=t[2];return Math.sqrt(e*e+i*i+t*t)},vec3.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]},vec3.direction=function(t,e,i){i||(i=t);var n=t[0]-e[0],r=t[1]-e[1];t=t[2]-e[2];if(!(e=Math.sqrt(n*n+r*r+t*t)))return i[0]=0,i[1]=0,i[2]=0,i;else return e=1/e,i[0]=n*e,i[1]=r*e,i[2]=t*e,i},vec3.lerp=function(t,e,i,n){return n||(n=t),n[0]=t[0]+i*(e[0]-t[0]),n[1]=t[1]+i*(e[1]-t[1]),n[2]=t[2]+i*(e[2]-t[2]),n},vec3.str=function(t){return"["+t[0]+", "+t[1]+", "+t[2]+"]"},mat3.create=function(t){var e=new MatrixArray(9);return t&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8]),e},mat3.set=function(t,e){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},mat3.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},mat3.transpose=function(t,e){if(e&&t!==e)return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],e;var i=t[1],n=t[2],r=t[5];return t[1]=t[3],t[2]=t[6],t[3]=i,t[5]=t[7],t[6]=n,t[7]=r,t},mat3.toMat4=function(t,e){return e||(e=mat4.create()),e[15]=1,e[14]=0,e[13]=0,e[12]=0,e[11]=0,e[10]=t[8],e[9]=t[7],e[8]=t[6],e[7]=0,e[6]=t[5],e[5]=t[4],e[4]=t[3],e[3]=0,e[2]=t[2],e[1]=t[1],e[0]=t[0],e},mat3.str=function(t){return"["+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+"]"},mat4.create=function(t){var e=new MatrixArray(16);return t&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e},mat4.set=function(t,e){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},mat4.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},mat4.transpose=function(t,e){if(e&&t!==e)return e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15],e;var i=t[1],n=t[2],r=t[3],o=t[6],s=t[7],a=t[11];return t[1]=t[4],t[2]=t[8],t[3]=t[12],t[4]=i,t[6]=t[9],t[7]=t[13],t[8]=n,t[9]=o,t[11]=t[14],t[12]=r,t[13]=s,t[14]=a,t},mat4.determinant=function(t){var e=t[0],i=t[1],n=t[2],r=t[3],o=t[4],s=t[5],a=t[6],l=t[7],c=t[8],u=t[9],h=t[10],d=t[11],p=t[12],f=t[13],m=t[14];return p*u*a*r-c*f*a*r-p*s*h*r+o*f*h*r+c*s*m*r-o*u*m*r-p*u*n*l+c*f*n*l+p*i*h*l-e*f*h*l-c*i*m*l+e*u*m*l+p*s*n*d-o*f*n*d-p*i*a*d+e*f*a*d+o*i*m*d-e*s*m*d-c*s*n*(t=t[15])+o*u*n*t+c*i*a*t-e*u*a*t-o*i*h*t+e*s*h*t},mat4.inverse=function(t,e){e||(e=t);var i=t[0],n=t[1],r=t[2],o=t[3],s=t[4],a=t[5],l=t[6],c=t[7],u=t[8],h=t[9],d=t[10],p=t[11],f=t[12],m=t[13],g=t[14],y=t[15],v=i*a-n*s,b=i*l-r*s,_=i*c-o*s,w=n*l-r*a,x=n*c-o*a,S=r*c-o*l,I=u*m-h*f,T=u*g-d*f,C=u*y-p*f,O=h*g-d*m,P=h*y-p*m,E=d*y-p*g,A=1/(v*E-b*P+_*O+w*C-x*T+S*I);return e[0]=(a*E-l*P+c*O)*A,e[1]=(-n*E+r*P-o*O)*A,e[2]=(m*S-g*x+y*w)*A,e[3]=(-h*S+d*x-p*w)*A,e[4]=(-s*E+l*C-c*T)*A,e[5]=(i*E-r*C+o*T)*A,e[6]=(-f*S+g*_-y*b)*A,e[7]=(u*S-d*_+p*b)*A,e[8]=(s*P-a*C+c*I)*A,e[9]=(-i*P+n*C-o*I)*A,e[10]=(f*x-m*_+y*v)*A,e[11]=(-u*x+h*_-p*v)*A,e[12]=(-s*O+a*T-l*I)*A,e[13]=(i*O-n*T+r*I)*A,e[14]=(-f*w+m*b-g*v)*A,e[15]=(u*w-h*b+d*v)*A,e},mat4.toRotationMat=function(t,e){return e||(e=mat4.create()),e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},mat4.toMat3=function(t,e){return e||(e=mat3.create()),e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e},mat4.toInverseMat3=function(t,e){var i=t[0],n=t[1],r=t[2],o=t[4],s=t[5],a=t[6],l=t[8],c=t[9],u=t[10],h=u*s-a*c,d=-u*o+a*l,p=c*o-s*l,f=i*h+n*d+r*p;if(!f)return null;else return f=1/f,e||(e=mat3.create()),e[0]=h*f,e[1]=(-u*n+r*c)*f,e[2]=(a*n-r*s)*f,e[3]=d*f,e[4]=(u*i-r*l)*f,e[5]=(-a*i+r*o)*f,e[6]=p*f,e[7]=(-c*i+n*l)*f,e[8]=(s*i-n*o)*f,e},mat4.multiply=function(t,e,i){i||(i=t);var n=t[0],r=t[1],o=t[2],s=t[3],a=t[4],l=t[5],c=t[6],u=t[7],h=t[8],d=t[9],p=t[10],f=t[11],m=t[12],g=t[13],y=t[14],v=(t=t[15],e[0]),b=e[1],_=e[2],w=e[3],x=e[4],S=e[5],I=e[6],T=e[7],C=e[8],O=e[9],P=e[10],E=e[11],A=e[12],k=e[13],M=e[14];e=e[15];return i[0]=v*n+b*a+_*h+w*m,i[1]=v*r+b*l+_*d+w*g,i[2]=v*o+b*c+_*p+w*y,i[3]=v*s+b*u+_*f+w*t,i[4]=x*n+S*a+I*h+T*m,i[5]=x*r+S*l+I*d+T*g,i[6]=x*o+S*c+I*p+T*y,i[7]=x*s+S*u+I*f+T*t,i[8]=C*n+O*a+P*h+E*m,i[9]=C*r+O*l+P*d+E*g,i[10]=C*o+O*c+P*p+E*y,i[11]=C*s+O*u+P*f+E*t,i[12]=A*n+k*a+M*h+e*m,i[13]=A*r+k*l+M*d+e*g,i[14]=A*o+k*c+M*p+e*y,i[15]=A*s+k*u+M*f+e*t,i},mat4.multiplyVec3=function(t,e,i){i||(i=e);var n=e[0],r=e[1];e=e[2];return i[0]=t[0]*n+t[4]*r+t[8]*e+t[12],i[1]=t[1]*n+t[5]*r+t[9]*e+t[13],i[2]=t[2]*n+t[6]*r+t[10]*e+t[14],i},mat4.multiplyVec4=function(t,e,i){i||(i=e);var n=e[0],r=e[1],o=e[2];e=e[3];return i[0]=t[0]*n+t[4]*r+t[8]*o+t[12]*e,i[1]=t[1]*n+t[5]*r+t[9]*o+t[13]*e,i[2]=t[2]*n+t[6]*r+t[10]*o+t[14]*e,i[3]=t[3]*n+t[7]*r+t[11]*o+t[15]*e,i},mat4.translate=function(t,e,i){var n,r,o,s,a,l,c,u,h,d,p,f,m=e[0],g=e[1];e=e[2];if(!i||t===i)return t[12]=t[0]*m+t[4]*g+t[8]*e+t[12],t[13]=t[1]*m+t[5]*g+t[9]*e+t[13],t[14]=t[2]*m+t[6]*g+t[10]*e+t[14],t[15]=t[3]*m+t[7]*g+t[11]*e+t[15],t;else return n=t[0],r=t[1],o=t[2],s=t[3],a=t[4],l=t[5],c=t[6],u=t[7],h=t[8],d=t[9],p=t[10],f=t[11],i[0]=n,i[1]=r,i[2]=o,i[3]=s,i[4]=a,i[5]=l,i[6]=c,i[7]=u,i[8]=h,i[9]=d,i[10]=p,i[11]=f,i[12]=n*m+a*g+h*e+t[12],i[13]=r*m+l*g+d*e+t[13],i[14]=o*m+c*g+p*e+t[14],i[15]=s*m+u*g+f*e+t[15],i},mat4.scale=function(t,e,i){var n=e[0],r=e[1];e=e[2];if(!i||t===i)return t[0]*=n,t[1]*=n,t[2]*=n,t[3]*=n,t[4]*=r,t[5]*=r,t[6]*=r,t[7]*=r,t[8]*=e,t[9]*=e,t[10]*=e,t[11]*=e,t;else return i[0]=t[0]*n,i[1]=t[1]*n,i[2]=t[2]*n,i[3]=t[3]*n,i[4]=t[4]*r,i[5]=t[5]*r,i[6]=t[6]*r,i[7]=t[7]*r,i[8]=t[8]*e,i[9]=t[9]*e,i[10]=t[10]*e,i[11]=t[11]*e,i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15],i},mat4.rotate=function(t,e,i,n){var r,o,s,a,l,c,u,h,d,p,f,m,g,y,v,b,_,w,x,S,I=i[0],T=i[1],C=(i=i[2],Math.sqrt(I*I+T*T+i*i));if(!C)return null;else return 1!==C&&(I*=C=1/C,T*=C,i*=C),r=Math.sin(e),s=1-(o=Math.cos(e)),e=t[0],C=t[1],a=t[2],l=t[3],c=t[4],u=t[5],h=t[6],d=t[7],p=t[8],f=t[9],m=t[10],g=t[11],y=I*I*s+o,v=T*I*s+i*r,b=i*I*s-T*r,_=I*T*s-i*r,w=T*T*s+o,x=i*T*s+I*r,S=I*i*s+T*r,I=T*i*s-I*r,T=i*i*s+o,n?t!==n&&(n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15]):n=t,n[0]=e*y+c*v+p*b,n[1]=C*y+u*v+f*b,n[2]=a*y+h*v+m*b,n[3]=l*y+d*v+g*b,n[4]=e*_+c*w+p*x,n[5]=C*_+u*w+f*x,n[6]=a*_+h*w+m*x,n[7]=l*_+d*w+g*x,n[8]=e*S+c*I+p*T,n[9]=C*S+u*I+f*T,n[10]=a*S+h*I+m*T,n[11]=l*S+d*I+g*T,n},mat4.rotateX=function(t,e,i){var n=Math.sin(e),r=(e=Math.cos(e),t[4]),o=t[5],s=t[6],a=t[7],l=t[8],c=t[9],u=t[10],h=t[11];return i?t!==i&&(i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15]):i=t,i[4]=r*e+l*n,i[5]=o*e+c*n,i[6]=s*e+u*n,i[7]=a*e+h*n,i[8]=r*-n+l*e,i[9]=o*-n+c*e,i[10]=s*-n+u*e,i[11]=a*-n+h*e,i},mat4.rotateY=function(t,e,i){var n=Math.sin(e),r=(e=Math.cos(e),t[0]),o=t[1],s=t[2],a=t[3],l=t[8],c=t[9],u=t[10],h=t[11];return i?t!==i&&(i[4]=t[4],i[5]=t[5],i[6]=t[6],i[7]=t[7],i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15]):i=t,i[0]=r*e+l*-n,i[1]=o*e+c*-n,i[2]=s*e+u*-n,i[3]=a*e+h*-n,i[8]=r*n+l*e,i[9]=o*n+c*e,i[10]=s*n+u*e,i[11]=a*n+h*e,i},mat4.rotateZ=function(t,e,i){var n=Math.sin(e),r=(e=Math.cos(e),t[0]),o=t[1],s=t[2],a=t[3],l=t[4],c=t[5],u=t[6],h=t[7];return i?t!==i&&(i[8]=t[8],i[9]=t[9],i[10]=t[10],i[11]=t[11],i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15]):i=t,i[0]=r*e+l*n,i[1]=o*e+c*n,i[2]=s*e+u*n,i[3]=a*e+h*n,i[4]=r*-n+l*e,i[5]=o*-n+c*e,i[6]=s*-n+u*e,i[7]=a*-n+h*e,i},mat4.frustum=function(t,e,i,n,r,o,s){s||(s=mat4.create());var a=e-t,l=n-i,c=o-r;return s[0]=2*r/a,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=2*r/l,s[6]=0,s[7]=0,s[8]=(e+t)/a,s[9]=(n+i)/l,s[10]=-(o+r)/c,s[11]=-1,s[12]=0,s[13]=0,s[14]=-o*r*2/c,s[15]=0,s},mat4.perspective=function(t,e,i,n,r){return e*=t=i*Math.tan(t*Math.PI/360),mat4.frustum(-e,e,-t,t,i,n,r)},mat4.ortho=function(t,e,i,n,r,o,s){s||(s=mat4.create());var a=e-t,l=n-i,c=o-r;return s[0]=2/a,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=2/l,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=-2/c,s[11]=0,s[12]=-(t+e)/a,s[13]=-(n+i)/l,s[14]=-(o+r)/c,s[15]=1,s},mat4.lookAt=function(t,e,i,n){var r,o,s,a,l,c,u,h;n||(n=mat4.create());var d=t[0],p=t[1];t=t[2];if(o=i[0],s=i[1],r=i[2],i=e[1],c=e[2],d===e[0]&&p===i&&t===c)return mat4.identity(n);else return i=d-e[0],c=p-e[1],u=t-e[2],e=s*(u*=h=1/Math.sqrt(i*i+c*c+u*u))-r*(c*=h),r=r*(i*=h)-o*u,o=o*c-s*i,(h=Math.sqrt(e*e+r*r+o*o))?(e*=h=1/h,r*=h,o*=h):o=r=e=0,s=c*o-u*r,a=u*e-i*o,l=i*r-c*e,(h=Math.sqrt(s*s+a*a+l*l))?(s*=h=1/h,a*=h,l*=h):l=a=s=0,n[0]=e,n[1]=s,n[2]=i,n[3]=0,n[4]=r,n[5]=a,n[6]=c,n[7]=0,n[8]=o,n[9]=l,n[10]=u,n[11]=0,n[12]=-(e*d+r*p+o*t),n[13]=-(s*d+a*p+l*t),n[14]=-(i*d+c*p+u*t),n[15]=1,n},mat4.fromRotationTranslation=function(t,e,i){i||(i=mat4.create());var n=t[0],r=t[1],o=t[2],s=t[3],a=n+n,l=r+r,c=o+o,u=(t=n*a,n*l);n*=c;var h=r*l;return r*=c,o*=c,a*=s,l*=s,s*=c,i[0]=1-(h+o),i[1]=u+s,i[2]=n-l,i[3]=0,i[4]=u-s,i[5]=1-(t+o),i[6]=r+a,i[7]=0,i[8]=n+l,i[9]=r-a,i[10]=1-(t+h),i[11]=0,i[12]=e[0],i[13]=e[1],i[14]=e[2],i[15]=1,i},mat4.str=function(t){return"["+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+"]"},quat4.create=function(t){var e=new MatrixArray(4);return t&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3]),e},quat4.set=function(t,e){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},quat4.calculateW=function(t,e){var i=t[0],n=t[1],r=t[2];if(!e||t===e)return t[3]=-Math.sqrt(Math.abs(1-i*i-n*n-r*r)),t;else return e[0]=i,e[1]=n,e[2]=r,e[3]=-Math.sqrt(Math.abs(1-i*i-n*n-r*r)),e},quat4.inverse=function(t,e){if(!e||t===e)return t[0]*=-1,t[1]*=-1,t[2]*=-1,t;else return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e},quat4.length=function(t){var e=t[0],i=t[1],n=t[2];t=t[3];return Math.sqrt(e*e+i*i+n*n+t*t)},quat4.normalize=function(t,e){e||(e=t);var i=t[0],n=t[1],r=t[2],o=t[3],s=Math.sqrt(i*i+n*n+r*r+o*o);if(0===s)return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e;else return s=1/s,e[0]=i*s,e[1]=n*s,e[2]=r*s,e[3]=o*s,e},quat4.multiply=function(t,e,i){i||(i=t);var n=t[0],r=t[1],o=t[2],s=(t=t[3],e[0]),a=e[1],l=e[2];e=e[3];return i[0]=n*e+t*s+r*l-o*a,i[1]=r*e+t*a+o*s-n*l,i[2]=o*e+t*l+n*a-r*s,i[3]=t*e-n*s-r*a-o*l,i},quat4.multiplyVec3=function(t,e,i){i||(i=e);var n=e[0],r=e[1],o=e[2],s=(e=t[0],t[1]),a=t[2],l=(t=t[3])*n+s*o-a*r,c=t*r+a*n-e*o,u=t*o+e*r-s*n;n=-e*n-s*r-a*o;return i[0]=l*t+n*-e+c*-a-u*-s,i[1]=c*t+n*-s+u*-e-l*-a,i[2]=u*t+n*-a+l*-s-c*-e,i},quat4.toMat3=function(t,e){e||(e=mat3.create());var i=t[0],n=t[1],r=t[2],o=t[3],s=i+i,a=n+n,l=r+r,c=i*s,u=i*a;i*=l;var h=n*a;return n*=l,r*=l,s*=o,a*=o,o*=l,e[0]=1-(h+r),e[1]=u+o,e[2]=i-a,e[3]=u-o,e[4]=1-(c+r),e[5]=n+s,e[6]=i+a,e[7]=n-s,e[8]=1-(c+h),e},quat4.toMat4=function(t,e){e||(e=mat4.create());var i=t[0],n=t[1],r=t[2],o=t[3],s=i+i,a=n+n,l=r+r,c=i*s,u=i*a;i*=l;var h=n*a;return n*=l,r*=l,s*=o,a*=o,o*=l,e[0]=1-(h+r),e[1]=u+o,e[2]=i-a,e[3]=0,e[4]=u-o,e[5]=1-(c+r),e[6]=n+s,e[7]=0,e[8]=i+a,e[9]=n-s,e[10]=1-(c+h),e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},quat4.slerp=function(t,e,i,n){n||(n=t);var r,o,s=t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3];if(1<=Math.abs(s))return n!==t&&(n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3]),n;if(r=Math.acos(s),o=Math.sqrt(1-s*s),Math.abs(o)<.001)return n[0]=.5*t[0]+.5*e[0],n[1]=.5*t[1]+.5*e[1],n[2]=.5*t[2]+.5*e[2],n[3]=.5*t[3]+.5*e[3],n;else return s=Math.sin((1-i)*r)/o,i=Math.sin(i*r)/o,n[0]=t[0]*s+e[0]*i,n[1]=t[1]*s+e[1]*i,n[2]=t[2]*s+e[2]*i,n[3]=t[3]*s+e[3]*i,n},quat4.str=function(t){return"["+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+"]"},function(){var i=mat4.create();function t(t,e,i){if(this.isIE=/msie/i.test(navigator.userAgent)||/trident/i.test(navigator.userAgent),this.width=0,this.height=0,this.enableFrontToBack=!!i,this.isEarlyZPass=!1,this.isBatchInEarlyZPass=!1,this.currentZ=0,this.zNear=1,this.zFar=1e3,this.zIncrement=(this.zFar-this.zNear)/32768,this.zA=this.zFar/(this.zFar-this.zNear),this.zB=this.zFar*this.zNear/(this.zNear-this.zFar),this.kzA=65536*this.zA,this.kzB=65536*this.zB,this.cam=vec3.create([0,0,100]),this.look=vec3.create([0,0,0]),this.up=vec3.create([0,1,0]),this.worldScale=vec3.create([1,1,1]),this.enable_mipmaps=!0,this.matP=mat4.create(),this.matMV=mat4.create(),this.lastMV=mat4.create(),this.currentMV=mat4.create(),this.gl=t,this.version=0===this.gl.getParameter(this.gl.VERSION).indexOf("WebGL 2")?2:1,this.timerExt=null,this.isTiming=!1,2===this.version)this.timerExt=this.gl.getExtension("EXT_disjoint_timer_query_webgl2")||this.gl.getExtension("EXT_disjoint_timer_query");else this.timerExt=this.gl.getExtension("EXT_disjoint_timer_query");this.frameNumber=0,this.timerResults=[],this.initState()}function d(t,e,i){if(this.gl=t,this.shaderProgram=e,this.name=i,this.locAPos=t.getAttribLocation(e,"aPos"),this.locATex=t.getAttribLocation(e,"aTex"),this.locMatP=t.getUniformLocation(e,"matP"),this.locMatMV=t.getUniformLocation(e,"matMV"),this.locOpacity=t.getUniformLocation(e,"opacity"),this.locColorFill=t.getUniformLocation(e,"colorFill"),this.locSamplerFront=t.getUniformLocation(e,"samplerFront"),this.locSamplerBack=t.getUniformLocation(e,"samplerBack"),this.locSrcStart=t.getUniformLocation(e,"srcStart"),this.locSrcEnd=t.getUniformLocation(e,"srcEnd"),this.locSrcOriginStart=t.getUniformLocation(e,"srcOriginStart"),this.locSrcOriginEnd=t.getUniformLocation(e,"srcOriginEnd"),this.locLayoutStart=t.getUniformLocation(e,"layoutStart"),this.locLayoutEnd=t.getUniformLocation(e,"layoutEnd"),this.locDestStart=t.getUniformLocation(e,"destStart"),this.locDestEnd=t.getUniformLocation(e,"destEnd"),this.locSeconds=t.getUniformLocation(e,"seconds"),this.locPixelSize=t.getUniformLocation(e,"pixelSize"),this.locLayerScale=t.getUniformLocation(e,"layerScale"),this.locLayerAngle=t.getUniformLocation(e,"layerAngle"),this.hasAnyOptionalUniforms=!!(this.locPixelSize||this.locSeconds||this.locSamplerBack||this.locSrcStart||this.locSrcEnd||this.locSrcOriginStart||this.locSrcOriginEnd||this.locLayoutStart||this.locLayoutEnd||this.locDestStart||this.locDestEnd||this.locLayerScale||this.locLayerAngle),this.lpPixelWidth=-999,this.lpPixelHeight=-999,this.lpOpacity=1,this.lpSrcStartX=0,this.lpSrcStartY=0,this.lpSrcEndX=0,this.lpSrcEndY=0,this.lpSrcOriginStartX=0,this.lpSrcOriginStartY=0,this.lpSrcOriginEndX=0,this.lpSrcOriginEndY=0,this.lpLayoutStartX=0,this.lpLayoutStartY=0,this.lpLayoutEndX=0,this.lpLayoutEndY=0,this.lpDestStartX=0,this.lpDestStartY=0,this.lpDestEndX=1,this.lpDestEndY=1,this.lpLayerScale=1,this.lpLayerAngle=0,this.lpSeconds=0,this.lastCustomParams=[],this.lpMatMV=mat4.create(),this.locOpacity)t.uniform1f(this.locOpacity,1);if(this.locColorFill)t.uniform4f(this.locColorFill,1,1,1,1);if(this.locSamplerFront)t.uniform1i(this.locSamplerFront,0);if(this.locSamplerBack)t.uniform1i(this.locSamplerBack,1);if(this.locSrcStart)t.uniform2f(this.locSrcStart,0,0);if(this.locSrcEnd)t.uniform2f(this.locSrcEnd,1,1);if(this.locSrcOriginStart)t.uniform2f(this.locSrcOriginStart,0,0);if(this.locSrcOriginEnd)t.uniform2f(this.locSrcOriginEnd,0,0);if(this.locLayoutStart)t.uniform2f(this.locLayoutStart,0,0);if(this.locLayoutEnd)t.uniform2f(this.locLayoutEnd,0,0);if(this.locDestStart)t.uniform2f(this.locDestStart,0,0);if(this.locDestEnd)t.uniform2f(this.locDestEnd,1,1);if(this.locLayerScale)t.uniform1f(this.locLayerScale,1);if(this.locLayerAngle)t.uniform1f(this.locLayerAngle,0);if(this.locSeconds)t.uniform1f(this.locSeconds,0);this.hasCurrentMatMV=!1}function e(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]}function n(t,e){this.type=t,this.glwrap=e,this.gl=e.gl,this.opacityParam=0,this.startIndex=0,this.indexCount=0,this.texParam=null,this.mat4param=null,this.layoutRect=quat4.create(),this.srcOriginRect=quat4.create(),this.shaderParams=[],drama.seal(this)}t.prototype.initState=function(){var t,e=this.gl;if(this.lastOpacity=1,this.lastTexture0=null,this.lastTexture1=null,this.currentOpacity=1,e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT),e.enable(e.BLEND),e.blendFunc(e.ONE,e.ONE_MINUS_SRC_ALPHA),e.disable(e.CULL_FACE),e.disable(e.STENCIL_TEST),e.disable(e.DITHER),this.enableFrontToBack)e.enable(e.DEPTH_TEST),e.depthFunc(e.LEQUAL);else e.disable(e.DEPTH_TEST);for(this.maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE),this.lastSrcBlend=e.ONE,this.lastDestBlend=e.ONE_MINUS_SRC_ALPHA,this.vertexData=new Float32Array(8e3*(this.enableFrontToBack?3:2)),this.texcoordData=new Float32Array(16e3),this.pointData=new Float32Array(32e3),this.pointBuffer=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,this.pointBuffer),e.bufferData(e.ARRAY_BUFFER,this.pointData.byteLength,e.DYNAMIC_DRAW),this.vertexBuffers=new Array(4),this.texcoordBuffers=new Array(4),t=0;t<4;t++)this.vertexBuffers[t]=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffers[t]),e.bufferData(e.ARRAY_BUFFER,this.vertexData.byteLength,e.DYNAMIC_DRAW),this.texcoordBuffers[t]=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,this.texcoordBuffers[t]),e.bufferData(e.ARRAY_BUFFER,this.texcoordData.byteLength,e.DYNAMIC_DRAW);this.curBuffer=0,this.indexBuffer=e.createBuffer(),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indexBuffer);var i=new Uint16Array(12e3);for(var n,r,o,s=t=0;t<12e3;)i[t++]=s,i[t++]=s+1,i[t++]=s+2,i[t++]=s,i[t++]=s+2,i[t++]=s+3,s+=4;if(e.bufferData(e.ELEMENT_ARRAY_BUFFER,i,e.STATIC_DRAW),this.vertexPtr=0,this.texPtr=0,this.pointPtr=0,this.shaderPrograms=[],n=["varying mediump vec2 vTex;","uniform lowp float opacity;","uniform lowp sampler2D samplerFront;","void main(void) {","\tgl_FragColor = texture2D(samplerFront, vTex);","\tgl_FragColor *= opacity;","}"].join("\n"),this.enableFrontToBack)r=["attribute highp vec3 aPos;","attribute mediump vec2 aTex;","varying mediump vec2 vTex;","uniform highp mat4 matP;","uniform highp mat4 matMV;","void main(void) {","\tgl_Position = matP * matMV * vec4(aPos.x, aPos.y, aPos.z, 1.0);","\tvTex = aTex;","}"].join("\n");else r=["attribute highp vec2 aPos;","attribute mediump vec2 aTex;","varying mediump vec2 vTex;","uniform highp mat4 matP;","uniform highp mat4 matMV;","void main(void) {","\tgl_Position = matP * matMV * vec4(aPos.x, aPos.y, 0.0, 1.0);","\tvTex = aTex;","}"].join("\n");assert2(o=this.createShaderProgram({src:n},r,"<default>"),"Failed to create default WebGL shader"),this.shaderPrograms.push(o),n=["uniform mediump sampler2D samplerFront;","varying lowp float opacity;","void main(void) {","\tgl_FragColor = texture2D(samplerFront, gl_PointCoord);","\tgl_FragColor *= opacity;","}"].join("\n");var a=["attribute vec4 aPos;","varying float opacity;","uniform mat4 matP;","uniform mat4 matMV;","void main(void) {","\tgl_Position = matP * matMV * vec4(aPos.x, aPos.y, 0.0, 1.0);","\tgl_PointSize = aPos.z;","\topacity = aPos.w;","}"].join("\n");for(var l in assert2(o=this.createShaderProgram({src:n},a,"<point>"),"Failed to create points WebGL shader"),this.shaderPrograms.push(o),n=["varying mediump vec2 vTex;","uniform lowp sampler2D samplerFront;","void main(void) {","\tif (texture2D(samplerFront, vTex).a < 1.0)","\t\tdiscard;","}"].join("\n"),assert2(o=this.createShaderProgram({src:n},r,"<earlyz>"),"Failed to create early-Z WebGL shader"),this.shaderPrograms.push(o),n=["uniform lowp vec4 colorFill;","void main(void) {","\tgl_FragColor = colorFill;","}"].join("\n"),assert2(o=this.createShaderProgram({src:n},r,"<fill>"),"Failed to create fill WebGL shader"),this.shaderPrograms.push(o),drama.shaders)if(drama.shaders.hasOwnProperty(l))this.shaderPrograms.push(this.createShaderProgram(drama.shaders[l],r,l));if(e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,null),this.batch=[],this.batchPtr=0,this.hasQuadBatchTop=!1,this.hasPointBatchTop=!1,this.lastProgram=-1,this.currentProgram=-1,this.currentShader=null,this.fbo=e.createFramebuffer(),this.renderToTex=null,this.depthBuffer=null,this.attachedDepthBuffer=!1,this.enableFrontToBack)this.depthBuffer=e.createRenderbuffer();this.tmpVec3=vec3.create([0,0,0]),log("Max texture size: "+this.maxTextureSize);var c=e.getParameter(e.ALIASED_POINT_SIZE_RANGE);if(this.minPointSize=c[0],this.maxPointSize=c[1],2048<this.maxPointSize)this.maxPointSize=2048;if(log("Point size range: "+this.minPointSize+" to "+this.maxPointSize),window.console&&window.console.log)window.console.log("WebGL extensions: ",e.getSupportedExtensions());this.switchProgram(0),drama.seal(this)},d.prototype.updateMatMV=function(t){if(!e(this.lpMatMV,t))mat4.set(t,this.lpMatMV),this.gl.uniformMatrix4fv(this.locMatMV,!1,t)},t.prototype.createShaderProgram=function(t,e,i){var n,r=this.gl,o=r.createShader(r.FRAGMENT_SHADER);if(r.shaderSource(o,t.src),r.compileShader(o),!r.getShaderParameter(o,r.COMPILE_STATUS))throw n=r.getShaderInfoLog(o),r.deleteShader(o),new Error("error compiling fragment shader: "+n);var s=r.createShader(r.VERTEX_SHADER);if(r.shaderSource(s,e),r.compileShader(s),!r.getShaderParameter(s,r.COMPILE_STATUS))throw n=r.getShaderInfoLog(s),r.deleteShader(o),r.deleteShader(s),new Error("error compiling vertex shader: "+n);var a=r.createProgram();if(r.attachShader(a,o),r.attachShader(a,s),r.linkProgram(a),!r.getProgramParameter(a,r.LINK_STATUS))throw n=r.getProgramInfoLog(a),r.deleteShader(o),r.deleteShader(s),r.deleteProgram(a),new Error("error linking shader program: "+n);r.useProgram(a);var l=r.getProgramInfoLog(a);if(l)log("Shader '"+i+"' log: "+l);r.deleteShader(o),r.deleteShader(s);var c,u,h=new d(r,a,i);for(h.extendBoxHorizontal=t.extendBoxHorizontal||0,h.extendBoxVertical=t.extendBoxVertical||0,h.crossSampling=!!t.crossSampling,h.preservesOpaqueness=!!t.preservesOpaqueness,h.animated=!!t.animated,h.parameters=t.parameters||[],c=0,u=h.parameters.length;c<u;c++)h.parameters[c][1]=r.getUniformLocation(a,h.parameters[c][0]),h.lastCustomParams.push(0);return drama.seal(h),h},t.prototype.getShaderIndex=function(t){var e,i;for(e=0,i=this.shaderPrograms.length;e<i;e++)if(this.shaderPrograms[e].name===t)return e;return-1},t.prototype.project=function(t,e,i){var n=this.matMV,r=this.matP,o=[0,0,0,0,0,0,0,0];if(o[0]=n[0]*t+n[4]*e+n[12],o[1]=n[1]*t+n[5]*e+n[13],o[2]=n[2]*t+n[6]*e+n[14],o[3]=n[3]*t+n[7]*e+n[15],o[4]=r[0]*o[0]+r[4]*o[1]+r[8]*o[2]+r[12]*o[3],o[5]=r[1]*o[0]+r[5]*o[1]+r[9]*o[2]+r[13]*o[3],o[6]=r[2]*o[0]+r[6]*o[1]+r[10]*o[2]+r[14]*o[3],o[7]=-o[2],0!==o[7])o[7]=1/o[7],o[4]*=o[7],o[5]*=o[7],o[6]*=o[7],i[0]=(.5*o[4]+.5)*this.width,i[1]=(.5*o[5]+.5)*this.height},t.prototype.setSize=function(t,e,i){if(this.width!==t||this.height!==e||i){this.endBatch();var n,r,o,s=this.gl;if(this.width=t,this.height=e,s.viewport(0,0,t,e),mat4.lookAt(this.cam,this.look,this.up,this.matMV),this.enableFrontToBack)mat4.ortho(-t/2,t/2,e/2,-e/2,this.zNear,this.zFar,this.matP),this.worldScale[0]=1,this.worldScale[1]=1;else{mat4.perspective(45,t/e,this.zNear,this.zFar,this.matP);var a=[0,0],l=[0,0];this.project(0,0,a),this.project(1,1,l),this.worldScale[0]=1/(l[0]-a[0]),this.worldScale[1]=-1/(l[1]-a[1])}for(n=0,r=this.shaderPrograms.length;n<r;n++)if((o=this.shaderPrograms[n]).hasCurrentMatMV=!1,o.locMatP)s.useProgram(o.shaderProgram),s.uniformMatrix4fv(o.locMatP,!1,this.matP);if(s.useProgram(this.shaderPrograms[this.lastProgram].shaderProgram),s.bindTexture(s.TEXTURE_2D,null),s.activeTexture(s.TEXTURE1),s.bindTexture(s.TEXTURE_2D,null),s.activeTexture(s.TEXTURE0),this.lastTexture0=null,this.lastTexture1=null,this.depthBuffer){if(s.bindFramebuffer(s.FRAMEBUFFER,this.fbo),s.bindRenderbuffer(s.RENDERBUFFER,this.depthBuffer),s.renderbufferStorage(s.RENDERBUFFER,s.DEPTH_COMPONENT16,this.width,this.height),!this.attachedDepthBuffer)s.framebufferRenderbuffer(s.FRAMEBUFFER,s.DEPTH_ATTACHMENT,s.RENDERBUFFER,this.depthBuffer),this.attachedDepthBuffer=!0;s.bindRenderbuffer(s.RENDERBUFFER,null),s.bindFramebuffer(s.FRAMEBUFFER,null),this.renderToTex=null}}},t.prototype.resetModelView=function(){mat4.lookAt(this.cam,this.look,this.up,this.matMV),mat4.scale(this.matMV,this.worldScale)},t.prototype.translate=function(t,e){if(0!==t||0!==e)this.tmpVec3[0]=t,this.tmpVec3[1]=e,this.tmpVec3[2]=0,mat4.translate(this.matMV,this.tmpVec3)},t.prototype.scale=function(t,e){if(1!==t||1!==e)this.tmpVec3[0]=t,this.tmpVec3[1]=e,this.tmpVec3[2]=1,mat4.scale(this.matMV,this.tmpVec3)},t.prototype.rotateZ=function(t){if(0!==t)mat4.rotateZ(this.matMV,t)},t.prototype.updateModelView=function(){if(!e(this.lastMV,this.matMV)){var t=this.pushBatch();if(t.type=5,t.mat4param)mat4.set(this.matMV,t.mat4param);else t.mat4param=mat4.create(this.matMV);mat4.set(this.matMV,this.lastMV),this.hasQuadBatchTop=!1,this.hasPointBatchTop=!1}},t.prototype.setEarlyZIndex=function(t){if(this.enableFrontToBack){if(32760<t)t=32760;this.currentZ=this.cam[2]-this.zNear-t*this.zIncrement}},n.prototype.doSetEarlyZPass=function(){var t=this.gl,e=this.glwrap;if(0!==this.startIndex)t.depthMask(!0),t.colorMask(!1,!1,!1,!1),t.disable(t.BLEND),t.bindFramebuffer(t.FRAMEBUFFER,e.fbo),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,null,0),t.clear(t.DEPTH_BUFFER_BIT),t.bindFramebuffer(t.FRAMEBUFFER,null),e.isBatchInEarlyZPass=!0;else t.depthMask(!1),t.colorMask(!0,!0,!0,!0),t.enable(t.BLEND),e.isBatchInEarlyZPass=!1},n.prototype.doSetScissorEnabled=function(){var t=this.gl;if(0!==this.startIndex)t.enable(t.SCISSOR_TEST),t.scissor(this.mat4param[0],this.mat4param[1],this.mat4param[2],this.mat4param[3]);else t.disable(t.SCISSOR_TEST)},n.prototype.doSetTexture=function(){this.gl.bindTexture(this.gl.TEXTURE_2D,this.texParam)},n.prototype.doSetTexture1=function(){var t=this.gl;t.activeTexture(t.TEXTURE1),t.bindTexture(t.TEXTURE_2D,this.texParam),t.activeTexture(t.TEXTURE0)},n.prototype.doSetOpacity=function(){var t=this.opacityParam,e=this.glwrap;e.currentOpacity=t;var i=e.currentShader;if(i.locOpacity&&i.lpOpacity!==t)i.lpOpacity=t,this.gl.uniform1f(i.locOpacity,t)},n.prototype.doQuad=function(){this.gl.drawElements(this.gl.TRIANGLES,this.indexCount,this.gl.UNSIGNED_SHORT,this.startIndex)},n.prototype.doSetBlend=function(){this.gl.blendFunc(this.startIndex,this.indexCount)},n.prototype.doUpdateModelView=function(){var t,e,i,n=this.glwrap.shaderPrograms,r=this.glwrap.currentProgram;for(t=0,e=n.length;t<e;t++)if(i=n[t],t===r&&i.locMatMV)i.updateMatMV(this.mat4param),i.hasCurrentMatMV=!0;else i.hasCurrentMatMV=!1;mat4.set(this.mat4param,this.glwrap.currentMV)},n.prototype.doRenderToTexture=function(){var t=this.gl,e=this.glwrap;if(this.texParam){if(e.lastTexture1===this.texParam)t.activeTexture(t.TEXTURE1),t.bindTexture(t.TEXTURE_2D,null),e.lastTexture1=null,t.activeTexture(t.TEXTURE0);if(t.bindFramebuffer(t.FRAMEBUFFER,e.fbo),!e.isBatchInEarlyZPass)t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this.texParam,0)}else{if(!e.enableFrontToBack)t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,null,0);t.bindFramebuffer(t.FRAMEBUFFER,null)}},n.prototype.doClear=function(){var t=this.gl,e=this.startIndex;if(0===e)t.clearColor(this.mat4param[0],this.mat4param[1],this.mat4param[2],this.mat4param[3]),t.clear(t.COLOR_BUFFER_BIT);else if(1===e)t.enable(t.SCISSOR_TEST),t.scissor(this.mat4param[0],this.mat4param[1],this.mat4param[2],this.mat4param[3]),t.clearColor(0,0,0,0),t.clear(t.COLOR_BUFFER_BIT),t.disable(t.SCISSOR_TEST);else t.clear(t.DEPTH_BUFFER_BIT)},n.prototype.doSetDepthTestEnabled=function(){var t=this.gl;if(0!==this.startIndex)t.enable(t.DEPTH_TEST);else t.disable(t.DEPTH_TEST)},n.prototype.doPoints=function(){var t=this.gl,e=this.glwrap;if(e.enableFrontToBack)t.disable(t.DEPTH_TEST);var i=e.shaderPrograms[1];if(t.useProgram(i.shaderProgram),!i.hasCurrentMatMV&&i.locMatMV)i.updateMatMV(e.currentMV),i.hasCurrentMatMV=!0;if(t.enableVertexAttribArray(i.locAPos),t.bindBuffer(t.ARRAY_BUFFER,e.pointBuffer),t.vertexAttribPointer(i.locAPos,4,t.FLOAT,!1,0,0),t.drawArrays(t.POINTS,this.startIndex/4,this.indexCount),i=e.currentShader,t.useProgram(i.shaderProgram),0<=i.locAPos)t.enableVertexAttribArray(i.locAPos),t.bindBuffer(t.ARRAY_BUFFER,e.vertexBuffers[e.curBuffer]),t.vertexAttribPointer(i.locAPos,e.enableFrontToBack?3:2,t.FLOAT,!1,0,0);if(0<=i.locATex)t.enableVertexAttribArray(i.locATex),t.bindBuffer(t.ARRAY_BUFFER,e.texcoordBuffers[e.curBuffer]),t.vertexAttribPointer(i.locATex,2,t.FLOAT,!1,0,0);if(e.enableFrontToBack)t.enable(t.DEPTH_TEST)},n.prototype.doSetProgram=function(){var t=this.gl,e=this.glwrap,i=e.shaderPrograms[this.startIndex];if(e.currentProgram=this.startIndex,e.currentShader=i,t.useProgram(i.shaderProgram),!i.hasCurrentMatMV&&i.locMatMV)i.updateMatMV(e.currentMV),i.hasCurrentMatMV=!0;if(i.locOpacity&&i.lpOpacity!==e.currentOpacity)i.lpOpacity=e.currentOpacity,t.uniform1f(i.locOpacity,e.currentOpacity);if(0<=i.locAPos)t.enableVertexAttribArray(i.locAPos),t.bindBuffer(t.ARRAY_BUFFER,e.vertexBuffers[e.curBuffer]),t.vertexAttribPointer(i.locAPos,e.enableFrontToBack?3:2,t.FLOAT,!1,0,0);if(0<=i.locATex)t.enableVertexAttribArray(i.locATex),t.bindBuffer(t.ARRAY_BUFFER,e.texcoordBuffers[e.curBuffer]),t.vertexAttribPointer(i.locATex,2,t.FLOAT,!1,0,0)},n.prototype.doSetColor=function(){var t=this.glwrap.currentShader,e=this.mat4param;this.gl.uniform4f(t.locColorFill,e[0],e[1],e[2],e[3])},n.prototype.doSetProgramParameters=function(){var t,e,i=this.glwrap.currentShader,n=this.gl,r=this.mat4param,o=this.layoutRect,s=this.srcOriginRect;if(i.locSamplerBack&&this.glwrap.lastTexture1!==this.texParam)n.activeTexture(n.TEXTURE1),n.bindTexture(n.TEXTURE_2D,this.texParam),this.glwrap.lastTexture1=this.texParam,n.activeTexture(n.TEXTURE0);var a=r[0],l=r[1];if(i.locPixelSize&&(a!==i.lpPixelWidth||l!==i.lpPixelHeight))i.lpPixelWidth=a,i.lpPixelHeight=l,n.uniform2f(i.locPixelSize,a,l);if(a=r[2],l=r[3],i.locDestStart&&(a!==i.lpDestStartX||l!==i.lpDestStartY))i.lpDestStartX=a,i.lpDestStartY=l,n.uniform2f(i.locDestStart,a,l);if(a=r[4],l=r[5],i.locDestEnd&&(a!==i.lpDestEndX||l!==i.lpDestEndY))i.lpDestEndX=a,i.lpDestEndY=l,n.uniform2f(i.locDestEnd,a,l);if(a=r[6],i.locLayerScale&&a!==i.lpLayerScale)i.lpLayerScale=a,n.uniform1f(i.locLayerScale,a);if(a=r[7],i.locLayerAngle&&a!==i.lpLayerAngle)i.lpLayerAngle=a,n.uniform1f(i.locLayerAngle,a);if(a=r[12],l=r[13],i.locSrcStart&&(a!==i.lpSrcStartX||l!==i.lpSrcStartY))i.lpSrcStartX=a,i.lpSrcStartY=l,n.uniform2f(i.locSrcStart,a,l);if(a=r[14],l=r[15],i.locSrcEnd&&(a!==i.lpSrcEndX||l!==i.lpSrcEndY))i.lpSrcEndX=a,i.lpSrcEndY=l,n.uniform2f(i.locSrcEnd,a,l);if(a=s[0],l=s[1],i.locSrcOriginStart&&(a!==i.lpSrcOriginStartX||l!==i.lpSrcOriginStartY))i.lpSrcOriginStartX=a,i.lpSrcOriginStartY=l,n.uniform2f(i.locSrcOriginStart,a,l);if(a=s[2],l=s[3],i.locSrcOriginEnd&&(a!==i.lpSrcOriginEndX||l!==i.lpSrcOriginEndY))i.lpSrcOriginEndX=a,i.lpSrcOriginEndY=l,n.uniform2f(i.locSrcOriginEnd,a,l);if(a=o[0],l=o[1],i.locLayoutStart&&(a!==i.lpLayoutStartX||l!==i.lpLayoutStartY))i.lpLayoutStartX=a,i.lpLayoutStartY=l,n.uniform2f(i.locLayoutStart,a,l);if(a=o[2],l=o[3],i.locLayoutEnd&&(a!==i.lpLayoutEndX||l!==i.lpLayoutEndY))i.lpLayoutEndX=a,i.lpLayoutEndY=l,n.uniform2f(i.locLayoutEnd,a,l);if(a=this.startIndex,i.locSeconds&&a!==i.lpSeconds)i.lpSeconds=a,n.uniform1f(i.locSeconds,a);if(i.parameters.length)for(t=0,e=i.parameters.length;t<e;t++)if(a=this.shaderParams[t],Array.isArray(a))n.uniform3fv(i.parameters[t][1],a.slice(0,3));else if(a!==i.lastCustomParams[t])i.lastCustomParams[t]=a,n.uniform1f(i.parameters[t][1],a)},t.prototype.pushBatch=function(){if(this.batchPtr===this.batch.length)this.batch.push(new n(0,this));return this.batch[this.batchPtr++]},t.prototype.endBatch=function(){if(0!==this.batchPtr)if(!this.gl.isContextLost()){this.maybeStartTiming();var t,e,i,n=this.gl,r=this.currentShader;if(0<this.pointPtr)if(n.bindBuffer(n.ARRAY_BUFFER,this.pointBuffer),n.bufferSubData(n.ARRAY_BUFFER,0,this.pointData.subarray(0,this.pointPtr)),r&&0<=r.locAPos&&"<point>"===r.name)n.vertexAttribPointer(r.locAPos,4,n.FLOAT,!1,0,0);if(0<this.vertexPtr){if(n.bindBuffer(n.ARRAY_BUFFER,this.vertexBuffers[this.curBuffer]),n.bufferSubData(n.ARRAY_BUFFER,0,this.vertexData.subarray(0,this.vertexPtr)),r&&0<=r.locAPos&&"<point>"!==r.name)n.vertexAttribPointer(r.locAPos,this.enableFrontToBack?3:2,n.FLOAT,!1,0,0);if(n.bindBuffer(n.ARRAY_BUFFER,this.texcoordBuffers[this.curBuffer]),n.bufferSubData(n.ARRAY_BUFFER,0,this.texcoordData.subarray(0,this.texPtr)),r&&0<=r.locATex&&"<point>"!==r.name)n.vertexAttribPointer(r.locATex,2,n.FLOAT,!1,0,0)}for(t=0,e=this.batchPtr;t<e;t++)switch((i=this.batch[t]).type){case 1:i.doQuad();break;case 2:i.doSetTexture();break;case 3:i.doSetOpacity();break;case 4:i.doSetBlend();break;case 5:i.doUpdateModelView();break;case 6:i.doRenderToTexture();break;case 7:i.doClear();break;case 8:i.doPoints();break;case 9:i.doSetProgram();break;case 10:i.doSetProgramParameters();break;case 11:i.doSetTexture1();break;case 12:i.doSetColor();break;case 13:i.doSetDepthTestEnabled();break;case 14:i.doSetEarlyZPass();break;case 15:i.doSetScissorEnabled()}if(this.batchPtr=0,this.vertexPtr=0,this.texPtr=0,this.pointPtr=0,this.hasQuadBatchTop=!1,this.hasPointBatchTop=!1,this.isBatchInEarlyZPass=!1,this.curBuffer++,4<=this.curBuffer)this.curBuffer=0}},t.prototype.maybeStartTiming=function(){if(!this.isTiming)if(this.timerExt){this.isTiming=!0;var t={frameNumber:this.frameNumber,query:null,result:0};if(2===this.version)t.query=this.gl.createQuery(),this.gl.beginQuery(this.timerExt.TIME_ELAPSED_EXT,t.query);else t.query=this.timerExt.createQueryEXT(),this.timerExt.beginQueryEXT(this.timerExt.TIME_ELAPSED_EXT,t.query);if(this.timerResults.push(t),1e3<this.timerResults.length){var e=this.timerResults.shift();if(e.query)if(2===this.version)this.gl.deleteQuery(e.query);else this.timerExt.deleteQueryEXT(e.query)}}},t.prototype.maybeFinishTiming=function(){if(this.isTiming&&this.timerResults.length){if(2===this.version)this.gl.endQuery(this.timerExt.TIME_ELAPSED_EXT);else this.timerExt.endQueryEXT(this.timerExt.TIME_ELAPSED_EXT);this.isTiming=!1}},t.prototype.checkForTimerResults=function(t){var e,i,n,r,o;for(e=0,i=this.timerResults.length;e<i;++e){if((n=this.timerResults[e]).frameNumber>=t)return;if(n.query){if(2===this.version)r=this.gl.getQueryParameter(n.query,this.gl.QUERY_RESULT_AVAILABLE);else r=this.timerExt.getQueryObjectEXT(n.query,this.timerExt.QUERY_RESULT_AVAILABLE_EXT);if(o=this.gl.getParameter(this.timerExt.GPU_DISJOINT_EXT),r&&!o){if(2===this.version)n.result=this.gl.getQueryParameter(n.query,this.gl.QUERY_RESULT);else n.result=this.timerExt.getQueryObjectEXT(n.query,this.timerExt.QUERY_RESULT_EXT);n.result/=1e9}if(r||o){if(2===this.version)this.gl.deleteQuery(n.query);else this.timerExt.deleteQueryEXT(n.query);n.query=null}}}},t.prototype.getFrameRangeTimerResults=function(t,e){if(e<=t)return-1;var i,n,r,o=0,s=0;for(i=0,n=this.timerResults.length;i<n&&!((r=this.timerResults[i]).frameNumber>=e);++i)if(r.frameNumber>=t){if(r.query)return-1;o+=r.result,s++}if(s<e-t)return-1;else return o},t.prototype.deleteTimerResultsToFrame=function(t){var e,i;for(e=0,i=this.timerResults.length;e<i;++e)if(this.timerResults[e].frameNumber>=t){if(0<e)this.timerResults.splice(0,e);return}},t.prototype.setOpacity=function(t){if(t!==this.lastOpacity)if(!this.isEarlyZPass){var e=this.pushBatch();e.type=3,e.opacityParam=t,this.lastOpacity=t,this.hasQuadBatchTop=!1,this.hasPointBatchTop=!1}},t.prototype.setTexture=function(t){if(t!==this.lastTexture0){assert2(!t||t!==this.renderToTex,"Warning: setting texture to current render texture");var e=this.pushBatch();e.type=2,e.texParam=t,this.lastTexture0=t,this.hasQuadBatchTop=!1,this.hasPointBatchTop=!1}},t.prototype.setBlend=function(t,e){if(t!==this.lastSrcBlend||e!==this.lastDestBlend)if(!this.isEarlyZPass){var i=this.pushBatch();i.type=4,i.startIndex=t,i.indexCount=e,this.lastSrcBlend=t,this.lastDestBlend=e,this.hasQuadBatchTop=!1,this.hasPointBatchTop=!1}},t.prototype.isPremultipliedAlphaBlend=function(){return this.lastSrcBlend===this.gl.ONE&&this.lastDestBlend===this.gl.ONE_MINUS_SRC_ALPHA},t.prototype.setAlphaBlend=function(t,e){this.setBlend(t||this.gl.ONE,e||this.gl.ONE_MINUS_SRC_ALPHA)},t.prototype.setNoPremultiplyAlphaBlend=function(){this.setBlend(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA)};t.prototype.quad=function(t,e,i,n,r,o,s,a){if(15992<=this.vertexPtr)this.endBatch();var l=this.vertexPtr,c=this.texPtr,u=this.vertexData,h=this.texcoordData,d=this.currentZ;if(this.hasQuadBatchTop)this.batch[this.batchPtr-1].indexCount+=6;else{var p=this.pushBatch();p.type=1,p.startIndex=this.enableFrontToBack?l:l/2*3,p.indexCount=6,this.hasQuadBatchTop=!0,this.hasPointBatchTop=!1}if(this.enableFrontToBack)u[l++]=t,u[l++]=e,u[l++]=d,u[l++]=i,u[l++]=n,u[l++]=d,u[l++]=r,u[l++]=o,u[l++]=d,u[l++]=s,u[l++]=a,u[l++]=d;else u[l++]=t,u[l++]=e,u[l++]=i,u[l++]=n,u[l++]=r,u[l++]=o,u[l++]=s,u[l++]=a;h[c++]=0,h[c++]=0,h[c++]=1,h[c++]=0,h[c++]=1,h[c++]=1,h[c++]=0,h[c++]=1,this.vertexPtr=l,this.texPtr=c},t.prototype.quadTex=function(t,e,i,n,r,o,s,a,l){if(15992<=this.vertexPtr)this.endBatch();var c=this.vertexPtr,u=this.texPtr,h=this.vertexData,d=this.texcoordData,p=this.currentZ;if(this.hasQuadBatchTop)this.batch[this.batchPtr-1].indexCount+=6;else{var f=this.pushBatch();f.type=1,f.startIndex=this.enableFrontToBack?c:c/2*3,f.indexCount=6,this.hasQuadBatchTop=!0,this.hasPointBatchTop=!1}var m=l.left,g=l.top,y=l.right,v=l.bottom;if(this.enableFrontToBack)h[c++]=t,h[c++]=e,h[c++]=p,h[c++]=i,h[c++]=n,h[c++]=p,h[c++]=r,h[c++]=o,h[c++]=p,h[c++]=s,h[c++]=a,h[c++]=p;else h[c++]=t,h[c++]=e,h[c++]=i,h[c++]=n,h[c++]=r,h[c++]=o,h[c++]=s,h[c++]=a;d[u++]=m,d[u++]=g,d[u++]=y,d[u++]=g,d[u++]=y,d[u++]=v,d[u++]=m,d[u++]=v,this.vertexPtr=c,this.texPtr=u},t.prototype.quadTexUV=function(t,e,i,n,r,o,s,a,l,c,u,h,d,p,f,m){if(15992<=this.vertexPtr)this.endBatch();var g=this.vertexPtr,y=this.texPtr,v=this.vertexData,b=this.texcoordData,_=this.currentZ;if(this.hasQuadBatchTop)this.batch[this.batchPtr-1].indexCount+=6;else{var w=this.pushBatch();w.type=1,w.startIndex=this.enableFrontToBack?g:g/2*3,w.indexCount=6,this.hasQuadBatchTop=!0,this.hasPointBatchTop=!1}if(this.enableFrontToBack)v[g++]=t,v[g++]=e,v[g++]=_,v[g++]=i,v[g++]=n,v[g++]=_,v[g++]=r,v[g++]=o,v[g++]=_,v[g++]=s,v[g++]=a,v[g++]=_;else v[g++]=t,v[g++]=e,v[g++]=i,v[g++]=n,v[g++]=r,v[g++]=o,v[g++]=s,v[g++]=a;b[y++]=l,b[y++]=c,b[y++]=u,b[y++]=h,b[y++]=d,b[y++]=p,b[y++]=f,b[y++]=m,this.vertexPtr=g,this.texPtr=y},t.prototype.enableScissor=function(t,e,i,n){var r=this.pushBatch();if(r.type=15,r.startIndex=1,!r.mat4param)r.mat4param=mat4.create();r.mat4param[0]=t,r.mat4param[1]=e,r.mat4param[2]=i,r.mat4param[3]=n,this.hasQuadBatchTop=!1,this.hasPointBatchTop=!1},t.prototype.disableScissor=function(){var t=this.pushBatch();t.type=15,t.startIndex=0,this.hasQuadBatchTop=!1,this.hasPointBatchTop=!1},t.prototype.convexPoly=function(t){var e=t.length/2;assert2(3<=e,"Must pass polygon with at least 3 points to convexPoly");var i,n,r,o,s,a,l,c,u=e-2,h=u-1,d=t[0],p=t[1];for(i=0;i<u;i+=2)if(r=t[(n=2*i)+2],o=t[n+3],s=t[n+4],a=t[n+5],i===h)this.quad(d,p,r,o,s,a,s,a);else l=t[n+6],c=t[n+7],this.quad(d,p,r,o,s,a,l,c)};t.prototype.point=function(t,e,i,n){if(7996<=this.pointPtr)this.endBatch();var r=this.pointPtr,o=this.pointData;if(this.hasPointBatchTop)this.batch[this.batchPtr-1].indexCount++;else{var s=this.pushBatch();s.type=8,s.startIndex=r,s.indexCount=1,this.hasPointBatchTop=!0,this.hasQuadBatchTop=!1}o[r++]=t,o[r++]=e,o[r++]=i,o[r++]=n,this.pointPtr=r},t.prototype.switchProgram=function(t){if(this.lastProgram!==t){var e=this.shaderPrograms[t];if(!e){if(0===this.lastProgram)return;t=0,e=this.shaderPrograms[0]}var i=this.pushBatch();i.type=9,i.startIndex=t,this.lastProgram=t,this.hasQuadBatchTop=!1,this.hasPointBatchTop=!1}},t.prototype.programUsesDest=function(t){var e=this.shaderPrograms[t];return!(!e.locDestStart&&!e.locDestEnd)},t.prototype.programUsesCrossSampling=function(t){var e=this.shaderPrograms[t];return!!(e.locDestStart||e.locDestEnd||e.crossSampling)},t.prototype.programPreservesOpaqueness=function(t){return this.shaderPrograms[t].preservesOpaqueness},t.prototype.programExtendsBox=function(t){var e=this.shaderPrograms[t];return 0!==e.extendBoxHorizontal||0!==e.extendBoxVertical},t.prototype.getProgramBoxExtendHorizontal=function(t){return this.shaderPrograms[t].extendBoxHorizontal},t.prototype.getProgramBoxExtendVertical=function(t){return this.shaderPrograms[t].extendBoxVertical},t.prototype.getProgramParameterType=function(t,e){return this.shaderPrograms[t].parameters[e][2]},t.prototype.programIsAnimated=function(t){return this.shaderPrograms[t].animated},t.prototype.setProgramParameters=function(t,e,i,n,r,o,s,a,l,c,u,h,d,p,f,m,g,y,v,b,_,w,x){var S,I,T,C,O,P,E,A=this.shaderPrograms[this.lastProgram];if(A.hasAnyOptionalUniforms||x.length){if((T=this.pushBatch()).type=10,T.mat4param)mat4.set(this.matMV,T.mat4param);else T.mat4param=mat4.create();if((C=T.mat4param)[0]=e,C[1]=i,C[2]=m,C[3]=g,C[4]=y,C[5]=v,C[6]=b,C[7]=_,C[12]=n,C[13]=r,C[14]=o,C[15]=s,(P=T.srcOriginRect)[0]=a,P[1]=l,P[2]=c,P[3]=u,(E=T.layoutRect)[0]=h,E[1]=f,E[2]=p,E[3]=d,T.startIndex=w,A.locSamplerBack)assert2(!t||t!==this.renderToTex,"Warning: setting texture1 to current render texture"),T.texParam=t;else T.texParam=null;if(x.length)for((O=T.shaderParams).length=x.length,S=0,I=x.length;S<I;S++)O[S]=x[S];this.hasQuadBatchTop=!1,this.hasPointBatchTop=!1}},t.prototype.clear=function(t,e,i,n){var r=this.pushBatch();if(r.type=7,r.startIndex=0,!r.mat4param)r.mat4param=mat4.create();r.mat4param[0]=t,r.mat4param[1]=e,r.mat4param[2]=i,r.mat4param[3]=n,this.hasQuadBatchTop=!1,this.hasPointBatchTop=!1},t.prototype.clearRect=function(t,e,i,n){if(!(i<0||n<0)){var r=this.pushBatch();if(r.type=7,r.startIndex=1,!r.mat4param)r.mat4param=mat4.create();r.mat4param[0]=t,r.mat4param[1]=e,r.mat4param[2]=i,r.mat4param[3]=n,this.hasQuadBatchTop=!1,this.hasPointBatchTop=!1}},t.prototype.clearDepth=function(){var t=this.pushBatch();t.type=7,t.startIndex=2,this.hasQuadBatchTop=!1,this.hasPointBatchTop=!1},t.prototype.setEarlyZPass=function(t){if(this.enableFrontToBack)if(t=!!t,this.isEarlyZPass!==t){var e=this.pushBatch();if(e.type=14,e.startIndex=t?1:0,this.hasQuadBatchTop=!1,this.hasPointBatchTop=!1,this.isEarlyZPass=t,this.renderToTex=null,this.isEarlyZPass)this.switchProgram(2);else this.switchProgram(0)}},t.prototype.setDepthTestEnabled=function(t){if(this.enableFrontToBack){var e=this.pushBatch();e.type=13,e.startIndex=t?1:0,this.hasQuadBatchTop=!1,this.hasPointBatchTop=!1}},t.prototype.fullscreenQuad=function(){mat4.set(this.lastMV,i),this.resetModelView(),this.updateModelView();var t=this.width/2,e=this.height/2;this.quad(-t,e,t,e,t,-e,-t,-e),mat4.set(i,this.matMV),this.updateModelView()},t.prototype.setColorFillMode=function(t,e,i,n){this.switchProgram(3);var r=this.pushBatch();if(r.type=12,!r.mat4param)r.mat4param=mat4.create();r.mat4param[0]=t,r.mat4param[1]=e,r.mat4param[2]=i,r.mat4param[3]=n,this.hasQuadBatchTop=!1,this.hasPointBatchTop=!1},t.prototype.setTextureFillMode=function(){assert2(!this.isEarlyZPass,"not allowed to set texture fill mode in early Z pass"),this.switchProgram(0)},t.prototype.restoreEarlyZMode=function(){assert2(this.isEarlyZPass,"must be in early Z pass"),this.switchProgram(2)},t.prototype.getFrameNumber=function(){return this.frameNumber},t.prototype.present=function(){this.endBatch(),this.maybeFinishTiming(),this.gl.flush(),this.checkForTimerResults(this.frameNumber),this.frameNumber++},t.prototype.supportsGpuProfiling=function(){return!!this.timerExt};var m=[],g={};t.prototype.contextLost=function(){drama.clearArray(m),g={}};t.prototype.loadTexture=function(t,e,i,n,r,o){e=!!e,i=!!i;var s=t.src+","+e+","+i+(e?","+r:""),a=null;if(void 0!==t.src&&g.hasOwnProperty(s))return(a=g[s]).c2refcount++,a;this.endBatch(),assert2(t.width<=this.maxTextureSize&&t.height<=this.maxTextureSize,"使用的图片超过最大显示尺寸，当前设备支持的最大图片尺寸为:".concat(this.maxTextureSize," * ").concat(this.maxTextureSize));var l=this.gl,c=drama.isPOT(t.width)&&drama.isPOT(t.height);a=l.createTexture(),l.bindTexture(l.TEXTURE_2D,a),l.pixelStorei(l.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0);var u=l.RGBA,h=l.RGBA,d=l.UNSIGNED_BYTE;if(n&&!this.isIE)switch(n){case 1:u=l.RGB,h=l.RGB;break;case 2:d=l.UNSIGNED_SHORT_4_4_4_4;break;case 3:d=l.UNSIGNED_SHORT_5_5_5_1;break;case 4:u=l.RGB,h=l.RGB,d=l.UNSIGNED_SHORT_5_6_5}if(1===this.version&&!c&&e){var p=document.createElement("canvas");p.width=drama.nextHighestPowerOfTwo(t.width),p.height=drama.nextHighestPowerOfTwo(t.height);var f=p.getContext("2d");f.imageSmoothingEnabled=i,f.drawImage(t,0,0,t.width,t.height,0,0,p.width,p.height),l.texImage2D(l.TEXTURE_2D,0,u,h,d,p)}else l.texImage2D(l.TEXTURE_2D,0,u,h,d,t);if(e)if("repeat-x"===r)l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_S,l.REPEAT),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_T,l.CLAMP_TO_EDGE);else if("repeat-y"===r)l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_S,l.CLAMP_TO_EDGE),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_T,l.REPEAT);else l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_S,l.REPEAT),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_T,l.REPEAT);else l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_S,l.CLAMP_TO_EDGE),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_T,l.CLAMP_TO_EDGE);if(i)if(l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MAG_FILTER,l.LINEAR),(c||2<=this.version)&&this.enable_mipmaps&&!o)l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MIN_FILTER,l.LINEAR_MIPMAP_LINEAR),l.generateMipmap(l.TEXTURE_2D);else l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MIN_FILTER,l.LINEAR);else l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MAG_FILTER,l.NEAREST),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MIN_FILTER,l.NEAREST);return l.bindTexture(l.TEXTURE_2D,null),this.lastTexture0=null,a.c2width=t.width,a.c2height=t.height,a.c2refcount=1,a.c2texkey=s,m.push(a),g[s]=a},t.prototype.createEmptyTexture=function(t,e,i,n,r){this.endBatch();var o=this.gl;if(this.isIE)n=!1;var s=o.createTexture();if(o.bindTexture(o.TEXTURE_2D,s),o.texImage2D(o.TEXTURE_2D,0,o.RGBA,t,e,0,o.RGBA,n?o.UNSIGNED_SHORT_4_4_4_4:o.UNSIGNED_BYTE,null),r)o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,o.REPEAT),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,o.REPEAT);else o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,o.CLAMP_TO_EDGE);return o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,i?o.LINEAR:o.NEAREST),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,i?o.LINEAR:o.NEAREST),o.bindTexture(o.TEXTURE_2D,null),this.lastTexture0=null,s.c2width=t,s.c2height=e,m.push(s),s},t.prototype.videoToTexture=function(t,e,i){this.endBatch();var n=this.gl;if(this.isIE)i=!1;n.bindTexture(n.TEXTURE_2D,e),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0);try{n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,i?n.UNSIGNED_SHORT_4_4_4_4:n.UNSIGNED_BYTE,t)}catch(t){if(console&&console.error)console.error("Error updating WebGL texture: ",t)}n.bindTexture(n.TEXTURE_2D,null),this.lastTexture0=null},t.prototype.deleteTexture=function(t){if(t)if(!(void 0!==t.c2refcount&&1<t.c2refcount)){if(this.endBatch(),t===this.lastTexture0)this.gl.bindTexture(this.gl.TEXTURE_2D,null),this.lastTexture0=null;if(t===this.lastTexture1)this.gl.activeTexture(this.gl.TEXTURE1),this.gl.bindTexture(this.gl.TEXTURE_2D,null),this.gl.activeTexture(this.gl.TEXTURE0),this.lastTexture1=null;if(drama.arrayFindRemove(m,t),void 0!==t.c2texkey)delete g[t.c2texkey];this.gl.deleteTexture(t)}else t.c2refcount--},t.prototype.estimateVRAM=function(){var t,e,i,n=this.width*this.height*4*2;for(t=0,e=m.length;t<e;t++)n+=(i=m[t]).c2width*i.c2height*4;return n},t.prototype.textureCount=function(){return m.length},t.prototype.setRenderingToTexture=function(t){if(t!==this.renderToTex){assert2(!t||t!==this.lastTexture0,"Warning: set rendering to current texture 0");var e=this.pushBatch();e.type=6,e.texParam=t,this.renderToTex=t,this.hasQuadBatchTop=!1,this.hasPointBatchTop=!1}},drama.GLWrap=t}(),function(global,undefined){!function(n,r,t){var e=global.protobuf=function t(e){var i=r[e];if(!i)n[e][0].call(i=r[e]={exports:{}},t,i,i.exports);return i.exports}(t[0]);if("function"==typeof define&&define.amd)define(["long"],function(t){if(t&&t.isLong)e.util.Long=t,e.configure();return e});if("object"===("undefined"==typeof module?"undefined":_typeof(module))&&module&&module.exports)module.exports=e}({1:[function(t,e,i){e.exports=function(t,e){var i=new Array(arguments.length-1),o=0,n=2,s=!0;for(;n<arguments.length;)i[o++]=arguments[n++];return new Promise(function(n,r){i[o]=function(t){if(s)if(s=!1,t)r(t);else{for(var e=new Array(arguments.length-1),i=0;i<e.length;)e[i++]=arguments[i];n.apply(null,e)}};try{t.apply(e||null,i)}catch(t){if(s)s=!1,r(t)}})}},{}],2:[function(t,e,i){var n=i;n.length=function(t){var e=t.length;if(!e)return 0;for(var i=0;1<--e%4&&"="===t.charAt(e);)++i;return Math.ceil(3*t.length)/4-i};for(var c=new Array(64),l=new Array(123),r=0;r<64;)l[c[r]=r<26?r+65:r<52?r+71:r<62?r-4:r-59|43]=r++;n.encode=function(t,e,i){for(var n,r=null,o=[],s=0,a=0;e<i;){var l=t[e++];switch(a){case 0:o[s++]=c[l>>2],n=(3&l)<<4,a=1;break;case 1:o[s++]=c[n|l>>4],n=(15&l)<<2,a=2;break;case 2:o[s++]=c[n|l>>6],o[s++]=c[63&l],a=0}if(8191<s)(r||(r=[])).push(String.fromCharCode.apply(String,o)),s=0}if(a)if(o[s++]=c[n],o[s++]=61,1===a)o[s++]=61;if(r){if(s)r.push(String.fromCharCode.apply(String,o.slice(0,s)));return r.join("")}return String.fromCharCode.apply(String,o.slice(0,s))};var u="invalid encoding";n.decode=function(t,e,i){for(var n,r=i,o=0,s=0;s<t.length;){var a=t.charCodeAt(s++);if(61===a&&1<o)break;if((a=l[a])===undefined)throw Error(u);switch(o){case 0:n=a,o=1;break;case 1:e[i++]=n<<2|(48&a)>>4,n=a,o=2;break;case 2:e[i++]=(15&n)<<4|(60&a)>>2,n=a,o=3;break;case 3:e[i++]=(3&n)<<6|a,o=0}}if(1===o)throw Error(u);return i-r},n.test=function(t){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(t)}},{}],3:[function(t,e,i){function h(e,i){if("string"==typeof e)i=e,e=undefined;var l=[];function c(t){if("string"!=typeof t){var e=u();if(h.verbose)console.log("codegen: "+e);if(e="return "+e,t){for(var i=Object.keys(t),n=new Array(i.length+1),r=new Array(i.length),o=0;o<i.length;)n[o]=i[o],r[o]=t[i[o++]];return n[o]=e,Function.apply(null,n).apply(null,r)}return Function(e)()}for(var s=new Array(arguments.length-1),a=0;a<s.length;)s[a]=arguments[++a];if(a=0,t=t.replace(/%([%dfijs])/g,function(t,e){var i=s[a++];switch(e){case"d":case"f":return String(Number(i));case"i":return String(Math.floor(i));case"j":return JSON.stringify(i);case"s":return String(i)}return"%"}),a!==s.length)throw Error("parameter count mismatch");return l.push(t),c}function u(t){return"function "+(t||i||"")+"("+(e&&e.join(",")||"")+"){\n  "+l.join("\n  ")+"\n}"}return c.toString=u,c}(e.exports=h).verbose=!1},{}],4:[function(t,e,i){function n(){this._listeners={}}(e.exports=n).prototype.on=function(t,e,i){return(this._listeners[t]||(this._listeners[t]=[])).push({fn:e,ctx:i||this}),this},n.prototype.off=function(t,e){if(t===undefined)this._listeners={};else if(e===undefined)this._listeners[t]=[];else for(var i=this._listeners[t],n=0;n<i.length;)if(i[n].fn===e)i.splice(n,1);else++n;return this},n.prototype.emit=function(t){var e=this._listeners[t];if(e){for(var i=[],n=1;n<arguments.length;)i.push(arguments[n++]);for(n=0;n<e.length;)e[n].fn.apply(e[n++].ctx,i)}return this}},{}],5:[function(t,e,i){e.exports=a;var o=t(1),s=t(7)("fs");function a(i,n,r){if("function"==typeof n)r=n,n={};else if(!n)n={};if(!r)return o(a,this,i,n);if(!n.xhr&&s&&s.readFile)return s.readFile(i,function(t,e){return t&&"undefined"!=typeof XMLHttpRequest?a.xhr(i,n,r):t?r(t):r(null,n.binary?e:e.toString("utf8"))});else return a.xhr(i,n,r)}a.xhr=function(t,i,n){var r=new XMLHttpRequest;if(r.onreadystatechange=function(){if(4!==r.readyState)return undefined;if(0!==r.status&&200!==r.status)return n(Error("status "+r.status));if(i.binary){var t=r.response;if(!t){t=[];for(var e=0;e<r.responseText.length;++e)t.push(255&r.responseText.charCodeAt(e))}return n(null,"undefined"!=typeof Uint8Array?new Uint8Array(t):t)}return n(null,r.responseText)},i.binary){if("overrideMimeType"in r)r.overrideMimeType("text/plain; charset=x-user-defined");r.responseType="arraybuffer"}r.open("GET",t),r.send()}},{1:1,7:7}],6:[function(t,e,i){function n(a){if("undefined"!=typeof Float32Array)!function(){var n=new Float32Array([-0]),r=new Uint8Array(n.buffer),t=128===r[3];function e(t,e,i){n[0]=t,e[i]=r[0],e[i+1]=r[1],e[i+2]=r[2],e[i+3]=r[3]}function i(t,e,i){n[0]=t,e[i]=r[3],e[i+1]=r[2],e[i+2]=r[1],e[i+3]=r[0]}function o(t,e){return r[0]=t[e],r[1]=t[e+1],r[2]=t[e+2],r[3]=t[e+3],n[0]}function s(t,e){return r[3]=t[e],r[2]=t[e+1],r[1]=t[e+2],r[0]=t[e+3],n[0]}a.writeFloatLE=t?e:i,a.writeFloatBE=t?i:e,a.readFloatLE=t?o:s,a.readFloatBE=t?s:o}();else!function(){function t(t,e,i,n){var r=e<0?1:0;if(r)e=-e;if(0===e)t(0<1/e?0:2147483648,i,n);else if(isNaN(e))t(2143289344,i,n);else if(34028234663852886e22<e)t((r<<31|2139095040)>>>0,i,n);else if(e<11754943508222875e-54)t((r<<31|Math.round(e/1401298464324817e-60))>>>0,i,n);else{var o=Math.floor(Math.log(e)/Math.LN2);t((r<<31|o+127<<23|8388607&Math.round(e*Math.pow(2,-o)*8388608))>>>0,i,n)}}function e(t,e,i){var n=t(e,i),r=2*(n>>31)+1,o=n>>>23&255,s=8388607&n;return 255===o?s?NaN:r*(1/0):0===o?1401298464324817e-60*r*s:r*Math.pow(2,o-150)*(s+8388608)}a.writeFloatLE=t.bind(null,r),a.writeFloatBE=t.bind(null,o),a.readFloatLE=e.bind(null,s),a.readFloatBE=e.bind(null,l)}();if("undefined"!=typeof Float64Array)!function(){var n=new Float64Array([-0]),r=new Uint8Array(n.buffer),t=128===r[7];function e(t,e,i){n[0]=t,e[i]=r[0],e[i+1]=r[1],e[i+2]=r[2],e[i+3]=r[3],e[i+4]=r[4],e[i+5]=r[5],e[i+6]=r[6],e[i+7]=r[7]}function i(t,e,i){n[0]=t,e[i]=r[7],e[i+1]=r[6],e[i+2]=r[5],e[i+3]=r[4],e[i+4]=r[3],e[i+5]=r[2],e[i+6]=r[1],e[i+7]=r[0]}function o(t,e){return r[0]=t[e],r[1]=t[e+1],r[2]=t[e+2],r[3]=t[e+3],r[4]=t[e+4],r[5]=t[e+5],r[6]=t[e+6],r[7]=t[e+7],n[0]}function s(t,e){return r[7]=t[e],r[6]=t[e+1],r[5]=t[e+2],r[4]=t[e+3],r[3]=t[e+4],r[2]=t[e+5],r[1]=t[e+6],r[0]=t[e+7],n[0]}a.writeDoubleLE=t?e:i,a.writeDoubleBE=t?i:e,a.readDoubleLE=t?o:s,a.readDoubleBE=t?s:o}();else!function(){function t(t,e,i,n,r,o){var s=n<0?1:0;if(s)n=-n;if(0===n)t(0,r,o+e),t(0<1/n?0:2147483648,r,o+i);else if(isNaN(n))t(0,r,o+e),t(2146959360,r,o+i);else if(17976931348623157e292<n)t(0,r,o+e),t((s<<31|2146435072)>>>0,r,o+i);else{var a;if(n<22250738585072014e-324)t((a=n/5e-324)>>>0,r,o+e),t((s<<31|a/4294967296)>>>0,r,o+i);else{var l=Math.floor(Math.log(n)/Math.LN2);if(1024===l)l=1023;t(4503599627370496*(a=n*Math.pow(2,-l))>>>0,r,o+e),t((s<<31|l+1023<<20|1048576*a&1048575)>>>0,r,o+i)}}}function e(t,e,i,n,r){var o=t(n,r+e),s=t(n,r+i),a=2*(s>>31)+1,l=s>>>20&2047,c=4294967296*(1048575&s)+o;return 2047===l?c?NaN:a*(1/0):0===l?5e-324*a*c:a*Math.pow(2,l-1075)*(c+4503599627370496)}a.writeDoubleLE=t.bind(null,r,0,4),a.writeDoubleBE=t.bind(null,o,4,0),a.readDoubleLE=e.bind(null,s,0,4),a.readDoubleBE=e.bind(null,l,4,0)}();return a}function r(t,e,i){e[i]=255&t,e[i+1]=t>>>8&255,e[i+2]=t>>>16&255,e[i+3]=t>>>24}function o(t,e,i){e[i]=t>>>24,e[i+1]=t>>>16&255,e[i+2]=t>>>8&255,e[i+3]=255&t}function s(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24)>>>0}function l(t,e){return(t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3])>>>0}e.exports=n(n)},{}],7:[function(require,module,exports){function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(t){}return null}module.exports=inquire},{}],8:[function(t,e,i){var n=i,o=n.isAbsolute=function(t){return/^(?:\/|\w+:)/.test(t)},r=n.normalize=function(t){var e=(t=t.replace(/\\/g,"/").replace(/\/{2,}/g,"/")).split("/"),i=o(t),n="";if(i)n=e.shift()+"/";for(var r=0;r<e.length;)if(".."===e[r])if(0<r&&".."!==e[r-1])e.splice(--r,2);else if(i)e.splice(r,1);else++r;else if("."===e[r])e.splice(r,1);else++r;return n+e.join("/")};n.resolve=function(t,e,i){if(!i)e=r(e);if(o(e))return e;if(!i)t=r(t);return(t=t.replace(/(?:\/|^)[^/]+$/,"")).length?r(t+"/"+e):e}},{}],9:[function(t,e,i){e.exports=function(i,n,t){var r=t||8192,o=r>>>1,s=null,a=r;return function(t){if(t<1||o<t)return i(t);if(r<a+t)s=i(r),a=0;var e=n.call(s,a,a+=t);if(7&a)a=1+(7|a);return e}}},{}],10:[function(t,e,i){var n=i;n.length=function(t){for(var e=0,i=0,n=0;n<t.length;++n)if((i=t.charCodeAt(n))<128)e+=1;else if(i<2048)e+=2;else if(55296==(64512&i)&&56320==(64512&t.charCodeAt(n+1)))++n,e+=4;else e+=3;return e},n.read=function(t,e,i){if(i-e<1)return"";for(var n,r=null,o=[],s=0;e<i;){if((n=t[e++])<128)o[s++]=n;else if(191<n&&n<224)o[s++]=(31&n)<<6|63&t[e++];else if(239<n&&n<365)n=((7&n)<<18|(63&t[e++])<<12|(63&t[e++])<<6|63&t[e++])-65536,o[s++]=55296+(n>>10),o[s++]=56320+(1023&n);else o[s++]=(15&n)<<12|(63&t[e++])<<6|63&t[e++];if(8191<s)(r||(r=[])).push(String.fromCharCode.apply(String,o)),s=0}if(r){if(s)r.push(String.fromCharCode.apply(String,o.slice(0,s)));return r.join("")}return String.fromCharCode.apply(String,o.slice(0,s))},n.write=function(t,e,i){for(var n,r,o=i,s=0;s<t.length;++s)if((n=t.charCodeAt(s))<128)e[i++]=n;else if(n<2048)e[i++]=n>>6|192,e[i++]=63&n|128;else if(55296==(64512&n)&&56320==(64512&(r=t.charCodeAt(s+1))))n=65536+((1023&n)<<10)+(1023&r),++s,e[i++]=n>>18|240,e[i++]=n>>12&63|128,e[i++]=n>>6&63|128,e[i++]=63&n|128;else e[i++]=n>>12|224,e[i++]=n>>6&63|128,e[i++]=63&n|128;return i-o}},{}],11:[function(t,e,i){e.exports=o;var n,r=/\/|\./;function o(t,e){if(!r.test(t))t="google/protobuf/"+t+".proto",e={nested:{google:{nested:{protobuf:{nested:e}}}}};o[t]=e}o("any",{Any:{fields:{type_url:{type:"string",id:1},value:{type:"bytes",id:2}}}}),o("duration",{Duration:n={fields:{seconds:{type:"int64",id:1},nanos:{type:"int32",id:2}}}}),o("timestamp",{Timestamp:n}),o("empty",{Empty:{fields:{}}}),o("struct",{Struct:{fields:{fields:{keyType:"string",type:"Value",id:1}}},Value:{oneofs:{kind:{oneof:["nullValue","numberValue","stringValue","boolValue","structValue","listValue"]}},fields:{nullValue:{type:"NullValue",id:1},numberValue:{type:"double",id:2},stringValue:{type:"string",id:3},boolValue:{type:"bool",id:4},structValue:{type:"Struct",id:5},listValue:{type:"ListValue",id:6}}},NullValue:{values:{NULL_VALUE:0}},ListValue:{fields:{values:{rule:"repeated",type:"Value",id:1}}}}),o("wrappers",{DoubleValue:{fields:{value:{type:"double",id:1}}},FloatValue:{fields:{value:{type:"float",id:1}}},Int64Value:{fields:{value:{type:"int64",id:1}}},UInt64Value:{fields:{value:{type:"uint64",id:1}}},Int32Value:{fields:{value:{type:"int32",id:1}}},UInt32Value:{fields:{value:{type:"uint32",id:1}}},BoolValue:{fields:{value:{type:"bool",id:1}}},StringValue:{fields:{value:{type:"string",id:1}}},BytesValue:{fields:{value:{type:"bytes",id:1}}}}),o.get=function(t){return o[t]||null}},{}],12:[function(t,e,i){var n=i,h=t(15),d=t(37);function s(t,e,i,n){if(e.resolvedType)if(e.resolvedType instanceof h){t("switch(d%s){",n);for(var r=e.resolvedType.values,o=Object.keys(r),s=0;s<o.length;++s){if(e.repeated&&r[o[s]]===e.typeDefault)t("default:");t("case%j:",o[s])("case %i:",r[o[s]])("m%s=%j",n,r[o[s]])("break")}t("}")}else t('if(typeof d%s!=="object")',n)("throw TypeError(%j)",e.fullName+": object expected")("m%s=types[%i].fromObject(d%s)",n,i,n);else{var a=!1;switch(e.type){case"double":case"float":t("m%s=Number(d%s)",n,n);break;case"uint32":case"fixed32":t("m%s=d%s>>>0",n,n);break;case"int32":case"sint32":case"sfixed32":t("m%s=d%s|0",n,n);break;case"uint64":a=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":t("if(util.Long)")("(m%s=util.Long.fromValue(d%s)).unsigned=%j",n,n,a)('else if(typeof d%s==="string")',n)("m%s=parseInt(d%s,10)",n,n)('else if(typeof d%s==="number")',n)("m%s=d%s",n,n)('else if(typeof d%s==="object")',n)("m%s=new util.LongBits(d%s.low>>>0,d%s.high>>>0).toNumber(%s)",n,n,n,a?"true":"");break;case"bytes":t('if(typeof d%s==="string")',n)("util.base64.decode(d%s,m%s=util.newBuffer(util.base64.length(d%s)),0)",n,n,n)("else if(d%s.length)",n)("m%s=d%s",n,n);break;case"string":t("m%s=String(d%s)",n,n);break;case"bool":t("m%s=Boolean(d%s)",n,n)}}return t}function p(t,e,i,n){if(e.resolvedType)if(e.resolvedType instanceof h)t("d%s=o.enums===String?types[%i].values[m%s]:m%s",n,i,n,n);else t("d%s=types[%i].toObject(m%s,o)",n,i,n);else{var r=!1;switch(e.type){case"double":case"float":t("d%s=o.json&&!isFinite(m%s)?String(m%s):m%s",n,n,n,n);break;case"uint64":r=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":t('if(typeof m%s==="number")',n)("d%s=o.longs===String?String(m%s):m%s",n,n,n)("else")("d%s=o.longs===String?util.Long.prototype.toString.call(m%s):o.longs===Number?new util.LongBits(m%s.low>>>0,m%s.high>>>0).toNumber(%s):m%s",n,n,n,n,r?"true":"",n);break;case"bytes":t("d%s=o.bytes===String?util.base64.encode(m%s,0,m%s.length):o.bytes===Array?Array.prototype.slice.call(m%s):m%s",n,n,n,n,n);break;default:t("d%s=m%s",n,n)}}return t}n.fromObject=function(t){var e=t.fieldsArray,i=d.codegen(["d"],t.name+"$fromObject")("if(d instanceof this.ctor)")("return d");if(!e.length)return i("return new this.ctor");i("var m=new this.ctor");for(var n=0;n<e.length;++n){var r=e[n].resolve(),o=d.safeProp(r.name);if(r.map)i("if(d%s){",o)('if(typeof d%s!=="object")',o)("throw TypeError(%j)",r.fullName+": object expected")("m%s={}",o)("for(var ks=Object.keys(d%s),i=0;i<ks.length;++i){",o),s(i,r,n,o+"[ks[i]]")("}")("}");else if(r.repeated)i("if(d%s){",o)("if(!Array.isArray(d%s))",o)("throw TypeError(%j)",r.fullName+": array expected")("m%s=[]",o)("for(var i=0;i<d%s.length;++i){",o),s(i,r,n,o+"[i]")("}")("}");else{if(!(r.resolvedType instanceof h))i("if(d%s!=null){",o);if(s(i,r,n,o),!(r.resolvedType instanceof h))i("}")}}return i("return m")},n.toObject=function(t){var e=t.fieldsArray.slice().sort(d.compareFieldsById);if(!e.length)return d.codegen()("return {}");for(var i=d.codegen(["m","o"],t.name+"$toObject")("if(!o)")("o={}")("var d={}"),n=[],r=[],o=[],s=0;s<e.length;++s)if(!e[s].partOf)(e[s].resolve().repeated?n:e[s].map?r:o).push(e[s]);if(n.length){for(i("if(o.arrays||o.defaults){"),s=0;s<n.length;++s)i("d%s=[]",d.safeProp(n[s].name));i("}")}if(r.length){for(i("if(o.objects||o.defaults){"),s=0;s<r.length;++s)i("d%s={}",d.safeProp(r[s].name));i("}")}if(o.length){for(i("if(o.defaults){"),s=0;s<o.length;++s){var a=o[s],l=d.safeProp(a.name);if(a.resolvedType instanceof h)i("d%s=o.enums===String?%j:%j",l,a.resolvedType.valuesById[a.typeDefault],a.typeDefault);else if(a.long)i("if(util.Long){")("var n=new util.Long(%i,%i,%j)",a.typeDefault.low,a.typeDefault.high,a.typeDefault.unsigned)("d%s=o.longs===String?n.toString():o.longs===Number?n.toNumber():n",l)("}else")("d%s=o.longs===String?%j:%i",l,a.typeDefault.toString(),a.typeDefault.toNumber());else if(a.bytes)i("d%s=o.bytes===String?%j:%s",l,String.fromCharCode.apply(String,a.typeDefault),"["+Array.prototype.slice.call(a.typeDefault).join(",")+"]");else i("d%s=%j",l,a.typeDefault)}i("}")}var c=!1;for(s=0;s<e.length;++s){a=e[s];var u=t._fieldsArray.indexOf(a);l=d.safeProp(a.name);if(a.map){if(!c)c=!0,i("var ks2");i("if(m%s&&(ks2=Object.keys(m%s)).length){",l,l)("d%s={}",l)("for(var j=0;j<ks2.length;++j){"),p(i,a,u,l+"[ks2[j]]")("}")}else if(a.repeated)i("if(m%s&&m%s.length){",l,l)("d%s=[]",l)("for(var j=0;j<m%s.length;++j){",l),p(i,a,u,l+"[j]")("}");else if(i("if(m%s!=null&&m.hasOwnProperty(%j)){",l,a.name),p(i,a,u,l),a.partOf)i("if(o.oneofs)")("d%s=%j",d.safeProp(a.partOf.name),a.name);i("}")}return i("return d")}},{15:15,37:37}],13:[function(t,e,i){e.exports=function(t){var e=c.codegen(["r","l"],t.name+"$decode")("if(!(r instanceof Reader))")("r=Reader.create(r)")("var c=l===undefined?r.len:r.pos+l,m=new this.ctor"+(t.fieldsArray.filter(function(t){return t.map}).length?",k":""))("while(r.pos<c){")("var t=r.uint32()");if(t.group)e("if((t&7)===4)")("break");e("switch(t>>>3){");for(var i=0;i<t.fieldsArray.length;++i){var n=t._fieldsArray[i].resolve(),r=n.resolvedType instanceof a?"int32":n.type,o="m"+c.safeProp(n.name);if(e("case %i:",n.id),n.map)if(e("r.skip().pos++")("if(%s===util.emptyObject)",o)("%s={}",o)("k=r.%s()",n.keyType)("r.pos++"),l.long[n.keyType]!==undefined)if(l.basic[r]===undefined)e('%s[typeof k==="object"?util.longToHash(k):k]=types[%i].decode(r,r.uint32())',o,i);else e('%s[typeof k==="object"?util.longToHash(k):k]=r.%s()',o,r);else if(l.basic[r]===undefined)e("%s[k]=types[%i].decode(r,r.uint32())",o,i);else e("%s[k]=r.%s()",o,r);else if(n.repeated){if(e("if(!(%s&&%s.length))",o,o)("%s=[]",o),l.packed[r]!==undefined)e("if((t&7)===2){")("var c2=r.uint32()+r.pos")("while(r.pos<c2)")("%s.push(r.%s())",o,r)("}else");if(l.basic[r]===undefined)e(n.resolvedType.group?"%s.push(types[%i].decode(r))":"%s.push(types[%i].decode(r,r.uint32()))",o,i);else e("%s.push(r.%s())",o,r)}else if(l.basic[r]===undefined)e(n.resolvedType.group?"%s=types[%i].decode(r)":"%s=types[%i].decode(r,r.uint32())",o,i);else e("%s=r.%s()",o,r);e("break")}for(e("default:")("r.skipType(t&7)")("break")("}")("}"),i=0;i<t._fieldsArray.length;++i){var s=t._fieldsArray[i];if(s.required)e("if(!m.hasOwnProperty(%j))",s.name)("throw util.ProtocolError(%j,{instance:m})","missing required '"+s.name+"'")}return e("return m")};var a=t(15),l=t(36),c=t(37)},{15:15,36:36,37:37}],14:[function(t,e,i){e.exports=function(t){for(var e,i=h.codegen(["m","w"],t.name+"$encode")("if(!w)")("w=Writer.create()"),n=t.fieldsArray.slice().sort(h.compareFieldsById),r=0;r<n.length;++r){var o=n[r].resolve(),s=t._fieldsArray.indexOf(o),a=o.resolvedType instanceof c?"int32":o.type,l=u.basic[a];if(e="m"+h.safeProp(o.name),o.map){if(i("if(%s!=null&&m.hasOwnProperty(%j)){",e,o.name)("for(var ks=Object.keys(%s),i=0;i<ks.length;++i){",e)("w.uint32(%i).fork().uint32(%i).%s(ks[i])",(o.id<<3|2)>>>0,8|u.mapKey[o.keyType],o.keyType),l===undefined)i("types[%i].encode(%s[ks[i]],w.uint32(18).fork()).ldelim().ldelim()",s,e);else i(".uint32(%i).%s(%s[ks[i]]).ldelim()",16|l,a,e);i("}")("}")}else if(o.repeated){if(i("if(%s!=null&&%s.length){",e,e),o.packed&&u.packed[a]!==undefined)i("w.uint32(%i).fork()",(o.id<<3|2)>>>0)("for(var i=0;i<%s.length;++i)",e)("w.%s(%s[i])",a,e)("w.ldelim()");else if(i("for(var i=0;i<%s.length;++i)",e),l===undefined)d(i,o,s,e+"[i]");else i("w.uint32(%i).%s(%s[i])",(o.id<<3|l)>>>0,a,e);i("}")}else{if(o.optional)i("if(%s!=null&&m.hasOwnProperty(%j))",e,o.name);if(l===undefined)d(i,o,s,e);else i("w.uint32(%i).%s(%s)",(o.id<<3|l)>>>0,a,e)}}return i("return w")};var c=t(15),u=t(36),h=t(37);function d(t,e,i,n){return e.resolvedType.group?t("types[%i].encode(%s,w.uint32(%i)).uint32(%i)",i,n,(e.id<<3|3)>>>0,(e.id<<3|4)>>>0):t("types[%i].encode(%s,w.uint32(%i).fork()).ldelim()",i,n,(e.id<<3|2)>>>0)}},{15:15,36:36,37:37}],15:[function(t,e,i){e.exports=s;var o=t(24);((s.prototype=Object.create(o.prototype)).constructor=s).className="Enum";var n=t(23),r=t(37);function s(t,e,i){if(o.call(this,t,i),e&&"object"!==_typeof(e))throw TypeError("values must be an object");if(this.valuesById={},this.values=Object.create(this.valuesById),this.comments={},this.reserved=undefined,e)for(var n=Object.keys(e),r=0;r<n.length;++r)if("number"==typeof e[n[r]])this.valuesById[this.values[n[r]]=e[n[r]]]=n[r]}s.fromJSON=function(t,e){var i=new s(t,e.values,e.options);return i.reserved=e.reserved,i},s.prototype.toJSON=function(){return r.toObject(["options",this.options,"values",this.values,"reserved",this.reserved&&this.reserved.length?this.reserved:undefined])},s.prototype.add=function(t,e,i){if(!r.isString(t))throw TypeError("name must be a string");if(!r.isInteger(e))throw TypeError("id must be an integer");if(this.values[t]!==undefined)throw Error("duplicate name '"+t+"' in "+this);if(this.isReservedId(e))throw Error("id "+e+" is reserved in "+this);if(this.isReservedName(t))throw Error("name '"+t+"' is reserved in "+this);if(this.valuesById[e]!==undefined){if(!this.options||!this.options.allow_alias)throw Error("duplicate id "+e+" in "+this);this.values[t]=e}else this.valuesById[this.values[t]=e]=t;return this.comments[t]=i||null,this},s.prototype.remove=function(t){if(!r.isString(t))throw TypeError("name must be a string");var e=this.values[t];if(null==e)throw Error("name '"+t+"' does not exist in "+this);return delete this.valuesById[e],delete this.values[t],delete this.comments[t],this},s.prototype.isReservedId=function(t){return n.isReservedId(this.reserved,t)},s.prototype.isReservedName=function(t){return n.isReservedName(this.reserved,t)}},{23:23,24:24,37:37}],16:[function(t,e,i){e.exports=u;var s=t(24);((u.prototype=Object.create(s.prototype)).constructor=u).className="Field";var n,r=t(15),a=t(36),l=t(37),c=/^required|optional|repeated$/;function u(t,e,i,n,r,o){if(l.isObject(n))o=n,n=r=undefined;else if(l.isObject(r))o=r,r=undefined;if(s.call(this,t,o),!l.isInteger(e)||e<0)throw TypeError("id must be a non-negative integer");if(!l.isString(i))throw TypeError("type must be a string");if(n!==undefined&&!c.test(n=n.toString().toLowerCase()))throw TypeError("rule must be a string rule");if(r!==undefined&&!l.isString(r))throw TypeError("extend must be a string");this.rule=n&&"optional"!==n?n:undefined,this.type=i,this.id=e,this.extend=r||undefined,this.required="required"===n,this.optional=!this.required,this.repeated="repeated"===n,this.map=!1,this.message=null,this.partOf=null,this.typeDefault=null,this.defaultValue=null,this.long=l.Long?a.long[i]!==undefined:!1,this.bytes="bytes"===i,this.resolvedType=null,this.extensionField=null,this.declaringField=null,this._packed=null}u.fromJSON=function(t,e){return new u(t,e.id,e.type,e.rule,e.extend,e.options)},Object.defineProperty(u.prototype,"packed",{get:function(){if(null===this._packed)this._packed=!1!==this.getOption("packed");return this._packed}}),u.prototype.setOption=function(t,e,i){if("packed"===t)this._packed=null;return s.prototype.setOption.call(this,t,e,i)},u.prototype.toJSON=function(){return l.toObject(["rule","optional"!==this.rule&&this.rule||undefined,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options])},u.prototype.resolve=function(){if(this.resolved)return this;if((this.typeDefault=a.defaults[this.type])===undefined)if(this.resolvedType=(this.declaringField?this.declaringField.parent:this.parent).lookupTypeOrEnum(this.type),this.resolvedType instanceof n)this.typeDefault=null;else this.typeDefault=this.resolvedType.values[Object.keys(this.resolvedType.values)[0]];if(this.options&&null!=this.options.default)if(this.typeDefault=this.options.default,this.resolvedType instanceof r&&"string"==typeof this.typeDefault)this.typeDefault=this.resolvedType.values[this.typeDefault];if(this.options){if(!0===this.options.packed||this.options.packed!==undefined&&this.resolvedType&&!(this.resolvedType instanceof r))delete this.options.packed;if(!Object.keys(this.options).length)this.options=undefined}if(this.long){if(this.typeDefault=l.Long.fromNumber(this.typeDefault,"u"===this.type.charAt(0)),Object.freeze)Object.freeze(this.typeDefault)}else if(this.bytes&&"string"==typeof this.typeDefault){var t;if(l.base64.test(this.typeDefault))l.base64.decode(this.typeDefault,t=l.newBuffer(l.base64.length(this.typeDefault)),0);else l.utf8.write(this.typeDefault,t=l.newBuffer(l.utf8.length(this.typeDefault)),0);this.typeDefault=t}if(this.map)this.defaultValue=l.emptyObject;else if(this.repeated)this.defaultValue=l.emptyArray;else this.defaultValue=this.typeDefault;if(this.parent instanceof n)this.parent.ctor.prototype[this.name]=this.defaultValue;return s.prototype.resolve.call(this)},u.d=function(i,n,r,o){if("function"==typeof n)n=l.decorateType(n).name;else if(n&&"object"===_typeof(n))n=l.decorateEnum(n).name;return function(t,e){l.decorateType(t.constructor).add(new u(e,i,n,r,{default:o}))}},u._configure=function(t){n=t}},{15:15,24:24,36:36,37:37}],17:[function(t,e,i){var n=e.exports=t(18);n.build="light",n.load=function(t,e,i){if("function"==typeof e)i=e,e=new n.Root;else if(!e)e=new n.Root;return e.load(t,i)},n.loadSync=function(t,e){if(!e)e=new n.Root;return e.loadSync(t)},n.encoder=t(14),n.decoder=t(13),n.verifier=t(40),n.converter=t(12),n.ReflectionObject=t(24),n.Namespace=t(23),n.Root=t(29),n.Enum=t(15),n.Type=t(35),n.Field=t(16),n.OneOf=t(25),n.MapField=t(20),n.Service=t(33),n.Method=t(22),n.Message=t(21),n.wrappers=t(41),n.types=t(36),n.util=t(37),n.ReflectionObject._configure(n.Root),n.Namespace._configure(n.Type,n.Service),n.Root._configure(n.Type),n.Field._configure(n.Type)},{12:12,13:13,14:14,15:15,16:16,18:18,20:20,21:21,22:22,23:23,24:24,25:25,29:29,33:33,35:35,36:36,37:37,40:40,41:41}],18:[function(t,e,i){var n=i;function r(){n.Reader._configure(n.BufferReader),n.util._configure()}n.build="minimal",n.Writer=t(42),n.BufferWriter=t(43),n.Reader=t(27),n.BufferReader=t(28),n.util=t(39),n.rpc=t(31),n.roots=t(30),n.configure=r,n.Writer._configure(n.BufferWriter),r()},{27:27,28:28,30:30,31:31,39:39,42:42,43:43}],19:[function(t,e,i){var n=e.exports=t(17);n.build="full",n.tokenize=t(34),n.parse=t(26),n.common=t(11),n.Root._configure(n.Type,n.parse,n.common)},{11:11,17:17,26:26,34:34}],20:[function(t,e,i){e.exports=a;var o=t(16);((a.prototype=Object.create(o.prototype)).constructor=a).className="MapField";var n=t(36),s=t(37);function a(t,e,i,n,r){if(o.call(this,t,e,n,r),!s.isString(i))throw TypeError("keyType must be a string");this.keyType=i,this.resolvedKeyType=null,this.map=!0}a.fromJSON=function(t,e){return new a(t,e.id,e.keyType,e.type,e.options)},a.prototype.toJSON=function(){return s.toObject(["keyType",this.keyType,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options])},a.prototype.resolve=function(){if(this.resolved)return this;if(n.mapKey[this.keyType]===undefined)throw Error("invalid key type: "+this.keyType);return o.prototype.resolve.call(this)},a.d=function(i,n,r){if("function"==typeof r)r=s.decorateType(r).name;else if(r&&"object"===_typeof(r))r=s.decorateEnum(r).name;return function(t,e){s.decorateType(t.constructor).add(new a(e,i,n,r))}}},{16:16,36:36,37:37}],21:[function(t,e,i){e.exports=r;var n=t(39);function r(t){if(t)for(var e=Object.keys(t),i=0;i<e.length;++i)this[e[i]]=t[e[i]]}r.create=function(t){return this.$type.create(t)},r.encode=function(t,e){return this.$type.encode(t,e)},r.encodeDelimited=function(t,e){return this.$type.encodeDelimited(t,e)},r.decode=function(t){return this.$type.decode(t)},r.decodeDelimited=function(t){return this.$type.decodeDelimited(t)},r.verify=function(t){return this.$type.verify(t)},r.fromObject=function(t){return this.$type.fromObject(t)},r.toObject=function(t,e){return this.$type.toObject(t,e)},r.prototype.toJSON=function(){return this.$type.toObject(this,n.toJSONOptions)}},{39:39}],22:[function(t,e,i){e.exports=n;var a=t(24);((n.prototype=Object.create(a.prototype)).constructor=n).className="Method";var l=t(37);function n(t,e,i,n,r,o,s){if(l.isObject(r))s=r,r=o=undefined;else if(l.isObject(o))s=o,o=undefined;if(e!==undefined&&!l.isString(e))throw TypeError("type must be a string");if(!l.isString(i))throw TypeError("requestType must be a string");if(!l.isString(n))throw TypeError("responseType must be a string");a.call(this,t,s),this.type=e||"rpc",this.requestType=i,this.requestStream=r?!0:undefined,this.responseType=n,this.responseStream=o?!0:undefined,this.resolvedRequestType=null,this.resolvedResponseType=null}n.fromJSON=function(t,e){return new n(t,e.type,e.requestType,e.responseType,e.requestStream,e.responseStream,e.options)},n.prototype.toJSON=function(){return l.toObject(["type","rpc"!==this.type&&this.type||undefined,"requestType",this.requestType,"requestStream",this.requestStream,"responseType",this.responseType,"responseStream",this.responseStream,"options",this.options])},n.prototype.resolve=function(){if(this.resolved)return this;else return this.resolvedRequestType=this.parent.lookupType(this.requestType),this.resolvedResponseType=this.parent.lookupType(this.responseType),a.prototype.resolve.call(this)}},{24:24,37:37}],23:[function(t,e,i){e.exports=u;var n=t(24);((u.prototype=Object.create(n.prototype)).constructor=u).className="Namespace";var r,o,s=t(15),a=t(16),l=t(37);function c(t){if(!t||!t.length)return undefined;for(var e={},i=0;i<t.length;++i)e[t[i].name]=t[i].toJSON();return e}function u(t,e){n.call(this,t,e),this.nested=undefined,this._nestedArray=null}function h(t){return t._nestedArray=null,t}u.fromJSON=function(t,e){return new u(t,e.options).addJSON(e.nested)},u.arrayToJSON=c,u.isReservedId=function(t,e){if(t)for(var i=0;i<t.length;++i)if("string"!=typeof t[i]&&t[i][0]<=e&&t[i][1]>=e)return!0;return!1},u.isReservedName=function(t,e){if(t)for(var i=0;i<t.length;++i)if(t[i]===e)return!0;return!1},Object.defineProperty(u.prototype,"nestedArray",{get:function(){return this._nestedArray||(this._nestedArray=l.toArray(this.nested))}}),u.prototype.toJSON=function(){return l.toObject(["options",this.options,"nested",c(this.nestedArray)])},u.prototype.addJSON=function(t){if(t)for(var e,i=Object.keys(t),n=0;n<i.length;++n)e=t[i[n]],this.add((e.fields!==undefined?r.fromJSON:e.values!==undefined?s.fromJSON:e.methods!==undefined?o.fromJSON:e.id!==undefined?a.fromJSON:u.fromJSON)(i[n],e));return this},u.prototype.get=function(t){return this.nested&&this.nested[t]||null},u.prototype.getEnum=function(t){if(this.nested&&this.nested[t]instanceof s)return this.nested[t].values;throw Error("no such enum")},u.prototype.add=function(t){if(!(t instanceof a&&t.extend!==undefined||t instanceof r||t instanceof s||t instanceof o||t instanceof u))throw TypeError("object must be a valid nested object");if(!this.nested)this.nested={};else{var e=this.get(t.name);if(e)if(e instanceof u&&t instanceof u&&!(e instanceof r||e instanceof o)){for(var i=e.nestedArray,n=0;n<i.length;++n)t.add(i[n]);if(this.remove(e),!this.nested)this.nested={};t.setOptions(e.options,!0)}else throw Error("duplicate name '"+t.name+"' in "+this)}return(this.nested[t.name]=t).onAdd(this),h(this)},u.prototype.remove=function(t){if(!(t instanceof n))throw TypeError("object must be a ReflectionObject");if(t.parent!==this)throw Error(t+" is not a member of "+this);if(delete this.nested[t.name],!Object.keys(this.nested).length)this.nested=undefined;return t.onRemove(this),h(this)},u.prototype.define=function(t,e){if(l.isString(t))t=t.split(".");else if(!Array.isArray(t))throw TypeError("illegal path");if(t&&t.length&&""===t[0])throw Error("path must be relative");for(var i=this;0<t.length;){var n=t.shift();if(i.nested&&i.nested[n]){if(!((i=i.nested[n])instanceof u))throw Error("path conflicts with non-namespace objects")}else i.add(i=new u(n))}if(e)i.addJSON(e);return i},u.prototype.resolveAll=function(){for(var t=this.nestedArray,e=0;e<t.length;)if(t[e]instanceof u)t[e++].resolveAll();else t[e++].resolve();return this.resolve()},u.prototype.lookup=function(t,e,i){if("boolean"==typeof e)i=e,e=undefined;else if(e&&!Array.isArray(e))e=[e];if(l.isString(t)&&t.length){if("."===t)return this.root;t=t.split(".")}else if(!t.length)return this;if(""===t[0])return this.root.lookup(t.slice(1),e);var n=this.get(t[0]);if(n){if(1===t.length){if(!e||-1<e.indexOf(n.constructor))return n}else if(n instanceof u&&(n=n.lookup(t.slice(1),e,!0)))return n}else for(var r=0;r<this.nestedArray.length;++r)if(this._nestedArray[r]instanceof u&&(n=this._nestedArray[r].lookup(t,e,!0)))return n;if(null===this.parent||i)return null;else return this.parent.lookup(t,e)},u.prototype.lookupType=function(t){var e=this.lookup(t,[r]);if(!e)throw Error("no such type");return e},u.prototype.lookupEnum=function(t){var e=this.lookup(t,[s]);if(!e)throw Error("no such Enum '"+t+"' in "+this);return e},u.prototype.lookupTypeOrEnum=function(t){var e=this.lookup(t,[r,s]);if(!e)throw Error("no such Type or Enum '"+t+"' in "+this);return e},u.prototype.lookupService=function(t){var e=this.lookup(t,[o]);if(!e)throw Error("no such Service '"+t+"' in "+this);return e},u._configure=function(t,e){r=t,o=e}},{15:15,16:16,24:24,37:37}],24:[function(t,e,i){(e.exports=o).className="ReflectionObject";var n,r=t(37);function o(t,e){if(!r.isString(t))throw TypeError("name must be a string");if(e&&!r.isObject(e))throw TypeError("options must be an object");this.options=e,this.name=t,this.parent=null,this.resolved=!1,this.comment=null,this.filename=null}Object.defineProperties(o.prototype,{root:{get:function(){for(var t=this;null!==t.parent;)t=t.parent;return t}},fullName:{get:function(){for(var t=[this.name],e=this.parent;e;)t.unshift(e.name),e=e.parent;return t.join(".")}}}),o.prototype.toJSON=function(){throw Error()},o.prototype.onAdd=function(t){if(this.parent&&this.parent!==t)this.parent.remove(this);this.parent=t,this.resolved=!1;var e=t.root;if(e instanceof n)e._handleAdd(this)},o.prototype.onRemove=function(t){var e=t.root;if(e instanceof n)e._handleRemove(this);this.parent=null,this.resolved=!1},o.prototype.resolve=function(){if(this.resolved)return this;if(this.root instanceof n)this.resolved=!0;return this},o.prototype.getOption=function(t){if(this.options)return this.options[t];else return undefined},o.prototype.setOption=function(t,e,i){if(!i||!this.options||this.options[t]===undefined)(this.options||(this.options={}))[t]=e;return this},o.prototype.setOptions=function(t,e){if(t)for(var i=Object.keys(t),n=0;n<i.length;++n)this.setOption(i[n],t[i[n]],e);return this},o.prototype.toString=function(){var t=this.constructor.className,e=this.fullName;if(e.length)return t+" "+e;else return t},o._configure=function(t){n=t}},{37:37}],25:[function(t,e,i){e.exports=s;var n=t(24);((s.prototype=Object.create(n.prototype)).constructor=s).className="OneOf";var r=t(16),o=t(37);function s(t,e,i){if(!Array.isArray(e))i=e,e=undefined;if(n.call(this,t,i),e!==undefined&&!Array.isArray(e))throw TypeError("fieldNames must be an Array");this.oneof=e||[],this.fieldsArray=[]}function a(t){if(t.parent)for(var e=0;e<t.fieldsArray.length;++e)if(!t.fieldsArray[e].parent)t.parent.add(t.fieldsArray[e])}s.fromJSON=function(t,e){return new s(t,e.oneof,e.options)},s.prototype.toJSON=function(){return o.toObject(["options",this.options,"oneof",this.oneof])},s.prototype.add=function(t){if(!(t instanceof r))throw TypeError("field must be a Field");if(t.parent&&t.parent!==this.parent)t.parent.remove(t);return this.oneof.push(t.name),this.fieldsArray.push(t),a(t.partOf=this),this},s.prototype.remove=function(t){if(!(t instanceof r))throw TypeError("field must be a Field");var e=this.fieldsArray.indexOf(t);if(e<0)throw Error(t+" is not a member of "+this);if(this.fieldsArray.splice(e,1),-1<(e=this.oneof.indexOf(t.name)))this.oneof.splice(e,1);return t.partOf=null,this},s.prototype.onAdd=function(t){n.prototype.onAdd.call(this,t);for(var e=0;e<this.oneof.length;++e){var i=t.get(this.oneof[e]);if(i&&!i.partOf)(i.partOf=this).fieldsArray.push(i)}a(this)},s.prototype.onRemove=function(t){for(var e,i=0;i<this.fieldsArray.length;++i)if((e=this.fieldsArray[i]).parent)e.parent.remove(e);n.prototype.onRemove.call(this,t)},s.d=function(){for(var i=new Array(arguments.length),t=0;t<arguments.length;)i[t]=arguments[t++];return function(t,e){o.decorateType(t.constructor).add(new s(e,i)),Object.defineProperty(t,e,{get:o.oneOfGetter(i),set:o.oneOfSetter(i)})}}},{16:16,24:24,37:37}],26:[function(t,e,i){(e.exports=Z).filename=null,Z.defaults={keepCase:!1};var M=t(34),R=t(29),L=t(35),D=t(16),N=t(20),B=t(25),F=t(15),j=t(33),G=t(22),V=t(36),U=t(37),W=/^[1-9][0-9]*$/,$=/^-?[1-9][0-9]*$/,H=/^0[x][0-9a-fA-F]+$/,J=/^-?0[x][0-9a-fA-F]+$/,K=/^0[0-7]+$/,q=/^-?0[0-7]+$/,z=/^(?![eE])[0-9]*(?:\.[0-9]*)?(?:[eE][+-]?[0-9]+)?$/,X=/^[a-zA-Z_][a-zA-Z_0-9]*$/,Y=/^(?:\.?[a-zA-Z_][a-zA-Z_0-9]*)+$/,Q=/^(?:\.[a-zA-Z][a-zA-Z_0-9]*)+$/;function Z(t,e,i){if(!(e instanceof R))i=e,e=new R;if(!i)i=Z.defaults;var n,r,o,s,a,l=M(t),c=l.next,u=l.push,h=l.peek,d=l.skip,p=l.cmnt,f=!0,m=!1,g=e,y=i.keepCase?function(t){return t}:U.camelCase;function v(t,e,i){var n=Z.filename;if(!i)Z.filename=null;return Error("illegal "+(e||"token")+" '"+t+"' ("+(n?n+", ":"")+"line "+l.line+")")}function b(){var t,e=[];do{if('"'!==(t=c())&&"'"!==t)throw v(t);e.push(c()),d(t),t=h()}while('"'===t||"'"===t);return e.join("")}function _(e){var i=c();switch(i){case"'":case'"':return u(i),b();case"true":case"TRUE":return!0;case"false":case"FALSE":return!1}try{return function(t,e){var i=1;if("-"===t.charAt(0))i=-1,t=t.substring(1);switch(t){case"inf":case"INF":case"Inf":return i*(1/0);case"nan":case"NAN":case"Nan":case"NaN":return NaN;case"0":return 0}if(W.test(t))return i*parseInt(t,10);if(H.test(t))return i*parseInt(t,16);if(K.test(t))return i*parseInt(t,8);if(z.test(t))return i*parseFloat(t);throw v(t,"number",e)}(i,!0)}catch(t){if(e&&Y.test(i))return i;throw v(i,"value")}}function w(t,e){var i,n;do{if(e&&('"'===(i=h())||"'"===i))t.push(b());else t.push([n=x(c()),d("to",!0)?x(c()):n])}while(d(",",!0));d(";")}function x(t,e){switch(t){case"max":case"MAX":case"Max":return 536870911;case"0":return 0}if(!e&&"-"===t.charAt(0))throw v(t,"id");if($.test(t))return parseInt(t,10);if(J.test(t))return parseInt(t,16);if(q.test(t))return parseInt(t,8);throw v(t,"id")}function S(){if(n!==undefined)throw v("package");if(n=c(),!Y.test(n))throw v(n,"name");g=g.define(n),d(";")}function I(){var t,e=h();switch(e){case"weak":t=o||(o=[]),c();break;case"public":c();default:t=r||(r=[])}e=b(),d(";"),t.push(e)}function T(){if(d("="),s=b(),!(m="proto3"===s)&&"proto2"!==s)throw v(s,"syntax");d(";")}function C(t,e){switch(e){case"option":return E(t,e),d(";"),!0;case"message":return function(t,e){if(!X.test(e=c()))throw v(e,"type name");var i=new L(e);O(i,function(t){if(!C(i,t))switch(t){case"map":!function(t){d("<");var e=c();if(V.mapKey[e]===undefined)throw v(e,"type");d(",");var i=c();if(!Y.test(i))throw v(i,"type");d(">");var n=c();if(!X.test(n))throw v(n,"name");d("=");var r=new N(y(n),x(c()),e,i);O(r,function(t){if("option"===t)E(r,t),d(";");else throw v(t)},function(){k(r)}),t.add(r)}(i);break;case"required":case"optional":case"repeated":P(i,t);break;case"oneof":!function(t,e){if(!X.test(e=c()))throw v(e,"name");var i=new B(y(e));O(i,function(t){if("option"===t)E(i,t),d(";");else u(t),P(i,"optional")}),t.add(i)}(i,t);break;case"extensions":w(i.extensions||(i.extensions=[]));break;case"reserved":w(i.reserved||(i.reserved=[]),!0);break;default:if(!m||!Y.test(t))throw v(t);u(t),P(i,"optional")}}),t.add(i)}(t,e),!0;case"enum":return function(t,e){if(!X.test(e=c()))throw v(e,"name");var i=new F(e);O(i,function(t){switch(t){case"option":E(i,t),d(";");break;case"reserved":w(i.reserved||(i.reserved=[]),!0);break;default:!function(t,e){if(!X.test(e))throw v(e,"name");d("=");var i=x(c(),!0),n={};O(n,function(t){if("option"===t)E(n,t),d(";");else throw v(t)},function(){k(n)}),t.add(e,i,n.comment)}(i,t)}}),t.add(i)}(t,e),!0;case"service":return function(t,e){if(!X.test(e=c()))throw v(e,"service name");var i=new j(e);O(i,function(t){if(!C(i,t))if("rpc"===t)!function(t,e){var i=e;if(!X.test(e=c()))throw v(e,"name");var n,r,o,s,a=e;if(d("("),d("stream",!0))r=!0;if(!Y.test(e=c()))throw v(e);if(n=e,d(")"),d("returns"),d("("),d("stream",!0))s=!0;if(!Y.test(e=c()))throw v(e);o=e,d(")");var l=new G(a,i,n,o,r,s);O(l,function(t){if("option"===t)E(l,t),d(";");else throw v(t)}),t.add(l)}(i,t);else throw v(t)}),t.add(i)}(t,e),!0;case"extend":return function(e,t){if(!Y.test(t=c()))throw v(t,"reference");var i=t;O(null,function(t){switch(t){case"required":case"repeated":case"optional":P(e,t,i);break;default:if(!m||!Y.test(t))throw v(t);u(t),P(e,"optional",i)}})}(t,e),!0}return!1}function O(t,e,i){var n=l.line;if(t)t.comment=p(),t.filename=Z.filename;if(d("{",!0)){for(var r;"}"!==(r=c());)e(r);d(";",!0)}else{if(i)i();if(d(";"),t&&"string"!=typeof t.comment)t.comment=p(n)}}function P(t,e,i){var n=c();if("group"!==n){if(!Y.test(n))throw v(n,"type");var r=c();if(!X.test(r))throw v(r,"name");r=y(r),d("=");var o=new D(r,x(c()),n,e,i);if(O(o,function(t){if("option"===t)E(o,t),d(";");else throw v(t)},function(){k(o)}),t.add(o),!m&&o.repeated&&(V.packed[n]!==undefined||V.basic[n]===undefined))o.setOption("packed",!1,!0)}else!function(t,e){var i=c();if(!X.test(i))throw v(i,"name");var n=U.lcFirst(i);if(i===n)i=U.ucFirst(i);d("=");var r=x(c()),o=new L(i);o.group=!0;var s=new D(n,r,i,e);s.filename=Z.filename,O(o,function(t){switch(t){case"option":E(o,t),d(";");break;case"required":case"optional":case"repeated":P(o,t);break;default:throw v(t)}}),t.add(o).add(s)}(t,e)}function E(t,e){var i=d("(",!0);if(!Y.test(e=c()))throw v(e,"name");var n=e;if(i)if(d(")"),n="("+n+")",e=h(),Q.test(e))n+=e,c();d("="),function t(e,i){if(d("{",!0))do{if(!X.test(a=c()))throw v(a,"name");if("{"===h())t(e,i+"."+a);else if(d(":"),"{"===h())t(e,i+"."+a);else A(e,i+"."+a,_(!0))}while(!d("}",!0));else A(e,i,_(!0))}(t,n)}function A(t,e,i){if(t.setOption)t.setOption(e,i)}function k(t){if(d("[",!0)){for(;E(t,"option"),d(",",!0););d("]")}return t}for(;null!==(a=c());)switch(a){case"package":if(!f)throw v(a);S();break;case"import":if(!f)throw v(a);I();break;case"syntax":if(!f)throw v(a);T();break;case"option":if(!f)throw v(a);E(g,a),d(";");break;default:if(C(g,a)){f=!1;continue}throw v(a)}return Z.filename=null,{package:n,imports:r,weakImports:o,syntax:s,root:e}}},{15:15,16:16,20:20,22:22,25:25,29:29,33:33,34:34,35:35,36:36,37:37}],27:[function(t,e,i){e.exports=l;var n,r=t(39),o=r.LongBits,s=r.utf8;function a(t,e){return RangeError("index out of range: "+t.pos+" + "+(e||1)+" > "+t.len)}function l(t){this.buf=t,this.pos=0,this.len=t.length}var c,u="undefined"!=typeof Uint8Array?function(t){if(t instanceof Uint8Array||Array.isArray(t))return new l(t);throw Error("illegal buffer")}:function(t){if(Array.isArray(t))return new l(t);throw Error("illegal buffer")};function h(){var t=new o(0,0),e=0;if(4<this.len-this.pos){for(;e<4;++e)if(t.lo=(t.lo|(127&this.buf[this.pos])<<7*e)>>>0,this.buf[this.pos++]<128)return t;if(t.lo=(t.lo|(127&this.buf[this.pos])<<28)>>>0,t.hi=(t.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return t;e=0}else{for(;e<3;++e){if(this.pos>=this.len)throw a(this);if(t.lo=(t.lo|(127&this.buf[this.pos])<<7*e)>>>0,this.buf[this.pos++]<128)return t}return t.lo=(t.lo|(127&this.buf[this.pos++])<<7*e)>>>0,t}if(4<this.len-this.pos){for(;e<5;++e)if(t.hi=(t.hi|(127&this.buf[this.pos])<<7*e+3)>>>0,this.buf[this.pos++]<128)return t}else for(;e<5;++e){if(this.pos>=this.len)throw a(this);if(t.hi=(t.hi|(127&this.buf[this.pos])<<7*e+3)>>>0,this.buf[this.pos++]<128)return t}throw Error("invalid varint encoding")}function d(t,e){return(t[e-4]|t[e-3]<<8|t[e-2]<<16|t[e-1]<<24)>>>0}function p(){if(this.pos+8>this.len)throw a(this,8);return new o(d(this.buf,this.pos+=4),d(this.buf,this.pos+=4))}l.create=r.Buffer?function(t){return(l.create=function(t){return r.Buffer.isBuffer(t)?new n(t):u(t)})(t)}:u,l.prototype._slice=r.Array.prototype.subarray||r.Array.prototype.slice,l.prototype.uint32=(c=4294967295,function(){if(c=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128)return c;if(c=(c|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)return c;if(c=(c|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)return c;if(c=(c|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)return c;if(c=(c|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128)return c;if((this.pos+=5)>this.len)throw this.pos=this.len,a(this,10);return c}),l.prototype.int32=function(){return 0|this.uint32()},l.prototype.sint32=function(){var t=this.uint32();return t>>>1^-(1&t)|0},l.prototype.bool=function(){return 0!==this.uint32()},l.prototype.fixed32=function(){if(this.pos+4>this.len)throw a(this,4);return d(this.buf,this.pos+=4)},l.prototype.sfixed32=function(){if(this.pos+4>this.len)throw a(this,4);return 0|d(this.buf,this.pos+=4)},l.prototype.float=function(){if(this.pos+4>this.len)throw a(this,4);var t=r.float.readFloatLE(this.buf,this.pos);return this.pos+=4,t},l.prototype.double=function(){if(this.pos+8>this.len)throw a(this,4);var t=r.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,t},l.prototype.bytes=function(){var t=this.uint32(),e=this.pos,i=this.pos+t;if(i>this.len)throw a(this,t);if(this.pos+=t,Array.isArray(this.buf))return this.buf.slice(e,i);else return e===i?new this.buf.constructor(0):this._slice.call(this.buf,e,i)},l.prototype.string=function(){var t=this.bytes();return s.read(t,0,t.length)},l.prototype.skip=function(t){if("number"==typeof t){if(this.pos+t>this.len)throw a(this,t);this.pos+=t}else do{if(this.pos>=this.len)throw a(this)}while(128&this.buf[this.pos++]);return this},l.prototype.skipType=function(t){switch(t){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;;){if(4==(t=7&this.uint32()))break;this.skipType(t)}break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+t+" at offset "+this.pos)}return this},l._configure=function(t){n=t;var e=r.Long?"toLong":"toNumber";r.merge(l.prototype,{int64:function(){return h.call(this)[e](!1)},uint64:function(){return h.call(this)[e](!0)},sint64:function(){return h.call(this).zzDecode()[e](!1)},fixed64:function(){return p.call(this)[e](!0)},sfixed64:function(){return p.call(this)[e](!1)}})}},{39:39}],28:[function(t,e,i){e.exports=o;var n=t(27);(o.prototype=Object.create(n.prototype)).constructor=o;var r=t(39);function o(t){n.call(this,t)}if(r.Buffer)o.prototype._slice=r.Buffer.prototype.slice;o.prototype.string=function(){var t=this.uint32();return this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+t,this.len))}},{27:27,39:39}],29:[function(t,e,i){e.exports=l;var n=t(23);((l.prototype=Object.create(n.prototype)).constructor=l).className="Root";var r,p,f,o=t(16),s=t(15),a=t(25),m=t(37);function l(t){n.call(this,"",t),this.deferred=[],this.files=[]}function g(){}l.fromJSON=function(t,e){if(!e)e=new l;if(t.options)e.setOptions(t.options);return e.addJSON(t.nested)},l.prototype.resolvePath=m.path.resolve,l.prototype.load=function t(e,o,s){if("function"==typeof o)s=o,o=undefined;var a=this;if(!s)return m.asPromise(t,a,e,o);var l=s===g;function c(t,e){if(s){var i=s;if(s=null,l)throw t;i(t,e)}}function u(t,e){try{if(m.isString(e)&&"{"===e.charAt(0))e=JSON.parse(e);if(!m.isString(e))a.setOptions(e.options).addJSON(e.nested);else{p.filename=t;var i,n=p(e,a,o),r=0;if(n.imports)for(;r<n.imports.length;++r)if(i=a.resolvePath(t,n.imports[r]))h(i);if(n.weakImports)for(r=0;r<n.weakImports.length;++r)if(i=a.resolvePath(t,n.weakImports[r]))h(i,!0)}}catch(t){c(t)}if(!l&&!d)c(null,a)}function h(i,n){var t=i.lastIndexOf("google/protobuf/");if(-1<t){var e=i.substring(t);if(e in f)i=e}if(!(-1<a.files.indexOf(i)))if(a.files.push(i),!(i in f))if(l){var r;try{r=m.fs.readFileSync(i).toString("utf8")}catch(t){if(!n)c(t);return}u(i,r)}else++d,m.fetch(i,function(t,e){if(--d,s)if(!t)u(i,e);else if(!n)c(t);else if(!d)c(null,a)});else if(l)u(i,f[i]);else++d,setTimeout(function(){--d,u(i,f[i])})}var d=0;if(m.isString(e))e=[e];for(var i,n=0;n<e.length;++n)if(i=a.resolvePath("",e[n]))h(i);if(l)return a;if(!d)c(null,a);return undefined},l.prototype.loadSync=function(t,e){if(!m.isNode)throw Error("not supported");return this.load(t,e,g)},l.prototype.resolveAll=function(){if(this.deferred.length)throw Error("unresolvable extensions: "+this.deferred.map(function(t){return"'extend "+t.extend+"' in "+t.parent.fullName}).join(", "));return n.prototype.resolveAll.call(this)};var c=/^[A-Z]/;function u(t,e){var i=e.parent.lookup(e.extend);if(i){var n=new o(e.fullName,e.id,e.type,e.rule,undefined,e.options);return(n.declaringField=e).extensionField=n,i.add(n),!0}return!1}l.prototype._handleAdd=function(t){if(t instanceof o){if(t.extend!==undefined&&!t.extensionField)if(!u(0,t))this.deferred.push(t)}else if(t instanceof s){if(c.test(t.name))t.parent[t.name]=t.values}else if(!(t instanceof a)){if(t instanceof r)for(var e=0;e<this.deferred.length;)if(u(0,this.deferred[e]))this.deferred.splice(e,1);else++e;for(var i=0;i<t.nestedArray.length;++i)this._handleAdd(t._nestedArray[i]);if(c.test(t.name))t.parent[t.name]=t}},l.prototype._handleRemove=function(t){if(t instanceof o){if(t.extend!==undefined)if(t.extensionField)t.extensionField.parent.remove(t.extensionField),t.extensionField=null;else{var e=this.deferred.indexOf(t);if(-1<e)this.deferred.splice(e,1)}}else if(t instanceof s){if(c.test(t.name))delete t.parent[t.name]}else if(t instanceof n){for(var i=0;i<t.nestedArray.length;++i)this._handleRemove(t._nestedArray[i]);if(c.test(t.name))delete t.parent[t.name]}},l._configure=function(t,e,i){r=t,p=e,f=i}},{15:15,16:16,23:23,25:25,37:37}],30:[function(t,e,i){e.exports={}},{}],31:[function(t,e,i){i.Service=t(32)},{32:32}],32:[function(t,e,i){e.exports=n;var a=t(39);function n(t,e,i){if("function"!=typeof t)throw TypeError("rpcImpl must be a function");a.EventEmitter.call(this),this.rpcImpl=t,this.requestDelimited=Boolean(e),this.responseDelimited=Boolean(i)}((n.prototype=Object.create(a.EventEmitter.prototype)).constructor=n).prototype.rpcCall=function t(i,e,n,r,o){if(!r)throw TypeError("request must be specified");var s=this;if(!o)return a.asPromise(t,s,i,e,n,r);if(!s.rpcImpl)return setTimeout(function(){o(Error("already ended"))},0),undefined;try{return s.rpcImpl(i,e[s.requestDelimited?"encodeDelimited":"encode"](r).finish(),function(t,e){if(t)return s.emit("error",t,i),o(t);if(null===e)return s.end(!0),undefined;if(!(e instanceof n))try{e=n[s.responseDelimited?"decodeDelimited":"decode"](e)}catch(t){return s.emit("error",t,i),o(t)}return s.emit("data",e,i),o(null,e)})}catch(t){return s.emit("error",t,i),setTimeout(function(){o(t)},0),undefined}},n.prototype.end=function(t){if(this.rpcImpl){if(!t)this.rpcImpl(null,null,null);this.rpcImpl=null,this.emit("end").off()}return this}},{39:39}],33:[function(t,e,i){e.exports=s;var n=t(23);((s.prototype=Object.create(n.prototype)).constructor=s).className="Service";var o=t(22),a=t(37),l=t(31);function s(t,e){n.call(this,t,e),this.methods={},this._methodsArray=null}function r(t){return t._methodsArray=null,t}s.fromJSON=function(t,e){var i=new s(t,e.options);if(e.methods)for(var n=Object.keys(e.methods),r=0;r<n.length;++r)i.add(o.fromJSON(n[r],e.methods[n[r]]));if(e.nested)i.addJSON(e.nested);return i},s.prototype.toJSON=function(){var t=n.prototype.toJSON.call(this);return a.toObject(["options",t&&t.options||undefined,"methods",n.arrayToJSON(this.methodsArray)||{},"nested",t&&t.nested||undefined])},Object.defineProperty(s.prototype,"methodsArray",{get:function(){return this._methodsArray||(this._methodsArray=a.toArray(this.methods))}}),s.prototype.get=function(t){return this.methods[t]||n.prototype.get.call(this,t)},s.prototype.resolveAll=function(){for(var t=this.methodsArray,e=0;e<t.length;++e)t[e].resolve();return n.prototype.resolve.call(this)},s.prototype.add=function(t){if(this.get(t.name))throw Error("duplicate name '"+t.name+"' in "+this);if(t instanceof o)return r((this.methods[t.name]=t).parent=this);else return n.prototype.add.call(this,t)},s.prototype.remove=function(t){if(t instanceof o){if(this.methods[t.name]!==t)throw Error(t+" is not a member of "+this);return delete this.methods[t.name],t.parent=null,r(this)}return n.prototype.remove.call(this,t)},s.prototype.create=function(t,e,i){for(var n,r=new l.Service(t,e,i),o=0;o<this.methodsArray.length;++o){var s=a.lcFirst((n=this._methodsArray[o]).resolve().name).replace(/[^$\w_]/g,"");r[s]=a.codegen(["r","c"],a.isReserved(s)?s+"_":s)("return this.rpcCall(m,q,s,r,c)")({m:n,q:n.resolvedRequestType.ctor,s:n.resolvedResponseType.ctor})}return r}},{22:22,23:23,31:31,37:37}],34:[function(t,e,i){e.exports=o;var _=/[\s{}=;:[\],'"()<>]/g,w=/(?:"([^"\\]*(?:\\.[^"\\]*)*)")/g,x=/(?:'([^'\\]*(?:\\.[^'\\]*)*)')/g,S=/^ *[*/]+ */,I=/\n/g,T=/\s/,n=/\\(.?)/g,r={0:"\0",r:"\r",n:"\n",t:"\t"};function C(t){return t.replace(n,function(t,e){switch(e){case"\\":case"":return e;default:return r[e]||""}})}function o(a){a=a.toString();var l=0,c=a.length,u=1,s=null,h=null,d=0,p=!1,f=[],m=null;function g(t){return Error("illegal "+t+" (line "+u+")")}function y(t){return a.charAt(t)}function v(t,e){s=a.charAt(t++),d=u,p=!1;var i,n=t-3;do{if(--n<0||"\n"===(i=a.charAt(n))){p=!0;break}}while(" "===i||"\t"===i);for(var r=a.substring(t,e).split(I),o=0;o<r.length;++o)r[o]=r[o].replace(S,"").trim();h=r.join("\n").trim()}function n(){if(0<f.length)return f.shift();if(m)return function(){var t="'"===m?x:w;t.lastIndex=l-1;var e=t.exec(a);if(!e)throw g("string");return l=t.lastIndex,b(m),m=null,C(e[1])}();var t,e,i,n,r;do{if(l===c)return null;for(t=!1;T.test(i=y(l));){if("\n"===i)++u;if(++l===c)return null}if("/"===y(l)){if(++l===c)throw g("comment");if("/"===y(l)){for(r="/"===y(n=l+1);"\n"!==y(++l);)if(l===c)return null;if(++l,r)v(n,l-1);++u,t=!0}else if("*"===(i=y(l))){r="*"===y(n=l+1);do{if("\n"===i)++u;if(++l===c)throw g("comment");e=i,i=y(l)}while("*"!==e||"/"!==i);if(++l,r)v(n,l-2);t=!0}else return"/"}}while(t);var o=l;if(_.lastIndex=0,!_.test(y(o++)))for(;o<c&&!_.test(y(o));)++o;var s=a.substring(l,l=o);if('"'===s||"'"===s)m=s;return s}function b(t){f.push(t)}function r(){if(!f.length){var t=n();if(null===t)return null;b(t)}return f[0]}return Object.defineProperty({next:n,peek:r,push:b,skip:function(t,e){var i=r();if(i===t)return n(),!0;if(!e)throw g("token '"+i+"', '"+t+"' expected");return!1},cmnt:function(t){var e=null;if(t===undefined){if(d===u-1&&("*"===s||p))e=h}else{if(d<t)r();if(d===t&&!p&&"/"===s)e=h}return e}},"line",{get:function(){return u}})}o.unescape=C},{}],35:[function(t,e,i){e.exports=b;var s=t(23);((b.prototype=Object.create(s.prototype)).constructor=b).className="Type";var a=t(15),l=t(25),c=t(16),u=t(20),h=t(33),r=t(21),o=t(27),d=t(42),p=t(37),f=t(14),m=t(13),g=t(40),y=t(12),v=t(41);function b(t,e){s.call(this,t,e),this.fields={},this.oneofs=undefined,this.extensions=undefined,this.reserved=undefined,this.group=undefined,this._fieldsById=null,this._fieldsArray=null,this._oneofsArray=null,this._ctor=null}function n(t){return t._fieldsById=t._fieldsArray=t._oneofsArray=null,delete t.encode,delete t.decode,delete t.verify,t}Object.defineProperties(b.prototype,{fieldsById:{get:function(){if(this._fieldsById)return this._fieldsById;this._fieldsById={};for(var t=Object.keys(this.fields),e=0;e<t.length;++e){var i=this.fields[t[e]],n=i.id;if(this._fieldsById[n])throw Error("duplicate id "+n+" in "+this);this._fieldsById[n]=i}return this._fieldsById}},fieldsArray:{get:function(){return this._fieldsArray||(this._fieldsArray=p.toArray(this.fields))}},oneofsArray:{get:function(){return this._oneofsArray||(this._oneofsArray=p.toArray(this.oneofs))}},ctor:{get:function(){return this._ctor||(this.ctor=b.generateConstructor(this)())},set:function(t){var e=t.prototype;if(!(e instanceof r))(t.prototype=new r).constructor=t,p.merge(t.prototype,e);t.$type=t.prototype.$type=this,p.merge(t,r,!0),this._ctor=t;for(var i=0;i<this.fieldsArray.length;++i)this._fieldsArray[i].resolve();var n={};for(i=0;i<this.oneofsArray.length;++i)n[this._oneofsArray[i].resolve().name]={get:p.oneOfGetter(this._oneofsArray[i].oneof),set:p.oneOfSetter(this._oneofsArray[i].oneof)};if(i)Object.defineProperties(t.prototype,n)}}}),b.generateConstructor=function(t){for(var e,i=p.codegen(["p"],t.name),n=0;n<t.fieldsArray.length;++n)if((e=t._fieldsArray[n]).map)i("this%s={}",p.safeProp(e.name));else if(e.repeated)i("this%s=[]",p.safeProp(e.name));return i("if(p)for(var ks=Object.keys(p),i=0;i<ks.length;++i)if(p[ks[i]]!=null)")("this[ks[i]]=p[ks[i]]")},b.fromJSON=function(t,e){var i=new b(t,e.options);i.extensions=e.extensions,i.reserved=e.reserved;for(var n=Object.keys(e.fields),r=0;r<n.length;++r)i.add((void 0!==e.fields[n[r]].keyType?u.fromJSON:c.fromJSON)(n[r],e.fields[n[r]]));if(e.oneofs)for(n=Object.keys(e.oneofs),r=0;r<n.length;++r)i.add(l.fromJSON(n[r],e.oneofs[n[r]]));if(e.nested)for(n=Object.keys(e.nested),r=0;r<n.length;++r){var o=e.nested[n[r]];i.add((o.id!==undefined?c.fromJSON:o.fields!==undefined?b.fromJSON:o.values!==undefined?a.fromJSON:o.methods!==undefined?h.fromJSON:s.fromJSON)(n[r],o))}if(e.extensions&&e.extensions.length)i.extensions=e.extensions;if(e.reserved&&e.reserved.length)i.reserved=e.reserved;if(e.group)i.group=!0;return i},b.prototype.toJSON=function(){var t=s.prototype.toJSON.call(this);return p.toObject(["options",t&&t.options||undefined,"oneofs",s.arrayToJSON(this.oneofsArray),"fields",s.arrayToJSON(this.fieldsArray.filter(function(t){return!t.declaringField}))||{},"extensions",this.extensions&&this.extensions.length?this.extensions:undefined,"reserved",this.reserved&&this.reserved.length?this.reserved:undefined,"group",this.group||undefined,"nested",t&&t.nested||undefined])},b.prototype.resolveAll=function(){for(var t=this.fieldsArray,e=0;e<t.length;)t[e++].resolve();var i=this.oneofsArray;for(e=0;e<i.length;)i[e++].resolve();return s.prototype.resolveAll.call(this)},b.prototype.get=function(t){return this.fields[t]||this.oneofs&&this.oneofs[t]||this.nested&&this.nested[t]||null},b.prototype.add=function(t){if(this.get(t.name))throw Error("duplicate name '"+t.name+"' in "+this);if(t instanceof c&&t.extend===undefined){if(this._fieldsById?this._fieldsById[t.id]:this.fieldsById[t.id])throw Error("duplicate id "+t.id+" in "+this);if(this.isReservedId(t.id))throw Error("id "+t.id+" is reserved in "+this);if(this.isReservedName(t.name))throw Error("name '"+t.name+"' is reserved in "+this);if(t.parent)t.parent.remove(t);return(this.fields[t.name]=t).message=this,t.onAdd(this),n(this)}if(t instanceof l){if(!this.oneofs)this.oneofs={};return(this.oneofs[t.name]=t).onAdd(this),n(this)}return s.prototype.add.call(this,t)},b.prototype.remove=function(t){if(t instanceof c&&t.extend===undefined){if(!this.fields||this.fields[t.name]!==t)throw Error(t+" is not a member of "+this);return delete this.fields[t.name],t.parent=null,t.onRemove(this),n(this)}if(t instanceof l){if(!this.oneofs||this.oneofs[t.name]!==t)throw Error(t+" is not a member of "+this);return delete this.oneofs[t.name],t.parent=null,t.onRemove(this),n(this)}return s.prototype.remove.call(this,t)},b.prototype.isReservedId=function(t){return s.isReservedId(this.reserved,t)},b.prototype.isReservedName=function(t){return s.isReservedName(this.reserved,t)},b.prototype.create=function(t){return new this.ctor(t)},b.prototype.setup=function(){for(var t=this.fullName,e=[],i=0;i<this.fieldsArray.length;++i)e.push(this._fieldsArray[i].resolve().resolvedType);this.encode=f(this)({Writer:d,types:e,util:p}),this.decode=m(this)({Reader:o,types:e,util:p}),this.verify=g(this)({types:e,util:p}),this.fromObject=y.fromObject(this)({types:e,util:p}),this.toObject=y.toObject(this)({types:e,util:p});var n=v[t];if(n){var r=Object.create(this);r.fromObject=this.fromObject,this.fromObject=n.fromObject.bind(r),r.toObject=this.toObject,this.toObject=n.toObject.bind(r)}return this},b.prototype.encode=function(t,e){return this.setup().encode(t,e)},b.prototype.encodeDelimited=function(t,e){return this.encode(t,e&&e.len?e.fork():e).ldelim()},b.prototype.decode=function(t,e){return this.setup().decode(t,e)},b.prototype.decodeDelimited=function(t){if(!(t instanceof o))t=o.create(t);return this.decode(t,t.uint32())},b.prototype.verify=function(t){return this.setup().verify(t)},b.prototype.fromObject=function(t){return this.setup().fromObject(t)},b.prototype.toObject=function(t,e){return this.setup().toObject(t,e)},b.d=function(e){return function(t){p.decorateType(t,e)}}},{12:12,13:13,14:14,15:15,16:16,20:20,21:21,23:23,25:25,27:27,33:33,37:37,40:40,41:41,42:42}],36:[function(t,e,i){var n=i,r=t(37),o=["double","float","int32","uint32","sint32","fixed32","sfixed32","int64","uint64","sint64","fixed64","sfixed64","bool","string","bytes"];function s(t,e){var i=0,n={};for(e|=0;i<t.length;)n[o[i+e]]=t[i++];return n}n.basic=s([1,5,0,0,0,5,5,0,0,0,1,1,0,2,2]),n.defaults=s([0,0,0,0,0,0,0,0,0,0,0,0,!1,"",r.emptyArray,null]),n.long=s([0,0,0,1,1],7),n.mapKey=s([0,0,0,5,5,0,0,0,1,1,0,2],2),n.packed=s([1,5,0,0,0,5,5,0,0,0,1,1,0])},{37:37}],37:[function(n,t,e){var r,i,o=t.exports=n(39),s=n(30);o.codegen=n(3),o.fetch=n(5),o.path=n(8),o.fs=o.inquire("fs"),o.toArray=function(t){if(t){for(var e=Object.keys(t),i=new Array(e.length),n=0;n<e.length;)i[n]=t[e[n++]];return i}return[]},o.toObject=function(t){for(var e={},i=0;i<t.length;){var n=t[i++],r=t[i++];if(r!==undefined)e[n]=r}return e};var a=/\\/g,l=/"/g;o.isReserved=function(t){return/^(?:do|if|in|for|let|new|try|var|case|else|enum|eval|false|null|this|true|void|with|break|catch|class|const|super|throw|while|yield|delete|export|import|public|return|static|switch|typeof|default|extends|finally|package|private|continue|debugger|function|arguments|interface|protected|implements|instanceof)$/.test(t)},o.safeProp=function(t){if(!/^[$\w_]+$/.test(t)||o.isReserved(t))return'["'+t.replace(a,"\\\\").replace(l,'\\"')+'"]';else return"."+t},o.ucFirst=function(t){return t.charAt(0).toUpperCase()+t.substring(1)};var c=/_([a-z])/g;o.camelCase=function(t){return t.substring(0,1)+t.substring(1).replace(c,function(t,e){return e.toUpperCase()})},o.compareFieldsById=function(t,e){return t.id-e.id},o.decorateType=function(t,e){if(t.$type){if(e&&t.$type.name!==e)o.decorateRoot.remove(t.$type),t.$type.name=e,o.decorateRoot.add(t.$type);return t.$type}if(!r)r=n(35);var i=new r(e||t.name);return o.decorateRoot.add(i),i.ctor=t,Object.defineProperty(t,"$type",{value:i,enumerable:!1}),Object.defineProperty(t.prototype,"$type",{value:i,enumerable:!1}),i};var u=0;o.decorateEnum=function(t){if(t.$type)return t.$type;if(!i)i=n(15);var e=new i("Enum"+u++,t);return o.decorateRoot.add(e),Object.defineProperty(t,"$type",{value:e,enumerable:!1}),e},Object.defineProperty(o,"decorateRoot",{get:function(){return s.decorated||(s.decorated=new(n(29)))}})},{15:15,29:29,3:3,30:30,35:35,39:39,5:5,8:8}],38:[function(t,e,i){e.exports=r;var n=t(39);function r(t,e){this.lo=t>>>0,this.hi=e>>>0}var o=r.zero=new r(0,0);o.toNumber=function(){return 0},o.zzEncode=o.zzDecode=function(){return this},o.length=function(){return 1};var s=r.zeroHash="\0\0\0\0\0\0\0\0";r.fromNumber=function(t){if(0===t)return o;var e=t<0;if(e)t=-t;var i=t>>>0,n=(t-i)/4294967296>>>0;if(e)if(n=~n>>>0,i=~i>>>0,4294967295<++i)if(i=0,4294967295<++n)n=0;return new r(i,n)},r.from=function(t){if("number"==typeof t)return r.fromNumber(t);if(n.isString(t))if(n.Long)t=n.Long.fromString(t);else return r.fromNumber(parseInt(t,10));return t.low||t.high?new r(t.low>>>0,t.high>>>0):o},r.prototype.toNumber=function(t){if(!t&&this.hi>>>31){var e=1+~this.lo>>>0,i=~this.hi>>>0;if(!e)i=i+1>>>0;return-(e+4294967296*i)}return this.lo+4294967296*this.hi},r.prototype.toLong=function(t){return n.Long?new n.Long(0|this.lo,0|this.hi,Boolean(t)):{low:0|this.lo,high:0|this.hi,unsigned:Boolean(t)}};var a=String.prototype.charCodeAt;r.fromHash=function(t){if(t===s)return o;else return new r((a.call(t,0)|a.call(t,1)<<8|a.call(t,2)<<16|a.call(t,3)<<24)>>>0,(a.call(t,4)|a.call(t,5)<<8|a.call(t,6)<<16|a.call(t,7)<<24)>>>0)},r.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},r.prototype.zzEncode=function(){var t=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^t)>>>0,this.lo=(this.lo<<1^t)>>>0,this},r.prototype.zzDecode=function(){var t=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^t)>>>0,this.hi=(this.hi>>>1^t)>>>0,this},r.prototype.length=function(){var t=this.lo,e=(this.lo>>>28|this.hi<<4)>>>0,i=this.hi>>>24;return 0===i?0===e?t<16384?t<128?1:2:t<2097152?3:4:e<16384?e<128?5:6:e<2097152?7:8:i<128?9:10}},{39:39}],39:[function(t,e,i){var n=i;function r(t,e,i){for(var n=Object.keys(e),r=0;r<n.length;++r)if(t[n[r]]===undefined||!i)t[n[r]]=e[n[r]];return t}function o(t){function i(t,e){if(!(this instanceof i))return new i(t,e);if(Object.defineProperty(this,"message",{get:function(){return t}}),Error.captureStackTrace)Error.captureStackTrace(this,i);else Object.defineProperty(this,"stack",{value:(new Error).stack||""});if(e)r(this,e)}return(i.prototype=Object.create(Error.prototype)).constructor=i,Object.defineProperty(i.prototype,"name",{get:function(){return t}}),i.prototype.toString=function(){return this.name+": "+this.message},i}n.asPromise=t(1),n.base64=t(2),n.EventEmitter=t(4),n.float=t(6),n.inquire=t(7),n.utf8=t(10),n.pool=t(9),n.LongBits=t(38),n.emptyArray=Object.freeze?Object.freeze([]):[],n.emptyObject=Object.freeze?Object.freeze({}):{},n.isNode=Boolean(global.process&&global.process.versions&&global.process.versions.node),n.isInteger=Number.isInteger||function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t},n.isString=function(t){return"string"==typeof t||t instanceof String},n.isObject=function(t){return t&&"object"===_typeof(t)},n.isset=n.isSet=function(t,e){var i=t[e];if(null!=i&&t.hasOwnProperty(e))return"object"!==_typeof(i)||0<(Array.isArray(i)?i.length:Object.keys(i).length);else return!1},n.Buffer=function(){try{var t=n.inquire("buffer").Buffer;return t.prototype.utf8Write?t:null}catch(t){return null}}(),n._Buffer_from=null,n._Buffer_allocUnsafe=null,n.newBuffer=function(t){return"number"==typeof t?n.Buffer?n._Buffer_allocUnsafe(t):new n.Array(t):n.Buffer?n._Buffer_from(t):"undefined"==typeof Uint8Array?t:new Uint8Array(t)},n.Array="undefined"!=typeof Uint8Array?Uint8Array:Array,n.Long=global.dcodeIO&&global.dcodeIO.Long||n.inquire("long"),n.key2Re=/^true|false|0|1$/,n.key32Re=/^-?(?:0|[1-9][0-9]*)$/,n.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,n.longToHash=function(t){return t?n.LongBits.from(t).toHash():n.LongBits.zeroHash},n.longFromHash=function(t,e){var i=n.LongBits.fromHash(t);if(n.Long)return n.Long.fromBits(i.lo,i.hi,e);else return i.toNumber(Boolean(e))},n.merge=r,n.lcFirst=function(t){return t.charAt(0).toLowerCase()+t.substring(1)},n.newError=o,n.ProtocolError=o("ProtocolError"),n.oneOfGetter=function(t){for(var i={},e=0;e<t.length;++e)i[t[e]]=1;return function(){for(var t=Object.keys(this),e=t.length-1;-1<e;--e)if(1===i[t[e]]&&this[t[e]]!==undefined&&null!==this[t[e]])return t[e]}},n.oneOfSetter=function(i){return function(t){for(var e=0;e<i.length;++e)if(i[e]!==t)delete this[i[e]]}},n.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},n._configure=function(){var i=n.Buffer;if(i)n._Buffer_from=i.from!==Uint8Array.from&&i.from||function(t,e){return new i(t,e)},n._Buffer_allocUnsafe=i.allocUnsafe||function(t){return new i(t)};else n._Buffer_from=n._Buffer_allocUnsafe=null}},{1:1,10:10,2:2,38:38,4:4,6:6,7:7,9:9}],40:[function(t,e,i){e.exports=function(t){var e=l.codegen(["m"],t.name+"$verify")('if(typeof m!=="object"||m===null)')("return%j","object expected"),i=t.oneofsArray,n={};if(i.length)e("var p={}");for(var r=0;r<t.fieldsArray.length;++r){var o=t._fieldsArray[r].resolve(),s="m"+l.safeProp(o.name);if(o.optional)e("if(%s!=null&&m.hasOwnProperty(%j)){",s,o.name);if(o.map)e("if(!util.isObject(%s))",s)("return%j",c(o,"object"))("var k=Object.keys(%s)",s)("for(var i=0;i<k.length;++i){"),h(e,o,"k[i]"),u(e,o,r,s+"[k[i]]")("}");else if(o.repeated)e("if(!Array.isArray(%s))",s)("return%j",c(o,"array"))("for(var i=0;i<%s.length;++i){",s),u(e,o,r,s+"[i]")("}");else{if(o.partOf){var a=l.safeProp(o.partOf.name);if(1===n[o.partOf.name])e("if(p%s===1)",a)("return%j",o.partOf.name+": multiple values");n[o.partOf.name]=1,e("p%s=1",a)}u(e,o,r,s)}if(o.optional)e("}")}return e("return null")};var s=t(15),l=t(37);function c(t,e){return t.name+": "+e+(t.repeated&&"array"!==e?"[]":t.map&&"object"!==e?"{k:"+t.keyType+"}":"")+" expected"}function u(t,e,i,n){if(e.resolvedType)if(e.resolvedType instanceof s){t("switch(%s){",n)("default:")("return%j",c(e,"enum value"));for(var r=Object.keys(e.resolvedType.values),o=0;o<r.length;++o)t("case %i:",e.resolvedType.values[r[o]]);t("break")("}")}else t("{")("var e=types[%i].verify(%s);",i,n)("if(e)")("return%j+e",e.name+".")("}");else switch(e.type){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":t("if(!util.isInteger(%s))",n)("return%j",c(e,"integer"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":t("if(!util.isInteger(%s)&&!(%s&&util.isInteger(%s.low)&&util.isInteger(%s.high)))",n,n,n,n)("return%j",c(e,"integer|Long"));break;case"float":case"double":t('if(typeof %s!=="number")',n)("return%j",c(e,"number"));break;case"bool":t('if(typeof %s!=="boolean")',n)("return%j",c(e,"boolean"));break;case"string":t("if(!util.isString(%s))",n)("return%j",c(e,"string"));break;case"bytes":t('if(!(%s&&typeof %s.length==="number"||util.isString(%s)))',n,n,n)("return%j",c(e,"buffer"))}return t}function h(t,e,i){switch(e.keyType){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":t("if(!util.key32Re.test(%s))",i)("return%j",c(e,"integer key"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":t("if(!util.key64Re.test(%s))",i)("return%j",c(e,"integer|Long key"));break;case"bool":t("if(!util.key2Re.test(%s))",i)("return%j",c(e,"boolean key"))}return t}},{15:15,37:37}],41:[function(t,e,i){var n=i,o=t(21);n[".google.protobuf.Any"]={fromObject:function(t){if(t&&t["@type"]){var e=this.lookup(t["@type"]);if(e){var i="."===t["@type"].charAt(0)?t["@type"].substr(1):t["@type"];return this.create({type_url:"/"+i,value:e.encode(e.fromObject(t)).finish()})}}return this.fromObject(t)},toObject:function(t,e){if(e&&e.json&&t.type_url&&t.value){var i=t.type_url.substring(t.type_url.lastIndexOf("/")+1),n=this.lookup(i);if(n)t=n.decode(t.value)}if(t instanceof this.ctor||!(t instanceof o))return this.toObject(t,e);var r=t.$type.toObject(t,e);return r["@type"]=t.$type.fullName,r}}},{21:21}],42:[function(t,e,i){e.exports=h;var n,r=t(39),o=r.LongBits,s=r.base64,a=r.utf8;function l(t,e,i){this.fn=t,this.len=e,this.next=undefined,this.val=i}function c(){}function u(t){this.head=t.head,this.tail=t.tail,this.len=t.len,this.next=t.states}function h(){this.len=0,this.head=new l(c,0,0),this.tail=this.head,this.states=null}if(h.create=r.Buffer?function(){return(h.create=function(){return new n})()}:function(){return new h},h.alloc=function(t){return new r.Array(t)},r.Array!==Array)h.alloc=r.pool(h.alloc,r.Array.prototype.subarray);function d(t,e,i){e[i]=255&t}function p(t,e){this.len=t,this.next=undefined,this.val=e}function f(t,e,i){for(;t.hi;)e[i++]=127&t.lo|128,t.lo=(t.lo>>>7|t.hi<<25)>>>0,t.hi>>>=7;for(;127<t.lo;)e[i++]=127&t.lo|128,t.lo=t.lo>>>7;e[i++]=t.lo}function m(t,e,i){e[i]=255&t,e[i+1]=t>>>8&255,e[i+2]=t>>>16&255,e[i+3]=t>>>24}h.prototype._push=function(t,e,i){return this.tail=this.tail.next=new l(t,e,i),this.len+=e,this},(p.prototype=Object.create(l.prototype)).fn=function(t,e,i){for(;127<t;)e[i++]=127&t|128,t>>>=7;e[i]=t},h.prototype.uint32=function(t){return this.len+=(this.tail=this.tail.next=new p((t>>>=0)<128?1:t<16384?2:t<2097152?3:t<268435456?4:5,t)).len,this},h.prototype.int32=function(t){return t<0?this._push(f,10,o.fromNumber(t)):this.uint32(t)},h.prototype.sint32=function(t){return this.uint32((t<<1^t>>31)>>>0)},h.prototype.int64=h.prototype.uint64=function(t){var e=o.from(t);return this._push(f,e.length(),e)},h.prototype.sint64=function(t){var e=o.from(t).zzEncode();return this._push(f,e.length(),e)},h.prototype.bool=function(t){return this._push(d,1,t?1:0)},h.prototype.sfixed32=h.prototype.fixed32=function(t){return this._push(m,4,t>>>0)},h.prototype.sfixed64=h.prototype.fixed64=function(t){var e=o.from(t);return this._push(m,4,e.lo)._push(m,4,e.hi)},h.prototype.float=function(t){return this._push(r.float.writeFloatLE,4,t)},h.prototype.double=function(t){return this._push(r.float.writeDoubleLE,8,t)};var g=r.Array.prototype.set?function(t,e,i){e.set(t,i)}:function(t,e,i){for(var n=0;n<t.length;++n)e[i+n]=t[n]};h.prototype.bytes=function(t){var e=t.length>>>0;if(!e)return this._push(d,1,0);if(r.isString(t)){var i=h.alloc(e=s.length(t));s.decode(t,i,0),t=i}return this.uint32(e)._push(g,e,t)},h.prototype.string=function(t){var e=a.length(t);return e?this.uint32(e)._push(a.write,e,t):this._push(d,1,0)},h.prototype.fork=function(){return this.states=new u(this),this.head=this.tail=new l(c,0,0),this.len=0,this},h.prototype.reset=function(){if(this.states)this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next;else this.head=this.tail=new l(c,0,0),this.len=0;return this},h.prototype.ldelim=function(){var t=this.head,e=this.tail,i=this.len;if(this.reset().uint32(i),i)this.tail.next=t.next,this.tail=e,this.len+=i;return this},h.prototype.finish=function(){for(var t=this.head.next,e=this.constructor.alloc(this.len),i=0;t;)t.fn(t.val,e,i),i+=t.len,t=t.next;return e},h._configure=function(t){n=t}},{39:39}],43:[function(t,e,i){e.exports=s;var n=t(42);(s.prototype=Object.create(n.prototype)).constructor=s;var r=t(39),o=r.Buffer;function s(){n.call(this)}s.alloc=function(t){return(s.alloc=r._Buffer_allocUnsafe)(t)};var a=o&&o.prototype instanceof Uint8Array&&"set"===o.prototype.set.name?function(t,e,i){e.set(t,i)}:function(t,e,i){if(t.copy)t.copy(e,i,0,t.length);else for(var n=0;n<t.length;)e[i++]=t[n++]};function l(t,e,i){if(t.length<40)r.utf8.write(t,e,i);else e.utf8Write(t,i)}s.prototype.bytes=function(t){if(r.isString(t))t=r._Buffer_from(t,"base64");var e=t.length>>>0;if(this.uint32(e),e)this._push(a,e,t);return this},s.prototype.string=function(t){var e=o.byteLength(t);if(this.uint32(e),e)this._push(l,e,t);return this}},{39:39,42:42}]},{},[19])}("object"===(void 0===window?"undefined":_typeof(window))&&window||"object"===("undefined"==typeof self?"undefined":_typeof(self))&&self||void 0);var $protobuf=window.protobuf;$protobuf.roots.default=window;var $Reader=$protobuf.Reader,$Writer=$protobuf.Writer,$util=$protobuf.util,$root=$protobuf.roots.default||($protobuf.roots.default={}),mJa,nJa,Ema;$root.game=(Ema={},Ema.BattlePlayer=function(){function e(t){if(t)for(var e=Object.keys(t),i=0;i<e.length;++i)if(null!=t[e[i]])this[e[i]]=t[e[i]]}return e.prototype.cid="",e.prototype.glov="",e.prototype.robotic=!1,e.prototype.attackable=!1,e.create=function(t){return new e(t)},e.encode=function(t,e){if(!e)e=$Writer.create();return e.uint32(10).string(t.cid),e.uint32(18).string(t.glov),e.uint32(24).bool(t.robotic),e.uint32(32).bool(t.attackable),e},e.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},e.decode=function(t,e){if(!(t instanceof $Reader))t=$Reader.create(t);for(var i=void 0===e?t.len:t.pos+e,n=new $root.game.BattlePlayer;t.pos<i;){var r=t.uint32();switch(r>>>3){case 1:n.cid=t.string();break;case 2:n.glov=t.string();break;case 3:n.robotic=t.bool();break;case 4:n.attackable=t.bool();break;default:t.skipType(7&r)}}if(!n.hasOwnProperty("cid"))throw $util.ProtocolError("missing required 'cid'",{instance:n});if(!n.hasOwnProperty("glov"))throw $util.ProtocolError("missing required 'glov'",{instance:n});if(!n.hasOwnProperty("robotic"))throw $util.ProtocolError("missing required 'robotic'",{instance:n});if(!n.hasOwnProperty("attackable"))throw $util.ProtocolError("missing required 'attackable'",{instance:n});return n},e.decodeDelimited=function(t){if(!(t instanceof $Reader))t=new $Reader(t);return this.decode(t,t.uint32())},e.verify=function(t){if("object"!==_typeof(t)||null===t)return"object expected";if(!$util.isString(t.cid))return"cid: string expected";if(!$util.isString(t.glov))return"glov: string expected";if("boolean"!=typeof t.robotic)return"robotic: boolean expected";if("boolean"!=typeof t.attackable)return"attackable: boolean expected";else return null},e.fromObject=function(t){if(t instanceof $root.game.BattlePlayer)return t;var e=new $root.game.BattlePlayer;if(null!=t.cid)e.cid=String(t.cid);if(null!=t.glov)e.glov=String(t.glov);if(null!=t.robotic)e.robotic=Boolean(t.robotic);if(null!=t.attackable)e.attackable=Boolean(t.attackable);return e},e.toObject=function(t,e){if(!e)e={};var i={};if(e.defaults)i.cid="",i.glov="",i.robotic=!1,i.attackable=!1;if(null!=t.cid&&t.hasOwnProperty("cid"))i.cid=t.cid;if(null!=t.glov&&t.hasOwnProperty("glov"))i.glov=t.glov;if(null!=t.robotic&&t.hasOwnProperty("robotic"))i.robotic=t.robotic;if(null!=t.attackable&&t.hasOwnProperty("attackable"))i.attackable=t.attackable;return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),Ema.BattleStartMatchReq=function(){function e(t){if(t)for(var e=Object.keys(t),i=0;i<e.length;++i)if(null!=t[e[i]])this[e[i]]=t[e[i]]}return e.prototype.instanceId="",e.prototype.pluginId="",e.create=function(t){return new e(t)},e.encode=function(t,e){if(!e)e=$Writer.create();return e.uint32(10).string(t.instanceId),e.uint32(18).string(t.pluginId),e},e.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},e.decode=function(t,e){if(!(t instanceof $Reader))t=$Reader.create(t);for(var i=void 0===e?t.len:t.pos+e,n=new $root.game.BattleStartMatchReq;t.pos<i;){var r=t.uint32();switch(r>>>3){case 1:n.instanceId=t.string();break;case 2:n.pluginId=t.string();break;default:t.skipType(7&r)}}if(!n.hasOwnProperty("instanceId"))throw $util.ProtocolError("missing required 'instanceId'",{instance:n});if(!n.hasOwnProperty("pluginId"))throw $util.ProtocolError("missing required 'pluginId'",{instance:n});return n},e.decodeDelimited=function(t){if(!(t instanceof $Reader))t=new $Reader(t);return this.decode(t,t.uint32())},e.verify=function(t){if("object"!==_typeof(t)||null===t)return"object expected";if(!$util.isString(t.instanceId))return"instanceId: string expected";if(!$util.isString(t.pluginId))return"pluginId: string expected";else return null},e.fromObject=function(t){if(t instanceof $root.game.BattleStartMatchReq)return t;var e=new $root.game.BattleStartMatchReq;if(null!=t.instanceId)e.instanceId=String(t.instanceId);if(null!=t.pluginId)e.pluginId=String(t.pluginId);return e},e.toObject=function(t,e){if(!e)e={};var i={};if(e.defaults)i.instanceId="",i.pluginId="";if(null!=t.instanceId&&t.hasOwnProperty("instanceId"))i.instanceId=t.instanceId;if(null!=t.pluginId&&t.hasOwnProperty("pluginId"))i.pluginId=t.pluginId;return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),Ema.BattleStartMatchResp=function(){function e(t){if(t)for(var e=Object.keys(t),i=0;i<e.length;++i)if(null!=t[e[i]])this[e[i]]=t[e[i]]}return e.prototype.code=0,e.prototype.info="",e.prototype.instanceId="",e.prototype.pluginId="",e.create=function(t){return new e(t)},e.encode=function(t,e){if(!e)e=$Writer.create();return e.uint32(8).int32(t.code),e.uint32(18).string(t.info),e.uint32(26).string(t.instanceId),e.uint32(34).string(t.pluginId),e},e.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},e.decode=function(t,e){if(!(t instanceof $Reader))t=$Reader.create(t);for(var i=void 0===e?t.len:t.pos+e,n=new $root.game.BattleStartMatchResp;t.pos<i;){var r=t.uint32();switch(r>>>3){case 1:n.code=t.int32();break;case 2:n.info=t.string();break;case 3:n.instanceId=t.string();break;case 4:n.pluginId=t.string();break;default:t.skipType(7&r)}}if(!n.hasOwnProperty("code"))throw $util.ProtocolError("missing required 'code'",{instance:n});if(!n.hasOwnProperty("info"))throw $util.ProtocolError("missing required 'info'",{instance:n});if(!n.hasOwnProperty("instanceId"))throw $util.ProtocolError("missing required 'instanceId'",{instance:n});if(!n.hasOwnProperty("pluginId"))throw $util.ProtocolError("missing required 'pluginId'",{instance:n});return n},e.decodeDelimited=function(t){if(!(t instanceof $Reader))t=new $Reader(t);return this.decode(t,t.uint32())},e.verify=function(t){if("object"!==_typeof(t)||null===t)return"object expected";if(!$util.isInteger(t.code))return"code: integer expected";if(!$util.isString(t.info))return"info: string expected";if(!$util.isString(t.instanceId))return"instanceId: string expected";if(!$util.isString(t.pluginId))return"pluginId: string expected";else return null},e.fromObject=function(t){if(t instanceof $root.game.BattleStartMatchResp)return t;var e=new $root.game.BattleStartMatchResp;if(null!=t.code)e.code=0|t.code;if(null!=t.info)e.info=String(t.info);if(null!=t.instanceId)e.instanceId=String(t.instanceId);if(null!=t.pluginId)e.pluginId=String(t.pluginId);return e},e.toObject=function(t,e){if(!e)e={};var i={};if(e.defaults)i.code=0,i.info="",i.instanceId="",i.pluginId="";if(null!=t.code&&t.hasOwnProperty("code"))i.code=t.code;if(null!=t.info&&t.hasOwnProperty("info"))i.info=t.info;if(null!=t.instanceId&&t.hasOwnProperty("instanceId"))i.instanceId=t.instanceId;if(null!=t.pluginId&&t.hasOwnProperty("pluginId"))i.pluginId=t.pluginId;return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),Ema.BattleFinishMatchNoti=function(){function e(t){if(this.players=[],t)for(var e=Object.keys(t),i=0;i<e.length;++i)if(null!=t[e[i]])this[e[i]]=t[e[i]]}return e.prototype.instanceId="",e.prototype.pluginId="",e.prototype.roomId="",e.prototype.players=$util.emptyArray,e.create=function(t){return new e(t)},e.encode=function(t,e){if(!e)e=$Writer.create();if(e.uint32(10).string(t.instanceId),e.uint32(18).string(t.pluginId),e.uint32(26).string(t.roomId),null!=t.players&&t.players.length)for(var i=0;i<t.players.length;++i)$root.game.BattlePlayer.encode(t.players[i],e.uint32(34).fork()).ldelim();return e},e.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},e.decode=function(t,e){if(!(t instanceof $Reader))t=$Reader.create(t);for(var i=void 0===e?t.len:t.pos+e,n=new $root.game.BattleFinishMatchNoti;t.pos<i;){var r=t.uint32();switch(r>>>3){case 1:n.instanceId=t.string();break;case 2:n.pluginId=t.string();break;case 3:n.roomId=t.string();break;case 4:if(!n.players||!n.players.length)n.players=[];n.players.push($root.game.BattlePlayer.decode(t,t.uint32()));break;default:t.skipType(7&r)}}if(!n.hasOwnProperty("instanceId"))throw $util.ProtocolError("missing required 'instanceId'",{instance:n});if(!n.hasOwnProperty("pluginId"))throw $util.ProtocolError("missing required 'pluginId'",{instance:n});if(!n.hasOwnProperty("roomId"))throw $util.ProtocolError("missing required 'roomId'",{instance:n});return n},e.decodeDelimited=function(t){if(!(t instanceof $Reader))t=new $Reader(t);return this.decode(t,t.uint32())},e.verify=function(t){if("object"!==_typeof(t)||null===t)return"object expected";if(!$util.isString(t.instanceId))return"instanceId: string expected";if(!$util.isString(t.pluginId))return"pluginId: string expected";if(!$util.isString(t.roomId))return"roomId: string expected";if(null!=t.players&&t.hasOwnProperty("players")){if(!Array.isArray(t.players))return"players: array expected";for(var e=0;e<t.players.length;++e){var i=$root.game.BattlePlayer.verify(t.players[e]);if(i)return"players."+i}}return null},e.fromObject=function(t){if(t instanceof $root.game.BattleFinishMatchNoti)return t;var e=new $root.game.BattleFinishMatchNoti;if(null!=t.instanceId)e.instanceId=String(t.instanceId);if(null!=t.pluginId)e.pluginId=String(t.pluginId);if(null!=t.roomId)e.roomId=String(t.roomId);if(t.players){if(!Array.isArray(t.players))throw TypeError(".game.BattleFinishMatchNoti.players: array expected");e.players=[];for(var i=0;i<t.players.length;++i){if("object"!==_typeof(t.players[i]))throw TypeError(".game.BattleFinishMatchNoti.players: object expected");e.players[i]=$root.game.BattlePlayer.fromObject(t.players[i])}}return e},e.toObject=function(t,e){if(!e)e={};var i={};if(e.arrays||e.defaults)i.players=[];if(e.defaults)i.instanceId="",i.pluginId="",i.roomId="";if(null!=t.instanceId&&t.hasOwnProperty("instanceId"))i.instanceId=t.instanceId;if(null!=t.pluginId&&t.hasOwnProperty("pluginId"))i.pluginId=t.pluginId;if(null!=t.roomId&&t.hasOwnProperty("roomId"))i.roomId=t.roomId;if(t.players&&t.players.length){i.players=[];for(var n=0;n<t.players.length;++n)i.players[n]=$root.game.BattlePlayer.toObject(t.players[n],e)}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),Ema.BattleReadyPKReq=function(){function e(t){if(t)for(var e=Object.keys(t),i=0;i<e.length;++i)if(null!=t[e[i]])this[e[i]]=t[e[i]]}return e.prototype.instanceId="",e.prototype.pluginId="",e.prototype.roomId="",e.prototype.round=0,e.prototype.attackerId="",e.create=function(t){return new e(t)},e.encode=function(t,e){if(!e)e=$Writer.create();return e.uint32(10).string(t.instanceId),e.uint32(18).string(t.pluginId),e.uint32(26).string(t.roomId),e.uint32(32).int32(t.round),e.uint32(42).string(t.attackerId),e},e.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},e.decode=function(t,e){if(!(t instanceof $Reader))t=$Reader.create(t);for(var i=void 0===e?t.len:t.pos+e,n=new $root.game.BattleReadyPKReq;t.pos<i;){var r=t.uint32();switch(r>>>3){case 1:n.instanceId=t.string();break;case 2:n.pluginId=t.string();break;case 3:n.roomId=t.string();break;case 4:n.round=t.int32();break;case 5:n.attackerId=t.string();break;default:t.skipType(7&r)}}if(!n.hasOwnProperty("instanceId"))throw $util.ProtocolError("missing required 'instanceId'",{instance:n});if(!n.hasOwnProperty("pluginId"))throw $util.ProtocolError("missing required 'pluginId'",{instance:n});if(!n.hasOwnProperty("roomId"))throw $util.ProtocolError("missing required 'roomId'",{instance:n});if(!n.hasOwnProperty("round"))throw $util.ProtocolError("missing required 'round'",{instance:n});if(!n.hasOwnProperty("attackerId"))throw $util.ProtocolError("missing required 'attackerId'",{instance:n});return n},e.decodeDelimited=function(t){if(!(t instanceof $Reader))t=new $Reader(t);return this.decode(t,t.uint32())},e.verify=function(t){if("object"!==_typeof(t)||null===t)return"object expected";if(!$util.isString(t.instanceId))return"instanceId: string expected";if(!$util.isString(t.pluginId))return"pluginId: string expected";if(!$util.isString(t.roomId))return"roomId: string expected";if(!$util.isInteger(t.round))return"round: integer expected";if(!$util.isString(t.attackerId))return"attackerId: string expected";else return null},e.fromObject=function(t){if(t instanceof $root.game.BattleReadyPKReq)return t;var e=new $root.game.BattleReadyPKReq;if(null!=t.instanceId)e.instanceId=String(t.instanceId);if(null!=t.pluginId)e.pluginId=String(t.pluginId);if(null!=t.roomId)e.roomId=String(t.roomId);if(null!=t.round)e.round=0|t.round;if(null!=t.attackerId)e.attackerId=String(t.attackerId);return e},e.toObject=function(t,e){if(!e)e={};var i={};if(e.defaults)i.instanceId="",i.pluginId="",i.roomId="",i.round=0,i.attackerId="";if(null!=t.instanceId&&t.hasOwnProperty("instanceId"))i.instanceId=t.instanceId;if(null!=t.pluginId&&t.hasOwnProperty("pluginId"))i.pluginId=t.pluginId;if(null!=t.roomId&&t.hasOwnProperty("roomId"))i.roomId=t.roomId;if(null!=t.round&&t.hasOwnProperty("round"))i.round=t.round;if(null!=t.attackerId&&t.hasOwnProperty("attackerId"))i.attackerId=t.attackerId;return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),Ema.BattleReadyPKResp=function(){function e(t){if(t)for(var e=Object.keys(t),i=0;i<e.length;++i)if(null!=t[e[i]])this[e[i]]=t[e[i]]}return e.prototype.code=0,e.prototype.info="",e.prototype.instanceId="",e.prototype.pluginId="",e.prototype.roomId="",e.create=function(t){return new e(t)},e.encode=function(t,e){if(!e)e=$Writer.create();return e.uint32(8).int32(t.code),e.uint32(18).string(t.info),e.uint32(26).string(t.instanceId),e.uint32(34).string(t.pluginId),e.uint32(42).string(t.roomId),e},e.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},e.decode=function(t,e){if(!(t instanceof $Reader))t=$Reader.create(t);for(var i=void 0===e?t.len:t.pos+e,n=new $root.game.BattleReadyPKResp;t.pos<i;){var r=t.uint32();switch(r>>>3){case 1:n.code=t.int32();break;case 2:n.info=t.string();break;case 3:n.instanceId=t.string();break;case 4:n.pluginId=t.string();break;case 5:n.roomId=t.string();break;default:t.skipType(7&r)}}if(!n.hasOwnProperty("code"))throw $util.ProtocolError("missing required 'code'",{instance:n});if(!n.hasOwnProperty("info"))throw $util.ProtocolError("missing required 'info'",{instance:n});if(!n.hasOwnProperty("instanceId"))throw $util.ProtocolError("missing required 'instanceId'",{instance:n});if(!n.hasOwnProperty("pluginId"))throw $util.ProtocolError("missing required 'pluginId'",{instance:n});if(!n.hasOwnProperty("roomId"))throw $util.ProtocolError("missing required 'roomId'",{instance:n});return n},e.decodeDelimited=function(t){if(!(t instanceof $Reader))t=new $Reader(t);return this.decode(t,t.uint32())},e.verify=function(t){if("object"!==_typeof(t)||null===t)return"object expected";if(!$util.isInteger(t.code))return"code: integer expected";if(!$util.isString(t.info))return"info: string expected";if(!$util.isString(t.instanceId))return"instanceId: string expected";if(!$util.isString(t.pluginId))return"pluginId: string expected";if(!$util.isString(t.roomId))return"roomId: string expected";else return null},e.fromObject=function(t){if(t instanceof $root.game.BattleReadyPKResp)return t;var e=new $root.game.BattleReadyPKResp;if(null!=t.code)e.code=0|t.code;if(null!=t.info)e.info=String(t.info);if(null!=t.instanceId)e.instanceId=String(t.instanceId);if(null!=t.pluginId)e.pluginId=String(t.pluginId);if(null!=t.roomId)e.roomId=String(t.roomId);return e},e.toObject=function(t,e){if(!e)e={};var i={};if(e.defaults)i.code=0,i.info="",i.instanceId="",i.pluginId="",i.roomId="";if(null!=t.code&&t.hasOwnProperty("code"))i.code=t.code;if(null!=t.info&&t.hasOwnProperty("info"))i.info=t.info;if(null!=t.instanceId&&t.hasOwnProperty("instanceId"))i.instanceId=t.instanceId;if(null!=t.pluginId&&t.hasOwnProperty("pluginId"))i.pluginId=t.pluginId;if(null!=t.roomId&&t.hasOwnProperty("roomId"))i.roomId=t.roomId;return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),Ema.BattleReadyPKNoti=function(){function e(t){if(t)for(var e=Object.keys(t),i=0;i<e.length;++i)if(null!=t[e[i]])this[e[i]]=t[e[i]]}return e.prototype.instanceId="",e.prototype.pluginId="",e.prototype.roomId="",e.prototype.senderId="",e.create=function(t){return new e(t)},e.encode=function(t,e){if(!e)e=$Writer.create();return e.uint32(10).string(t.instanceId),e.uint32(18).string(t.pluginId),e.uint32(26).string(t.roomId),e.uint32(34).string(t.senderId),e},e.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},e.decode=function(t,e){if(!(t instanceof $Reader))t=$Reader.create(t);for(var i=void 0===e?t.len:t.pos+e,n=new $root.game.BattleReadyPKNoti;t.pos<i;){var r=t.uint32();switch(r>>>3){case 1:n.instanceId=t.string();break;case 2:n.pluginId=t.string();break;case 3:n.roomId=t.string();break;case 4:n.senderId=t.string();break;default:t.skipType(7&r)}}if(!n.hasOwnProperty("instanceId"))throw $util.ProtocolError("missing required 'instanceId'",{instance:n});if(!n.hasOwnProperty("pluginId"))throw $util.ProtocolError("missing required 'pluginId'",{instance:n});if(!n.hasOwnProperty("roomId"))throw $util.ProtocolError("missing required 'roomId'",{instance:n});if(!n.hasOwnProperty("senderId"))throw $util.ProtocolError("missing required 'senderId'",{instance:n});return n},e.decodeDelimited=function(t){if(!(t instanceof $Reader))t=new $Reader(t);return this.decode(t,t.uint32())},e.verify=function(t){if("object"!==_typeof(t)||null===t)return"object expected";if(!$util.isString(t.instanceId))return"instanceId: string expected";if(!$util.isString(t.pluginId))return"pluginId: string expected";if(!$util.isString(t.roomId))return"roomId: string expected";if(!$util.isString(t.senderId))return"senderId: string expected";else return null},e.fromObject=function(t){if(t instanceof $root.game.BattleReadyPKNoti)return t;var e=new $root.game.BattleReadyPKNoti;if(null!=t.instanceId)e.instanceId=String(t.instanceId);if(null!=t.pluginId)e.pluginId=String(t.pluginId);if(null!=t.roomId)e.roomId=String(t.roomId);if(null!=t.senderId)e.senderId=String(t.senderId);return e},e.toObject=function(t,e){if(!e)e={};var i={};if(e.defaults)i.instanceId="",i.pluginId="",i.roomId="",i.senderId="";if(null!=t.instanceId&&t.hasOwnProperty("instanceId"))i.instanceId=t.instanceId;if(null!=t.pluginId&&t.hasOwnProperty("pluginId"))i.pluginId=t.pluginId;if(null!=t.roomId&&t.hasOwnProperty("roomId"))i.roomId=t.roomId;if(null!=t.senderId&&t.hasOwnProperty("senderId"))i.senderId=t.senderId;return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),Ema.BattleStartPKNoti=function(){function e(t){if(this.players=[],t)for(var e=Object.keys(t),i=0;i<e.length;++i)if(null!=t[e[i]])this[e[i]]=t[e[i]]}return e.prototype.instanceId="",e.prototype.pluginId="",e.prototype.roomId="",e.prototype.round=0,e.prototype.roundStartTime=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.players=$util.emptyArray,e.create=function(t){return new e(t)},e.encode=function(t,e){if(!e)e=$Writer.create();if(e.uint32(10).string(t.instanceId),e.uint32(18).string(t.pluginId),e.uint32(26).string(t.roomId),e.uint32(32).int32(t.round),e.uint32(40).int64(t.roundStartTime),null!=t.players&&t.players.length)for(var i=0;i<t.players.length;++i)$root.game.BattlePlayer.encode(t.players[i],e.uint32(50).fork()).ldelim();return e},e.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},e.decode=function(t,e){if(!(t instanceof $Reader))t=$Reader.create(t);for(var i=void 0===e?t.len:t.pos+e,n=new $root.game.BattleStartPKNoti;t.pos<i;){var r=t.uint32();switch(r>>>3){case 1:n.instanceId=t.string();break;case 2:n.pluginId=t.string();break;case 3:n.roomId=t.string();break;case 4:n.round=t.int32();break;case 5:n.roundStartTime=t.int64();break;case 6:if(!n.players||!n.players.length)n.players=[];n.players.push($root.game.BattlePlayer.decode(t,t.uint32()));break;default:t.skipType(7&r)}}if(!n.hasOwnProperty("instanceId"))throw $util.ProtocolError("missing required 'instanceId'",{instance:n});if(!n.hasOwnProperty("pluginId"))throw $util.ProtocolError("missing required 'pluginId'",{instance:n});if(!n.hasOwnProperty("roomId"))throw $util.ProtocolError("missing required 'roomId'",{instance:n});if(!n.hasOwnProperty("round"))throw $util.ProtocolError("missing required 'round'",{instance:n});if(!n.hasOwnProperty("roundStartTime"))throw $util.ProtocolError("missing required 'roundStartTime'",{instance:n});return n},e.decodeDelimited=function(t){if(!(t instanceof $Reader))t=new $Reader(t);return this.decode(t,t.uint32())},e.verify=function(t){if("object"!==_typeof(t)||null===t)return"object expected";if(!$util.isString(t.instanceId))return"instanceId: string expected";if(!$util.isString(t.pluginId))return"pluginId: string expected";if(!$util.isString(t.roomId))return"roomId: string expected";if(!$util.isInteger(t.round))return"round: integer expected";if(!($util.isInteger(t.roundStartTime)||t.roundStartTime&&$util.isInteger(t.roundStartTime.low)&&$util.isInteger(t.roundStartTime.high)))return"roundStartTime: integer|Long expected";if(null!=t.players&&t.hasOwnProperty("players")){if(!Array.isArray(t.players))return"players: array expected";for(var e=0;e<t.players.length;++e){var i=$root.game.BattlePlayer.verify(t.players[e]);if(i)return"players."+i}}return null},e.fromObject=function(t){if(t instanceof $root.game.BattleStartPKNoti)return t;var e=new $root.game.BattleStartPKNoti;if(null!=t.instanceId)e.instanceId=String(t.instanceId);if(null!=t.pluginId)e.pluginId=String(t.pluginId);if(null!=t.roomId)e.roomId=String(t.roomId);if(null!=t.round)e.round=0|t.round;if(null!=t.roundStartTime)if($util.Long)(e.roundStartTime=$util.Long.fromValue(t.roundStartTime)).unsigned=!1;else if("string"==typeof t.roundStartTime)e.roundStartTime=parseInt(t.roundStartTime,10);else if("number"==typeof t.roundStartTime)e.roundStartTime=t.roundStartTime;else if("object"===_typeof(t.roundStartTime))e.roundStartTime=new $util.LongBits(t.roundStartTime.low>>>0,t.roundStartTime.high>>>0).toNumber();if(t.players){if(!Array.isArray(t.players))throw TypeError(".game.BattleStartPKNoti.players: array expected");e.players=[];for(var i=0;i<t.players.length;++i){if("object"!==_typeof(t.players[i]))throw TypeError(".game.BattleStartPKNoti.players: object expected");e.players[i]=$root.game.BattlePlayer.fromObject(t.players[i])}}return e},e.toObject=function(t,e){if(!e)e={};var i={};if(e.arrays||e.defaults)i.players=[];if(e.defaults)if(i.instanceId="",i.pluginId="",i.roomId="",i.round=0,$util.Long){var n=new $util.Long(0,0,!1);i.roundStartTime=e.longs===String?n.toString():e.longs===Number?n.toNumber():n}else i.roundStartTime=e.longs===String?"0":0;if(null!=t.instanceId&&t.hasOwnProperty("instanceId"))i.instanceId=t.instanceId;if(null!=t.pluginId&&t.hasOwnProperty("pluginId"))i.pluginId=t.pluginId;if(null!=t.roomId&&t.hasOwnProperty("roomId"))i.roomId=t.roomId;if(null!=t.round&&t.hasOwnProperty("round"))i.round=t.round;if(null!=t.roundStartTime&&t.hasOwnProperty("roundStartTime"))if("number"==typeof t.roundStartTime)i.roundStartTime=e.longs===String?String(t.roundStartTime):t.roundStartTime;else i.roundStartTime=e.longs===String?$util.Long.prototype.toString.call(t.roundStartTime):e.longs===Number?new $util.LongBits(t.roundStartTime.low>>>0,t.roundStartTime.high>>>0).toNumber():t.roundStartTime;if(t.players&&t.players.length){i.players=[];for(var r=0;r<t.players.length;++r)i.players[r]=$root.game.BattlePlayer.toObject(t.players[r],e)}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),Ema.BattlePostActionReq=function(){function e(t){if(t)for(var e=Object.keys(t),i=0;i<e.length;++i)if(null!=t[e[i]])this[e[i]]=t[e[i]]}return e.prototype.instanceId="",e.prototype.pluginId="",e.prototype.roomId="",e.prototype.pkAction="",e.prototype.pkParams="",e.create=function(t){return new e(t)},e.encode=function(t,e){if(!e)e=$Writer.create();return e.uint32(10).string(t.instanceId),e.uint32(18).string(t.pluginId),e.uint32(26).string(t.roomId),e.uint32(34).string(t.pkAction),e.uint32(42).string(t.pkParams),e},e.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},e.decode=function(t,e){if(!(t instanceof $Reader))t=$Reader.create(t);for(var i=void 0===e?t.len:t.pos+e,n=new $root.game.BattlePostActionReq;t.pos<i;){var r=t.uint32();switch(r>>>3){case 1:n.instanceId=t.string();break;case 2:n.pluginId=t.string();break;case 3:n.roomId=t.string();break;case 4:n.pkAction=t.string();break;case 5:n.pkParams=t.string();break;default:t.skipType(7&r)}}if(!n.hasOwnProperty("instanceId"))throw $util.ProtocolError("missing required 'instanceId'",{instance:n});if(!n.hasOwnProperty("pluginId"))throw $util.ProtocolError("missing required 'pluginId'",{instance:n});if(!n.hasOwnProperty("roomId"))throw $util.ProtocolError("missing required 'roomId'",{instance:n});if(!n.hasOwnProperty("pkAction"))throw $util.ProtocolError("missing required 'pkAction'",{instance:n});if(!n.hasOwnProperty("pkParams"))throw $util.ProtocolError("missing required 'pkParams'",{instance:n});return n},e.decodeDelimited=function(t){if(!(t instanceof $Reader))t=new $Reader(t);return this.decode(t,t.uint32())},e.verify=function(t){if("object"!==_typeof(t)||null===t)return"object expected";if(!$util.isString(t.instanceId))return"instanceId: string expected";if(!$util.isString(t.pluginId))return"pluginId: string expected";if(!$util.isString(t.roomId))return"roomId: string expected";if(!$util.isString(t.pkAction))return"pkAction: string expected";if(!$util.isString(t.pkParams))return"pkParams: string expected";else return null},e.fromObject=function(t){if(t instanceof $root.game.BattlePostActionReq)return t;var e=new $root.game.BattlePostActionReq;if(null!=t.instanceId)e.instanceId=String(t.instanceId);if(null!=t.pluginId)e.pluginId=String(t.pluginId);if(null!=t.roomId)e.roomId=String(t.roomId);if(null!=t.pkAction)e.pkAction=String(t.pkAction);if(null!=t.pkParams)e.pkParams=String(t.pkParams);return e},e.toObject=function(t,e){if(!e)e={};var i={};if(e.defaults)i.instanceId="",i.pluginId="",i.roomId="",i.pkAction="",i.pkParams="";if(null!=t.instanceId&&t.hasOwnProperty("instanceId"))i.instanceId=t.instanceId;if(null!=t.pluginId&&t.hasOwnProperty("pluginId"))i.pluginId=t.pluginId;if(null!=t.roomId&&t.hasOwnProperty("roomId"))i.roomId=t.roomId;if(null!=t.pkAction&&t.hasOwnProperty("pkAction"))i.pkAction=t.pkAction;if(null!=t.pkParams&&t.hasOwnProperty("pkParams"))i.pkParams=t.pkParams;return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),Ema.BattlePostActionResp=function(){function e(t){if(t)for(var e=Object.keys(t),i=0;i<e.length;++i)if(null!=t[e[i]])this[e[i]]=t[e[i]]}return e.prototype.code=0,e.prototype.info="",e.prototype.instanceId="",e.prototype.pluginId="",e.prototype.roomId="",e.create=function(t){return new e(t)},e.encode=function(t,e){if(!e)e=$Writer.create();return e.uint32(8).int32(t.code),e.uint32(18).string(t.info),e.uint32(26).string(t.instanceId),e.uint32(34).string(t.pluginId),e.uint32(42).string(t.roomId),e},e.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},e.decode=function(t,e){if(!(t instanceof $Reader))t=$Reader.create(t);for(var i=void 0===e?t.len:t.pos+e,n=new $root.game.BattlePostActionResp;t.pos<i;){var r=t.uint32();switch(r>>>3){case 1:n.code=t.int32();break;case 2:n.info=t.string();break;case 3:n.instanceId=t.string();break;case 4:n.pluginId=t.string();break;case 5:n.roomId=t.string();break;default:t.skipType(7&r)}}if(!n.hasOwnProperty("code"))throw $util.ProtocolError("missing required 'code'",{instance:n});if(!n.hasOwnProperty("info"))throw $util.ProtocolError("missing required 'info'",{instance:n});if(!n.hasOwnProperty("instanceId"))throw $util.ProtocolError("missing required 'instanceId'",{instance:n});if(!n.hasOwnProperty("pluginId"))throw $util.ProtocolError("missing required 'pluginId'",{instance:n});if(!n.hasOwnProperty("roomId"))throw $util.ProtocolError("missing required 'roomId'",{instance:n});return n},e.decodeDelimited=function(t){if(!(t instanceof $Reader))t=new $Reader(t);return this.decode(t,t.uint32())},e.verify=function(t){if("object"!==_typeof(t)||null===t)return"object expected";if(!$util.isInteger(t.code))return"code: integer expected";if(!$util.isString(t.info))return"info: string expected";if(!$util.isString(t.instanceId))return"instanceId: string expected";if(!$util.isString(t.pluginId))return"pluginId: string expected";if(!$util.isString(t.roomId))return"roomId: string expected";else return null},e.fromObject=function(t){if(t instanceof $root.game.BattlePostActionResp)return t;var e=new $root.game.BattlePostActionResp;if(null!=t.code)e.code=0|t.code;if(null!=t.info)e.info=String(t.info);if(null!=t.instanceId)e.instanceId=String(t.instanceId);if(null!=t.pluginId)e.pluginId=String(t.pluginId);if(null!=t.roomId)e.roomId=String(t.roomId);return e},e.toObject=function(t,e){if(!e)e={};var i={};if(e.defaults)i.code=0,i.info="",i.instanceId="",i.pluginId="",i.roomId="";if(null!=t.code&&t.hasOwnProperty("code"))i.code=t.code;if(null!=t.info&&t.hasOwnProperty("info"))i.info=t.info;if(null!=t.instanceId&&t.hasOwnProperty("instanceId"))i.instanceId=t.instanceId;if(null!=t.pluginId&&t.hasOwnProperty("pluginId"))i.pluginId=t.pluginId;if(null!=t.roomId&&t.hasOwnProperty("roomId"))i.roomId=t.roomId;return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),Ema.BattlePostActionNoti=function(){function e(t){if(t)for(var e=Object.keys(t),i=0;i<e.length;++i)if(null!=t[e[i]])this[e[i]]=t[e[i]]}return e.prototype.instanceId="",e.prototype.pluginId="",e.prototype.roomId="",e.prototype.senderId="",e.prototype.pkAction="",e.prototype.pkParams="",e.create=function(t){return new e(t)},e.encode=function(t,e){if(!e)e=$Writer.create();return e.uint32(10).string(t.instanceId),e.uint32(18).string(t.pluginId),e.uint32(26).string(t.roomId),e.uint32(34).string(t.senderId),e.uint32(42).string(t.pkAction),e.uint32(50).string(t.pkParams),e},e.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},e.decode=function(t,e){if(!(t instanceof $Reader))t=$Reader.create(t);for(var i=void 0===e?t.len:t.pos+e,n=new $root.game.BattlePostActionNoti;t.pos<i;){var r=t.uint32();switch(r>>>3){case 1:n.instanceId=t.string();break;case 2:n.pluginId=t.string();break;case 3:n.roomId=t.string();break;case 4:n.senderId=t.string();break;case 5:n.pkAction=t.string();break;case 6:n.pkParams=t.string();break;default:t.skipType(7&r)}}if(!n.hasOwnProperty("instanceId"))throw $util.ProtocolError("missing required 'instanceId'",{instance:n});if(!n.hasOwnProperty("pluginId"))throw $util.ProtocolError("missing required 'pluginId'",{instance:n});if(!n.hasOwnProperty("roomId"))throw $util.ProtocolError("missing required 'roomId'",{instance:n});if(!n.hasOwnProperty("senderId"))throw $util.ProtocolError("missing required 'senderId'",{instance:n});if(!n.hasOwnProperty("pkAction"))throw $util.ProtocolError("missing required 'pkAction'",{instance:n});if(!n.hasOwnProperty("pkParams"))throw $util.ProtocolError("missing required 'pkParams'",{instance:n});return n},e.decodeDelimited=function(t){if(!(t instanceof $Reader))t=new $Reader(t);return this.decode(t,t.uint32())},e.verify=function(t){if("object"!==_typeof(t)||null===t)return"object expected";if(!$util.isString(t.instanceId))return"instanceId: string expected";if(!$util.isString(t.pluginId))return"pluginId: string expected";if(!$util.isString(t.roomId))return"roomId: string expected";if(!$util.isString(t.senderId))return"senderId: string expected";if(!$util.isString(t.pkAction))return"pkAction: string expected";if(!$util.isString(t.pkParams))return"pkParams: string expected";else return null},e.fromObject=function(t){if(t instanceof $root.game.BattlePostActionNoti)return t;var e=new $root.game.BattlePostActionNoti;if(null!=t.instanceId)e.instanceId=String(t.instanceId);if(null!=t.pluginId)e.pluginId=String(t.pluginId);if(null!=t.roomId)e.roomId=String(t.roomId);if(null!=t.senderId)e.senderId=String(t.senderId);if(null!=t.pkAction)e.pkAction=String(t.pkAction);if(null!=t.pkParams)e.pkParams=String(t.pkParams);return e},e.toObject=function(t,e){if(!e)e={};var i={};if(e.defaults)i.instanceId="",i.pluginId="",i.roomId="",i.senderId="",i.pkAction="",i.pkParams="";if(null!=t.instanceId&&t.hasOwnProperty("instanceId"))i.instanceId=t.instanceId;if(null!=t.pluginId&&t.hasOwnProperty("pluginId"))i.pluginId=t.pluginId;if(null!=t.roomId&&t.hasOwnProperty("roomId"))i.roomId=t.roomId;if(null!=t.senderId&&t.hasOwnProperty("senderId"))i.senderId=t.senderId;if(null!=t.pkAction&&t.hasOwnProperty("pkAction"))i.pkAction=t.pkAction;if(null!=t.pkParams&&t.hasOwnProperty("pkParams"))i.pkParams=t.pkParams;return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),Ema.BattleStopRoundReq=function(){function e(t){if(t)for(var e=Object.keys(t),i=0;i<e.length;++i)if(null!=t[e[i]])this[e[i]]=t[e[i]]}return e.prototype.instanceId="",e.prototype.pluginId="",e.prototype.roomId="",e.prototype.round=0,e.prototype.attackerId="",e.create=function(t){return new e(t)},e.encode=function(t,e){if(!e)e=$Writer.create();return e.uint32(10).string(t.instanceId),e.uint32(18).string(t.pluginId),e.uint32(26).string(t.roomId),e.uint32(32).int32(t.round),e.uint32(42).string(t.attackerId),e},e.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},e.decode=function(t,e){if(!(t instanceof $Reader))t=$Reader.create(t);for(var i=void 0===e?t.len:t.pos+e,n=new $root.game.BattleStopRoundReq;t.pos<i;){var r=t.uint32();switch(r>>>3){case 1:n.instanceId=t.string();break;case 2:n.pluginId=t.string();break;case 3:n.roomId=t.string();break;case 4:n.round=t.int32();break;case 5:n.attackerId=t.string();break;default:t.skipType(7&r)}}if(!n.hasOwnProperty("instanceId"))throw $util.ProtocolError("missing required 'instanceId'",{instance:n});if(!n.hasOwnProperty("pluginId"))throw $util.ProtocolError("missing required 'pluginId'",{instance:n});if(!n.hasOwnProperty("roomId"))throw $util.ProtocolError("missing required 'roomId'",{instance:n});if(!n.hasOwnProperty("round"))throw $util.ProtocolError("missing required 'round'",{instance:n});if(!n.hasOwnProperty("attackerId"))throw $util.ProtocolError("missing required 'attackerId'",{instance:n});return n},e.decodeDelimited=function(t){if(!(t instanceof $Reader))t=new $Reader(t);return this.decode(t,t.uint32())},e.verify=function(t){if("object"!==_typeof(t)||null===t)return"object expected";if(!$util.isString(t.instanceId))return"instanceId: string expected";if(!$util.isString(t.pluginId))return"pluginId: string expected";if(!$util.isString(t.roomId))return"roomId: string expected";if(!$util.isInteger(t.round))return"round: integer expected";if(!$util.isString(t.attackerId))return"attackerId: string expected";else return null},e.fromObject=function(t){if(t instanceof $root.game.BattleStopRoundReq)return t;var e=new $root.game.BattleStopRoundReq;if(null!=t.instanceId)e.instanceId=String(t.instanceId);if(null!=t.pluginId)e.pluginId=String(t.pluginId);if(null!=t.roomId)e.roomId=String(t.roomId);if(null!=t.round)e.round=0|t.round;if(null!=t.attackerId)e.attackerId=String(t.attackerId);return e},e.toObject=function(t,e){if(!e)e={};var i={};if(e.defaults)i.instanceId="",i.pluginId="",i.roomId="",i.round=0,i.attackerId="";if(null!=t.instanceId&&t.hasOwnProperty("instanceId"))i.instanceId=t.instanceId;if(null!=t.pluginId&&t.hasOwnProperty("pluginId"))i.pluginId=t.pluginId;if(null!=t.roomId&&t.hasOwnProperty("roomId"))i.roomId=t.roomId;if(null!=t.round&&t.hasOwnProperty("round"))i.round=t.round;if(null!=t.attackerId&&t.hasOwnProperty("attackerId"))i.attackerId=t.attackerId;return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),Ema.BattleStopRoundResp=function(){function e(t){if(t)for(var e=Object.keys(t),i=0;i<e.length;++i)if(null!=t[e[i]])this[e[i]]=t[e[i]]}return e.prototype.code=0,e.prototype.info="",e.prototype.instanceId="",e.prototype.pluginId="",e.prototype.roomId="",e.create=function(t){return new e(t)},e.encode=function(t,e){if(!e)e=$Writer.create();return e.uint32(8).int32(t.code),e.uint32(18).string(t.info),e.uint32(26).string(t.instanceId),e.uint32(34).string(t.pluginId),e.uint32(42).string(t.roomId),e},e.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},e.decode=function(t,e){if(!(t instanceof $Reader))t=$Reader.create(t);for(var i=void 0===e?t.len:t.pos+e,n=new $root.game.BattleStopRoundResp;t.pos<i;){var r=t.uint32();switch(r>>>3){case 1:n.code=t.int32();break;case 2:n.info=t.string();break;case 3:n.instanceId=t.string();break;case 4:n.pluginId=t.string();break;case 5:n.roomId=t.string();break;default:t.skipType(7&r)}}if(!n.hasOwnProperty("code"))throw $util.ProtocolError("missing required 'code'",{instance:n});if(!n.hasOwnProperty("info"))throw $util.ProtocolError("missing required 'info'",{instance:n});if(!n.hasOwnProperty("instanceId"))throw $util.ProtocolError("missing required 'instanceId'",{instance:n});if(!n.hasOwnProperty("pluginId"))throw $util.ProtocolError("missing required 'pluginId'",{instance:n});if(!n.hasOwnProperty("roomId"))throw $util.ProtocolError("missing required 'roomId'",{instance:n});return n},e.decodeDelimited=function(t){if(!(t instanceof $Reader))t=new $Reader(t);return this.decode(t,t.uint32())},e.verify=function(t){if("object"!==_typeof(t)||null===t)return"object expected";if(!$util.isInteger(t.code))return"code: integer expected";if(!$util.isString(t.info))return"info: string expected";if(!$util.isString(t.instanceId))return"instanceId: string expected";if(!$util.isString(t.pluginId))return"pluginId: string expected";if(!$util.isString(t.roomId))return"roomId: string expected";else return null},e.fromObject=function(t){if(t instanceof $root.game.BattleStopRoundResp)return t;var e=new $root.game.BattleStopRoundResp;if(null!=t.code)e.code=0|t.code;if(null!=t.info)e.info=String(t.info);if(null!=t.instanceId)e.instanceId=String(t.instanceId);if(null!=t.pluginId)e.pluginId=String(t.pluginId);if(null!=t.roomId)e.roomId=String(t.roomId);return e},e.toObject=function(t,e){if(!e)e={};var i={};if(e.defaults)i.code=0,i.info="",i.instanceId="",i.pluginId="",i.roomId="";if(null!=t.code&&t.hasOwnProperty("code"))i.code=t.code;if(null!=t.info&&t.hasOwnProperty("info"))i.info=t.info;if(null!=t.instanceId&&t.hasOwnProperty("instanceId"))i.instanceId=t.instanceId;if(null!=t.pluginId&&t.hasOwnProperty("pluginId"))i.pluginId=t.pluginId;if(null!=t.roomId&&t.hasOwnProperty("roomId"))i.roomId=t.roomId;return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),Ema.BattleStartRoundNoti=function(){function e(t){if(this.players=[],t)for(var e=Object.keys(t),i=0;i<e.length;++i)if(null!=t[e[i]])this[e[i]]=t[e[i]]}return e.prototype.instanceId="",e.prototype.pluginId="",e.prototype.roomId="",e.prototype.round=0,e.prototype.roundStartTime=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.players=$util.emptyArray,e.create=function(t){return new e(t)},e.encode=function(t,e){if(!e)e=$Writer.create();if(e.uint32(10).string(t.instanceId),e.uint32(18).string(t.pluginId),e.uint32(26).string(t.roomId),e.uint32(32).int32(t.round),e.uint32(40).int64(t.roundStartTime),null!=t.players&&t.players.length)for(var i=0;i<t.players.length;++i)$root.game.BattlePlayer.encode(t.players[i],e.uint32(50).fork()).ldelim();return e},e.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},e.decode=function(t,e){if(!(t instanceof $Reader))t=$Reader.create(t);for(var i=void 0===e?t.len:t.pos+e,n=new $root.game.BattleStartRoundNoti;t.pos<i;){var r=t.uint32();switch(r>>>3){case 1:n.instanceId=t.string();break;case 2:n.pluginId=t.string();break;case 3:n.roomId=t.string();break;case 4:n.round=t.int32();break;case 5:n.roundStartTime=t.int64();break;case 6:if(!n.players||!n.players.length)n.players=[];n.players.push($root.game.BattlePlayer.decode(t,t.uint32()));break;default:t.skipType(7&r)}}if(!n.hasOwnProperty("instanceId"))throw $util.ProtocolError("missing required 'instanceId'",{instance:n});if(!n.hasOwnProperty("pluginId"))throw $util.ProtocolError("missing required 'pluginId'",{instance:n});if(!n.hasOwnProperty("roomId"))throw $util.ProtocolError("missing required 'roomId'",{instance:n});if(!n.hasOwnProperty("round"))throw $util.ProtocolError("missing required 'round'",{instance:n});if(!n.hasOwnProperty("roundStartTime"))throw $util.ProtocolError("missing required 'roundStartTime'",{instance:n});return n},e.decodeDelimited=function(t){if(!(t instanceof $Reader))t=new $Reader(t);return this.decode(t,t.uint32())},e.verify=function(t){if("object"!==_typeof(t)||null===t)return"object expected";if(!$util.isString(t.instanceId))return"instanceId: string expected";if(!$util.isString(t.pluginId))return"pluginId: string expected";if(!$util.isString(t.roomId))return"roomId: string expected";if(!$util.isInteger(t.round))return"round: integer expected";if(!($util.isInteger(t.roundStartTime)||t.roundStartTime&&$util.isInteger(t.roundStartTime.low)&&$util.isInteger(t.roundStartTime.high)))return"roundStartTime: integer|Long expected";if(null!=t.players&&t.hasOwnProperty("players")){if(!Array.isArray(t.players))return"players: array expected";for(var e=0;e<t.players.length;++e){var i=$root.game.BattlePlayer.verify(t.players[e]);if(i)return"players."+i}}return null},e.fromObject=function(t){if(t instanceof $root.game.BattleStartRoundNoti)return t;var e=new $root.game.BattleStartRoundNoti;if(null!=t.instanceId)e.instanceId=String(t.instanceId);if(null!=t.pluginId)e.pluginId=String(t.pluginId);if(null!=t.roomId)e.roomId=String(t.roomId);if(null!=t.round)e.round=0|t.round;if(null!=t.roundStartTime)if($util.Long)(e.roundStartTime=$util.Long.fromValue(t.roundStartTime)).unsigned=!1;else if("string"==typeof t.roundStartTime)e.roundStartTime=parseInt(t.roundStartTime,10);else if("number"==typeof t.roundStartTime)e.roundStartTime=t.roundStartTime;else if("object"===_typeof(t.roundStartTime))e.roundStartTime=new $util.LongBits(t.roundStartTime.low>>>0,t.roundStartTime.high>>>0).toNumber();if(t.players){if(!Array.isArray(t.players))throw TypeError(".game.BattleStartRoundNoti.players: array expected");e.players=[];for(var i=0;i<t.players.length;++i){if("object"!==_typeof(t.players[i]))throw TypeError(".game.BattleStartRoundNoti.players: object expected");e.players[i]=$root.game.BattlePlayer.fromObject(t.players[i])}}return e},e.toObject=function(t,e){if(!e)e={};var i={};if(e.arrays||e.defaults)i.players=[];if(e.defaults)if(i.instanceId="",i.pluginId="",i.roomId="",i.round=0,$util.Long){var n=new $util.Long(0,0,!1);i.roundStartTime=e.longs===String?n.toString():e.longs===Number?n.toNumber():n}else i.roundStartTime=e.longs===String?"0":0;if(null!=t.instanceId&&t.hasOwnProperty("instanceId"))i.instanceId=t.instanceId;if(null!=t.pluginId&&t.hasOwnProperty("pluginId"))i.pluginId=t.pluginId;if(null!=t.roomId&&t.hasOwnProperty("roomId"))i.roomId=t.roomId;if(null!=t.round&&t.hasOwnProperty("round"))i.round=t.round;if(null!=t.roundStartTime&&t.hasOwnProperty("roundStartTime"))if("number"==typeof t.roundStartTime)i.roundStartTime=e.longs===String?String(t.roundStartTime):t.roundStartTime;else i.roundStartTime=e.longs===String?$util.Long.prototype.toString.call(t.roundStartTime):e.longs===Number?new $util.LongBits(t.roundStartTime.low>>>0,t.roundStartTime.high>>>0).toNumber():t.roundStartTime;if(t.players&&t.players.length){i.players=[];for(var r=0;r<t.players.length;++r)i.players[r]=$root.game.BattlePlayer.toObject(t.players[r],e)}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),Ema.BattleStopPKReq=function(){function e(t){if(t)for(var e=Object.keys(t),i=0;i<e.length;++i)if(null!=t[e[i]])this[e[i]]=t[e[i]]}return e.prototype.instanceId="",e.prototype.pluginId="",e.prototype.roomId="",e.prototype.deporteeId="",e.create=function(t){return new e(t)},e.encode=function(t,e){if(!e)e=$Writer.create();return e.uint32(10).string(t.instanceId),e.uint32(18).string(t.pluginId),e.uint32(26).string(t.roomId),e.uint32(34).string(t.deporteeId),e},e.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},e.decode=function(t,e){if(!(t instanceof $Reader))t=$Reader.create(t);for(var i=void 0===e?t.len:t.pos+e,n=new $root.game.BattleStopPKReq;t.pos<i;){var r=t.uint32();switch(r>>>3){case 1:n.instanceId=t.string();break;case 2:n.pluginId=t.string();break;case 3:n.roomId=t.string();break;case 4:n.deporteeId=t.string();break;default:t.skipType(7&r)}}if(!n.hasOwnProperty("instanceId"))throw $util.ProtocolError("missing required 'instanceId'",{instance:n});if(!n.hasOwnProperty("pluginId"))throw $util.ProtocolError("missing required 'pluginId'",{instance:n});if(!n.hasOwnProperty("roomId"))throw $util.ProtocolError("missing required 'roomId'",{instance:n});if(!n.hasOwnProperty("deporteeId"))throw $util.ProtocolError("missing required 'deporteeId'",{instance:n});return n},e.decodeDelimited=function(t){if(!(t instanceof $Reader))t=new $Reader(t);return this.decode(t,t.uint32())},e.verify=function(t){if("object"!==_typeof(t)||null===t)return"object expected";if(!$util.isString(t.instanceId))return"instanceId: string expected";if(!$util.isString(t.pluginId))return"pluginId: string expected";if(!$util.isString(t.roomId))return"roomId: string expected";if(!$util.isString(t.deporteeId))return"deporteeId: string expected";else return null},e.fromObject=function(t){if(t instanceof $root.game.BattleStopPKReq)return t;var e=new $root.game.BattleStopPKReq;if(null!=t.instanceId)e.instanceId=String(t.instanceId);if(null!=t.pluginId)e.pluginId=String(t.pluginId);if(null!=t.roomId)e.roomId=String(t.roomId);if(null!=t.deporteeId)e.deporteeId=String(t.deporteeId);return e},e.toObject=function(t,e){if(!e)e={};var i={};if(e.defaults)i.instanceId="",i.pluginId="",i.roomId="",i.deporteeId="";if(null!=t.instanceId&&t.hasOwnProperty("instanceId"))i.instanceId=t.instanceId;if(null!=t.pluginId&&t.hasOwnProperty("pluginId"))i.pluginId=t.pluginId;if(null!=t.roomId&&t.hasOwnProperty("roomId"))i.roomId=t.roomId;if(null!=t.deporteeId&&t.hasOwnProperty("deporteeId"))i.deporteeId=t.deporteeId;return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),Ema.BattleStopPKResp=function(){function e(t){if(t)for(var e=Object.keys(t),i=0;i<e.length;++i)if(null!=t[e[i]])this[e[i]]=t[e[i]]}return e.prototype.code=0,e.prototype.info="",e.prototype.instanceId="",e.prototype.pluginId="",e.prototype.roomId="",e.create=function(t){return new e(t)},e.encode=function(t,e){if(!e)e=$Writer.create();return e.uint32(8).int32(t.code),e.uint32(18).string(t.info),e.uint32(26).string(t.instanceId),e.uint32(34).string(t.pluginId),e.uint32(42).string(t.roomId),e},e.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},e.decode=function(t,e){if(!(t instanceof $Reader))t=$Reader.create(t);for(var i=void 0===e?t.len:t.pos+e,n=new $root.game.BattleStopPKResp;t.pos<i;){var r=t.uint32();switch(r>>>3){case 1:n.code=t.int32();break;case 2:n.info=t.string();break;case 3:n.instanceId=t.string();break;case 4:n.pluginId=t.string();break;case 5:n.roomId=t.string();break;default:t.skipType(7&r)}}if(!n.hasOwnProperty("code"))throw $util.ProtocolError("missing required 'code'",{instance:n});if(!n.hasOwnProperty("info"))throw $util.ProtocolError("missing required 'info'",{instance:n});if(!n.hasOwnProperty("instanceId"))throw $util.ProtocolError("missing required 'instanceId'",{instance:n});if(!n.hasOwnProperty("pluginId"))throw $util.ProtocolError("missing required 'pluginId'",{instance:n});if(!n.hasOwnProperty("roomId"))throw $util.ProtocolError("missing required 'roomId'",{instance:n});return n},e.decodeDelimited=function(t){if(!(t instanceof $Reader))t=new $Reader(t);return this.decode(t,t.uint32())},e.verify=function(t){if("object"!==_typeof(t)||null===t)return"object expected";if(!$util.isInteger(t.code))return"code: integer expected";if(!$util.isString(t.info))return"info: string expected";if(!$util.isString(t.instanceId))return"instanceId: string expected";if(!$util.isString(t.pluginId))return"pluginId: string expected";if(!$util.isString(t.roomId))return"roomId: string expected";else return null},e.fromObject=function(t){if(t instanceof $root.game.BattleStopPKResp)return t;var e=new $root.game.BattleStopPKResp;if(null!=t.code)e.code=0|t.code;if(null!=t.info)e.info=String(t.info);if(null!=t.instanceId)e.instanceId=String(t.instanceId);if(null!=t.pluginId)e.pluginId=String(t.pluginId);if(null!=t.roomId)e.roomId=String(t.roomId);return e},e.toObject=function(t,e){if(!e)e={};var i={};if(e.defaults)i.code=0,i.info="",i.instanceId="",i.pluginId="",i.roomId="";if(null!=t.code&&t.hasOwnProperty("code"))i.code=t.code;if(null!=t.info&&t.hasOwnProperty("info"))i.info=t.info;if(null!=t.instanceId&&t.hasOwnProperty("instanceId"))i.instanceId=t.instanceId;if(null!=t.pluginId&&t.hasOwnProperty("pluginId"))i.pluginId=t.pluginId;if(null!=t.roomId&&t.hasOwnProperty("roomId"))i.roomId=t.roomId;return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),Ema.BattleStopPKNoti=function(){function e(t){if(t)for(var e=Object.keys(t),i=0;i<e.length;++i)if(null!=t[e[i]])this[e[i]]=t[e[i]]}return e.prototype.instanceId="",e.prototype.pluginId="",e.prototype.roomId="",e.prototype.senderId="",e.prototype.deporteeId="",e.create=function(t){return new e(t)},e.encode=function(t,e){if(!e)e=$Writer.create();return e.uint32(10).string(t.instanceId),e.uint32(18).string(t.pluginId),e.uint32(26).string(t.roomId),e.uint32(34).string(t.senderId),e.uint32(42).string(t.deporteeId),e},e.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},e.decode=function(t,e){if(!(t instanceof $Reader))t=$Reader.create(t);for(var i=void 0===e?t.len:t.pos+e,n=new $root.game.BattleStopPKNoti;t.pos<i;){var r=t.uint32();switch(r>>>3){case 1:n.instanceId=t.string();break;case 2:n.pluginId=t.string();break;case 3:n.roomId=t.string();break;case 4:n.senderId=t.string();break;case 5:n.deporteeId=t.string();break;default:t.skipType(7&r)}}if(!n.hasOwnProperty("instanceId"))throw $util.ProtocolError("missing required 'instanceId'",{instance:n});if(!n.hasOwnProperty("pluginId"))throw $util.ProtocolError("missing required 'pluginId'",{instance:n});if(!n.hasOwnProperty("roomId"))throw $util.ProtocolError("missing required 'roomId'",{instance:n});if(!n.hasOwnProperty("senderId"))throw $util.ProtocolError("missing required 'senderId'",{instance:n});if(!n.hasOwnProperty("deporteeId"))throw $util.ProtocolError("missing required 'deporteeId'",{instance:n});return n},e.decodeDelimited=function(t){if(!(t instanceof $Reader))t=new $Reader(t);return this.decode(t,t.uint32())},e.verify=function(t){if("object"!==_typeof(t)||null===t)return"object expected";if(!$util.isString(t.instanceId))return"instanceId: string expected";if(!$util.isString(t.pluginId))return"pluginId: string expected";if(!$util.isString(t.roomId))return"roomId: string expected";if(!$util.isString(t.senderId))return"senderId: string expected";if(!$util.isString(t.deporteeId))return"deporteeId: string expected";else return null},e.fromObject=function(t){if(t instanceof $root.game.BattleStopPKNoti)return t;var e=new $root.game.BattleStopPKNoti;if(null!=t.instanceId)e.instanceId=String(t.instanceId);if(null!=t.pluginId)e.pluginId=String(t.pluginId);if(null!=t.roomId)e.roomId=String(t.roomId);if(null!=t.senderId)e.senderId=String(t.senderId);if(null!=t.deporteeId)e.deporteeId=String(t.deporteeId);return e},e.toObject=function(t,e){if(!e)e={};var i={};if(e.defaults)i.instanceId="",i.pluginId="",i.roomId="",i.senderId="",i.deporteeId="";if(null!=t.instanceId&&t.hasOwnProperty("instanceId"))i.instanceId=t.instanceId;if(null!=t.pluginId&&t.hasOwnProperty("pluginId"))i.pluginId=t.pluginId;if(null!=t.roomId&&t.hasOwnProperty("roomId"))i.roomId=t.roomId;if(null!=t.senderId&&t.hasOwnProperty("senderId"))i.senderId=t.senderId;if(null!=t.deporteeId&&t.hasOwnProperty("deporteeId"))i.deporteeId=t.deporteeId;return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),Ema.BattleStopMatchReq=function(){function e(t){if(t)for(var e=Object.keys(t),i=0;i<e.length;++i)if(null!=t[e[i]])this[e[i]]=t[e[i]]}return e.prototype.instanceId="",e.prototype.pluginId="",e.create=function(t){return new e(t)},e.encode=function(t,e){if(!e)e=$Writer.create();return e.uint32(10).string(t.instanceId),e.uint32(18).string(t.pluginId),e},e.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},e.decode=function(t,e){if(!(t instanceof $Reader))t=$Reader.create(t);for(var i=void 0===e?t.len:t.pos+e,n=new $root.game.BattleStopMatchReq;t.pos<i;){var r=t.uint32();switch(r>>>3){case 1:n.instanceId=t.string();break;case 2:n.pluginId=t.string();break;default:t.skipType(7&r)}}if(!n.hasOwnProperty("instanceId"))throw $util.ProtocolError("missing required 'instanceId'",{instance:n});if(!n.hasOwnProperty("pluginId"))throw $util.ProtocolError("missing required 'pluginId'",{instance:n});return n},e.decodeDelimited=function(t){if(!(t instanceof $Reader))t=new $Reader(t);return this.decode(t,t.uint32())},e.verify=function(t){if("object"!==_typeof(t)||null===t)return"object expected";if(!$util.isString(t.instanceId))return"instanceId: string expected";if(!$util.isString(t.pluginId))return"pluginId: string expected";else return null},e.fromObject=function(t){if(t instanceof $root.game.BattleStopMatchReq)return t;var e=new $root.game.BattleStopMatchReq;if(null!=t.instanceId)e.instanceId=String(t.instanceId);if(null!=t.pluginId)e.pluginId=String(t.pluginId);return e},e.toObject=function(t,e){if(!e)e={};var i={};if(e.defaults)i.instanceId="",i.pluginId="";if(null!=t.instanceId&&t.hasOwnProperty("instanceId"))i.instanceId=t.instanceId;if(null!=t.pluginId&&t.hasOwnProperty("pluginId"))i.pluginId=t.pluginId;return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),Ema.BattleStopMatchResp=function(){function e(t){if(t)for(var e=Object.keys(t),i=0;i<e.length;++i)if(null!=t[e[i]])this[e[i]]=t[e[i]]}return e.prototype.code=0,e.prototype.info="",e.prototype.instanceId="",e.prototype.pluginId="",e.create=function(t){return new e(t)},e.encode=function(t,e){if(!e)e=$Writer.create();return e.uint32(8).int32(t.code),e.uint32(18).string(t.info),e.uint32(26).string(t.instanceId),e.uint32(34).string(t.pluginId),e},e.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},e.decode=function(t,e){if(!(t instanceof $Reader))t=$Reader.create(t);for(var i=void 0===e?t.len:t.pos+e,n=new $root.game.BattleStopMatchResp;t.pos<i;){var r=t.uint32();switch(r>>>3){case 1:n.code=t.int32();break;case 2:n.info=t.string();break;case 3:n.instanceId=t.string();break;case 4:n.pluginId=t.string();break;default:t.skipType(7&r)}}if(!n.hasOwnProperty("code"))throw $util.ProtocolError("missing required 'code'",{instance:n});if(!n.hasOwnProperty("info"))throw $util.ProtocolError("missing required 'info'",{instance:n});if(!n.hasOwnProperty("instanceId"))throw $util.ProtocolError("missing required 'instanceId'",{instance:n});if(!n.hasOwnProperty("pluginId"))throw $util.ProtocolError("missing required 'pluginId'",{instance:n});return n},e.decodeDelimited=function(t){if(!(t instanceof $Reader))t=new $Reader(t);return this.decode(t,t.uint32())},e.verify=function(t){if("object"!==_typeof(t)||null===t)return"object expected";if(!$util.isInteger(t.code))return"code: integer expected";if(!$util.isString(t.info))return"info: string expected";if(!$util.isString(t.instanceId))return"instanceId: string expected";if(!$util.isString(t.pluginId))return"pluginId: string expected";else return null},e.fromObject=function(t){if(t instanceof $root.game.BattleStopMatchResp)return t;var e=new $root.game.BattleStopMatchResp;if(null!=t.code)e.code=0|t.code;if(null!=t.info)e.info=String(t.info);if(null!=t.instanceId)e.instanceId=String(t.instanceId);if(null!=t.pluginId)e.pluginId=String(t.pluginId);return e},e.toObject=function(t,e){if(!e)e={};var i={};if(e.defaults)i.code=0,i.info="",i.instanceId="",i.pluginId="";if(null!=t.code&&t.hasOwnProperty("code"))i.code=t.code;if(null!=t.info&&t.hasOwnProperty("info"))i.info=t.info;if(null!=t.instanceId&&t.hasOwnProperty("instanceId"))i.instanceId=t.instanceId;if(null!=t.pluginId&&t.hasOwnProperty("pluginId"))i.pluginId=t.pluginId;return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),Ema.BattleOfflineNoti=function(){function e(t){if(t)for(var e=Object.keys(t),i=0;i<e.length;++i)if(null!=t[e[i]])this[e[i]]=t[e[i]]}return e.prototype.instanceId="",e.prototype.pluginId="",e.prototype.roomId="",e.prototype.offlineId="",e.prototype.factor="",e.create=function(t){return new e(t)},e.encode=function(t,e){if(!e)e=$Writer.create();return e.uint32(10).string(t.instanceId),e.uint32(18).string(t.pluginId),e.uint32(26).string(t.roomId),e.uint32(34).string(t.offlineId),e.uint32(42).string(t.factor),e},e.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},e.decode=function(t,e){if(!(t instanceof $Reader))t=$Reader.create(t);for(var i=void 0===e?t.len:t.pos+e,n=new $root.game.BattleOfflineNoti;t.pos<i;){var r=t.uint32();switch(r>>>3){case 1:n.instanceId=t.string();break;case 2:n.pluginId=t.string();break;case 3:n.roomId=t.string();break;case 4:n.offlineId=t.string();break;case 5:n.factor=t.string();break;default:t.skipType(7&r)}}if(!n.hasOwnProperty("instanceId"))throw $util.ProtocolError("missing required 'instanceId'",{instance:n});if(!n.hasOwnProperty("pluginId"))throw $util.ProtocolError("missing required 'pluginId'",{instance:n});if(!n.hasOwnProperty("roomId"))throw $util.ProtocolError("missing required 'roomId'",{instance:n});if(!n.hasOwnProperty("offlineId"))throw $util.ProtocolError("missing required 'offlineId'",{instance:n});if(!n.hasOwnProperty("factor"))throw $util.ProtocolError("missing required 'factor'",{instance:n});return n},e.decodeDelimited=function(t){if(!(t instanceof $Reader))t=new $Reader(t);return this.decode(t,t.uint32())},e.verify=function(t){if("object"!==_typeof(t)||null===t)return"object expected";if(!$util.isString(t.instanceId))return"instanceId: string expected";if(!$util.isString(t.pluginId))return"pluginId: string expected";if(!$util.isString(t.roomId))return"roomId: string expected";if(!$util.isString(t.offlineId))return"offlineId: string expected";if(!$util.isString(t.factor))return"factor: string expected";else return null},e.fromObject=function(t){if(t instanceof $root.game.BattleOfflineNoti)return t;var e=new $root.game.BattleOfflineNoti;if(null!=t.instanceId)e.instanceId=String(t.instanceId);if(null!=t.pluginId)e.pluginId=String(t.pluginId);if(null!=t.roomId)e.roomId=String(t.roomId);if(null!=t.offlineId)e.offlineId=String(t.offlineId);if(null!=t.factor)e.factor=String(t.factor);return e},e.toObject=function(t,e){if(!e)e={};var i={};if(e.defaults)i.instanceId="",i.pluginId="",i.roomId="",i.offlineId="",i.factor="";if(null!=t.instanceId&&t.hasOwnProperty("instanceId"))i.instanceId=t.instanceId;if(null!=t.pluginId&&t.hasOwnProperty("pluginId"))i.pluginId=t.pluginId;if(null!=t.roomId&&t.hasOwnProperty("roomId"))i.roomId=t.roomId;if(null!=t.offlineId&&t.hasOwnProperty("offlineId"))i.offlineId=t.offlineId;if(null!=t.factor&&t.hasOwnProperty("factor"))i.factor=t.factor;return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),Ema.BattleReadyTimeoutReq=function(){function e(t){if(t)for(var e=Object.keys(t),i=0;i<e.length;++i)if(null!=t[e[i]])this[e[i]]=t[e[i]]}return e.prototype.instanceId="",e.prototype.pluginId="",e.prototype.roomId="",e.create=function(t){return new e(t)},e.encode=function(t,e){if(!e)e=$Writer.create();return e.uint32(10).string(t.instanceId),e.uint32(18).string(t.pluginId),e.uint32(26).string(t.roomId),e},e.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},e.decode=function(t,e){if(!(t instanceof $Reader))t=$Reader.create(t);for(var i=void 0===e?t.len:t.pos+e,n=new $root.game.BattleReadyTimeoutReq;t.pos<i;){var r=t.uint32();switch(r>>>3){case 1:n.instanceId=t.string();break;case 2:n.pluginId=t.string();break;case 3:n.roomId=t.string();break;default:t.skipType(7&r)}}if(!n.hasOwnProperty("instanceId"))throw $util.ProtocolError("missing required 'instanceId'",{instance:n});if(!n.hasOwnProperty("pluginId"))throw $util.ProtocolError("missing required 'pluginId'",{instance:n});if(!n.hasOwnProperty("roomId"))throw $util.ProtocolError("missing required 'roomId'",{instance:n});return n},e.decodeDelimited=function(t){if(!(t instanceof $Reader))t=new $Reader(t);return this.decode(t,t.uint32())},e.verify=function(t){if("object"!==_typeof(t)||null===t)return"object expected";if(!$util.isString(t.instanceId))return"instanceId: string expected";if(!$util.isString(t.pluginId))return"pluginId: string expected";if(!$util.isString(t.roomId))return"roomId: string expected";else return null},e.fromObject=function(t){if(t instanceof $root.game.BattleReadyTimeoutReq)return t;var e=new $root.game.BattleReadyTimeoutReq;if(null!=t.instanceId)e.instanceId=String(t.instanceId);if(null!=t.pluginId)e.pluginId=String(t.pluginId);if(null!=t.roomId)e.roomId=String(t.roomId);return e},e.toObject=function(t,e){if(!e)e={};var i={};if(e.defaults)i.instanceId="",i.pluginId="",i.roomId="";if(null!=t.instanceId&&t.hasOwnProperty("instanceId"))i.instanceId=t.instanceId;if(null!=t.pluginId&&t.hasOwnProperty("pluginId"))i.pluginId=t.pluginId;if(null!=t.roomId&&t.hasOwnProperty("roomId"))i.roomId=t.roomId;return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),Ema.BattleReadyTimeoutResp=function(){function e(t){if(t)for(var e=Object.keys(t),i=0;i<e.length;++i)if(null!=t[e[i]])this[e[i]]=t[e[i]]}return e.prototype.code=0,e.prototype.info="",e.prototype.instanceId="",e.prototype.pluginId="",e.prototype.roomId="",e.create=function(t){return new e(t)},e.encode=function(t,e){if(!e)e=$Writer.create();return e.uint32(8).int32(t.code),e.uint32(18).string(t.info),e.uint32(26).string(t.instanceId),e.uint32(34).string(t.pluginId),e.uint32(42).string(t.roomId),e},e.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},e.decode=function(t,e){if(!(t instanceof $Reader))t=$Reader.create(t);for(var i=void 0===e?t.len:t.pos+e,n=new $root.game.BattleReadyTimeoutResp;t.pos<i;){var r=t.uint32();switch(r>>>3){case 1:n.code=t.int32();break;case 2:n.info=t.string();break;case 3:n.instanceId=t.string();break;case 4:n.pluginId=t.string();break;case 5:n.roomId=t.string();break;default:t.skipType(7&r)}}if(!n.hasOwnProperty("code"))throw $util.ProtocolError("missing required 'code'",{instance:n});if(!n.hasOwnProperty("info"))throw $util.ProtocolError("missing required 'info'",{instance:n});if(!n.hasOwnProperty("instanceId"))throw $util.ProtocolError("missing required 'instanceId'",{instance:n});if(!n.hasOwnProperty("pluginId"))throw $util.ProtocolError("missing required 'pluginId'",{instance:n});if(!n.hasOwnProperty("roomId"))throw $util.ProtocolError("missing required 'roomId'",{instance:n});return n},e.decodeDelimited=function(t){if(!(t instanceof $Reader))t=new $Reader(t);return this.decode(t,t.uint32())},e.verify=function(t){if("object"!==_typeof(t)||null===t)return"object expected";if(!$util.isInteger(t.code))return"code: integer expected";if(!$util.isString(t.info))return"info: string expected";if(!$util.isString(t.instanceId))return"instanceId: string expected";if(!$util.isString(t.pluginId))return"pluginId: string expected";if(!$util.isString(t.roomId))return"roomId: string expected";else return null},e.fromObject=function(t){if(t instanceof $root.game.BattleReadyTimeoutResp)return t;var e=new $root.game.BattleReadyTimeoutResp;if(null!=t.code)e.code=0|t.code;if(null!=t.info)e.info=String(t.info);if(null!=t.instanceId)e.instanceId=String(t.instanceId);if(null!=t.pluginId)e.pluginId=String(t.pluginId);if(null!=t.roomId)e.roomId=String(t.roomId);return e},e.toObject=function(t,e){if(!e)e={};var i={};if(e.defaults)i.code=0,i.info="",i.instanceId="",i.pluginId="",i.roomId="";if(null!=t.code&&t.hasOwnProperty("code"))i.code=t.code;if(null!=t.info&&t.hasOwnProperty("info"))i.info=t.info;if(null!=t.instanceId&&t.hasOwnProperty("instanceId"))i.instanceId=t.instanceId;if(null!=t.pluginId&&t.hasOwnProperty("pluginId"))i.pluginId=t.pluginId;if(null!=t.roomId&&t.hasOwnProperty("roomId"))i.roomId=t.roomId;return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),Ema.BattleReadyTimeoutNoti=function(){function e(t){if(t)for(var e=Object.keys(t),i=0;i<e.length;++i)if(null!=t[e[i]])this[e[i]]=t[e[i]]}return e.prototype.instanceId="",e.prototype.pluginId="",e.prototype.roomId="",e.prototype.senderId="",e.create=function(t){return new e(t)},e.encode=function(t,e){if(!e)e=$Writer.create();return e.uint32(10).string(t.instanceId),e.uint32(18).string(t.pluginId),e.uint32(26).string(t.roomId),e.uint32(34).string(t.senderId),e},e.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},e.decode=function(t,e){if(!(t instanceof $Reader))t=$Reader.create(t);for(var i=void 0===e?t.len:t.pos+e,n=new $root.game.BattleReadyTimeoutNoti;t.pos<i;){var r=t.uint32();switch(r>>>3){case 1:n.instanceId=t.string();break;case 2:n.pluginId=t.string();break;case 3:n.roomId=t.string();break;case 4:n.senderId=t.string();break;default:t.skipType(7&r)}}if(!n.hasOwnProperty("instanceId"))throw $util.ProtocolError("missing required 'instanceId'",{instance:n});if(!n.hasOwnProperty("pluginId"))throw $util.ProtocolError("missing required 'pluginId'",{instance:n});if(!n.hasOwnProperty("roomId"))throw $util.ProtocolError("missing required 'roomId'",{instance:n});if(!n.hasOwnProperty("senderId"))throw $util.ProtocolError("missing required 'senderId'",{instance:n});return n},e.decodeDelimited=function(t){if(!(t instanceof $Reader))t=new $Reader(t);return this.decode(t,t.uint32())},e.verify=function(t){if("object"!==_typeof(t)||null===t)return"object expected";if(!$util.isString(t.instanceId))return"instanceId: string expected";if(!$util.isString(t.pluginId))return"pluginId: string expected";if(!$util.isString(t.roomId))return"roomId: string expected";if(!$util.isString(t.senderId))return"senderId: string expected";else return null},e.fromObject=function(t){if(t instanceof $root.game.BattleReadyTimeoutNoti)return t;var e=new $root.game.BattleReadyTimeoutNoti;if(null!=t.instanceId)e.instanceId=String(t.instanceId);if(null!=t.pluginId)e.pluginId=String(t.pluginId);if(null!=t.roomId)e.roomId=String(t.roomId);if(null!=t.senderId)e.senderId=String(t.senderId);return e},e.toObject=function(t,e){if(!e)e={};var i={};if(e.defaults)i.instanceId="",i.pluginId="",i.roomId="",i.senderId="";if(null!=t.instanceId&&t.hasOwnProperty("instanceId"))i.instanceId=t.instanceId;if(null!=t.pluginId&&t.hasOwnProperty("pluginId"))i.pluginId=t.pluginId;if(null!=t.roomId&&t.hasOwnProperty("roomId"))i.roomId=t.roomId;if(null!=t.senderId&&t.hasOwnProperty("senderId"))i.senderId=t.senderId;return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),Ema.BattleCancelMatchReq=function(){function e(t){if(t)for(var e=Object.keys(t),i=0;i<e.length;++i)if(null!=t[e[i]])this[e[i]]=t[e[i]]}return e.prototype.instanceId="",e.prototype.pluginId="",e.prototype.roomId="",e.create=function(t){return new e(t)},e.encode=function(t,e){if(!e)e=$Writer.create();return e.uint32(10).string(t.instanceId),e.uint32(18).string(t.pluginId),e.uint32(26).string(t.roomId),e},e.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},e.decode=function(t,e){if(!(t instanceof $Reader))t=$Reader.create(t);for(var i=void 0===e?t.len:t.pos+e,n=new $root.game.BattleCancelMatchReq;t.pos<i;){var r=t.uint32();switch(r>>>3){case 1:n.instanceId=t.string();break;case 2:n.pluginId=t.string();break;case 3:n.roomId=t.string();break;default:t.skipType(7&r)}}if(!n.hasOwnProperty("instanceId"))throw $util.ProtocolError("missing required 'instanceId'",{instance:n});if(!n.hasOwnProperty("pluginId"))throw $util.ProtocolError("missing required 'pluginId'",{instance:n});if(!n.hasOwnProperty("roomId"))throw $util.ProtocolError("missing required 'roomId'",{instance:n});return n},e.decodeDelimited=function(t){if(!(t instanceof $Reader))t=new $Reader(t);return this.decode(t,t.uint32())},e.verify=function(t){if("object"!==_typeof(t)||null===t)return"object expected";if(!$util.isString(t.instanceId))return"instanceId: string expected";if(!$util.isString(t.pluginId))return"pluginId: string expected";if(!$util.isString(t.roomId))return"roomId: string expected";else return null},e.fromObject=function(t){if(t instanceof $root.game.BattleCancelMatchReq)return t;var e=new $root.game.BattleCancelMatchReq;if(null!=t.instanceId)e.instanceId=String(t.instanceId);if(null!=t.pluginId)e.pluginId=String(t.pluginId);if(null!=t.roomId)e.roomId=String(t.roomId);return e},e.toObject=function(t,e){if(!e)e={};var i={};if(e.defaults)i.instanceId="",i.pluginId="",i.roomId="";if(null!=t.instanceId&&t.hasOwnProperty("instanceId"))i.instanceId=t.instanceId;if(null!=t.pluginId&&t.hasOwnProperty("pluginId"))i.pluginId=t.pluginId;if(null!=t.roomId&&t.hasOwnProperty("roomId"))i.roomId=t.roomId;return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),Ema.BattleCancelMatchResp=function(){function e(t){if(t)for(var e=Object.keys(t),i=0;i<e.length;++i)if(null!=t[e[i]])this[e[i]]=t[e[i]]}return e.prototype.code=0,e.prototype.info="",e.prototype.instanceId="",e.prototype.pluginId="",e.prototype.roomId="",e.create=function(t){return new e(t)},e.encode=function(t,e){if(!e)e=$Writer.create();return e.uint32(8).int32(t.code),e.uint32(18).string(t.info),e.uint32(26).string(t.instanceId),e.uint32(34).string(t.pluginId),e.uint32(42).string(t.roomId),e},e.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},e.decode=function(t,e){if(!(t instanceof $Reader))t=$Reader.create(t);for(var i=void 0===e?t.len:t.pos+e,n=new $root.game.BattleCancelMatchResp;t.pos<i;){var r=t.uint32();switch(r>>>3){case 1:n.code=t.int32();break;case 2:n.info=t.string();break;case 3:n.instanceId=t.string();break;case 4:n.pluginId=t.string();break;case 5:n.roomId=t.string();break;default:t.skipType(7&r)}}if(!n.hasOwnProperty("code"))throw $util.ProtocolError("missing required 'code'",{instance:n});if(!n.hasOwnProperty("info"))throw $util.ProtocolError("missing required 'info'",{instance:n});if(!n.hasOwnProperty("instanceId"))throw $util.ProtocolError("missing required 'instanceId'",{instance:n});if(!n.hasOwnProperty("pluginId"))throw $util.ProtocolError("missing required 'pluginId'",{instance:n});if(!n.hasOwnProperty("roomId"))throw $util.ProtocolError("missing required 'roomId'",{instance:n});return n},e.decodeDelimited=function(t){if(!(t instanceof $Reader))t=new $Reader(t);return this.decode(t,t.uint32())},e.verify=function(t){if("object"!==_typeof(t)||null===t)return"object expected";if(!$util.isInteger(t.code))return"code: integer expected";if(!$util.isString(t.info))return"info: string expected";if(!$util.isString(t.instanceId))return"instanceId: string expected";if(!$util.isString(t.pluginId))return"pluginId: string expected";if(!$util.isString(t.roomId))return"roomId: string expected";else return null},e.fromObject=function(t){if(t instanceof $root.game.BattleCancelMatchResp)return t;var e=new $root.game.BattleCancelMatchResp;if(null!=t.code)e.code=0|t.code;if(null!=t.info)e.info=String(t.info);if(null!=t.instanceId)e.instanceId=String(t.instanceId);if(null!=t.pluginId)e.pluginId=String(t.pluginId);if(null!=t.roomId)e.roomId=String(t.roomId);return e},e.toObject=function(t,e){if(!e)e={};var i={};if(e.defaults)i.code=0,i.info="",i.instanceId="",i.pluginId="",i.roomId="";if(null!=t.code&&t.hasOwnProperty("code"))i.code=t.code;if(null!=t.info&&t.hasOwnProperty("info"))i.info=t.info;if(null!=t.instanceId&&t.hasOwnProperty("instanceId"))i.instanceId=t.instanceId;if(null!=t.pluginId&&t.hasOwnProperty("pluginId"))i.pluginId=t.pluginId;if(null!=t.roomId&&t.hasOwnProperty("roomId"))i.roomId=t.roomId;return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),Ema.BattleCancelMatchNoti=function(){function e(t){if(t)for(var e=Object.keys(t),i=0;i<e.length;++i)if(null!=t[e[i]])this[e[i]]=t[e[i]]}return e.prototype.instanceId="",e.prototype.pluginId="",e.prototype.roomId="",e.prototype.senderId="",e.create=function(t){return new e(t)},e.encode=function(t,e){if(!e)e=$Writer.create();return e.uint32(10).string(t.instanceId),e.uint32(18).string(t.pluginId),e.uint32(26).string(t.roomId),e.uint32(34).string(t.senderId),e},e.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},e.decode=function(t,e){if(!(t instanceof $Reader))t=$Reader.create(t);for(var i=void 0===e?t.len:t.pos+e,n=new $root.game.BattleCancelMatchNoti;t.pos<i;){var r=t.uint32();switch(r>>>3){case 1:n.instanceId=t.string();break;case 2:n.pluginId=t.string();break;case 3:n.roomId=t.string();break;case 4:n.senderId=t.string();break;default:t.skipType(7&r)}}if(!n.hasOwnProperty("instanceId"))throw $util.ProtocolError("missing required 'instanceId'",{instance:n});if(!n.hasOwnProperty("pluginId"))throw $util.ProtocolError("missing required 'pluginId'",{instance:n});if(!n.hasOwnProperty("roomId"))throw $util.ProtocolError("missing required 'roomId'",{instance:n});if(!n.hasOwnProperty("senderId"))throw $util.ProtocolError("missing required 'senderId'",{instance:n});return n},e.decodeDelimited=function(t){if(!(t instanceof $Reader))t=new $Reader(t);return this.decode(t,t.uint32())},e.verify=function(t){if("object"!==_typeof(t)||null===t)return"object expected";if(!$util.isString(t.instanceId))return"instanceId: string expected";if(!$util.isString(t.pluginId))return"pluginId: string expected";if(!$util.isString(t.roomId))return"roomId: string expected";if(!$util.isString(t.senderId))return"senderId: string expected";else return null},e.fromObject=function(t){if(t instanceof $root.game.BattleCancelMatchNoti)return t;var e=new $root.game.BattleCancelMatchNoti;if(null!=t.instanceId)e.instanceId=String(t.instanceId);if(null!=t.pluginId)e.pluginId=String(t.pluginId);if(null!=t.roomId)e.roomId=String(t.roomId);if(null!=t.senderId)e.senderId=String(t.senderId);return e},e.toObject=function(t,e){if(!e)e={};var i={};if(e.defaults)i.instanceId="",i.pluginId="",i.roomId="",i.senderId="";if(null!=t.instanceId&&t.hasOwnProperty("instanceId"))i.instanceId=t.instanceId;if(null!=t.pluginId&&t.hasOwnProperty("pluginId"))i.pluginId=t.pluginId;if(null!=t.roomId&&t.hasOwnProperty("roomId"))i.roomId=t.roomId;if(null!=t.senderId&&t.hasOwnProperty("senderId"))i.senderId=t.senderId;return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),Ema.BattleRoundTimeoutNoti=function(){function e(t){if(this.players=[],t)for(var e=Object.keys(t),i=0;i<e.length;++i)if(null!=t[e[i]])this[e[i]]=t[e[i]]}return e.prototype.instanceId="",e.prototype.pluginId="",e.prototype.roomId="",e.prototype.round=0,e.prototype.roundStartTime=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.players=$util.emptyArray,e.create=function(t){return new e(t)},e.encode=function(t,e){if(!e)e=$Writer.create();if(e.uint32(10).string(t.instanceId),e.uint32(18).string(t.pluginId),e.uint32(26).string(t.roomId),e.uint32(32).int32(t.round),e.uint32(40).int64(t.roundStartTime),null!=t.players&&t.players.length)for(var i=0;i<t.players.length;++i)$root.game.BattlePlayer.encode(t.players[i],e.uint32(50).fork()).ldelim();return e},e.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},e.decode=function(t,e){if(!(t instanceof $Reader))t=$Reader.create(t);for(var i=void 0===e?t.len:t.pos+e,n=new $root.game.BattleRoundTimeoutNoti;t.pos<i;){var r=t.uint32();switch(r>>>3){case 1:n.instanceId=t.string();break;case 2:n.pluginId=t.string();break;case 3:n.roomId=t.string();break;case 4:n.round=t.int32();break;case 5:n.roundStartTime=t.int64();break;case 6:if(!n.players||!n.players.length)n.players=[];n.players.push($root.game.BattlePlayer.decode(t,t.uint32()));break;default:t.skipType(7&r)}}if(!n.hasOwnProperty("instanceId"))throw $util.ProtocolError("missing required 'instanceId'",{instance:n});if(!n.hasOwnProperty("pluginId"))throw $util.ProtocolError("missing required 'pluginId'",{instance:n});if(!n.hasOwnProperty("roomId"))throw $util.ProtocolError("missing required 'roomId'",{instance:n});if(!n.hasOwnProperty("round"))throw $util.ProtocolError("missing required 'round'",{instance:n});if(!n.hasOwnProperty("roundStartTime"))throw $util.ProtocolError("missing required 'roundStartTime'",{instance:n});return n},e.decodeDelimited=function(t){if(!(t instanceof $Reader))t=new $Reader(t);return this.decode(t,t.uint32())},e.verify=function(t){if("object"!==_typeof(t)||null===t)return"object expected";if(!$util.isString(t.instanceId))return"instanceId: string expected";if(!$util.isString(t.pluginId))return"pluginId: string expected";if(!$util.isString(t.roomId))return"roomId: string expected";if(!$util.isInteger(t.round))return"round: integer expected";if(!($util.isInteger(t.roundStartTime)||t.roundStartTime&&$util.isInteger(t.roundStartTime.low)&&$util.isInteger(t.roundStartTime.high)))return"roundStartTime: integer|Long expected";if(null!=t.players&&t.hasOwnProperty("players")){if(!Array.isArray(t.players))return"players: array expected";for(var e=0;e<t.players.length;++e){var i=$root.game.BattlePlayer.verify(t.players[e]);if(i)return"players."+i}}return null},e.fromObject=function(t){if(t instanceof $root.game.BattleRoundTimeoutNoti)return t;var e=new $root.game.BattleRoundTimeoutNoti;if(null!=t.instanceId)e.instanceId=String(t.instanceId);if(null!=t.pluginId)e.pluginId=String(t.pluginId);if(null!=t.roomId)e.roomId=String(t.roomId);if(null!=t.round)e.round=0|t.round;if(null!=t.roundStartTime)if($util.Long)(e.roundStartTime=$util.Long.fromValue(t.roundStartTime)).unsigned=!1;else if("string"==typeof t.roundStartTime)e.roundStartTime=parseInt(t.roundStartTime,10);else if("number"==typeof t.roundStartTime)e.roundStartTime=t.roundStartTime;else if("object"===_typeof(t.roundStartTime))e.roundStartTime=new $util.LongBits(t.roundStartTime.low>>>0,t.roundStartTime.high>>>0).toNumber();if(t.players){if(!Array.isArray(t.players))throw TypeError(".game.BattleRoundTimeoutNoti.players: array expected");e.players=[];for(var i=0;i<t.players.length;++i){if("object"!==_typeof(t.players[i]))throw TypeError(".game.BattleRoundTimeoutNoti.players: object expected");e.players[i]=$root.game.BattlePlayer.fromObject(t.players[i])}}return e},e.toObject=function(t,e){if(!e)e={};var i={};if(e.arrays||e.defaults)i.players=[];if(e.defaults)if(i.instanceId="",i.pluginId="",i.roomId="",i.round=0,$util.Long){var n=new $util.Long(0,0,!1);i.roundStartTime=e.longs===String?n.toString():e.longs===Number?n.toNumber():n}else i.roundStartTime=e.longs===String?"0":0;if(null!=t.instanceId&&t.hasOwnProperty("instanceId"))i.instanceId=t.instanceId;if(null!=t.pluginId&&t.hasOwnProperty("pluginId"))i.pluginId=t.pluginId;if(null!=t.roomId&&t.hasOwnProperty("roomId"))i.roomId=t.roomId;if(null!=t.round&&t.hasOwnProperty("round"))i.round=t.round;if(null!=t.roundStartTime&&t.hasOwnProperty("roundStartTime"))if("number"==typeof t.roundStartTime)i.roundStartTime=e.longs===String?String(t.roundStartTime):t.roundStartTime;else i.roundStartTime=e.longs===String?$util.Long.prototype.toString.call(t.roundStartTime):e.longs===Number?new $util.LongBits(t.roundStartTime.low>>>0,t.roundStartTime.high>>>0).toNumber():t.roundStartTime;if(t.players&&t.players.length){i.players=[];for(var r=0;r<t.players.length;++r)i.players[r]=$root.game.BattlePlayer.toObject(t.players[r],e)}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),Ema.BattleFinishPKReq=function(){function e(t){if(t)for(var e=Object.keys(t),i=0;i<e.length;++i)if(null!=t[e[i]])this[e[i]]=t[e[i]]}return e.prototype.instanceId="",e.prototype.pluginId="",e.prototype.roomId="",e.create=function(t){return new e(t)},e.encode=function(t,e){if(!e)e=$Writer.create();return e.uint32(10).string(t.instanceId),e.uint32(18).string(t.pluginId),e.uint32(26).string(t.roomId),e},e.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},e.decode=function(t,e){if(!(t instanceof $Reader))t=$Reader.create(t);for(var i=void 0===e?t.len:t.pos+e,n=new $root.game.BattleFinishPKReq;t.pos<i;){var r=t.uint32();switch(r>>>3){case 1:n.instanceId=t.string();break;case 2:n.pluginId=t.string();break;case 3:n.roomId=t.string();break;default:t.skipType(7&r)}}if(!n.hasOwnProperty("instanceId"))throw $util.ProtocolError("missing required 'instanceId'",{instance:n});if(!n.hasOwnProperty("pluginId"))throw $util.ProtocolError("missing required 'pluginId'",{instance:n});if(!n.hasOwnProperty("roomId"))throw $util.ProtocolError("missing required 'roomId'",{instance:n});return n},e.decodeDelimited=function(t){if(!(t instanceof $Reader))t=new $Reader(t);return this.decode(t,t.uint32())},e.verify=function(t){if("object"!==_typeof(t)||null===t)return"object expected";if(!$util.isString(t.instanceId))return"instanceId: string expected";if(!$util.isString(t.pluginId))return"pluginId: string expected";if(!$util.isString(t.roomId))return"roomId: string expected";else return null},e.fromObject=function(t){if(t instanceof $root.game.BattleFinishPKReq)return t;var e=new $root.game.BattleFinishPKReq;if(null!=t.instanceId)e.instanceId=String(t.instanceId);if(null!=t.pluginId)e.pluginId=String(t.pluginId);if(null!=t.roomId)e.roomId=String(t.roomId);return e},e.toObject=function(t,e){if(!e)e={};var i={};if(e.defaults)i.instanceId="",i.pluginId="",i.roomId="";if(null!=t.instanceId&&t.hasOwnProperty("instanceId"))i.instanceId=t.instanceId;if(null!=t.pluginId&&t.hasOwnProperty("pluginId"))i.pluginId=t.pluginId;if(null!=t.roomId&&t.hasOwnProperty("roomId"))i.roomId=t.roomId;return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),Ema.BattleFinishPKResp=function(){function e(t){if(t)for(var e=Object.keys(t),i=0;i<e.length;++i)if(null!=t[e[i]])this[e[i]]=t[e[i]]}return e.prototype.code=0,e.prototype.info="",e.prototype.instanceId="",e.prototype.pluginId="",e.prototype.roomId="",e.create=function(t){return new e(t)},e.encode=function(t,e){if(!e)e=$Writer.create();return e.uint32(8).int32(t.code),e.uint32(18).string(t.info),e.uint32(26).string(t.instanceId),e.uint32(34).string(t.pluginId),e.uint32(42).string(t.roomId),e},e.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},e.decode=function(t,e){if(!(t instanceof $Reader))t=$Reader.create(t);for(var i=void 0===e?t.len:t.pos+e,n=new $root.game.BattleFinishPKResp;t.pos<i;){var r=t.uint32();switch(r>>>3){case 1:n.code=t.int32();break;case 2:n.info=t.string();break;case 3:n.instanceId=t.string();break;case 4:n.pluginId=t.string();break;case 5:n.roomId=t.string();break;default:t.skipType(7&r)}}if(!n.hasOwnProperty("code"))throw $util.ProtocolError("missing required 'code'",{instance:n});if(!n.hasOwnProperty("info"))throw $util.ProtocolError("missing required 'info'",{instance:n});if(!n.hasOwnProperty("instanceId"))throw $util.ProtocolError("missing required 'instanceId'",{instance:n});if(!n.hasOwnProperty("pluginId"))throw $util.ProtocolError("missing required 'pluginId'",{instance:n});if(!n.hasOwnProperty("roomId"))throw $util.ProtocolError("missing required 'roomId'",{instance:n});return n},e.decodeDelimited=function(t){if(!(t instanceof $Reader))t=new $Reader(t);return this.decode(t,t.uint32())},e.verify=function(t){if("object"!==_typeof(t)||null===t)return"object expected";if(!$util.isInteger(t.code))return"code: integer expected";if(!$util.isString(t.info))return"info: string expected";if(!$util.isString(t.instanceId))return"instanceId: string expected";if(!$util.isString(t.pluginId))return"pluginId: string expected";if(!$util.isString(t.roomId))return"roomId: string expected";else return null},e.fromObject=function(t){if(t instanceof $root.game.BattleFinishPKResp)return t;var e=new $root.game.BattleFinishPKResp;if(null!=t.code)e.code=0|t.code;if(null!=t.info)e.info=String(t.info);if(null!=t.instanceId)e.instanceId=String(t.instanceId);if(null!=t.pluginId)e.pluginId=String(t.pluginId);if(null!=t.roomId)e.roomId=String(t.roomId);return e},e.toObject=function(t,e){if(!e)e={};var i={};if(e.defaults)i.code=0,i.info="",i.instanceId="",i.pluginId="",i.roomId="";if(null!=t.code&&t.hasOwnProperty("code"))i.code=t.code;if(null!=t.info&&t.hasOwnProperty("info"))i.info=t.info;if(null!=t.instanceId&&t.hasOwnProperty("instanceId"))i.instanceId=t.instanceId;if(null!=t.pluginId&&t.hasOwnProperty("pluginId"))i.pluginId=t.pluginId;if(null!=t.roomId&&t.hasOwnProperty("roomId"))i.roomId=t.roomId;return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),Ema.BattleFinishPKNoti=function(){function e(t){if(t)for(var e=Object.keys(t),i=0;i<e.length;++i)if(null!=t[e[i]])this[e[i]]=t[e[i]]}return e.prototype.instanceId="",e.prototype.pluginId="",e.prototype.roomId="",e.prototype.senderId="",e.create=function(t){return new e(t)},e.encode=function(t,e){if(!e)e=$Writer.create();return e.uint32(10).string(t.instanceId),e.uint32(18).string(t.pluginId),e.uint32(26).string(t.roomId),e.uint32(34).string(t.senderId),e},e.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},e.decode=function(t,e){if(!(t instanceof $Reader))t=$Reader.create(t);for(var i=void 0===e?t.len:t.pos+e,n=new $root.game.BattleFinishPKNoti;t.pos<i;){var r=t.uint32();switch(r>>>3){case 1:n.instanceId=t.string();break;case 2:n.pluginId=t.string();break;case 3:n.roomId=t.string();break;case 4:n.senderId=t.string();break;default:t.skipType(7&r)}}if(!n.hasOwnProperty("instanceId"))throw $util.ProtocolError("missing required 'instanceId'",{instance:n});if(!n.hasOwnProperty("pluginId"))throw $util.ProtocolError("missing required 'pluginId'",{instance:n});if(!n.hasOwnProperty("roomId"))throw $util.ProtocolError("missing required 'roomId'",{instance:n});if(!n.hasOwnProperty("senderId"))throw $util.ProtocolError("missing required 'senderId'",{instance:n});return n},e.decodeDelimited=function(t){if(!(t instanceof $Reader))t=new $Reader(t);return this.decode(t,t.uint32())},e.verify=function(t){if("object"!==_typeof(t)||null===t)return"object expected";if(!$util.isString(t.instanceId))return"instanceId: string expected";if(!$util.isString(t.pluginId))return"pluginId: string expected";if(!$util.isString(t.roomId))return"roomId: string expected";if(!$util.isString(t.senderId))return"senderId: string expected";else return null},e.fromObject=function(t){if(t instanceof $root.game.BattleFinishPKNoti)return t;var e=new $root.game.BattleFinishPKNoti;if(null!=t.instanceId)e.instanceId=String(t.instanceId);if(null!=t.pluginId)e.pluginId=String(t.pluginId);if(null!=t.roomId)e.roomId=String(t.roomId);if(null!=t.senderId)e.senderId=String(t.senderId);return e},e.toObject=function(t,e){if(!e)e={};var i={};if(e.defaults)i.instanceId="",i.pluginId="",i.roomId="",i.senderId="";if(null!=t.instanceId&&t.hasOwnProperty("instanceId"))i.instanceId=t.instanceId;if(null!=t.pluginId&&t.hasOwnProperty("pluginId"))i.pluginId=t.pluginId;if(null!=t.roomId&&t.hasOwnProperty("roomId"))i.roomId=t.roomId;if(null!=t.senderId&&t.hasOwnProperty("senderId"))i.senderId=t.senderId;return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),Ema.BattleCreateRoomReq=function(){function e(t){if(t)for(var e=Object.keys(t),i=0;i<e.length;++i)if(null!=t[e[i]])this[e[i]]=t[e[i]]}return e.prototype.instanceId="",e.prototype.pluginId="",e.create=function(t){return new e(t)},e.encode=function(t,e){if(!e)e=$Writer.create();return e.uint32(10).string(t.instanceId),e.uint32(18).string(t.pluginId),e},e.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},e.decode=function(t,e){if(!(t instanceof $Reader))t=$Reader.create(t);for(var i=void 0===e?t.len:t.pos+e,n=new $root.game.BattleCreateRoomReq;t.pos<i;){var r=t.uint32();switch(r>>>3){case 1:n.instanceId=t.string();break;case 2:n.pluginId=t.string();break;default:t.skipType(7&r)}}if(!n.hasOwnProperty("instanceId"))throw $util.ProtocolError("missing required 'instanceId'",{instance:n});if(!n.hasOwnProperty("pluginId"))throw $util.ProtocolError("missing required 'pluginId'",{instance:n});return n},e.decodeDelimited=function(t){if(!(t instanceof $Reader))t=new $Reader(t);return this.decode(t,t.uint32())},e.verify=function(t){if("object"!==_typeof(t)||null===t)return"object expected";if(!$util.isString(t.instanceId))return"instanceId: string expected";if(!$util.isString(t.pluginId))return"pluginId: string expected";else return null},e.fromObject=function(t){if(t instanceof $root.game.BattleCreateRoomReq)return t;var e=new $root.game.BattleCreateRoomReq;if(null!=t.instanceId)e.instanceId=String(t.instanceId);if(null!=t.pluginId)e.pluginId=String(t.pluginId);return e},e.toObject=function(t,e){if(!e)e={};var i={};if(e.defaults)i.instanceId="",i.pluginId="";if(null!=t.instanceId&&t.hasOwnProperty("instanceId"))i.instanceId=t.instanceId;if(null!=t.pluginId&&t.hasOwnProperty("pluginId"))i.pluginId=t.pluginId;return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),Ema.BattleCreateRoomResp=function(){function e(t){if(t)for(var e=Object.keys(t),i=0;i<e.length;++i)if(null!=t[e[i]])this[e[i]]=t[e[i]]}return e.prototype.code=0,e.prototype.info="",e.prototype.instanceId="",e.prototype.pluginId="",e.prototype.roomId="",e.prototype.inviteCode="",e.create=function(t){return new e(t)},e.encode=function(t,e){if(!e)e=$Writer.create();return e.uint32(8).int32(t.code),e.uint32(18).string(t.info),e.uint32(26).string(t.instanceId),e.uint32(34).string(t.pluginId),e.uint32(42).string(t.roomId),e.uint32(50).string(t.inviteCode),e},e.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},e.decode=function(t,e){if(!(t instanceof $Reader))t=$Reader.create(t);for(var i=void 0===e?t.len:t.pos+e,n=new $root.game.BattleCreateRoomResp;t.pos<i;){var r=t.uint32();switch(r>>>3){case 1:n.code=t.int32();break;case 2:n.info=t.string();break;case 3:n.instanceId=t.string();break;case 4:n.pluginId=t.string();break;case 5:n.roomId=t.string();break;case 6:n.inviteCode=t.string();break;default:t.skipType(7&r)}}if(!n.hasOwnProperty("code"))throw $util.ProtocolError("missing required 'code'",{instance:n});if(!n.hasOwnProperty("info"))throw $util.ProtocolError("missing required 'info'",{instance:n});if(!n.hasOwnProperty("instanceId"))throw $util.ProtocolError("missing required 'instanceId'",{instance:n});if(!n.hasOwnProperty("pluginId"))throw $util.ProtocolError("missing required 'pluginId'",{instance:n});if(!n.hasOwnProperty("roomId"))throw $util.ProtocolError("missing required 'roomId'",{instance:n});if(!n.hasOwnProperty("inviteCode"))throw $util.ProtocolError("missing required 'inviteCode'",{instance:n});return n},e.decodeDelimited=function(t){if(!(t instanceof $Reader))t=new $Reader(t);return this.decode(t,t.uint32())},e.verify=function(t){if("object"!==_typeof(t)||null===t)return"object expected";if(!$util.isInteger(t.code))return"code: integer expected";if(!$util.isString(t.info))return"info: string expected";if(!$util.isString(t.instanceId))return"instanceId: string expected";if(!$util.isString(t.pluginId))return"pluginId: string expected";if(!$util.isString(t.roomId))return"roomId: string expected";if(!$util.isString(t.inviteCode))return"inviteCode: string expected";else return null},e.fromObject=function(t){if(t instanceof $root.game.BattleCreateRoomResp)return t;var e=new $root.game.BattleCreateRoomResp;if(null!=t.code)e.code=0|t.code;if(null!=t.info)e.info=String(t.info);if(null!=t.instanceId)e.instanceId=String(t.instanceId);if(null!=t.pluginId)e.pluginId=String(t.pluginId);if(null!=t.roomId)e.roomId=String(t.roomId);if(null!=t.inviteCode)e.inviteCode=String(t.inviteCode);return e},e.toObject=function(t,e){if(!e)e={};var i={};if(e.defaults)i.code=0,i.info="",i.instanceId="",i.pluginId="",i.roomId="",i.inviteCode="";if(null!=t.code&&t.hasOwnProperty("code"))i.code=t.code;if(null!=t.info&&t.hasOwnProperty("info"))i.info=t.info;if(null!=t.instanceId&&t.hasOwnProperty("instanceId"))i.instanceId=t.instanceId;if(null!=t.pluginId&&t.hasOwnProperty("pluginId"))i.pluginId=t.pluginId;if(null!=t.roomId&&t.hasOwnProperty("roomId"))i.roomId=t.roomId;if(null!=t.inviteCode&&t.hasOwnProperty("inviteCode"))i.inviteCode=t.inviteCode;return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),Ema.BattleJoinRoomReq=function(){function e(t){if(t)for(var e=Object.keys(t),i=0;i<e.length;++i)if(null!=t[e[i]])this[e[i]]=t[e[i]]}return e.prototype.instanceId="",e.prototype.pluginId="",e.prototype.inviteCode="",e.create=function(t){return new e(t)},e.encode=function(t,e){if(!e)e=$Writer.create();return e.uint32(10).string(t.instanceId),e.uint32(18).string(t.pluginId),e.uint32(26).string(t.inviteCode),e},e.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},e.decode=function(t,e){if(!(t instanceof $Reader))t=$Reader.create(t);for(var i=void 0===e?t.len:t.pos+e,n=new $root.game.BattleJoinRoomReq;t.pos<i;){var r=t.uint32();switch(r>>>3){case 1:n.instanceId=t.string();break;case 2:n.pluginId=t.string();break;case 3:n.inviteCode=t.string();break;default:t.skipType(7&r)}}if(!n.hasOwnProperty("instanceId"))throw $util.ProtocolError("missing required 'instanceId'",{instance:n});if(!n.hasOwnProperty("pluginId"))throw $util.ProtocolError("missing required 'pluginId'",{instance:n});if(!n.hasOwnProperty("inviteCode"))throw $util.ProtocolError("missing required 'inviteCode'",{instance:n});return n},e.decodeDelimited=function(t){if(!(t instanceof $Reader))t=new $Reader(t);return this.decode(t,t.uint32())},e.verify=function(t){if("object"!==_typeof(t)||null===t)return"object expected";if(!$util.isString(t.instanceId))return"instanceId: string expected";if(!$util.isString(t.pluginId))return"pluginId: string expected";if(!$util.isString(t.inviteCode))return"inviteCode: string expected";else return null},e.fromObject=function(t){if(t instanceof $root.game.BattleJoinRoomReq)return t;var e=new $root.game.BattleJoinRoomReq;if(null!=t.instanceId)e.instanceId=String(t.instanceId);if(null!=t.pluginId)e.pluginId=String(t.pluginId);if(null!=t.inviteCode)e.inviteCode=String(t.inviteCode);return e},e.toObject=function(t,e){if(!e)e={};var i={};if(e.defaults)i.instanceId="",i.pluginId="",i.inviteCode="";if(null!=t.instanceId&&t.hasOwnProperty("instanceId"))i.instanceId=t.instanceId;if(null!=t.pluginId&&t.hasOwnProperty("pluginId"))i.pluginId=t.pluginId;if(null!=t.inviteCode&&t.hasOwnProperty("inviteCode"))i.inviteCode=t.inviteCode;return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),Ema.BattleJoinRoomResp=function(){function e(t){if(t)for(var e=Object.keys(t),i=0;i<e.length;++i)if(null!=t[e[i]])this[e[i]]=t[e[i]]}return e.prototype.code=0,e.prototype.info="",e.prototype.instanceId="",e.prototype.pluginId="",e.prototype.roomId="",e.prototype.inviteCode="",e.create=function(t){return new e(t)},e.encode=function(t,e){if(!e)e=$Writer.create();return e.uint32(8).int32(t.code),e.uint32(18).string(t.info),e.uint32(26).string(t.instanceId),e.uint32(34).string(t.pluginId),e.uint32(42).string(t.roomId),e.uint32(50).string(t.inviteCode),e},e.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},e.decode=function(t,e){if(!(t instanceof $Reader))t=$Reader.create(t);for(var i=void 0===e?t.len:t.pos+e,n=new $root.game.BattleJoinRoomResp;t.pos<i;){var r=t.uint32();switch(r>>>3){case 1:n.code=t.int32();break;case 2:n.info=t.string();break;case 3:n.instanceId=t.string();break;case 4:n.pluginId=t.string();break;case 5:n.roomId=t.string();break;case 6:n.inviteCode=t.string();break;default:t.skipType(7&r)}}if(!n.hasOwnProperty("code"))throw $util.ProtocolError("missing required 'code'",{instance:n});if(!n.hasOwnProperty("info"))throw $util.ProtocolError("missing required 'info'",{instance:n});if(!n.hasOwnProperty("instanceId"))throw $util.ProtocolError("missing required 'instanceId'",{instance:n});if(!n.hasOwnProperty("pluginId"))throw $util.ProtocolError("missing required 'pluginId'",{instance:n});if(!n.hasOwnProperty("roomId"))throw $util.ProtocolError("missing required 'roomId'",{instance:n});if(!n.hasOwnProperty("inviteCode"))throw $util.ProtocolError("missing required 'inviteCode'",{instance:n});return n},e.decodeDelimited=function(t){if(!(t instanceof $Reader))t=new $Reader(t);return this.decode(t,t.uint32())},e.verify=function(t){if("object"!==_typeof(t)||null===t)return"object expected";if(!$util.isInteger(t.code))return"code: integer expected";if(!$util.isString(t.info))return"info: string expected";if(!$util.isString(t.instanceId))return"instanceId: string expected";if(!$util.isString(t.pluginId))return"pluginId: string expected";if(!$util.isString(t.roomId))return"roomId: string expected";if(!$util.isString(t.inviteCode))return"inviteCode: string expected";else return null},e.fromObject=function(t){if(t instanceof $root.game.BattleJoinRoomResp)return t;var e=new $root.game.BattleJoinRoomResp;if(null!=t.code)e.code=0|t.code;if(null!=t.info)e.info=String(t.info);if(null!=t.instanceId)e.instanceId=String(t.instanceId);if(null!=t.pluginId)e.pluginId=String(t.pluginId);if(null!=t.roomId)e.roomId=String(t.roomId);if(null!=t.inviteCode)e.inviteCode=String(t.inviteCode);return e},e.toObject=function(t,e){if(!e)e={};var i={};if(e.defaults)i.code=0,i.info="",i.instanceId="",i.pluginId="",i.roomId="",i.inviteCode="";if(null!=t.code&&t.hasOwnProperty("code"))i.code=t.code;if(null!=t.info&&t.hasOwnProperty("info"))i.info=t.info;if(null!=t.instanceId&&t.hasOwnProperty("instanceId"))i.instanceId=t.instanceId;if(null!=t.pluginId&&t.hasOwnProperty("pluginId"))i.pluginId=t.pluginId;if(null!=t.roomId&&t.hasOwnProperty("roomId"))i.roomId=t.roomId;if(null!=t.inviteCode&&t.hasOwnProperty("inviteCode"))i.inviteCode=t.inviteCode;return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),Ema.BattleQuitRoomReq=function(){function e(t){if(t)for(var e=Object.keys(t),i=0;i<e.length;++i)if(null!=t[e[i]])this[e[i]]=t[e[i]]}return e.prototype.instanceId="",e.prototype.pluginId="",e.prototype.inviteCode="",e.create=function(t){return new e(t)},e.encode=function(t,e){if(!e)e=$Writer.create();return e.uint32(10).string(t.instanceId),e.uint32(18).string(t.pluginId),e.uint32(26).string(t.inviteCode),e},e.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},e.decode=function(t,e){if(!(t instanceof $Reader))t=$Reader.create(t);for(var i=void 0===e?t.len:t.pos+e,n=new $root.game.BattleQuitRoomReq;t.pos<i;){var r=t.uint32();switch(r>>>3){case 1:n.instanceId=t.string();break;case 2:n.pluginId=t.string();break;case 3:n.inviteCode=t.string();break;default:t.skipType(7&r)}}if(!n.hasOwnProperty("instanceId"))throw $util.ProtocolError("missing required 'instanceId'",{instance:n});if(!n.hasOwnProperty("pluginId"))throw $util.ProtocolError("missing required 'pluginId'",{instance:n});if(!n.hasOwnProperty("inviteCode"))throw $util.ProtocolError("missing required 'inviteCode'",{instance:n});return n},e.decodeDelimited=function(t){if(!(t instanceof $Reader))t=new $Reader(t);return this.decode(t,t.uint32())},e.verify=function(t){if("object"!==_typeof(t)||null===t)return"object expected";if(!$util.isString(t.instanceId))return"instanceId: string expected";if(!$util.isString(t.pluginId))return"pluginId: string expected";if(!$util.isString(t.inviteCode))return"inviteCode: string expected";else return null},e.fromObject=function(t){if(t instanceof $root.game.BattleQuitRoomReq)return t;var e=new $root.game.BattleQuitRoomReq;if(null!=t.instanceId)e.instanceId=String(t.instanceId);if(null!=t.pluginId)e.pluginId=String(t.pluginId);if(null!=t.inviteCode)e.inviteCode=String(t.inviteCode);return e},e.toObject=function(t,e){if(!e)e={};var i={};if(e.defaults)i.instanceId="",i.pluginId="",i.inviteCode="";if(null!=t.instanceId&&t.hasOwnProperty("instanceId"))i.instanceId=t.instanceId;if(null!=t.pluginId&&t.hasOwnProperty("pluginId"))i.pluginId=t.pluginId;if(null!=t.inviteCode&&t.hasOwnProperty("inviteCode"))i.inviteCode=t.inviteCode;return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),Ema.BattleQuitRoomResp=function(){function e(t){if(t)for(var e=Object.keys(t),i=0;i<e.length;++i)if(null!=t[e[i]])this[e[i]]=t[e[i]]}return e.prototype.code=0,e.prototype.info="",e.prototype.instanceId="",e.prototype.pluginId="",e.prototype.roomId="",e.create=function(t){return new e(t)},e.encode=function(t,e){if(!e)e=$Writer.create();return e.uint32(8).int32(t.code),e.uint32(18).string(t.info),e.uint32(26).string(t.instanceId),e.uint32(34).string(t.pluginId),e.uint32(42).string(t.roomId),e},e.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},e.decode=function(t,e){if(!(t instanceof $Reader))t=$Reader.create(t);for(var i=void 0===e?t.len:t.pos+e,n=new $root.game.BattleQuitRoomResp;t.pos<i;){var r=t.uint32();switch(r>>>3){case 1:n.code=t.int32();break;case 2:n.info=t.string();break;case 3:n.instanceId=t.string();break;case 4:n.pluginId=t.string();break;case 5:n.roomId=t.string();break;default:t.skipType(7&r)}}if(!n.hasOwnProperty("code"))throw $util.ProtocolError("missing required 'code'",{instance:n});if(!n.hasOwnProperty("info"))throw $util.ProtocolError("missing required 'info'",{instance:n});if(!n.hasOwnProperty("instanceId"))throw $util.ProtocolError("missing required 'instanceId'",{instance:n});if(!n.hasOwnProperty("pluginId"))throw $util.ProtocolError("missing required 'pluginId'",{instance:n});if(!n.hasOwnProperty("roomId"))throw $util.ProtocolError("missing required 'roomId'",{instance:n});return n},e.decodeDelimited=function(t){if(!(t instanceof $Reader))t=new $Reader(t);return this.decode(t,t.uint32())},e.verify=function(t){if("object"!==_typeof(t)||null===t)return"object expected";if(!$util.isInteger(t.code))return"code: integer expected";if(!$util.isString(t.info))return"info: string expected";if(!$util.isString(t.instanceId))return"instanceId: string expected";if(!$util.isString(t.pluginId))return"pluginId: string expected";if(!$util.isString(t.roomId))return"roomId: string expected";else return null},e.fromObject=function(t){if(t instanceof $root.game.BattleQuitRoomResp)return t;var e=new $root.game.BattleQuitRoomResp;if(null!=t.code)e.code=0|t.code;if(null!=t.info)e.info=String(t.info);if(null!=t.instanceId)e.instanceId=String(t.instanceId);if(null!=t.pluginId)e.pluginId=String(t.pluginId);if(null!=t.roomId)e.roomId=String(t.roomId);return e},e.toObject=function(t,e){if(!e)e={};var i={};if(e.defaults)i.code=0,i.info="",i.instanceId="",i.pluginId="",i.roomId="";if(null!=t.code&&t.hasOwnProperty("code"))i.code=t.code;if(null!=t.info&&t.hasOwnProperty("info"))i.info=t.info;if(null!=t.instanceId&&t.hasOwnProperty("instanceId"))i.instanceId=t.instanceId;if(null!=t.pluginId&&t.hasOwnProperty("pluginId"))i.pluginId=t.pluginId;if(null!=t.roomId&&t.hasOwnProperty("roomId"))i.roomId=t.roomId;return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),Ema.BattleRoomNumberNoti=function(){function e(t){if(t)for(var e=Object.keys(t),i=0;i<e.length;++i)if(null!=t[e[i]])this[e[i]]=t[e[i]]}return e.prototype.code=0,e.prototype.info="",e.prototype.instanceId="",e.prototype.pluginId="",e.prototype.roomId="",e.prototype.roomNumber=0,e.create=function(t){return new e(t)},e.encode=function(t,e){if(!e)e=$Writer.create();return e.uint32(8).int32(t.code),e.uint32(18).string(t.info),e.uint32(26).string(t.instanceId),e.uint32(34).string(t.pluginId),e.uint32(42).string(t.roomId),e.uint32(48).int32(t.roomNumber),e},e.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},e.decode=function(t,e){if(!(t instanceof $Reader))t=$Reader.create(t);for(var i=void 0===e?t.len:t.pos+e,n=new $root.game.BattleRoomNumberNoti;t.pos<i;){var r=t.uint32();switch(r>>>3){case 1:n.code=t.int32();break;case 2:n.info=t.string();break;case 3:n.instanceId=t.string();break;case 4:n.pluginId=t.string();break;case 5:n.roomId=t.string();break;case 6:n.roomNumber=t.int32();break;default:t.skipType(7&r)}}if(!n.hasOwnProperty("code"))throw $util.ProtocolError("missing required 'code'",{instance:n});if(!n.hasOwnProperty("info"))throw $util.ProtocolError("missing required 'info'",{instance:n});if(!n.hasOwnProperty("instanceId"))throw $util.ProtocolError("missing required 'instanceId'",{instance:n});if(!n.hasOwnProperty("pluginId"))throw $util.ProtocolError("missing required 'pluginId'",{instance:n});if(!n.hasOwnProperty("roomId"))throw $util.ProtocolError("missing required 'roomId'",{instance:n});if(!n.hasOwnProperty("roomNumber"))throw $util.ProtocolError("missing required 'roomNumber'",{instance:n});return n},e.decodeDelimited=function(t){if(!(t instanceof $Reader))t=new $Reader(t);return this.decode(t,t.uint32())},e.verify=function(t){if("object"!==_typeof(t)||null===t)return"object expected";if(!$util.isInteger(t.code))return"code: integer expected";if(!$util.isString(t.info))return"info: string expected";if(!$util.isString(t.instanceId))return"instanceId: string expected";if(!$util.isString(t.pluginId))return"pluginId: string expected";if(!$util.isString(t.roomId))return"roomId: string expected";if(!$util.isInteger(t.roomNumber))return"roomNumber: integer expected";else return null},e.fromObject=function(t){if(t instanceof $root.game.BattleRoomNumberNoti)return t;var e=new $root.game.BattleRoomNumberNoti;if(null!=t.code)e.code=0|t.code;if(null!=t.info)e.info=String(t.info);if(null!=t.instanceId)e.instanceId=String(t.instanceId);if(null!=t.pluginId)e.pluginId=String(t.pluginId);if(null!=t.roomId)e.roomId=String(t.roomId);if(null!=t.roomNumber)e.roomNumber=0|t.roomNumber;return e},e.toObject=function(t,e){if(!e)e={};var i={};if(e.defaults)i.code=0,i.info="",i.instanceId="",i.pluginId="",i.roomId="",i.roomNumber=0;if(null!=t.code&&t.hasOwnProperty("code"))i.code=t.code;if(null!=t.info&&t.hasOwnProperty("info"))i.info=t.info;if(null!=t.instanceId&&t.hasOwnProperty("instanceId"))i.instanceId=t.instanceId;if(null!=t.pluginId&&t.hasOwnProperty("pluginId"))i.pluginId=t.pluginId;if(null!=t.roomId&&t.hasOwnProperty("roomId"))i.roomId=t.roomId;if(null!=t.roomNumber&&t.hasOwnProperty("roomNumber"))i.roomNumber=t.roomNumber;return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),Ema.BattleCancelReadyPKReq=function(){function e(t){if(t)for(var e=Object.keys(t),i=0;i<e.length;++i)if(null!=t[e[i]])this[e[i]]=t[e[i]]}return e.prototype.instanceId="",e.prototype.pluginId="",e.prototype.roomId="",e.create=function(t){return new e(t)},e.encode=function(t,e){if(!e)e=$Writer.create();return e.uint32(10).string(t.instanceId),e.uint32(18).string(t.pluginId),e.uint32(26).string(t.roomId),e},e.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},e.decode=function(t,e){if(!(t instanceof $Reader))t=$Reader.create(t);for(var i=void 0===e?t.len:t.pos+e,n=new $root.game.BattleCancelReadyPKReq;t.pos<i;){var r=t.uint32();switch(r>>>3){case 1:n.instanceId=t.string();break;case 2:n.pluginId=t.string();break;case 3:n.roomId=t.string();break;default:t.skipType(7&r)}}if(!n.hasOwnProperty("instanceId"))throw $util.ProtocolError("missing required 'instanceId'",{instance:n});if(!n.hasOwnProperty("pluginId"))throw $util.ProtocolError("missing required 'pluginId'",{instance:n});if(!n.hasOwnProperty("roomId"))throw $util.ProtocolError("missing required 'roomId'",{instance:n});return n},e.decodeDelimited=function(t){if(!(t instanceof $Reader))t=new $Reader(t);return this.decode(t,t.uint32())},e.verify=function(t){if("object"!==_typeof(t)||null===t)return"object expected";if(!$util.isString(t.instanceId))return"instanceId: string expected";if(!$util.isString(t.pluginId))return"pluginId: string expected";if(!$util.isString(t.roomId))return"roomId: string expected";else return null},e.fromObject=function(t){if(t instanceof $root.game.BattleCancelReadyPKReq)return t;var e=new $root.game.BattleCancelReadyPKReq;if(null!=t.instanceId)e.instanceId=String(t.instanceId);if(null!=t.pluginId)e.pluginId=String(t.pluginId);if(null!=t.roomId)e.roomId=String(t.roomId);return e},e.toObject=function(t,e){if(!e)e={};var i={};if(e.defaults)i.instanceId="",i.pluginId="",i.roomId="";if(null!=t.instanceId&&t.hasOwnProperty("instanceId"))i.instanceId=t.instanceId;if(null!=t.pluginId&&t.hasOwnProperty("pluginId"))i.pluginId=t.pluginId;if(null!=t.roomId&&t.hasOwnProperty("roomId"))i.roomId=t.roomId;return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),Ema.BattleCancelReadyPKResp=function(){function e(t){if(t)for(var e=Object.keys(t),i=0;i<e.length;++i)if(null!=t[e[i]])this[e[i]]=t[e[i]]}return e.prototype.code=0,e.prototype.info="",e.prototype.instanceId="",e.prototype.pluginId="",e.prototype.roomId="",e.create=function(t){return new e(t)},e.encode=function(t,e){if(!e)e=$Writer.create();return e.uint32(8).int32(t.code),e.uint32(18).string(t.info),e.uint32(26).string(t.instanceId),e.uint32(34).string(t.pluginId),e.uint32(42).string(t.roomId),e},e.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},e.decode=function(t,e){if(!(t instanceof $Reader))t=$Reader.create(t);for(var i=void 0===e?t.len:t.pos+e,n=new $root.game.BattleCancelReadyPKResp;t.pos<i;){var r=t.uint32();switch(r>>>3){case 1:n.code=t.int32();break;case 2:n.info=t.string();break;case 3:n.instanceId=t.string();break;case 4:n.pluginId=t.string();break;case 5:n.roomId=t.string();break;default:t.skipType(7&r)}}if(!n.hasOwnProperty("code"))throw $util.ProtocolError("missing required 'code'",{instance:n});if(!n.hasOwnProperty("info"))throw $util.ProtocolError("missing required 'info'",{instance:n});if(!n.hasOwnProperty("instanceId"))throw $util.ProtocolError("missing required 'instanceId'",{instance:n});if(!n.hasOwnProperty("pluginId"))throw $util.ProtocolError("missing required 'pluginId'",{instance:n});if(!n.hasOwnProperty("roomId"))throw $util.ProtocolError("missing required 'roomId'",{instance:n});return n},e.decodeDelimited=function(t){if(!(t instanceof $Reader))t=new $Reader(t);return this.decode(t,t.uint32())},e.verify=function(t){if("object"!==_typeof(t)||null===t)return"object expected";if(!$util.isInteger(t.code))return"code: integer expected";if(!$util.isString(t.info))return"info: string expected";if(!$util.isString(t.instanceId))return"instanceId: string expected";if(!$util.isString(t.pluginId))return"pluginId: string expected";if(!$util.isString(t.roomId))return"roomId: string expected";else return null},e.fromObject=function(t){if(t instanceof $root.game.BattleCancelReadyPKResp)return t;var e=new $root.game.BattleCancelReadyPKResp;if(null!=t.code)e.code=0|t.code;if(null!=t.info)e.info=String(t.info);if(null!=t.instanceId)e.instanceId=String(t.instanceId);if(null!=t.pluginId)e.pluginId=String(t.pluginId);if(null!=t.roomId)e.roomId=String(t.roomId);return e},e.toObject=function(t,e){if(!e)e={};var i={};if(e.defaults)i.code=0,i.info="",i.instanceId="",i.pluginId="",i.roomId="";if(null!=t.code&&t.hasOwnProperty("code"))i.code=t.code;if(null!=t.info&&t.hasOwnProperty("info"))i.info=t.info;if(null!=t.instanceId&&t.hasOwnProperty("instanceId"))i.instanceId=t.instanceId;if(null!=t.pluginId&&t.hasOwnProperty("pluginId"))i.pluginId=t.pluginId;if(null!=t.roomId&&t.hasOwnProperty("roomId"))i.roomId=t.roomId;return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),Ema.BattleCancelReadyPKNoti=function(){function e(t){if(t)for(var e=Object.keys(t),i=0;i<e.length;++i)if(null!=t[e[i]])this[e[i]]=t[e[i]]}return e.prototype.instanceId="",e.prototype.pluginId="",e.prototype.roomId="",e.prototype.senderId="",e.create=function(t){return new e(t)},e.encode=function(t,e){if(!e)e=$Writer.create();return e.uint32(10).string(t.instanceId),e.uint32(18).string(t.pluginId),e.uint32(26).string(t.roomId),e.uint32(34).string(t.senderId),e},e.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},e.decode=function(t,e){if(!(t instanceof $Reader))t=$Reader.create(t);for(var i=void 0===e?t.len:t.pos+e,n=new $root.game.BattleCancelReadyPKNoti;t.pos<i;){var r=t.uint32();switch(r>>>3){case 1:n.instanceId=t.string();break;case 2:n.pluginId=t.string();break;case 3:n.roomId=t.string();break;case 4:n.senderId=t.string();break;default:t.skipType(7&r)}}if(!n.hasOwnProperty("instanceId"))throw $util.ProtocolError("missing required 'instanceId'",{instance:n});if(!n.hasOwnProperty("pluginId"))throw $util.ProtocolError("missing required 'pluginId'",{instance:n});if(!n.hasOwnProperty("roomId"))throw $util.ProtocolError("missing required 'roomId'",{instance:n});if(!n.hasOwnProperty("senderId"))throw $util.ProtocolError("missing required 'senderId'",{instance:n});return n},e.decodeDelimited=function(t){if(!(t instanceof $Reader))t=new $Reader(t);return this.decode(t,t.uint32())},e.verify=function(t){if("object"!==_typeof(t)||null===t)return"object expected";if(!$util.isString(t.instanceId))return"instanceId: string expected";if(!$util.isString(t.pluginId))return"pluginId: string expected";if(!$util.isString(t.roomId))return"roomId: string expected";if(!$util.isString(t.senderId))return"senderId: string expected";else return null},e.fromObject=function(t){if(t instanceof $root.game.BattleCancelReadyPKNoti)return t;var e=new $root.game.BattleCancelReadyPKNoti;if(null!=t.instanceId)e.instanceId=String(t.instanceId);if(null!=t.pluginId)e.pluginId=String(t.pluginId);if(null!=t.roomId)e.roomId=String(t.roomId);if(null!=t.senderId)e.senderId=String(t.senderId);return e},e.toObject=function(t,e){if(!e)e={};var i={};if(e.defaults)i.instanceId="",i.pluginId="",i.roomId="",i.senderId="";if(null!=t.instanceId&&t.hasOwnProperty("instanceId"))i.instanceId=t.instanceId;if(null!=t.pluginId&&t.hasOwnProperty("pluginId"))i.pluginId=t.pluginId;if(null!=t.roomId&&t.hasOwnProperty("roomId"))i.roomId=t.roomId;if(null!=t.senderId&&t.hasOwnProperty("senderId"))i.senderId=t.senderId;return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),Ema.MsgType=(mJa={},(nJa=Object.create(mJa))[mJa[1]="UNKNOWN_MSG"]=1,nJa[mJa[2]="COMMON_FAIL_RESP"]=2,nJa[mJa[3]="HEART_REQ"]=3,nJa[mJa[4]="HEART_RESP"]=4,nJa[mJa[11001]="PK1V1_START_MATCH_REQ"]=11001,nJa[mJa[11002]="PK1V1_START_MATCH_RESP"]=11002,nJa[mJa[11003]="PK1V1_FINISH_MATCH_NOTI"]=11003,nJa[mJa[11004]="PK1V1_READY_PK_REQ"]=11004,nJa[mJa[11005]="PK1V1_READY_PK_RESP"]=11005,nJa[mJa[11006]="PK1V1_START_PK_NOTI"]=11006,nJa[mJa[11015]="PK1V1_POST_ACTION_REQ"]=11015,nJa[mJa[11016]="PK1V1_POST_ACTION_RESP"]=11016,nJa[mJa[11017]="PK1V1_POST_ACTION_NOTI"]=11017,nJa[mJa[11007]="PK1V1_STOP_ROUND_REQ"]=11007,nJa[mJa[11008]="PK1V1_STOP_ROUND_RESP"]=11008,nJa[mJa[11009]="PK1V1_START_ROUND_NOTI"]=11009,nJa[mJa[11010]="PK1V1_STOP_PK_REQ"]=11010,nJa[mJa[11011]="PK1V1_STOP_PK_RESP"]=11011,nJa[mJa[11018]="PK1V1_STOP_PK_NOTI"]=11018,nJa[mJa[11012]="PK1V1_STOP_MATCH_REQ"]=11012,nJa[mJa[11013]="PK1V1_STOP_MATCH_RESP"]=11013,nJa[mJa[11014]="PK1V1_OFFLINE_NOTI"]=11014,nJa[mJa[11019]="PK1V1_READY_TIMEOUT_REQ"]=11019,nJa[mJa[11020]="PK1V1_READY_TIMEOUT_RESP"]=11020,nJa[mJa[11021]="PK1V1_READY_TIMEOUT_NOTI"]=11021,nJa[mJa[11022]="PK1V1_CANCEL_MATCH_REQ"]=11022,nJa[mJa[11023]="PK1V1_CANCEL_MATCH_RESP"]=11023,nJa[mJa[11024]="PK1V1_CANCEL_MATCH_NOTI"]=11024,nJa[mJa[11025]="PK1V1_ROUND_TIMEOUT_NOTI"]=11025,nJa[mJa[11026]="PK1V1_CANCEL_READY_PK_REQ"]=11026,nJa[mJa[11027]="PK1V1_CANCEL_READY_PK_RESP"]=11027,nJa[mJa[11028]="PK1V1_CREATE_ROOM_REQ"]=11028,nJa[mJa[11029]="PK1V1_CREATE_ROOM_RESP"]=11029,nJa[mJa[11032]="PK1V1_JOIN_ROOM_REQ"]=11032,nJa[mJa[11033]="PK1V1_JOIN_ROOM_RESP"]=11033,nJa[mJa[11034]="PK1V1_QUIT_ROOM_REQ"]=11034,nJa[mJa[11035]="PK1V1_QUIT_ROOM_RESP"]=11035,nJa[mJa[11036]="PK1V1_ROOM_NUMBER_NOTI"]=11036,nJa[mJa[11037]="PK1V1_CANCEL_READY_PK_NOTI"]=11037,nJa[mJa[11101]="BATTLE_START_MATCH_REQ"]=11101,nJa[mJa[11102]="BATTLE_START_MATCH_RESP"]=11102,nJa[mJa[11103]="BATTLE_FINISH_MATCH_NOTI"]=11103,nJa[mJa[11104]="BATTLE_READY_PK_REQ"]=11104,nJa[mJa[11105]="BATTLE_READY_PK_RESP"]=11105,nJa[mJa[11126]="BATTLE_READY_PK_NOTI"]=11126,nJa[mJa[11106]="BATTLE_START_PK_NOTI"]=11106,nJa[mJa[11115]="BATTLE_POST_ACTION_REQ"]=11115,nJa[mJa[11116]="BATTLE_POST_ACTION_RESP"]=11116,nJa[mJa[11117]="BATTLE_POST_ACTION_NOTI"]=11117,nJa[mJa[11107]="BATTLE_STOP_ROUND_REQ"]=11107,nJa[mJa[11108]="BATTLE_STOP_ROUND_RESP"]=11108,nJa[mJa[11109]="BATTLE_START_ROUND_NOTI"]=11109,nJa[mJa[11110]="BATTLE_STOP_PK_REQ"]=11110,nJa[mJa[11111]="BATTLE_STOP_PK_RESP"]=11111,nJa[mJa[11118]="BATTLE_STOP_PK_NOTI"]=11118,nJa[mJa[11112]="BATTLE_STOP_MATCH_REQ"]=11112,nJa[mJa[11113]="BATTLE_STOP_MATCH_RESP"]=11113,nJa[mJa[11114]="BATTLE_OFFLINE_NOTI"]=11114,nJa[mJa[11119]="BATTLE_READY_TIMEOUT_REQ"]=11119,nJa[mJa[11120]="BATTLE_READY_TIMEOUT_RESP"]=11120,nJa[mJa[11121]="BATTLE_READY_TIMEOUT_NOTI"]=11121,nJa[mJa[11122]="BATTLE_CANCEL_MATCH_REQ"]=11122,nJa[mJa[11123]="BATTLE_CANCEL_MATCH_RESP"]=11123,nJa[mJa[11124]="BATTLE_CANCEL_MATCH_NOTI"]=11124,nJa[mJa[11125]="BATTLE_ROUND_TIMEOUT_NOTI"]=11125,nJa[mJa[11127]="BATTLE_FINISH_PK_REQ"]=11127,nJa[mJa[11128]="BATTLE_FINISH_PK_RESP"]=11128,nJa[mJa[11129]="BATTLE_FINISH_PK_NOTI"]=11129,nJa[mJa[11130]="BATTLE_CREATE_ROOM_REQ"]=11130,nJa[mJa[11131]="BATTLE_CREATE_ROOM_RESP"]=11131,nJa[mJa[11134]="BATTLE_JOIN_ROOM_REQ"]=11134,nJa[mJa[11135]="BATTLE_JOIN_ROOM_RESP"]=11135,nJa[mJa[11136]="BATTLE_QUIT_ROOM_REQ"]=11136,nJa[mJa[11137]="BATTLE_QUIT_ROOM_RESP"]=11137,nJa[mJa[11138]="BATTLE_ROOM_NUMBER_NOTI"]=11138,nJa[mJa[11139]="BATTLE_CANCEL_READY_PK_REQ"]=11139,nJa[mJa[11140]="BATTLE_CANCEL_READY_PK_RESP"]=11140,nJa[mJa[11141]="BATTLE_CANCEL_READY_PK_NOTI"]=11141,nJa),Ema.UnknownMsg=function(){function e(t){if(t)for(var e=Object.keys(t),i=0;i<e.length;++i)if(null!=t[e[i]])this[e[i]]=t[e[i]]}return e.prototype.code=0,e.prototype.info="",e.create=function(t){return new e(t)},e.encode=function(t,e){if(!e)e=$Writer.create();return e.uint32(8).int32(t.code),e.uint32(18).string(t.info),e},e.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},e.decode=function(t,e){if(!(t instanceof $Reader))t=$Reader.create(t);for(var i=void 0===e?t.len:t.pos+e,n=new $root.game.UnknownMsg;t.pos<i;){var r=t.uint32();switch(r>>>3){case 1:n.code=t.int32();break;case 2:n.info=t.string();break;default:t.skipType(7&r)}}if(!n.hasOwnProperty("code"))throw $util.ProtocolError("missing required 'code'",{instance:n});if(!n.hasOwnProperty("info"))throw $util.ProtocolError("missing required 'info'",{instance:n});return n},e.decodeDelimited=function(t){if(!(t instanceof $Reader))t=new $Reader(t);return this.decode(t,t.uint32())},e.verify=function(t){if("object"!==_typeof(t)||null===t)return"object expected";if(!$util.isInteger(t.code))return"code: integer expected";if(!$util.isString(t.info))return"info: string expected";else return null},e.fromObject=function(t){if(t instanceof $root.game.UnknownMsg)return t;var e=new $root.game.UnknownMsg;if(null!=t.code)e.code=0|t.code;if(null!=t.info)e.info=String(t.info);return e},e.toObject=function(t,e){if(!e)e={};var i={};if(e.defaults)i.code=0,i.info="";if(null!=t.code&&t.hasOwnProperty("code"))i.code=t.code;if(null!=t.info&&t.hasOwnProperty("info"))i.info=t.info;return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),Ema.CommonFailResp=function(){function e(t){if(t)for(var e=Object.keys(t),i=0;i<e.length;++i)if(null!=t[e[i]])this[e[i]]=t[e[i]]}return e.prototype.code=0,e.prototype.info="",e.prototype.type=0,e.create=function(t){return new e(t)},e.encode=function(t,e){if(!e)e=$Writer.create();if(e.uint32(8).int32(t.code),e.uint32(18).string(t.info),null!=t.type&&Object.hasOwnProperty.call(t,"type"))e.uint32(24).int32(t.type);return e},e.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},e.decode=function(t,e){if(!(t instanceof $Reader))t=$Reader.create(t);for(var i=void 0===e?t.len:t.pos+e,n=new $root.game.CommonFailResp;t.pos<i;){var r=t.uint32();switch(r>>>3){case 1:n.code=t.int32();break;case 2:n.info=t.string();break;case 3:n.type=t.int32();break;default:t.skipType(7&r)}}if(!n.hasOwnProperty("code"))throw $util.ProtocolError("missing required 'code'",{instance:n});if(!n.hasOwnProperty("info"))throw $util.ProtocolError("missing required 'info'",{instance:n});return n},e.decodeDelimited=function(t){if(!(t instanceof $Reader))t=new $Reader(t);return this.decode(t,t.uint32())},e.verify=function(t){if("object"!==_typeof(t)||null===t)return"object expected";if(!$util.isInteger(t.code))return"code: integer expected";if(!$util.isString(t.info))return"info: string expected";if(null!=t.type&&t.hasOwnProperty("type"))if(!$util.isInteger(t.type))return"type: integer expected";return null},e.fromObject=function(t){if(t instanceof $root.game.CommonFailResp)return t;var e=new $root.game.CommonFailResp;if(null!=t.code)e.code=0|t.code;if(null!=t.info)e.info=String(t.info);if(null!=t.type)e.type=0|t.type;return e},e.toObject=function(t,e){if(!e)e={};var i={};if(e.defaults)i.code=0,i.info="",i.type=0;if(null!=t.code&&t.hasOwnProperty("code"))i.code=t.code;if(null!=t.info&&t.hasOwnProperty("info"))i.info=t.info;if(null!=t.type&&t.hasOwnProperty("type"))i.type=t.type;return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),Ema.HeartReq=function(){function e(t){if(t)for(var e=Object.keys(t),i=0;i<e.length;++i)if(null!=t[e[i]])this[e[i]]=t[e[i]]}return e.create=function(t){return new e(t)},e.encode=function(t,e){if(!e)e=$Writer.create();return e},e.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},e.decode=function(t,e){if(!(t instanceof $Reader))t=$Reader.create(t);for(var i=void 0===e?t.len:t.pos+e,n=new $root.game.HeartReq;t.pos<i;){var r=t.uint32();t.skipType(7&r)}return n},e.decodeDelimited=function(t){if(!(t instanceof $Reader))t=new $Reader(t);return this.decode(t,t.uint32())},e.verify=function(t){if("object"!==_typeof(t)||null===t)return"object expected";else return null},e.fromObject=function(t){if(t instanceof $root.game.HeartReq)return t;else return new $root.game.HeartReq},e.toObject=function(){return{}},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),Ema.HeartResp=function(){function e(t){if(t)for(var e=Object.keys(t),i=0;i<e.length;++i)if(null!=t[e[i]])this[e[i]]=t[e[i]]}return e.prototype.code=0,e.prototype.info="",e.prototype.timestamp=$util.Long?$util.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(t,e){if(!e)e=$Writer.create();if(e.uint32(8).int32(t.code),e.uint32(18).string(t.info),null!=t.timestamp&&Object.hasOwnProperty.call(t,"timestamp"))e.uint32(24).int64(t.timestamp);return e},e.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},e.decode=function(t,e){if(!(t instanceof $Reader))t=$Reader.create(t);for(var i=void 0===e?t.len:t.pos+e,n=new $root.game.HeartResp;t.pos<i;){var r=t.uint32();switch(r>>>3){case 1:n.code=t.int32();break;case 2:n.info=t.string();break;case 3:n.timestamp=t.int64();break;default:t.skipType(7&r)}}if(!n.hasOwnProperty("code"))throw $util.ProtocolError("missing required 'code'",{instance:n});if(!n.hasOwnProperty("info"))throw $util.ProtocolError("missing required 'info'",{instance:n});return n},e.decodeDelimited=function(t){if(!(t instanceof $Reader))t=new $Reader(t);return this.decode(t,t.uint32())},e.verify=function(t){if("object"!==_typeof(t)||null===t)return"object expected";if(!$util.isInteger(t.code))return"code: integer expected";if(!$util.isString(t.info))return"info: string expected";if(null!=t.timestamp&&t.hasOwnProperty("timestamp"))if(!($util.isInteger(t.timestamp)||t.timestamp&&$util.isInteger(t.timestamp.low)&&$util.isInteger(t.timestamp.high)))return"timestamp: integer|Long expected";return null},e.fromObject=function(t){if(t instanceof $root.game.HeartResp)return t;var e=new $root.game.HeartResp;if(null!=t.code)e.code=0|t.code;if(null!=t.info)e.info=String(t.info);if(null!=t.timestamp)if($util.Long)(e.timestamp=$util.Long.fromValue(t.timestamp)).unsigned=!1;else if("string"==typeof t.timestamp)e.timestamp=parseInt(t.timestamp,10);else if("number"==typeof t.timestamp)e.timestamp=t.timestamp;else if("object"===_typeof(t.timestamp))e.timestamp=new $util.LongBits(t.timestamp.low>>>0,t.timestamp.high>>>0).toNumber();return e},e.toObject=function(t,e){if(!e)e={};var i={};if(e.defaults)if(i.code=0,i.info="",$util.Long){var n=new $util.Long(0,0,!1);i.timestamp=e.longs===String?n.toString():e.longs===Number?n.toNumber():n}else i.timestamp=e.longs===String?"0":0;if(null!=t.code&&t.hasOwnProperty("code"))i.code=t.code;if(null!=t.info&&t.hasOwnProperty("info"))i.info=t.info;if(null!=t.timestamp&&t.hasOwnProperty("timestamp"))if("number"==typeof t.timestamp)i.timestamp=e.longs===String?String(t.timestamp):t.timestamp;else i.timestamp=e.longs===String?$util.Long.prototype.toString.call(t.timestamp):e.longs===Number?new $util.LongBits(t.timestamp.low>>>0,t.timestamp.high>>>0).toNumber():t.timestamp;return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),Ema.PK1v1Player=function(){function e(t){if(t)for(var e=Object.keys(t),i=0;i<e.length;++i)if(null!=t[e[i]])this[e[i]]=t[e[i]]}return e.prototype.cid="",e.prototype.glov="",e.prototype.robotic=!1,e.prototype.attackable=!1,e.create=function(t){return new e(t)},e.encode=function(t,e){if(!e)e=$Writer.create();return e.uint32(10).string(t.cid),e.uint32(18).string(t.glov),e.uint32(24).bool(t.robotic),e.uint32(32).bool(t.attackable),e},e.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},e.decode=function(t,e){if(!(t instanceof $Reader))t=$Reader.create(t);for(var i=void 0===e?t.len:t.pos+e,n=new $root.game.PK1v1Player;t.pos<i;){var r=t.uint32();switch(r>>>3){case 1:n.cid=t.string();break;case 2:n.glov=t.string();break;case 3:n.robotic=t.bool();break;case 4:n.attackable=t.bool();break;default:t.skipType(7&r)}}if(!n.hasOwnProperty("cid"))throw $util.ProtocolError("missing required 'cid'",{instance:n});if(!n.hasOwnProperty("glov"))throw $util.ProtocolError("missing required 'glov'",{instance:n});if(!n.hasOwnProperty("robotic"))throw $util.ProtocolError("missing required 'robotic'",{instance:n});if(!n.hasOwnProperty("attackable"))throw $util.ProtocolError("missing required 'attackable'",{instance:n});return n},e.decodeDelimited=function(t){if(!(t instanceof $Reader))t=new $Reader(t);return this.decode(t,t.uint32())},e.verify=function(t){if("object"!==_typeof(t)||null===t)return"object expected";if(!$util.isString(t.cid))return"cid: string expected";if(!$util.isString(t.glov))return"glov: string expected";if("boolean"!=typeof t.robotic)return"robotic: boolean expected";if("boolean"!=typeof t.attackable)return"attackable: boolean expected";else return null},e.fromObject=function(t){if(t instanceof $root.game.PK1v1Player)return t;var e=new $root.game.PK1v1Player;if(null!=t.cid)e.cid=String(t.cid);if(null!=t.glov)e.glov=String(t.glov);if(null!=t.robotic)e.robotic=Boolean(t.robotic);if(null!=t.attackable)e.attackable=Boolean(t.attackable);return e},e.toObject=function(t,e){if(!e)e={};var i={};if(e.defaults)i.cid="",i.glov="",i.robotic=!1,i.attackable=!1;if(null!=t.cid&&t.hasOwnProperty("cid"))i.cid=t.cid;if(null!=t.glov&&t.hasOwnProperty("glov"))i.glov=t.glov;if(null!=t.robotic&&t.hasOwnProperty("robotic"))i.robotic=t.robotic;if(null!=t.attackable&&t.hasOwnProperty("attackable"))i.attackable=t.attackable;return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),Ema.PK1v1StartMatchReq=function(){function e(t){if(t)for(var e=Object.keys(t),i=0;i<e.length;++i)if(null!=t[e[i]])this[e[i]]=t[e[i]]}return e.prototype.instanceId="",e.prototype.pluginId="",e.create=function(t){return new e(t)},e.encode=function(t,e){if(!e)e=$Writer.create();return e.uint32(10).string(t.instanceId),e.uint32(18).string(t.pluginId),e},e.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},e.decode=function(t,e){if(!(t instanceof $Reader))t=$Reader.create(t);for(var i=void 0===e?t.len:t.pos+e,n=new $root.game.PK1v1StartMatchReq;t.pos<i;){var r=t.uint32();switch(r>>>3){case 1:n.instanceId=t.string();break;case 2:n.pluginId=t.string();break;default:t.skipType(7&r)}}if(!n.hasOwnProperty("instanceId"))throw $util.ProtocolError("missing required 'instanceId'",{instance:n});if(!n.hasOwnProperty("pluginId"))throw $util.ProtocolError("missing required 'pluginId'",{instance:n});return n},e.decodeDelimited=function(t){if(!(t instanceof $Reader))t=new $Reader(t);return this.decode(t,t.uint32())},e.verify=function(t){if("object"!==_typeof(t)||null===t)return"object expected";if(!$util.isString(t.instanceId))return"instanceId: string expected";if(!$util.isString(t.pluginId))return"pluginId: string expected";else return null},e.fromObject=function(t){if(t instanceof $root.game.PK1v1StartMatchReq)return t;var e=new $root.game.PK1v1StartMatchReq;if(null!=t.instanceId)e.instanceId=String(t.instanceId);if(null!=t.pluginId)e.pluginId=String(t.pluginId);return e},e.toObject=function(t,e){if(!e)e={};var i={};if(e.defaults)i.instanceId="",i.pluginId="";if(null!=t.instanceId&&t.hasOwnProperty("instanceId"))i.instanceId=t.instanceId;if(null!=t.pluginId&&t.hasOwnProperty("pluginId"))i.pluginId=t.pluginId;return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),Ema.PK1v1StartMatchResp=function(){function e(t){if(t)for(var e=Object.keys(t),i=0;i<e.length;++i)if(null!=t[e[i]])this[e[i]]=t[e[i]]}return e.prototype.code=0,e.prototype.info="",e.prototype.instanceId="",e.prototype.pluginId="",e.create=function(t){return new e(t)},e.encode=function(t,e){if(!e)e=$Writer.create();return e.uint32(8).int32(t.code),e.uint32(18).string(t.info),e.uint32(26).string(t.instanceId),e.uint32(34).string(t.pluginId),e},e.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},e.decode=function(t,e){if(!(t instanceof $Reader))t=$Reader.create(t);for(var i=void 0===e?t.len:t.pos+e,n=new $root.game.PK1v1StartMatchResp;t.pos<i;){var r=t.uint32();switch(r>>>3){case 1:n.code=t.int32();break;case 2:n.info=t.string();break;case 3:n.instanceId=t.string();break;case 4:n.pluginId=t.string();break;default:t.skipType(7&r)}}if(!n.hasOwnProperty("code"))throw $util.ProtocolError("missing required 'code'",{instance:n});if(!n.hasOwnProperty("info"))throw $util.ProtocolError("missing required 'info'",{instance:n});if(!n.hasOwnProperty("instanceId"))throw $util.ProtocolError("missing required 'instanceId'",{instance:n});if(!n.hasOwnProperty("pluginId"))throw $util.ProtocolError("missing required 'pluginId'",{instance:n});return n},e.decodeDelimited=function(t){if(!(t instanceof $Reader))t=new $Reader(t);return this.decode(t,t.uint32())},e.verify=function(t){if("object"!==_typeof(t)||null===t)return"object expected";if(!$util.isInteger(t.code))return"code: integer expected";if(!$util.isString(t.info))return"info: string expected";if(!$util.isString(t.instanceId))return"instanceId: string expected";if(!$util.isString(t.pluginId))return"pluginId: string expected";else return null},e.fromObject=function(t){if(t instanceof $root.game.PK1v1StartMatchResp)return t;var e=new $root.game.PK1v1StartMatchResp;if(null!=t.code)e.code=0|t.code;if(null!=t.info)e.info=String(t.info);if(null!=t.instanceId)e.instanceId=String(t.instanceId);if(null!=t.pluginId)e.pluginId=String(t.pluginId);return e},e.toObject=function(t,e){if(!e)e={};var i={};if(e.defaults)i.code=0,i.info="",i.instanceId="",i.pluginId="";if(null!=t.code&&t.hasOwnProperty("code"))i.code=t.code;if(null!=t.info&&t.hasOwnProperty("info"))i.info=t.info;if(null!=t.instanceId&&t.hasOwnProperty("instanceId"))i.instanceId=t.instanceId;if(null!=t.pluginId&&t.hasOwnProperty("pluginId"))i.pluginId=t.pluginId;return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),Ema.PK1v1FinishMatchNoti=function(){function e(t){if(this.players=[],t)for(var e=Object.keys(t),i=0;i<e.length;++i)if(null!=t[e[i]])this[e[i]]=t[e[i]]}return e.prototype.code=0,e.prototype.info="",e.prototype.instanceId="",e.prototype.pluginId="",e.prototype.roomId="",e.prototype.players=$util.emptyArray,e.create=function(t){return new e(t)},e.encode=function(t,e){if(!e)e=$Writer.create();if(e.uint32(8).int32(t.code),e.uint32(18).string(t.info),e.uint32(26).string(t.instanceId),e.uint32(34).string(t.pluginId),e.uint32(42).string(t.roomId),null!=t.players&&t.players.length)for(var i=0;i<t.players.length;++i)$root.game.PK1v1Player.encode(t.players[i],e.uint32(50).fork()).ldelim();return e},e.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},e.decode=function(t,e){if(!(t instanceof $Reader))t=$Reader.create(t);for(var i=void 0===e?t.len:t.pos+e,n=new $root.game.PK1v1FinishMatchNoti;t.pos<i;){var r=t.uint32();switch(r>>>3){case 1:n.code=t.int32();break;case 2:n.info=t.string();break;case 3:n.instanceId=t.string();break;case 4:n.pluginId=t.string();break;case 5:n.roomId=t.string();break;case 6:if(!n.players||!n.players.length)n.players=[];n.players.push($root.game.PK1v1Player.decode(t,t.uint32()));break;default:t.skipType(7&r)}}if(!n.hasOwnProperty("code"))throw $util.ProtocolError("missing required 'code'",{instance:n});if(!n.hasOwnProperty("info"))throw $util.ProtocolError("missing required 'info'",{instance:n});if(!n.hasOwnProperty("instanceId"))throw $util.ProtocolError("missing required 'instanceId'",{instance:n});if(!n.hasOwnProperty("pluginId"))throw $util.ProtocolError("missing required 'pluginId'",{instance:n});if(!n.hasOwnProperty("roomId"))throw $util.ProtocolError("missing required 'roomId'",{instance:n});return n},e.decodeDelimited=function(t){if(!(t instanceof $Reader))t=new $Reader(t);return this.decode(t,t.uint32())},e.verify=function(t){if("object"!==_typeof(t)||null===t)return"object expected";if(!$util.isInteger(t.code))return"code: integer expected";if(!$util.isString(t.info))return"info: string expected";if(!$util.isString(t.instanceId))return"instanceId: string expected";if(!$util.isString(t.pluginId))return"pluginId: string expected";if(!$util.isString(t.roomId))return"roomId: string expected";if(null!=t.players&&t.hasOwnProperty("players")){if(!Array.isArray(t.players))return"players: array expected";for(var e=0;e<t.players.length;++e){var i=$root.game.PK1v1Player.verify(t.players[e]);if(i)return"players."+i}}return null},e.fromObject=function(t){if(t instanceof $root.game.PK1v1FinishMatchNoti)return t;var e=new $root.game.PK1v1FinishMatchNoti;if(null!=t.code)e.code=0|t.code;if(null!=t.info)e.info=String(t.info);if(null!=t.instanceId)e.instanceId=String(t.instanceId);if(null!=t.pluginId)e.pluginId=String(t.pluginId);if(null!=t.roomId)e.roomId=String(t.roomId);if(t.players){if(!Array.isArray(t.players))throw TypeError(".game.PK1v1FinishMatchNoti.players: array expected");e.players=[];for(var i=0;i<t.players.length;++i){if("object"!==_typeof(t.players[i]))throw TypeError(".game.PK1v1FinishMatchNoti.players: object expected");e.players[i]=$root.game.PK1v1Player.fromObject(t.players[i])}}return e},e.toObject=function(t,e){if(!e)e={};var i={};if(e.arrays||e.defaults)i.players=[];if(e.defaults)i.code=0,i.info="",i.instanceId="",i.pluginId="",i.roomId="";if(null!=t.code&&t.hasOwnProperty("code"))i.code=t.code;if(null!=t.info&&t.hasOwnProperty("info"))i.info=t.info;if(null!=t.instanceId&&t.hasOwnProperty("instanceId"))i.instanceId=t.instanceId;if(null!=t.pluginId&&t.hasOwnProperty("pluginId"))i.pluginId=t.pluginId;if(null!=t.roomId&&t.hasOwnProperty("roomId"))i.roomId=t.roomId;if(t.players&&t.players.length){i.players=[];for(var n=0;n<t.players.length;++n)i.players[n]=$root.game.PK1v1Player.toObject(t.players[n],e)}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),Ema.PK1v1ReadyPKReq=function(){function e(t){if(t)for(var e=Object.keys(t),i=0;i<e.length;++i)if(null!=t[e[i]])this[e[i]]=t[e[i]]}return e.prototype.instanceId="",e.prototype.pluginId="",e.prototype.roomId="",e.create=function(t){return new e(t)},e.encode=function(t,e){if(!e)e=$Writer.create();return e.uint32(10).string(t.instanceId),e.uint32(18).string(t.pluginId),e.uint32(26).string(t.roomId),e},e.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},e.decode=function(t,e){if(!(t instanceof $Reader))t=$Reader.create(t);for(var i=void 0===e?t.len:t.pos+e,n=new $root.game.PK1v1ReadyPKReq;t.pos<i;){var r=t.uint32();switch(r>>>3){case 1:n.instanceId=t.string();break;case 2:n.pluginId=t.string();break;case 3:n.roomId=t.string();break;default:t.skipType(7&r)}}if(!n.hasOwnProperty("instanceId"))throw $util.ProtocolError("missing required 'instanceId'",{instance:n});if(!n.hasOwnProperty("pluginId"))throw $util.ProtocolError("missing required 'pluginId'",{instance:n});if(!n.hasOwnProperty("roomId"))throw $util.ProtocolError("missing required 'roomId'",{instance:n});return n},e.decodeDelimited=function(t){if(!(t instanceof $Reader))t=new $Reader(t);return this.decode(t,t.uint32())},e.verify=function(t){if("object"!==_typeof(t)||null===t)return"object expected";if(!$util.isString(t.instanceId))return"instanceId: string expected";if(!$util.isString(t.pluginId))return"pluginId: string expected";if(!$util.isString(t.roomId))return"roomId: string expected";else return null},e.fromObject=function(t){if(t instanceof $root.game.PK1v1ReadyPKReq)return t;var e=new $root.game.PK1v1ReadyPKReq;if(null!=t.instanceId)e.instanceId=String(t.instanceId);if(null!=t.pluginId)e.pluginId=String(t.pluginId);if(null!=t.roomId)e.roomId=String(t.roomId);return e},e.toObject=function(t,e){if(!e)e={};var i={};if(e.defaults)i.instanceId="",i.pluginId="",i.roomId="";if(null!=t.instanceId&&t.hasOwnProperty("instanceId"))i.instanceId=t.instanceId;if(null!=t.pluginId&&t.hasOwnProperty("pluginId"))i.pluginId=t.pluginId;if(null!=t.roomId&&t.hasOwnProperty("roomId"))i.roomId=t.roomId;return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),Ema.PK1v1ReadyPKResp=function(){function e(t){if(t)for(var e=Object.keys(t),i=0;i<e.length;++i)if(null!=t[e[i]])this[e[i]]=t[e[i]]}return e.prototype.code=0,e.prototype.info="",e.prototype.instanceId="",e.prototype.pluginId="",e.prototype.roomId="",e.create=function(t){return new e(t)},e.encode=function(t,e){if(!e)e=$Writer.create();return e.uint32(8).int32(t.code),e.uint32(18).string(t.info),e.uint32(26).string(t.instanceId),e.uint32(34).string(t.pluginId),e.uint32(42).string(t.roomId),e},e.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},e.decode=function(t,e){if(!(t instanceof $Reader))t=$Reader.create(t);for(var i=void 0===e?t.len:t.pos+e,n=new $root.game.PK1v1ReadyPKResp;t.pos<i;){var r=t.uint32();switch(r>>>3){case 1:n.code=t.int32();break;case 2:n.info=t.string();break;case 3:n.instanceId=t.string();break;case 4:n.pluginId=t.string();break;case 5:n.roomId=t.string();break;default:t.skipType(7&r)}}if(!n.hasOwnProperty("code"))throw $util.ProtocolError("missing required 'code'",{instance:n});if(!n.hasOwnProperty("info"))throw $util.ProtocolError("missing required 'info'",{instance:n});if(!n.hasOwnProperty("instanceId"))throw $util.ProtocolError("missing required 'instanceId'",{instance:n});if(!n.hasOwnProperty("pluginId"))throw $util.ProtocolError("missing required 'pluginId'",{instance:n});if(!n.hasOwnProperty("roomId"))throw $util.ProtocolError("missing required 'roomId'",{instance:n});return n},e.decodeDelimited=function(t){if(!(t instanceof $Reader))t=new $Reader(t);return this.decode(t,t.uint32())},e.verify=function(t){if("object"!==_typeof(t)||null===t)return"object expected";if(!$util.isInteger(t.code))return"code: integer expected";if(!$util.isString(t.info))return"info: string expected";if(!$util.isString(t.instanceId))return"instanceId: string expected";if(!$util.isString(t.pluginId))return"pluginId: string expected";if(!$util.isString(t.roomId))return"roomId: string expected";else return null},e.fromObject=function(t){if(t instanceof $root.game.PK1v1ReadyPKResp)return t;var e=new $root.game.PK1v1ReadyPKResp;if(null!=t.code)e.code=0|t.code;if(null!=t.info)e.info=String(t.info);if(null!=t.instanceId)e.instanceId=String(t.instanceId);if(null!=t.pluginId)e.pluginId=String(t.pluginId);if(null!=t.roomId)e.roomId=String(t.roomId);return e},e.toObject=function(t,e){if(!e)e={};var i={};if(e.defaults)i.code=0,i.info="",i.instanceId="",i.pluginId="",i.roomId="";if(null!=t.code&&t.hasOwnProperty("code"))i.code=t.code;if(null!=t.info&&t.hasOwnProperty("info"))i.info=t.info;if(null!=t.instanceId&&t.hasOwnProperty("instanceId"))i.instanceId=t.instanceId;if(null!=t.pluginId&&t.hasOwnProperty("pluginId"))i.pluginId=t.pluginId;if(null!=t.roomId&&t.hasOwnProperty("roomId"))i.roomId=t.roomId;return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),Ema.PK1v1StartPKNoti=function(){function e(t){if(this.players=[],t)for(var e=Object.keys(t),i=0;i<e.length;++i)if(null!=t[e[i]])this[e[i]]=t[e[i]]}return e.prototype.code=0,e.prototype.info="",e.prototype.instanceId="",e.prototype.pluginId="",e.prototype.roomId="",e.prototype.round=0,e.prototype.players=$util.emptyArray,e.prototype.roundStartTime=$util.Long?$util.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(t,e){if(!e)e=$Writer.create();if(e.uint32(8).int32(t.code),e.uint32(18).string(t.info),e.uint32(26).string(t.instanceId),e.uint32(34).string(t.pluginId),e.uint32(42).string(t.roomId),e.uint32(48).int32(t.round),null!=t.players&&t.players.length)for(var i=0;i<t.players.length;++i)$root.game.PK1v1Player.encode(t.players[i],e.uint32(58).fork()).ldelim();return e.uint32(64).int64(t.roundStartTime),e},e.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},e.decode=function(t,e){if(!(t instanceof $Reader))t=$Reader.create(t);for(var i=void 0===e?t.len:t.pos+e,n=new $root.game.PK1v1StartPKNoti;t.pos<i;){var r=t.uint32();switch(r>>>3){case 1:n.code=t.int32();break;case 2:n.info=t.string();break;case 3:n.instanceId=t.string();break;case 4:n.pluginId=t.string();break;case 5:n.roomId=t.string();break;case 6:n.round=t.int32();break;case 7:if(!n.players||!n.players.length)n.players=[];n.players.push($root.game.PK1v1Player.decode(t,t.uint32()));break;case 8:n.roundStartTime=t.int64();break;default:t.skipType(7&r)}}if(!n.hasOwnProperty("code"))throw $util.ProtocolError("missing required 'code'",{instance:n});if(!n.hasOwnProperty("info"))throw $util.ProtocolError("missing required 'info'",{instance:n});if(!n.hasOwnProperty("instanceId"))throw $util.ProtocolError("missing required 'instanceId'",{instance:n});if(!n.hasOwnProperty("pluginId"))throw $util.ProtocolError("missing required 'pluginId'",{instance:n});if(!n.hasOwnProperty("roomId"))throw $util.ProtocolError("missing required 'roomId'",{instance:n});if(!n.hasOwnProperty("round"))throw $util.ProtocolError("missing required 'round'",{instance:n});if(!n.hasOwnProperty("roundStartTime"))throw $util.ProtocolError("missing required 'roundStartTime'",{instance:n});return n},e.decodeDelimited=function(t){if(!(t instanceof $Reader))t=new $Reader(t);return this.decode(t,t.uint32())},e.verify=function(t){if("object"!==_typeof(t)||null===t)return"object expected";if(!$util.isInteger(t.code))return"code: integer expected";if(!$util.isString(t.info))return"info: string expected";if(!$util.isString(t.instanceId))return"instanceId: string expected";if(!$util.isString(t.pluginId))return"pluginId: string expected";if(!$util.isString(t.roomId))return"roomId: string expected";if(!$util.isInteger(t.round))return"round: integer expected";if(null!=t.players&&t.hasOwnProperty("players")){if(!Array.isArray(t.players))return"players: array expected";for(var e=0;e<t.players.length;++e){var i=$root.game.PK1v1Player.verify(t.players[e]);if(i)return"players."+i}}if(!($util.isInteger(t.roundStartTime)||t.roundStartTime&&$util.isInteger(t.roundStartTime.low)&&$util.isInteger(t.roundStartTime.high)))return"roundStartTime: integer|Long expected";else return null},e.fromObject=function(t){if(t instanceof $root.game.PK1v1StartPKNoti)return t;var e=new $root.game.PK1v1StartPKNoti;if(null!=t.code)e.code=0|t.code;if(null!=t.info)e.info=String(t.info);if(null!=t.instanceId)e.instanceId=String(t.instanceId);if(null!=t.pluginId)e.pluginId=String(t.pluginId);if(null!=t.roomId)e.roomId=String(t.roomId);if(null!=t.round)e.round=0|t.round;if(t.players){if(!Array.isArray(t.players))throw TypeError(".game.PK1v1StartPKNoti.players: array expected");e.players=[];for(var i=0;i<t.players.length;++i){if("object"!==_typeof(t.players[i]))throw TypeError(".game.PK1v1StartPKNoti.players: object expected");e.players[i]=$root.game.PK1v1Player.fromObject(t.players[i])}}if(null!=t.roundStartTime)if($util.Long)(e.roundStartTime=$util.Long.fromValue(t.roundStartTime)).unsigned=!1;else if("string"==typeof t.roundStartTime)e.roundStartTime=parseInt(t.roundStartTime,10);else if("number"==typeof t.roundStartTime)e.roundStartTime=t.roundStartTime;else if("object"===_typeof(t.roundStartTime))e.roundStartTime=new $util.LongBits(t.roundStartTime.low>>>0,t.roundStartTime.high>>>0).toNumber();return e},e.toObject=function(t,e){if(!e)e={};var i={};if(e.arrays||e.defaults)i.players=[];if(e.defaults)if(i.code=0,i.info="",i.instanceId="",i.pluginId="",i.roomId="",i.round=0,$util.Long){var n=new $util.Long(0,0,!1);i.roundStartTime=e.longs===String?n.toString():e.longs===Number?n.toNumber():n}else i.roundStartTime=e.longs===String?"0":0;if(null!=t.code&&t.hasOwnProperty("code"))i.code=t.code;if(null!=t.info&&t.hasOwnProperty("info"))i.info=t.info;if(null!=t.instanceId&&t.hasOwnProperty("instanceId"))i.instanceId=t.instanceId;if(null!=t.pluginId&&t.hasOwnProperty("pluginId"))i.pluginId=t.pluginId;if(null!=t.roomId&&t.hasOwnProperty("roomId"))i.roomId=t.roomId;if(null!=t.round&&t.hasOwnProperty("round"))i.round=t.round;if(t.players&&t.players.length){i.players=[];for(var r=0;r<t.players.length;++r)i.players[r]=$root.game.PK1v1Player.toObject(t.players[r],e)}if(null!=t.roundStartTime&&t.hasOwnProperty("roundStartTime"))if("number"==typeof t.roundStartTime)i.roundStartTime=e.longs===String?String(t.roundStartTime):t.roundStartTime;else i.roundStartTime=e.longs===String?$util.Long.prototype.toString.call(t.roundStartTime):e.longs===Number?new $util.LongBits(t.roundStartTime.low>>>0,t.roundStartTime.high>>>0).toNumber():t.roundStartTime;return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),Ema.PK1v1PostActionReq=function(){function e(t){if(t)for(var e=Object.keys(t),i=0;i<e.length;++i)if(null!=t[e[i]])this[e[i]]=t[e[i]]}return e.prototype.instanceId="",e.prototype.pluginId="",e.prototype.roomId="",e.prototype.pkAction="",e.prototype.pkParams="",e.create=function(t){return new e(t)},e.encode=function(t,e){if(!e)e=$Writer.create();return e.uint32(10).string(t.instanceId),e.uint32(18).string(t.pluginId),e.uint32(26).string(t.roomId),e.uint32(34).string(t.pkAction),e.uint32(42).string(t.pkParams),e},e.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},e.decode=function(t,e){if(!(t instanceof $Reader))t=$Reader.create(t);for(var i=void 0===e?t.len:t.pos+e,n=new $root.game.PK1v1PostActionReq;t.pos<i;){var r=t.uint32();switch(r>>>3){case 1:n.instanceId=t.string();break;case 2:n.pluginId=t.string();break;case 3:n.roomId=t.string();break;case 4:n.pkAction=t.string();break;case 5:n.pkParams=t.string();break;default:t.skipType(7&r)}}if(!n.hasOwnProperty("instanceId"))throw $util.ProtocolError("missing required 'instanceId'",{instance:n});if(!n.hasOwnProperty("pluginId"))throw $util.ProtocolError("missing required 'pluginId'",{instance:n});if(!n.hasOwnProperty("roomId"))throw $util.ProtocolError("missing required 'roomId'",{instance:n});if(!n.hasOwnProperty("pkAction"))throw $util.ProtocolError("missing required 'pkAction'",{instance:n});if(!n.hasOwnProperty("pkParams"))throw $util.ProtocolError("missing required 'pkParams'",{instance:n});return n},e.decodeDelimited=function(t){if(!(t instanceof $Reader))t=new $Reader(t);return this.decode(t,t.uint32())},e.verify=function(t){if("object"!==_typeof(t)||null===t)return"object expected";if(!$util.isString(t.instanceId))return"instanceId: string expected";if(!$util.isString(t.pluginId))return"pluginId: string expected";if(!$util.isString(t.roomId))return"roomId: string expected";if(!$util.isString(t.pkAction))return"pkAction: string expected";if(!$util.isString(t.pkParams))return"pkParams: string expected";else return null},e.fromObject=function(t){if(t instanceof $root.game.PK1v1PostActionReq)return t;var e=new $root.game.PK1v1PostActionReq;if(null!=t.instanceId)e.instanceId=String(t.instanceId);if(null!=t.pluginId)e.pluginId=String(t.pluginId);if(null!=t.roomId)e.roomId=String(t.roomId);if(null!=t.pkAction)e.pkAction=String(t.pkAction);if(null!=t.pkParams)e.pkParams=String(t.pkParams);return e},e.toObject=function(t,e){if(!e)e={};var i={};if(e.defaults)i.instanceId="",i.pluginId="",i.roomId="",i.pkAction="",i.pkParams="";if(null!=t.instanceId&&t.hasOwnProperty("instanceId"))i.instanceId=t.instanceId;if(null!=t.pluginId&&t.hasOwnProperty("pluginId"))i.pluginId=t.pluginId;if(null!=t.roomId&&t.hasOwnProperty("roomId"))i.roomId=t.roomId;if(null!=t.pkAction&&t.hasOwnProperty("pkAction"))i.pkAction=t.pkAction;if(null!=t.pkParams&&t.hasOwnProperty("pkParams"))i.pkParams=t.pkParams;return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),Ema.PK1v1PostActionResp=function(){function e(t){if(t)for(var e=Object.keys(t),i=0;i<e.length;++i)if(null!=t[e[i]])this[e[i]]=t[e[i]]}return e.prototype.code=0,e.prototype.info="",e.prototype.instanceId="",e.prototype.pluginId="",e.prototype.roomId="",e.create=function(t){return new e(t)},e.encode=function(t,e){if(!e)e=$Writer.create();return e.uint32(8).int32(t.code),e.uint32(18).string(t.info),e.uint32(26).string(t.instanceId),e.uint32(34).string(t.pluginId),e.uint32(42).string(t.roomId),e},e.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},e.decode=function(t,e){if(!(t instanceof $Reader))t=$Reader.create(t);for(var i=void 0===e?t.len:t.pos+e,n=new $root.game.PK1v1PostActionResp;t.pos<i;){var r=t.uint32();switch(r>>>3){case 1:n.code=t.int32();break;case 2:n.info=t.string();break;case 3:n.instanceId=t.string();break;case 4:n.pluginId=t.string();break;case 5:n.roomId=t.string();break;default:t.skipType(7&r)}}if(!n.hasOwnProperty("code"))throw $util.ProtocolError("missing required 'code'",{instance:n});if(!n.hasOwnProperty("info"))throw $util.ProtocolError("missing required 'info'",{instance:n});if(!n.hasOwnProperty("instanceId"))throw $util.ProtocolError("missing required 'instanceId'",{instance:n});if(!n.hasOwnProperty("pluginId"))throw $util.ProtocolError("missing required 'pluginId'",{instance:n});if(!n.hasOwnProperty("roomId"))throw $util.ProtocolError("missing required 'roomId'",{instance:n});return n},e.decodeDelimited=function(t){if(!(t instanceof $Reader))t=new $Reader(t);return this.decode(t,t.uint32())},e.verify=function(t){if("object"!==_typeof(t)||null===t)return"object expected";if(!$util.isInteger(t.code))return"code: integer expected";if(!$util.isString(t.info))return"info: string expected";if(!$util.isString(t.instanceId))return"instanceId: string expected";if(!$util.isString(t.pluginId))return"pluginId: string expected";if(!$util.isString(t.roomId))return"roomId: string expected";else return null},e.fromObject=function(t){if(t instanceof $root.game.PK1v1PostActionResp)return t;var e=new $root.game.PK1v1PostActionResp;if(null!=t.code)e.code=0|t.code;if(null!=t.info)e.info=String(t.info);if(null!=t.instanceId)e.instanceId=String(t.instanceId);if(null!=t.pluginId)e.pluginId=String(t.pluginId);if(null!=t.roomId)e.roomId=String(t.roomId);return e},e.toObject=function(t,e){if(!e)e={};var i={};if(e.defaults)i.code=0,i.info="",i.instanceId="",i.pluginId="",i.roomId="";if(null!=t.code&&t.hasOwnProperty("code"))i.code=t.code;if(null!=t.info&&t.hasOwnProperty("info"))i.info=t.info;if(null!=t.instanceId&&t.hasOwnProperty("instanceId"))i.instanceId=t.instanceId;if(null!=t.pluginId&&t.hasOwnProperty("pluginId"))i.pluginId=t.pluginId;if(null!=t.roomId&&t.hasOwnProperty("roomId"))i.roomId=t.roomId;return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),Ema.PK1v1PostActionNoti=function(){function e(t){if(t)for(var e=Object.keys(t),i=0;i<e.length;++i)if(null!=t[e[i]])this[e[i]]=t[e[i]]}return e.prototype.code=0,e.prototype.info="",e.prototype.instanceId="",e.prototype.pluginId="",e.prototype.roomId="",e.prototype.pkAction="",e.prototype.pkParams="",e.create=function(t){return new e(t)},e.encode=function(t,e){if(!e)e=$Writer.create();return e.uint32(8).int32(t.code),e.uint32(18).string(t.info),e.uint32(26).string(t.instanceId),e.uint32(34).string(t.pluginId),e.uint32(42).string(t.roomId),e.uint32(50).string(t.pkAction),e.uint32(58).string(t.pkParams),e},e.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},e.decode=function(t,e){if(!(t instanceof $Reader))t=$Reader.create(t);for(var i=void 0===e?t.len:t.pos+e,n=new $root.game.PK1v1PostActionNoti;t.pos<i;){var r=t.uint32();switch(r>>>3){case 1:n.code=t.int32();break;case 2:n.info=t.string();break;case 3:n.instanceId=t.string();break;case 4:n.pluginId=t.string();break;case 5:n.roomId=t.string();break;case 6:n.pkAction=t.string();break;case 7:n.pkParams=t.string();break;default:t.skipType(7&r)}}if(!n.hasOwnProperty("code"))throw $util.ProtocolError("missing required 'code'",{instance:n});if(!n.hasOwnProperty("info"))throw $util.ProtocolError("missing required 'info'",{instance:n});if(!n.hasOwnProperty("instanceId"))throw $util.ProtocolError("missing required 'instanceId'",{instance:n});if(!n.hasOwnProperty("pluginId"))throw $util.ProtocolError("missing required 'pluginId'",{instance:n});if(!n.hasOwnProperty("roomId"))throw $util.ProtocolError("missing required 'roomId'",{instance:n});if(!n.hasOwnProperty("pkAction"))throw $util.ProtocolError("missing required 'pkAction'",{instance:n});if(!n.hasOwnProperty("pkParams"))throw $util.ProtocolError("missing required 'pkParams'",{instance:n});return n},e.decodeDelimited=function(t){if(!(t instanceof $Reader))t=new $Reader(t);return this.decode(t,t.uint32())},e.verify=function(t){if("object"!==_typeof(t)||null===t)return"object expected";if(!$util.isInteger(t.code))return"code: integer expected";if(!$util.isString(t.info))return"info: string expected";if(!$util.isString(t.instanceId))return"instanceId: string expected";if(!$util.isString(t.pluginId))return"pluginId: string expected";if(!$util.isString(t.roomId))return"roomId: string expected";if(!$util.isString(t.pkAction))return"pkAction: string expected";if(!$util.isString(t.pkParams))return"pkParams: string expected";else return null},e.fromObject=function(t){if(t instanceof $root.game.PK1v1PostActionNoti)return t;var e=new $root.game.PK1v1PostActionNoti;if(null!=t.code)e.code=0|t.code;if(null!=t.info)e.info=String(t.info);if(null!=t.instanceId)e.instanceId=String(t.instanceId);if(null!=t.pluginId)e.pluginId=String(t.pluginId);if(null!=t.roomId)e.roomId=String(t.roomId);if(null!=t.pkAction)e.pkAction=String(t.pkAction);if(null!=t.pkParams)e.pkParams=String(t.pkParams);return e},e.toObject=function(t,e){if(!e)e={};var i={};if(e.defaults)i.code=0,i.info="",i.instanceId="",i.pluginId="",i.roomId="",i.pkAction="",i.pkParams="";if(null!=t.code&&t.hasOwnProperty("code"))i.code=t.code;if(null!=t.info&&t.hasOwnProperty("info"))i.info=t.info;if(null!=t.instanceId&&t.hasOwnProperty("instanceId"))i.instanceId=t.instanceId;if(null!=t.pluginId&&t.hasOwnProperty("pluginId"))i.pluginId=t.pluginId;if(null!=t.roomId&&t.hasOwnProperty("roomId"))i.roomId=t.roomId;if(null!=t.pkAction&&t.hasOwnProperty("pkAction"))i.pkAction=t.pkAction;if(null!=t.pkParams&&t.hasOwnProperty("pkParams"))i.pkParams=t.pkParams;return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),Ema.PK1v1StopRoundReq=function(){function e(t){if(t)for(var e=Object.keys(t),i=0;i<e.length;++i)if(null!=t[e[i]])this[e[i]]=t[e[i]]}return e.prototype.instanceId="",e.prototype.pluginId="",e.prototype.roomId="",e.prototype.round=0,e.prototype.attackerId="",e.create=function(t){return new e(t)},e.encode=function(t,e){if(!e)e=$Writer.create();return e.uint32(10).string(t.instanceId),e.uint32(18).string(t.pluginId),e.uint32(26).string(t.roomId),e.uint32(32).int32(t.round),e.uint32(42).string(t.attackerId),e},e.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},e.decode=function(t,e){if(!(t instanceof $Reader))t=$Reader.create(t);for(var i=void 0===e?t.len:t.pos+e,n=new $root.game.PK1v1StopRoundReq;t.pos<i;){var r=t.uint32();switch(r>>>3){case 1:n.instanceId=t.string();break;case 2:n.pluginId=t.string();break;case 3:n.roomId=t.string();break;case 4:n.round=t.int32();break;case 5:n.attackerId=t.string();break;default:t.skipType(7&r)}}if(!n.hasOwnProperty("instanceId"))throw $util.ProtocolError("missing required 'instanceId'",{instance:n});if(!n.hasOwnProperty("pluginId"))throw $util.ProtocolError("missing required 'pluginId'",{instance:n});if(!n.hasOwnProperty("roomId"))throw $util.ProtocolError("missing required 'roomId'",{instance:n});if(!n.hasOwnProperty("round"))throw $util.ProtocolError("missing required 'round'",{instance:n});if(!n.hasOwnProperty("attackerId"))throw $util.ProtocolError("missing required 'attackerId'",{instance:n});return n},e.decodeDelimited=function(t){if(!(t instanceof $Reader))t=new $Reader(t);return this.decode(t,t.uint32())},e.verify=function(t){if("object"!==_typeof(t)||null===t)return"object expected";if(!$util.isString(t.instanceId))return"instanceId: string expected";if(!$util.isString(t.pluginId))return"pluginId: string expected";if(!$util.isString(t.roomId))return"roomId: string expected";if(!$util.isInteger(t.round))return"round: integer expected";if(!$util.isString(t.attackerId))return"attackerId: string expected";else return null},e.fromObject=function(t){if(t instanceof $root.game.PK1v1StopRoundReq)return t;var e=new $root.game.PK1v1StopRoundReq;if(null!=t.instanceId)e.instanceId=String(t.instanceId);if(null!=t.pluginId)e.pluginId=String(t.pluginId);if(null!=t.roomId)e.roomId=String(t.roomId);if(null!=t.round)e.round=0|t.round;if(null!=t.attackerId)e.attackerId=String(t.attackerId);return e},e.toObject=function(t,e){if(!e)e={};var i={};if(e.defaults)i.instanceId="",i.pluginId="",i.roomId="",i.round=0,i.attackerId="";if(null!=t.instanceId&&t.hasOwnProperty("instanceId"))i.instanceId=t.instanceId;if(null!=t.pluginId&&t.hasOwnProperty("pluginId"))i.pluginId=t.pluginId;if(null!=t.roomId&&t.hasOwnProperty("roomId"))i.roomId=t.roomId;if(null!=t.round&&t.hasOwnProperty("round"))i.round=t.round;if(null!=t.attackerId&&t.hasOwnProperty("attackerId"))i.attackerId=t.attackerId;return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),Ema.PK1v1StopRoundResp=function(){function e(t){if(t)for(var e=Object.keys(t),i=0;i<e.length;++i)if(null!=t[e[i]])this[e[i]]=t[e[i]]}return e.prototype.code=0,e.prototype.info="",e.prototype.instanceId="",e.prototype.pluginId="",e.prototype.roomId="",e.create=function(t){return new e(t)},e.encode=function(t,e){if(!e)e=$Writer.create();return e.uint32(8).int32(t.code),e.uint32(18).string(t.info),e.uint32(26).string(t.instanceId),e.uint32(34).string(t.pluginId),e.uint32(42).string(t.roomId),e},e.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},e.decode=function(t,e){if(!(t instanceof $Reader))t=$Reader.create(t);for(var i=void 0===e?t.len:t.pos+e,n=new $root.game.PK1v1StopRoundResp;t.pos<i;){var r=t.uint32();switch(r>>>3){case 1:n.code=t.int32();break;case 2:n.info=t.string();break;case 3:n.instanceId=t.string();break;case 4:n.pluginId=t.string();break;case 5:n.roomId=t.string();break;default:t.skipType(7&r)}}if(!n.hasOwnProperty("code"))throw $util.ProtocolError("missing required 'code'",{instance:n});if(!n.hasOwnProperty("info"))throw $util.ProtocolError("missing required 'info'",{instance:n});if(!n.hasOwnProperty("instanceId"))throw $util.ProtocolError("missing required 'instanceId'",{instance:n});if(!n.hasOwnProperty("pluginId"))throw $util.ProtocolError("missing required 'pluginId'",{instance:n});if(!n.hasOwnProperty("roomId"))throw $util.ProtocolError("missing required 'roomId'",{instance:n});return n},e.decodeDelimited=function(t){if(!(t instanceof $Reader))t=new $Reader(t);return this.decode(t,t.uint32())},e.verify=function(t){if("object"!==_typeof(t)||null===t)return"object expected";if(!$util.isInteger(t.code))return"code: integer expected";if(!$util.isString(t.info))return"info: string expected";if(!$util.isString(t.instanceId))return"instanceId: string expected";if(!$util.isString(t.pluginId))return"pluginId: string expected";if(!$util.isString(t.roomId))return"roomId: string expected";else return null},e.fromObject=function(t){if(t instanceof $root.game.PK1v1StopRoundResp)return t;var e=new $root.game.PK1v1StopRoundResp;if(null!=t.code)e.code=0|t.code;if(null!=t.info)e.info=String(t.info);if(null!=t.instanceId)e.instanceId=String(t.instanceId);if(null!=t.pluginId)e.pluginId=String(t.pluginId);if(null!=t.roomId)e.roomId=String(t.roomId);return e},e.toObject=function(t,e){if(!e)e={};var i={};if(e.defaults)i.code=0,i.info="",i.instanceId="",i.pluginId="",i.roomId="";if(null!=t.code&&t.hasOwnProperty("code"))i.code=t.code;if(null!=t.info&&t.hasOwnProperty("info"))i.info=t.info;if(null!=t.instanceId&&t.hasOwnProperty("instanceId"))i.instanceId=t.instanceId;if(null!=t.pluginId&&t.hasOwnProperty("pluginId"))i.pluginId=t.pluginId;if(null!=t.roomId&&t.hasOwnProperty("roomId"))i.roomId=t.roomId;return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),Ema.PK1v1StartRoundNoti=function(){function e(t){if(this.players=[],t)for(var e=Object.keys(t),i=0;i<e.length;++i)if(null!=t[e[i]])this[e[i]]=t[e[i]]}return e.prototype.code=0,e.prototype.info="",e.prototype.instanceId="",e.prototype.pluginId="",e.prototype.roomId="",e.prototype.round=0,e.prototype.players=$util.emptyArray,e.prototype.roundStartTime=$util.Long?$util.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(t,e){if(!e)e=$Writer.create();if(e.uint32(8).int32(t.code),e.uint32(18).string(t.info),e.uint32(26).string(t.instanceId),e.uint32(34).string(t.pluginId),e.uint32(42).string(t.roomId),e.uint32(48).int32(t.round),null!=t.players&&t.players.length)for(var i=0;i<t.players.length;++i)$root.game.PK1v1Player.encode(t.players[i],e.uint32(58).fork()).ldelim();return e.uint32(64).int64(t.roundStartTime),e},e.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},e.decode=function(t,e){if(!(t instanceof $Reader))t=$Reader.create(t);for(var i=void 0===e?t.len:t.pos+e,n=new $root.game.PK1v1StartRoundNoti;t.pos<i;){var r=t.uint32();switch(r>>>3){case 1:n.code=t.int32();break;case 2:n.info=t.string();break;case 3:n.instanceId=t.string();break;case 4:n.pluginId=t.string();break;case 5:n.roomId=t.string();break;case 6:n.round=t.int32();break;case 7:if(!n.players||!n.players.length)n.players=[];n.players.push($root.game.PK1v1Player.decode(t,t.uint32()));break;case 8:n.roundStartTime=t.int64();break;default:t.skipType(7&r)}}if(!n.hasOwnProperty("code"))throw $util.ProtocolError("missing required 'code'",{instance:n});if(!n.hasOwnProperty("info"))throw $util.ProtocolError("missing required 'info'",{instance:n});if(!n.hasOwnProperty("instanceId"))throw $util.ProtocolError("missing required 'instanceId'",{instance:n});if(!n.hasOwnProperty("pluginId"))throw $util.ProtocolError("missing required 'pluginId'",{instance:n});if(!n.hasOwnProperty("roomId"))throw $util.ProtocolError("missing required 'roomId'",{instance:n});if(!n.hasOwnProperty("round"))throw $util.ProtocolError("missing required 'round'",{instance:n});if(!n.hasOwnProperty("roundStartTime"))throw $util.ProtocolError("missing required 'roundStartTime'",{instance:n});return n},e.decodeDelimited=function(t){if(!(t instanceof $Reader))t=new $Reader(t);return this.decode(t,t.uint32())},e.verify=function(t){if("object"!==_typeof(t)||null===t)return"object expected";if(!$util.isInteger(t.code))return"code: integer expected";if(!$util.isString(t.info))return"info: string expected";if(!$util.isString(t.instanceId))return"instanceId: string expected";if(!$util.isString(t.pluginId))return"pluginId: string expected";if(!$util.isString(t.roomId))return"roomId: string expected";if(!$util.isInteger(t.round))return"round: integer expected";if(null!=t.players&&t.hasOwnProperty("players")){if(!Array.isArray(t.players))return"players: array expected";for(var e=0;e<t.players.length;++e){var i=$root.game.PK1v1Player.verify(t.players[e]);if(i)return"players."+i}}if(!($util.isInteger(t.roundStartTime)||t.roundStartTime&&$util.isInteger(t.roundStartTime.low)&&$util.isInteger(t.roundStartTime.high)))return"roundStartTime: integer|Long expected";else return null},e.fromObject=function(t){if(t instanceof $root.game.PK1v1StartRoundNoti)return t;var e=new $root.game.PK1v1StartRoundNoti;if(null!=t.code)e.code=0|t.code;if(null!=t.info)e.info=String(t.info);if(null!=t.instanceId)e.instanceId=String(t.instanceId);if(null!=t.pluginId)e.pluginId=String(t.pluginId);if(null!=t.roomId)e.roomId=String(t.roomId);if(null!=t.round)e.round=0|t.round;if(t.players){if(!Array.isArray(t.players))throw TypeError(".game.PK1v1StartRoundNoti.players: array expected");e.players=[];for(var i=0;i<t.players.length;++i){if("object"!==_typeof(t.players[i]))throw TypeError(".game.PK1v1StartRoundNoti.players: object expected");e.players[i]=$root.game.PK1v1Player.fromObject(t.players[i])}}if(null!=t.roundStartTime)if($util.Long)(e.roundStartTime=$util.Long.fromValue(t.roundStartTime)).unsigned=!1;else if("string"==typeof t.roundStartTime)e.roundStartTime=parseInt(t.roundStartTime,10);else if("number"==typeof t.roundStartTime)e.roundStartTime=t.roundStartTime;else if("object"===_typeof(t.roundStartTime))e.roundStartTime=new $util.LongBits(t.roundStartTime.low>>>0,t.roundStartTime.high>>>0).toNumber();return e},e.toObject=function(t,e){if(!e)e={};var i={};if(e.arrays||e.defaults)i.players=[];if(e.defaults)if(i.code=0,i.info="",i.instanceId="",i.pluginId="",i.roomId="",i.round=0,$util.Long){var n=new $util.Long(0,0,!1);i.roundStartTime=e.longs===String?n.toString():e.longs===Number?n.toNumber():n}else i.roundStartTime=e.longs===String?"0":0;if(null!=t.code&&t.hasOwnProperty("code"))i.code=t.code;if(null!=t.info&&t.hasOwnProperty("info"))i.info=t.info;if(null!=t.instanceId&&t.hasOwnProperty("instanceId"))i.instanceId=t.instanceId;if(null!=t.pluginId&&t.hasOwnProperty("pluginId"))i.pluginId=t.pluginId;if(null!=t.roomId&&t.hasOwnProperty("roomId"))i.roomId=t.roomId;if(null!=t.round&&t.hasOwnProperty("round"))i.round=t.round;if(t.players&&t.players.length){i.players=[];for(var r=0;r<t.players.length;++r)i.players[r]=$root.game.PK1v1Player.toObject(t.players[r],e)}if(null!=t.roundStartTime&&t.hasOwnProperty("roundStartTime"))if("number"==typeof t.roundStartTime)i.roundStartTime=e.longs===String?String(t.roundStartTime):t.roundStartTime;else i.roundStartTime=e.longs===String?$util.Long.prototype.toString.call(t.roundStartTime):e.longs===Number?new $util.LongBits(t.roundStartTime.low>>>0,t.roundStartTime.high>>>0).toNumber():t.roundStartTime;return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),Ema.PK1v1StopPKReq=function(){function e(t){if(t)for(var e=Object.keys(t),i=0;i<e.length;++i)if(null!=t[e[i]])this[e[i]]=t[e[i]]}return e.prototype.instanceId="",e.prototype.pluginId="",e.prototype.roomId="",e.create=function(t){return new e(t)},e.encode=function(t,e){if(!e)e=$Writer.create();return e.uint32(10).string(t.instanceId),e.uint32(18).string(t.pluginId),e.uint32(26).string(t.roomId),e},e.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},e.decode=function(t,e){if(!(t instanceof $Reader))t=$Reader.create(t);for(var i=void 0===e?t.len:t.pos+e,n=new $root.game.PK1v1StopPKReq;t.pos<i;){var r=t.uint32();switch(r>>>3){case 1:n.instanceId=t.string();break;case 2:n.pluginId=t.string();break;case 3:n.roomId=t.string();break;default:t.skipType(7&r)}}if(!n.hasOwnProperty("instanceId"))throw $util.ProtocolError("missing required 'instanceId'",{instance:n});if(!n.hasOwnProperty("pluginId"))throw $util.ProtocolError("missing required 'pluginId'",{instance:n});if(!n.hasOwnProperty("roomId"))throw $util.ProtocolError("missing required 'roomId'",{instance:n});return n},e.decodeDelimited=function(t){if(!(t instanceof $Reader))t=new $Reader(t);return this.decode(t,t.uint32())},e.verify=function(t){if("object"!==_typeof(t)||null===t)return"object expected";if(!$util.isString(t.instanceId))return"instanceId: string expected";if(!$util.isString(t.pluginId))return"pluginId: string expected";if(!$util.isString(t.roomId))return"roomId: string expected";else return null},e.fromObject=function(t){if(t instanceof $root.game.PK1v1StopPKReq)return t;var e=new $root.game.PK1v1StopPKReq;if(null!=t.instanceId)e.instanceId=String(t.instanceId);if(null!=t.pluginId)e.pluginId=String(t.pluginId);if(null!=t.roomId)e.roomId=String(t.roomId);return e},e.toObject=function(t,e){if(!e)e={};var i={};if(e.defaults)i.instanceId="",i.pluginId="",i.roomId="";if(null!=t.instanceId&&t.hasOwnProperty("instanceId"))i.instanceId=t.instanceId;if(null!=t.pluginId&&t.hasOwnProperty("pluginId"))i.pluginId=t.pluginId;if(null!=t.roomId&&t.hasOwnProperty("roomId"))i.roomId=t.roomId;return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),Ema.PK1v1StopPKResp=function(){function e(t){if(t)for(var e=Object.keys(t),i=0;i<e.length;++i)if(null!=t[e[i]])this[e[i]]=t[e[i]]}return e.prototype.code=0,e.prototype.info="",e.prototype.instanceId="",e.prototype.pluginId="",e.prototype.roomId="",e.create=function(t){return new e(t)},e.encode=function(t,e){if(!e)e=$Writer.create();return e.uint32(8).int32(t.code),e.uint32(18).string(t.info),e.uint32(26).string(t.instanceId),e.uint32(34).string(t.pluginId),e.uint32(42).string(t.roomId),e},e.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},e.decode=function(t,e){if(!(t instanceof $Reader))t=$Reader.create(t);for(var i=void 0===e?t.len:t.pos+e,n=new $root.game.PK1v1StopPKResp;t.pos<i;){var r=t.uint32();switch(r>>>3){case 1:n.code=t.int32();break;case 2:n.info=t.string();break;case 3:n.instanceId=t.string();break;case 4:n.pluginId=t.string();break;case 5:n.roomId=t.string();break;default:t.skipType(7&r)}}if(!n.hasOwnProperty("code"))throw $util.ProtocolError("missing required 'code'",{instance:n});if(!n.hasOwnProperty("info"))throw $util.ProtocolError("missing required 'info'",{instance:n});if(!n.hasOwnProperty("instanceId"))throw $util.ProtocolError("missing required 'instanceId'",{instance:n});if(!n.hasOwnProperty("pluginId"))throw $util.ProtocolError("missing required 'pluginId'",{instance:n});if(!n.hasOwnProperty("roomId"))throw $util.ProtocolError("missing required 'roomId'",{instance:n});return n},e.decodeDelimited=function(t){if(!(t instanceof $Reader))t=new $Reader(t);return this.decode(t,t.uint32())},e.verify=function(t){if("object"!==_typeof(t)||null===t)return"object expected";if(!$util.isInteger(t.code))return"code: integer expected";if(!$util.isString(t.info))return"info: string expected";if(!$util.isString(t.instanceId))return"instanceId: string expected";if(!$util.isString(t.pluginId))return"pluginId: string expected";if(!$util.isString(t.roomId))return"roomId: string expected";else return null},e.fromObject=function(t){if(t instanceof $root.game.PK1v1StopPKResp)return t;var e=new $root.game.PK1v1StopPKResp;if(null!=t.code)e.code=0|t.code;if(null!=t.info)e.info=String(t.info);if(null!=t.instanceId)e.instanceId=String(t.instanceId);if(null!=t.pluginId)e.pluginId=String(t.pluginId);if(null!=t.roomId)e.roomId=String(t.roomId);return e},e.toObject=function(t,e){if(!e)e={};var i={};if(e.defaults)i.code=0,i.info="",i.instanceId="",i.pluginId="",i.roomId="";if(null!=t.code&&t.hasOwnProperty("code"))i.code=t.code;if(null!=t.info&&t.hasOwnProperty("info"))i.info=t.info;if(null!=t.instanceId&&t.hasOwnProperty("instanceId"))i.instanceId=t.instanceId;if(null!=t.pluginId&&t.hasOwnProperty("pluginId"))i.pluginId=t.pluginId;if(null!=t.roomId&&t.hasOwnProperty("roomId"))i.roomId=t.roomId;return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),Ema.PK1v1StopPKNoti=function(){function e(t){if(t)for(var e=Object.keys(t),i=0;i<e.length;++i)if(null!=t[e[i]])this[e[i]]=t[e[i]]}return e.prototype.code=0,e.prototype.info="",e.prototype.instanceId="",e.prototype.pluginId="",e.prototype.roomId="",e.create=function(t){return new e(t)},e.encode=function(t,e){if(!e)e=$Writer.create();return e.uint32(8).int32(t.code),e.uint32(18).string(t.info),e.uint32(26).string(t.instanceId),e.uint32(34).string(t.pluginId),e.uint32(42).string(t.roomId),e},e.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},e.decode=function(t,e){if(!(t instanceof $Reader))t=$Reader.create(t);for(var i=void 0===e?t.len:t.pos+e,n=new $root.game.PK1v1StopPKNoti;t.pos<i;){var r=t.uint32();switch(r>>>3){case 1:n.code=t.int32();break;case 2:n.info=t.string();break;case 3:n.instanceId=t.string();break;case 4:n.pluginId=t.string();break;case 5:n.roomId=t.string();break;default:t.skipType(7&r)}}if(!n.hasOwnProperty("code"))throw $util.ProtocolError("missing required 'code'",{instance:n});if(!n.hasOwnProperty("info"))throw $util.ProtocolError("missing required 'info'",{instance:n});if(!n.hasOwnProperty("instanceId"))throw $util.ProtocolError("missing required 'instanceId'",{instance:n});if(!n.hasOwnProperty("pluginId"))throw $util.ProtocolError("missing required 'pluginId'",{instance:n});if(!n.hasOwnProperty("roomId"))throw $util.ProtocolError("missing required 'roomId'",{instance:n});return n},e.decodeDelimited=function(t){if(!(t instanceof $Reader))t=new $Reader(t);return this.decode(t,t.uint32())},e.verify=function(t){if("object"!==_typeof(t)||null===t)return"object expected";if(!$util.isInteger(t.code))return"code: integer expected";if(!$util.isString(t.info))return"info: string expected";if(!$util.isString(t.instanceId))return"instanceId: string expected";if(!$util.isString(t.pluginId))return"pluginId: string expected";if(!$util.isString(t.roomId))return"roomId: string expected";else return null},e.fromObject=function(t){if(t instanceof $root.game.PK1v1StopPKNoti)return t;var e=new $root.game.PK1v1StopPKNoti;if(null!=t.code)e.code=0|t.code;if(null!=t.info)e.info=String(t.info);if(null!=t.instanceId)e.instanceId=String(t.instanceId);if(null!=t.pluginId)e.pluginId=String(t.pluginId);if(null!=t.roomId)e.roomId=String(t.roomId);return e},e.toObject=function(t,e){if(!e)e={};var i={};if(e.defaults)i.code=0,i.info="",i.instanceId="",i.pluginId="",i.roomId="";if(null!=t.code&&t.hasOwnProperty("code"))i.code=t.code;if(null!=t.info&&t.hasOwnProperty("info"))i.info=t.info;if(null!=t.instanceId&&t.hasOwnProperty("instanceId"))i.instanceId=t.instanceId;if(null!=t.pluginId&&t.hasOwnProperty("pluginId"))i.pluginId=t.pluginId;if(null!=t.roomId&&t.hasOwnProperty("roomId"))i.roomId=t.roomId;return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),Ema.PK1v1StopMatchReq=function(){function e(t){if(t)for(var e=Object.keys(t),i=0;i<e.length;++i)if(null!=t[e[i]])this[e[i]]=t[e[i]]}return e.prototype.instanceId="",e.prototype.pluginId="",e.create=function(t){return new e(t)},e.encode=function(t,e){if(!e)e=$Writer.create();return e.uint32(10).string(t.instanceId),e.uint32(18).string(t.pluginId),e},e.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},e.decode=function(t,e){if(!(t instanceof $Reader))t=$Reader.create(t);for(var i=void 0===e?t.len:t.pos+e,n=new $root.game.PK1v1StopMatchReq;t.pos<i;){var r=t.uint32();switch(r>>>3){case 1:n.instanceId=t.string();break;case 2:n.pluginId=t.string();break;default:t.skipType(7&r)}}if(!n.hasOwnProperty("instanceId"))throw $util.ProtocolError("missing required 'instanceId'",{instance:n});if(!n.hasOwnProperty("pluginId"))throw $util.ProtocolError("missing required 'pluginId'",{instance:n});return n},e.decodeDelimited=function(t){if(!(t instanceof $Reader))t=new $Reader(t);return this.decode(t,t.uint32())},e.verify=function(t){if("object"!==_typeof(t)||null===t)return"object expected";if(!$util.isString(t.instanceId))return"instanceId: string expected";if(!$util.isString(t.pluginId))return"pluginId: string expected";else return null},e.fromObject=function(t){if(t instanceof $root.game.PK1v1StopMatchReq)return t;var e=new $root.game.PK1v1StopMatchReq;if(null!=t.instanceId)e.instanceId=String(t.instanceId);if(null!=t.pluginId)e.pluginId=String(t.pluginId);return e},e.toObject=function(t,e){if(!e)e={};var i={};if(e.defaults)i.instanceId="",i.pluginId="";if(null!=t.instanceId&&t.hasOwnProperty("instanceId"))i.instanceId=t.instanceId;if(null!=t.pluginId&&t.hasOwnProperty("pluginId"))i.pluginId=t.pluginId;return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),Ema.PK1v1StopMatchResp=function(){function e(t){if(t)for(var e=Object.keys(t),i=0;i<e.length;++i)if(null!=t[e[i]])this[e[i]]=t[e[i]]}return e.prototype.code=0,e.prototype.info="",e.prototype.instanceId="",e.prototype.pluginId="",e.create=function(t){return new e(t)},e.encode=function(t,e){if(!e)e=$Writer.create();return e.uint32(8).int32(t.code),e.uint32(18).string(t.info),e.uint32(26).string(t.instanceId),e.uint32(34).string(t.pluginId),e},e.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},e.decode=function(t,e){if(!(t instanceof $Reader))t=$Reader.create(t);for(var i=void 0===e?t.len:t.pos+e,n=new $root.game.PK1v1StopMatchResp;t.pos<i;){var r=t.uint32();switch(r>>>3){case 1:n.code=t.int32();break;case 2:n.info=t.string();break;case 3:n.instanceId=t.string();break;case 4:n.pluginId=t.string();break;default:t.skipType(7&r)}}if(!n.hasOwnProperty("code"))throw $util.ProtocolError("missing required 'code'",{instance:n});if(!n.hasOwnProperty("info"))throw $util.ProtocolError("missing required 'info'",{instance:n});if(!n.hasOwnProperty("instanceId"))throw $util.ProtocolError("missing required 'instanceId'",{instance:n});if(!n.hasOwnProperty("pluginId"))throw $util.ProtocolError("missing required 'pluginId'",{instance:n});return n},e.decodeDelimited=function(t){if(!(t instanceof $Reader))t=new $Reader(t);return this.decode(t,t.uint32())},e.verify=function(t){if("object"!==_typeof(t)||null===t)return"object expected";if(!$util.isInteger(t.code))return"code: integer expected";if(!$util.isString(t.info))return"info: string expected";if(!$util.isString(t.instanceId))return"instanceId: string expected";if(!$util.isString(t.pluginId))return"pluginId: string expected";else return null},e.fromObject=function(t){if(t instanceof $root.game.PK1v1StopMatchResp)return t;var e=new $root.game.PK1v1StopMatchResp;if(null!=t.code)e.code=0|t.code;if(null!=t.info)e.info=String(t.info);if(null!=t.instanceId)e.instanceId=String(t.instanceId);if(null!=t.pluginId)e.pluginId=String(t.pluginId);return e},e.toObject=function(t,e){if(!e)e={};var i={};if(e.defaults)i.code=0,i.info="",i.instanceId="",i.pluginId="";if(null!=t.code&&t.hasOwnProperty("code"))i.code=t.code;if(null!=t.info&&t.hasOwnProperty("info"))i.info=t.info;if(null!=t.instanceId&&t.hasOwnProperty("instanceId"))i.instanceId=t.instanceId;if(null!=t.pluginId&&t.hasOwnProperty("pluginId"))i.pluginId=t.pluginId;return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),Ema.PK1v1OfflineNoti=function(){function e(t){if(t)for(var e=Object.keys(t),i=0;i<e.length;++i)if(null!=t[e[i]])this[e[i]]=t[e[i]]}return e.prototype.code=0,e.prototype.info="",e.prototype.instanceId="",e.prototype.pluginId="",e.prototype.roomId="",e.prototype.offlineId="",e.prototype.factor="",e.create=function(t){return new e(t)},e.encode=function(t,e){if(!e)e=$Writer.create();return e.uint32(8).int32(t.code),e.uint32(18).string(t.info),e.uint32(26).string(t.instanceId),e.uint32(34).string(t.pluginId),e.uint32(42).string(t.roomId),e.uint32(50).string(t.offlineId),e.uint32(58).string(t.factor),e},e.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},e.decode=function(t,e){if(!(t instanceof $Reader))t=$Reader.create(t);for(var i=void 0===e?t.len:t.pos+e,n=new $root.game.PK1v1OfflineNoti;t.pos<i;){var r=t.uint32();switch(r>>>3){case 1:n.code=t.int32();break;case 2:n.info=t.string();break;case 3:n.instanceId=t.string();break;case 4:n.pluginId=t.string();break;case 5:n.roomId=t.string();break;case 6:n.offlineId=t.string();break;case 7:n.factor=t.string();break;default:t.skipType(7&r)}}if(!n.hasOwnProperty("code"))throw $util.ProtocolError("missing required 'code'",{instance:n});if(!n.hasOwnProperty("info"))throw $util.ProtocolError("missing required 'info'",{instance:n});if(!n.hasOwnProperty("instanceId"))throw $util.ProtocolError("missing required 'instanceId'",{instance:n});if(!n.hasOwnProperty("pluginId"))throw $util.ProtocolError("missing required 'pluginId'",{instance:n});if(!n.hasOwnProperty("roomId"))throw $util.ProtocolError("missing required 'roomId'",{instance:n});if(!n.hasOwnProperty("offlineId"))throw $util.ProtocolError("missing required 'offlineId'",{instance:n});if(!n.hasOwnProperty("factor"))throw $util.ProtocolError("missing required 'factor'",{instance:n});return n},e.decodeDelimited=function(t){if(!(t instanceof $Reader))t=new $Reader(t);return this.decode(t,t.uint32())},e.verify=function(t){if("object"!==_typeof(t)||null===t)return"object expected";if(!$util.isInteger(t.code))return"code: integer expected";if(!$util.isString(t.info))return"info: string expected";if(!$util.isString(t.instanceId))return"instanceId: string expected";if(!$util.isString(t.pluginId))return"pluginId: string expected";if(!$util.isString(t.roomId))return"roomId: string expected";if(!$util.isString(t.offlineId))return"offlineId: string expected";if(!$util.isString(t.factor))return"factor: string expected";else return null},e.fromObject=function(t){if(t instanceof $root.game.PK1v1OfflineNoti)return t;var e=new $root.game.PK1v1OfflineNoti;if(null!=t.code)e.code=0|t.code;if(null!=t.info)e.info=String(t.info);if(null!=t.instanceId)e.instanceId=String(t.instanceId);if(null!=t.pluginId)e.pluginId=String(t.pluginId);if(null!=t.roomId)e.roomId=String(t.roomId);if(null!=t.offlineId)e.offlineId=String(t.offlineId);if(null!=t.factor)e.factor=String(t.factor);return e},e.toObject=function(t,e){if(!e)e={};var i={};if(e.defaults)i.code=0,i.info="",i.instanceId="",i.pluginId="",i.roomId="",i.offlineId="",i.factor="";if(null!=t.code&&t.hasOwnProperty("code"))i.code=t.code;if(null!=t.info&&t.hasOwnProperty("info"))i.info=t.info;if(null!=t.instanceId&&t.hasOwnProperty("instanceId"))i.instanceId=t.instanceId;if(null!=t.pluginId&&t.hasOwnProperty("pluginId"))i.pluginId=t.pluginId;if(null!=t.roomId&&t.hasOwnProperty("roomId"))i.roomId=t.roomId;if(null!=t.offlineId&&t.hasOwnProperty("offlineId"))i.offlineId=t.offlineId;if(null!=t.factor&&t.hasOwnProperty("factor"))i.factor=t.factor;return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),Ema.PK1v1ReadyTimeoutReq=function(){function e(t){if(t)for(var e=Object.keys(t),i=0;i<e.length;++i)if(null!=t[e[i]])this[e[i]]=t[e[i]]}return e.prototype.instanceId="",e.prototype.pluginId="",e.prototype.roomId="",e.create=function(t){return new e(t)},e.encode=function(t,e){if(!e)e=$Writer.create();return e.uint32(10).string(t.instanceId),e.uint32(18).string(t.pluginId),e.uint32(26).string(t.roomId),e},e.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},e.decode=function(t,e){if(!(t instanceof $Reader))t=$Reader.create(t);for(var i=void 0===e?t.len:t.pos+e,n=new $root.game.PK1v1ReadyTimeoutReq;t.pos<i;){var r=t.uint32();switch(r>>>3){case 1:n.instanceId=t.string();break;case 2:n.pluginId=t.string();break;case 3:n.roomId=t.string();break;default:t.skipType(7&r)}}if(!n.hasOwnProperty("instanceId"))throw $util.ProtocolError("missing required 'instanceId'",{instance:n});if(!n.hasOwnProperty("pluginId"))throw $util.ProtocolError("missing required 'pluginId'",{instance:n});if(!n.hasOwnProperty("roomId"))throw $util.ProtocolError("missing required 'roomId'",{instance:n});return n},e.decodeDelimited=function(t){if(!(t instanceof $Reader))t=new $Reader(t);return this.decode(t,t.uint32())},e.verify=function(t){if("object"!==_typeof(t)||null===t)return"object expected";if(!$util.isString(t.instanceId))return"instanceId: string expected";if(!$util.isString(t.pluginId))return"pluginId: string expected";if(!$util.isString(t.roomId))return"roomId: string expected";else return null},e.fromObject=function(t){if(t instanceof $root.game.PK1v1ReadyTimeoutReq)return t;var e=new $root.game.PK1v1ReadyTimeoutReq;if(null!=t.instanceId)e.instanceId=String(t.instanceId);if(null!=t.pluginId)e.pluginId=String(t.pluginId);if(null!=t.roomId)e.roomId=String(t.roomId);return e},e.toObject=function(t,e){if(!e)e={};var i={};if(e.defaults)i.instanceId="",i.pluginId="",i.roomId="";if(null!=t.instanceId&&t.hasOwnProperty("instanceId"))i.instanceId=t.instanceId;if(null!=t.pluginId&&t.hasOwnProperty("pluginId"))i.pluginId=t.pluginId;if(null!=t.roomId&&t.hasOwnProperty("roomId"))i.roomId=t.roomId;return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),Ema.PK1v1ReadyTimeoutResp=function(){function e(t){if(t)for(var e=Object.keys(t),i=0;i<e.length;++i)if(null!=t[e[i]])this[e[i]]=t[e[i]]}return e.prototype.code=0,e.prototype.info="",e.prototype.instanceId="",e.prototype.pluginId="",e.prototype.roomId="",e.create=function(t){return new e(t)},e.encode=function(t,e){if(!e)e=$Writer.create();return e.uint32(8).int32(t.code),e.uint32(18).string(t.info),e.uint32(26).string(t.instanceId),e.uint32(34).string(t.pluginId),e.uint32(42).string(t.roomId),e},e.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},e.decode=function(t,e){if(!(t instanceof $Reader))t=$Reader.create(t);for(var i=void 0===e?t.len:t.pos+e,n=new $root.game.PK1v1ReadyTimeoutResp;t.pos<i;){var r=t.uint32();switch(r>>>3){case 1:n.code=t.int32();break;case 2:n.info=t.string();break;case 3:n.instanceId=t.string();break;case 4:n.pluginId=t.string();break;case 5:n.roomId=t.string();break;default:t.skipType(7&r)}}if(!n.hasOwnProperty("code"))throw $util.ProtocolError("missing required 'code'",{instance:n});if(!n.hasOwnProperty("info"))throw $util.ProtocolError("missing required 'info'",{instance:n});if(!n.hasOwnProperty("instanceId"))throw $util.ProtocolError("missing required 'instanceId'",{instance:n});if(!n.hasOwnProperty("pluginId"))throw $util.ProtocolError("missing required 'pluginId'",{instance:n});if(!n.hasOwnProperty("roomId"))throw $util.ProtocolError("missing required 'roomId'",{instance:n});return n},e.decodeDelimited=function(t){if(!(t instanceof $Reader))t=new $Reader(t);return this.decode(t,t.uint32())},e.verify=function(t){if("object"!==_typeof(t)||null===t)return"object expected";if(!$util.isInteger(t.code))return"code: integer expected";if(!$util.isString(t.info))return"info: string expected";if(!$util.isString(t.instanceId))return"instanceId: string expected";if(!$util.isString(t.pluginId))return"pluginId: string expected";if(!$util.isString(t.roomId))return"roomId: string expected";else return null},e.fromObject=function(t){if(t instanceof $root.game.PK1v1ReadyTimeoutResp)return t;var e=new $root.game.PK1v1ReadyTimeoutResp;if(null!=t.code)e.code=0|t.code;if(null!=t.info)e.info=String(t.info);if(null!=t.instanceId)e.instanceId=String(t.instanceId);if(null!=t.pluginId)e.pluginId=String(t.pluginId);if(null!=t.roomId)e.roomId=String(t.roomId);return e},e.toObject=function(t,e){if(!e)e={};var i={};if(e.defaults)i.code=0,i.info="",i.instanceId="",i.pluginId="",i.roomId="";if(null!=t.code&&t.hasOwnProperty("code"))i.code=t.code;if(null!=t.info&&t.hasOwnProperty("info"))i.info=t.info;if(null!=t.instanceId&&t.hasOwnProperty("instanceId"))i.instanceId=t.instanceId;if(null!=t.pluginId&&t.hasOwnProperty("pluginId"))i.pluginId=t.pluginId;if(null!=t.roomId&&t.hasOwnProperty("roomId"))i.roomId=t.roomId;return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),Ema.PK1v1ReadyTimeoutNoti=function(){function e(t){if(t)for(var e=Object.keys(t),i=0;i<e.length;++i)if(null!=t[e[i]])this[e[i]]=t[e[i]]}return e.prototype.code=0,e.prototype.info="",e.prototype.instanceId="",e.prototype.pluginId="",e.prototype.roomId="",e.create=function(t){return new e(t)},e.encode=function(t,e){if(!e)e=$Writer.create();return e.uint32(8).int32(t.code),e.uint32(18).string(t.info),e.uint32(26).string(t.instanceId),e.uint32(34).string(t.pluginId),e.uint32(42).string(t.roomId),e},e.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},e.decode=function(t,e){if(!(t instanceof $Reader))t=$Reader.create(t);for(var i=void 0===e?t.len:t.pos+e,n=new $root.game.PK1v1ReadyTimeoutNoti;t.pos<i;){var r=t.uint32();switch(r>>>3){case 1:n.code=t.int32();break;case 2:n.info=t.string();break;case 3:n.instanceId=t.string();break;case 4:n.pluginId=t.string();break;case 5:n.roomId=t.string();break;default:t.skipType(7&r)}}if(!n.hasOwnProperty("code"))throw $util.ProtocolError("missing required 'code'",{instance:n});if(!n.hasOwnProperty("info"))throw $util.ProtocolError("missing required 'info'",{instance:n});if(!n.hasOwnProperty("instanceId"))throw $util.ProtocolError("missing required 'instanceId'",{instance:n});if(!n.hasOwnProperty("pluginId"))throw $util.ProtocolError("missing required 'pluginId'",{instance:n});if(!n.hasOwnProperty("roomId"))throw $util.ProtocolError("missing required 'roomId'",{instance:n});return n},e.decodeDelimited=function(t){if(!(t instanceof $Reader))t=new $Reader(t);return this.decode(t,t.uint32())},e.verify=function(t){if("object"!==_typeof(t)||null===t)return"object expected";if(!$util.isInteger(t.code))return"code: integer expected";if(!$util.isString(t.info))return"info: string expected";if(!$util.isString(t.instanceId))return"instanceId: string expected";if(!$util.isString(t.pluginId))return"pluginId: string expected";if(!$util.isString(t.roomId))return"roomId: string expected";else return null},e.fromObject=function(t){if(t instanceof $root.game.PK1v1ReadyTimeoutNoti)return t;var e=new $root.game.PK1v1ReadyTimeoutNoti;if(null!=t.code)e.code=0|t.code;if(null!=t.info)e.info=String(t.info);if(null!=t.instanceId)e.instanceId=String(t.instanceId);if(null!=t.pluginId)e.pluginId=String(t.pluginId);if(null!=t.roomId)e.roomId=String(t.roomId);return e},e.toObject=function(t,e){if(!e)e={};var i={};if(e.defaults)i.code=0,i.info="",i.instanceId="",i.pluginId="",i.roomId="";if(null!=t.code&&t.hasOwnProperty("code"))i.code=t.code;if(null!=t.info&&t.hasOwnProperty("info"))i.info=t.info;if(null!=t.instanceId&&t.hasOwnProperty("instanceId"))i.instanceId=t.instanceId;if(null!=t.pluginId&&t.hasOwnProperty("pluginId"))i.pluginId=t.pluginId;if(null!=t.roomId&&t.hasOwnProperty("roomId"))i.roomId=t.roomId;return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),Ema.PK1v1CancelMatchReq=function(){function e(t){if(t)for(var e=Object.keys(t),i=0;i<e.length;++i)if(null!=t[e[i]])this[e[i]]=t[e[i]]}return e.prototype.instanceId="",e.prototype.pluginId="",e.prototype.roomId="",e.create=function(t){return new e(t)},e.encode=function(t,e){if(!e)e=$Writer.create();return e.uint32(10).string(t.instanceId),e.uint32(18).string(t.pluginId),e.uint32(26).string(t.roomId),e},e.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},e.decode=function(t,e){if(!(t instanceof $Reader))t=$Reader.create(t);for(var i=void 0===e?t.len:t.pos+e,n=new $root.game.PK1v1CancelMatchReq;t.pos<i;){var r=t.uint32();switch(r>>>3){case 1:n.instanceId=t.string();break;case 2:n.pluginId=t.string();break;case 3:n.roomId=t.string();break;default:t.skipType(7&r)}}if(!n.hasOwnProperty("instanceId"))throw $util.ProtocolError("missing required 'instanceId'",{instance:n});if(!n.hasOwnProperty("pluginId"))throw $util.ProtocolError("missing required 'pluginId'",{instance:n});if(!n.hasOwnProperty("roomId"))throw $util.ProtocolError("missing required 'roomId'",{instance:n});return n},e.decodeDelimited=function(t){if(!(t instanceof $Reader))t=new $Reader(t);return this.decode(t,t.uint32())},e.verify=function(t){if("object"!==_typeof(t)||null===t)return"object expected";if(!$util.isString(t.instanceId))return"instanceId: string expected";if(!$util.isString(t.pluginId))return"pluginId: string expected";if(!$util.isString(t.roomId))return"roomId: string expected";else return null},e.fromObject=function(t){if(t instanceof $root.game.PK1v1CancelMatchReq)return t;var e=new $root.game.PK1v1CancelMatchReq;if(null!=t.instanceId)e.instanceId=String(t.instanceId);if(null!=t.pluginId)e.pluginId=String(t.pluginId);if(null!=t.roomId)e.roomId=String(t.roomId);return e},e.toObject=function(t,e){if(!e)e={};var i={};if(e.defaults)i.instanceId="",i.pluginId="",i.roomId="";if(null!=t.instanceId&&t.hasOwnProperty("instanceId"))i.instanceId=t.instanceId;if(null!=t.pluginId&&t.hasOwnProperty("pluginId"))i.pluginId=t.pluginId;if(null!=t.roomId&&t.hasOwnProperty("roomId"))i.roomId=t.roomId;return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),Ema.PK1v1CancelMatchResp=function(){function e(t){if(t)for(var e=Object.keys(t),i=0;i<e.length;++i)if(null!=t[e[i]])this[e[i]]=t[e[i]]}return e.prototype.code=0,e.prototype.info="",e.prototype.instanceId="",e.prototype.pluginId="",e.prototype.roomId="",e.create=function(t){return new e(t)},e.encode=function(t,e){if(!e)e=$Writer.create();return e.uint32(8).int32(t.code),e.uint32(18).string(t.info),e.uint32(26).string(t.instanceId),e.uint32(34).string(t.pluginId),e.uint32(42).string(t.roomId),e},e.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},e.decode=function(t,e){if(!(t instanceof $Reader))t=$Reader.create(t);for(var i=void 0===e?t.len:t.pos+e,n=new $root.game.PK1v1CancelMatchResp;t.pos<i;){var r=t.uint32();switch(r>>>3){case 1:n.code=t.int32();break;case 2:n.info=t.string();break;case 3:n.instanceId=t.string();break;case 4:n.pluginId=t.string();break;case 5:n.roomId=t.string();break;default:t.skipType(7&r)}}if(!n.hasOwnProperty("code"))throw $util.ProtocolError("missing required 'code'",{instance:n});if(!n.hasOwnProperty("info"))throw $util.ProtocolError("missing required 'info'",{instance:n});if(!n.hasOwnProperty("instanceId"))throw $util.ProtocolError("missing required 'instanceId'",{instance:n});if(!n.hasOwnProperty("pluginId"))throw $util.ProtocolError("missing required 'pluginId'",{instance:n});if(!n.hasOwnProperty("roomId"))throw $util.ProtocolError("missing required 'roomId'",{instance:n});return n},e.decodeDelimited=function(t){if(!(t instanceof $Reader))t=new $Reader(t);return this.decode(t,t.uint32())},e.verify=function(t){if("object"!==_typeof(t)||null===t)return"object expected";if(!$util.isInteger(t.code))return"code: integer expected";if(!$util.isString(t.info))return"info: string expected";if(!$util.isString(t.instanceId))return"instanceId: string expected";if(!$util.isString(t.pluginId))return"pluginId: string expected";if(!$util.isString(t.roomId))return"roomId: string expected";else return null},e.fromObject=function(t){if(t instanceof $root.game.PK1v1CancelMatchResp)return t;var e=new $root.game.PK1v1CancelMatchResp;if(null!=t.code)e.code=0|t.code;if(null!=t.info)e.info=String(t.info);if(null!=t.instanceId)e.instanceId=String(t.instanceId);if(null!=t.pluginId)e.pluginId=String(t.pluginId);if(null!=t.roomId)e.roomId=String(t.roomId);return e},e.toObject=function(t,e){if(!e)e={};var i={};if(e.defaults)i.code=0,i.info="",i.instanceId="",i.pluginId="",i.roomId="";if(null!=t.code&&t.hasOwnProperty("code"))i.code=t.code;if(null!=t.info&&t.hasOwnProperty("info"))i.info=t.info;if(null!=t.instanceId&&t.hasOwnProperty("instanceId"))i.instanceId=t.instanceId;if(null!=t.pluginId&&t.hasOwnProperty("pluginId"))i.pluginId=t.pluginId;if(null!=t.roomId&&t.hasOwnProperty("roomId"))i.roomId=t.roomId;return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),Ema.PK1v1CancelMatchNoti=function(){function e(t){if(t)for(var e=Object.keys(t),i=0;i<e.length;++i)if(null!=t[e[i]])this[e[i]]=t[e[i]]}return e.prototype.code=0,e.prototype.info="",e.prototype.instanceId="",e.prototype.pluginId="",e.prototype.roomId="",e.create=function(t){return new e(t)},e.encode=function(t,e){if(!e)e=$Writer.create();return e.uint32(8).int32(t.code),e.uint32(18).string(t.info),e.uint32(26).string(t.instanceId),e.uint32(34).string(t.pluginId),e.uint32(42).string(t.roomId),e},e.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},e.decode=function(t,e){if(!(t instanceof $Reader))t=$Reader.create(t);for(var i=void 0===e?t.len:t.pos+e,n=new $root.game.PK1v1CancelMatchNoti;t.pos<i;){var r=t.uint32();switch(r>>>3){case 1:n.code=t.int32();break;case 2:n.info=t.string();break;case 3:n.instanceId=t.string();break;case 4:n.pluginId=t.string();break;case 5:n.roomId=t.string();break;default:t.skipType(7&r)}}if(!n.hasOwnProperty("code"))throw $util.ProtocolError("missing required 'code'",{instance:n});if(!n.hasOwnProperty("info"))throw $util.ProtocolError("missing required 'info'",{instance:n});if(!n.hasOwnProperty("instanceId"))throw $util.ProtocolError("missing required 'instanceId'",{instance:n});if(!n.hasOwnProperty("pluginId"))throw $util.ProtocolError("missing required 'pluginId'",{instance:n});if(!n.hasOwnProperty("roomId"))throw $util.ProtocolError("missing required 'roomId'",{instance:n});return n},e.decodeDelimited=function(t){if(!(t instanceof $Reader))t=new $Reader(t);return this.decode(t,t.uint32())},e.verify=function(t){if("object"!==_typeof(t)||null===t)return"object expected";if(!$util.isInteger(t.code))return"code: integer expected";if(!$util.isString(t.info))return"info: string expected";if(!$util.isString(t.instanceId))return"instanceId: string expected";if(!$util.isString(t.pluginId))return"pluginId: string expected";if(!$util.isString(t.roomId))return"roomId: string expected";else return null},e.fromObject=function(t){if(t instanceof $root.game.PK1v1CancelMatchNoti)return t;var e=new $root.game.PK1v1CancelMatchNoti;if(null!=t.code)e.code=0|t.code;if(null!=t.info)e.info=String(t.info);if(null!=t.instanceId)e.instanceId=String(t.instanceId);if(null!=t.pluginId)e.pluginId=String(t.pluginId);if(null!=t.roomId)e.roomId=String(t.roomId);return e},e.toObject=function(t,e){if(!e)e={};var i={};if(e.defaults)i.code=0,i.info="",i.instanceId="",i.pluginId="",i.roomId="";if(null!=t.code&&t.hasOwnProperty("code"))i.code=t.code;if(null!=t.info&&t.hasOwnProperty("info"))i.info=t.info;if(null!=t.instanceId&&t.hasOwnProperty("instanceId"))i.instanceId=t.instanceId;if(null!=t.pluginId&&t.hasOwnProperty("pluginId"))i.pluginId=t.pluginId;if(null!=t.roomId&&t.hasOwnProperty("roomId"))i.roomId=t.roomId;return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),Ema.PK1v1RoundTimeoutNoti=function(){function e(t){if(this.players=[],t)for(var e=Object.keys(t),i=0;i<e.length;++i)if(null!=t[e[i]])this[e[i]]=t[e[i]]}return e.prototype.code=0,e.prototype.info="",e.prototype.instanceId="",e.prototype.pluginId="",e.prototype.roomId="",e.prototype.round=0,e.prototype.players=$util.emptyArray,e.prototype.roundStartTime=$util.Long?$util.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(t,e){if(!e)e=$Writer.create();if(e.uint32(8).int32(t.code),e.uint32(18).string(t.info),e.uint32(26).string(t.instanceId),e.uint32(34).string(t.pluginId),e.uint32(42).string(t.roomId),e.uint32(48).int32(t.round),null!=t.players&&t.players.length)for(var i=0;i<t.players.length;++i)$root.game.PK1v1Player.encode(t.players[i],e.uint32(58).fork()).ldelim();return e.uint32(64).int64(t.roundStartTime),e},e.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},e.decode=function(t,e){if(!(t instanceof $Reader))t=$Reader.create(t);for(var i=void 0===e?t.len:t.pos+e,n=new $root.game.PK1v1RoundTimeoutNoti;t.pos<i;){var r=t.uint32();switch(r>>>3){case 1:n.code=t.int32();break;case 2:n.info=t.string();break;case 3:n.instanceId=t.string();break;case 4:n.pluginId=t.string();break;case 5:n.roomId=t.string();break;case 6:n.round=t.int32();break;case 7:if(!n.players||!n.players.length)n.players=[];n.players.push($root.game.PK1v1Player.decode(t,t.uint32()));break;case 8:n.roundStartTime=t.int64();break;default:t.skipType(7&r)}}if(!n.hasOwnProperty("code"))throw $util.ProtocolError("missing required 'code'",{instance:n});if(!n.hasOwnProperty("info"))throw $util.ProtocolError("missing required 'info'",{instance:n});if(!n.hasOwnProperty("instanceId"))throw $util.ProtocolError("missing required 'instanceId'",{instance:n});if(!n.hasOwnProperty("pluginId"))throw $util.ProtocolError("missing required 'pluginId'",{instance:n});if(!n.hasOwnProperty("roomId"))throw $util.ProtocolError("missing required 'roomId'",{instance:n});if(!n.hasOwnProperty("round"))throw $util.ProtocolError("missing required 'round'",{instance:n});if(!n.hasOwnProperty("roundStartTime"))throw $util.ProtocolError("missing required 'roundStartTime'",{instance:n});return n},e.decodeDelimited=function(t){if(!(t instanceof $Reader))t=new $Reader(t);return this.decode(t,t.uint32())},e.verify=function(t){if("object"!==_typeof(t)||null===t)return"object expected";if(!$util.isInteger(t.code))return"code: integer expected";if(!$util.isString(t.info))return"info: string expected";if(!$util.isString(t.instanceId))return"instanceId: string expected";if(!$util.isString(t.pluginId))return"pluginId: string expected";if(!$util.isString(t.roomId))return"roomId: string expected";if(!$util.isInteger(t.round))return"round: integer expected";if(null!=t.players&&t.hasOwnProperty("players")){if(!Array.isArray(t.players))return"players: array expected";for(var e=0;e<t.players.length;++e){var i=$root.game.PK1v1Player.verify(t.players[e]);if(i)return"players."+i}}if(!($util.isInteger(t.roundStartTime)||t.roundStartTime&&$util.isInteger(t.roundStartTime.low)&&$util.isInteger(t.roundStartTime.high)))return"roundStartTime: integer|Long expected";else return null},e.fromObject=function(t){if(t instanceof $root.game.PK1v1RoundTimeoutNoti)return t;var e=new $root.game.PK1v1RoundTimeoutNoti;if(null!=t.code)e.code=0|t.code;if(null!=t.info)e.info=String(t.info);if(null!=t.instanceId)e.instanceId=String(t.instanceId);if(null!=t.pluginId)e.pluginId=String(t.pluginId);if(null!=t.roomId)e.roomId=String(t.roomId);if(null!=t.round)e.round=0|t.round;if(t.players){if(!Array.isArray(t.players))throw TypeError(".game.PK1v1RoundTimeoutNoti.players: array expected");e.players=[];for(var i=0;i<t.players.length;++i){if("object"!==_typeof(t.players[i]))throw TypeError(".game.PK1v1RoundTimeoutNoti.players: object expected");e.players[i]=$root.game.PK1v1Player.fromObject(t.players[i])}}if(null!=t.roundStartTime)if($util.Long)(e.roundStartTime=$util.Long.fromValue(t.roundStartTime)).unsigned=!1;else if("string"==typeof t.roundStartTime)e.roundStartTime=parseInt(t.roundStartTime,10);else if("number"==typeof t.roundStartTime)e.roundStartTime=t.roundStartTime;else if("object"===_typeof(t.roundStartTime))e.roundStartTime=new $util.LongBits(t.roundStartTime.low>>>0,t.roundStartTime.high>>>0).toNumber();return e},e.toObject=function(t,e){if(!e)e={};var i={};if(e.arrays||e.defaults)i.players=[];if(e.defaults)if(i.code=0,i.info="",i.instanceId="",i.pluginId="",i.roomId="",i.round=0,$util.Long){var n=new $util.Long(0,0,!1);i.roundStartTime=e.longs===String?n.toString():e.longs===Number?n.toNumber():n}else i.roundStartTime=e.longs===String?"0":0;if(null!=t.code&&t.hasOwnProperty("code"))i.code=t.code;if(null!=t.info&&t.hasOwnProperty("info"))i.info=t.info;if(null!=t.instanceId&&t.hasOwnProperty("instanceId"))i.instanceId=t.instanceId;if(null!=t.pluginId&&t.hasOwnProperty("pluginId"))i.pluginId=t.pluginId;if(null!=t.roomId&&t.hasOwnProperty("roomId"))i.roomId=t.roomId;if(null!=t.round&&t.hasOwnProperty("round"))i.round=t.round;if(t.players&&t.players.length){i.players=[];for(var r=0;r<t.players.length;++r)i.players[r]=$root.game.PK1v1Player.toObject(t.players[r],e)}if(null!=t.roundStartTime&&t.hasOwnProperty("roundStartTime"))if("number"==typeof t.roundStartTime)i.roundStartTime=e.longs===String?String(t.roundStartTime):t.roundStartTime;else i.roundStartTime=e.longs===String?$util.Long.prototype.toString.call(t.roundStartTime):e.longs===Number?new $util.LongBits(t.roundStartTime.low>>>0,t.roundStartTime.high>>>0).toNumber():t.roundStartTime;return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),Ema.PK1v1CancelReadyPKReq=function(){function e(t){if(t)for(var e=Object.keys(t),i=0;i<e.length;++i)if(null!=t[e[i]])this[e[i]]=t[e[i]]}return e.prototype.instanceId="",e.prototype.pluginId="",e.prototype.roomId="",e.create=function(t){return new e(t)},e.encode=function(t,e){if(!e)e=$Writer.create();return e.uint32(10).string(t.instanceId),e.uint32(18).string(t.pluginId),e.uint32(26).string(t.roomId),e},e.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},e.decode=function(t,e){if(!(t instanceof $Reader))t=$Reader.create(t);for(var i=void 0===e?t.len:t.pos+e,n=new $root.game.PK1v1CancelReadyPKReq;t.pos<i;){var r=t.uint32();switch(r>>>3){case 1:n.instanceId=t.string();break;case 2:n.pluginId=t.string();break;case 3:n.roomId=t.string();break;default:t.skipType(7&r)}}if(!n.hasOwnProperty("instanceId"))throw $util.ProtocolError("missing required 'instanceId'",{instance:n});if(!n.hasOwnProperty("pluginId"))throw $util.ProtocolError("missing required 'pluginId'",{instance:n});if(!n.hasOwnProperty("roomId"))throw $util.ProtocolError("missing required 'roomId'",{instance:n});return n},e.decodeDelimited=function(t){if(!(t instanceof $Reader))t=new $Reader(t);return this.decode(t,t.uint32())},e.verify=function(t){if("object"!==_typeof(t)||null===t)return"object expected";if(!$util.isString(t.instanceId))return"instanceId: string expected";if(!$util.isString(t.pluginId))return"pluginId: string expected";if(!$util.isString(t.roomId))return"roomId: string expected";else return null},e.fromObject=function(t){if(t instanceof $root.game.PK1v1CancelReadyPKReq)return t;var e=new $root.game.PK1v1CancelReadyPKReq;if(null!=t.instanceId)e.instanceId=String(t.instanceId);if(null!=t.pluginId)e.pluginId=String(t.pluginId);if(null!=t.roomId)e.roomId=String(t.roomId);return e},e.toObject=function(t,e){if(!e)e={};var i={};if(e.defaults)i.instanceId="",i.pluginId="",i.roomId="";if(null!=t.instanceId&&t.hasOwnProperty("instanceId"))i.instanceId=t.instanceId;if(null!=t.pluginId&&t.hasOwnProperty("pluginId"))i.pluginId=t.pluginId;if(null!=t.roomId&&t.hasOwnProperty("roomId"))i.roomId=t.roomId;return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),Ema.PK1v1CancelReadyPKResp=function(){function e(t){if(t)for(var e=Object.keys(t),i=0;i<e.length;++i)if(null!=t[e[i]])this[e[i]]=t[e[i]]}return e.prototype.code=0,e.prototype.info="",e.prototype.instanceId="",e.prototype.pluginId="",e.prototype.roomId="",e.create=function(t){return new e(t)},e.encode=function(t,e){if(!e)e=$Writer.create();return e.uint32(8).int32(t.code),e.uint32(18).string(t.info),e.uint32(26).string(t.instanceId),e.uint32(34).string(t.pluginId),e.uint32(42).string(t.roomId),e},e.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},e.decode=function(t,e){if(!(t instanceof $Reader))t=$Reader.create(t);for(var i=void 0===e?t.len:t.pos+e,n=new $root.game.PK1v1CancelReadyPKResp;t.pos<i;){var r=t.uint32();switch(r>>>3){case 1:n.code=t.int32();break;case 2:n.info=t.string();break;case 3:n.instanceId=t.string();break;case 4:n.pluginId=t.string();break;case 5:n.roomId=t.string();break;default:t.skipType(7&r)}}if(!n.hasOwnProperty("code"))throw $util.ProtocolError("missing required 'code'",{instance:n});if(!n.hasOwnProperty("info"))throw $util.ProtocolError("missing required 'info'",{instance:n});if(!n.hasOwnProperty("instanceId"))throw $util.ProtocolError("missing required 'instanceId'",{instance:n});if(!n.hasOwnProperty("pluginId"))throw $util.ProtocolError("missing required 'pluginId'",{instance:n});if(!n.hasOwnProperty("roomId"))throw $util.ProtocolError("missing required 'roomId'",{instance:n});return n},e.decodeDelimited=function(t){if(!(t instanceof $Reader))t=new $Reader(t);return this.decode(t,t.uint32())},e.verify=function(t){if("object"!==_typeof(t)||null===t)return"object expected";if(!$util.isInteger(t.code))return"code: integer expected";if(!$util.isString(t.info))return"info: string expected";if(!$util.isString(t.instanceId))return"instanceId: string expected";if(!$util.isString(t.pluginId))return"pluginId: string expected";if(!$util.isString(t.roomId))return"roomId: string expected";else return null},e.fromObject=function(t){if(t instanceof $root.game.PK1v1CancelReadyPKResp)return t;var e=new $root.game.PK1v1CancelReadyPKResp;if(null!=t.code)e.code=0|t.code;if(null!=t.info)e.info=String(t.info);if(null!=t.instanceId)e.instanceId=String(t.instanceId);if(null!=t.pluginId)e.pluginId=String(t.pluginId);if(null!=t.roomId)e.roomId=String(t.roomId);return e},e.toObject=function(t,e){if(!e)e={};var i={};if(e.defaults)i.code=0,i.info="",i.instanceId="",i.pluginId="",i.roomId="";if(null!=t.code&&t.hasOwnProperty("code"))i.code=t.code;if(null!=t.info&&t.hasOwnProperty("info"))i.info=t.info;if(null!=t.instanceId&&t.hasOwnProperty("instanceId"))i.instanceId=t.instanceId;if(null!=t.pluginId&&t.hasOwnProperty("pluginId"))i.pluginId=t.pluginId;if(null!=t.roomId&&t.hasOwnProperty("roomId"))i.roomId=t.roomId;return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),Ema.PK1v1CreateRoomReq=function(){function e(t){if(t)for(var e=Object.keys(t),i=0;i<e.length;++i)if(null!=t[e[i]])this[e[i]]=t[e[i]]}return e.prototype.instanceId="",e.prototype.pluginId="",e.create=function(t){return new e(t)},e.encode=function(t,e){if(!e)e=$Writer.create();return e.uint32(10).string(t.instanceId),e.uint32(18).string(t.pluginId),e},e.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},e.decode=function(t,e){if(!(t instanceof $Reader))t=$Reader.create(t);for(var i=void 0===e?t.len:t.pos+e,n=new $root.game.PK1v1CreateRoomReq;t.pos<i;){var r=t.uint32();switch(r>>>3){case 1:n.instanceId=t.string();break;case 2:n.pluginId=t.string();break;default:t.skipType(7&r)}}if(!n.hasOwnProperty("instanceId"))throw $util.ProtocolError("missing required 'instanceId'",{instance:n});if(!n.hasOwnProperty("pluginId"))throw $util.ProtocolError("missing required 'pluginId'",{instance:n});return n},e.decodeDelimited=function(t){if(!(t instanceof $Reader))t=new $Reader(t);return this.decode(t,t.uint32())},e.verify=function(t){if("object"!==_typeof(t)||null===t)return"object expected";if(!$util.isString(t.instanceId))return"instanceId: string expected";if(!$util.isString(t.pluginId))return"pluginId: string expected";else return null},e.fromObject=function(t){if(t instanceof $root.game.PK1v1CreateRoomReq)return t;var e=new $root.game.PK1v1CreateRoomReq;if(null!=t.instanceId)e.instanceId=String(t.instanceId);if(null!=t.pluginId)e.pluginId=String(t.pluginId);return e},e.toObject=function(t,e){if(!e)e={};var i={};if(e.defaults)i.instanceId="",i.pluginId="";if(null!=t.instanceId&&t.hasOwnProperty("instanceId"))i.instanceId=t.instanceId;if(null!=t.pluginId&&t.hasOwnProperty("pluginId"))i.pluginId=t.pluginId;return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),Ema.PK1v1CreateRoomResp=function(){function e(t){if(t)for(var e=Object.keys(t),i=0;i<e.length;++i)if(null!=t[e[i]])this[e[i]]=t[e[i]]}return e.prototype.code=0,e.prototype.info="",e.prototype.instanceId="",e.prototype.pluginId="",e.prototype.roomId="",e.prototype.inviteCode="",e.create=function(t){return new e(t)},e.encode=function(t,e){if(!e)e=$Writer.create();return e.uint32(8).int32(t.code),e.uint32(18).string(t.info),e.uint32(26).string(t.instanceId),e.uint32(34).string(t.pluginId),e.uint32(42).string(t.roomId),e.uint32(50).string(t.inviteCode),e},e.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},e.decode=function(t,e){if(!(t instanceof $Reader))t=$Reader.create(t);for(var i=void 0===e?t.len:t.pos+e,n=new $root.game.PK1v1CreateRoomResp;t.pos<i;){var r=t.uint32();switch(r>>>3){case 1:n.code=t.int32();break;case 2:n.info=t.string();break;case 3:n.instanceId=t.string();break;case 4:n.pluginId=t.string();break;case 5:n.roomId=t.string();break;case 6:n.inviteCode=t.string();break;default:t.skipType(7&r)}}if(!n.hasOwnProperty("code"))throw $util.ProtocolError("missing required 'code'",{instance:n});if(!n.hasOwnProperty("info"))throw $util.ProtocolError("missing required 'info'",{instance:n});if(!n.hasOwnProperty("instanceId"))throw $util.ProtocolError("missing required 'instanceId'",{instance:n});if(!n.hasOwnProperty("pluginId"))throw $util.ProtocolError("missing required 'pluginId'",{instance:n});if(!n.hasOwnProperty("roomId"))throw $util.ProtocolError("missing required 'roomId'",{instance:n});if(!n.hasOwnProperty("inviteCode"))throw $util.ProtocolError("missing required 'inviteCode'",{instance:n});return n},e.decodeDelimited=function(t){if(!(t instanceof $Reader))t=new $Reader(t);return this.decode(t,t.uint32())},e.verify=function(t){if("object"!==_typeof(t)||null===t)return"object expected";if(!$util.isInteger(t.code))return"code: integer expected";if(!$util.isString(t.info))return"info: string expected";if(!$util.isString(t.instanceId))return"instanceId: string expected";if(!$util.isString(t.pluginId))return"pluginId: string expected";if(!$util.isString(t.roomId))return"roomId: string expected";if(!$util.isString(t.inviteCode))return"inviteCode: string expected";else return null},e.fromObject=function(t){if(t instanceof $root.game.PK1v1CreateRoomResp)return t;var e=new $root.game.PK1v1CreateRoomResp;if(null!=t.code)e.code=0|t.code;if(null!=t.info)e.info=String(t.info);if(null!=t.instanceId)e.instanceId=String(t.instanceId);if(null!=t.pluginId)e.pluginId=String(t.pluginId);if(null!=t.roomId)e.roomId=String(t.roomId);if(null!=t.inviteCode)e.inviteCode=String(t.inviteCode);return e},e.toObject=function(t,e){if(!e)e={};var i={};if(e.defaults)i.code=0,i.info="",i.instanceId="",i.pluginId="",i.roomId="",i.inviteCode="";if(null!=t.code&&t.hasOwnProperty("code"))i.code=t.code;if(null!=t.info&&t.hasOwnProperty("info"))i.info=t.info;if(null!=t.instanceId&&t.hasOwnProperty("instanceId"))i.instanceId=t.instanceId;if(null!=t.pluginId&&t.hasOwnProperty("pluginId"))i.pluginId=t.pluginId;if(null!=t.roomId&&t.hasOwnProperty("roomId"))i.roomId=t.roomId;if(null!=t.inviteCode&&t.hasOwnProperty("inviteCode"))i.inviteCode=t.inviteCode;return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),Ema.PK1v1JoinRoomReq=function(){function e(t){if(t)for(var e=Object.keys(t),i=0;i<e.length;++i)if(null!=t[e[i]])this[e[i]]=t[e[i]]}return e.prototype.instanceId="",e.prototype.pluginId="",e.prototype.inviteCode="",e.create=function(t){return new e(t)},e.encode=function(t,e){if(!e)e=$Writer.create();return e.uint32(10).string(t.instanceId),e.uint32(18).string(t.pluginId),e.uint32(26).string(t.inviteCode),e},e.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},e.decode=function(t,e){if(!(t instanceof $Reader))t=$Reader.create(t);for(var i=void 0===e?t.len:t.pos+e,n=new $root.game.PK1v1JoinRoomReq;t.pos<i;){var r=t.uint32();switch(r>>>3){case 1:n.instanceId=t.string();break;case 2:n.pluginId=t.string();break;case 3:n.inviteCode=t.string();break;default:t.skipType(7&r)}}if(!n.hasOwnProperty("instanceId"))throw $util.ProtocolError("missing required 'instanceId'",{instance:n});if(!n.hasOwnProperty("pluginId"))throw $util.ProtocolError("missing required 'pluginId'",{instance:n});if(!n.hasOwnProperty("inviteCode"))throw $util.ProtocolError("missing required 'inviteCode'",{instance:n});return n},e.decodeDelimited=function(t){if(!(t instanceof $Reader))t=new $Reader(t);return this.decode(t,t.uint32())},e.verify=function(t){if("object"!==_typeof(t)||null===t)return"object expected";if(!$util.isString(t.instanceId))return"instanceId: string expected";if(!$util.isString(t.pluginId))return"pluginId: string expected";if(!$util.isString(t.inviteCode))return"inviteCode: string expected";else return null},e.fromObject=function(t){if(t instanceof $root.game.PK1v1JoinRoomReq)return t;var e=new $root.game.PK1v1JoinRoomReq;if(null!=t.instanceId)e.instanceId=String(t.instanceId);if(null!=t.pluginId)e.pluginId=String(t.pluginId);if(null!=t.inviteCode)e.inviteCode=String(t.inviteCode);return e},e.toObject=function(t,e){if(!e)e={};var i={};if(e.defaults)i.instanceId="",i.pluginId="",i.inviteCode="";if(null!=t.instanceId&&t.hasOwnProperty("instanceId"))i.instanceId=t.instanceId;if(null!=t.pluginId&&t.hasOwnProperty("pluginId"))i.pluginId=t.pluginId;if(null!=t.inviteCode&&t.hasOwnProperty("inviteCode"))i.inviteCode=t.inviteCode;return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),Ema.PK1v1JoinRoomResp=function(){function e(t){if(t)for(var e=Object.keys(t),i=0;i<e.length;++i)if(null!=t[e[i]])this[e[i]]=t[e[i]]}return e.prototype.code=0,e.prototype.info="",e.prototype.instanceId="",e.prototype.pluginId="",e.prototype.roomId="",e.prototype.inviteCode="",e.create=function(t){return new e(t)},e.encode=function(t,e){if(!e)e=$Writer.create();return e.uint32(8).int32(t.code),e.uint32(18).string(t.info),e.uint32(26).string(t.instanceId),e.uint32(34).string(t.pluginId),e.uint32(42).string(t.roomId),e.uint32(50).string(t.inviteCode),e},e.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},e.decode=function(t,e){if(!(t instanceof $Reader))t=$Reader.create(t);for(var i=void 0===e?t.len:t.pos+e,n=new $root.game.PK1v1JoinRoomResp;t.pos<i;){var r=t.uint32();switch(r>>>3){case 1:n.code=t.int32();break;case 2:n.info=t.string();break;case 3:n.instanceId=t.string();break;case 4:n.pluginId=t.string();break;case 5:n.roomId=t.string();break;case 6:n.inviteCode=t.string();break;default:t.skipType(7&r)}}if(!n.hasOwnProperty("code"))throw $util.ProtocolError("missing required 'code'",{instance:n});if(!n.hasOwnProperty("info"))throw $util.ProtocolError("missing required 'info'",{instance:n});if(!n.hasOwnProperty("instanceId"))throw $util.ProtocolError("missing required 'instanceId'",{instance:n});if(!n.hasOwnProperty("pluginId"))throw $util.ProtocolError("missing required 'pluginId'",{instance:n});if(!n.hasOwnProperty("roomId"))throw $util.ProtocolError("missing required 'roomId'",{instance:n});if(!n.hasOwnProperty("inviteCode"))throw $util.ProtocolError("missing required 'inviteCode'",{instance:n});return n},e.decodeDelimited=function(t){if(!(t instanceof $Reader))t=new $Reader(t);return this.decode(t,t.uint32())},e.verify=function(t){if("object"!==_typeof(t)||null===t)return"object expected";if(!$util.isInteger(t.code))return"code: integer expected";if(!$util.isString(t.info))return"info: string expected";if(!$util.isString(t.instanceId))return"instanceId: string expected";if(!$util.isString(t.pluginId))return"pluginId: string expected";if(!$util.isString(t.roomId))return"roomId: string expected";if(!$util.isString(t.inviteCode))return"inviteCode: string expected";else return null},e.fromObject=function(t){if(t instanceof $root.game.PK1v1JoinRoomResp)return t;var e=new $root.game.PK1v1JoinRoomResp;if(null!=t.code)e.code=0|t.code;if(null!=t.info)e.info=String(t.info);if(null!=t.instanceId)e.instanceId=String(t.instanceId);if(null!=t.pluginId)e.pluginId=String(t.pluginId);if(null!=t.roomId)e.roomId=String(t.roomId);if(null!=t.inviteCode)e.inviteCode=String(t.inviteCode);return e},e.toObject=function(t,e){if(!e)e={};var i={};if(e.defaults)i.code=0,i.info="",i.instanceId="",i.pluginId="",i.roomId="",i.inviteCode="";if(null!=t.code&&t.hasOwnProperty("code"))i.code=t.code;if(null!=t.info&&t.hasOwnProperty("info"))i.info=t.info;if(null!=t.instanceId&&t.hasOwnProperty("instanceId"))i.instanceId=t.instanceId;if(null!=t.pluginId&&t.hasOwnProperty("pluginId"))i.pluginId=t.pluginId;if(null!=t.roomId&&t.hasOwnProperty("roomId"))i.roomId=t.roomId;if(null!=t.inviteCode&&t.hasOwnProperty("inviteCode"))i.inviteCode=t.inviteCode;return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),Ema.PK1v1QuitRoomReq=function(){function e(t){if(t)for(var e=Object.keys(t),i=0;i<e.length;++i)if(null!=t[e[i]])this[e[i]]=t[e[i]]}return e.prototype.instanceId="",e.prototype.pluginId="",e.prototype.inviteCode="",e.create=function(t){return new e(t)},e.encode=function(t,e){if(!e)e=$Writer.create();return e.uint32(10).string(t.instanceId),e.uint32(18).string(t.pluginId),e.uint32(26).string(t.inviteCode),e},e.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},e.decode=function(t,e){if(!(t instanceof $Reader))t=$Reader.create(t);for(var i=void 0===e?t.len:t.pos+e,n=new $root.game.PK1v1QuitRoomReq;t.pos<i;){var r=t.uint32();switch(r>>>3){case 1:n.instanceId=t.string();break;case 2:n.pluginId=t.string();break;case 3:n.inviteCode=t.string();break;default:t.skipType(7&r)}}if(!n.hasOwnProperty("instanceId"))throw $util.ProtocolError("missing required 'instanceId'",{instance:n});if(!n.hasOwnProperty("pluginId"))throw $util.ProtocolError("missing required 'pluginId'",{instance:n});if(!n.hasOwnProperty("inviteCode"))throw $util.ProtocolError("missing required 'inviteCode'",{instance:n});return n},e.decodeDelimited=function(t){if(!(t instanceof $Reader))t=new $Reader(t);return this.decode(t,t.uint32())},e.verify=function(t){if("object"!==_typeof(t)||null===t)return"object expected";if(!$util.isString(t.instanceId))return"instanceId: string expected";if(!$util.isString(t.pluginId))return"pluginId: string expected";if(!$util.isString(t.inviteCode))return"inviteCode: string expected";else return null},e.fromObject=function(t){if(t instanceof $root.game.PK1v1QuitRoomReq)return t;var e=new $root.game.PK1v1QuitRoomReq;if(null!=t.instanceId)e.instanceId=String(t.instanceId);if(null!=t.pluginId)e.pluginId=String(t.pluginId);if(null!=t.inviteCode)e.inviteCode=String(t.inviteCode);return e},e.toObject=function(t,e){if(!e)e={};var i={};if(e.defaults)i.instanceId="",i.pluginId="",i.inviteCode="";if(null!=t.instanceId&&t.hasOwnProperty("instanceId"))i.instanceId=t.instanceId;if(null!=t.pluginId&&t.hasOwnProperty("pluginId"))i.pluginId=t.pluginId;if(null!=t.inviteCode&&t.hasOwnProperty("inviteCode"))i.inviteCode=t.inviteCode;return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),Ema.PK1v1QuitRoomResp=function(){function e(t){if(t)for(var e=Object.keys(t),i=0;i<e.length;++i)if(null!=t[e[i]])this[e[i]]=t[e[i]]}return e.prototype.code=0,e.prototype.info="",e.prototype.instanceId="",e.prototype.pluginId="",e.prototype.roomId="",e.create=function(t){return new e(t)},e.encode=function(t,e){if(!e)e=$Writer.create();return e.uint32(8).int32(t.code),e.uint32(18).string(t.info),e.uint32(26).string(t.instanceId),e.uint32(34).string(t.pluginId),e.uint32(42).string(t.roomId),e},e.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},e.decode=function(t,e){if(!(t instanceof $Reader))t=$Reader.create(t);for(var i=void 0===e?t.len:t.pos+e,n=new $root.game.PK1v1QuitRoomResp;t.pos<i;){var r=t.uint32();switch(r>>>3){case 1:n.code=t.int32();break;case 2:n.info=t.string();break;case 3:n.instanceId=t.string();break;case 4:n.pluginId=t.string();break;case 5:n.roomId=t.string();break;default:t.skipType(7&r)}}if(!n.hasOwnProperty("code"))throw $util.ProtocolError("missing required 'code'",{instance:n});if(!n.hasOwnProperty("info"))throw $util.ProtocolError("missing required 'info'",{instance:n});if(!n.hasOwnProperty("instanceId"))throw $util.ProtocolError("missing required 'instanceId'",{instance:n});if(!n.hasOwnProperty("pluginId"))throw $util.ProtocolError("missing required 'pluginId'",{instance:n});if(!n.hasOwnProperty("roomId"))throw $util.ProtocolError("missing required 'roomId'",{instance:n});return n},e.decodeDelimited=function(t){if(!(t instanceof $Reader))t=new $Reader(t);return this.decode(t,t.uint32())},e.verify=function(t){if("object"!==_typeof(t)||null===t)return"object expected";if(!$util.isInteger(t.code))return"code: integer expected";if(!$util.isString(t.info))return"info: string expected";if(!$util.isString(t.instanceId))return"instanceId: string expected";if(!$util.isString(t.pluginId))return"pluginId: string expected";if(!$util.isString(t.roomId))return"roomId: string expected";else return null},e.fromObject=function(t){if(t instanceof $root.game.PK1v1QuitRoomResp)return t;var e=new $root.game.PK1v1QuitRoomResp;if(null!=t.code)e.code=0|t.code;if(null!=t.info)e.info=String(t.info);if(null!=t.instanceId)e.instanceId=String(t.instanceId);if(null!=t.pluginId)e.pluginId=String(t.pluginId);if(null!=t.roomId)e.roomId=String(t.roomId);return e},e.toObject=function(t,e){if(!e)e={};var i={};if(e.defaults)i.code=0,i.info="",i.instanceId="",i.pluginId="",i.roomId="";if(null!=t.code&&t.hasOwnProperty("code"))i.code=t.code;if(null!=t.info&&t.hasOwnProperty("info"))i.info=t.info;if(null!=t.instanceId&&t.hasOwnProperty("instanceId"))i.instanceId=t.instanceId;if(null!=t.pluginId&&t.hasOwnProperty("pluginId"))i.pluginId=t.pluginId;if(null!=t.roomId&&t.hasOwnProperty("roomId"))i.roomId=t.roomId;return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),Ema.PK1v1RoomNumberNoti=function(){function e(t){if(t)for(var e=Object.keys(t),i=0;i<e.length;++i)if(null!=t[e[i]])this[e[i]]=t[e[i]]}return e.prototype.code=0,e.prototype.info="",e.prototype.instanceId="",e.prototype.pluginId="",e.prototype.roomId="",e.prototype.roomNumber=0,e.create=function(t){return new e(t)},e.encode=function(t,e){if(!e)e=$Writer.create();return e.uint32(8).int32(t.code),e.uint32(18).string(t.info),e.uint32(26).string(t.instanceId),e.uint32(34).string(t.pluginId),e.uint32(42).string(t.roomId),e.uint32(48).int32(t.roomNumber),e},e.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},e.decode=function(t,e){if(!(t instanceof $Reader))t=$Reader.create(t);for(var i=void 0===e?t.len:t.pos+e,n=new $root.game.PK1v1RoomNumberNoti;t.pos<i;){var r=t.uint32();switch(r>>>3){case 1:n.code=t.int32();break;case 2:n.info=t.string();break;case 3:n.instanceId=t.string();break;case 4:n.pluginId=t.string();break;case 5:n.roomId=t.string();break;case 6:n.roomNumber=t.int32();break;default:t.skipType(7&r)}}if(!n.hasOwnProperty("code"))throw $util.ProtocolError("missing required 'code'",{instance:n});if(!n.hasOwnProperty("info"))throw $util.ProtocolError("missing required 'info'",{instance:n});if(!n.hasOwnProperty("instanceId"))throw $util.ProtocolError("missing required 'instanceId'",{instance:n});if(!n.hasOwnProperty("pluginId"))throw $util.ProtocolError("missing required 'pluginId'",{instance:n});if(!n.hasOwnProperty("roomId"))throw $util.ProtocolError("missing required 'roomId'",{instance:n});if(!n.hasOwnProperty("roomNumber"))throw $util.ProtocolError("missing required 'roomNumber'",{instance:n});return n},e.decodeDelimited=function(t){if(!(t instanceof $Reader))t=new $Reader(t);return this.decode(t,t.uint32())},e.verify=function(t){if("object"!==_typeof(t)||null===t)return"object expected";if(!$util.isInteger(t.code))return"code: integer expected";if(!$util.isString(t.info))return"info: string expected";if(!$util.isString(t.instanceId))return"instanceId: string expected";if(!$util.isString(t.pluginId))return"pluginId: string expected";if(!$util.isString(t.roomId))return"roomId: string expected";if(!$util.isInteger(t.roomNumber))return"roomNumber: integer expected";else return null},e.fromObject=function(t){if(t instanceof $root.game.PK1v1RoomNumberNoti)return t;var e=new $root.game.PK1v1RoomNumberNoti;if(null!=t.code)e.code=0|t.code;if(null!=t.info)e.info=String(t.info);if(null!=t.instanceId)e.instanceId=String(t.instanceId);if(null!=t.pluginId)e.pluginId=String(t.pluginId);if(null!=t.roomId)e.roomId=String(t.roomId);if(null!=t.roomNumber)e.roomNumber=0|t.roomNumber;return e},e.toObject=function(t,e){if(!e)e={};var i={};if(e.defaults)i.code=0,i.info="",i.instanceId="",i.pluginId="",i.roomId="",i.roomNumber=0;if(null!=t.code&&t.hasOwnProperty("code"))i.code=t.code;if(null!=t.info&&t.hasOwnProperty("info"))i.info=t.info;if(null!=t.instanceId&&t.hasOwnProperty("instanceId"))i.instanceId=t.instanceId;if(null!=t.pluginId&&t.hasOwnProperty("pluginId"))i.pluginId=t.pluginId;if(null!=t.roomId&&t.hasOwnProperty("roomId"))i.roomId=t.roomId;if(null!=t.roomNumber&&t.hasOwnProperty("roomNumber"))i.roomNumber=t.roomNumber;return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),Ema.PK1v1CancelReadyPKNoti=function(){function e(t){if(t)for(var e=Object.keys(t),i=0;i<e.length;++i)if(null!=t[e[i]])this[e[i]]=t[e[i]]}return e.prototype.instanceId="",e.prototype.pluginId="",e.prototype.roomId="",e.prototype.senderId="",e.create=function(t){return new e(t)},e.encode=function(t,e){if(!e)e=$Writer.create();return e.uint32(10).string(t.instanceId),e.uint32(18).string(t.pluginId),e.uint32(26).string(t.roomId),e.uint32(34).string(t.senderId),e},e.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},e.decode=function(t,e){if(!(t instanceof $Reader))t=$Reader.create(t);for(var i=void 0===e?t.len:t.pos+e,n=new $root.game.PK1v1CancelReadyPKNoti;t.pos<i;){var r=t.uint32();switch(r>>>3){case 1:n.instanceId=t.string();break;case 2:n.pluginId=t.string();break;case 3:n.roomId=t.string();break;case 4:n.senderId=t.string();break;default:t.skipType(7&r)}}if(!n.hasOwnProperty("instanceId"))throw $util.ProtocolError("missing required 'instanceId'",{instance:n});if(!n.hasOwnProperty("pluginId"))throw $util.ProtocolError("missing required 'pluginId'",{instance:n});if(!n.hasOwnProperty("roomId"))throw $util.ProtocolError("missing required 'roomId'",{instance:n});if(!n.hasOwnProperty("senderId"))throw $util.ProtocolError("missing required 'senderId'",{instance:n});return n},e.decodeDelimited=function(t){if(!(t instanceof $Reader))t=new $Reader(t);return this.decode(t,t.uint32())},e.verify=function(t){if("object"!==_typeof(t)||null===t)return"object expected";if(!$util.isString(t.instanceId))return"instanceId: string expected";if(!$util.isString(t.pluginId))return"pluginId: string expected";if(!$util.isString(t.roomId))return"roomId: string expected";if(!$util.isString(t.senderId))return"senderId: string expected";else return null},e.fromObject=function(t){if(t instanceof $root.game.PK1v1CancelReadyPKNoti)return t;var e=new $root.game.PK1v1CancelReadyPKNoti;if(null!=t.instanceId)e.instanceId=String(t.instanceId);if(null!=t.pluginId)e.pluginId=String(t.pluginId);if(null!=t.roomId)e.roomId=String(t.roomId);if(null!=t.senderId)e.senderId=String(t.senderId);return e},e.toObject=function(t,e){if(!e)e={};var i={};if(e.defaults)i.instanceId="",i.pluginId="",i.roomId="",i.senderId="";if(null!=t.instanceId&&t.hasOwnProperty("instanceId"))i.instanceId=t.instanceId;if(null!=t.pluginId&&t.hasOwnProperty("pluginId"))i.pluginId=t.pluginId;if(null!=t.roomId&&t.hasOwnProperty("roomId"))i.roomId=t.roomId;if(null!=t.senderId&&t.hasOwnProperty("senderId"))i.senderId=t.senderId;return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),Ema);var __extends=(U3a=function(t,e){return(U3a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]})(t,e)},function(t,e){function i(){this.constructor=t}U3a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),U3a,__assign=function(){return(__assign=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var r in e=arguments[i])if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r];return t}).apply(this,arguments)},xf,xf,xf,xf,xf,xf,xf,xf,xf,xf;function _typeof(t){if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator)_typeof=function(t){return typeof t};else _typeof=function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};return _typeof(t)}function _typeof(t){if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator)_typeof=function(t){return typeof t};else _typeof=function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};return _typeof(t)}!function(xf){xf.RAD_TO_DEG=180/Math.PI,xf.DEG_TO_RAD=Math.PI/180;for(var e={},i={},t=0;t<360;t++)e[t]=Math.sin(t*xf.DEG_TO_RAD),i[t]=Math.cos(t*xf.DEG_TO_RAD);e[90]=1,i[90]=0,e[180]=0,i[180]=-1,e[270]=-1,i[270]=0,xf.canvasPool=[],xf.clipImage=function(t,e,i,n,r){var o=this.createCanvas(n,r),s=o.getContext("2d");return s.save(),s.drawImage(t,e,i,n,r,0,0,n,r),s.restore(),o},xf.checkTouchable=function(t,e,i){if(!t.type.runtime.is_catch_event)return!1;var n=t.layer;if(n&&n.visible)if(!n.checkTouchable(t,e,i))return!1;else{for(var r=n.layout.layers,o=n.index+1,s=r.length;o<s;o++){if(r[o].getFirstTouch(e,i))return!1}return!0}else return!1},xf.formatString=function(t,e){if(t){for(var i=/\{[0-9]+?\}/;t.match(i);){var n=t.match(i)[0].match(/[0-9]+?/);t=t.replace(i,e[parseInt(n[0])])}return t}return""},xf.loadTextures=function(t){var e=t.runtime;if(!t.is_family&&e.glwrap){var i=t.all_frames;if(i&&!t.has_loaded_textures){for(var n=0,r=i.length;n<r;n++){var o=i[n];if(o){if(t.isAnimations&&!o.texture_img){e.sectionAlert(t.name);continue}o.webGL_texture=e.glwrap.loadTexture(o.texture_img,!1,e.linearSampling,o.pixelformat),xf.updateFrameUV(o)}}t.has_loaded_textures=!0}if(t.isTexture&&!t.texture_img)e.sectionAlert(t.name);if(t.texture_img&&!t.webGL_texture)t.webGL_texture=e.glwrap.loadTexture(t.texture_img,!0,e.linearSampling,t.texture_pixelformat)}},xf.testTypeImage=function(t){var e=t.runtime,i=t.animations;if(t.isAnimations&&i&&0<i.length&&!i[0].frames)e.sectionAlert(t.name);if(t.isTexture&&!t.texture_img)e.sectionAlert(t.name)},xf.unloadTextures=function(t){var e=t.runtime;if(!t.is_family&&!t.instances.length){var i=t.all_frames;if(i&&t.has_loaded_textures){for(var n=0,r=i.length;n<r;n++){var o=i[n];if(o)e.glwrap.deleteTexture(o.webGL_texture),o.webGL_texture=null}t.has_loaded_textures=!1}if(t.webGL_texture)e.glwrap.deleteTexture(t.webGL_texture),t.webGL_texture=null}},xf.preloadCanvas2D=function(t,e){var i=t.all_frames;if(i){if(t.m_preDrawImages)drama.clearArray(t.m_preDrawImages);else t.m_preDrawImages=[];for(var n=0,r=i.length;n<r;n++){var o=i[n];if(o){var s=o.texture_img;if(-1!==t.m_preDrawImages.indexOf(s))continue;e.drawImage(s,0,0),t.m_preDrawImages.push(s)}}}if(t.texture_img)e.drawImage(t.texture_img,0,0)},xf.formatAnimation=function(s){var t=s.animations;if(t){for(var a=[],e={},i=0,n=t.length;i<n;i++){var r=l.format(t[i],a);e[(t[i]=r).name]=r}s.animationMap=e;var o=function(t,e){var i=a[t];if(i){var n=i.texture_file,r=i.texture_filesize,o=window.xfHost.get({url:n});if(o)o.cr_src=n,o.cr_filesize=r,i.texture_img=o;else i.xf_src=n,i.xf_filesize=r,s.runtime.xfPreloadGroup.push(n,function(e){s.all_frames.map(function(t){if(!t.texture_img||t.xf_src==n&&t.xf_filesize==r)t.texture_img=e[n],t.texture_img.cr_src=n,t.texture_img.cr_filesize=r,t.texture_img.c2webGL_texture=null})})}};for(i=0,n=a.length;i<n;i++)o(i);s.all_frames=a}},xf.updateFrameUV=function(t){if(0===t.width)t.width=t.texture_img.width,t.height=t.texture_img.height;if(t.spritesheeted){var e=t.texture_img,i=t.sheetTex;if(i.left=t.offx/e.width,i.top=t.offy/e.height,i.right=(t.offx+t.width)/e.width,i.bottom=(t.offy+t.height)/e.height,0===t.offx&&0===t.offy&&t.width===e.width&&t.height===e.height)t.spritesheeted=!1}},xf.getAnimationByName=function(t,e){var i=t.animations;if(i)for(var n=0,r=i.length;n<r;n++){var o=i[n];if(drama.equals_nocase(o.name,e))return o}return null},xf.createImage=function(t,e,i){var n=t.findWaitingTexture(e);if(n)return n;else(n=new Image).cr_src=e,n.cr_filesize=i,n.crossOrigin="anonymous",t.waitForImageLoad(n,e);return n},xf.createImageLoader=function(n){return new Promise(function(t,e){var i=new Image;i.crossOrigin="anonymous",i.onload=function(){t(i)},i.onerror=function(t){e(t)},i.src=n})},xf.drawImage=function(t,e,i,n,r,o,s,a){s=s||1,a=a||0;var l=(t=t||2048)+2*(o=o||0)+2*(n=n||0),c=(e=e||2048)+2*o+2*n,u=xf.createCanvas(l,c),h=u.getContext("2d");if(h.save(),h.globalAlpha=s,h.lineJoin="round",xf.radiusRect(h,o+n,o+n,t,e,a),0<n)h.strokeStyle=r,h.lineWidth=n,h.stroke();if(o)h.shadowColor="rgba(0, 0, 0, 0.14)",h.shadowBlur=o;return h.fillStyle=i,h.fill(),h.restore(),u},xf.drawGLImage=function(t,e,i,n,r){if(t.setTexture(e),t.setOpacity(i),r)t.quadTex(n.tlx,n.tly,n.trx,n.try,n.brx,n.bry,n.blx,n.bly,r);else t.quad(n.tlx,n.tly,n.trx,n.try,n.brx,n.bry,n.blx,n.bly)},xf.createCanvas=function(t,e){var i=xf.canvasPool.pop();if(!i)i=document.createElement("canvas");return i.width=t||0,i.height=e||0,i},xf.recoverCanvas=function(t){if(t)xf.canvasPool.push(t)},xf.deleteTexture=function(t){var e=window.xfruntime;if(e.enableWebGL&&t)e.glwrap.deleteTexture(t)},xf.getAngle=function(t){if(t){var e=t.angle,i=t.layer,n=i.layout;return e+i.angle+n.angle}return 0},xf.getLastTouch=function(t){var e={pageX:0,pageY:0};if(t){var i=t.changedTouches;if(i){for(var n=0,r=i.length;n<r;n++){var o=i[n],s=drama.convertPageXY(o.pageX,o.pageY);e.pageX=s.pageX,e.pageY=s.pageY}return e}}return e},xf.getFirstTouch=function(t){var e={pageX:0,pageY:0};if(t){var i=t.changedTouches;if(i&&i.length){var n=i[0],r=drama.convertPageXY(n.pageX,n.pageY);return e.pageX=r.pageX,e.pageY=r.pageY,e}}return e},xf.pageToGlobal=function(t,e){var i=drama.convertPageXY(t,e);t=i.pageX,e=i.pageY;var n=window.xfruntime,r=n.canvas.offsetLeft,o=n.canvas.offsetTop,s=n.devicePixelRatio,a=n.aspect_scale;return{x:(t-r)*s/a,y:(e-o)*s/a}};var l=function(){function a(){}return a.format=function(t,e){var i=new a;i.name=t[0],i.speed=t[1],i.loop=t[2],i.repeatcount=t[3],i.repeatto=t[4],i.pingpong=t[5],i.sid=t[6],i.frames=[];for(var n=t[7],r=0,o=n.length;r<o;r++){var s=c.format(n[r]);if(i.frames.push(s),e)e.push(s)}return i},a}();xf.AnimationData=l;var c=function(){function i(){this.sheetTex=o.create(0,0,1,1)}return i.prototype.getDataUri=function(){if(0===this.datauri.length){var t=document.createElement("canvas");t.width=this.width,t.height=this.height;var e=t.getContext("2d");if(this.spritesheeted)e.drawImage(this.texture_img,this.offx,this.offy,this.width,this.height,0,0,this.width,this.height);else e.drawImage(this.texture_img,0,0,this.width,this.height);this.datauri=t.toDataURL("image/png")}return this.datauri},i.format=function(t){var e=new i;return e.texture_file=t[0],e.texture_filesize=t[1],e.offx=t[2],e.offy=t[3],e.width=t[4],e.height=t[5],e.duration=t[6],e.hotspotX=t[7],e.hotspotY=t[8],e.image_points=t[9],e.poly_pts=t[10],e.pixelformat=t[11],e.spritesheeted=0!==e.width,e.datauri="",e},i}();xf.FrameData=c;var r=function(){function r(){this.x=0,this.y=0,this.z=0}return r.prototype.setTo=function(t,e,i){if(void 0===i)i=0;return this.x=t,this.y=e,this.z=i,this},r.prototype.equal=function(t){return this.x===t.x&&this.y===t.y&&this.z===t.z},r.create=function(t,e,i){var n=new r;return n.x=t||0,n.y=e||0,n.z=i||0,n},r}(),T=function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t.flag=0,t}return __extends(n,e),n.create=function(t,e){var i=new n;return i.x=t||0,i.y=e||0,i.flag=0,i},n}(xf.Point=r);xf.flagPoint=T;var n=function(){function r(t,e,i,n){if(void 0===t)t=0;if(void 0===e)e=0;if(void 0===i)i=0;if(void 0===n)n=0;this.x=t,this.y=e,this.width=i,this.height=n}return r.create=function(t,e,i,n){if(void 0===t)t=0;if(void 0===e)e=0;if(void 0===i)i=0;if(void 0===n)n=0;if(r.s_pool.length)return r.s_pool.pop().setTo(t,e,i,n);else return new r(t,e,i,n)},r.prototype.destory=function(){r.s_pool.push(this)},r.prototype.formbbox=function(t,e,i,n){return this.x=t,this.y=i,this.width=e-t,this.height=n-i,this},Object.defineProperty(r.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"left",{get:function(){return this.x},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"top",{get:function(){return this.y},enumerable:!0,configurable:!0}),r.prototype.copyFrom=function(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this},r.prototype.setTo=function(t,e,i,n){return this.x=t,this.y=e,this.width=i,this.height=n,this},r.prototype.contains=function(t,e){return this.x<=t&&this.x+this.width>=t&&this.y<=e&&this.y+this.height>=e},r.prototype.intersection=function(t){return this.clone().$intersectInPlace(t)},r.prototype.inflate=function(t,e){this.x-=t,this.width+=2*t,this.y-=e,this.height+=2*e},r.prototype.$intersectInPlace=function(t){var e=this.x,i=this.y,n=t.x,r=t.y,o=Math.max(e,n),s=Math.min(e+this.width,n+t.width);if(o<=s){var a=Math.max(i,r),l=Math.min(i+this.height,r+t.height);if(a<=l)return this.setTo(o,a,s-o,l-a),this}return this.setEmpty(),this},r.prototype.intersects=function(t){return Math.max(this.x,t.x)<=Math.min(this.right,t.right)&&Math.max(this.y,t.y)<=Math.min(this.bottom,t.bottom)},r.prototype.isEmpty=function(){return this.width<=0||this.height<=0},r.prototype.setEmpty=function(){this.x=0,this.y=0,this.width=0,this.height=0},r.prototype.clone=function(){return r.create(this.x,this.y,this.width,this.height)},r.prototype.containsPoint=function(t){if(this.x<=t.x&&this.x+this.width>t.x&&this.y<=t.y&&this.y+this.height>t.y)return!0;else return!1},r.prototype.containsRect=function(t){var e=t.x+t.width,i=t.y+t.height,n=this.x+this.width,r=this.y+this.height;return t.x>=this.x&&t.x<n&&t.y>=this.y&&t.y<r&&e>this.x&&e<=n&&i>this.y&&i<=r},r.prototype.equals=function(t){if(this===t)return!0;else return this.x===t.x&&this.y===t.y&&this.width===t.width&&this.height===t.height},r.prototype.inflatePoint=function(t){this.inflate(t.x,t.y)},r.prototype.offset=function(t,e){this.x+=t,this.y+=e},r.prototype.offsetPoint=function(t){this.offset(t.x,t.y)},r.prototype.toString=function(){return"(x="+this.x+", y="+this.y+", width="+this.width+", height="+this.height+")"},r.prototype.union=function(t){var e=this.clone();if(t.isEmpty())return e;if(e.isEmpty())return e.copyFrom(t),e;var i=Math.min(e.x,t.x),n=Math.min(e.y,t.y);return e.setTo(i,n,Math.max(e.right,t.right)-i,Math.max(e.bottom,t.bottom)-n),e},r.prototype.appendPoint=function(t,e){for(var i=0,n=t.length;i<n;i++){var r=t[i];if(r.equal(e))return void(r.flag=e.flag)}t.push(e)},r.prototype.appendPointToRect=function(t,e){for(var i=0,n=t.length;i<n;i++){var r=t[i],o=t[(i+1)%n];if(r.equal(e))return void(r.flag=e.flag);if(o.equal(e))return void(o.flag=e.flag);if(r.x===o.x&&e.x===r.x){if(0===r.x){if(e.y<o.y)return void t.splice(i+1,0,e)}else if(e.y>o.y)return void t.splice(i+1,0,e)}else if(r.y===o.y&&e.y===r.y)if(0===r.y){if(e.x>o.x)return void t.splice(i+1,0,e)}else if(e.x<o.x)return void t.splice(i+1,0,e)}},r.prototype.checkPoint=function(t,e){for(var i=0,n=e.length;i<n;i++)for(var r=e[i],o=0,s=r.length;o<s;o++)if(t.x===r[o]&&t.y===r[o+1])return!0;return!1},r.prototype.clipPolys=function(t,e,i,n){if(!this.checkPoint(t,n))for(var r=[],o=void 0;;){for(var s=0,a=r.length;s<a;s+=2)if(r[s]===t.x&&r[s+1]===t.y)return void n.push(r);if(r.push(t.x,t.y),1===t.flag)o=e;else if(-1===t.flag)o=i;for(s=0,a=o.length;s<a;s++){if(o[s].equal(t)){t=o[(s+1)%o.length];break}}}},r.prototype.polygonClip=function(b){for(var _=[0,0,0,this.height,this.width,this.height,this.width,0],w=[],x=[],S=[],t=function(t,e){var i=b[t]>>0,n=b[t+1]>>0,r=b[(t+2)%e]>>0,o=b[(t+3)%e]>>0,s=T.create(i,n),a=T.create(r,o);I.appendPoint(x,s);for(var l=[],c=0,u=_.length;c<u;c+=2){var h=_[c],d=_[c+1],p=_[(c+2)%u],f=_[(c+3)%u],m=T.create(h,d),g=T.create(p,f);if(S.length<.5*u)S.push(m);var y=drama.segments_intersect_point(s,a,m,g);if(y&&!y.equal(s)&&!y.equal(a)){var v=(p-i)*(y.y-n)-(y.x-i)*(f-n);if(0<v)y.flag=-1;else if(v<0)y.flag=1;I.appendPoint(w,y),l.push(y)}}if(0<l.length)if(1<l.length)l.sort(function(t,e){return Math.pow(t.x-i,2)+Math.pow(t.y-n,2)-(Math.pow(e.x-i,2)+Math.pow(e.y-n,2))}),l.forEach(function(t,e){x.push(t)});else I.appendPoint(x,l[0])},I=this,e=0,i=b.length;e<i;e+=2)t(e,i);for(var n=0,r=w;n<r.length;n++){var o=r[n];this.appendPointToRect(S,o)}var s=[];for(e=0,i=w.length;e<i;e++){if(-1===(o=w[e]).flag)this.clipPolys(o,x,S,s)}return s},r.prototype.round=function(){var t=this.clone();return t.x=t.x>>0,t.y=t.y>>0,t.width=t.width>>0,t.height=t.height>>0,t},r.s_pool=[],r}();xf.Rect=n;var o=function(){function o(){}return o.create=function(t,e,i,n){var r=new o;return r.left=t,r.right=i,r.top=e,r.bottom=n,r},o}();xf.UV=o;var s,a=function(){function c(){}return c.create=function(t,e,i,n,r,o,s,a){var l=new c;return l.tlx=t,l.tly=e,l.trx=i,l.try=n,l.blx=r,l.bly=o,l.brx=s,l.bry=a,l},c.createByRect=function(t,e,i,n){var r=new c;return r.tlx=t,r.tly=e,r.trx=t+i,r.try=e,r.blx=t,r.bly=e+n,r.brx=t+i,r.bry=e+n,r},c.prototype.updateByRect=function(t,e,i,n){return this.tlx=t,this.tly=e,this.trx=t+i,this.try=e,this.blx=t,this.bly=e+n,this.brx=t+i,this.bry=e+n,this},c.prototype.calculateVertices=function(t,e){var i=r.create(),n=r.create();if(!e)e=new c;return t.apply(i.setTo(this.x,this.y),n),e.tlx=n.x,e.tly=n.y,t.apply(i.setTo(this.x+this.width,this.y),n),e.trx=n.x,e.try=n.y,t.apply(i.setTo(this.x,this.y+this.height),n),e.blx=n.x,e.bly=n.y,t.apply(i.setTo(this.x+this.width,this.y+this.height),n),e.brx=n.x,e.bry=n.y,e},Object.defineProperty(c.prototype,"x",{get:function(){return Math.min(this.tlx,this.trx,this.blx,this.brx)},set:function(t){this.tlx=t,this.blx=t},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"y",{get:function(){return Math.min(this.tly,this.try,this.bly,this.bry)},set:function(t){this.tly=t,this.try=t},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"width",{get:function(){return Math.max(this.tlx,this.trx,this.blx,this.brx)-this.x},set:function(t){this.trx=this.tlx+t,this.brx=this.blx+t},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"height",{get:function(){return Math.max(this.tly,this.try,this.bly,this.bry)-this.y},set:function(t){this.bly=this.tly+t,this.bry=this.try+t},enumerable:!0,configurable:!0}),c.prototype.contains=function(t,e){return t>this.x&&t<this.x+this.width&&e>this.y&&e<this.y+this.height},c}();xf.Quad=a,xf.pt2px=function(t){return Math.ceil(t/72*96)},xf.hexaDecimal=function(t,e){if(void 0===e)e=!1;if("[object Array]"!=Object.prototype.toString.call(t))return e?"#ffffffff":"#ffffff";var i=Math.round(255*t[0]).toString(16),n=Math.round(255*t[1]).toString(16),r=Math.round(255*t[2]).toString(16),o="";if(1===i.length)i="0"+i;if(1===n.length)n="0"+n;if(1===r.length)r="0"+r;if(e&&4===t.length)o=1===(o=Math.round(255*t[3]).toString(16)).length?"0"+o:o;return"#"+i+n+r+o},xf.sizeOfUTF8Str=function(t,e){var i,n=0;if("utf-16"===e)for(var r=0;r<t.length;r++)if((i=t.charCodeAt(r))<=65535)n+=2;else n+=4;else for(r=0;r<t.length;r++)if(0<=(i=t.charCodeAt(r))&&i<=127)n+=1;else if(128<=i&&i<=2047)n+=2;else if(2048<=i&&i<=65535)n+=3;else if(65536<i&&i<=2097151)n+=4;else if(2097152<i&&i<=67108863)n+=5;else if(67108864<i&&i<=2147483647)n+=6;return n},xf.getStringLength=function(t){for(var e=0,i=0;i<t.length;i++){var n=t.charCodeAt(i);if(0<=n&&n<=128)e+=1;else e+=2}return e},xf.queryString=function(t,e){t=t.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var i=new RegExp("[\\?&]"+t+"=([^&#]*)").exec(location.search),n=null;if(null===i)return"";else if(n=i[1].replace(/\+/g," "),e)return n;else return decodeURIComponent(n)},xf.parseQuery=function(t){var e={};if("string"!=typeof t)t=window.location.search;if(!(t=t.replace(/^\?/g,"")))return{};for(var i,n=t.split("&"),r=0;r<n.length;++r){if((i=n[r].indexOf("="))<0)i=n[r].length;e[decodeURIComponent(n[r].slice(0,i))]=decodeURIComponent(n[r].slice(i+1))}return e},xf.stringify=function(e,i){if(!e||e.constructor!==Object)throw new Error("Query object should be an object.");var n="";return Object.keys(e).forEach(function(t){if(void 0!==e[t])if(i)n+=t+"="+encodeURIComponent(e[t])+"&";else n+=t+"="+e[t]+"&"}),n=n.replace(/\&$/g,"")},(s=xf.Orientation||(xf.Orientation={})).LANDSCAPE="landscape",s.PORTRAIT="portrait",xf.checkOrientation=function(){if(void 0!==window.orientation&&!window.xfruntime.isCordova)if(0==window.orientation||180==window.orientation)return"portrait";else return"landscape";return window.innerWidth>window.innerHeight?"landscape":"portrait"},xf.simulator_ratio=function(t){return t*window.devicePixelRatio},xf.constructPoly=function(t,e,i,n){for(var r=t.concat(),o=0,s=r.length;o<s;o+=2)r[o]/=e,r[o+1]/=i;var a=new drama.CollisionPoly(r);return a.cache_poly(e,i,n),a},xf.formatDate=function(t,e){var i={"M+":t.getMonth()+1,"d+":t.getDate(),"h+":t.getHours(),"m+":t.getMinutes(),"s+":t.getSeconds(),"q+":Math.floor((t.getMonth()+3)/3),S:t.getMilliseconds()};if(/(y+)/.test(e))e=e.replace(RegExp.$1,(t.getFullYear()+"").substr(4-RegExp.$1.length));for(var n in i)if(new RegExp("("+n+")").test(e))e=e.replace(RegExp.$1,1==RegExp.$1.length?i[n]:("00"+i[n]).substr((""+i[n]).length));return e},xf.radiusRect=function(t,e,i,n,r,o){Math.PI,t.beginPath(),t.arc(e+n-o,i+r-o,o,0,Math.PI/2),t.lineTo(e+o,i+r),t.arc(e+o,i+r-o,o,Math.PI/2,Math.PI),t.lineTo(e,i+o),t.arc(e+o,i+o,o,Math.PI,3*Math.PI/2),t.lineTo(e+n-o,i),t.arc(e+n-o,i+o,o,3*Math.PI/2,2*Math.PI),t.lineTo(e+n,i+r-o),t.closePath()};var u=function(){function r(){}return r.isNumber=function(t){return"number"==typeof t&&!isNaN(t)},r.sin=function(t){var e=Math.floor(t),i=e+1,n=r.sinInt(e);if(e==t)return n;else return(t-e)*r.sinInt(i)+(i-t)*n},r.sinInt=function(t){if((t%=360)<0)t+=360;return e[t]},r.cos=function(t){var e=Math.floor(t),i=e+1,n=r.cosInt(e);if(e==t)return n;else return(t-e)*r.cosInt(i)+(i-t)*n},r.cosInt=function(t){if((t%=360)<0)t+=360;return i[t]},r.convertStringToHashCode=function(t){if(0===t.length)return 0;for(var e=0,i=0,n=t.length;i<n;++i){e=(e<<5)-e+t.charCodeAt(i),e|=0}return e},r}();xf.NumberUtils=u,xf.awaitTo=function(t,e){return t.then(function(t){return[null,t]}).catch(function(t){if(e)t=__assign({},t,e);return[t,void 0]})};var h,d,p,f=!(xf.isIpad=function(){var t=window.navigator.userAgent;if(-1<t.toLowerCase().indexOf("ipad"))return!0;if(-1<t.indexOf("Macintosh"))try{return document.createEvent("TouchEvent"),!0}catch(t){}return!1}),m=!1;function g(t){var e=new Image;e.src="https://www.baidu.com/favicon.ico?_t="+Date.now(),e.onload=function(){t(!0)},e.onerror=function(){t(!1)}}xf.getSupportsPassive=function(){if(f)return m;try{var t=Object.defineProperty({},"passive",{get:function(){m=!0}});window.addEventListener("test",null,t)}catch(t){}return f=!0,m},(h=xf.Platform||(xf.Platform={}))[h.Android=1]="Android",h[h.iOS=2]="iOS",h[h.OSX=4]="OSX",h[h.Browser=8]="Browser",h[h.microApp=16]="microApp",h[h.Windows=32]="Windows",(d=xf.gameExportType||(xf.gameExportType={}))[d.Preview=0]="Preview",d[d.Game=1]="Game",(p=xf.PayType||(xf.PayType={}))[p.AliPay=1]="AliPay",p[p.WXPay=2]="WXPay",p[p.ApplePay=3]="ApplePay",p[p.Sandbox=4]="Sandbox",xf.isOnline=function(){if(navigator.onLine)return Promise.resolve(!0);var t=navigator,e=t.connection||t.mozConnection||t.webkitConnecttion;if(e&&0<e.rrt)return Promise.resolve(!0);else return new Promise(g)}}(xf||(xf={})),function(i){var n={};function r(t){if(n[t])return n[t].exports;var e=n[t]={i:t,l:!1,exports:{}};return i[t].call(e.exports,e,e.exports,r),e.l=!0,e.exports}r.m=i,r.c=n,r.d=function(t,e,i){if(!r.o(t,e))Object.defineProperty(t,e,{enumerable:!0,get:i})},r.r=function(t){if("undefined"!=typeof Symbol&&Symbol.toStringTag)Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(e,t){if(1&t)e=r(e);if(8&t)return e;if(4&t&&"object"===_typeof(e)&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(i,n,function(t){return e[t]}.bind(null,n));return i},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s="d8a6e6e590e85ade")}({"0ee4763173a9a955":function(t,e){var i;i=function(){return this}();try{i=i||new Function("return this")()}catch(t){if("object"===(void 0===window?"undefined":_typeof(window)))i=window}t.exports=i},"53484a302ce1864e":function(t,e,i){t.exports={ach:{name:"Acholi",examples:[{plural:0,sample:1},{plural:1,sample:2}],nplurals:2,pluralsText:"nplurals = 2; plural = (n > 1)",pluralsFunc:function(t){return 1<t}},af:{name:"Afrikaans",examples:[{plural:0,sample:1},{plural:1,sample:2}],nplurals:2,pluralsText:"nplurals = 2; plural = (n !== 1)",pluralsFunc:function(t){return 1!==t}},ak:{name:"Akan",examples:[{plural:0,sample:1},{plural:1,sample:2}],nplurals:2,pluralsText:"nplurals = 2; plural = (n > 1)",pluralsFunc:function(t){return 1<t}},am:{name:"Amharic",examples:[{plural:0,sample:1},{plural:1,sample:2}],nplurals:2,pluralsText:"nplurals = 2; plural = (n > 1)",pluralsFunc:function(t){return 1<t}},an:{name:"Aragonese",examples:[{plural:0,sample:1},{plural:1,sample:2}],nplurals:2,pluralsText:"nplurals = 2; plural = (n !== 1)",pluralsFunc:function(t){return 1!==t}},ar:{name:"Arabic",examples:[{plural:0,sample:0},{plural:1,sample:1},{plural:2,sample:2},{plural:3,sample:3},{plural:4,sample:11},{plural:5,sample:100}],nplurals:6,pluralsText:"nplurals = 6; plural = (n === 0 ? 0 : n === 1 ? 1 : n === 2 ? 2 : n % 100 >= 3 && n % 100 <= 10 ? 3 : n % 100 >= 11 ? 4 : 5)",pluralsFunc:function(t){return 0===t?0:1===t?1:2===t?2:3<=t%100&&t%100<=10?3:11<=t%100?4:5}},arn:{name:"Mapudungun",examples:[{plural:0,sample:1},{plural:1,sample:2}],nplurals:2,pluralsText:"nplurals = 2; plural = (n > 1)",pluralsFunc:function(t){return 1<t}},ast:{name:"Asturian",examples:[{plural:0,sample:1},{plural:1,sample:2}],nplurals:2,pluralsText:"nplurals = 2; plural = (n !== 1)",pluralsFunc:function(t){return 1!==t}},ay:{name:"Aymará",examples:[{plural:0,sample:1}],nplurals:1,pluralsText:"nplurals = 1; plural = 0",pluralsFunc:function(){return 0}},az:{name:"Azerbaijani",examples:[{plural:0,sample:1},{plural:1,sample:2}],nplurals:2,pluralsText:"nplurals = 2; plural = (n !== 1)",pluralsFunc:function(t){return 1!==t}},be:{name:"Belarusian",examples:[{plural:0,sample:1},{plural:1,sample:2},{plural:2,sample:5}],nplurals:3,pluralsText:"nplurals = 3; plural = (n % 10 === 1 && n % 100 !== 11 ? 0 : n % 10 >= 2 && n % 10 <= 4 && (n % 100 < 10 || n % 100 >= 20) ? 1 : 2)",pluralsFunc:function(t){return t%10==1&&t%100!=11?0:2<=t%10&&t%10<=4&&(t%100<10||20<=t%100)?1:2}},bg:{name:"Bulgarian",examples:[{plural:0,sample:1},{plural:1,sample:2}],nplurals:2,pluralsText:"nplurals = 2; plural = (n !== 1)",pluralsFunc:function(t){return 1!==t}},bn:{name:"Bengali",examples:[{plural:0,sample:1},{plural:1,sample:2}],nplurals:2,pluralsText:"nplurals = 2; plural = (n !== 1)",pluralsFunc:function(t){return 1!==t}},bo:{name:"Tibetan",examples:[{plural:0,sample:1}],nplurals:1,pluralsText:"nplurals = 1; plural = 0",pluralsFunc:function(){return 0}},br:{name:"Breton",examples:[{plural:0,sample:1},{plural:1,sample:2}],nplurals:2,pluralsText:"nplurals = 2; plural = (n > 1)",pluralsFunc:function(t){return 1<t}},brx:{name:"Bodo",examples:[{plural:0,sample:1},{plural:1,sample:2}],nplurals:2,pluralsText:"nplurals = 2; plural = (n !== 1)",pluralsFunc:function(t){return 1!==t}},bs:{name:"Bosnian",examples:[{plural:0,sample:1},{plural:1,sample:2},{plural:2,sample:5}],nplurals:3,pluralsText:"nplurals = 3; plural = (n % 10 === 1 && n % 100 !== 11 ? 0 : n % 10 >= 2 && n % 10 <= 4 && (n % 100 < 10 || n % 100 >= 20) ? 1 : 2)",pluralsFunc:function(t){return t%10==1&&t%100!=11?0:2<=t%10&&t%10<=4&&(t%100<10||20<=t%100)?1:2}},ca:{name:"Catalan",examples:[{plural:0,sample:1},{plural:1,sample:2}],nplurals:2,pluralsText:"nplurals = 2; plural = (n !== 1)",pluralsFunc:function(t){return 1!==t}},cgg:{name:"Chiga",examples:[{plural:0,sample:1}],nplurals:1,pluralsText:"nplurals = 1; plural = 0",pluralsFunc:function(){return 0}},cs:{name:"Czech",examples:[{plural:0,sample:1},{plural:1,sample:2},{plural:2,sample:5}],nplurals:3,pluralsText:"nplurals = 3; plural = (n === 1 ? 0 : (n >= 2 && n <= 4) ? 1 : 2)",pluralsFunc:function(t){return 1===t?0:2<=t&&t<=4?1:2}},csb:{name:"Kashubian",examples:[{plural:0,sample:1},{plural:1,sample:2},{plural:2,sample:5}],nplurals:3,pluralsText:"nplurals = 3; plural = (n === 1 ? 0 : n % 10 >= 2 && n % 10 <= 4 && (n % 100 < 10 || n % 100 >= 20) ? 1 : 2)",pluralsFunc:function(t){return 1===t?0:2<=t%10&&t%10<=4&&(t%100<10||20<=t%100)?1:2}},cy:{name:"Welsh",examples:[{plural:0,sample:1},{plural:1,sample:2},{plural:2,sample:3},{plural:3,sample:8}],nplurals:4,pluralsText:"nplurals = 4; plural = (n === 1 ? 0 : n === 2 ? 1 : (n !== 8 && n !== 11) ? 2 : 3)",pluralsFunc:function(t){return 1===t?0:2===t?1:8!==t&&11!==t?2:3}},da:{name:"Danish",examples:[{plural:0,sample:1},{plural:1,sample:2}],nplurals:2,pluralsText:"nplurals = 2; plural = (n !== 1)",pluralsFunc:function(t){return 1!==t}},de:{name:"German",examples:[{plural:0,sample:1},{plural:1,sample:2}],nplurals:2,pluralsText:"nplurals = 2; plural = (n !== 1)",pluralsFunc:function(t){return 1!==t}},doi:{name:"Dogri",examples:[{plural:0,sample:1},{plural:1,sample:2}],nplurals:2,pluralsText:"nplurals = 2; plural = (n !== 1)",pluralsFunc:function(t){return 1!==t}},dz:{name:"Dzongkha",examples:[{plural:0,sample:1}],nplurals:1,pluralsText:"nplurals = 1; plural = 0",pluralsFunc:function(){return 0}},el:{name:"Greek",examples:[{plural:0,sample:1},{plural:1,sample:2}],nplurals:2,pluralsText:"nplurals = 2; plural = (n !== 1)",pluralsFunc:function(t){return 1!==t}},en:{name:"English",examples:[{plural:0,sample:1},{plural:1,sample:2}],nplurals:2,pluralsText:"nplurals = 2; plural = (n !== 1)",pluralsFunc:function(t){return 1!==t}},eo:{name:"Esperanto",examples:[{plural:0,sample:1},{plural:1,sample:2}],nplurals:2,pluralsText:"nplurals = 2; plural = (n !== 1)",pluralsFunc:function(t){return 1!==t}},es:{name:"Spanish",examples:[{plural:0,sample:1},{plural:1,sample:2}],nplurals:2,pluralsText:"nplurals = 2; plural = (n !== 1)",pluralsFunc:function(t){return 1!==t}},et:{name:"Estonian",examples:[{plural:0,sample:1},{plural:1,sample:2}],nplurals:2,pluralsText:"nplurals = 2; plural = (n !== 1)",pluralsFunc:function(t){return 1!==t}},eu:{name:"Basque",examples:[{plural:0,sample:1},{plural:1,sample:2}],nplurals:2,pluralsText:"nplurals = 2; plural = (n !== 1)",pluralsFunc:function(t){return 1!==t}},fa:{name:"Persian",examples:[{plural:0,sample:1}],nplurals:1,pluralsText:"nplurals = 1; plural = 0",pluralsFunc:function(){return 0}},ff:{name:"Fulah",examples:[{plural:0,sample:1},{plural:1,sample:2}],nplurals:2,pluralsText:"nplurals = 2; plural = (n !== 1)",pluralsFunc:function(t){return 1!==t}},fi:{name:"Finnish",examples:[{plural:0,sample:1},{plural:1,sample:2}],nplurals:2,pluralsText:"nplurals = 2; plural = (n !== 1)",pluralsFunc:function(t){return 1!==t}},fil:{name:"Filipino",examples:[{plural:0,sample:1},{plural:1,sample:2}],nplurals:2,pluralsText:"nplurals = 2; plural = (n > 1)",pluralsFunc:function(t){return 1<t}},fo:{name:"Faroese",examples:[{plural:0,sample:1},{plural:1,sample:2}],nplurals:2,pluralsText:"nplurals = 2; plural = (n !== 1)",pluralsFunc:function(t){return 1!==t}},fr:{name:"French",examples:[{plural:0,sample:1},{plural:1,sample:2}],nplurals:2,pluralsText:"nplurals = 2; plural = (n > 1)",pluralsFunc:function(t){return 1<t}},fur:{name:"Friulian",examples:[{plural:0,sample:1},{plural:1,sample:2}],nplurals:2,pluralsText:"nplurals = 2; plural = (n !== 1)",pluralsFunc:function(t){return 1!==t}},fy:{name:"Frisian",examples:[{plural:0,sample:1},{plural:1,sample:2}],nplurals:2,pluralsText:"nplurals = 2; plural = (n !== 1)",pluralsFunc:function(t){return 1!==t}},ga:{name:"Irish",examples:[{plural:0,sample:1},{plural:1,sample:2},{plural:2,sample:3},{plural:3,sample:7},{plural:4,sample:11}],nplurals:5,pluralsText:"nplurals = 5; plural = (n === 1 ? 0 : n === 2 ? 1 : n < 7 ? 2 : n < 11 ? 3 : 4)",pluralsFunc:function(t){return 1===t?0:2===t?1:t<7?2:t<11?3:4}},gd:{name:"Scottish Gaelic",examples:[{plural:0,sample:1},{plural:1,sample:2},{plural:2,sample:3},{plural:3,sample:20}],nplurals:4,pluralsText:"nplurals = 4; plural = ((n === 1 || n === 11) ? 0 : (n === 2 || n === 12) ? 1 : (n > 2 && n < 20) ? 2 : 3)",pluralsFunc:function(t){return 1===t||11===t?0:2===t||12===t?1:2<t&&t<20?2:3}},gl:{name:"Galician",examples:[{plural:0,sample:1},{plural:1,sample:2}],nplurals:2,pluralsText:"nplurals = 2; plural = (n !== 1)",pluralsFunc:function(t){return 1!==t}},gu:{name:"Gujarati",examples:[{plural:0,sample:1},{plural:1,sample:2}],nplurals:2,pluralsText:"nplurals = 2; plural = (n !== 1)",pluralsFunc:function(t){return 1!==t}},gun:{name:"Gun",examples:[{plural:0,sample:1},{plural:1,sample:2}],nplurals:2,pluralsText:"nplurals = 2; plural = (n > 1)",pluralsFunc:function(t){return 1<t}},ha:{name:"Hausa",examples:[{plural:0,sample:1},{plural:1,sample:2}],nplurals:2,pluralsText:"nplurals = 2; plural = (n !== 1)",pluralsFunc:function(t){return 1!==t}},he:{name:"Hebrew",examples:[{plural:0,sample:1},{plural:1,sample:2}],nplurals:2,pluralsText:"nplurals = 2; plural = (n !== 1)",pluralsFunc:function(t){return 1!==t}},hi:{name:"Hindi",examples:[{plural:0,sample:1},{plural:1,sample:2}],nplurals:2,pluralsText:"nplurals = 2; plural = (n !== 1)",pluralsFunc:function(t){return 1!==t}},hne:{name:"Chhattisgarhi",examples:[{plural:0,sample:1},{plural:1,sample:2}],nplurals:2,pluralsText:"nplurals = 2; plural = (n !== 1)",pluralsFunc:function(t){return 1!==t}},hr:{name:"Croatian",examples:[{plural:0,sample:1},{plural:1,sample:2},{plural:2,sample:5}],nplurals:3,pluralsText:"nplurals = 3; plural = (n % 10 === 1 && n % 100 !== 11 ? 0 : n % 10 >= 2 && n % 10 <= 4 && (n % 100 < 10 || n % 100 >= 20) ? 1 : 2)",pluralsFunc:function(t){return t%10==1&&t%100!=11?0:2<=t%10&&t%10<=4&&(t%100<10||20<=t%100)?1:2}},hu:{name:"Hungarian",examples:[{plural:0,sample:1},{plural:1,sample:2}],nplurals:2,pluralsText:"nplurals = 2; plural = (n !== 1)",pluralsFunc:function(t){return 1!==t}},hy:{name:"Armenian",examples:[{plural:0,sample:1},{plural:1,sample:2}],nplurals:2,pluralsText:"nplurals = 2; plural = (n !== 1)",pluralsFunc:function(t){return 1!==t}},id:{name:"Indonesian",examples:[{plural:0,sample:1}],nplurals:1,pluralsText:"nplurals = 1; plural = 0",pluralsFunc:function(){return 0}},is:{name:"Icelandic",examples:[{plural:0,sample:1},{plural:1,sample:2}],nplurals:2,pluralsText:"nplurals = 2; plural = (n % 10 !== 1 || n % 100 === 11)",pluralsFunc:function(t){return t%10!=1||t%100==11}},it:{name:"Italian",examples:[{plural:0,sample:1},{plural:1,sample:2}],nplurals:2,pluralsText:"nplurals = 2; plural = (n !== 1)",pluralsFunc:function(t){return 1!==t}},ja:{name:"Japanese",examples:[{plural:0,sample:1}],nplurals:1,pluralsText:"nplurals = 1; plural = 0",pluralsFunc:function(){return 0}},jbo:{name:"Lojban",examples:[{plural:0,sample:1}],nplurals:1,pluralsText:"nplurals = 1; plural = 0",pluralsFunc:function(){return 0}},jv:{name:"Javanese",examples:[{plural:0,sample:0},{plural:1,sample:1}],nplurals:2,pluralsText:"nplurals = 2; plural = (n !== 0)",pluralsFunc:function(t){return 0!==t}},ka:{name:"Georgian",examples:[{plural:0,sample:1}],nplurals:1,pluralsText:"nplurals = 1; plural = 0",pluralsFunc:function(){return 0}},kk:{name:"Kazakh",examples:[{plural:0,sample:1}],nplurals:1,pluralsText:"nplurals = 1; plural = 0",pluralsFunc:function(){return 0}},km:{name:"Khmer",examples:[{plural:0,sample:1}],nplurals:1,pluralsText:"nplurals = 1; plural = 0",pluralsFunc:function(){return 0}},kn:{name:"Kannada",examples:[{plural:0,sample:1},{plural:1,sample:2}],nplurals:2,pluralsText:"nplurals = 2; plural = (n !== 1)",pluralsFunc:function(t){return 1!==t}},ko:{name:"Korean",examples:[{plural:0,sample:1}],nplurals:1,pluralsText:"nplurals = 1; plural = 0",pluralsFunc:function(){return 0}},ku:{name:"Kurdish",examples:[{plural:0,sample:1},{plural:1,sample:2}],nplurals:2,pluralsText:"nplurals = 2; plural = (n !== 1)",pluralsFunc:function(t){return 1!==t}},kw:{name:"Cornish",examples:[{plural:0,sample:1},{plural:1,sample:2},{plural:2,sample:3},{plural:3,sample:4}],nplurals:4,pluralsText:"nplurals = 4; plural = (n === 1 ? 0 : n === 2 ? 1 : n === 3 ? 2 : 3)",pluralsFunc:function(t){return 1===t?0:2===t?1:3===t?2:3}},ky:{name:"Kyrgyz",examples:[{plural:0,sample:1}],nplurals:1,pluralsText:"nplurals = 1; plural = 0",pluralsFunc:function(){return 0}},lb:{name:"Letzeburgesch",examples:[{plural:0,sample:1},{plural:1,sample:2}],nplurals:2,pluralsText:"nplurals = 2; plural = (n !== 1)",pluralsFunc:function(t){return 1!==t}},ln:{name:"Lingala",examples:[{plural:0,sample:1},{plural:1,sample:2}],nplurals:2,pluralsText:"nplurals = 2; plural = (n > 1)",pluralsFunc:function(t){return 1<t}},lo:{name:"Lao",examples:[{plural:0,sample:1}],nplurals:1,pluralsText:"nplurals = 1; plural = 0",pluralsFunc:function(){return 0}},lt:{name:"Lithuanian",examples:[{plural:0,sample:1},{plural:1,sample:2},{plural:2,sample:10}],nplurals:3,pluralsText:"nplurals = 3; plural = (n % 10 === 1 && n % 100 !== 11 ? 0 : n % 10 >= 2 && (n % 100 < 10 || n % 100 >= 20) ? 1 : 2)",pluralsFunc:function(t){return t%10==1&&t%100!=11?0:2<=t%10&&(t%100<10||20<=t%100)?1:2}},lv:{name:"Latvian",examples:[{plural:2,sample:0},{plural:0,sample:1},{plural:1,sample:2}],nplurals:3,pluralsText:"nplurals = 3; plural = (n % 10 === 1 && n % 100 !== 11 ? 0 : n !== 0 ? 1 : 2)",pluralsFunc:function(t){return t%10==1&&t%100!=11?0:0!==t?1:2}},mai:{name:"Maithili",examples:[{plural:0,sample:1},{plural:1,sample:2}],nplurals:2,pluralsText:"nplurals = 2; plural = (n !== 1)",pluralsFunc:function(t){return 1!==t}},mfe:{name:"Mauritian Creole",examples:[{plural:0,sample:1},{plural:1,sample:2}],nplurals:2,pluralsText:"nplurals = 2; plural = (n > 1)",pluralsFunc:function(t){return 1<t}},mg:{name:"Malagasy",examples:[{plural:0,sample:1},{plural:1,sample:2}],nplurals:2,pluralsText:"nplurals = 2; plural = (n > 1)",pluralsFunc:function(t){return 1<t}},mi:{name:"Maori",examples:[{plural:0,sample:1},{plural:1,sample:2}],nplurals:2,pluralsText:"nplurals = 2; plural = (n > 1)",pluralsFunc:function(t){return 1<t}},mk:{name:"Macedonian",examples:[{plural:0,sample:1},{plural:1,sample:2}],nplurals:2,pluralsText:"nplurals = 2; plural = (n === 1 || n % 10 === 1 ? 0 : 1)",pluralsFunc:function(t){return 1===t||t%10==1?0:1}},ml:{name:"Malayalam",examples:[{plural:0,sample:1},{plural:1,sample:2}],nplurals:2,pluralsText:"nplurals = 2; plural = (n !== 1)",pluralsFunc:function(t){return 1!==t}},mn:{name:"Mongolian",examples:[{plural:0,sample:1},{plural:1,sample:2}],nplurals:2,pluralsText:"nplurals = 2; plural = (n !== 1)",pluralsFunc:function(t){return 1!==t}},mni:{name:"Manipuri",examples:[{plural:0,sample:1},{plural:1,sample:2}],nplurals:2,pluralsText:"nplurals = 2; plural = (n !== 1)",pluralsFunc:function(t){return 1!==t}},mnk:{name:"Mandinka",examples:[{plural:0,sample:0},{plural:1,sample:1},{plural:2,sample:2}],nplurals:3,pluralsText:"nplurals = 3; plural = (n === 0 ? 0 : n === 1 ? 1 : 2)",pluralsFunc:function(t){return 0===t?0:1===t?1:2}},mr:{name:"Marathi",examples:[{plural:0,sample:1},{plural:1,sample:2}],nplurals:2,pluralsText:"nplurals = 2; plural = (n !== 1)",pluralsFunc:function(t){return 1!==t}},ms:{name:"Malay",examples:[{plural:0,sample:1}],nplurals:1,pluralsText:"nplurals = 1; plural = 0",pluralsFunc:function(){return 0}},mt:{name:"Maltese",examples:[{plural:0,sample:1},{plural:1,sample:2},{plural:2,sample:11},{plural:3,sample:20}],nplurals:4,pluralsText:"nplurals = 4; plural = (n === 1 ? 0 : n === 0 || ( n % 100 > 1 && n % 100 < 11) ? 1 : (n % 100 > 10 && n % 100 < 20 ) ? 2 : 3)",pluralsFunc:function(t){return 1===t?0:0===t||1<t%100&&t%100<11?1:10<t%100&&t%100<20?2:3}},my:{name:"Burmese",examples:[{plural:0,sample:1}],nplurals:1,pluralsText:"nplurals = 1; plural = 0",pluralsFunc:function(){return 0}},nah:{name:"Nahuatl",examples:[{plural:0,sample:1},{plural:1,sample:2}],nplurals:2,pluralsText:"nplurals = 2; plural = (n !== 1)",pluralsFunc:function(t){return 1!==t}},nap:{name:"Neapolitan",examples:[{plural:0,sample:1},{plural:1,sample:2}],nplurals:2,pluralsText:"nplurals = 2; plural = (n !== 1)",pluralsFunc:function(t){return 1!==t}},nb:{name:"Norwegian Bokmal",examples:[{plural:0,sample:1},{plural:1,sample:2}],nplurals:2,pluralsText:"nplurals = 2; plural = (n !== 1)",pluralsFunc:function(t){return 1!==t}},ne:{name:"Nepali",examples:[{plural:0,sample:1},{plural:1,sample:2}],nplurals:2,pluralsText:"nplurals = 2; plural = (n !== 1)",pluralsFunc:function(t){return 1!==t}},nl:{name:"Dutch",examples:[{plural:0,sample:1},{plural:1,sample:2}],nplurals:2,pluralsText:"nplurals = 2; plural = (n !== 1)",pluralsFunc:function(t){return 1!==t}},nn:{name:"Norwegian Nynorsk",examples:[{plural:0,sample:1},{plural:1,sample:2}],nplurals:2,pluralsText:"nplurals = 2; plural = (n !== 1)",pluralsFunc:function(t){return 1!==t}},no:{name:"Norwegian",examples:[{plural:0,sample:1},{plural:1,sample:2}],nplurals:2,pluralsText:"nplurals = 2; plural = (n !== 1)",pluralsFunc:function(t){return 1!==t}},nso:{name:"Northern Sotho",examples:[{plural:0,sample:1},{plural:1,sample:2}],nplurals:2,pluralsText:"nplurals = 2; plural = (n !== 1)",pluralsFunc:function(t){return 1!==t}},oc:{name:"Occitan",examples:[{plural:0,sample:1},{plural:1,sample:2}],nplurals:2,pluralsText:"nplurals = 2; plural = (n > 1)",pluralsFunc:function(t){return 1<t}},or:{name:"Oriya",examples:[{plural:0,sample:1},{plural:1,sample:2}],nplurals:2,pluralsText:"nplurals = 2; plural = (n !== 1)",pluralsFunc:function(t){return 1!==t}},pa:{name:"Punjabi",examples:[{plural:0,sample:1},{plural:1,sample:2}],nplurals:2,pluralsText:"nplurals = 2; plural = (n !== 1)",pluralsFunc:function(t){return 1!==t}},pap:{name:"Papiamento",examples:[{plural:0,sample:1},{plural:1,sample:2}],nplurals:2,pluralsText:"nplurals = 2; plural = (n !== 1)",pluralsFunc:function(t){return 1!==t}},pl:{name:"Polish",examples:[{plural:0,sample:1},{plural:1,sample:2},{plural:2,sample:5}],nplurals:3,pluralsText:"nplurals = 3; plural = (n === 1 ? 0 : n % 10 >= 2 && n % 10 <= 4 && (n % 100 < 10 || n % 100 >= 20) ? 1 : 2)",pluralsFunc:function(t){return 1===t?0:2<=t%10&&t%10<=4&&(t%100<10||20<=t%100)?1:2}},pms:{name:"Piemontese",examples:[{plural:0,sample:1},{plural:1,sample:2}],nplurals:2,pluralsText:"nplurals = 2; plural = (n !== 1)",pluralsFunc:function(t){return 1!==t}},ps:{name:"Pashto",examples:[{plural:0,sample:1},{plural:1,sample:2}],nplurals:2,pluralsText:"nplurals = 2; plural = (n !== 1)",pluralsFunc:function(t){return 1!==t}},pt:{name:"Portuguese",examples:[{plural:0,sample:1},{plural:1,sample:2}],nplurals:2,pluralsText:"nplurals = 2; plural = (n !== 1)",pluralsFunc:function(t){return 1!==t}},rm:{name:"Romansh",examples:[{plural:0,sample:1},{plural:1,sample:2}],nplurals:2,pluralsText:"nplurals = 2; plural = (n !== 1)",pluralsFunc:function(t){return 1!==t}},ro:{name:"Romanian",examples:[{plural:0,sample:1},{plural:1,sample:2},{plural:2,sample:20}],nplurals:3,pluralsText:"nplurals = 3; plural = (n === 1 ? 0 : (n === 0 || (n % 100 > 0 && n % 100 < 20)) ? 1 : 2)",pluralsFunc:function(t){return 1===t?0:0===t||0<t%100&&t%100<20?1:2}},ru:{name:"Russian",examples:[{plural:0,sample:1},{plural:1,sample:2},{plural:2,sample:5}],nplurals:3,pluralsText:"nplurals = 3; plural = (n % 10 === 1 && n % 100 !== 11 ? 0 : n % 10 >= 2 && n % 10 <= 4 && (n % 100 < 10 || n % 100 >= 20) ? 1 : 2)",pluralsFunc:function(t){return t%10==1&&t%100!=11?0:2<=t%10&&t%10<=4&&(t%100<10||20<=t%100)?1:2}},rw:{name:"Kinyarwanda",examples:[{plural:0,sample:1},{plural:1,sample:2}],nplurals:2,pluralsText:"nplurals = 2; plural = (n !== 1)",pluralsFunc:function(t){return 1!==t}},sah:{name:"Yakut",examples:[{plural:0,sample:1}],nplurals:1,pluralsText:"nplurals = 1; plural = 0",pluralsFunc:function(){return 0}},sat:{name:"Santali",examples:[{plural:0,sample:1},{plural:1,sample:2}],nplurals:2,pluralsText:"nplurals = 2; plural = (n !== 1)",pluralsFunc:function(t){return 1!==t}},sco:{name:"Scots",examples:[{plural:0,sample:1},{plural:1,sample:2}],nplurals:2,pluralsText:"nplurals = 2; plural = (n !== 1)",pluralsFunc:function(t){return 1!==t}},sd:{name:"Sindhi",examples:[{plural:0,sample:1},{plural:1,sample:2}],nplurals:2,pluralsText:"nplurals = 2; plural = (n !== 1)",pluralsFunc:function(t){return 1!==t}},se:{name:"Northern Sami",examples:[{plural:0,sample:1},{plural:1,sample:2}],nplurals:2,pluralsText:"nplurals = 2; plural = (n !== 1)",pluralsFunc:function(t){return 1!==t}},si:{name:"Sinhala",examples:[{plural:0,sample:1},{plural:1,sample:2}],nplurals:2,pluralsText:"nplurals = 2; plural = (n !== 1)",pluralsFunc:function(t){return 1!==t}},sk:{name:"Slovak",examples:[{plural:0,sample:1},{plural:1,sample:2},{plural:2,sample:5}],nplurals:3,pluralsText:"nplurals = 3; plural = (n === 1 ? 0 : (n >= 2 && n <= 4) ? 1 : 2)",pluralsFunc:function(t){return 1===t?0:2<=t&&t<=4?1:2}},sl:{name:"Slovenian",examples:[{plural:1,sample:1},{plural:2,sample:2},{plural:3,sample:3},{plural:0,sample:5}],nplurals:4,pluralsText:"nplurals = 4; plural = (n % 100 === 1 ? 1 : n % 100 === 2 ? 2 : n % 100 === 3 || n % 100 === 4 ? 3 : 0)",pluralsFunc:function(t){return t%100==1?1:t%100==2?2:t%100==3||t%100==4?3:0}},so:{name:"Somali",examples:[{plural:0,sample:1},{plural:1,sample:2}],nplurals:2,pluralsText:"nplurals = 2; plural = (n !== 1)",pluralsFunc:function(t){return 1!==t}},son:{name:"Songhay",examples:[{plural:0,sample:1},{plural:1,sample:2}],nplurals:2,pluralsText:"nplurals = 2; plural = (n !== 1)",pluralsFunc:function(t){return 1!==t}},sq:{name:"Albanian",examples:[{plural:0,sample:1},{plural:1,sample:2}],nplurals:2,pluralsText:"nplurals = 2; plural = (n !== 1)",pluralsFunc:function(t){return 1!==t}},sr:{name:"Serbian",examples:[{plural:0,sample:1},{plural:1,sample:2},{plural:2,sample:5}],nplurals:3,pluralsText:"nplurals = 3; plural = (n % 10 === 1 && n % 100 !== 11 ? 0 : n % 10 >= 2 && n % 10 <= 4 && (n % 100 < 10 || n % 100 >= 20) ? 1 : 2)",pluralsFunc:function(t){return t%10==1&&t%100!=11?0:2<=t%10&&t%10<=4&&(t%100<10||20<=t%100)?1:2}},su:{name:"Sundanese",examples:[{plural:0,sample:1}],nplurals:1,pluralsText:"nplurals = 1; plural = 0",pluralsFunc:function(){return 0}},sv:{name:"Swedish",examples:[{plural:0,sample:1},{plural:1,sample:2}],nplurals:2,pluralsText:"nplurals = 2; plural = (n !== 1)",pluralsFunc:function(t){return 1!==t}},sw:{name:"Swahili",examples:[{plural:0,sample:1},{plural:1,sample:2}],nplurals:2,pluralsText:"nplurals = 2; plural = (n !== 1)",pluralsFunc:function(t){return 1!==t}},ta:{name:"Tamil",examples:[{plural:0,sample:1},{plural:1,sample:2}],nplurals:2,pluralsText:"nplurals = 2; plural = (n !== 1)",pluralsFunc:function(t){return 1!==t}},te:{name:"Telugu",examples:[{plural:0,sample:1},{plural:1,sample:2}],nplurals:2,pluralsText:"nplurals = 2; plural = (n !== 1)",pluralsFunc:function(t){return 1!==t}},tg:{name:"Tajik",examples:[{plural:0,sample:1},{plural:1,sample:2}],nplurals:2,pluralsText:"nplurals = 2; plural = (n > 1)",pluralsFunc:function(t){return 1<t}},th:{name:"Thai",examples:[{plural:0,sample:1}],nplurals:1,pluralsText:"nplurals = 1; plural = 0",pluralsFunc:function(){return 0}},ti:{name:"Tigrinya",examples:[{plural:0,sample:1},{plural:1,sample:2}],nplurals:2,pluralsText:"nplurals = 2; plural = (n > 1)",pluralsFunc:function(t){return 1<t}},tk:{name:"Turkmen",examples:[{plural:0,sample:1},{plural:1,sample:2}],nplurals:2,pluralsText:"nplurals = 2; plural = (n !== 1)",pluralsFunc:function(t){return 1!==t}},tr:{name:"Turkish",examples:[{plural:0,sample:1},{plural:1,sample:2}],nplurals:2,pluralsText:"nplurals = 2; plural = (n > 1)",pluralsFunc:function(t){return 1<t}},tt:{name:"Tatar",examples:[{plural:0,sample:1}],nplurals:1,pluralsText:"nplurals = 1; plural = 0",pluralsFunc:function(){return 0}},ug:{name:"Uyghur",examples:[{plural:0,sample:1}],nplurals:1,pluralsText:"nplurals = 1; plural = 0",pluralsFunc:function(){return 0}},uk:{name:"Ukrainian",examples:[{plural:0,sample:1},{plural:1,sample:2},{plural:2,sample:5}],nplurals:3,pluralsText:"nplurals = 3; plural = (n % 10 === 1 && n % 100 !== 11 ? 0 : n % 10 >= 2 && n % 10 <= 4 && (n % 100 < 10 || n % 100 >= 20) ? 1 : 2)",pluralsFunc:function(t){return t%10==1&&t%100!=11?0:2<=t%10&&t%10<=4&&(t%100<10||20<=t%100)?1:2}},ur:{name:"Urdu",examples:[{plural:0,sample:1},{plural:1,sample:2}],nplurals:2,pluralsText:"nplurals = 2; plural = (n !== 1)",pluralsFunc:function(t){return 1!==t}},uz:{name:"Uzbek",examples:[{plural:0,sample:1},{plural:1,sample:2}],nplurals:2,pluralsText:"nplurals = 2; plural = (n > 1)",pluralsFunc:function(t){return 1<t}},vi:{name:"Vietnamese",examples:[{plural:0,sample:1}],nplurals:1,pluralsText:"nplurals = 1; plural = 0",pluralsFunc:function(){return 0}},wa:{name:"Walloon",examples:[{plural:0,sample:1},{plural:1,sample:2}],nplurals:2,pluralsText:"nplurals = 2; plural = (n > 1)",pluralsFunc:function(t){return 1<t}},wo:{name:"Wolof",examples:[{plural:0,sample:1}],nplurals:1,pluralsText:"nplurals = 1; plural = 0",pluralsFunc:function(){return 0}},yo:{name:"Yoruba",examples:[{plural:0,sample:1},{plural:1,sample:2}],nplurals:2,pluralsText:"nplurals = 2; plural = (n !== 1)",pluralsFunc:function(t){return 1!==t}},zh:{name:"Chinese",examples:[{plural:0,sample:1}],nplurals:1,pluralsText:"nplurals = 1; plural = 0",pluralsFunc:function(){return 0}}}},"5b69d43ebd9d048e":function(t,e){var i,n,r=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function a(e){if(i===setTimeout)return setTimeout(e,0);if((i===o||!i)&&setTimeout)return i=setTimeout,setTimeout(e,0);try{return i(e,0)}catch(t){try{return i.call(null,e,0)}catch(t){return i.call(this,e,0)}}}!function(){try{if("function"==typeof setTimeout)i=setTimeout;else i=o}catch(t){i=o}try{if("function"==typeof clearTimeout)n=clearTimeout;else n=s}catch(t){n=s}}();var l,c=[],u=!1,h=-1;function d(){if(u&&l){if(u=!1,l.length)c=l.concat(c);else h=-1;if(c.length)p()}}function p(){if(!u){var t=a(d);u=!0;for(var e=c.length;e;){for(l=c,c=[];++h<e;)if(l)l[h].run();h=-1,e=c.length}l=null,u=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===s||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(t)}}function f(t,e){this.fun=t,this.array=e}function m(){}r.nextTick=function(t){var e=new Array(arguments.length-1);if(1<arguments.length)for(var i=1;i<arguments.length;i++)e[i-1]=arguments[i];if(c.push(new f(t,e)),1===c.length&&!u)a(p)},f.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=m,r.addListener=m,r.once=m,r.off=m,r.removeListener=m,r.removeAllListeners=m,r.emit=m,r.prependListener=m,r.prependOnceListener=m,r.listeners=function(t){return[]},r.binding=function(t){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(t){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},"60e9623f1bd2a21f":function(t,e,i){(function(e){var n=i("cb74d576d67f77c5"),l=i("53484a302ce1864e");function c(t){if(t=t||{},this.catalogs={},this.locale="",this.domain="messages",this.listeners=[],this.sourceLocale="",t.sourceLocale)if("string"==typeof t.sourceLocale)this.sourceLocale=t.sourceLocale;else this.warn("The `sourceLocale` option should be a string");if("debug"in t)this.debug=!0===t.debug;else if(void 0!==e&&e.env)this.debug=!1;else this.debug=!1}(t.exports=c).prototype.on=function(t,e){this.listeners.push({eventName:t,callback:e})},c.prototype.off=function(e,i){this.listeners=this.listeners.filter(function(t){return!1==(t.eventName===e&&t.callback===i)})},c.prototype.emit=function(t,e){for(var i=0;i<this.listeners.length;i++){var n=this.listeners[i];if(n.eventName===t)n.callback(e)}},c.prototype.warn=function(t){if(this.debug)console.warn(t);this.emit("error",t)},c.prototype.addTranslations=function(t,e,i){if(!this.catalogs[t])this.catalogs[t]={};this.catalogs[t][e]=i},c.prototype.setLocale=function(t){if("string"==typeof t){if(""===t.trim())this.warn("You called setLocale() with an empty value, which makes little sense.");if(t!==this.sourceLocale&&!this.catalogs[t])this.warn('You called setLocale() with "'+t+'", but no translations for that locale has been added.');this.locale=t}else this.warn("You called setLocale() with an argument of type "+_typeof(t)+". The locale must be a string.")},c.prototype.setTextDomain=function(t){if("string"==typeof t){if(""===t.trim())this.warn("You called setTextDomain() with an empty `domain` value.");this.domain=t}else this.warn("You called setTextDomain() with an argument of type "+_typeof(t)+". The domain must be a string.")},c.prototype.gettext=function(t){return this.dnpgettext(this.domain,"",t)},c.prototype.dgettext=function(t,e){return this.dnpgettext(t,"",e)},c.prototype.ngettext=function(t,e,i){return this.dnpgettext(this.domain,"",t,e,i)},c.prototype.dngettext=function(t,e,i,n){return this.dnpgettext(t,"",e,i,n)},c.prototype.pgettext=function(t,e){return this.dnpgettext(this.domain,t,e)},c.prototype.dpgettext=function(t,e,i){return this.dnpgettext(t,e,i)},c.prototype.npgettext=function(t,e,i,n){return this.dnpgettext(this.domain,t,e,i,n)},c.prototype.dnpgettext=function(t,e,i,n,r){var o,s,a=i;if(e=e||"",!isNaN(r)&&1!==r)a=n||i;if(o=this._getTranslation(t,e,i)){if("number"==typeof r){if("boolean"==typeof(s=(0,l[c.getLanguageCode(this.locale)].pluralsFunc)(r)))s=s?1:0}else s=0;return o.msgstr[s]||a}else if(!this.sourceLocale||this.locale!==this.sourceLocale)this.warn('No translation was found for msgid "'+i+'" in msgctxt "'+e+'" and domain "'+t+'"');return a},c.prototype.getComment=function(t,e,i){var n;if(n=this._getTranslation(t,e,i))return n.comments||{};else return{}},c.prototype._getTranslation=function(t,e,i){return e=e||"",n(this.catalogs,[this.locale,t,"translations",e,i])},c.getLanguageCode=function(t){return t.split(/[\-_]/)[0].toLowerCase()},c.prototype.textdomain=function(t){if(this.debug)console.warn("textdomain(domain) was used to set locales in node-gettext v1. Make sure you are using it for domains, and switch to setLocale(locale) if you are not.\n\n To read more about the migration from node-gettext v1 to v2, see https://github.com/alexanderwallin/node-gettext/#migrating-from-1x-to-2x\n\nThis warning will be removed in the final 2.0.0");this.setTextDomain(t)},c.prototype.setlocale=function(t){this.setLocale(t)},c.prototype.addTextdomain=function(){console.error("addTextdomain() is deprecated.\n\n* To add translations, use addTranslations()\n* To set the default domain, use setTextDomain() (or its alias textdomain())\n\nTo read more about the migration from node-gettext v1 to v2, see https://github.com/alexanderwallin/node-gettext/#migrating-from-1x-to-2x")}}).call(this,i("5b69d43ebd9d048e"))},cb74d576d67f77c5:function(J,t,e){(function(t){var e="Expected a function",n="__lodash_hash_undefined__",i=1/0,r="[object Function]",o="[object GeneratorFunction]",s="[object Symbol]",a=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,l=/^\w*$/,c=/^\./,u=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,h=/\\(\\)?/g,d=/^\[object .+?Constructor\]$/,p="object"==_typeof(t)&&t&&t.Object===Object&&t,f="object"==("undefined"==typeof self?"undefined":_typeof(self))&&self&&self.Object===Object&&self,m=p||f||Function("return this")();var g,y=Array.prototype,v=Function.prototype,b=Object.prototype,_=m["__core-js_shared__"],w=(g=/[^.]+$/.exec(_&&_.keys&&_.keys.IE_PROTO||""))?"Symbol(src)_1."+g:"",x=v.toString,S=b.hasOwnProperty,I=b.toString,T=RegExp("^"+x.call(S).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),C=m.Symbol,O=y.splice,P=j(m,"Map"),E=j(Object,"create"),A=C?C.prototype:void 0,k=A?A.toString:void 0;function M(t){var e=-1,i=t?t.length:0;for(this.clear();++e<i;){var n=t[e];this.set(n[0],n[1])}}function R(t){var e=-1,i=t?t.length:0;for(this.clear();++e<i;){var n=t[e];this.set(n[0],n[1])}}function L(t){var e=-1,i=t?t.length:0;for(this.clear();++e<i;){var n=t[e];this.set(n[0],n[1])}}function D(t,e){for(var i,n,r=t.length;r--;)if((i=t[r][0])===(n=e)||i!=i&&n!=n)return r;return-1}function N(t,e){for(var i,n=0,r=(e=function(t,e){if(W(t))return!1;var i=_typeof(t);if("number"==i||"symbol"==i||"boolean"==i||null==t||H(t))return!0;return l.test(t)||!a.test(t)||null!=e&&t in Object(e)}(e,t)?[e]:W(i=e)?i:G(i)).length;null!=t&&n<r;)t=t[V(e[n++])];return n&&n==r?t:void 0}function B(t){if(!$(t)||(e=t,w&&w in e))return!1;else return((n=$(i=t)?I.call(i):"")==r||n==o||function(t){var e=!1;if(null!=t&&"function"!=typeof t.toString)try{e=!!(t+"")}catch(t){}return e}(t)?T:d).test(function(t){if(null!=t){try{return x.call(t)}catch(t){}try{return t+""}catch(t){}}return""}(t));var e,i,n}function F(t,e){var i,n,r=t.__data__;return("string"==(n=_typeof(i=e))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==i:null===i)?r["string"==typeof e?"string":"hash"]:r.map}function j(t,e){var i,n,r=(n=e,null==(i=t)?void 0:i[n]);return B(r)?r:void 0}M.prototype.clear=function(){this.__data__=E?E(null):{}},M.prototype.delete=function(t){return this.has(t)&&delete this.__data__[t]},M.prototype.get=function(t){var e=this.__data__;if(E){var i=e[t];return i===n?void 0:i}return S.call(e,t)?e[t]:void 0},M.prototype.has=function(t){var e=this.__data__;return E?void 0!==e[t]:S.call(e,t)},M.prototype.set=function(t,e){return this.__data__[t]=E&&void 0===e?n:e,this},R.prototype.clear=function(){this.__data__=[]},R.prototype.delete=function(t){var e=this.__data__,i=D(e,t);if(i<0)return!1;if(i==e.length-1)e.pop();else O.call(e,i,1);return!0},R.prototype.get=function(t){var e=this.__data__,i=D(e,t);return i<0?void 0:e[i][1]},R.prototype.has=function(t){return-1<D(this.__data__,t)},R.prototype.set=function(t,e){var i=this.__data__,n=D(i,t);if(n<0)i.push([t,e]);else i[n][1]=e;return this},L.prototype.clear=function(){this.__data__={hash:new M,map:new(P||R),string:new M}},L.prototype.delete=function(t){return F(this,t).delete(t)},L.prototype.get=function(t){return F(this,t).get(t)},L.prototype.has=function(t){return F(this,t).has(t)},L.prototype.set=function(t,e){return F(this,t).set(t,e),this};var G=U(function(t){var e;t=null==(e=t)?"":function(t){if("string"==typeof t)return t;if(H(t))return k?k.call(t):"";var e=t+"";return"0"==e&&1/t==-i?"-0":e}(e);var r=[];if(c.test(t))r.push("");return t.replace(u,function(t,e,i,n){r.push(i?n.replace(h,"$1"):e||t)}),r});function V(t){if("string"==typeof t||H(t))return t;var e=t+"";return"0"==e&&1/t==-i?"-0":e}function U(o,s){if("function"!=typeof o||s&&"function"!=typeof s)throw new TypeError(e);var t=function t(){var e=arguments,i=s?s.apply(this,e):e[0],n=t.cache;if(n.has(i))return n.get(i);var r=o.apply(this,e);return t.cache=n.set(i,r),r};return t.cache=new(U.Cache||L),t}U.Cache=L;var W=Array.isArray;function $(t){var e=_typeof(t);return!!t&&("object"==e||"function"==e)}function H(t){return"symbol"==_typeof(t)||!!(e=t)&&"object"==_typeof(e)&&I.call(t)==s;var e}J.exports=function(t,e,i){var n=null==t?void 0:N(t,e);return void 0===n?i:n}}).call(this,e("0ee4763173a9a955"))},d17160be920e06f2:function(e,i,n){var r;!function(){var f={not_string:/[^s]/,not_bool:/[^t]/,not_type:/[^T]/,not_primitive:/[^v]/,number:/[diefg]/,numeric_arg:/[bcdiefguxX]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijostTuvxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[+-]/};function m(t){return function(t,e){var i,n,r,o,s,a,l,c,u,h=1,d=t.length,p="";for(n=0;n<d;n++)if("string"==typeof t[n])p+=t[n];else if("object"===_typeof(t[n])){if((o=t[n]).keys)for(i=e[h],r=0;r<o.keys.length;r++){if(null==i)throw new Error(m('[sprintf] Cannot access property "%s" of undefined value "%s"',o.keys[r],o.keys[r-1]));i=i[o.keys[r]]}else if(o.param_no)i=e[o.param_no];else i=e[h++];if(f.not_type.test(o.type)&&f.not_primitive.test(o.type)&&i instanceof Function)i=i();if(f.numeric_arg.test(o.type)&&"number"!=typeof i&&isNaN(i))throw new TypeError(m("[sprintf] expecting number but found %T",i));if(f.number.test(o.type))c=0<=i;switch(o.type){case"b":i=parseInt(i,10).toString(2);break;case"c":i=String.fromCharCode(parseInt(i,10));break;case"d":case"i":i=parseInt(i,10);break;case"j":i=JSON.stringify(i,null,o.width?parseInt(o.width):0);break;case"e":i=o.precision?parseFloat(i).toExponential(o.precision):parseFloat(i).toExponential();break;case"f":i=o.precision?parseFloat(i).toFixed(o.precision):parseFloat(i);break;case"g":i=o.precision?String(Number(i.toPrecision(o.precision))):parseFloat(i);break;case"o":i=(parseInt(i,10)>>>0).toString(8);break;case"s":i=String(i),i=o.precision?i.substring(0,o.precision):i;break;case"t":i=String(!!i),i=o.precision?i.substring(0,o.precision):i;break;case"T":i=Object.prototype.toString.call(i).slice(8,-1).toLowerCase(),i=o.precision?i.substring(0,o.precision):i;break;case"u":i=parseInt(i,10)>>>0;break;case"v":i=i.valueOf(),i=o.precision?i.substring(0,o.precision):i;break;case"x":i=(parseInt(i,10)>>>0).toString(16);break;case"X":i=(parseInt(i,10)>>>0).toString(16).toUpperCase()}if(f.json.test(o.type))p+=i;else{if(f.number.test(o.type)&&(!c||o.sign))u=c?"+":"-",i=i.toString().replace(f.sign,"");else u="";a=o.pad_char?"0"===o.pad_char?"0":o.pad_char.charAt(1):" ",l=o.width-(u+i).length,s=o.width?0<l?a.repeat(l):"":"",p+=o.align?u+i+s:"0"===a?u+s+i:s+u+i}}return p}(function(t){if(l[t])return l[t];var e,i=t,n=[],r=0;for(;i;){if(null!==(e=f.text.exec(i)))n.push(e[0]);else if(null!==(e=f.modulo.exec(i)))n.push("%");else if(null!==(e=f.placeholder.exec(i))){if(e[2]){r|=1;var o=[],s=e[2],a=[];if(null!==(a=f.key.exec(s)))for(o.push(a[1]);""!==(s=s.substring(a[0].length));)if(null!==(a=f.key_access.exec(s)))o.push(a[1]);else if(null!==(a=f.index_access.exec(s)))o.push(a[1]);else throw new SyntaxError("[sprintf] failed to parse named argument key");else throw new SyntaxError("[sprintf] failed to parse named argument key");e[2]=o}else r|=2;if(3===r)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");n.push({placeholder:e[0],param_no:e[1],keys:e[2],sign:e[3],pad_char:e[4],align:e[5],width:e[6],precision:e[7],type:e[8]})}else throw new SyntaxError("[sprintf] unexpected placeholder");i=i.substring(e[0].length)}return l[t]=n}(t),arguments)}function t(t,e){return m.apply(null,[t].concat(e||[]))}var l=Object.create(null);if(1)i.sprintf=m,i.vsprintf=t;if(void 0!==window)if(window.sprintf=m,window.vsprintf=t,1)void 0===(r=function(){return{sprintf:m,vsprintf:t}}.call(i,n,i,e))||(e.exports=r)}()},d8a6e6e590e85ade:function(t,e,i){Object.defineProperty(e,"__esModule",{value:!0});var o=i("60e9623f1bd2a21f"),a=i("d17160be920e06f2"),s=window,n=function(){function t(){var s=this;this.getLang=function(t,e){if(void 0===e)e=[];var i=t;if(s.needTranslate()&&s.gt)i=s.gt.gettext.call(s.gt,t);return e.length?a.vsprintf(i,e):i},this.getLangWithDefault=function(t,e,i){if(void 0===i)i=[];var n=e;if(s.needTranslate()&&s.gt)n=s.gt.pgettext.call(s.gt,t,e);return i.length?a.vsprintf(n,i):n},this.getPluralsLang=function(t,e,i,n){if(void 0===n)n=[];var r=t;if(s.needTranslate()&&s.gt)r=s.gt.ngettext.call(s.gt,t,e,i);return n.length?a.vsprintf(r,n):r},this.getPluralsLangWithDefault=function(t,e,i,n,r){if(void 0===r)r=[];var o=e;if(s.needTranslate()&&s.gt)o=s.gt.npgettext.call(s.gt,t,e,i,n);return r.length?a.vsprintf(o,r):o}}return t.prototype.init=function(){var r=this;return new Promise(function(i,t){var n="minigame"===xfConfig.exportType||/minigame/i.test(navigator.userAgent)?"drama/locales.json":"locales.json";(new s.xf.XfLoader).loadResGroup([n],"i18n_json").then(function(t){if(t[n]){if(!r.gt){r.gt=new o,r.gt.addTranslations("en","messages",t[n].en);var e=(navigator.language||navigator.browserLanguage).toLowerCase();r.locale=-1!==e.indexOf("zh")?"zh":"en",r.gt.setLocale(r.locale)}}else console.error("Error fetching locales.json");i()}).catch(function(t){console.error("Error fetching locales.json",t),i()})})},t.prototype.needTranslate=function(){return this.locale&&"zh"!=this.locale},t}();if(!s.i18n)s.i18n=new n,s.trFunc=s.i18n.getLang}}),function(i){var n={};function r(t){if(n[t])return n[t].exports;var e=n[t]={i:t,l:!1,exports:{}};return i[t].call(e.exports,e,e.exports,r),e.l=!0,e.exports}r.m=i,r.c=n,r.d=function(t,e,i){if(!r.o(t,e))Object.defineProperty(t,e,{enumerable:!0,get:i})},r.r=function(t){if("undefined"!=typeof Symbol&&Symbol.toStringTag)Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(e,t){if(1&t)e=r(e);if(8&t)return e;if(4&t&&"object"===_typeof(e)&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(i,n,function(t){return e[t]}.bind(null,n));return i},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s="e5624d3e9e0e1fb6")}({e5624d3e9e0e1fb6:function(t,e,i){Object.defineProperty(e,"__esModule",{value:!0});var r=window,c="laster",n=function(){function t(){this.inited=!1,this.forbiddonWordMap={}}return t.prototype.init=function(){var n=this;return new Promise(function(e,t){var i="minigame"===xfConfig.exportType||/minigame/i.test(navigator.userAgent)?"drama/forbiddon.json":"forbiddon.json";(new r.xf.XfLoader).loadResGroup([i],"forbiddon_json").then(function(t){if(t[i])n.forbiddonWordMap=n.makeForbiddonMap(t[i].words),n.inited=!0;else console.error("Error fetching forbiddon.json");e()}).catch(function(t){console.error("Error fetching forbiddon.json",t),e()})})},t.prototype.makeForbiddonMap=function(t){var o={};return t.forEach(function(t){for(var e=o,i=0;i<t.length;i++){var n=t.charAt(i);if(e[n])e=e[n];else{if(!0===e[c])e[c]=!1;var r={laster:!0};e[n]=r,e=e[n]}}}),o},t.prototype.checkForbiddonWord=function(t,e,i){for(var n=t,r=!1,o=0,s="",a=i;a<e.length;a++){var l=e.charAt(a);if(n=n[l]){if(o++,s+=l,!0===n[c]){r=!0;break}}else break}if(o<2)r=!1;return{flag:r,forbiddonWord:s}},t.prototype.filterForbiddonWord=function(t){if(!this.inited)return[];for(var e=[],i=t.replace(" ",""),n=0;n<i.length;n++){var r=this.checkForbiddonWord(this.forbiddonWordMap,i,n);if(r.flag)e.push(r.forbiddonWord)}return e},t}();if(e.default=n,!r.fbdManager)r.fbdManager=new n,r.checkForbiddon=r.fbdManager.filterForbiddonWord.bind(r.fbdManager)}}),function(xf){var t=function(){function t(t,e){this.callback=t,this.thisObj=e}return Object.defineProperty(t.prototype,"bindCallback",{get:function(){if(!this.m_bindCallback)this.m_bindCallback=this.callback.bind(this.thisObj);return this.m_bindCallback},enumerable:!0,configurable:!0}),t}();xf.Callback=t}(xf||(xf={})),function(xf){var t=function(){function t(){this.m_keys=[],this.m_values=[]}return Object.defineProperty(t.prototype,"length",{get:function(){return this.m_keys.length},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"values",{get:function(){return this.m_values.concat()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"keys",{get:function(){return this.m_keys.concat()},enumerable:!0,configurable:!0}),t.prototype.indexOfKey=function(t){return this.m_keys.indexOf(t)},t.prototype.indexOfValue=function(t){return this.m_values.indexOf(t)},t.prototype.getKeyByValue=function(t){return this.m_keys[this.indexOfValue(t)]},t.prototype.add=function(t,e){var i=this.indexOfKey(t);if(0<=i)this.m_values[i]=e;else this.m_keys.push(t),this.m_values.push(e)},t.prototype.get=function(t){var e=this.indexOfKey(t);if(0<=e)return this.m_values[e];else return null},t.prototype.remove=function(t){var e=this.indexOfKey(t);if(0<=e)return this.m_keys.splice(e,1),this.m_values.splice(e,1)[0];else return null},t.prototype.clear=function(){this.m_keys.length=0,this.m_values.length=0},t.prototype.getRandomData=function(){var t=Math.random()*this.keys.length<<0;return this.m_values[t]},t}();xf.Dictionary=t}(xf||(xf={})),function(xf){var t=function(t,e){this.messageID=t,this.messageData=e};xf.EventData=t}(xf||(xf={})),function(xf){var o=function(){function t(){}return t.LITTLE_ENDIAN="littleEndian",t.BIG_ENDIAN="bigEndian",t}();xf.Endian=o;var t=function(){function t(t,e){if(void 0===e)e=0;if(this.bufferExtSize=0,this.EOF_byte=-1,this.EOF_code_point=-1,e<0)e=0;var i;this.bufferExtSize=e;var n=0;if(t){var r=void 0;if(t instanceof Uint8Array)n=(r=t).length;else n=t.byteLength,r=new Uint8Array(t);if(0==e)i=new Uint8Array(n);else{i=new Uint8Array((1+(n/e|0))*e)}i.set(r)}else i=new Uint8Array(e);this.write_position=n,this._position=0,this._bytes=i,this.data=new DataView(i.buffer),this.endian=o.BIG_ENDIAN}return Object.defineProperty(t.prototype,"endian",{get:function(){return 0==this.$endian?o.LITTLE_ENDIAN:o.BIG_ENDIAN},set:function(t){this.$endian=t==o.LITTLE_ENDIAN?0:1},enumerable:!0,configurable:!0}),t.prototype.setArrayBuffer=function(t){},Object.defineProperty(t.prototype,"readAvailable",{get:function(){return this.write_position-this._position},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"buffer",{get:function(){return this.data.buffer.slice(0,this.write_position)},set:function(t){var e,i=t.byteLength,n=new Uint8Array(t),r=this.bufferExtSize;if(0==r)e=new Uint8Array(i);else{e=new Uint8Array((1+(i/r|0))*r)}e.set(n),this.write_position=i,this._bytes=e,this.data=new DataView(e.buffer)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rawBuffer",{get:function(){return this.data.buffer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bytes",{get:function(){return this._bytes},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dataView",{get:function(){return this.data},set:function(t){this.buffer=t.buffer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bufferOffset",{get:function(){return this.data.byteOffset},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"position",{get:function(){return this._position},set:function(t){if((this._position=t)>this.write_position)this.write_position=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"length",{get:function(){return this.write_position},set:function(t){if(this.write_position=t,this.data.byteLength>t)this._position=t;this._validateBuffer(t)},enumerable:!0,configurable:!0}),t.prototype._validateBuffer=function(t){if(this.data.byteLength<t){var e=this.bufferExtSize,i=void 0;if(0==e)i=new Uint8Array(t);else{i=new Uint8Array((1+(t/e>>0))*e)}i.set(this._bytes),this._bytes=i,this.data=new DataView(i.buffer)}},Object.defineProperty(t.prototype,"bytesAvailable",{get:function(){return this.data.byteLength-this._position},enumerable:!0,configurable:!0}),t.prototype.clear=function(){var t=new ArrayBuffer(this.bufferExtSize);this.data=new DataView(t),this._bytes=new Uint8Array(t),this._position=0,this.write_position=0},t.prototype.readBoolean=function(){if(this.validate(1))return!!this._bytes[this.position++]},t.prototype.readByte=function(){if(this.validate(1))return this.data.getInt8(this.position++)},t.prototype.readBytes=function(t,e,i){if(void 0===e)e=0;if(void 0===i)i=0;if(t){var n=this._position,r=this.write_position-n;if(!(r<0)){if(0==i)i=r;else if(r<i)return;var o=t._position;t._position=0,t.validateBuffer(e+i),t._position=o,t._bytes.set(this._bytes.subarray(n,n+i),e),this.position+=i}}},t.prototype.readDouble=function(){if(this.validate(8)){var t=this.data.getFloat64(this._position,0==this.$endian);return this.position+=8,t}},t.prototype.readFloat=function(){if(this.validate(4)){var t=this.data.getFloat32(this._position,0==this.$endian);return this.position+=4,t}},t.prototype.readInt=function(){if(this.validate(4)){var t=this.data.getInt32(this._position,0==this.$endian);return this.position+=4,t}},t.prototype.readShort=function(){if(this.validate(2)){var t=this.data.getInt16(this._position,0==this.$endian);return this.position+=2,t}},t.prototype.readUnsignedByte=function(){if(this.validate(1))return this._bytes[this.position++]},t.prototype.readUnsignedInt=function(){if(this.validate(4)){var t=this.data.getUint32(this._position,0==this.$endian);return this.position+=4,t}},t.prototype.readUnsignedShort=function(){if(this.validate(2)){var t=this.data.getUint16(this._position,0==this.$endian);return this.position+=2,t}},t.prototype.readUTF=function(){var t=this.readUnsignedShort();if(0<t)return this.readUTFBytes(t);else return""},t.prototype.readUTFBytes=function(t){if(this.validate(t)){var e=this.data,i=new Uint8Array(e.buffer,e.byteOffset+this._position,t);return this.position+=t,this.decodeUTF8(i)}},t.prototype.writeBoolean=function(t){this.validateBuffer(1),this._bytes[this.position++]=+t},t.prototype.writeByte=function(t){this.validateBuffer(1),this._bytes[this.position++]=255&t},t.prototype.writeBytes=function(t,e,i){if(void 0===e)e=0;if(void 0===i)i=0;var n;if(!(e<0))if(!(i<0)){if(0==i)n=t.length-e;else n=Math.min(t.length-e,i);if(0<n)this.validateBuffer(n),this._bytes.set(t._bytes.subarray(e,e+n),this._position),this.position=this._position+n}},t.prototype.writeDouble=function(t){this.validateBuffer(8),this.data.setFloat64(this._position,t,0==this.$endian),this.position+=8},t.prototype.writeFloat=function(t){this.validateBuffer(4),this.data.setFloat32(this._position,t,0==this.$endian),this.position+=4},t.prototype.writeInt=function(t){this.validateBuffer(4),this.data.setInt32(this._position,t,0==this.$endian),this.position+=4},t.prototype.writeShort=function(t){this.validateBuffer(2),this.data.setInt16(this._position,t,0==this.$endian),this.position+=2},t.prototype.writeUnsignedInt=function(t){this.validateBuffer(4),this.data.setUint32(this._position,t,0==this.$endian),this.position+=4},t.prototype.writeUnsignedShort=function(t){this.validateBuffer(2),this.data.setUint16(this._position,t,0==this.$endian),this.position+=2},t.prototype.writeUTF=function(t){var e=this.encodeUTF8(t),i=e.length;this.validateBuffer(2+i),this.data.setUint16(this._position,i,0==this.$endian),this.position+=2,this._writeUint8Array(e,!1)},t.prototype.writeUTFBytes=function(t){this._writeUint8Array(this.encodeUTF8(t))},t.prototype.toString=function(){return"[ByteArray] length:"+this.length+", bytesAvailable:"+this.bytesAvailable},t.prototype._writeUint8Array=function(t,e){if(void 0===e)e=!0;var i=this._position,n=i+t.length;if(e)this.validateBuffer(n);this.bytes.set(t,i),this.position=n},t.prototype.validate=function(t){var e=this._bytes.length;if(0<e&&this._position+t<=e)return!0},t.prototype.validateBuffer=function(t){this.write_position=t>this.write_position?t:this.write_position,t+=this._position,this._validateBuffer(t)},t.prototype.encodeUTF8=function(t){for(var e=0,i=this.stringToCodePoints(t),n=[];i.length>e;){var r=i[e++];if(this.inRange(r,55296,57343))this.encoderError(r);else if(this.inRange(r,0,127))n.push(r);else{var o=void 0,s=void 0;if(this.inRange(r,128,2047))o=1,s=192;else if(this.inRange(r,2048,65535))o=2,s=224;else if(this.inRange(r,65536,1114111))o=3,s=240;for(n.push(this.div(r,Math.pow(64,o))+s);0<o;){var a=this.div(r,Math.pow(64,o-1));n.push(128+a%64),o-=1}}}return new Uint8Array(n)},t.prototype.decodeUTF8=function(t){for(var e,i=0,n="",r=0,o=0,s=0,a=0;t.length>i;){var l=t[i++];if(l==this.EOF_byte)if(0!=o)e=this.decoderError(!1);else e=this.EOF_code_point;else if(0==o)if(this.inRange(l,0,127))e=l;else{if(this.inRange(l,194,223))o=1,a=128,r=l-192;else if(this.inRange(l,224,239))o=2,a=2048,r=l-224;else if(this.inRange(l,240,244))o=3,a=65536,r=l-240;else this.decoderError(!1);r*=Math.pow(64,o),e=null}else if(!this.inRange(l,128,191))a=s=o=r=0,i--,e=this.decoderError(!1,l);else if(s+=1,r+=(l-128)*Math.pow(64,o-s),s!==o)e=null;else{var c=r,u=a;if(a=s=o=r=0,this.inRange(c,u,1114111)&&!this.inRange(c,55296,57343))e=c;else e=this.decoderError(!1,l)}if(null!==e&&e!==this.EOF_code_point)if(e<=65535){if(0<e)n+=String.fromCharCode(e)}else e-=65536,n+=String.fromCharCode(55296+(e>>10&1023)),n+=String.fromCharCode(56320+(1023&e))}return n},t.prototype.encoderError=function(t){console.log(t)},t.prototype.decoderError=function(t,e){return e||65533},t.prototype.inRange=function(t,e,i){return e<=t&&t<=i},t.prototype.div=function(t,e){return Math.floor(t/e)},t.prototype.stringToCodePoints=function(t){for(var e=[],i=0,n=t.length;i<t.length;){var r=t.charCodeAt(i);if(!this.inRange(r,55296,57343))e.push(r);else if(this.inRange(r,56320,57343))e.push(65533);else if(i==n-1)e.push(65533);else{var o=t.charCodeAt(i+1);if(this.inRange(o,56320,57343)){var s=1023&r,a=1023&o;i+=1,e.push(65536+(s<<10)+a)}else e.push(65533)}i+=1}return e},t}();xf.xfByteArray=t}(xf||(xf={})),function(xf){var t=function(){function e(t,e,i,n,r,o){if(void 0===t)t=1;if(void 0===e)e=0;if(void 0===i)i=0;if(void 0===n)n=1;if(void 0===r)r=0;if(void 0===o)o=0;this.a=t,this.b=e,this.c=i,this.d=n,this.tx=r,this.ty=o,this.array=null}return e.prototype.fromArray=function(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]},e.prototype.set=function(t,e,i,n,r,o){return this.a=t,this.b=e,this.c=i,this.d=n,this.tx=r,this.ty=o,this},e.prototype.toArray=function(t,e){if(!this.array)this.array=new Float32Array(9);var i=e||this.array;if(t)i[0]=this.a,i[1]=this.b,i[2]=0,i[3]=this.c,i[4]=this.d,i[5]=0,i[6]=this.tx,i[7]=this.ty,i[8]=1;else i[0]=this.a,i[1]=this.c,i[2]=this.tx,i[3]=this.b,i[4]=this.d,i[5]=this.ty,i[6]=0,i[7]=0,i[8]=1;return i},e.prototype.apply=function(t,e){e=e||new xf.Point;var i=t.x,n=t.y;return e.x=this.a*i+this.c*n+this.tx,e.y=this.b*i+this.d*n+this.ty,e},e.prototype.applyInverse=function(t,e){e=e||new xf.Point;var i=1/(this.a*this.d+this.c*-this.b),n=t.x,r=t.y;return e.x=this.d*i*n+-this.c*i*r+(this.ty*this.c-this.tx*this.d)*i,e.y=this.a*i*r+-this.b*i*n+(-this.ty*this.a+this.tx*this.b)*i,e},e.prototype.translate=function(t,e){return this.tx+=t,this.ty+=e,this},e.prototype.scale=function(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this},e.prototype.rotate=function(t){var e=Math.cos(t),i=Math.sin(t),n=this.a,r=this.c,o=this.tx;return this.a=n*e-this.b*i,this.b=n*i+this.b*e,this.c=r*e-this.d*i,this.d=r*i+this.d*e,this.tx=o*e-this.ty*i,this.ty=o*i+this.ty*e,this},e.prototype.append=function(t){var e=this.a,i=this.b,n=this.c,r=this.d;return this.a=t.a*e+t.b*n,this.b=t.a*i+t.b*r,this.c=t.c*e+t.d*n,this.d=t.c*i+t.d*r,this.tx=t.tx*e+t.ty*n+this.tx,this.ty=t.tx*i+t.ty*r+this.ty,this},e.prototype.setTransform=function(t,e,i,n,r,o,s,a,l){return this.a=Math.cos(s+l)*r,this.b=Math.sin(s+l)*r,this.c=-Math.sin(s-a)*o,this.d=Math.cos(s-a)*o,this.tx=t-(i*this.a+n*this.c),this.ty=e-(i*this.b+n*this.d),this},e.prototype.prepend=function(t){var e=this.tx;if(1!==t.a||0!==t.b||0!==t.c||1!==t.d){var i=this.a,n=this.c;this.a=i*t.a+this.b*t.c,this.b=i*t.b+this.b*t.d,this.c=n*t.a+this.d*t.c,this.d=n*t.b+this.d*t.d}return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this},e.prototype.decompose=function(t){var e=this.a,i=this.b,n=this.c,r=this.d,o=-Math.atan2(-n,r),s=Math.atan2(i,e),a=Math.abs(o+s);if(a<1e-5||Math.abs(2*Math.PI-a)<1e-5)t.rotation=s,t.skew.x=t.skew.y=0;else t.rotation=0,t.skew.x=o,t.skew.y=s;return t.scale.x=Math.sqrt(e*e+i*i),t.scale.y=Math.sqrt(n*n+r*r),t.position.x=this.tx,t.position.y=this.ty,t},e.prototype.invert=function(){var t=this.a,e=this.b,i=this.c,n=this.d,r=this.tx,o=t*n-e*i;return this.a=n/o,this.b=-e/o,this.c=-i/o,this.d=t/o,this.tx=(i*this.ty-n*r)/o,this.ty=-(t*this.ty-e*r)/o,this},e.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},e.prototype.clone=function(){var t=new e;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},e.prototype.copyTo=function(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},e.prototype.copyFrom=function(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this},Object.defineProperty(e,"IDENTITY",{get:function(){return new e},enumerable:!0,configurable:!0}),e}();xf.Matrix=t}(xf||(xf={})),function(xf){var t=function(){function t(){this.worldTransform=new xf.Matrix,this.localTransform=new xf.Matrix,this.position=new xf.ObservablePoint(this.onChange,this,0,0),this.scale=new xf.ObservablePoint(this.onChange,this,1,1),this.pivot=new xf.ObservablePoint(this.onChange,this,0,0),this.skew=new xf.ObservablePoint(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=-1,this._worldID=0,this._parentID=0}return t.prototype.onChange=function(){this._localID++},t.prototype.updateSkew=function(){var t=(this._rotation+this.skew.y)/xf.DEG_TO_RAD,e=(this._rotation+this.skew.y)/xf.DEG_TO_RAD,i=xf.NumberUtils.cos(t),n=xf.NumberUtils.sin(t);if(t===e)this._cx=i,this._sx=n;else this._cx=xf.NumberUtils.cos(e),this._sx=xf.NumberUtils.sin(e);this._cy=-n,this._sy=i,this._localID++},t.prototype.updateTransform=function(t){var e=this.localTransform;if(this._localID!==this._currentLocalID)e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1;if(this._parentID!==t._worldID){var i=t.worldTransform,n=this.worldTransform;n.a=e.a*i.a+e.b*i.c,n.b=e.a*i.b+e.b*i.d,n.c=e.c*i.a+e.d*i.c,n.d=e.c*i.b+e.d*i.d,n.tx=e.tx*i.a+e.ty*i.c+i.tx,n.ty=e.tx*i.b+e.ty*i.d+i.ty,this._parentID=t._worldID,this._worldID++}},t.prototype.setFromMatrix=function(t){t.decompose(this),this._localID++},Object.defineProperty(t.prototype,"rotation",{get:function(){return this._rotation},set:function(t){if(this._rotation!==t)this._rotation=t,this.updateSkew()},enumerable:!0,configurable:!0}),t}();xf.Transform=t}(xf||(xf={})),function(xf){var t=function(){function i(t,e,i,n){if(void 0===i)i=0;if(void 0===n)n=0;this._x=i,this._y=n,this.cb=t,this.scope=e}return i.prototype.clone=function(t,e){if(void 0===t)t=null;if(void 0===e)e=null;return new i(t||this.cb,e||this.scope,this._x,this._y)},i.prototype.set=function(t,e){var i=t||0,n=e||(0!==e?i:0);if(this._x!==i||this._y!==n)this._x=i,this._y=n,this.cb.call(this.scope)},i.prototype.copyFrom=function(t){if(this._x!==t.x||this._y!==t.y)this._x=t.x,this._y=t.y,this.cb.call(this.scope);return this},i.prototype.copyTo=function(t){return t.set(this._x,this._y),t},i.prototype.equals=function(t){return t.x===this._x&&t.y===this._y},Object.defineProperty(i.prototype,"x",{get:function(){return this._x},set:function(t){if(this._x!==t)this._x=t,this.cb.call(this.scope)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"y",{get:function(){return this._y},set:function(t){if(this._y!==t)this._y=t,this.cb.call(this.scope)},enumerable:!0,configurable:!0}),i}();xf.ObservablePoint=t}(xf||(xf={})),function(xf){var t=function(){function t(){}return t.DirectionEnum=function(){function t(){}return t.NONE=0,t.UP=1,t.DOWN=2,t.LEFT=4,t.RIGHT=8,t.LEFTUP=t.LEFT|t.UP,t.LEFTDOWN=t.LEFT|t.DOWN,t.RIGHTUP=t.RIGHT|t.UP,t.RIGHTDOWN=t.RIGHT|t.DOWN,t}(),t}();xf.GameConst=t}(xf||(xf={})),function(xf){var t=function(){function t(){}return t.SDK_INIT_SUCCESS="sdk-init-success",t.SDK_LOGIN_SUCCESS="sdk-login-success",t.LOGIN_SUCCESS="xf-login-success",t.LOGIN_FAIL="xf-login-fail",t.SDK_LOGOUT="sdk-login",t.SDK_SWITCH_ACCOUNT="sdk-switch-account",t.REPORT_GLOBAL_VARS="report-global-vars",t.CHANGE_SCREEN="change_screen",t.SCENE_RESIZE="scene_resize",t.SCROLL_LAYOUT_X="scroll_layout_x",t.SCROLL_LAYOUT_Y="scroll_layout_y",t.JOYSTICK_MOVE="joystick_move",t.JOYSTICK_RESET="joystick_reset",t.BUTTON_CLICKED="button_clicked",t}();xf.EventType=t}(xf||(xf={}));var __extends=(Etb=function(t,e){return(Etb=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]})(t,e)},function(t,e){function i(){this.constructor=t}Etb(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),Etb,xf,xf,xf,xf,xf,xf,xf,xf,xf,xf;!function(xf){var t=function(){function t(){this.m_callbackMaps=new xf.Dictionary,this.m_sendBuffer=[]}return Object.defineProperty(t,"instance",{get:function(){if(null==t.s_instance)t.s_instance=new t;return t.s_instance},enumerable:!0,configurable:!0}),t.prototype.addEventListener=function(t,e,i,n){if(void 0===n)n=0;if(e&&i){var r=new l(e,i);r.index=n,r.messageID=t;var o=this.m_callbackMaps.get(t);if(o){for(var s=0,a=o.length;s<a;s++)if(r.index<o[s].index)return void o.splice(s,0,r);o.push(r)}else this.m_callbackMaps.add(t,[r])}},t.prototype.removeEventListener=function(t,e,i){var n=this.m_callbackMaps.get(t);if(n)for(var r=n.length;0<r;r--){var o=n[r-1];if(o.callback==e&&o.thisObj===i){o.isValid=!1,n.splice(r-1,1);break}}},t.prototype.sendEvent=function(t){var e=this;this.m_sendBuffer.push(t),setTimeout(function(){e.sendAll()},0)},t.prototype.flush=function(){this.sendAll()},t.prototype.sendAll=function(){var t,e=Date.now(),i=0,n=this.m_sendBuffer.length,r=this.m_sendBuffer;if(100<n)r=this.m_sendBuffer.splice(0,100),console.log("分帧剩余未处理请求数："+this.m_sendBuffer.length);for(;0<r.length;){var o=r.shift(),s=this.m_callbackMaps.get(o.messageID);if(s)for(var a=0,l=(s=s.concat()).length;a<l;a++){var c=s[a];if(c.isValid){var u=Date.now();c.bindCallback(o);var h=Date.now();if(i<h-u)i=h-u,t=c}}}var d=Date.now()-e;if(10<d)if(t&&5<i)console.log("单帧事件派发耗时："+d+" 最高耗时事件："+t.messageID+" 耗时："+i);else console.log("单帧事件派发耗时："+d)},t}();xf.EventCenter=t;var l=function(n){function t(t,e){var i=n.call(this,t,e)||this;return i.isValid=!0,i}return __extends(t,n),t}(xf.Callback);xf.EventCallBack=l}(xf||(xf={})),function(xf){var i,t,n,e;(t=i=xf.WebSocketStateEnum||(xf.WebSocketStateEnum={}))[t.CONNECTING=0]="CONNECTING",t[t.CONNECTED=1]="CONNECTED",t[t.CLOSING=2]="CLOSING",t[t.CLOSED=3]="CLOSED",(e=n||(n={}))[e.TYPE_STRING=0]="TYPE_STRING",e[e.TYPE_BINARY=1]="TYPE_BINARY";var r=function(){function e(){this.m_status=i.CLOSED,this.m_receiveType=n.TYPE_BINARY}return Object.defineProperty(e.prototype,"status",{get:function(){return this.m_status},enumerable:!0,configurable:!0}),e.prototype.onOpen=function(t){this.m_status=i.CONNECTED,xf.EventCenter.instance.sendEvent(new xf.EventData(xf.xfWebSocket.CONNECT))},e.prototype.onMessage=function(t){xf.EventCenter.instance.sendEvent(new xf.EventData(xf.xfWebSocket.SOCKET_DATA,t.data))},e.prototype.onError=function(t){this.m_status=i.CLOSED,xf.EventCenter.instance.sendEvent(new xf.EventData(xf.xfWebSocket.IO_ERROR))},e.prototype.onClose=function(t){this.m_status=i.CLOSED,xf.EventCenter.instance.sendEvent(new xf.EventData(xf.xfWebSocket.CLOSE))},e.prototype.connect=function(t,e,i){if(void 0===i)i=!1;var n;if(!i)n="ws://"+t+":"+e;else n="wss://"+t+":"+e;this.connectByURL(n)},e.prototype.connectByURL=function(t){if(e.isSupport()){if(this.m_status===i.CLOSED){if(this.m_socket&&this.close(),this.m_socket=new WebSocket(t),this.m_socket.addEventListener("open",this.onOpen.bind(this)),this.m_socket.addEventListener("message",this.onMessage.bind(this)),this.m_socket.addEventListener("error",this.onError.bind(this)),this.m_socket.addEventListener("close",this.onClose.bind(this)),this.m_receiveType==n.TYPE_BINARY)this.m_socket.binaryType="arraybuffer";else this.m_socket.binaryType="blob";this.m_status=i.CONNECTING}}else console.warn("当前设备不支持websocket")},e.prototype.writeBytes=function(t){this.m_socket.send(t)},e.prototype.close=function(){if(this.m_socket)try{this.m_socket.close(),this.m_status=i.CLOSING}catch(t){}},e.isSupport=function(){return"undefined"!=typeof WebSocket},Object.defineProperty(e,"instance",{get:function(){if(!e.s_instance)e.s_instance=new e;return e.s_instance},enumerable:!0,configurable:!0}),e.CONNECT="xfWebSocket.CONNECT",e.IO_ERROR="xfWebSocket.IO_ERROR",e.CLOSE="xfWebSocket.CLOSE",e.SOCKET_DATA="xfWebSocket.SOCKET_DATA",e}();xf.xfWebSocket=r}(xf||(xf={})),function(xf){var t=function(){function r(){}return r.encode=function(t,e){var i=new xf.xfByteArray;return i.writeByte(r.HEAD),i.writeUnsignedInt(0),i.writeUnsignedShort(t),i.writeByte(0),i.writeByte(0),i.writeUnsignedInt(e.length),i.writeBytes(e),i},r.decode=function(t){if(t.position=0,t.readByte()==r.HEAD){t.readUnsignedInt();var e=t.readShort(),i=(t.readByte(),t.readByte(),t.readUnsignedInt()),n=new xf.xfByteArray;n.writeBytes(t,t.position,i),xf.EventCenter.instance.sendEvent(new xf.EventData(e,n.bytes))}else console.log("协议封包验证失败")},r.sendPacket=function(t,e){if(xf.xfWebSocket.instance.status===xf.WebSocketStateEnum.CONNECTED){var i=new xf.xfByteArray;i._writeUint8Array(e),xf.xfWebSocket.instance.writeBytes(xf.PacketUtils.encode(t,i).buffer)}else console.error("请求发送失败，游戏服务器链接异常！当前链接状态："+xf.WebSocketStateEnum[xf.xfWebSocket.instance.status])},r.decodePacket=function(t){var e=new xf.xfByteArray;e._writeUint8Array(new Uint8Array(t)),xf.PacketUtils.decode(e)},r.HEAD=124,r}();xf.PacketUtils=t}(xf||(xf={})),function(xf){var t=function(){function t(){var e=this;if(this.m_heartbeatInterval=1e4,this.m_reconnectDelay=1e4,this.m_tryTimes=0,this.m_maxTimes=3,t.s_instance)throw Error("单例类不可实例化");xf.EventCenter.instance.addEventListener(xf.xfWebSocket.CONNECT,this.onConnect,this),xf.EventCenter.instance.addEventListener(xf.xfWebSocket.IO_ERROR,this.onIOError,this),xf.EventCenter.instance.addEventListener(xf.xfWebSocket.CLOSE,this.onClose,this),xf.EventCenter.instance.addEventListener(xf.xfWebSocket.SOCKET_DATA,this.onSocketData,this),xf.EventCenter.instance.addEventListener(game.MsgType.HEART_RESP,this.onHeartbeat,this),window.addEventListener("online",function(t){if(xf.xfWebSocketUtils.isNeedReconnect)e.m_tryTimes=0,xf.xfWebSocket.instance.connectByURL(e.m_url)})}return t.prototype.onConnect=function(t){this.m_tryTimes=0,console.log("onConnect:"+JSON.stringify(t)),this.heartbeat()},t.prototype.onIOError=function(t){console.log("onClose:"+JSON.stringify(t))},t.prototype.onClose=function(t){var e=this;if(console.log("onClose:"+JSON.stringify(t)),this.m_tryTimes<this.m_maxTimes)setTimeout(function(){if(xf.xfWebSocketUtils.isNeedReconnect)xf.xfWebSocket.instance.connectByURL(e.m_url),e.m_tryTimes++,console.log("开始第"+e.m_tryTimes+"次重连")},this.m_reconnectDelay);else this.m_tryTimes=0,console.log("重连失败")},t.prototype.onSocketData=function(t){xf.PacketUtils.decodePacket(t.messageData)},t.prototype.heartbeat=function(){var t=new game.HeartReq;xf.PacketUtils.sendPacket(game.MsgType.HEART_REQ,game.HeartReq.encode(t).finish()),this.heartbeatSendTime=Date.now()},t.prototype.onHeartbeat=function(t){var e=this,i=game.HeartResp.decode(t.messageData),n=Number(i.timestamp)-Date.now();if(0===xf.xfWebSocketUtils.timeDiff)xf.xfWebSocketUtils.timeDiff=Date.now()-this.heartbeatSendTime+n;if(i)setTimeout(function(){e.heartbeat()},this.m_heartbeatInterval)},Object.defineProperty(t,"instance",{get:function(){if(!t.s_instance)t.s_instance=new t;return t.s_instance},enumerable:!0,configurable:!0}),t.prototype.connect=function(t,e,i,n,r,o,s){xf.xfWebSocketUtils.isNeedReconnect=!0,this.m_url=xfConfig.gameSocket+"?gameId="+t+"&gameVersion="+e+"&playerId="+i+"&cid="+n+"&token="+r+"&deviceId="+o+"&platform="+s,xf.xfWebSocket.instance.connectByURL(this.m_url)},t.prototype.disconnect=function(){xf.xfWebSocketUtils.isNeedReconnect=!1,xf.xfWebSocket.instance.close()},t.now=function(){return new Date(Date.now()+xf.xfWebSocketUtils.timeDiff).getTime()},t.isNeedReconnect=!0,t.timeDiff=0,t}();xf.xfWebSocketUtils=t}(xf||(xf={})),function(xf){var t=function(){function e(){this.m_data=[]}return e.create=function(){var t;if(e.s_pool.length)t=e.s_pool.pop();else t=new e;return t.isNewLine=!1,t},e.prototype.destory=function(){if(e.s_pool.indexOf(this)<0){if(e.s_pool.push(this),this.style)this.style.destory(),this.style=null;if(this.rect)this.rect.destory(),this.rect=null;this.text="",this.isNewLine=!1}},Object.defineProperty(e.prototype,"text",{get:function(){return this.m_data[0]},set:function(t){this.m_data[0]=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"style",{get:function(){return this.m_data[1]},set:function(t){this.m_data[1]=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rect",{get:function(){return this.m_data[2]},set:function(t){this.m_data[2]=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isNewLine",{get:function(){return this.m_data[3]},set:function(t){this.m_data[3]=t},enumerable:!0,configurable:!0}),e.s_pool=[],e}();xf.TextNode=t}(xf||(xf={})),function(xf){var t=function(){function n(){this.m_isDestory=!1,this.blocks=[],this.lineWidth=this.lineHeight=0}return n.create=function(){var t;if(n.s_blockPool.length)t=n.s_blockPool.pop();else t=new n;return t.m_isDestory=!1,t},n.prototype.destory=function(){var t=this.blocks;if(t&&t.length){for(var e=0,i=t.length;e<i;e++)t[e].destory();this.blocks.length=0}if(this.lineWidth=0,this.lineHeight=0,!this.m_isDestory)this.m_isDestory=!0,n.s_blockPool.push(this)},n.s_blockPool=[],n}();xf.LineBlock=t}(xf||(xf={})),function(xf){var t=function(){function f(){this.$style=[],this.reset()}return f.create=function(){var t;if(f.s_pool.length)t=f.s_pool.pop();else t=new f;return t.reset(),t},f.prototype.reset=function(){var t=this.$style;t[3]=20,t[4]="#FFFFFF",t[5]="center",t[6]="middle",t[7]=0,t[8]="bottom",t[9]=!1,t[10]=!1,t[11]="Arial",t[0]=null,t[1]=null,t[13]=!1,t[14]=!1,t[15]=0,t[16]="#FFFFFF",t[17]=0,t[18]=0,t[19]="#FFFFFF",t[20]=0},f.prototype.destory=function(){if(f.s_pool.indexOf(this)<0)this.$style.length=0,f.s_pool.push(this)},Object.defineProperty(f.prototype,"type",{get:function(){return this.$style[0]},set:function(t){this.$style[0]=t},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"parent",{get:function(){return this.$style[1]},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"size",{get:function(){return this.$style[3]},set:function(t){this.$style[3]=t},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"color",{get:function(){return this.$style[4]},set:function(t){this.$style[4]=t},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"hAlign",{get:function(){return this.$style[5]},set:function(t){this.$style[5]=t},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"vAlign",{get:function(){return this.$style[6]},set:function(t){this.$style[6]=t},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"line_height",{get:function(){return this.$style[7]},set:function(t){this.$style[7]=t},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"line_vAlign",{get:function(){return this.$style[8]},set:function(t){this.$style[8]=t},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"isBold",{get:function(){if("strong"==this.$style[0])return!0;else return this.$style[9]},set:function(t){this.$style[9]=t},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"isItalic",{get:function(){if("em"==this.$style[0])return!0;else return this.$style[10]},set:function(t){this.$style[10]=t},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"fontFamily",{get:function(){return this.$style[11]},set:function(t){this.$style[11]=t},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"backgroundColor",{get:function(){return this.$style[12]},set:function(t){this.$style[12]=t},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"underline",{get:function(){return this.$style[13]},set:function(t){this.$style[13]=t},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"deleteline",{get:function(){return this.$style[14]},set:function(t){this.$style[14]=t},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"strokeSize",{get:function(){return this.$style[15]},set:function(t){this.$style[15]=t},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"strokeColor",{get:function(){return this.$style[16]},set:function(t){this.$style[16]=t},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"shadowSize",{get:function(){return this.$style[17]},set:function(t){this.$style[17]=t},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"shadowAngle",{get:function(){return this.$style[18]},set:function(t){this.$style[18]=t},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"shadowColor",{get:function(){return this.$style[19]},set:function(t){this.$style[19]=t},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"shadowDistance",{get:function(){return this.$style[20]},set:function(t){this.$style[20]=t},enumerable:!0,configurable:!0}),f.prototype.getFont=function(){var t="";if(this.isItalic)t+="italic ";if(this.isBold)t+="bold ";return t+=this.size+"px ",t+=this.fontFamily.replace(/\.ttf/gi,"")},f.prototype.checkUpdate=function(t){for(var e=t.$style,i=this.$style,n=0,r=e.length;n<r;n++)if(i[n]!==e[n])return!0;return!1},f.prototype.copy=function(t){for(var e=t.$style,i=this.$style,n=3,r=e.length;n<r;n++)if(i[n]!==e[n])i[n]=e[n];return this},f.prototype.copyAll=function(t){for(var e=t.$style,i=this.$style,n=0,r=e.length;n<r;n++)if(i[n]!==e[n])i[n]=e[n];return this},f.prototype.update=function(t,e){var i=this.$style;if(t)this.copy(t),i[1]=t;if(e)for(;;){var n=f.propRegExp.exec(e);if(n){var r=n[1],o=n[2];switch(r){case"color":i[4]=o;break;case"background-color":i[12]=o;break;case"font-size":var s=o.match(/[^0-9]+/)[0];if(s)switch(s){case"px":i[3]=parseInt(o,10);break;case"pt":i[3]=xf.pt2px(parseInt(o,10));break;default:console.error(r+"单位未确定")}break;case"text-align":i[5]=o;break;case"font-weight":i[9]="bold"==o;break;case"font-style":i[10]="italic"==o;break;case"vertical-align":i[6]=o;break;case"font-family":i[11]=o;break;case"text-decoration":if("underline"===o)i[13]=!0;else if("line-through"===o)i[14]=!0;break;case"text-stroke":var a=o.split(" ");if(a)i[15]=a[0],i[16]=a[1];break;case"text-shadow":var l=o.split(" ");if(a){var c=l[0],u=l[1],h=Number(l[2]),d=Number(l[3]),p=Math.atan(d/h);i[17]=c,i[16]=u,i[18]=p,i[20]=Math.sqrt(Math.pow(h,2)+Math.pow(d,2))}}}else break}return this},f.propRegExp=/([a-z|\-].+?)\:\s?(.+?)\;/gi,f.s_pool=[],f}();xf.TextStyle=t}(xf||(xf={})),function(xf){var t=function(){function b(){}return b.addTextNode=function(t,e,i,n){if(e||n)if(t){var r=null,o=t[t.length-1];if(!n&&o&&!o.text)r=o;else r=xf.TextNode.create(),t.push(r),r.isNewLine=n;r.text=e,r.style=i}},b.checkWordWarp=function(t,e,i,n){if(t)for(var r=0,o=e.split(/\n/gi);r<o.length;r++){var s=o[r];b.addTextNode(t,s,i,n),n=!0}},b.parse=function(t,e){for(var i=[[/&lt;/g,"<"],[/&gt;/g,">"],[/&amp;/g,"&"],[/&quot;/g,'"'],[/&apos;/g,"'"],[/&ldquo;/g,"“"],[/&rdquo;/g,"”"],[/&nbsp;/g," "]],n=0,r=i.length;n<r;n++)t=t.replace(i[n][0],i[n][1]);var o=/\<(\/)?([a-z]+)(?:\s?(?:style=(?:[\'\"](.+?)[\'\"]))?)?(\/)?\>/gi,s=[],a=!1,l=xf.TextStyle.create();for(l.update(e);;){var c=o.lastIndex,u=o.exec(t);if(u){var h=u.index,d=!!u[1],p=u[2],f=u[3],m=!!u[4],g=t.substring(c,h);if(g)b.checkWordWarp(s,g,l,a);if(m){if("br"===p)a=!0;continue}if(d){var y=l&&l.parent;if(y)l=y}else{var v=l;if((l=xf.TextStyle.create()).update(v,f),"p"===(l.type=p)||"div"===p)a=!0;else a=!1}}else{if(c<t.length)b.checkWordWarp(s,t.substring(c),l,a);break}}return s},b}();xf.TextParser=t}(xf||(xf={})),function(xf){var t=function(){function t(){this.m_lines=[],this.m_lineSpace=0,this.m_multiline=!0,this.m_textWidth=0,this.m_textHeight=0,this.m_isRichText=!1,this.m_text="",this.m_defaultStyle=xf.TextStyle.create()}return Object.defineProperty(t.prototype,"width",{get:function(){return this.m_width},set:function(t){this.m_width=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.m_height},set:function(t){this.m_height=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"text",{get:function(){return this.m_text},set:function(t){t=t||"";for(var e=0,i=[[/&lt;/g,"<"],[/&gt;/g,">"],[/&amp;/g,"&"],[/&quot;/g,'"'],[/&apos;/g,"'"],[/&nbsp;/g," "],[/&yen;/g,"¥"],[/&hellip;/g,"……"],[/&mdash;/g,"—"],[/&lsquo;/g,"‘"],[/&rsquo;/g,"’"],[/&rdquo;/g,"“"],[/&bdquo;/g,"”"]];e<i.length;e++){var n=i[e];t=t.replace(n[0],n[1])}this.m_text=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isRichText",{get:function(){return this.m_isRichText},set:function(t){this.m_isRichText=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lineSpace",{get:function(){return this.m_lineSpace||0},set:function(t){this.m_lineSpace=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"multiline",{get:function(){return this.m_multiline},set:function(t){this.m_multiline=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"textWidth",{get:function(){return this.m_textWidth},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"textHeight",{get:function(){return this.m_textHeight},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lines",{get:function(){return this.m_lines},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"defaultStyle",{get:function(){return this.m_defaultStyle},enumerable:!0,configurable:!0}),t.prototype.layoutText=function(){var t=this.m_width,e=this.m_height,i=xf.createCanvas(t,e),n=i.getContext("2d"),r=xf.TextStyle.create().copy(this.m_defaultStyle);n.save(),n.font=r.getFont(),n.fillStyle=r.color;var o=0,s=0,a=0,l="",c=0;if(!this.multiline)this.m_text=this.m_text.replace(/\n/gi,"");for(var u=this.m_text.split(/\n/gi),h=!this.m_text.match(/[\u4e00-\u9fa5]/g),d=r.line_height||r.size,p=0,f=u;p<f.length;p++){var m=f[p];if(m){var g=n.measureText(m).width;if(t<g&&0<t&&this.multiline){var y=1,v=0,b=m.length;if(h){for(var _=m.split(" "),w=n.measureText(" ").width,x=0,S=_;x<S.length;x++){var I=S[x];if(t<c+(g=n.measureText(I).width)){if(0<c){(C=xf.TextNode.create()).style=r,C.text=l,C.rect=xf.Rect.create(o,s,c,d),(O=xf.LineBlock.create()).lineWidth=c,O.lineHeight=d,O.blocks.push(C),this.m_lines.push(O),s+=d+this.m_lineSpace}l=I+" ",c=g+w}else l+=I+" ",c+=g+w}if(0<c){(C=xf.TextNode.create()).style=r,C.text=l,C.rect=xf.Rect.create(o,s,c,d),(O=xf.LineBlock.create()).lineWidth=c,O.lineHeight=d,O.blocks.push(C),this.m_lines.push(O),s+=d+this.m_lineSpace,l="",c=0}}else for(;;){var T=m.substring(v,y);if(t<(g=n.measureText(T).width)){switch(a=Math.max(c,a),v=y-1,r.hAlign){case xf.HorizontalAlign.LEFT:o=0;break;case xf.HorizontalAlign.CENTER:o=.5*(t-c);break;case xf.HorizontalAlign.RIGHT:o=t-c}if(l){(C=xf.TextNode.create()).style=r,C.text=l,C.rect=xf.Rect.create(o,s,c,d),(O=xf.LineBlock.create()).lineWidth=c,O.lineHeight=d,O.blocks.push(C),this.m_lines.push(O),s+=d+this.m_lineSpace}else break}else if(l=T,c=g,y++===b){switch(r.hAlign){case xf.HorizontalAlign.LEFT:o=0;break;case xf.HorizontalAlign.CENTER:o=.5*(t-c);break;case xf.HorizontalAlign.RIGHT:o=t-c}(C=xf.TextNode.create()).style=r,C.text=l,C.rect=xf.Rect.create(o,s,c,d),(O=this.m_lines.pop()).lineWidth=c,O.lineHeight=d,O.blocks.push(C),this.m_lines.push(O),a=Math.max(c,a),s+=this.m_lineSpace+d;break}}}else{switch(r.hAlign){case xf.HorizontalAlign.LEFT:o=0;break;case xf.HorizontalAlign.CENTER:o=.5*(t-g);break;case xf.HorizontalAlign.RIGHT:o=t-g}var C,O;(C=xf.TextNode.create()).style=r,C.text=m,C.rect=xf.Rect.create(o,s,g,d),(O=xf.LineBlock.create()).lineWidth=g,O.lineHeight=d,O.blocks.push(C),this.m_lines.push(O),a=Math.max(g,a),s+=this.m_lineSpace+d}}else s+=d+this.m_lineSpace}this.m_textWidth=a,this.m_textHeight=s,n.restore(),xf.recoverCanvas(i)},t.prototype.layoutRichText=function(){var t=this.m_width,e=this.m_height,i=xf.createCanvas(t,e),n=i.getContext("2d");n.save();for(var r,o=xf.TextStyle.create().copy(this.m_defaultStyle),s=xf.TextParser.parse(this.m_text,o),a=0,l=0,c="",u=0,h=0,d=0,p=!this.m_text.match(/[\u4e00-\u9fa5]/g),f=0,m=s;f<m.length;f++){var g=m[f],y=xf.TextStyle.create();y.copyAll(g.style),n.font=y.getFont(),n.fillStyle=y.color;var v=o.line_height||y.size;if(g.isNewLine&&this.multiline){if(a=0,r)l+=r.lineHeight+this.m_lineSpace,h=Math.max(r.lineWidth,h);r=xf.LineBlock.create(),this.m_lines.push(r)}var b=g.text,_=n.measureText(b).width;if(t<a+_&&this.multiline)if(p){for(var w=b.split(" "),x=n.measureText(" ").width,S=0,I=w;S<I.length;S++){var T=I[S];if(t<u+(_=n.measureText(T).width)){if(0<u){(N=xf.TextNode.create()).style=y,N.text=c,N.rect=xf.Rect.create(a,l,u,v);var C=xf.LineBlock.create();C.lineWidth=u,C.lineHeight=v,C.blocks.push(N),this.m_lines.push(C),l+=v+this.m_lineSpace,h=Math.max(C.lineWidth,h)}c=T+" ",u=_+x}else c+=T+" ",u+=_+x}if(0<u){(N=xf.TextNode.create()).style=y,N.text=c,N.rect=xf.Rect.create(a,l,u,v);var O=xf.LineBlock.create();O.lineWidth=u,O.lineHeight=v,O.blocks.push(N),this.m_lines.push(O),l+=v+this.m_lineSpace,h=Math.max(O.lineWidth,h),c="",u=0}d=l}else for(var P=1,E=0,A=b.length;;){var k=b.substring(E,P);if(t<a+(_=n.measureText(k).width)){if(0<u){if((N=xf.TextNode.create()).style=y,N.text=c,N.rect=xf.Rect.create(a,l,u,v),!r)r=xf.LineBlock.create(),this.m_lines.push(r);r.blocks.push(N),r.lineWidth=a+u,r.lineHeight=Math.max(r.lineHeight,v),h=Math.max(r.lineWidth,h),c="",u=0}if(P-1===E)break;E=P-1,r=xf.LineBlock.create(),this.m_lines.push(r),a=0,d=l+=v+this.m_lineSpace}else if(c=k,u=_,P++===A){if(c){if(d=l+v,(N=xf.TextNode.create()).style=y,N.text=c,N.rect=xf.Rect.create(a,l,u,v),!r)r=xf.LineBlock.create(),this.m_lines.push(r);r.blocks.push(N),r.lineWidth=a+u,r.lineHeight=Math.max(r.lineHeight,v),a=r.lineWidth,c="",u=0}break}}else{if((N=xf.TextNode.create()).style=y,N.text=b,N.rect=xf.Rect.create(a,l,_,v),!r)r=xf.LineBlock.create(),this.m_lines.push(r);r.blocks.push(N),r.lineWidth=a+_,r.lineHeight=Math.max(r.lineHeight,v),a=r.lineWidth,h=Math.max(r.lineWidth,h),d=l+r.lineHeight}}this.m_textWidth=h,this.m_textHeight=d;for(var M=0,R=this.m_lines;M<R.length;M++){var L=R[M],D=L.blocks;if(0<D.length){var N;switch((N=D[0]).style.hAlign){case xf.HorizontalAlign.LEFT:a=0;break;case xf.HorizontalAlign.CENTER:a=.5*(t-L.lineWidth);break;case xf.HorizontalAlign.RIGHT:a=t-L.lineWidth;break;default:a=0}for(var B=0,F=L.blocks;B<F.length;B++){F[B].rect.offset(a,0)}}}this.clearNodes(s),n.restore(),xf.recoverCanvas(i)},t.prototype.clearNodes=function(t){if(t){for(var e=0,i=t;e<i.length;e++){i[e].destory()}t.length=0}},t.prototype.clearLines=function(){if(this.m_lines){for(var t=0,e=this.m_lines;t<e.length;t++){e[t].destory()}this.m_lines.length=0}},t.prototype.doLayout=function(){if(this.clearLines(),this.m_isRichText)this.layoutRichText();else this.layoutText()},t.prototype.destory=function(){if(this.clearLines(),this.m_lines=null,this.m_defaultStyle)this.m_defaultStyle.destory(),this.m_defaultStyle=null},t}();xf.xfTextLayout=t}(xf||(xf={})),function(xf){var t=function(){function t(){this.m_parent=null,this.m_transform=null,this.m_alpha=1,this.m_visible=!0,this.m_scrollRect=null,this.p_width=0,this.p_height=0,this.touchEnable=!1,this.touchChildren=!1,this.p_runtime=null,this.m_isInited=!1,this.m_transform=new xf.Transform,this.p_runtime=window.xfruntime}return Object.defineProperty(t.prototype,"name",{get:function(){return this.m_name},set:function(t){this.m_name=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return this.m_parent},set:function(t){if(this.m_parent!==t)this.m_parent=t,this.p_runtime.redraw=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"root",{get:function(){if(this.parent)return this.parent.root;else return this},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"owner",{get:function(){return this.m_owner},set:function(t){this.m_owner=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"transform",{get:function(){return this.m_transform},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"worldTransform",{get:function(){return this.m_transform.worldTransform},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"localTransform",{get:function(){return this.m_transform.localTransform},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"alpha",{get:function(){return this.m_alpha},set:function(t){if(this.m_alpha!==t)this.m_alpha=t,this.p_runtime.redraw=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"worldAlpha",{get:function(){if(this.m_parent)return this.alpha*this.m_parent.worldAlpha;else return this.m_alpha},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"visible",{get:function(){if(this.parent)return this.m_visible&&this.parent.visible;else return this.m_visible},set:function(t){this.m_visible=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scrollRect",{get:function(){return this.m_scrollRect},set:function(t){if(!this.m_scrollRect||!this.m_scrollRect.equals(t))this.m_scrollRect=t,this.p_runtime.redraw=!0},enumerable:!0,configurable:!0}),t.prototype.setTransform=function(t,e,i,n,r,o,s,a,l){if(void 0===t)t=0;if(void 0===e)e=0;if(void 0===r)r=0;if(void 0===o)o=0;if(void 0===s)s=0;if(this.position.x!==t)this.position.x=t,this.p_runtime.redraw=!0;if(this.position.y!==e)this.position.y=e,this.p_runtime.redraw=!0;var c=!i?1:i;if(this.scale.x!==c)this.scale.x=c,this.p_runtime.redraw=!0;var u=!n?1:n;if(this.scale.y!==u)this.scale.y=u,this.p_runtime.redraw=!0;if(this.rotation!==r)this.rotation=r,this.p_runtime.redraw=!0;if(this.skew.x!==o)this.skew.x=o,this.p_runtime.redraw=!0;if(this.skew.y!==s)this.skew.y=s,this.p_runtime.redraw=!0;if(this.pivot.x!==a)this.pivot.x=a,this.p_runtime.redraw=!0;if(this.pivot.y!==l)this.pivot.y=l,this.p_runtime.redraw=!0},Object.defineProperty(t.prototype,"x",{get:function(){return this.position.x},set:function(t){if(this.position.x!==t)this.position.x=t,this.p_runtime.redraw=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this.position.y},set:function(t){if(this.position.y!==t)this.position.y=t,this.p_runtime.redraw=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"position",{get:function(){return this.m_transform.position},set:function(t){if(this.position.x!==t.x||this.position.y!==t.y)this.m_transform.position.copyFrom(t),this.p_runtime.redraw=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scale",{get:function(){return this.m_transform.scale},set:function(t){if(this.scale.x!==t.x||this.scale.y!==t.y)this.m_transform.scale.copyFrom(t),this.p_runtime.redraw=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pivot",{get:function(){return this.m_transform.pivot},set:function(t){if(this.pivot.x!==t.x||this.pivot.y!==t.y)this.m_transform.pivot.copyFrom(t),this.p_runtime.redraw=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"skew",{get:function(){return this.m_transform.skew},set:function(t){if(this.skew.x!==t.x||this.skew.y!==t.y)this.m_transform.skew.copyFrom(t),this.p_runtime.redraw=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rotation",{get:function(){return this.m_transform.rotation},set:function(t){if(this.rotation!==t)this.m_transform.rotation=t,this.p_runtime.redraw=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"angle",{get:function(){return this.m_transform.rotation*xf.RAD_TO_DEG},set:function(t){var e=t*xf.DEG_TO_RAD;if(this.rotation!==e)this.m_transform.rotation=e,this.p_runtime.redraw=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this.p_width},set:function(t){if(this.p_width!==t)this.p_width=t,this.p_runtime.redraw=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.p_height},set:function(t){if(this.p_height!==t)this.p_height=t,this.p_runtime.redraw=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"anchorOffsetX",{get:function(){return this.m_transform.pivot.x},set:function(t){if(this.anchorOffsetX!==t)this.m_transform.pivot.x=t,this.p_runtime.redraw=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"anchorOffsetY",{get:function(){return this.m_transform.pivot.y},set:function(t){if(this.anchorOffsetY!==t)this.m_transform.pivot.y=t,this.p_runtime.redraw=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scaleX",{get:function(){return this.m_transform.scale.x},set:function(t){if(this.m_transform.scale.x!==t)this.m_transform.scale.x=t,this.p_runtime.redraw=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scaleY",{get:function(){return this.m_transform.scale.y},set:function(t){if(this.m_transform.scale.y!==t)this.m_transform.scale.y=t,this.p_runtime.redraw=!0},enumerable:!0,configurable:!0}),t.prototype.updateTransform=function(){this.recursivePostUpdateTransform()},t.prototype.recursivePostUpdateTransform=function(){if(this.m_parent)this.m_parent.recursivePostUpdateTransform(),this.m_transform.updateTransform(this.m_parent.transform);else{if(!this.m_tempTramsform)this.m_tempTramsform=new xf.Transform;this.m_transform.updateTransform(this.m_tempTramsform)}},t.prototype.localToGlobal=function(t,e){if(void 0===e)e=!1;if(e)this.recursivePostUpdateTransform();return this.worldTransform.apply(t,null)},t.prototype.init=function(){},t.prototype.draw=function(t,e){if(this.visible){if(!this.m_isInited)this.init(),this.m_isInited=!0,this.p_runtime.redraw=!0;this.updateTransform()}},t.prototype.drawGL=function(t,e){if(this.visible){if(!this.m_isInited)this.init(),this.m_isInited=!0,this.p_runtime.redraw=!0;this.updateTransform()}},t.prototype.calculateBounds=function(){var t=xf.Quad.createByRect(0,0,this.width,this.height),e=new xf.Quad;t.calculateVertices(this.worldTransform,e),this.m_bounds.setTo(e.x,e.y,e.width,e.height)},t.prototype.hitTest=function(t,e){if(this.touchEnable){var i=this.scrollRect,n=this.getBounds(!0);if(!i&&n.contains(t,e)||i&&i.contains(t,e))return this}return null},t.prototype.getLocalBounds=function(t){if(!t)t=xf.Rect.create(this.x,this.y,this.width,this.height);return t},t.prototype.getBounds=function(t,e){if(t)this.recursivePostUpdateTransform();if(!e){if(!this.m_bounds)this.m_bounds=xf.Rect.create();e=this.m_bounds}return this.calculateBounds(),e.setTo(this.m_bounds.x,this.m_bounds.y,this.m_bounds.width,this.m_bounds.height)},t.prototype.addRenderList=function(){if(!this.parent){var t=this.p_runtime.drawlist;if(t.indexOf(this)<0)t.push(this),this.p_runtime.redraw=!0}},t.prototype.removeRenderList=function(){var t=this.p_runtime.drawlist,e=t.indexOf(this);if(0<=e)t.splice(e,1),this.p_runtime.redraw=!0},t.prototype.isUnderRenderList=function(){return 0<=this.p_runtime.drawlist.indexOf(this)},t.prototype.destory=function(){if(this.removeRenderList(),this.m_parent)this.m_parent.removeChild(this),this.m_parent=null;this.m_isInited=!1,this.m_scrollRect=null,this.m_transform=null,this.m_owner=null,this.p_runtime=null},t}();xf.xfDisplayObject=t}(xf||(xf={}));var __extends=(kCb=function(t,e){return(kCb=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]})(t,e)},function(t,e){function i(){this.constructor=t}kCb(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),kCb,xf;!function(xf){var t=function(l){function t(){var t=l.call(this)||this;return t.m_childs=[],t}return __extends(t,l),Object.defineProperty(t.prototype,"children",{get:function(){return this.m_childs},enumerable:!0,configurable:!0}),t.prototype.draw=function(t,e){l.prototype.draw.call(this,t,e);var i=this.m_childs,n=this.scrollRect;if(n){t.rect(n.x,n.y,n.width,n.height);for(var r=0,o=i.length;r<o;r++){if(s=i[r])s.draw(t,e)}}else for(r=0,o=i.length;r<o;r++){var s;if(s=i[r])s.draw(t,e)}},t.prototype.drawGL=function(t,e){l.prototype.drawGL.call(this,t,e);var i=this.m_childs,n=this.scrollRect;if(n){var r=e.aspect_scale;t.enableScissor(n.x*r,e.height-(n.height+n.y)*r,n.width*r,n.height*r);for(var o=0,s=i.length;o<s;o++){if(a=i[o])a.drawGL(t,e)}t.disableScissor()}else for(o=0,s=i.length;o<s;o++){var a;if(a=i[o])a.drawGL(t,e)}},t.prototype.addChild=function(t){if(t&&t.parent)t.parent.removeChild(t);return(t.parent=this).m_childs.push(t)},t.prototype.removeChild=function(t){var e=this.m_childs,i=e.indexOf(t);if(0<=i)return t.parent=null,e.splice(i,1)[0]},t.prototype.addChildAt=function(t,e){var i=this.m_childs,n=i.indexOf(t);if(n!=e)i.splice(n,1);return(t.parent=this).m_childs.splice(e,0,t)[0]},t.prototype.removeChildAt=function(t){var e=this.m_childs;if(0<=t){var i=e.splice(t,1)[0];return i.parent=null,i}return null},t.prototype.removeAll=function(){for(var t=this.m_childs,e=t.length;0<e;){var i=t.pop();if(i)i.parent=null;e--}},t.prototype.getBounds=function(){for(var t=xf.Rect.create(),e=this.m_childs,i=0,n=e.length;i<n;i++){var r=e[i];if(r)t=t.union(r.getBounds(!0))}return t},t.prototype.hitTest=function(t,e){if(this.touchChildren)for(var i=this.m_childs,n=i.length-1;0<n;n--){var r=i[n];if(r.touchEnable=!0,r&&r.hitTest(t,e))return r}return l.prototype.hitTest.call(this,t,e)},t.prototype.measuredBounds=function(){return null},t.prototype.destory=function(){for(var t=this.m_childs,e=t.length;0<e;){var i=t.pop();if(i)i.destory();e--}this.m_childs=null,l.prototype.destory.call(this)},t}(xf.xfDisplayObject);xf.xfContainer=t}(xf||(xf={}));var __extends=(pDb=function(t,e){return(pDb=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]})(t,e)},function(t,e){function i(){this.constructor=t}pDb(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),pDb,xf;!function(xf){var b,t,e=function(v){function t(){var t=v.call(this)||this;return t.m_sourceUpdate=!1,t.m_diffFillMode=!1,t.m_isClip=!1,t.m_fillMode=b.SCALE,t.m_centerFillMode=b.CLIP,t.m_clipX=t.m_clipY=t.m_clipW=t.m_clipH=0,t.m_pixelformat=0,t}return __extends(t,v),t.prototype.setClip=function(t,e,i,n,r){if(!this.m_isClip||this.m_clipX!==t||this.m_clipY!==e||this.m_clipW!==i||this.m_clipH!==n)this.m_clipX=t,this.m_clipY=e,this.m_clipW=i,this.m_clipH=n,this.m_pixelformat=r,this.m_isClip=!0,this.p_runtime.redraw=!0},Object.defineProperty(t.prototype,"scale9Grid",{get:function(){return this.m_scale9Grid},set:function(t){if(!this.m_scale9Grid||!this.m_scale9Grid.equals(t))this.m_scale9Grid=t,this.p_runtime.redraw=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"source",{get:function(){return this.m_source},set:function(t){if(this.m_source!==t){this.m_source=t,this.m_sourceUpdate=!0;var e=this.p_runtime.glwrap;if(e)e.deleteTexture(this.m_texture),e.deleteTexture(this.m_texture_bottom),e.deleteTexture(this.m_texture_center),e.deleteTexture(this.m_texture_left),e.deleteTexture(this.m_texture_right),e.deleteTexture(this.m_texture_top),this.m_texture=null,this.m_texture_bottom=null,this.m_texture_center=null,this.m_texture_left=null,this.m_texture_right=null,this.m_texture_top=null}},enumerable:!0,configurable:!0}),t.prototype.redraw=function(){this.m_sourceUpdate=!0},Object.defineProperty(t.prototype,"fillMode",{get:function(){return this.m_fillMode},set:function(t){if(window.assert2(t!==b.NONE,"centerFillMode 不支持 FillMode.NONE"),this.m_fillMode=t===b.NONE?this.m_fillMode:t,this.m_centerFillMode!==this.m_fillMode&&this.m_centerFillMode!==b.CLIP)this.m_diffFillMode=!0,this.p_runtime.redraw=!0;else this.m_diffFillMode=!1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"centerFillMode",{get:function(){return this.m_centerFillMode},set:function(t){if(window.assert2(t!==b.CLIP,"centerFillMode 不支持 FillMode.CLIP"),this.m_centerFillMode=t===b.CLIP?this.m_centerFillMode:t,this.m_centerFillMode!==this.m_fillMode&&this.m_centerFillMode!==b.CLIP)this.m_diffFillMode=!0,this.p_runtime.redraw=!0;else this.m_diffFillMode=!1},enumerable:!0,configurable:!0}),t.prototype.draw=function(t,e){if(v.prototype.draw.call(this,t,e),this.visible&&this.m_source){window.assert2(this.m_fillMode!==b.NONE,"fillMode 不支持 FillMode.NONE"),t.save();var i,n,r=this.worldTransform;if(t.globalAlpha=this.worldAlpha,t.transform(r.a,r.b,r.c,r.d,r.tx,r.ty),"undefined"!=typeof SVGImageElement&&this.m_source instanceof SVGImageElement)i=this.m_source.width.animVal.value,n=this.m_source.height.animVal.value;else i=this.m_source.width,n=this.m_source.height;var o=this.p_width,s=this.p_height;if(this.m_fillMode===b.SCALE)if(this.m_scale9Grid){var a=i-((h=this.m_scale9Grid.round()).x+h.width),l=n-(h.y+h.height),c=o-(i-h.width),u=s-(n-h.height);if(t.drawImage(this.m_source,0,0,h.x,h.y,0,0,h.x,h.y),t.drawImage(this.m_source,0,h.y,h.x,h.height,0,h.y,h.x,u),t.drawImage(this.m_source,0,h.y+h.height,h.x,l,0,h.y+u,h.x,l),t.drawImage(this.m_source,h.x,0,h.width,h.y,h.x,0,c,h.y),!this.m_diffFillMode)t.drawImage(this.m_source,h.x,h.y,h.width,h.height,h.x,h.y,c,u);t.drawImage(this.m_source,h.x,h.y+h.height,h.width,l,h.x,h.y+u,c,l),t.drawImage(this.m_source,h.x+h.width,0,a,h.y,h.x+c,0,a,h.y),t.drawImage(this.m_source,h.x+h.width,h.y,a,h.height,h.x+c,h.y,a,u),t.drawImage(this.m_source,h.x+h.width,h.y+h.height,a,l,h.x+c,h.y+u,a,l)}else t.drawImage(this.m_source,0,0,i,n,0,0,o,s);else if(this.m_fillMode===b.CLIP)if(this.m_isClip)t.drawImage(this.m_source,this.m_clipX,this.m_clipY,this.m_clipW,this.m_clipH,0,0,o,s);else t.drawImage(this.m_source,0,0,i,n,0,0,o,s);else if(this.m_scale9Grid){var h=this.m_scale9Grid.round(),d=(p=xf.createCanvas()).getContext("2d");a=i-(h.x+h.width),l=n-(h.y+h.height),c=o-(i-h.width),u=s-(n-h.height);if(t.drawImage(this.m_source,0,0,h.x,h.y,0,0,h.x,h.y),d.save(),d.drawImage(this.m_source,0,h.y,h.x,h.height),t.fillStyle=t.createPattern(p,"repeat-y"),t.fillRect(0,h.y,h.x,u),d.restore(),t.drawImage(this.m_source,0,h.y+h.height,h.x,l,0,h.y+u,h.x,l),t.drawImage(this.m_source,h.x+h.width,0,a,h.y,h.x+c,0,a,h.y),d.save(),d.drawImage(this.m_source,h.x+c,h.y,a,h.height),t.fillStyle=t.createPattern(p,"repeat-y"),t.fillRect(h.x+c,h.y,a,u),d.restore(),t.drawImage(this.m_source,h.x+h.width,h.y+h.height,a,l,h.x+c,h.y+u,a,l),d.save(),d.drawImage(this.m_source,h.x,0,h.width,h.y),t.fillStyle=t.createPattern(p,"repeat-x"),t.fillRect(h.x,0,c,h.y),d.restore(),!this.m_diffFillMode)d.save(),d.drawImage(this.m_source,h.x,h.y,h.width,h.height),t.fillStyle=t.createPattern(p,"repeat"),t.fillRect(h.x,h.y,c,u),d.restore();d.save(),d.drawImage(this.m_source,h.x,h.y+h.height,h.width,l),t.fillStyle=t.createPattern(p,"repeat-x"),t.fillRect(h.x,h.y+u,c,l),d.restore(),xf.recoverCanvas(p)}else t.fillStyle=t.createPattern(this.m_source,"repeat"),t.fillRect(0,0,o,s);if(this.m_diffFillMode&&this.m_scale9Grid){c=o-(i-(h=this.m_scale9Grid.round()).width),u=s-(n-h.height);if(this.m_centerFillMode===b.SCALE)t.drawImage(this.m_source,h.x,h.y,h.width,h.height,h.x,h.y,c,u);else if(this.m_centerFillMode===b.REPEAT){var p;(d=(p=xf.createCanvas()).getContext("2d")).save(),d.drawImage(this.m_source,h.x,h.y,h.width,h.height),t.fillStyle=t.createPattern(p,"repeat"),t.fillRect(h.x,h.y,c,u),d.restore(),xf.recoverCanvas(p)}}t.restore()}},t.prototype.drawGL=function(t,e){if(v.prototype.drawGL.call(this,t,e),this.visible&&this.m_source){var i,n;if(window.assert2(this.m_fillMode!==b.NONE,"fillMode 不支持 FillMode.NONE"),t.setOpacity(this.worldAlpha),"undefined"!=typeof SVGImageElement&&this.m_source instanceof SVGImageElement)i=this.m_source.width.animVal.value,n=this.m_source.height.animVal.value;else i=this.m_source.width,n=this.m_source.height;var r=this.p_width,o=this.p_height,s=new xf.Quad,a=new xf.Quad;if(this.m_fillMode===b.SCALE){if(!this.m_texture||this.m_sourceUpdate)if(!this.m_texture)this.m_texture=t.loadTexture(this.m_source,!1,e.linearSampling,this.m_pixelformat);else t.videoToTexture(this.m_source,this.m_texture,e.isMobile);if(t.setTexture(this.m_texture),this.m_scale9Grid){var l=i-((g=this.m_scale9Grid.round()).x+g.width),c=n-(g.y+g.height),u=r-(i-g.width),h=o-(n-g.height),d=xf.Rect.create();if(s.updateByRect(0,0,g.x,g.y),this.drawPatch(t,i,n,d.setTo(0,0,g.x,g.y),s.calculateVertices(this.worldTransform,a)),s.updateByRect(0,g.y,g.x,h),this.drawPatch(t,i,n,d.setTo(0,g.y,g.x,g.height),s.calculateVertices(this.worldTransform,a)),s.updateByRect(0,g.y+h,g.x,c),this.drawPatch(t,i,n,d.setTo(0,g.y+g.height,g.x,c),s.calculateVertices(this.worldTransform,a)),s.updateByRect(g.x,0,u,g.y),this.drawPatch(t,i,n,d.setTo(g.x,0,g.width,g.y),s.calculateVertices(this.worldTransform,a)),!this.m_diffFillMode)s.updateByRect(g.x,g.y,u,h),this.drawPatch(t,i,n,d.setTo(g.x,g.y,g.width,g.height),s.calculateVertices(this.worldTransform,a));s.updateByRect(g.x,g.y+h,u,c),this.drawPatch(t,i,n,d.setTo(g.x,g.y+g.height,g.width,c),s.calculateVertices(this.worldTransform,a)),s.updateByRect(g.x+u,0,l,g.y),this.drawPatch(t,i,n,d.setTo(g.x+g.width,0,l,g.y),s.calculateVertices(this.worldTransform,a)),s.updateByRect(g.x+u,g.y,l,h),this.drawPatch(t,i,n,d.setTo(g.x+g.width,g.y,l,g.height),s.calculateVertices(this.worldTransform,a)),s.updateByRect(g.x+u,g.y+h,l,c),this.drawPatch(t,i,n,d.setTo(g.x+g.width,g.y+g.height,l,c),s.calculateVertices(this.worldTransform,a))}else s.updateByRect(0,0,r,o),s.calculateVertices(this.worldTransform,a),t.quad(a.tlx,a.tly,a.trx,a.try,a.brx,a.bry,a.blx,a.bly)}else if(this.m_fillMode===b.CLIP){if(!this.m_texture||this.m_sourceUpdate)if(!this.m_texture)this.m_texture=t.loadTexture(this.m_source,!1,e.linearSampling,this.m_pixelformat);else t.videoToTexture(this.m_source,this.m_texture,e.isMobile);if(t.setTexture(this.m_texture),s.updateByRect(0,0,r,o),this.m_isClip)this.drawPatch(t,i,n,xf.Rect.create(this.m_clipX,this.m_clipY,this.m_clipW,this.m_clipH),s.calculateVertices(this.worldTransform,a));else s.calculateVertices(this.worldTransform,a),t.quad(a.tlx,a.tly,a.trx,a.try,a.brx,a.bry,a.blx,a.bly)}else{if(!this.m_texture||this.m_sourceUpdate)if(!this.m_texture)this.m_texture=t.loadTexture(this.m_source,!1,e.linearSampling,this.m_pixelformat);else t.videoToTexture(this.m_source,this.m_texture,e.isMobile);if(t.setTexture(this.m_texture),this.m_scale9Grid){l=i-((g=this.m_scale9Grid.round()).x+g.width),c=n-(g.y+g.height),u=r-(i-g.width),h=o-(n-g.height),d=xf.Rect.create();s.updateByRect(0,0,g.x,g.y),this.drawPatch(t,i,n,d.setTo(0,0,g.x,g.y),s.calculateVertices(this.worldTransform,a)),s.updateByRect(0,g.y+h,g.x,c),this.drawPatch(t,i,n,d.setTo(0,g.y+g.height,g.x,c),s.calculateVertices(this.worldTransform,a)),s.updateByRect(g.x+u,0,l,g.y),this.drawPatch(t,i,n,d.setTo(g.x+g.width,0,l,g.y),s.calculateVertices(this.worldTransform,a)),s.updateByRect(g.x+u,g.y+h,l,c),this.drawPatch(t,i,n,d.setTo(g.x+g.width,g.y+g.height,l,c),s.calculateVertices(this.worldTransform,a));var p=Math.min(g.height,h);if(!this.m_texture_left||this.m_sourceUpdate){var f=xf.clipImage(this.m_source,0,g.y,g.x,p);if(this.m_texture_left)t.videoToTexture(f,this.m_texture_left,e.isMobile);else this.m_texture_left=t.loadTexture(f,!0,e.linearSampling,this.m_pixelformat,"repeat-y")}t.setTexture(this.m_texture_left),s.updateByRect(0,g.y,g.x,p),this.tilePatch(t,g.x,p,s.calculateVertices(this.worldTransform,a));var m=Math.min(g.width,u);if(!this.m_texture_top||this.m_sourceUpdate){f=xf.clipImage(this.m_source,g.x,0,m,g.y);if(this.m_texture_top)t.videoToTexture(f,this.m_texture_top,e.isMobile);else this.m_texture_top=t.loadTexture(f,!0,e.linearSampling,this.m_pixelformat,"repeat-x")}if(t.setTexture(this.m_texture_top),s.updateByRect(g.x,0,m,g.y),this.tilePatch(t,m,g.y,s.calculateVertices(this.worldTransform,a)),!this.m_diffFillMode){if(!this.m_texture_center||this.m_sourceUpdate){f=xf.clipImage(this.m_source,g.x,g.y,m,p);if(this.m_texture_center)t.videoToTexture(f,this.m_texture_center,e.isMobile);else this.m_texture_center=t.loadTexture(f,!0,e.linearSampling,this.m_pixelformat)}t.setTexture(this.m_texture_center),s.updateByRect(g.x,g.y,m,p),this.tilePatch(t,m,p,s.calculateVertices(this.worldTransform,a))}if(!this.m_texture_bottom||this.m_sourceUpdate){f=xf.clipImage(this.m_source,g.x,g.y+g.height,m,c);if(this.m_texture_bottom)t.videoToTexture(f,this.m_texture_bottom,e.isMobile);else this.m_texture_bottom=t.loadTexture(f,!0,e.linearSampling,this.m_pixelformat,"repeat-x")}if(t.setTexture(this.m_texture_bottom),s.updateByRect(g.x,g.y+h,m,c),this.tilePatch(t,m,c,s.calculateVertices(this.worldTransform,a)),!this.m_texture_right||this.m_sourceUpdate){f=xf.clipImage(this.m_source,g.x+g.width,g.y,l,p);if(this.m_texture_right)t.videoToTexture(f,this.m_texture_right,e.isMobile);else this.m_texture_right=t.loadTexture(f,!0,e.linearSampling,this.m_pixelformat,"repeat-y")}t.setTexture(this.m_texture_right),s.updateByRect(g.x+u,g.y,l,p),this.tilePatch(t,l,p,s.calculateVertices(this.worldTransform,a))}else{m=Math.min(i,r),p=Math.min(n,o);s.updateByRect(0,0,m,p),this.tilePatch(t,m,p,s.calculateVertices(this.worldTransform,a))}}if(this.m_diffFillMode&&this.m_scale9Grid){var g;u=r-(i-(g=this.m_scale9Grid.round()).width),h=o-(n-g.height),d=xf.Rect.create();if(this.m_centerFillMode===b.SCALE)t.setTexture(this.m_texture),s.updateByRect(g.x,g.y,u,h),this.drawPatch(t,i,n,d.setTo(g.x,g.y,g.width,g.height),s.calculateVertices(this.worldTransform,a));else if(this.m_centerFillMode===b.REPEAT){m=Math.min(g.width,u),p=Math.min(g.height,h);if(!this.m_texture_center||this.m_sourceUpdate){var y=xf.clipImage(this.m_source,g.x,g.y,m,p);if(this.m_texture_center)t.videoToTexture(y,this.m_texture_center,e.isMobile);else this.m_texture_center=t.loadTexture(y,!1,e.linearSampling,this.m_pixelformat)}t.setTexture(this.m_texture_center),s.updateByRect(g.x,g.y,m,p),this.tilePatch(t,m,p,s.calculateVertices(this.worldTransform,a))}}this.m_sourceUpdate=!1}},t.prototype.drawPatch=function(t,e,i,n,r){var o=n.x,s=n.y,a=n.x+n.width,l=n.y+n.height,c=xf.UV.create(o/e,s/i,a/e,l/i);t.quadTex(r.tlx,r.tly,r.trx,r.try,r.brx,r.bry,r.blx,r.bly,c)},t.prototype.tilePatch=function(t,e,i,n){var r=xf.UV.create(0,0,n.width/e,n.height/i);t.quadTex(n.tlx,n.tly,n.trx,n.try,n.brx,n.bry,n.blx,n.bly,r)},t.prototype.measuredBounds=function(){return null},t.prototype.destory=function(){var t=this.p_runtime.glwrap;if(t)t.deleteTexture(this.m_texture_bottom),t.deleteTexture(this.m_texture_center),t.deleteTexture(this.m_texture_left),t.deleteTexture(this.m_texture_right),t.deleteTexture(this.m_texture_top),this.m_texture=null,this.m_texture_bottom=null,this.m_texture_center=null,this.m_texture_left=null,this.m_texture_right=null,this.m_texture_top=null;if(this.m_scale9Grid)this.m_scale9Grid.destory(),this.m_scale9Grid=null;this.m_source=null,v.prototype.destory.call(this)},t}(xf.xfDisplayObject);xf.xfImage=e,(t=b=xf.FillMode||(xf.FillMode={}))[t.SCALE=0]="SCALE",t[t.CLIP=1]="CLIP",t[t.REPEAT=2]="REPEAT",t[t.NONE=3]="NONE"}(xf||(xf={}));var __extends=(TEb=function(t,e){return(TEb=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]})(t,e)},function(t,e){function i(){this.constructor=t}TEb(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),TEb,xf;!function(xf){var t,e,i=function(I){function t(t){var e=I.call(this)||this;if(e.m_isChanged=!1,e.alpha=1,e.m_typewriter=!1,e.m_isTypeComplete=!1,e.m_typeInterval=100,e.m_lastType=0,e.m_typeIndex=0,e.m_layout=new xf.xfTextLayout,e.m_scrollPoint=new xf.ObservablePoint(e.updateScrollPoint,e,0,0),t)e.m_layout.defaultStyle.copyAll(t);return e}return __extends(t,I),Object.defineProperty(t.prototype,"scrollX",{get:function(){return this.m_scrollPoint.x},set:function(t){this.m_scrollPoint.x=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scrollY",{get:function(){return this.m_scrollPoint.y},set:function(t){this.m_scrollPoint.y=t},enumerable:!0,configurable:!0}),t.prototype.updateScrollPoint=function(){this.p_runtime.redraw=!0,this.m_isChanged=!0},Object.defineProperty(t.prototype,"typeIndex",{get:function(){return this.m_typeIndex},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"defaultStyle",{get:function(){return this.m_layout.defaultStyle},set:function(t){if(this.m_layout.defaultStyle.checkUpdate(t))this.m_layout.defaultStyle.copyAll(t),this.m_isChanged=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"text",{get:function(){return this.m_layout.text},set:function(t){if(t=t||"",this.m_layout.text!=t)this.m_layout.text=t,this.m_layout.isRichText=!1,this.m_firstLayout=!0,this.m_isChanged=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"richText",{get:function(){return this.m_layout.text},set:function(t){if(t=t||"",this.m_layout.text!=t)this.m_layout.text=t,this.m_layout.isRichText=!0,this.m_firstLayout=!0,this.m_isChanged=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"textWidth",{get:function(){return this.doLayout(),this.m_layout.textWidth},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"textHeight",{get:function(){return this.doLayout(),this.m_layout.textHeight},enumerable:!0,configurable:!0}),t.prototype.setTypewriterEnable=function(t){this.m_isChanged=!0,this.m_typewriter=t,this.m_isTypeComplete=!t,this.m_lastType=0,this.m_typeIndex=0},Object.defineProperty(t.prototype,"multiline",{get:function(){return this.m_layout.multiline},set:function(t){this.m_layout.multiline=t,this.m_isChanged=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lineSpace",{get:function(){return this.m_layout.lineSpace},set:function(t){this.m_layout.lineSpace=t,this.m_isChanged=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"typeInterval",{get:function(){return this.m_typeInterval},set:function(t){this.m_typeInterval=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isTypeState",{get:function(){return this.m_typewriter},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isTypeComplete",{get:function(){return this.m_isTypeComplete},enumerable:!0,configurable:!0}),t.prototype.setTypeComplete=function(t,e){if(t&&e)this.m_typeComplete=t.bind(e)},t.prototype.doLayout=function(){if(this.m_isChanged)this.m_layout.width=this.p_width,this.m_layout.height=this.p_height,this.m_layout.doLayout()},t.prototype.checkUpdate=function(){var t=Date.now();if(t-this.m_lastType>=this.m_typeInterval)return this.m_lastType=t,this.m_typeIndex++,!0;else return!1},t.prototype.draw=function(t,e){var i=this;if(I.prototype.draw.call(this,t,e),this.visible)if(this.m_layout.text)if(this.p_width&&this.p_height&&!(this.p_width<1&&this.p_height<1)){if(this.doLayout(),this.m_firstLayout){switch(this.defaultStyle.vAlign){case xf.VerticalAlign.BOTTOM:this.scrollY=this.height-this.m_layout.textHeight;break;case xf.VerticalAlign.MIDDLE:this.scrollY=.5*(this.height-this.m_layout.textHeight);break;case xf.VerticalAlign.TOP:this.scrollY=0}this.m_firstLayout=!1}var n=e.isMinigame?1:e.aspect_scale<1?1:e.aspect_scale,r=Math.ceil(this.width*n),o=Math.ceil(this.height*n),s=xf.createCanvas(r,o),a=s.getContext("2d");if(a.scale(n,n),a.globalAlpha=1,this.defaultStyle.backgroundColor)a.fillStyle=this.defaultStyle.backgroundColor,a.fillRect(0,0,r,o);if(this.m_typewriter)this.checkUpdate();for(var l=this.m_typeIndex,c=!1,u=!0,h=this.m_layout.lines,d=0,p=h.length;d<p;d++){for(var f=h[d].blocks,m=0,g=f.length;m<g;m++){var y=f[m];if(y){if(y.rect.y+y.rect.height+this.scrollY<0)continue;if(y.rect.y+this.scrollY>this.height)continue;var v=y.style;a.font=v.getFont(),a.fillStyle=v.color,a.textBaseline="top";var b=e.gl?"arial"===v.fontFamily.toLowerCase()?2:0:0;if(this.m_typewriter){var _=y.text.substr(0,l);if(a.fillText(_,y.rect.x,b+y.rect.y+this.scrollY),(l-=_.length)<=0){c=!0;break}}else a.fillText(y.text,y.rect.x,b+y.rect.y+this.scrollY)}}if(c){u=!1;break}}if(!window.xfruntime.glwrap){t.save();var w=this.worldTransform,x=this.width,S=this.height;t.drawImage(s,0,0,s.width,s.height,w.tx,w.ty,x,S),t.restore()}else t.videoToTexture(s,this.m_texture,e.isMobile);if(xf.recoverCanvas(s),this.m_isTypeComplete=u,this.m_typewriter&&u)if(this.m_typewriter=!1,this.m_typeComplete)setTimeout(function(){i.m_typeComplete()},0)}},t.prototype.drawGL=function(t,e){if(I.prototype.drawGL.call(this,t,e),this.visible)if(this.m_layout.text)if(this.p_width&&this.p_height&&!(this.p_width<1&&this.p_height<1)){var i=e.glwrap.maxTextureSize,n=Math.min(this.width,i),r=Math.min(this.height,i),o=this.m_texture;if(this.m_isChanged||this.m_typewriter&&!this.m_isTypeComplete){if(o&&(o.c2width!==n||o.c2height!==r))if(o)t.deleteTexture(o),o=null;if(!o)o=t.createEmptyTexture(n,r,e.linearSampling,e.isMobile),this.m_texture=o;this.draw(t,e),this.m_isChanged=!1}var s=new xf.Quad;s.updateByRect(0,0,this.width,this.height),xf.drawGLImage(t,o,this.worldAlpha,s.calculateVertices(this.worldTransform))}},t.prototype.destory=function(){if(this.m_typeComplete=null,this.m_layout)this.m_layout.destory(),this.m_layout=null;if(this.m_texture)xf.deleteTexture(this.m_texture),this.m_texture=null;if(this.m_scrollPoint)this.m_scrollPoint.cb=null,this.m_scrollPoint.scope=null,this.m_scrollPoint=null;I.prototype.destory.call(this)},t}(xf.xfDisplayObject);xf.xfText=i,(t=xf.VerticalAlign||(xf.VerticalAlign={})).TOP="top",t.MIDDLE="middle",t.BOTTOM="bottom",(e=xf.HorizontalAlign||(xf.HorizontalAlign={})).LEFT="left",e.CENTER="center",e.RIGHT="right"}(xf||(xf={}));var __extends=(CGb=function(t,e){return(CGb=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]})(t,e)},function(t,e){function i(){this.constructor=t}CGb(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),CGb,xf,xf,xf,xf,xf,xf;function _typeof(t){if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator)_typeof=function(t){return typeof t};else _typeof=function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};return _typeof(t)}function _typeof(t){if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator)_typeof=function(t){return typeof t};else _typeof=function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};return _typeof(t)}function _typeof(t){if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator)_typeof=function(t){return typeof t};else _typeof=function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};return _typeof(t)}function _typeof(t){if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator)_typeof=function(t){return typeof t};else _typeof=function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};return _typeof(t)}function _typeof(t){if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator)_typeof=function(t){return typeof t};else _typeof=function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};return _typeof(t)}function _typeof(t){if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator)_typeof=function(t){return typeof t};else _typeof=function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};return _typeof(t)}!function(xf){var a,t,l=function(t,e){this.offsetX=t,this.offsetY=e};xf.ScrollEvent=l,(t=a=xf.ScrollDirection||(xf.ScrollDirection={}))[t.HORIZONTAL=0]="HORIZONTAL",t[t.VERTICAL=1]="VERTICAL";var e=function(i){function r(){var e=i.call(this)||this;if(e.m_visibleView=null,e.m_visibleRect=null,e.m_contentView=null,e.m_touchEnabled=!1,e.m_touch_start=null,e.m_touch_move=null,e.m_touch_end=null,e.m_touch_cancel=null,e.m_lastTouchX=0,e.m_lastTouchY=0,e.m_startTouchX=0,e.m_startTouchY=0,e.m_orientation=0,e.m_moveDistance=0,e.m_scroll_ticker=null,e.m_rebound_ticker=null,e.m_maxContainerOffsetX=0,e.m_maxContainerOffsetY=0,e.m_minContainerOffsetX=0,e.m_minContainerOffsetY=0,e.m_bTouchedOuter=!0,e.autoControl=!0,e.onScroll=function(t){},e.m_visibleView=new xf.xfContainer,e.addChild(e.m_visibleView),e.m_touch_start=function(t){if(e.m_touchEnabled)e.doTouchStart(t)},e.m_touch_move=function(t){if(e.m_touchEnabled)e.doTouchMove(t)},e.m_touch_end=function(t){if(e.m_touchEnabled)e.doTouchEnd(t)},e.setTouchEnabled(!0),e.p_runtime.isMobile){if(xf.getSupportsPassive())e.p_runtime.canvas.addEventListener("touchstart",e.m_touch_start,{passive:!0}),e.p_runtime.canvas.addEventListener("touchmove",e.m_touch_move,{passive:!0});else e.p_runtime.canvas.addEventListener("touchstart",e.m_touch_start),e.p_runtime.canvas.addEventListener("touchmove",e.m_touch_move);e.p_runtime.canvas.addEventListener("touchend",e.m_touch_end),document.addEventListener("touchend",e.m_touch_end)}else if(e.p_runtime.canvas.addEventListener("mousedown",e.m_touch_start),e.p_runtime.canvas.addEventListener("mousemove",e.m_touch_move),e.p_runtime.canvas.addEventListener("mouseup",e.m_touch_end),e.p_runtime.canvas.addEventListener("mouseout",e.m_touch_end),document)document.addEventListener("mouseup",e.m_touch_end),document.addEventListener("mouseout",e.m_touch_end);return e}return __extends(r,i),Object.defineProperty(r.prototype,"touchedOuter",{get:function(){return this.m_bTouchedOuter},set:function(t){this.m_bTouchedOuter=t},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"direction",{get:function(){return this.m_orientation},set:function(t){this.m_orientation=t},enumerable:!0,configurable:!0}),r.prototype.setVisibleRect=function(t){if(null!=t)this.m_visibleRect=t,this._initView()},r.prototype._initView=function(){if(0!==this.width&&0!==this.height){if(null!=this.m_visibleRect){var t=this.m_visibleView.localToGlobal(xf.Point.create(0,0),!0);this.m_visibleView.scrollRect=xf.Rect.create(t.x,t.y,this.m_visibleRect.width,this.m_visibleRect.height),this.m_visibleView.width=this.m_visibleRect.width,this.m_visibleView.height=this.m_visibleRect.height}}else console.log("xfScroller _initView error: width && height is ",this.width,this.height)},r.prototype.setTouchEnabled=function(t){this.m_touchEnabled=t},r.prototype.setContentView=function(t){if(null===this.m_contentView)this.m_contentView=t,this.m_visibleView.addChild(this.m_contentView),this.m_contentView.x=0,this.m_contentView.y=0},r.prototype.measuredBounds=function(){return null},r.prototype.draw=function(t,e){this.visit(),i.prototype.draw.call(this,t,e)},r.prototype.drawGL=function(t,e){this.visit(),i.prototype.drawGL.call(this,t,e)},r.prototype.doTouchStart=function(t){var e,i;if(this.p_runtime.isMobile)e=t.changedTouches[0].pageX,i=t.changedTouches[0].pageY;else e=t.pageX,i=t.pageY;var n=xf.pageToGlobal(e,i);if(this.getBounds().contains(n.x,n.y))this.m_moveDistance=0,this.m_scroll_ticker=null,this.m_rebound_ticker=null,this.m_lastTouchX=this.m_startTouchX=n.x,this.m_lastTouchY=this.m_startTouchY=n.y},r.prototype.doTouchMove=function(t){var e,i;if(this.p_runtime.isMobile)e=t.changedTouches[0].pageX,i=t.changedTouches[0].pageY;else e=t.pageX,i=t.pageY;var n=xf.pageToGlobal(e,i),r=!1;if(this.m_bTouchedOuter)r=!0;else{if(this.getBounds().contains(n.x,n.y))r=!0}if(r)if(0!=this.m_startTouchX&&0!=this.m_startTouchY&&null!=this.m_contentView){var o=n.x-this.m_lastTouchX,s=n.y-this.m_lastTouchY;if(this.m_lastTouchX=n.x,this.m_lastTouchY=n.y,this.minContainerOffset(),this.maxContainerOffset(),!this.autoControl)return void this.onScroll(new l(o,s));if(this.m_orientation===a.HORIZONTAL)this.m_moveDistance=o,this.m_contentView.x+=o;if(this.m_orientation===a.VERTICAL)this.m_moveDistance=s,this.m_contentView.y+=s}},r.prototype.doTouchEnd=function(t){var e,i;if(this.p_runtime.isMobile)e=t.changedTouches[0].pageX,i=t.changedTouches[0].pageY;else e=t.pageX,i=t.pageY;var n=xf.pageToGlobal(e,i);if(0<this.m_startTouchX&&0<this.m_startTouchY){this.m_startTouchX=0,this.m_startTouchY=0;var r=this.localToGlobal(xf.Point.create(0,0));if(n.x<r.x&&n.x>r.x+this.width&&n.y<r.y&&n.y>r.y+this.height)this.m_moveDistance=0;if(!this.autoControl)return;this.deaccelerateScrolling()}},r.prototype.deaccelerateRebound=function(){var e=this;if(this.m_rebound_ticker)this.m_rebound_ticker=null;if(null!==this.m_contentView){if(this.m_orientation===a.VERTICAL)if(this.m_contentView.height<this.m_visibleView.height)this.m_rebound_ticker=function(){var t=e.m_contentView.y/2;if(e.m_contentView.y+=-t,Math.abs(t)<=r.BOUNCE_DURATION)e.m_contentView.y=0,e.m_rebound_ticker=null;e.p_runtime.redraw=!0};else if(0<this.m_contentView.y)this.m_rebound_ticker=function(){var t=e.m_contentView.y/2;if(e.m_contentView.y+=-t,Math.abs(t)<=r.BOUNCE_DURATION)e.m_contentView.y=0,e.m_rebound_ticker=null;e.p_runtime.redraw=!0};else{var i=0;if(this.m_contentView.height>this.m_visibleView.height)i=-(this.m_contentView.height-this.m_visibleView.height);if(this.m_contentView.y<i)this.m_rebound_ticker=function(){var t=(e.m_contentView.y-i)/2;if(e.m_contentView.y-=t,Math.abs(t)<=r.BOUNCE_DURATION)e.m_contentView.y=i,e.m_rebound_ticker=null;e.p_runtime.redraw=!0}}if(this.m_orientation===a.HORIZONTAL){if(0<this.m_contentView.x)this.m_rebound_ticker=function(){var t=e.m_contentView.x/2;if(e.m_contentView.x+=-t,Math.abs(t)<=r.BOUNCE_DURATION)e.m_contentView.x=0,e.m_rebound_ticker=null;e.p_runtime.redraw=!0};if(this.m_contentView.x<-(this.m_contentView.width-this.m_visibleView.width))this.m_rebound_ticker=function(){e.minContainerOffset();var t=(e.m_contentView.x- -(e.m_contentView.width-e.m_visibleView.width))/2;if(e.m_contentView.x+=-t,Math.abs(t)<=r.BOUNCE_DURATION)e.m_contentView.x=-(e.m_contentView.width-e.m_visibleView.width),e.m_rebound_ticker=null;e.p_runtime.redraw=!0}}}},r.prototype.setContentOffset=function(t,e){this.minContainerOffset(),this.maxContainerOffset();var i=!1;if(t<0){if(this.m_contentView.x<this.m_minContainerOffsetX)this.m_contentView.x=this.m_minContainerOffsetX,i=!0}else if(0<t)if(this.m_contentView.x>this.m_maxContainerOffsetX)this.m_contentView.x=this.m_maxContainerOffsetX,i=!0;if(e<0){if(this.m_contentView.y<this.m_minContainerOffsetY)this.m_contentView.y=this.m_minContainerOffsetY,i=!0}else if(0<e)if(this.m_contentView.y>this.m_maxContainerOffsetY)this.m_contentView.y=this.m_maxContainerOffsetY,i=!0;return i},r.prototype.deaccelerateScrolling=function(){var n=this;if(null!=this.m_scroll_ticker)this.m_scroll_ticker=null;this.m_scroll_ticker=function(){var t=0,e=0;if(n.m_orientation===a.HORIZONTAL)t=n.m_moveDistance;if(n.m_orientation===a.VERTICAL)e=n.m_moveDistance;var i=!1;if(n.m_contentView)n.m_contentView.x+=t,n.m_contentView.y+=e,i=n.setContentOffset(t,e);if(n.m_moveDistance=n.m_moveDistance*r.SCROLL_DEACCEL_RATE,Math.abs(n.m_moveDistance)<=r.SCROLL_DEACCEL_DIST||!0===i)n.m_moveDistance=0,n.m_scroll_ticker=null,n.deaccelerateRebound();n.p_runtime.redraw=!0},this.visit()},r.prototype.visit=function(){if(null!=this.m_scroll_ticker)this.m_scroll_ticker();if(null!=this.m_rebound_ticker)this.m_rebound_ticker()},r.prototype.destory=function(){if(this.m_contentView=null,this.m_visibleRect=null,this.m_visibleView=null,this.p_runtime.isMobile)this.p_runtime.canvas.removeEventListener("touchstart",this.m_touch_start),this.p_runtime.canvas.removeEventListener("touchmove",this.m_touch_move),this.p_runtime.canvas.removeEventListener("touchend",this.m_touch_end),document.removeEventListener("touchend",this.m_touch_end);else this.p_runtime.canvas.removeEventListener("mousedown",this.m_touch_start),this.p_runtime.canvas.removeEventListener("mousemove",this.m_touch_move),this.p_runtime.canvas.removeEventListener("mouseup",this.m_touch_end),this.p_runtime.canvas.removeEventListener("mouseout",this.m_touch_end),document.removeEventListener("mouseup",this.m_touch_end),document.removeEventListener("mouseout",this.m_touch_end);this.m_touch_end=null,this.m_touch_move=null,this.m_touch_start=null,this.m_scroll_ticker=null,this.m_rebound_ticker=null,i.prototype.destory.call(this)},r.prototype.maxContainerOffset=function(){this.m_maxContainerOffsetX=this.m_visibleView.width,this.m_maxContainerOffsetY=this.m_visibleView.height},r.prototype.minContainerOffset=function(){if(this.m_contentView)this.m_minContainerOffsetX=-this.m_contentView.width,this.m_minContainerOffsetY=-this.m_contentView.height},r.SCROLL_DEACCEL_RATE=.95,r.SCROLL_DEACCEL_DIST=1,r.BOUNCE_DURATION=1,r}(xf.xfContainer);xf.xfScroller=e}(xf||(xf={})),function(xf){window.XfEventCache=null;var t=function(){function e(t){this.clickQueue=[],this.mousemoveQueue=[],this.mousedownQueue=[],this.mouseupQueue=[],this.isMousedownMap={},this.mouseoverQueue=[],this.mouseoutQueue=[],this.dblclickQueue=[],this.touchstartQueue=[],this.isTouchstartMap={},this.touchmoveQueue=[],this.touchendQueue=[],this.touchcancelQueue=[],this.outFlag=[],this.overFlag=[],this.m_touch_start=function(){},this.m_touch_move=function(){},this.m_touch_end=function(){},this.m_touch_cancel=function(){},this.m_click=function(){},this.m_mouse_move=function(){},this.m_mouse_down=function(){},this.m_mouse_up=function(){},this.m_mouse_over=function(){},this.m_mouse_out=function(){},this.m_db_click=function(){},this.m_touch_start=this.touchstartHand.bind(this),this.m_touch_move=this.touchmoveHand.bind(this),this.m_touch_end=this.touchendHand.bind(this),this.m_touch_cancel=this.touchendHand.bind(this),this.m_click=this.clickHand.bind(this),this.m_mouse_move=this.mousemoveHand.bind(this),this.m_mouse_down=this.mousedownHand.bind(this),this.m_mouse_up=this.mouseupHand.bind(this),this.m_mouse_over=this.mouseoverHand.bind(this),this.m_mouse_out=this.mouseoutHand.bind(this),this.m_db_click=this.dblclickHand.bind(this),this.init(t)}return e.create=function(t){if(null==e.s_instance)e.s_instance=new e(t);return e.s_instance},e.prototype.init=function(t){this.isMicrosoftEdge=/edge\//i.test(navigator.userAgent),this.isIE=(/msie/i.test(navigator.userAgent)||/trident/i.test(navigator.userAgent)||/iemobile/i.test(navigator.userAgent))&&!this.isMicrosoftEdge,this.isTizen=/tizen/i.test(navigator.userAgent),this.isAndroid=/android/i.test(navigator.userAgent)&&!this.isTizen&&!this.isIE&&!this.isMicrosoftEdge,this.isiPhone=(/iphone/i.test(navigator.userAgent)||/ipod/i.test(navigator.userAgent))&&!this.isIE&&!this.isMicrosoftEdge,this.isiPad=xf.isIpad(),this.isiOS=this.isiPhone||this.isiPad,this.runtime=t,this.elm=t.canvas,this.addCanvasEvent()},e.prototype.handleEvent=function(t,e){if(!xf.MessageBox.isMessageBoxShow())if(t.inst.visible)if(this.isAndroid||this.isiOS){if("touchcancel"==t.type)t.handle(e);else if("touchend"==t.type){if(this.isTouchstartMap[t.inst.uid])t.handle(e),this.isTouchstartMap[t.inst.uid]=!1}else if(this.mobileContains(t,e)){if("touchstart"==t.type)this.isTouchstartMap[t.inst.uid]=!0;t.handle(e)}}else if("mouseout"==t.type)t.handle(e);else if("mouseup"==t.type){if(this.isMousedownMap[t.inst.uid])t.handle(e),this.isMousedownMap[t.inst.uid]=!1}else if(this.contains(t,e)){if("mousedown"==t.type)this.isMousedownMap[t.inst.uid]=!0;t.handle(e)}},e.prototype.clickHand=function(e){var i=this;this.clickQueue.map(function(t){i.handleEvent(t,e)})},e.prototype.mousemoveHand=function(i){var n=this;this.mousemoveQueue.map(function(t){n.handleEvent(t,i)}),this.mouseoverQueue.map(function(t,e){if(n.contains(t,i)&&t.inst.visible&&!n.overFlag[e])n.handleEvent(t,i),n.overFlag[e]=!0,n.outFlag[e]=!1}),this.mouseoutQueue.map(function(t,e){if(!n.contains(t,i)&&t.inst.visible&&!n.outFlag[e]&&n.overFlag[e])n.handleEvent(t,i),n.overFlag[e]=!1,n.outFlag[e]=!0})},e.prototype.mousedownHand=function(e){var i=this;this.mousedownQueue.map(function(t){i.handleEvent(t,e)})},e.prototype.mouseupHand=function(e){var i=this;this.mouseupQueue.map(function(t){i.handleEvent(t,e)})},e.prototype.mouseoverHand=function(i){var n=this;this.mouseoverQueue.map(function(t,e){if(n.contains(t,i)&&t.inst.visible&&!n.overFlag[e])n.handleEvent(t,i),n.overFlag[e]=!0,n.outFlag[e]=!1})},e.prototype.mouseoutHand=function(i){var n=this;this.mouseoutQueue.map(function(t,e){if(!n.contains(t,i)&&t.inst.visible&&!n.outFlag[e]&&n.overFlag[e])n.handleEvent(t,i),n.overFlag[e]=!1,n.outFlag[e]=!0})},e.prototype.dblclickHand=function(e){var i=this;this.dblclickQueue.map(function(t){i.handleEvent(t,e)})},e.prototype.touchstartHand=function(e){var i=this;this.touchstartQueue.map(function(t){i.handleEvent(t,e)})},e.prototype.touchmoveHand=function(e){var i=this;this.touchmoveQueue.map(function(t){i.handleEvent(t,e)})},e.prototype.touchendHand=function(e){var i=this;this.touchendQueue.map(function(t){i.handleEvent(t,e)})},e.prototype.touchcancelHand=function(e){var i=this;this.touchcancelQueue.map(function(t){i.handleEvent(t,e)})},e.prototype.contains=function(t,e){var i=e.pageX-this.runtime.canvas.offsetLeft,n=e.pageY-this.runtime.canvas.offsetTop,r=t.inst,o=xf.checkTouchable(r,i,n);if(t.props&&t.props.isClickCanvas&&"click"==t.type)return o=this.checkTouchable(r,i,n);if(t.props&&t.props.displayObject){var s=t.props.displayObject.getBounds(),a=r.layer.canvasToLayer(i,n,!0),l=r.layer.canvasToLayer(i,n,!1);o=s.contains(a,l)}return o},e.prototype.mobileContains=function(t,e){var i,n,r,o,s,a,l,c=t.inst;for(i=0,n=e.changedTouches.length;i<n;i++){r=e.changedTouches[i];var u=drama.convertPageXY(r.pageX,r.pageY);o=u.pageX,s=u.pageY}a=o-this.runtime.canvas.offsetLeft,l=s-this.runtime.canvas.offsetTop;var h=xf.checkTouchable(c,a,l);if(!h&&t.props&&t.props.isTouchStartCanvas&&"touchstart"==t.type)return h=this.checkTouchable(c,a,l);if(t.props&&t.props.displayObject){var d=t.props.displayObject.getBounds(),p=c.layer.canvasToLayer(a,l,!0),f=c.layer.canvasToLayer(a,l,!1);h=d.contains(p,f)}return h},e.prototype.checkTouchable=function(t,e,i){var n=t.layer,r=n.layout.layers,o=t.layer.getFirstTouch(e,i);if(o&&n.instances.indexOf(o)>n.instances.indexOf(t))return!1;else{for(var s=n.index+1,a=r.length;s<a;s++){if(o=r[s].getFirstTouch(e,i))return!1;break}return!0}},e.prototype.addCanvasEvent=function(){var t=xf.getSupportsPassive(),e=this.elm;if(this.isAndroid||this.isiOS){if(t)e.addEventListener("touchstart",this.m_touch_start,{passive:!0}),e.addEventListener("touchmove",this.m_touch_move,{passive:!0});else e.addEventListener("touchstart",this.m_touch_start),e.addEventListener("touchmove",this.m_touch_move);e.addEventListener("touchend",this.m_touch_end),e.addEventListener("touchcancel",this.m_touch_cancel)}else e.addEventListener("click",this.m_click),e.addEventListener("mousemove",this.m_mouse_move),e.addEventListener("mousedown",this.m_mouse_down),e.addEventListener("mouseup",this.m_mouse_up),e.addEventListener("mouseover",this.m_mouse_over),e.addEventListener("mouseout",this.m_mouse_out),e.addEventListener("dblclick",this.m_db_click)},e.prototype.destoryEvent=function(){var t=this.elm;if(this.isAndroid||this.isiOS)t.removeEventListener("touchstart",this.m_touch_start,!1),t.removeEventListener("touchmove",this.m_touch_move,!1),t.removeEventListener("touchend",this.m_touch_end,!1),t.removeEventListener("touchcancel",this.m_touch_cancel,!1);else t.removeEventListener("click",this.m_click,!1),t.removeEventListener("mousemove",this.m_mouse_move,!1),t.removeEventListener("mousedown",this.m_mouse_down,!1),t.removeEventListener("mouseup",this.m_mouse_up,!1),t.removeEventListener("mouseover",this.m_mouse_over,!1),t.removeEventListener("mouseout",this.m_mouse_out,!1),t.removeEventListener("dblclick",this.m_db_click,!1)},e.prototype.addEventListener=function(t,e,i,n){var r=[];switch(t){case"click":r=this.clickQueue;break;case"mousemove":r=this.mousemoveQueue;break;case"mousedown":r=this.mousedownQueue;break;case"mouseup":r=this.mouseupQueue;break;case"mouseover":r=this.mouseoverQueue;break;case"mouseout":r=this.mouseoutQueue;break;case"dblclick":r=this.dblclickQueue;break;case"touchstart":r=this.touchstartQueue;break;case"touchmove":r=this.touchmoveQueue;break;case"touchend":r=this.touchendQueue;break;case"touchcancel":r=this.touchcancelQueue}r.push({type:t,handle:e.bind(i),inst:i,props:n})},e.prototype.removeEventListeners=function(t,e){var i=this;t.map(function(t){i.removeEventListener(t,e)})},e.prototype.removeEventListener=function(t,i){var n=[];switch(t){case"click":n=this.clickQueue;break;case"mousemove":n=this.mousemoveQueue;break;case"mousedown":n=this.mousedownQueue;break;case"mouseup":n=this.mouseupQueue;break;case"mouseover":n=this.mouseoverQueue;break;case"mouseout":n=this.mouseoutQueue;break;case"dblclick":n=this.dblclickQueue;break;case"touchstart":n=this.touchstartQueue;break;case"touchmove":n=this.touchmoveQueue;break;case"touchend":n=this.touchendQueue;break;case"touchcancel":n=this.touchcancelQueue}n.map(function(t,e){if(t.inst.uid==i.uid&&n[e])n[e].handle=null,n[e]=null,n.splice(e,1)})},e}();xf.XfEvent=t}(xf||(xf={})),function(xf){var n=!1;xf.createBanner=function(){var t=window.xfruntime;if(t&&t.isMobile)if(!document.getElementById("evkBanner")){if(-1===navigator.userAgent.toLowerCase().indexOf("evkworld")){var e=document.createElement("div");e.style.cssText="position: fixed;bottom: 0;left: 0;z-index: 100001;transform-origin: bottom left",e.innerHTML='\n            <div style="position:absolute;padding: 5px 0;bottom: 0;width: 100%;background: #fff;border-top: solid 1px rgba(239,240,236, 1);max-height: 80px;">\n                <a style="background: rgba(100, 100, 100, 0.8); width: 22px; height: 22px; border-radius: 100%;position: absolute;right: 10px; top: -8px; text-align: center; line-height: 22px; font-size: 12px; color: #fff;" id="bannerCloseBtn">X</a>\n                <div style="width: 100%;display: flex;align-items: center;justify-content: space-between;">\n                    <img style="width: 50px;height: 50px; border-radius: 10px;margin-left: 16px;" src="assets/common-images/logoEvkApp.png"/>\n                    <p style="color: rgb(36, 39, 65);font-size: 14px; padding: 0 8px 0 8px;" id="bannerDesc">用唤境APP做同款游戏，抢先体验本游戏最新版本</p>\n                    <a id="downLoadEvkApp" href="javascript:;" style="background: rgb(252,66,95); border-radius: 4px;height: 30px;line-height: 30px;color: #fff;font-size: 13px;text-align: center;text-decoration: none;">打开APP</a>\n                </div>\n            </div>\n        ',e.id="evkBanner",document.body.appendChild(e);var i=function(){o()},n=document.getElementById("downLoadEvkApp");n.addEventListener("click",i,!1);var r=document.getElementById("bannerCloseBtn");r.addEventListener("click",function t(){n.removeEventListener("click",i),r.removeEventListener("click",t),document.body.removeChild(e)},!1),xf.appBannerTransform()}}},xf.appBannerTransform=function(){var t=document.getElementById("evkBanner");if(t){var e,i,n,r=window.xfruntime,o=document.getElementById("downLoadEvkApp"),s=[70,16],a=[80,70],l=r.deviceOrientation,c=r.isForceLandScape,u=r.isForcePortrait,h=document.documentElement.clientWidth,d=document.documentElement.clientHeight;if("landscape"==l)if(i=a[0],n=a[1],u)i=s[0],n=s[1],e=d,t.style.transform="translateX("+h+"px)rotate(-90deg)";else e=h,t.style.transform=null;else if(i=s[0],n=s[1],c)i=a[0],n=a[1],e=d,t.style.transform="translateY("+-d+"px)rotate(90deg)";else e=h,t.style.transform=null;t.style.width=e+"px";var p=e-i-n-50-16;document.getElementById("bannerDesc").style.width=p+"px",o.style.width=i+"px",o.style.marginRight=n+"px"}};var o=function(){var t=window.xfruntime,e=navigator.userAgent.toLowerCase(),i=/micromessenger/.test(e),n=/qq\//.test(e);if(!t.isMobile||!i&&!n){var r=document.createElement("a"),o="https://down.evkworld.com/evkapp.html?type=banner";if(r.href=o,-1!==e.indexOf("chrome"))r.click();else window.open(o)}else s()},s=function(){var t='\n            <img style="display: inline-block;width: 80%;margin: 10px 15px 0 0;" src="assets/common-images/down-guide.png" alt="在浏览器打开">\n            <p style="text-align: center;font-size: 17px;color: #fff;">然后选择在 '+(window.xfruntime.isiOS?"Safari":"系统浏览器")+" 中打开</p>\n        ",e=document.createElement("div");e.id="appGuide",e.style.cssText="position: fixed;width: 100%;height: 100%;z-index: 100002;top: 0;right: 0;text-align: right;background: rgba(0,0,0,0.7);",e.innerHTML=t,document.body.appendChild(e);e.addEventListener("click",function(){e.style.display="none"},!1)};xf.createLandscapeGuide=function(){if(!n){var t=window.xfruntime;if(t&&t.isMobile&&!t.isCordova)if(!document.getElementById("unlockPortraitGuide")){if(-1===navigator.userAgent.toLowerCase().indexOf("evkworld")){var e=document.createElement("div");e.style.cssText="position: fixed; top: 40%; left: 50%;width: 300px; height: 155.5px; transform: translate(-50%, -50%); z-index: 99999",e.innerHTML='\n            <div style="position:absolute; display: flex; flex-direction: column; width: 100%;height: 100%;background: #fff;box-shadow: 0 1px 5px 0 rgba(0,0,0,0.50);border-radius: 10px;">\n                <div style="width: 100%; height: 40px; text-align: center; line-height: 40px; background: #454545; border-radius: 10px 10px 0 0; color: #fff">\n                    提示\n                    <img style="position: absolute; width: 21px; height: 21px; right: 9.5px; top: 10px;" id="guideCloseBtn" src="assets/common-images/guide_close.png">\n                </div>\n                <div style="width: 100%;display: flex; flex: 1; align-items: center; justify-content: center;">\n                    <p style="font-family: PingFangSC-Regular; font-size: 14px; color: #565656; letter-spacing: 0.6px;">建议横屏获得更好游戏体验</p>\n                </div>\n                <div style=\'display: flex; align-items: center; margin-left: 163px; margin-bottom: 21.5px;\' id="hotRect">\n                    <img style="width: 22px; height: 15px; margin-right: 5px" src="assets/common-images/guide_arrow.png">\n                    <u style=\'font-family: PingFangSC-Medium; font-size: 13px; color: #027CFF; letter-spacing: 0.555px;\'>如何开启横屏?</u>\n                </div>\n            </div>\n        ',e.id="unlockPortraitGuide",document.body.appendChild(e),document.getElementById("hotRect").addEventListener("click",r,!1),document.getElementById("guideCloseBtn").addEventListener("click",xf.removeLandscapeGuide,!1)}}}};var r=function(){var t="http://dev.gramaker.com/g/unlockGuide";if("production"==xfConfig.environment)t="https://www.evkworld.com/g/unlockGuide";else if("beta"==xfConfig.environment)t="http://beta.gramaker.com/g/unlockGuide";var e="guideIframeDiv",i="guideIframe",n=document.getElementById(e);if(!n){(n=document.createElement("div")).style.cssText="\n            position: fixed; width: 100%; height: 100%; z-index: 99999999; background-color: white;\n            -webkit-overflow-scrolling: touch; -webkit-overflow-y:auto; overflow-y:auto;\n            overflow-x: hidden; -webkit-overflow-x: hidden;\n        ",n.innerHTML='\n                <iframe style=\'width: 100%; height: 100%\' allowfullscreen="true" id=guideIframe scrolling="yes" noresize="noresize" />\n        ',n.id=e,document.body.appendChild(n),document.getElementById(i).src=t,window.addEventListener("message",function(t){if("remove-guide-iframe"===t.data.type)n.style.display="none"})}else n.style.display="block"};xf.removeLandscapeGuide=function(t,e){if(void 0===e)e=!0;var i=document.getElementById("unlockPortraitGuide");if(i)n=e,document.getElementById("hotRect").removeEventListener("click",r,!1),document.getElementById("guideCloseBtn").removeEventListener("click",xf.removeLandscapeGuide,!1),document.body.removeChild(i)}}(xf||(xf={})),function(i){var n={};function r(t){if(n[t])return n[t].exports;var e=n[t]={i:t,l:!1,exports:{}};return i[t].call(e.exports,e,e.exports,r),e.l=!0,e.exports}r.m=i,r.c=n,r.d=function(t,e,i){if(!r.o(t,e))Object.defineProperty(t,e,{enumerable:!0,get:i})},r.r=function(t){if("undefined"!=typeof Symbol&&Symbol.toStringTag)Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(e,t){if(1&t)e=r(e);if(8&t)return e;if(4&t&&"object"===_typeof(e)&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(i,n,function(t){return e[t]}.bind(null,n));return i},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s="281fcbeb5baaea9e")}({"281fcbeb5baaea9e":function(t,e,i){var n=this&&this.__awaiter||function(o,s,a,l){return new(a||(a=Promise))(function(t,e){function i(t){try{r(l.next(t))}catch(t){e(t)}}function n(t){try{r(l.throw(t))}catch(t){e(t)}}function r(e){e.done?t(e.value):new a(function(t){t(e.value)}).then(i,n)}r((l=l.apply(o,s||[])).next())})},a=this&&this.__generator||function(i,n){var r,o,s,t,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;if(o=0,s)e=[2&e[0],s.value];switch(e[0]){case 0:case 1:s=e;break;case 4:return a.label++,{value:e[1],done:!1};case 5:a.label++,o=e[1],e=[0];continue;case 7:e=a.ops.pop(),a.trys.pop();continue;default:if(!(s=0<(s=a.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){a=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){a.label=e[1];break}if(6===e[0]&&a.label<s[1]){a.label=s[1],s=e;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(e);break}if(s[2])a.ops.pop();a.trys.pop();continue}e=n.call(i,a)}catch(t){e=[6,t],o=0}finally{r=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}};Object.defineProperty(e,"__esModule",{value:!0});var o=i("b765635c89014130"),s=i("fe6322fc3f6bbbce"),l=i("34c535a3500967f1"),c=i("ceedf3b26a21d114"),r=function(){function t(){this.ready=!1,this.saveSlotToCloud=function(t){var n=this,r={success:0,error:t.length,total:t.length};return new Promise(function(e,i){n.saveArchiveToCloud(0,t,r,function(t){if(0==t.error)e(t);else i()})})},this.LocalStorage_WriteSlot=function(t,e){return l.default.write(t,e)},this.LocalStorage_ReadSlot=function(t){return l.default.read(t)}}return t.prototype.init=function(){return n(this,void 0,void 0,function(){var e,i,n,r=this;return a(this,function(t){if(console.log("---- init archiveSDK ----"),l.default.init(),c.default.lStorage(l.default),!this.IsIndexedDBAvailable())return[2];if(xf.gameInfo.playerId)localStorage.setItem("preUserId",xf.gameInfo.playerId);if(e=xf.gameInfo.projectId,this.preUserId=localStorage.getItem("preUserId"),xf.gameInfo.playerId)this._dbStoreName="evk_"+xf.gameInfo.playerId,this._dbOldStoreName="evk_offline";else this._dbStoreName="evk_offline",this._dbOldStoreName="evk_"+this.preUserId;return this._dbName="__evk_"+e,i=s.getVersion(this._dbStoreName),n=s.getVersion(this._dbOldStoreName),this._version=n<i?i:n,this._db=new o.default(this._dbName,this._version,{onupgradeneeded:function(t){var e=t.target.result;if(!e.objectStoreNames.contains(r._dbStoreName))e.createObjectStore(r._dbStoreName,{keyPath:"slot"});if(!e.objectStoreNames.contains(r._dbOldStoreName))e.createObjectStore(r._dbOldStoreName,{keyPath:"slot"})}}),this._db.open().then(function(){r.ready=!0,c.default.translateData(r._db,r._dbStoreName,r._dbOldStoreName)}).catch(function(t){r.reportSentry(t),console.log(t)}),[2]})})},t.prototype.reportSentry=function(t){window.Sentry.captureMessage({versions:localStorage.getItem("__evk_archive_version"),version:this._version,dbName:this._dbName,storeName:this._dbStoreName,error:t})},t.prototype.Init_Archive_From_Cloud=function(){return n(this,void 0,void 0,function(){var e,i,n,r=this;return a(this,function(t){switch(t.label){case 0:return[4,xf.webApi.queryArchive()];case 1:return e=t.sent(),[4,this.getSaveSlots()];case 2:if(i=t.sent(),(n=s.getSaveSlotsNameCloud(e,i)).length)this.getSlotFromCloud(n).then(function(t){console.log(t)}).catch(function(t){r.reportSentry(t)});else console.log("不需要云端存档同步到本地");return[2]}})})},t.prototype.handleSaveToLocal=function(t,e,i,n){if(e.length-1==t)n&&n(i);else this.saveArchiveFromCloud(++t,e,i,n)},t.prototype.saveArchiveFromCloud=function(i,n,r,o){var s=this,a=n[i];xf.webApi.loadArchive(a).then(function(t){var e=decodeURIComponent(t.data);console.log("结果"+a.slot+a.gameVersion),s.saveSlotToLocal(a.slot,e).then(function(t){if(t)r.success+=1,r.error-=1;s.handleSaveToLocal(i,n,r,o)}).catch(function(t){s.handleSaveToLocal(i,n,r,o)})}).catch(function(t){s.handleSaveToLocal(i,n,r,o)})},t.prototype.saveSlotToLocal=function(i,n){var r=this;return new Promise(function(e,t){if(r.IsIndexedDBAvailable())r.IndexedDB_WriteSlot(i,n,function(){console.log("Saved state to IndexedDB storage ("+n.length+" bytes)"),e(!0)},function(t){l.default.write(i,n),e(!0)});else l.default.write(i,n),e(!0)})},t.prototype.saveArchiveToCloud=function(e,i,n,r){var o=this,t=i[e];xf.webApi.saveArchive(t).then(function(t){if(t)n.success+=1,n.error-=1;if(i.length-1==e)r&&r(n);else this.saveArchiveToCloud(++e,i,n,r)}).catch(function(t){if(i.length-1==e)r&&r(n);else o.saveArchiveToCloud(++e,i,n,r)})},t.prototype.IndexedDB_GetAllSlot=function(){return n(this,void 0,void 0,function(){var e,i,n;return a(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this._db.getAll()];case 1:if(e=t.sent(),i=[],e&&e.target.result)e.target.result.map(function(t){i.push({slot:t.slot,data:t.data,md5Code:md5(t.data)})});return[2,Promise.resolve(i)];case 2:return n=t.sent(),[2,Promise.reject(n)];case 3:return[2]}})})},t.prototype.getSaveSlotsNameLocal=function(t,e){return s.getSaveSlotsNameLocal(t,e)},t.prototype.getSaveSlotsNameCloud=function(t,e){return s.getSaveSlotsNameCloud(t,e)},t.prototype.IsIndexedDBAvailable=function(){try{return!(!window.indexedDB||!window.indexedDB.open("__xf_indexDB_version"))}catch(t){return!1}},t.prototype.getSlotFromCloud=function(t){var n=this,r={success:0,error:t.length,total:t.length};return new Promise(function(e,i){n.saveArchiveFromCloud(0,t,r,function(t){if(0==t.error)e(t);else i()})})},t.prototype.getSaveSlots=function(){var t=this;return new Promise(function(o,s){return n(t,void 0,void 0,function(){var e,i,n,r;return a(this,function(t){switch(t.label){case 0:if(e=[],!this.IsIndexedDBAvailable())return[3,8];t.label=1;case 1:return t.trys.push([1,6,,7]),[4,this._db.getAll(this._dbStoreName)];case 2:if(!(i=t.sent()).target.result||!i.target.result.length)return[3,3];else return i.target.result.map(function(t){e.push({slot:t.slot,data:t.data,md5Code:md5(t.data)})}),[3,5];case 3:return[4,l.default.getAllSlot()];case 4:r=t.sent(),e=r,t.label=5;case 5:return[3,7];case 6:return n=t.sent(),console.log(n),s(n),[3,7];case 7:return[3,10];case 8:return[4,l.default.getAllSlot()];case 9:r=t.sent(),e=r,t.label=10;case 10:return o(e),[2]}})})})},t.prototype.IndexedDB_WriteSlot=function(t,e,i,n){var r=this;this._db.put(this._dbStoreName,{slot:t,time:Date.now(),data:e}).then(function(t){i&&i(t)}).catch(function(t){r.reportSentry(t),n&&n(t)})},t.prototype.IndexedDB_ReadSlot=function(e,i,n){var r=this;this._db.get(this._dbStoreName,e).then(function(t){if(t.target&&t.target.result)i&&i(t.target.result.data);else n&&n("获取不到"+e+"存档数据")}).catch(function(t){r.reportSentry(t),n&&n(t)})},t}();e.default=r,xf.archiveSDK=new r},"34c535a3500967f1":function(t,e,i){var o=this&&this.__assign||function(){return(o=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var r in e=arguments[i])if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r];return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0});var n=null,s={init:function(){var t="__xfsave_"+xf.gameInfo.projectId.substr(0,8);if(xfConfig.isLogin&&xf.gameInfo.playerId)t+="_"+xf.gameInfo.playerId;n=t},write:function(t,e){var i=n+"_"+t;localStorage.setItem(i,e),s.addToSlot(t)},read:function(t){var e=n+"_"+t;return localStorage.getItem(e)||""},delete:function(t){var e=n+"_"+t;return localStorage.getItem(e)||""},getAllSlot:function(){var t=[],e="xf_offline_archive";if(xfConfig.isLogin&&xf.gameInfo.playerId)e="xf_online_archive";var i=localStorage.getItem(e)||"{}",n=JSON.parse(i);if(Object.keys(n).length)for(var r in n[xf.gameInfo.projectId]){var o=s.read(r);t.push({slot:r,data:o,md5Code:md5(o)})}return Promise.resolve(t)},addToSlot:function(t){var e,i,n="xf_offline_archive";if(xfConfig.isLogin&&xf.gameInfo.playerId)n="xf_online_archive";var r=localStorage.getItem(n)||"{}";if((r=JSON.parse(r))[xf.gameInfo.projectId]&&r[xf.gameInfo.projectId][t])return!1;else if(!r[xf.gameInfo.projectId])return r[xf.gameInfo.projectId]=((e={})[t]=t,e),localStorage.setItem(n,JSON.stringify(r)),!0;else if(!r[xf.gameInfo.projectId][t])return r[xf.gameInfo.projectId]=o({},r[xf.gameInfo.projectId],((i={})[t]=t,i)),localStorage.setItem(n,JSON.stringify(r)),!0}};e.default=s},b765635c89014130:function(t,e,i){var r=this&&this.__awaiter||function(o,s,a,l){return new(a||(a=Promise))(function(t,e){function i(t){try{r(l.next(t))}catch(t){e(t)}}function n(t){try{r(l.throw(t))}catch(t){e(t)}}function r(e){e.done?t(e.value):new a(function(t){t(e.value)}).then(i,n)}r((l=l.apply(o,s||[])).next())})},o=this&&this.__generator||function(i,n){var r,o,s,t,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;if(o=0,s)e=[2&e[0],s.value];switch(e[0]){case 0:case 1:s=e;break;case 4:return a.label++,{value:e[1],done:!1};case 5:a.label++,o=e[1],e=[0];continue;case 7:e=a.ops.pop(),a.trys.pop();continue;default:if(!(s=0<(s=a.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){a=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){a.label=e[1];break}if(6===e[0]&&a.label<s[1]){a.label=s[1],s=e;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(e);break}if(s[2])a.ops.pop();a.trys.pop();continue}e=n.call(i,a)}catch(t){e=[6,t],o=0}finally{r=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}};Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e,i){if(void 0===e)e=1;if(this.name=t,this.version=e,i&&i.onupgradeneeded)this._onupgradeneeded=i.onupgradeneeded;this._db=null}return t.prototype.open=function(){var n=this;return new Promise(function(e,i){var t=window.indexedDB.open(n.name,n.version);if(t.onerror=function(t){i(t)},t.onsuccess=function(t){n._db=t,e(t)},n._onupgradeneeded)t.onupgradeneeded=n._onupgradeneeded})},t.prototype._handleTransaction=function(n,r,o,s,a){var l=this;return new Promise(function(e,i){var t;(t=l._db.target.result.transaction([r],o).objectStore(r)[n](s,a)).onsuccess=function(t){e(t)},t.onerror=function(t){i(t)}})},t.prototype.add=function(e,i,n){return r(this,void 0,void 0,function(){return o(this,function(t){switch(t.label){case 0:if(!n)return[3,2];else return[4,this.get(this.name,n)];case 1:if(t.sent().target.result)return[2,Promise.reject(e+"中的"+n+"已经存在")];t.label=2;case 2:return[2,this._handleTransaction("add",e,"readwrite",i)]}})})},t.prototype.put=function(t,e){return this._handleTransaction("put",t,"readwrite",e)},t.prototype.clear=function(t){return this._handleTransaction("clear",t,"readwrite")},t.prototype.count=function(t,e){return this._handleTransaction("count",t,"readonly",e)},t.prototype.delete=function(t,e){return this._handleTransaction("delete",t,"readwrite",e)},t.prototype.get=function(t,e){return this._handleTransaction("get",t,"readonly",e)},t.prototype.getAll=function(t,e,i){return this._handleTransaction("getAll",t,"readonly",e,i)},t.prototype.getAllKeys=function(t,e,i){return this._handleTransaction("getAllKeys",t,"readonly",e,i)},t}();e.default=n},ceedf3b26a21d114:function(t,e,i){var n=this&&this.__awaiter||function(o,s,a,l){return new(a||(a=Promise))(function(t,e){function i(t){try{r(l.next(t))}catch(t){e(t)}}function n(t){try{r(l.throw(t))}catch(t){e(t)}}function r(e){e.done?t(e.value):new a(function(t){t(e.value)}).then(i,n)}r((l=l.apply(o,s||[])).next())})},y=this&&this.__generator||function(i,n){var r,o,s,t,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;if(o=0,s)e=[2&e[0],s.value];switch(e[0]){case 0:case 1:s=e;break;case 4:return a.label++,{value:e[1],done:!1};case 5:a.label++,o=e[1],e=[0];continue;case 7:e=a.ops.pop(),a.trys.pop();continue;default:if(!(s=0<(s=a.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){a=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){a.label=e[1];break}if(6===e[0]&&a.label<s[1]){a.label=s[1],s=e;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(e);break}if(s[2])a.ops.pop();a.trys.pop();continue}e=n.call(i,a)}catch(t){e=[6,t],o=0}finally{r=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}};Object.defineProperty(e,"__esModule",{value:!0});e.default={lStorage:function(i){if(!xfConfig.isLogin||!xf.gameInfo.playerId)return!1;var n=xf.gameInfo.playerId,t=localStorage.getItem("__xf_all_slot_"+n);if(!t)return!1;t.split(",").map(function(t){t=t.replace("__xfsave_","");var e=localStorage.getItem("__xfsave_"+t+"_"+n);if(e)localStorage.removeItem("__xfsave_"+t+"_"+n),localStorage.removeItem("__xf_all_slot_"+n),i.write(t,e)})},translateData:function(f,m,g){return n(this,void 0,void 0,function(){var e,i,n,r,o,s,a,l,c,u,h,d,p;return y(this,function(t){switch(t.label){case 0:if(!g&&!m)return[2];t.label=1;case 1:return t.trys.push([1,19,,20]),[4,f.getAll(m)];case 2:return e=t.sent(),[4,f.getAll(g)];case 3:return i=t.sent(),[4,f.getAllKeys(m)];case 4:if(n=t.sent(),r=e.target.result,o=n.target.result,!(s=i.target.result).length)return console.log("没有就存档，不需要更新存档"),[2];if(r.length)return[3,9];a=0,t.label=5;case 5:if(!(a<s.length))return[3,8];if(!(h=s[a]).time)h.time=Date.now();return console.log("更新存档："+h.slot+" "+h.time),[4,f.put(m,h)];case 6:t.sent(),t.label=7;case 7:return a++,[3,5];case 8:return[2];case 9:l=0,t.label=10;case 10:if(!(l<s.length))return[3,18];if(c=s[l],!(-1<o.indexOf(c.slot)))return[3,15];u=0,t.label=11;case 11:if(!(u<r.length))return[3,14];if((h=r[u]).slot!==c.slot)return[3,13];if(console.log("data: "+h.time+", oldData: "+c.time+" "+(c.time>h.time)),!(h.time&&c.time&&c.time>h.time||c.time&&!h.time))return[3,13];else return(d=JSON.parse(JSON.stringify(c))).time=Date.now(),console.log("更新存档："+d.slot+" "+d.time),[4,f.put(m,d)];case 12:t.sent(),t.label=13;case 13:return u++,[3,11];case 14:return[3,17];case 15:return(d=JSON.parse(JSON.stringify(c))).time=Date.now(),[4,f.put(m,d)];case 16:t.sent(),t.label=17;case 17:return l++,[3,10];case 18:return[3,20];case 19:return p=t.sent(),window.Sentry.captureMessage({storeName:m,oldStoreName:g,error:p}),[2,{}];case 20:return[2]}})})}}},fe6322fc3f6bbbce:function(t,o,e){Object.defineProperty(o,"__esModule",{value:!0}),o.findIndex=function(t,e){return t.findIndex(function(t){return t.slot==e})},o.getSaveSlotsNameLocal=function(t,e){var i=[];return e.forEach(function(e){if(-1==o.findIndex(t,e.slot))i.push(e);t.forEach(function(t){if(t.slot==e.slot&&e.md5Code!=t.md5Code)i.push(e)})}),i},o.getSaveSlotsNameCloud=function(t,n){var r=[];return t.forEach(function(t){if(-1==o.findIndex(n,t.slot)&&xf.gameInfo.version>=t.gameVersion)r.push(t);for(var e=0;e<n.length;e++){var i=n[e];if(i.slot==t.slot&&t.md5Code!=i.md5Code&&xf.gameInfo.version>=t.gameVersion){r.push(t);break}}}),r},o.getVersion=function(t){var e,i,n="__evk_archive_version",r=localStorage.getItem(n);if(!r)i={version:1,data:(e={},e[t]=1,e)};else{if((i=JSON.parse(r)).data[t])return i.version;i.version=i.version+1,i.data[t]=1}return localStorage.setItem(n,JSON.stringify(i)),i.version}}}),function(i){var n={};function r(t){if(n[t])return n[t].exports;var e=n[t]={i:t,l:!1,exports:{}};return i[t].call(e.exports,e,e.exports,r),e.l=!0,e.exports}r.m=i,r.c=n,r.d=function(t,e,i){if(!r.o(t,e))Object.defineProperty(t,e,{enumerable:!0,get:i})},r.r=function(t){if("undefined"!=typeof Symbol&&Symbol.toStringTag)Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(e,t){if(1&t)e=r(e);if(8&t)return e;if(4&t&&"object"===_typeof(e)&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(i,n,function(t){return e[t]}.bind(null,n));return i},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s="44bafe173b7e7d99")}({"00693e66090f3263":function(t,e,i){e.a=function(e){var i=this.constructor;return this.then(function(t){return i.resolve(e()).then(function(){return t})},function(t){return i.resolve(e()).then(function(){return i.reject(t)})})}},"09149f47bd83cc56":function(t,e,i){i("6c6afa32ac63b8c5");var n=i("1e0189becf3fa25f"),r=i("ff9c8a971a33458f"),o=i("30c767f5616de1fb"),s=i("292bdc4089e4c5f3");t.exports=function(){return s({browserConfig:n,getDid:r.getDid,getDidSync:r.getDidSync,request:o,contextKey:"browser",storage:{get:function(t){return localStorage.getItem(t)},set:function(t,e){return localStorage.setItem(t,e)}}})}},"0ee4763173a9a955":function(t,e){var i;i=function(){return this}();try{i=i||new Function("return this")()}catch(t){if("object"===(void 0===window?"undefined":_typeof(window)))i=window}t.exports=i},"14800daf2a27de50":function(t,e,i){t.exports=function(t){return null!==t&&"object"===_typeof(t)}},"186f7c258b03348a":function(t,i,e){var n;if(void 0!==window)n=window;else if("undefined"!=typeof self)n=self;else console.warn("Using browser-only version of superagent in non-browser environment"),n=this;var r=e("a6755452eda84f88"),o=e("a396c9856093b9d2"),s=e("14800daf2a27de50"),a=e("8a85aa64fcac3ebf"),l=e("7bf15d9882a03017");function c(){}var u=i=t.exports=function(t,e){if("function"==typeof e)return new i.Request("GET",t).end(e);if(1==arguments.length)return new i.Request("GET",t);else return new i.Request(t,e)};i.Request=y,u.getXHR=function(){if(n.XMLHttpRequest&&(!n.location||"file:"!=n.location.protocol||!n.ActiveXObject))return new XMLHttpRequest;else{try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(t){}try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(t){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(t){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(t){}}throw Error("Browser-only version of superagent could not find XHR")};var h="".trim?function(t){return t.trim()}:function(t){return t.replace(/(^\s*|\s*$)/g,"")};function d(t){if(!s(t))return t;var e=[];for(var i in t)p(e,i,t[i]);return e.join("&")}function p(e,i,t){if(null!=t)if(Array.isArray(t))t.forEach(function(t){p(e,i,t)});else if(s(t))for(var n in t)p(e,i+"["+n+"]",t[n]);else e.push(encodeURIComponent(i)+"="+encodeURIComponent(t));else if(null===t)e.push(encodeURIComponent(i))}function f(t){for(var e,i,n={},r=t.split("&"),o=0,s=r.length;o<s;++o)if(-1==(i=(e=r[o]).indexOf("=")))n[decodeURIComponent(e)]="";else n[decodeURIComponent(e.slice(0,i))]=decodeURIComponent(e.slice(i+1));return n}function m(t){return/[\/+]json($|[^-\w])/.test(t)}function g(t){this.req=t,this.xhr=this.req.xhr,this.text="HEAD"!=this.req.method&&(""===this.xhr.responseType||"text"===this.xhr.responseType)||void 0===this.xhr.responseType?this.xhr.responseText:null,this.statusText=this.req.xhr.statusText;var e=this.xhr.status;if(1223===e)e=204;if(this._setStatusProperties(e),this.header=this.headers=function(t){for(var e,i,n,r,o=t.split(/\r?\n/),s={},a=0,l=o.length;a<l;++a)if(-1!==(e=(i=o[a]).indexOf(":")))n=i.slice(0,e).toLowerCase(),r=h(i.slice(e+1)),s[n]=r;return s}(this.xhr.getAllResponseHeaders()),this.header["content-type"]=this.xhr.getResponseHeader("content-type"),this._setHeaderProperties(this.header),null===this.text&&t._responseType)this.body=this.xhr.response;else this.body="HEAD"!=this.req.method?this._parseBody(this.text?this.text:this.xhr.response):null}function y(t,e){var n=this;this._query=this._query||[],this.method=t,this.url=e,this.header={},this._header={},this.on("end",function(){var e,i=null,t=null;try{t=new g(n)}catch(t){if((i=new Error("Parser is unable to parse the response")).parse=!0,i.original=t,n.xhr)i.rawResponse=void 0===n.xhr.responseType?n.xhr.responseText:n.xhr.response,i.status=n.xhr.status?n.xhr.status:null,i.statusCode=i.status;else i.rawResponse=null,i.status=null;return n.callback(i)}n.emit("response",t);try{if(!n._isResponseOK(t))e=new Error(t.statusText||"Unsuccessful HTTP response")}catch(t){e=t}if(e)e.original=i,e.response=t,e.status=t.status,n.callback(e,t);else n.callback(null,t)})}function v(t,e,i){var n=u("DELETE",t);if("function"==typeof e)i=e,e=null;if(e)n.send(e);if(i)n.end(i);return n}u.serializeObject=d,u.parseString=f,u.types={html:"text/html",json:"application/json",xml:"text/xml",urlencoded:"application/x-www-form-urlencoded",form:"application/x-www-form-urlencoded","form-data":"application/x-www-form-urlencoded"},u.serialize={"application/x-www-form-urlencoded":d,"application/json":JSON.stringify},u.parse={"application/x-www-form-urlencoded":f,"application/json":JSON.parse},a(g.prototype),g.prototype._parseBody=function(t){var e=u.parse[this.type];if(this.req._parser)return this.req._parser(this,t);if(!e&&m(this.type))e=u.parse["application/json"];return e&&t&&(t.length||t instanceof Object)?e(t):null},g.prototype.toError=function(){var t=this.req,e=t.method,i=t.url,n="cannot "+e+" "+i+" ("+this.status+")",r=new Error(n);return r.status=this.status,r.method=e,r.url=i,r},u.Response=g,r(y.prototype),o(y.prototype),y.prototype.type=function(t){return this.set("Content-Type",u.types[t]||t),this},y.prototype.accept=function(t){return this.set("Accept",u.types[t]||t),this},y.prototype.auth=function(t,e,i){if(1===arguments.length)e="";if("object"===_typeof(e)&&null!==e)i=e,e="";if(!i)i={type:"function"==typeof btoa?"basic":"auto"};return this._auth(t,e,i,function(t){if("function"==typeof btoa)return btoa(t);throw new Error("Cannot use basic auth, btoa is not a function")})},y.prototype.query=function(t){if("string"!=typeof t)t=d(t);if(t)this._query.push(t);return this},y.prototype.attach=function(t,e,i){if(e){if(this._data)throw Error("superagent can't mix .send() and .attach()");this._getFormData().append(t,e,i||e.name)}return this},y.prototype._getFormData=function(){if(!this._formData)this._formData=new n.FormData;return this._formData},y.prototype.callback=function(t,e){if(this._shouldRetry(t,e))return this._retry();var i=this._callback;if(this.clearTimeout(),t){if(this._maxRetries)t.retries=this._retries-1;this.emit("error",t)}i(t,e)},y.prototype.crossDomainError=function(){var t=new Error("Request has been terminated\nPossible causes: the network is offline, Origin is not allowed by Access-Control-Allow-Origin, the page is being unloaded, etc.");t.crossDomain=!0,t.status=this.status,t.method=this.method,t.url=this.url,this.callback(t)},y.prototype.buffer=y.prototype.ca=y.prototype.agent=function(){return console.warn("This is not supported in browser version of superagent"),this},y.prototype.pipe=y.prototype.write=function(){throw Error("Streaming is not supported in browser version of superagent")},y.prototype._isHost=function(t){return t&&"object"===_typeof(t)&&!Array.isArray(t)&&"[object Object]"!==Object.prototype.toString.call(t)},y.prototype.end=function(t){if(this._endCalled)console.warn("Warning: .end() was called twice. This is not supported in superagent");return this._endCalled=!0,this._callback=t||c,this._finalizeQueryString(),this._end()},y.prototype._end=function(){var i=this,n=this.xhr=u.getXHR(),t=this._formData||this._data;this._setTimeouts(),n.onreadystatechange=function(){var t=n.readyState;if(2<=t&&i._responseTimeoutTimer)clearTimeout(i._responseTimeoutTimer);if(4==t){var e;try{e=n.status}catch(t){e=0}if(!e){if(i.timedout||i._aborted)return;return i.crossDomainError()}i.emit("end")}};var e=function(t,e){if(0<e.total)e.percent=e.loaded/e.total*100;e.direction=t,i.emit("progress",e)};if(this.hasListeners("progress"))try{if(n.onprogress=e.bind(null,"download"),n.upload)n.upload.onprogress=e.bind(null,"upload")}catch(t){}try{if(this.username&&this.password)n.open(this.method,this.url,!0,this.username,this.password);else n.open(this.method,this.url,!0)}catch(t){return this.callback(t)}if(this._withCredentials)n.withCredentials=!0;if(!this._formData&&"GET"!=this.method&&"HEAD"!=this.method&&"string"!=typeof t&&!this._isHost(t)){var r=this._header["content-type"],o=this._serializer||u.serialize[r?r.split(";")[0]:""];if(!o&&m(r))o=u.serialize["application/json"];if(o)t=o(t)}for(var s in this.header)if(null!=this.header[s])if(this.header.hasOwnProperty(s))n.setRequestHeader(s,this.header[s]);if(this._responseType)n.responseType=this._responseType;return this.emit("request",this),n.send(void 0!==t?t:null),this},u.agent=function(){return new l},["GET","POST","OPTIONS","PATCH","PUT","DELETE"].forEach(function(n){l.prototype[n.toLowerCase()]=function(t,e){var i=new u.Request(n,t);if(this._setDefaults(i),e)i.end(e);return i}}),l.prototype.del=l.prototype.delete,u.get=function(t,e,i){var n=u("GET",t);if("function"==typeof e)i=e,e=null;if(e)n.query(e);if(i)n.end(i);return n},u.head=function(t,e,i){var n=u("HEAD",t);if("function"==typeof e)i=e,e=null;if(e)n.query(e);if(i)n.end(i);return n},u.options=function(t,e,i){var n=u("OPTIONS",t);if("function"==typeof e)i=e,e=null;if(e)n.send(e);if(i)n.end(i);return n},u.del=v,u.delete=v,u.patch=function(t,e,i){var n=u("PATCH",t);if("function"==typeof e)i=e,e=null;if(e)n.send(e);if(i)n.end(i);return n},u.post=function(t,e,i){var n=u("POST",t);if("function"==typeof e)i=e,e=null;if(e)n.send(e);if(i)n.end(i);return n},u.put=function(t,e,i){var n=u("PUT",t);if("function"==typeof e)i=e,e=null;if(e)n.send(e);if(i)n.end(i);return n}},"1e0189becf3fa25f":function(t,e,i){i("2fa6db0e3e060439");var n=i("ea5b58cc67292e8c"),r=i("ff9c8a971a33458f"),o=i("537d6b6fa7a8e3cb");var s=n.parse(navigator.userAgent),a=function(){var t=0,e=0;if(window.innerWidth)t=window.innerWidth;else if(document.body&&document.body.clientWidth)t=document.body.clientWidth;if(window.innerHeight)e=window.innerHeight;else if(document.body&&document.body.clientHeight)e=document.body.clientHeight;if(document.documentElement&&document.documentElement.clientHeight&&document.documentElement.clientWidth)e=document.documentElement.clientHeight,t=document.documentElement.clientWidth;return{winWidth:t,winHeight:e}}();t.exports=function(){return new Promise(function(e,t){r.getDidSync().then(function(t){e({tz:o.getTz(),lang:navigator.language||"zh-CN",width:a.winWidth,height:a.winHeight,brover:s.toString()||"",os:o.webDetectOS(navigator.userAgent),osver:s.os.toString(),ua:navigator.userAgent,ref:document.referrer||"",did:t})})})}},"292bdc4089e4c5f3":function(t,e,i){var x=i("537d6b6fa7a8e3cb"),S=i("6c241f4130e50913"),I=i("2fa6db0e3e060439"),T=x.validateState,C=x.validateBy,o=x.put,O=x.extendSetters,P=x.pick,s=x.delegatorMethod,E=S.sdkv;t.exports=function(t){var u,h,d=S.reportTypeConfig,p=[],a={},f={},l=0,c=t.getDid,m=t.browserConfig,g=t.request,e=t.storage,y=t.contextKey;function v(t){return g({method:"get",url:t}).then(function(t){if(200===t.status&&t.timestamp)l=Date.now()-t.timestamp;return l})}function b(t){if(l)return{then:function(t){return t(Date.now()-l)}};else return v(t).then(function(t){return Date.now()-t})}function _(t,e,i){if(this.key="__data:retry-list"+t,this.appId=t,this.appSecret=e,this.sending=!1,this.host=i,this.api="/web",this.sending=!1,1===u)this.api="/cwithb";else if(2===u)this.api="/mini";this.max=50,this.timer()}function r(t,e,i,n,r){if(this.type=r,this.appId=e,this.appSecret=i,this.host=n,this.state=x.assign({sdkv:E},t),this.finalConfig={},!C(d,r))return!1;if(O(this,this.state,d[r],this.finalConfig),"event"===r)this.putString=o(this.state,"string",S.keys,p),this.putNumber=o(this.state,"number",S.keys,p),this.put=function(t){for(var e in t)if("string"==typeof t[e])this.putString(e,t[e]);else if("number"==typeof t[e])this.putNumber(e,t[e]);else throw Error("value shoule be in [string, number]");return this}}function w(i){return new Promise(function(t,e){if("function"==typeof i)t(i());else t(i)})}function i(t,e,i,n,r,o){if(!t||!e||!i)throw Error("appId, appSecret and host is all required");if(1===r)if(y="browser",u=1,!o)throw Error("when mode !== 0, container is required");else{var s=o.platform,a=S.containerConfig[s];if(!a)throw Error("container platform should in [web, pc, app, minapp]");else{x.validateAll(o,a);for(var l=[],c=0;c<a.length;c++)l.push(a[c].key);if(o=P(o,l),"minapp"===s)o.ua="",o.ref=""}}if(2===r)y="minapp",w(m).then(function(t){t.apil=t.apil||0,t.brand=t.brand||"",t.model=t.model||"",t=x.assign(t,o),m=P(t,S.minappKeys)});if(u=u||r||0,f=o||{},"/"===i[i.length-1])i=i.slice(0,i.length-1);if(this.appId=t,this.appSecret=e,this.host=i,!n||x.hasOneKey(n,S.keys))p=Object.keys(n||{}),this.config=n||{},this.finalConfig={},O(this,this.config,d.commonConfig,this.finalConfig),h=new _(t,e,i),v(this.host)}return u=t.mode,_.prototype.getList=function(){var t=e.get(this.key);return t?JSON.parse(t):[]},_.prototype.setList=function(t){e.set(this.key,JSON.stringify(t))},_.prototype.push=function(t){var e=this.getList();if(e.length>=this.max)e.shift();t.uuid=x.uuid(),e.push(t),this.setList(e)},_.prototype.timer=function(){var t=this;setTimeout(function(){if(t.timer(),!t.sending)t.sending=!0,t.send()},5e3)},_.prototype.removeBy=function(t){for(var e=this.getList(),i=0;i<e.length;i++)if(e[i].uuid===t)e.splice(i,1);this.setList(e)},_.prototype.send=function(){var i=this.getList()[0],n=this;if(i){var r=i.uuid;return delete i.uuid,b(n.host).then(function(t){i.when=t,i.who=n.appId;var e=I(I(JSON.stringify(i))+n.appSecret);return g({method:"post",url:n.host+n.api+"?sign="+e,data:i}).then(function(t){if(200===t.status&&t.timestamp)l=Date.now()-t.timestamp;n.removeBy(r),n.sending=!1}).catch(function(t){if(n.sending=!1,500===t.status)n.removeBy(r)})})}else this.sending=!1},r.prototype.getDidSync=function(){return t.getDidSync()},r.prototype.send=function(){var s=this;return w(m).then(function(o){if(C(d,s.type))if(T(s.state,s.finalConfig))return b(s.host).then(function(t){var e=x.assign(x.assign({},s.state),a);e.time=t,e.fc=e.c;var i={when:t,who:s.appId,platform:"web",what:s.type,context:{data:e}};i.context[y]=o;var n="/web";if(1===u)n="/cwithb",i.context.container=f,i.platform="candb";else if(2===u)n="/mini",i.platform="minapp";else if(3===u)n="/web",i.platform="pc";else if(4===u)n="/web",i.platform="app";var r=function(t){o.did=t;var e=I(I(JSON.stringify(i))+s.appSecret);return g({method:"post",url:s.host+n+"?sign="+e,data:i}).then(function(t){if(200===t.status&&t.timestamp)l=Date.now()-t.timestamp;return t}).catch(function(t){throw h.push(i),t})};if(o.did)return r(o.did);else return c().then(function(t){return r(t)})})})},i.prototype.getSystemConfig=function(){var e="web";if(1===u)e="candb";else if(2===u)e="minapp";else if(3===u)e="pc";else if(4===u)e="app";return w(m).then(function(t){return x.assign({platform:e},t)})},i.prototype.getLogger=function(t){if(!t)throw Error("type is required");if(!this.appId||!this.appSecret||!this.host)throw Error("appId, appSecret and host is all required");if(!T(this.config,this.finalConfig))return!1;var e=new r(this.config,this.appId,this.appSecret,this.host,t),i={};for(var n in e)if("function"==typeof e[n])s(e,i,n);return i},i.prototype.setGlobalConfig=function(t){if(x.hasOneKey(t,S.keys)){for(var e=Object.keys(t),i=0;i<e.length;i++)if(-1===p.indexOf(e[i]))throw Error("you just can set the keys in ["+p.join(", ")+"] which you set in the LoggerFactory initial function ");return a=x.assign(a,t),this}},i}},"2fa6db0e3e060439":function(t,e,i){var v,b,_,w,n;v=i("f7942e3ea8ab53f5"),b=i("8850c878e08b75c1").utf8,_=i("45edeb55f71ddeb5"),w=i("8850c878e08b75c1").bin,(n=function t(e,i){if(e.constructor==String)if(i&&"binary"===i.encoding)e=w.stringToBytes(e);else e=b.stringToBytes(e);else if(_(e))e=Array.prototype.slice.call(e,0);else if(!Array.isArray(e))e=e.toString();for(var n=v.bytesToWords(e),r=8*e.length,o=1732584193,s=-271733879,a=-1732584194,l=271733878,c=0;c<n.length;c++)n[c]=16711935&(n[c]<<8|n[c]>>>24)|4278255360&(n[c]<<24|n[c]>>>8);n[r>>>5]|=128<<r%32,n[14+(r+64>>>9<<4)]=r;var u=t._ff,h=t._gg,d=t._hh,p=t._ii;for(c=0;c<n.length;c+=16){var f=o,m=s,g=a,y=l;s=p(s=p(s=p(s=p(s=d(s=d(s=d(s=d(s=h(s=h(s=h(s=h(s=u(s=u(s=u(s=u(s,a=u(a,l=u(l,o=u(o,s,a,l,n[c+0],7,-680876936),s,a,n[c+1],12,-389564586),o,s,n[c+2],17,606105819),l,o,n[c+3],22,-1044525330),a=u(a,l=u(l,o=u(o,s,a,l,n[c+4],7,-176418897),s,a,n[c+5],12,1200080426),o,s,n[c+6],17,-1473231341),l,o,n[c+7],22,-45705983),a=u(a,l=u(l,o=u(o,s,a,l,n[c+8],7,1770035416),s,a,n[c+9],12,-1958414417),o,s,n[c+10],17,-42063),l,o,n[c+11],22,-1990404162),a=u(a,l=u(l,o=u(o,s,a,l,n[c+12],7,1804603682),s,a,n[c+13],12,-40341101),o,s,n[c+14],17,-1502002290),l,o,n[c+15],22,1236535329),a=h(a,l=h(l,o=h(o,s,a,l,n[c+1],5,-165796510),s,a,n[c+6],9,-1069501632),o,s,n[c+11],14,643717713),l,o,n[c+0],20,-373897302),a=h(a,l=h(l,o=h(o,s,a,l,n[c+5],5,-701558691),s,a,n[c+10],9,38016083),o,s,n[c+15],14,-660478335),l,o,n[c+4],20,-405537848),a=h(a,l=h(l,o=h(o,s,a,l,n[c+9],5,568446438),s,a,n[c+14],9,-1019803690),o,s,n[c+3],14,-187363961),l,o,n[c+8],20,1163531501),a=h(a,l=h(l,o=h(o,s,a,l,n[c+13],5,-1444681467),s,a,n[c+2],9,-51403784),o,s,n[c+7],14,1735328473),l,o,n[c+12],20,-1926607734),a=d(a,l=d(l,o=d(o,s,a,l,n[c+5],4,-378558),s,a,n[c+8],11,-2022574463),o,s,n[c+11],16,1839030562),l,o,n[c+14],23,-35309556),a=d(a,l=d(l,o=d(o,s,a,l,n[c+1],4,-1530992060),s,a,n[c+4],11,1272893353),o,s,n[c+7],16,-155497632),l,o,n[c+10],23,-1094730640),a=d(a,l=d(l,o=d(o,s,a,l,n[c+13],4,681279174),s,a,n[c+0],11,-358537222),o,s,n[c+3],16,-722521979),l,o,n[c+6],23,76029189),a=d(a,l=d(l,o=d(o,s,a,l,n[c+9],4,-640364487),s,a,n[c+12],11,-421815835),o,s,n[c+15],16,530742520),l,o,n[c+2],23,-995338651),a=p(a,l=p(l,o=p(o,s,a,l,n[c+0],6,-198630844),s,a,n[c+7],10,1126891415),o,s,n[c+14],15,-1416354905),l,o,n[c+5],21,-57434055),a=p(a,l=p(l,o=p(o,s,a,l,n[c+12],6,1700485571),s,a,n[c+3],10,-1894986606),o,s,n[c+10],15,-1051523),l,o,n[c+1],21,-2054922799),a=p(a,l=p(l,o=p(o,s,a,l,n[c+8],6,1873313359),s,a,n[c+15],10,-30611744),o,s,n[c+6],15,-1560198380),l,o,n[c+13],21,1309151649),a=p(a,l=p(l,o=p(o,s,a,l,n[c+4],6,-145523070),s,a,n[c+11],10,-1120210379),o,s,n[c+2],15,718787259),l,o,n[c+9],21,-343485551),o=o+f>>>0,s=s+m>>>0,a=a+g>>>0,l=l+y>>>0}return v.endian([o,s,a,l])})._ff=function(t,e,i,n,r,o,s){var a=t+(e&i|~e&n)+(r>>>0)+s;return(a<<o|a>>>32-o)+e},n._gg=function(t,e,i,n,r,o,s){var a=t+(e&n|i&~n)+(r>>>0)+s;return(a<<o|a>>>32-o)+e},n._hh=function(t,e,i,n,r,o,s){var a=t+(e^i^n)+(r>>>0)+s;return(a<<o|a>>>32-o)+e},n._ii=function(t,e,i,n,r,o,s){var a=t+(i^(e|~n))+(r>>>0)+s;return(a<<o|a>>>32-o)+e},n._blocksize=16,n._digestsize=16,t.exports=function(t,e){if(null==t)throw new Error("Illegal argument "+t);var i=v.wordsToBytes(n(t,e));return e&&e.asBytes?i:e&&e.asString?w.bytesToString(i):v.bytesToHex(i)}},"305e7e9a7e66c3de":function(t,h,d){(function(e){var t=d("00693e66090f3263"),i=setTimeout;function n(){}function o(t){if(!(this instanceof o))throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],u(t,this)}function r(i,n){for(;3===i._state;)i=i._value;if(0!==i._state)i._handled=!0,o._immediateFn(function(){var t=1===i._state?n.onFulfilled:n.onRejected;if(null!==t){var e;try{e=t(i._value)}catch(t){return void a(n.promise,t)}s(n.promise,e)}else(1===i._state?s:a)(n.promise,i._value)});else i._deferreds.push(n)}function s(e,t){try{if(t===e)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"===_typeof(t)||"function"==typeof t)){var i=t.then;if(t instanceof o)return e._state=3,e._value=t,void l(e);else if("function"==typeof i)return void u((n=i,r=t,function(){n.apply(r,arguments)}),e)}e._state=1,e._value=t,l(e)}catch(t){a(e,t)}var n,r}function a(t,e){t._state=2,t._value=e,l(t)}function l(t){if(2===t._state&&0===t._deferreds.length)o._immediateFn(function(){if(!t._handled)o._unhandledRejectionFn(t._value)});for(var e=0,i=t._deferreds.length;e<i;e++)r(t,t._deferreds[e]);t._deferreds=null}function c(t,e,i){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof e?e:null,this.promise=i}function u(t,e){var i=!1;try{t(function(t){if(!i)i=!0,s(e,t)},function(t){if(!i)i=!0,a(e,t)})}catch(t){if(i)return;i=!0,a(e,t)}}o.prototype.catch=function(t){return this.then(null,t)},o.prototype.then=function(t,e){var i=new this.constructor(n);return r(this,new c(t,e,i)),i},o.prototype.finally=t.a,o.all=function(e){return new o(function(n,r){if(!e||void 0===e.length)throw new TypeError("Promise.all accepts an array");var o=Array.prototype.slice.call(e);if(0===o.length)return n([]);var s=o.length;function a(e,t){try{if(t&&("object"===_typeof(t)||"function"==typeof t)){var i=t.then;if("function"==typeof i)return void i.call(t,function(t){a(e,t)},r)}if(o[e]=t,0==--s)n(o)}catch(t){r(t)}}for(var t=0;t<o.length;t++)a(t,o[t])})},o.resolve=function(e){if(e&&"object"===_typeof(e)&&e.constructor===o)return e;else return new o(function(t){t(e)})},o.reject=function(i){return new o(function(t,e){e(i)})},o.race=function(r){return new o(function(t,e){for(var i=0,n=r.length;i<n;i++)r[i].then(t,e)})},o._immediateFn="function"==typeof e&&function(t){e(t)}||function(t){i(t,0)},o._unhandledRejectionFn=function(t){if("undefined"!=typeof console&&console)console.warn("Possible Unhandled Promise Rejection:",t)},h.a=o}).call(this,d("d7ada808cf2940cd").setImmediate)},"30c767f5616de1fb":function(t,e,i){var n=i("186f7c258b03348a");t.exports=function(t){return n.post(t.url).send(t.data).then(function(t){return t.body})}},"44bafe173b7e7d99":function(t,e,i){Object.defineProperty(e,"__esModule",{value:!0});var n=i("627a4e3ad50980bd"),r=i("49de92caa11afecf"),o=i("d1b980a8f08be79b"),s=i("b5b7bf838d55bbbb"),a=function(){function i(){}return i.init=function(t,e){if(!e.appId)return Promise.reject("appId 参数异常："+e.appId);else if(!e.appSecret)return Promise.reject("appSecret 参数异常："+e.appSecret);else if(!e.appVersion)return Promise.reject("appVersion 参数异常："+e.appVersion);else if(!e.channelId)return Promise.reject("channelId 参数异常："+e.channelId);if(t==s.Platform.Cordova)i.cloudladder=new r.default(e);else if(t==s.Platform.Electron)i.cloudladder=new o.default(e);else i.cloudladder=new n.default(e);return i.cloudladder.init.then(function(){i.isInit=!0}),i.cloudladder.init},i.doReportStartup=function(){if(i.isInit)return i.cloudladder.doReportStartup()},i.doReportSignUp=function(t,e){if(i.isInit)return i.cloudladder.doReportLogin(s.LoginType.SignUp,t,e)},i.doReportLogin=function(t,e){if(i.isInit)return i.cloudladder.doReportLogin(s.LoginType.Login,t,e)},i.doReportLogout=function(){if(i.isInit)return i.cloudladder.doReportLogout()},i.doReportEvent=function(t,e){if(i.isInit)return i.cloudladder.doReportEvent(t,e)},i.destroy=function(){i.cloudladder.destroy()},i.isInit=!1,i}();e.cloudLadderSDK=a,window.xf.cloudLadderSDK=a},"45edeb55f71ddeb5":function(t,e){function i(t){return!!t.constructor&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)}t.exports=function(t){return null!=t&&(i(t)||"function"==typeof(e=t).readFloatLE&&"function"==typeof e.slice&&i(e.slice(0,0))||!!t._isBuffer);var e}},"49de92caa11afecf":function(t,e,i){var c=this&&this.__assign||function(){return(c=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var r in e=arguments[i])if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r];return t}).apply(this,arguments)},n=this&&this.__awaiter||function(o,s,a,l){return new(a||(a=Promise))(function(t,e){function i(t){try{r(l.next(t))}catch(t){e(t)}}function n(t){try{r(l.throw(t))}catch(t){e(t)}}function r(e){e.done?t(e.value):new a(function(t){t(e.value)}).then(i,n)}r((l=l.apply(o,s||[])).next())})},u=this&&this.__generator||function(i,n){var r,o,s,t,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;if(o=0,s)e=[2&e[0],s.value];switch(e[0]){case 0:case 1:s=e;break;case 4:return a.label++,{value:e[1],done:!1};case 5:a.label++,o=e[1],e=[0];continue;case 7:e=a.ops.pop(),a.trys.pop();continue;default:if(!(s=0<(s=a.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){a=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){a.label=e[1];break}if(6===e[0]&&a.label<s[1]){a.label=s[1],s=e;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(e);break}if(s[2])a.ops.pop();a.trys.pop();continue}e=n.call(i,a)}catch(t){e=[6,t],o=0}finally{r=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}};Object.defineProperty(e,"__esModule",{value:!0});var h=i("91cd9132e447ac52"),d=i("b5b7bf838d55bbbb"),r=function(){function t(l){var t=this;this.init=new Promise(function(s,a){return n(t,void 0,void 0,function(){var e,i,n,r,o=this;return u(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),[4,this.getDeviceInfo()];case 1:return e=t.sent(),[4,this.getPackName()];case 2:return i=t.sent(),n=c({},e,{platform:"app"}),this.loggerFactory=new h(l.appId,l.appSecret,l.host,c({},l.globalConfig,{pkg:i||""}),d.Mode.Drama,n),this.loggerFactory.setC(l.channelId).setSc(l.subChannelId).setExtc(l.extChannelId).setAppv(l.appVersion).setUid(l.uid),this.startupLogger=this.loggerFactory.getLogger(d.LoggerType.Startup),this.loginLogger=this.loggerFactory.getLogger(d.LoggerType.Login),this.logoutLogger=this.loggerFactory.getLogger(d.LoggerType.Logout),this.heartbeatLogger=this.loggerFactory.getLogger(d.LoggerType.Heartbeat),this.timer=window.setInterval(function(){o.heartbeatLogger.send().catch(function(t){console.log(t)})},6e4),s(),[3,4];case 3:return r=t.sent(),console.error(r),a(r),[3,4];case 4:return[2]}})})})}return t.prototype.doReportStartup=function(){return this.startupLogger.send()},t.prototype.doReportLogin=function(t,e,i){return this.loggerFactory.setUid(e),this.loginLogger=this.loggerFactory.getLogger(d.LoggerType.Login),this.logoutLogger=this.loggerFactory.getLogger(d.LoggerType.Logout),this.heartbeatLogger=this.loggerFactory.getLogger(d.LoggerType.Heartbeat),this.loginLogger.setNew(t).setRtime(i).setLway(d.Lway.UnKnown).send()},t.prototype.doReportLogout=function(){return this.logoutLogger.send()},t.prototype.doReportEvent=function(t,e){return this.loggerFactory.getLogger(d.LoggerType.Event).setAction(t).put(e).send()},t.prototype.destroy=function(){window.clearInterval(this.timer)},t.prototype.getPackName=function(){return new Promise(function(e,i){try{cordova.plugins.DramaApplication.getPackName(function(t){e(t)})}catch(t){i(t)}})},t.prototype.getDeviceInfo=function(){return new Promise(function(e,i){cordova.plugins.DramaApplication.getDeviceInfo(function(t){e(t.device||{})},function(t){i(t)})})},t}();e.default=r},"537d6b6fa7a8e3cb":function(t,e){t.exports={validateState:function(t,e){for(var i in e)if(e[i].required&&!t[i]&&0!==t[i])throw Error(i+" is required");return!0},validateBy:function(t,e){var i=Object.keys(t).slice(1);if(-1===i.indexOf(e))throw Error(e+" not in ["+i.join(", ")+"]");return!0},put:function(i,n,r,o){return function(t,e){if(_typeof(e)!==n)throw Error(t+" should be a "+n);if(-1!==r.indexOf(t))throw Error("you can not change the system keys in ["+r.join(", ")+"]");if(-1!==o.indexOf(t))throw Error("you can not change the global keys in ["+o.join(", ")+"]");return i[t]=e,this}},extendSetters:function(t,n,e,i){for(var r=0;r<e.length;r++){var o=e[r];if("string"==typeof o)o={type:"string",key:o};o.type=o.type||"string";var s=o.key,a=o.type||"string";if("string"===a)n[s]="";else if("number"===a)n[s]=0;i[s]=o,t["set"+s.slice(0,1).toUpperCase()+s.slice(1,s.length)]=function(e,i){return function(t){if(_typeof(t)!==i)throw Error(e+" should be a "+i);return n[e]=t,this}}(s,a)}},pick:function(t,e){for(var i={},n=0;n<e.length;n++){var r=e[n];i[r]=t[r]}return i},delegatorMethod:function(t,e,i){e[i]=function(){return t[i].apply(t,arguments)}},getTz:function(){var t=(new Date).getTimezoneOffset()/60*-1;if(0<t)t="+"+t;else t+="";return t},detectOS:function(t){t=(t||"").toLocaleLowerCase();if(/android/i.test(t))return 1;else if(/(iphone|ipad|ipod|ios)/i.test(t))return 2;else return 3},webDetectOS:function(t){t=(t||"").toLocaleLowerCase();var e=3;if(/(iphone|ipad|ipod|ios)/i.test(t))e=2;else if(-1!==t.indexOf("android"))e=1;else if(-1!==t.indexOf("window"))e=3;else if(-1!==t.indexOf("linux"))e=5;else if(-1!==t.indexOf("os x")||-1!==t.indexOf("mac"))e=4;return e},hasOneKey:function(t,e){if("object"!==_typeof(t))throw Error("globalConfig should be object");for(var i=Object.keys(t),n=0;n<i.length;n++)if(-1!==e.indexOf(i[n]))throw Error("you can not change the system keys in ["+e.join(", ")+"] by the function setGlobalConfig");return!0},assign:function(t,e){for(var i in e)t[i]=e[i];return t},uuid:function(){for(var t=[],e="0123456789abcdef",i=0;i<36;i++)t[i]=e.substr(Math.floor(16*Math.random()),1);t[14]="4",t[19]=e.substr(3&t[19]|8,1),t[8]=t[13]=t[18]=t[23]="-";var n=t.join("");return n},validateAll:function(t,e){for(var i=0;i<e.length;i++){var n=e[i],r=n.key;if(n.required&&!t[r]&&0!==t[r]&&""!==t[r])throw Error(r+" is required");var o=n.type||"string";if(_typeof(t[r])!==o)throw Error(r+" should be "+o)}return!0}}},"5a7cafacff309646":function(t,e,i){e.type=function(t){return t.split(/ *; */).shift()},e.params=function(t){return t.split(/ *; */).reduce(function(t,e){var i=e.split(/ *= */),n=i.shift(),r=i.shift();if(n&&r)t[n]=r;return t},{})},e.parseLinks=function(t){return t.split(/ *, */).reduce(function(t,e){var i=e.split(/ *; */),n=i[0].slice(1,-1);return t[i[1].split(/ *= */)[1].slice(1,-1)]=n,t},{})},e.cleanHeader=function(t,e){if(delete t["content-type"],delete t["content-length"],delete t["transfer-encoding"],delete t.host,e)delete t.authorization,delete t.cookie;return t}},"5b69d43ebd9d048e":function(t,e){var i,n,r=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function a(e){if(i===setTimeout)return setTimeout(e,0);if((i===o||!i)&&setTimeout)return i=setTimeout,setTimeout(e,0);try{return i(e,0)}catch(t){try{return i.call(null,e,0)}catch(t){return i.call(this,e,0)}}}!function(){try{if("function"==typeof setTimeout)i=setTimeout;else i=o}catch(t){i=o}try{if("function"==typeof clearTimeout)n=clearTimeout;else n=s}catch(t){n=s}}();var l,c=[],u=!1,h=-1;function d(){if(u&&l){if(u=!1,l.length)c=l.concat(c);else h=-1;if(c.length)p()}}function p(){if(!u){var t=a(d);u=!0;for(var e=c.length;e;){for(l=c,c=[];++h<e;)if(l)l[h].run();h=-1,e=c.length}l=null,u=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===s||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(t)}}function f(t,e){this.fun=t,this.array=e}function m(){}r.nextTick=function(t){var e=new Array(arguments.length-1);if(1<arguments.length)for(var i=1;i<arguments.length;i++)e[i-1]=arguments[i];if(c.push(new f(t,e)),1===c.length&&!u)a(p)},f.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=m,r.addListener=m,r.once=m,r.off=m,r.removeListener=m,r.removeAllListeners=m,r.emit=m,r.prependListener=m,r.prependOnceListener=m,r.listeners=function(t){return[]},r.binding=function(t){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(t){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},"605825b22d85888e":function(t,e,i){var n=i("186f7c258b03348a");t.exports=function(t){return n.post(t.url).send(t.data).then(function(t){return t.body})}},"627a4e3ad50980bd":function(t,e,i){Object.defineProperty(e,"__esModule",{value:!0});var r=i("91cd9132e447ac52"),o=i("b5b7bf838d55bbbb"),n=function(){function t(i){var n=this;this.init=new Promise(function(t,e){try{n.loggerFactory=new r(i.appId,i.appSecret,i.host,i.globalConfig,o.Mode.Drama,{platform:"web"}),n.loggerFactory.setC(i.channelId).setSc(i.subChannelId).setExtc(i.extChannelId).setAppv(i.appVersion).setUid(i.uid),n.startupLogger=n.loggerFactory.getLogger(o.LoggerType.Startup),n.loginLogger=n.loggerFactory.getLogger(o.LoggerType.Login),n.logoutLogger=n.loggerFactory.getLogger(o.LoggerType.Logout),n.heartbeatLogger=n.loggerFactory.getLogger(o.LoggerType.Heartbeat),n.timer=window.setInterval(function(){n.heartbeatLogger.send().catch(function(t){console.log(t)})},6e4),t()}catch(t){console.error(t),e(t)}})}return t.prototype.doReportStartup=function(){return this.startupLogger.send()},t.prototype.doReportLogin=function(t,e,i){return this.loggerFactory.setUid(e),this.loginLogger=this.loggerFactory.getLogger(o.LoggerType.Login),this.logoutLogger=this.loggerFactory.getLogger(o.LoggerType.Logout),this.heartbeatLogger=this.loggerFactory.getLogger(o.LoggerType.Heartbeat),this.loginLogger.setNew(t).setRtime(i).setLway(o.Lway.UnKnown).send()},t.prototype.doReportLogout=function(){return this.logoutLogger.send()},t.prototype.doReportEvent=function(t,e){return this.loggerFactory.getLogger(o.LoggerType.Event).setAction(t).put(e).send()},t.prototype.destroy=function(){window.clearInterval(this.timer)},t}();e.default=n},"6c241f4130e50913":function(t,e){t.exports={sdkv:"1.4.0",reportTypeConfig:{commonConfig:[{key:"c",required:!0},"sc","extc","uid",{key:"appv",required:!0}],event:[{key:"action",required:!0}],startup:[],login:[{type:"number",key:"rtime",required:!0},{type:"number",key:"new",required:!0},{type:"number",key:"lway",required:!0}],logout:[],heartbeat:[]},keys:["action","appv","c","extc","fc","sc","sdkv","time","uid","rtime","new","lway"],containerConfig:{web:[{type:"string",key:"platform",required:!0}],pc:[{key:"platform",required:!0},{key:"did",required:!0},{key:"tz",required:!0},{key:"lang",required:!0},{key:"width",type:"number",required:!0},{key:"height",type:"number",required:!0},{key:"mac",required:!0},{key:"host",required:!0},{key:"battery",required:!0},{key:"model",required:!0},{key:"os",type:"number",required:!0},{key:"osver",required:!0},{key:"cpu",required:!0},{key:"memory",required:!0},{key:"graph",required:!0},{key:"board",required:!0},{key:"brand",required:!0},{key:"factory",required:!0}],app:[{key:"platform",required:!0},{key:"carrier",required:!0},{key:"jbk",type:"number",required:!0},{key:"did",required:!0},{key:"tz",required:!0},{key:"lang",required:!0},{key:"width",type:"number",required:!0},{key:"height",type:"number",required:!0},{key:"mac",required:!0},{key:"net",type:"number",required:!0},{key:"model",required:!0},{key:"os",type:"number",required:!0},{key:"osver",required:!0},{key:"apil",type:"number",required:!0},{key:"idfa",required:!0},{key:"idfv",required:!0},{key:"imei",required:!0},{key:"ip",required:!0},{key:"wifi",required:!0},{key:"brand",required:!0},{key:"factory",required:!0}],minapp:[{key:"platform",required:!0},{key:"did",required:!0},{key:"tz",required:!0},{key:"lang",required:!0},{key:"width",type:"number",required:!0},{key:"height",type:"number",required:!0},{key:"os",type:"number",required:!0},{key:"osver",required:!0},{key:"brover",required:!0},{key:"ua",required:!0},{key:"ref",required:!0},{key:"apil",type:"number",required:!0},{key:"brand",required:!0},{key:"model",required:!0}]},minappKeys:["did","tz","lang","width","height","os","osver","ua","ref","apil","brand","model","brover"]}},"6c6afa32ac63b8c5":function(t,e,r){r.r(e),function(t){var e=r("305e7e9a7e66c3de"),i=r("00693e66090f3263"),n=function(){if("undefined"!=typeof self)return self;if(void 0!==window)return window;if(void 0!==t)return t;throw new Error("unable to locate global object")}();if(!("Promise"in n))n.Promise=e.a;else if(!n.Promise.prototype.finally)n.Promise.prototype.finally=i.a}.call(this,r("0ee4763173a9a955"))},"7bf15d9882a03017":function(t,e){function i(){this._defaults=[]}["use","on","once","set","query","type","accept","auth","withCredentials","sortQuery","retry","ok","redirects","timeout","buffer","serialize","parse","ca","key","pfx","cert"].forEach(function(t){i.prototype[t]=function(){return this._defaults.push({fn:t,arguments:arguments}),this}}),i.prototype._setDefaults=function(e){this._defaults.forEach(function(t){e[t.fn].apply(e,t.arguments)})},t.exports=i},"83e2d5fbb9b411d2":function(t,e,i){i("6c6afa32ac63b8c5");var n=i("d93933ecb2eefadb"),r=i("b91fa3d329bc4a0f"),o=i("605825b22d85888e"),s=i("292bdc4089e4c5f3");t.exports=function(){return s({browserConfig:n,getDid:r.getDid,getDidSync:r.getDidSync,request:o,contextKey:"browser",storage:{get:function(t){return localStorage.getItem(t)},set:function(t,e){return localStorage.setItem(t,e)}}})}},"8850c878e08b75c1":function(t,e){var i={utf8:{stringToBytes:function(t){return i.bin.stringToBytes(unescape(encodeURIComponent(t)))},bytesToString:function(t){return decodeURIComponent(escape(i.bin.bytesToString(t)))}},bin:{stringToBytes:function(t){for(var e=[],i=0;i<t.length;i++)e.push(255&t.charCodeAt(i));return e},bytesToString:function(t){for(var e=[],i=0;i<t.length;i++)e.push(String.fromCharCode(t[i]));return e.join("")}}};t.exports=i},"8a85aa64fcac3ebf":function(t,e,i){var r=i("5a7cafacff309646");function n(t){if(t)return function(t){for(var e in n.prototype)t[e]=n.prototype[e];return t}(t)}(t.exports=n).prototype.get=function(t){return this.header[t.toLowerCase()]},n.prototype._setHeaderProperties=function(t){var e=t["content-type"]||"";this.type=r.type(e);var i=r.params(e);for(var n in i)this[n]=i[n];this.links={};try{if(t.link)this.links=r.parseLinks(t.link)}catch(t){}},n.prototype._setStatusProperties=function(t){var e=t/100|0;this.status=this.statusCode=t,this.statusType=e,this.info=1==e,this.ok=2==e,this.redirect=3==e,this.clientError=4==e,this.serverError=5==e,this.error=4==e||5==e?this.toError():!1,this.created=201==t,this.accepted=202==t,this.noContent=204==t,this.badRequest=400==t,this.unauthorized=401==t,this.notAcceptable=406==t,this.forbidden=403==t,this.notFound=404==t,this.unprocessableEntity=422==t}},"91cd9132e447ac52":function(t,e,i){var n,r=i("09149f47bd83cc56"),o=i("83e2d5fbb9b411d2");if(!window.isGreatTankShell)n=r();else n=o();window.LoggerFactory=n,t.exports=n},"9b2a67369d2214bb":function(t,e,i){(function(t,d){!function(i,n){if(!i.setImmediate){var r,o,e,s=1,a={},l=!1,c=i.document,t=Object.getPrototypeOf&&Object.getPrototypeOf(i);if(t=t&&t.setTimeout?t:i,"[object process]"==={}.toString.call(i.process))r=function(t){d.nextTick(function(){h(t)})};else if(function(){if(i.postMessage&&!i.importScripts){var t=!0,e=i.onmessage;return i.onmessage=function(){t=!1},i.postMessage("","*"),i.onmessage=e,t}}())!function(){var e="setImmediate$"+Math.random()+"$",t=function(t){if(t.source===i&&"string"==typeof t.data&&0===t.data.indexOf(e))h(+t.data.slice(e.length))};if(i.addEventListener)i.addEventListener("message",t,!1);else i.attachEvent("onmessage",t);r=function(t){i.postMessage(e+t,"*")}}();else if(i.MessageChannel)(e=new MessageChannel).port1.onmessage=function(t){h(t.data)},r=function(t){e.port2.postMessage(t)};else if(c&&"onreadystatechange"in c.createElement("script"))o=c.documentElement,r=function(t){var e=c.createElement("script");e.onreadystatechange=function(){h(t),e.onreadystatechange=null,o.removeChild(e),e=null},o.appendChild(e)};else r=function(t){setTimeout(h,0,t)};t.setImmediate=function(t){if("function"!=typeof t)t=new Function(""+t);for(var e=new Array(arguments.length-1),i=0;i<e.length;i++)e[i]=arguments[i+1];var n={callback:t,args:e};return a[s]=n,r(s),s++},t.clearImmediate=u}function u(t){delete a[t]}function h(t){if(l)setTimeout(h,0,t);else{var e=a[t];if(e){l=!0;try{!function(t){var e=t.callback,i=t.args;switch(i.length){case 0:e();break;case 1:e(i[0]);break;case 2:e(i[0],i[1]);break;case 3:e(i[0],i[1],i[2]);break;default:e.apply(n,i)}}(e)}finally{u(t),l=!1}}}}}("undefined"==typeof self?void 0===t?this:t:self)}).call(this,i("0ee4763173a9a955"),i("5b69d43ebd9d048e"))},a396c9856093b9d2:function(t,e,i){var r=i("14800daf2a27de50");function n(t){if(t)return function(t){for(var e in n.prototype)t[e]=n.prototype[e];return t}(t)}(t.exports=n).prototype.clearTimeout=function(){return clearTimeout(this._timer),clearTimeout(this._responseTimeoutTimer),delete this._timer,delete this._responseTimeoutTimer,this},n.prototype.parse=function(t){return this._parser=t,this},n.prototype.responseType=function(t){return this._responseType=t,this},n.prototype.serialize=function(t){return this._serializer=t,this},n.prototype.timeout=function(t){if(!t||"object"!==_typeof(t))return this._timeout=t,this._responseTimeout=0,this;for(var e in t)switch(e){case"deadline":this._timeout=t.deadline;break;case"response":this._responseTimeout=t.response;break;default:console.warn("Unknown timeout option",e)}return this},n.prototype.retry=function(t,e){if(0===arguments.length||!0===t)t=1;if(t<=0)t=0;return this._maxRetries=t,this._retries=0,this._retryCallback=e,this};var o=["ECONNRESET","ETIMEDOUT","EADDRINFO","ESOCKETTIMEDOUT"];n.prototype._shouldRetry=function(t,e){if(!this._maxRetries||this._retries++>=this._maxRetries)return!1;if(this._retryCallback)try{var i=this._retryCallback(t,e);if(!0===i)return!0;if(!1===i)return!1}catch(t){console.error(t)}if(e&&e.status&&500<=e.status&&501!=e.status)return!0;if(t){if(t.code&&~o.indexOf(t.code))return!0;if(t.timeout&&"ECONNABORTED"==t.code)return!0;if(t.crossDomain)return!0}return!1},n.prototype._retry=function(){if(this.clearTimeout(),this.req)this.req=null,this.req=this.request();return this._aborted=!1,this.timedout=!1,this._end()},n.prototype.then=function(t,e){if(!this._fullfilledPromise){var r=this;if(this._endCalled)console.warn("Warning: superagent request was sent twice, because both .end() and .then() were called. Never call .end() if you use promises");this._fullfilledPromise=new Promise(function(i,n){r.end(function(t,e){if(t)n(t);else i(e)})})}return this._fullfilledPromise.then(t,e)},n.prototype.catch=function(t){return this.then(void 0,t)},n.prototype.use=function(t){return t(this),this},n.prototype.ok=function(t){if("function"!=typeof t)throw Error("Callback required");return this._okCallback=t,this},n.prototype._isResponseOK=function(t){if(!t)return!1;if(this._okCallback)return this._okCallback(t);else return 200<=t.status&&t.status<300},n.prototype.getHeader=n.prototype.get=function(t){return this._header[t.toLowerCase()]},n.prototype.set=function(t,e){if(r(t)){for(var i in t)this.set(i,t[i]);return this}return this._header[t.toLowerCase()]=e,this.header[t]=e,this},n.prototype.unset=function(t){return delete this._header[t.toLowerCase()],delete this.header[t],this},n.prototype.field=function(t,e){if(null==t)throw new Error(".field(name, val) name can not be empty");if(this._data)console.error(".field() can't be used if .send() is used. Please use only .send() or only .field() & .attach()");if(r(t)){for(var i in t)this.field(i,t[i]);return this}if(Array.isArray(e)){for(var n in e)this.field(t,e[n]);return this}if(null==e)throw new Error(".field(name, val) val can not be empty");if("boolean"==typeof e)e=""+e;return this._getFormData().append(t,e),this},n.prototype.abort=function(){if(this._aborted)return this;else return this._aborted=!0,this.xhr&&this.xhr.abort(),this.req&&this.req.abort(),this.clearTimeout(),this.emit("abort"),this},n.prototype._auth=function(t,e,i,n){switch(i.type){case"basic":this.set("Authorization","Basic "+n(t+":"+e));break;case"auto":this.username=t,this.password=e;break;case"bearer":this.set("Authorization","Bearer "+t)}return this},n.prototype.withCredentials=function(t){if(null==t)t=!0;return this._withCredentials=t,this},n.prototype.redirects=function(t){return this._maxRedirects=t,this},n.prototype.maxResponseSize=function(t){if("number"!=typeof t)throw TypeError("Invalid argument");return this._maxResponseSize=t,this},n.prototype.toJSON=function(){return{method:this.method,url:this.url,data:this._data,headers:this._header}},n.prototype.send=function(t){var e=r(t),i=this._header["content-type"];if(this._formData)console.error(".send() can't be used if .attach() or .field() is used. Please use only .send() or only .field() & .attach()");if(e&&!this._data){if(Array.isArray(t))this._data=[];else if(!this._isHost(t))this._data={}}else if(t&&this._data&&this._isHost(this._data))throw Error("Can't merge these send calls");if(e&&r(this._data))for(var n in t)this._data[n]=t[n];else if("string"==typeof t){if(!i)this.type("form");if("application/x-www-form-urlencoded"==(i=this._header["content-type"]))this._data=this._data?this._data+"&"+t:t;else this._data=(this._data||"")+t}else this._data=t;if(!e||this._isHost(t))return this;if(!i)this.type("json");return this},n.prototype.sortQuery=function(t){return this._sort=void 0===t?!0:t,this},n.prototype._finalizeQueryString=function(){var t=this._query.join("&");if(t)this.url+=(0<=this.url.indexOf("?")?"&":"?")+t;if(this._query.length=0,this._sort){var e=this.url.indexOf("?");if(0<=e){var i=this.url.substring(e+1).split("&");if("function"==typeof this._sort)i.sort(this._sort);else i.sort();this.url=this.url.substring(0,e)+"?"+i.join("&")}}},n.prototype._appendQueryString=function(){console.trace("Unsupported")},n.prototype._timeoutError=function(t,e,i){if(!this._aborted){var n=new Error(t+e+"ms exceeded");n.timeout=e,n.code="ECONNABORTED",n.errno=i,this.timedout=!0,this.abort(),this.callback(n)}},n.prototype._setTimeouts=function(){var t=this;if(this._timeout&&!this._timer)this._timer=setTimeout(function(){t._timeoutError("Timeout of ",t._timeout,"ETIME")},this._timeout);if(this._responseTimeout&&!this._responseTimeoutTimer)this._responseTimeoutTimer=setTimeout(function(){t._timeoutError("Response timeout of ",t._responseTimeout,"ETIMEDOUT")},this._responseTimeout)}},a6755452eda84f88:function(t,e,i){if(1)t.exports=n;function n(t){if(t)return function(t){for(var e in n.prototype)t[e]=n.prototype[e];return t}(t)}n.prototype.on=n.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this},n.prototype.once=function(t,e){function i(){this.off(t,i),e.apply(this,arguments)}return i.fn=e,this.on(t,i),this},n.prototype.off=n.prototype.removeListener=n.prototype.removeAllListeners=n.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var i,n=this._callbacks["$"+t];if(!n)return this;if(1==arguments.length)return delete this._callbacks["$"+t],this;for(var r=0;r<n.length;r++)if((i=n[r])===e||i.fn===e){n.splice(r,1);break}return this},n.prototype.emit=function(t){this._callbacks=this._callbacks||{};var e=[].slice.call(arguments,1),i=this._callbacks["$"+t];if(i)for(var n=0,r=(i=i.slice(0)).length;n<r;++n)i[n].apply(this,e);return this},n.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]},n.prototype.hasListeners=function(t){return!!this.listeners(t).length}},b5b7bf838d55bbbb:function(t,e,i){var n,r,o,s,a;Object.defineProperty(e,"__esModule",{value:!0}),(n=e.LoginType||(e.LoginType={}))[n.Login=0]="Login",n[n.SignUp=1]="SignUp",(r=e.Lway||(e.Lway={}))[r.UnKnown=0]="UnKnown",r[r.WeChat=1]="WeChat",r[r.QQ=2]="QQ",r[r.WeiBo=3]="WeiBo",(o=e.LoggerType||(e.LoggerType={})).Startup="startup",o.Login="login",o.Logout="logout",o.Event="event",o.Heartbeat="heartbeat",(s=e.Mode||(e.Mode={}))[s.Browser=0]="Browser",s[s.Drama=1]="Drama",s[s.MiniApp=2]="MiniApp",(a=e.Platform||(e.Platform={})).Browser="browser",a.Electron="electron",a.Cordova="cordova",a.WeChat="wechat",a.ByteDance="bytedance"},b91fa3d329bc4a0f:function(t,e,i){var n=i("d93933ecb2eefadb");function r(){return n().then(function(t){return t.did})}t.exports={getDid:r,getDidSync:r}},d1b980a8f08be79b:function(t,e,i){var l=this&&this.__assign||function(){return(l=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var r in e=arguments[i])if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r];return t}).apply(this,arguments)},n=this&&this.__awaiter||function(o,s,a,l){return new(a||(a=Promise))(function(t,e){function i(t){try{r(l.next(t))}catch(t){e(t)}}function n(t){try{r(l.throw(t))}catch(t){e(t)}}function r(e){e.done?t(e.value):new a(function(t){t(e.value)}).then(i,n)}r((l=l.apply(o,s||[])).next())})},c=this&&this.__generator||function(i,n){var r,o,s,t,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;if(o=0,s)e=[2&e[0],s.value];switch(e[0]){case 0:case 1:s=e;break;case 4:return a.label++,{value:e[1],done:!1};case 5:a.label++,o=e[1],e=[0];continue;case 7:e=a.ops.pop(),a.trys.pop();continue;default:if(!(s=0<(s=a.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){a=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){a.label=e[1];break}if(6===e[0]&&a.label<s[1]){a.label=s[1],s=e;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(e);break}if(s[2])a.ops.pop();a.trys.pop();continue}e=n.call(i,a)}catch(t){e=[6,t],o=0}finally{r=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}};Object.defineProperty(e,"__esModule",{value:!0});var u=i("91cd9132e447ac52"),h=i("b5b7bf838d55bbbb"),r=function(){function t(a){var t=this;this.init=new Promise(function(o,s){return n(t,void 0,void 0,function(){var e,i,n,r=this;return c(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,window.cloudladder.getDeviceInfo()];case 1:return e=t.sent(),i=l({},e,{platform:"pc"}),this.loggerFactory=new u(a.appId,a.appSecret,a.host,a.globalConfig,h.Mode.Drama,i),this.loggerFactory.setC(a.channelId).setSc(a.subChannelId).setExtc(a.extChannelId).setAppv(a.appVersion).setUid(a.uid),this.startupLogger=this.loggerFactory.getLogger(h.LoggerType.Startup),this.loginLogger=this.loggerFactory.getLogger(h.LoggerType.Login),this.logoutLogger=this.loggerFactory.getLogger(h.LoggerType.Logout),this.heartbeatLogger=this.loggerFactory.getLogger(h.LoggerType.Heartbeat),this.timer=window.setInterval(function(){r.heartbeatLogger.send().catch(function(t){console.log(t)})},6e4),o(),[3,3];case 2:return n=t.sent(),console.error(n),s(n),[3,3];case 3:return[2]}})})})}return t.prototype.doReportStartup=function(){return this.startupLogger.send()},t.prototype.doReportLogin=function(t,e,i){return this.loggerFactory.setUid(e),this.loginLogger=this.loggerFactory.getLogger(h.LoggerType.Login),this.logoutLogger=this.loggerFactory.getLogger(h.LoggerType.Logout),this.heartbeatLogger=this.loggerFactory.getLogger(h.LoggerType.Heartbeat),this.loginLogger.setNew(t).setRtime(i).setLway(h.Lway.UnKnown).send()},t.prototype.doReportLogout=function(){return this.logoutLogger.send()},t.prototype.doReportEvent=function(t,e){return this.loggerFactory.getLogger(h.LoggerType.Event).setAction(t).put(e).send()},t.prototype.destroy=function(){window.clearInterval(this.timer)},t}();e.default=r},d7ada808cf2940cd:function(t,r,o){(function(t){var e=void 0!==t&&t||"undefined"!=typeof self&&self||window,i=Function.prototype.apply;function n(t,e){this._id=t,this._clearFn=e}r.setTimeout=function(){return new n(i.call(setTimeout,e,arguments),clearTimeout)},r.setInterval=function(){return new n(i.call(setInterval,e,arguments),clearInterval)},r.clearTimeout=r.clearInterval=function(t){if(t)t.close()},n.prototype.unref=n.prototype.ref=function(){},n.prototype.close=function(){this._clearFn.call(e,this._id)},r.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},r.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},r._unrefActive=r.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;if(0<=e)t._idleTimeoutId=setTimeout(function(){if(t._onTimeout)t._onTimeout()},e)},o("9b2a67369d2214bb"),r.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==t&&t.setImmediate||this&&this.setImmediate,r.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==t&&t.clearImmediate||this&&this.clearImmediate}).call(this,o("0ee4763173a9a955"))},d93933ecb2eefadb:function(t,e,i){var n=i("1e0189becf3fa25f");t.exports=function(){return new Promise(function(i,t){window.GTTankJsBridge.getDeviceInfo(function(e){n().then(function(t){delete t.did,i(Object.assign({},e,t))})})})}},dc8447a9c618c1f4:function(t,e){t.exports=function(t){if(!t.webpackPolyfill){if(t.deprecate=function(){},t.paths=[],!t.children)t.children=[];Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1}return t}},ea5b58cc67292e8c:function(t,d,p){(function(c,u){var h;(function(){var t={function:!0,object:!0},N=t[void 0===window?"undefined":_typeof(window)]&&window||this,e=t[_typeof(d)]&&d,i=t[_typeof(c)]&&c&&!c.nodeType&&c,n=e&&i&&"object"==_typeof(u)&&u;if(n&&(n.global===n||n.window===n||n.self===n))N=n;var o=Math.pow(2,53)-1,B=/\bOpera/,r=Object.prototype,s=r.hasOwnProperty,F=r.toString;function a(t){return(t=String(t)).charAt(0).toUpperCase()+t.slice(1)}function j(t){return t=$(t),/^(?:webOS|i(?:OS|P))/.test(t)?t:a(t)}function G(t,e){for(var i in t)if(s.call(t,i))e(t[i],i,t)}function V(t){return null==t?a(t):F.call(t).slice(8,-1)}function U(t){return String(t).replace(/([ -])(?!$)/g,"$1?")}function W(i,n){var r=null;return function(t,e){var i=-1,n=t?t.length:0;if("number"==typeof n&&-1<n&&n<=o)for(;++i<n;)e(t[i],i,t);else G(t,e)}(i,function(t,e){r=n(r,t,e,i)}),r}function $(t){return String(t).replace(/^ +| +$/g,"")}var l=function t(n){var e=N,i=n&&"object"==_typeof(n)&&"String"!=V(n);if(i)e=n,n=null;var r=e.navigator||{},o=r.userAgent||"";n||(n=o);var s,a,l,c,u,h=i?!!r.likeChrome:/\bChrome\b/.test(n)&&!/internal|\n/i.test(F.toString()),d="Object",p=i?d:"ScriptBridgingProxyObject",f=i?d:"Environment",m=i&&e.java?"JavaPackage":V(e.java),g=i?d:"RuntimeObject",y=/\bJava/.test(m)&&e.java,v=y&&V(e.environment)==f,b=y?"a":"α",_=y?"b":"β",w=e.document||{},x=e.operamini||e.opera,S=B.test(S=i&&x?x["[[Class]]"]:V(x))?S:x=null,I=n,T=[],C=null,O=n==o,P=O&&x&&"function"==typeof x.version&&x.version(),E=W([{label:"EdgeHTML",pattern:"Edge"},"Trident",{label:"WebKit",pattern:"AppleWebKit"},"iCab","Presto","NetFront","Tasman","KHTML","Gecko"],function(t,e){return t||RegExp("\\b"+(e.pattern||U(e))+"\\b","i").exec(n)&&(e.label||e)}),A=W(["Adobe AIR","Arora","Avant Browser","Breach","Camino","Electron","Epiphany","Fennec","Flock","Galeon","GreenBrowser","iCab","Iceweasel","K-Meleon","Konqueror","Lunascape","Maxthon",{label:"Microsoft Edge",pattern:"Edge"},"Midori","Nook Browser","PaleMoon","PhantomJS","Raven","Rekonq","RockMelt",{label:"Samsung Internet",pattern:"SamsungBrowser"},"SeaMonkey",{label:"Silk",pattern:"(?:Cloud9|Silk-Accelerated)"},"Sleipnir","SlimBrowser",{label:"SRWare Iron",pattern:"Iron"},"Sunrise","Swiftfox","Waterfox","WebPositive","Opera Mini",{label:"Opera Mini",pattern:"OPiOS"},"Opera",{label:"Opera",pattern:"OPR"},"Chrome",{label:"Chrome Mobile",pattern:"(?:CriOS|CrMo)"},{label:"Firefox",pattern:"(?:Firefox|Minefield)"},{label:"Firefox for iOS",pattern:"FxiOS"},{label:"IE",pattern:"IEMobile"},{label:"IE",pattern:"MSIE"},"Safari"],function(t,e){return t||RegExp("\\b"+(e.pattern||U(e))+"\\b","i").exec(n)&&(e.label||e)}),k=L([{label:"BlackBerry",pattern:"BB10"},"BlackBerry",{label:"Galaxy S",pattern:"GT-I9000"},{label:"Galaxy S2",pattern:"GT-I9100"},{label:"Galaxy S3",pattern:"GT-I9300"},{label:"Galaxy S4",pattern:"GT-I9500"},{label:"Galaxy S5",pattern:"SM-G900"},{label:"Galaxy S6",pattern:"SM-G920"},{label:"Galaxy S6 Edge",pattern:"SM-G925"},{label:"Galaxy S7",pattern:"SM-G930"},{label:"Galaxy S7 Edge",pattern:"SM-G935"},"Google TV","Lumia","iPad","iPod","iPhone","Kindle",{label:"Kindle Fire",pattern:"(?:Cloud9|Silk-Accelerated)"},"Nexus","Nook","PlayBook","PlayStation Vita","PlayStation","TouchPad","Transformer",{label:"Wii U",pattern:"WiiU"},"Wii","Xbox One",{label:"Xbox 360",pattern:"Xbox"},"Xoom"]),M=W({Apple:{iPad:1,iPhone:1,iPod:1},Archos:{},Amazon:{Kindle:1,"Kindle Fire":1},Asus:{Transformer:1},"Barnes & Noble":{Nook:1},BlackBerry:{PlayBook:1},Google:{"Google TV":1,Nexus:1},HP:{TouchPad:1},HTC:{},LG:{},Microsoft:{Xbox:1,"Xbox One":1},Motorola:{Xoom:1},Nintendo:{"Wii U":1,Wii:1},Nokia:{Lumia:1},Samsung:{"Galaxy S":1,"Galaxy S2":1,"Galaxy S3":1,"Galaxy S4":1},Sony:{PlayStation:1,"PlayStation Vita":1}},function(t,e,i){return t||(e[k]||e[/^[a-z]+(?: +[a-z]+\b)*/i.exec(k)]||RegExp("\\b"+U(i)+"(?:\\b|\\w*\\d)","i").exec(n))&&i}),R=W(["Windows Phone","Android","CentOS",{label:"Chrome OS",pattern:"CrOS"},"Debian","Fedora","FreeBSD","Gentoo","Haiku","Kubuntu","Linux Mint","OpenBSD","Red Hat","SuSE","Ubuntu","Xubuntu","Cygwin","Symbian OS","hpwOS","webOS ","webOS","Tablet OS","Tizen","Linux","Mac OS X","Macintosh","Mac","Windows 98;","Windows "],function(t,e){var i=e.pattern||U(e);if(!t&&(t=RegExp("\\b"+i+"(?:/[\\d.]+|[ \\w.]*)","i").exec(n)))t=function(t,e,i){var n={"10.0":"10",6.4:"10 Technical Preview",6.3:"8.1",6.2:"8",6.1:"Server 2008 R2 / 7","6.0":"Server 2008 / Vista",5.2:"Server 2003 / XP 64-bit",5.1:"XP",5.01:"2000 SP1","5.0":"2000","4.0":"NT","4.90":"ME"};if(e&&i&&/^Win/i.test(t)&&!/^Windows Phone /i.test(t)&&(n=n[/[\d.]+$/.exec(t)]))t="Windows "+n;if(t=String(t),e&&i)t=t.replace(RegExp(e,"i"),i);return t=j(t.replace(/ ce$/i," CE").replace(/\bhpw/i,"web").replace(/\bMacintosh\b/,"Mac OS").replace(/_PowerPC\b/i," OS").replace(/\b(OS X) [^ \d]+/i,"$1").replace(/\bMac (OS X)\b/,"$1").replace(/\/(\d)/," $1").replace(/_/g,".").replace(/(?: BePC|[ .]*fc[ \d.]+)$/i,"").replace(/\bx86\.64\b/gi,"x86_64").replace(/\b(Windows Phone) OS\b/,"$1").replace(/\b(Chrome OS \w+) [\d.]+\b/,"$1").split(" on ")[0])}(t,i,e.label||e);return t});function L(t){return W(t,function(t,e){var i=e.pattern||U(e);if(!t&&(t=RegExp("\\b"+i+" *\\d+[.\\w_]*","i").exec(n)||RegExp("\\b"+i+" *\\w+-[\\w]*","i").exec(n)||RegExp("\\b"+i+"(?:; *(?:[a-z]+[_-])?[a-z]+\\d+|[^ ();-]*)","i").exec(n))){if((t=String(e.label&&!RegExp(i,"i").test(e.label)?e.label:t).split("/"))[1]&&!/[\d.]+/.test(t[0]))t[0]+=" "+t[1];e=e.label||e,t=j(t[0].replace(RegExp(i,"i"),e).replace(RegExp("; *(?:"+e+"[_-])?","i")," ").replace(RegExp("("+e+")[-_.]?(\\w)","i"),"$1 $2"))}return t})}if(E&&(E=[E]),M&&!k)k=L([M]);if(s=/\bGoogle TV\b/.exec(k))k=s[0];if(/\bSimulator\b/i.test(n))k=(k?k+" ":"")+"Simulator";if("Opera Mini"==A&&/\bOPiOS\b/.test(n))T.push("running in Turbo/Uncompressed mode");if("IE"==A&&/\blike iPhone OS\b/.test(n))M=(s=t(n.replace(/like iPhone OS/,""))).manufacturer,k=s.product;else if(/^iP/.test(k))A||(A="Safari"),R="iOS"+((s=/ OS ([\d_]+)/i.exec(n))?" "+s[1].replace(/_/g,"."):"");else if("Konqueror"==A&&!/buntu/i.test(R))R="Kubuntu";else if(M&&"Google"!=M&&(/Chrome/.test(A)&&!/\bMobile Safari\b/i.test(n)||/\bVita\b/.test(k))||/\bAndroid\b/.test(R)&&/^Chrome/.test(A)&&/\bVersion\//i.test(n))A="Android Browser",R=/\bAndroid\b/.test(R)?R:"Android";else if("Silk"==A){if(!/\bMobi/i.test(n))R="Android",T.unshift("desktop mode");if(/Accelerated *= *true/i.test(n))T.unshift("accelerated")}else if("PaleMoon"==A&&(s=/\bFirefox\/([\d.]+)\b/.exec(n)))T.push("identifying as Firefox "+s[1]);else if("Firefox"==A&&(s=/\b(Mobile|Tablet|TV)\b/i.exec(n)))R||(R="Firefox OS"),k||(k=s[1]);else if(!A||(s=!/\bMinefield\b/i.test(n)&&/\b(?:Firefox|Safari)\b/.exec(A))){if(A&&!k&&/[\/,]|^[^(]+?\)/.test(n.slice(n.indexOf(s+"/")+8)))A=null;if((s=k||M||R)&&(k||M||/\b(?:Android|Symbian OS|Tablet OS|webOS)\b/.test(R)))A=/[a-z]+(?: Hat)?/i.exec(/\bAndroid\b/.test(R)?R:s)+" Browser"}else if("Electron"==A&&(s=(/\bChrome\/([\d.]+)\b/.exec(n)||0)[1]))T.push("Chromium "+s);if(!P)P=W(["(?:Cloud9|CriOS|CrMo|Edge|FxiOS|IEMobile|Iron|Opera ?Mini|OPiOS|OPR|Raven|SamsungBrowser|Silk(?!/[\\d.]+$))","Version",U(A),"(?:Firefox|Minefield|NetFront)"],function(t,e){return t||(RegExp(e+"(?:-[\\d.]+/|(?: for [\\w-]+)?[ /-])([\\d.]+[^ ();/_-]*)","i").exec(n)||0)[1]||null});if(s=("iCab"==E&&3<parseFloat(P)?"WebKit":/\bOpera\b/.test(A)&&(/\bOPR\b/.test(n)?"Blink":"Presto"))||/\b(?:Midori|Nook|Safari)\b/i.test(n)&&!/^(?:Trident|EdgeHTML)$/.test(E)&&"WebKit"||!E&&/\bMSIE\b/i.test(n)&&("Mac OS"==R?"Tasman":"Trident")||"WebKit"==E&&/\bPlayStation\b(?! Vita\b)/i.test(A)&&"NetFront")E=[s];if("IE"==A&&(s=(/; *(?:XBLWP|ZuneWP)(\d+)/i.exec(n)||0)[1]))A+=" Mobile",R="Windows Phone "+(/\+$/.test(s)?s:s+".x"),T.unshift("desktop mode");else if(/\bWPDesktop\b/i.test(n))A="IE Mobile",R="Windows Phone 8.x",T.unshift("desktop mode"),P||(P=(/\brv:([\d.]+)/.exec(n)||0)[1]);else if("IE"!=A&&"Trident"==E&&(s=/\brv:([\d.]+)/.exec(n))){if(A)T.push("identifying as "+A+(P?" "+P:""));A="IE",P=s[1]}if(O){if(c="global",u=null!=(l=e)?_typeof(l[c]):"number",!/^(?:boolean|number|string|undefined)$/.test(u)&&("object"==u?l[c]:1)){if(y)I=(s=y.lang.System).getProperty("os.arch"),R=R||s.getProperty("os.name")+" "+s.getProperty("os.version");if(v){try{P=e.require("ringo/engine").version.join("."),A="RingoJS"}catch(t){if((s=e.system)&&s.global.system==e.system)A="Narwhal",R||(R=s[0].os||null)}if(!A)A="Rhino"}else if("object"==_typeof(e.process)&&!e.process.browser&&(s=e.process)){if("object"==_typeof(s.versions))if("string"==typeof s.versions.electron)T.push("Node "+s.versions.node),A="Electron",P=s.versions.electron;else if("string"==typeof s.versions.nw)T.push("Chromium "+P,"Node "+s.versions.node),A="NW.js",P=s.versions.nw;if(!A)A="Node.js",I=s.arch,R=s.platform,P=(P=/[\d.]+/.exec(s.version))?P[0]:null}}else if(V(s=e.runtime)==p)A="Adobe AIR",R=s.flash.system.Capabilities.os;else if(V(s=e.phantom)==g)A="PhantomJS",P=(s=s.version||null)&&s.major+"."+s.minor+"."+s.patch;else if("number"==typeof w.documentMode&&(s=/\bTrident\/(\d+)/i.exec(n))){if(P=[P,w.documentMode],(s=+s[1]+4)!=P[1])T.push("IE "+P[1]+" mode"),E&&(E[1]=""),P[1]=s;P="IE"==A?String(P[1].toFixed(1)):P[0]}else if("number"==typeof w.documentMode&&/^(?:Chrome|Firefox)\b/.test(A))T.push("masking as "+A+" "+P),A="IE",P="11.0",E=["Trident"],R="Windows";R=R&&j(R)}if(P&&(s=/(?:[ab]|dp|pre|[ab]\d+pre)(?:\d+\+?)?$/i.exec(P)||/(?:alpha|beta)(?: ?\d)?/i.exec(n+";"+(O&&r.appMinorVersion))||/\bMinefield\b/i.test(n)&&"a"))C=/b/i.test(s)?"beta":"alpha",P=P.replace(RegExp(s+"\\+?$"),"")+("beta"==C?_:b)+(/\d+\+?/.exec(s)||"");if("Fennec"==A||"Firefox"==A&&/\b(?:Android|Firefox OS)\b/.test(R))A="Firefox Mobile";else if("Maxthon"==A&&P)P=P.replace(/\.[\d.]+/,".x");else if(/\bXbox\b/i.test(k)){if("Xbox 360"==k)R=null;if("Xbox 360"==k&&/\bIEMobile\b/.test(n))T.unshift("mobile mode")}else if((/^(?:Chrome|IE|Opera)$/.test(A)||A&&!k&&!/Browser|Mobi/.test(A))&&("Windows CE"==R||/Mobi/i.test(n)))A+=" Mobile";else if("IE"==A&&O)try{if(null===e.external)T.unshift("platform preview")}catch(t){T.unshift("embedded")}else if((/\bBlackBerry\b/.test(k)||/\bBB10\b/.test(n))&&(s=(RegExp(k.replace(/ +/g," *")+"/([.\\d]+)","i").exec(n)||0)[1]||P))R=((s=[s,/BB10/.test(n)])[1]?(k=null,M="BlackBerry"):"Device Software")+" "+s[0],P=null;else if(this!=G&&"Wii"!=k&&(O&&x||/Opera/.test(A)&&/\b(?:MSIE|Firefox)\b/i.test(n)||"Firefox"==A&&/\bOS X (?:\d+\.){2,}/.test(R)||"IE"==A&&(R&&!/^Win/.test(R)&&5.5<P||/\bWindows XP\b/.test(R)&&8<P||8==P&&!/\bTrident\b/.test(n)))&&!B.test(s=t.call(G,n.replace(B,"")+";"))&&s.name){if(s="ing as "+s.name+((s=s.version)?" "+s:""),B.test(A)){if(/\bIE\b/.test(s)&&"Mac OS"==R)R=null;s="identify"+s}else{if(s="mask"+s,S)A=j(S.replace(/([a-z])([A-Z])/g,"$1 $2"));else A="Opera";if(/\bIE\b/.test(s))R=null;if(!O)P=null}E=["Presto"],T.push(s)}if(s=(/\bAppleWebKit\/([\d.]+\+?)/i.exec(n)||0)[1]){if(s=[parseFloat(s.replace(/\.(\d)$/,".0$1")),s],"Safari"==A&&"+"==s[1].slice(-1))A="WebKit Nightly",C="alpha",P=s[1].slice(0,-1);else if(P==s[1]||P==(s[2]=(/\bSafari\/([\d.]+\+?)/i.exec(n)||0)[1]))P=null;if(s[1]=(/\bChrome\/([\d.]+)/i.exec(n)||0)[1],537.36==s[0]&&537.36==s[2]&&28<=parseFloat(s[1])&&"WebKit"==E)E=["Blink"];if(!O||!h&&!s[1])E&&(E[1]="like Safari"),s=(s=s[0])<400?1:s<500?2:s<526?3:s<533?4:s<534?"4+":s<535?5:s<537?6:s<538?7:s<601?8:"8";else E&&(E[1]="like Chrome"),s=s[1]||((s=s[0])<530?1:s<532?2:s<532.05?3:s<533?4:s<534.03?5:s<534.07?6:s<534.1?7:s<534.13?8:s<534.16?9:s<534.24?10:s<534.3?11:s<535.01?12:s<535.02?"13+":s<535.07?15:s<535.11?16:s<535.19?17:s<536.05?18:s<536.1?19:s<537.01?20:s<537.11?"21+":s<537.13?23:s<537.18?24:s<537.24?25:s<537.36?26:"Blink"!=E?"27":"28");if(E&&(E[1]+=" "+(s+="number"==typeof s?".x":/[.+]/.test(s)?"":"+")),"Safari"==A&&(!P||45<parseInt(P)))P=s}if("Opera"==A&&(s=/\bzbov|zvav$/.exec(R))){if(A+=" ",T.unshift("desktop mode"),"zvav"==s)A+="Mini",P=null;else A+="Mobile";R=R.replace(RegExp(" *"+s+"$"),"")}else if("Safari"==A&&/\bChrome\b/.exec(E&&E[1]))if(T.unshift("desktop mode"),A="Chrome Mobile",P=null,/\bOS X\b/.test(R))M="Apple",R="iOS 4.3+";else R=null;if(P&&0==P.indexOf(s=/[\d.]+$/.exec(R))&&-1<n.indexOf("/"+s+"-"))R=$(R.replace(s,""));if(E&&!/\b(?:Avant|Nook)\b/.test(A)&&(/Browser|Lunascape|Maxthon/.test(A)||"Safari"!=A&&/^iOS/.test(R)&&/\bSafari\b/.test(E[1])||/^(?:Adobe|Arora|Breach|Midori|Opera|Phantom|Rekonq|Rock|Samsung Internet|Sleipnir|Web)/.test(A)&&E[1]))(s=E[E.length-1])&&T.push(s);if(T.length)T=["("+T.join("; ")+")"];if(M&&k&&k.indexOf(M)<0)T.push("on "+M);if(k)T.push((/^on /.test(T[T.length-1])?"":"on ")+k);if(R)s=/ ([\d.+]+)$/.exec(R),a=s&&"/"==R.charAt(R.length-s[0].length-1),R={architecture:32,family:s&&!a?R.replace(s[0],""):R,version:s?s[1]:null,toString:function(){var t=this.version;return this.family+(t&&!a?" "+t:"")+(64==this.architecture?" 64-bit":"")}};if((s=/\b(?:AMD|IA|Win|WOW|x86_|x)64\b/i.exec(I))&&!/\bi686\b/i.test(I)){if(R)R.architecture=64,R.family=R.family.replace(RegExp(" *"+s),"");if(A&&(/\bWOW64\b/i.test(n)||O&&/\w(?:86|32)$/.test(r.cpuClass||r.platform)&&!/\bWin64; x64\b/i.test(n)))T.unshift("32-bit")}else if(R&&/^OS X/.test(R.family)&&"Chrome"==A&&39<=parseFloat(P))R.architecture=64;n||(n=null);var D={};if(D.description=n,D.layout=E&&E[0],D.manufacturer=M,D.name=A,D.prerelease=C,D.product=k,D.ua=n,D.version=A&&P,D.os=R||{architecture:null,family:null,version:null,toString:function(){return"null"}},D.parse=t,D.toString=function(){return this.description||""},D.version)T.unshift(P);if(D.name)T.unshift(A);if(R&&A&&(R!=String(R).split(" ")[0]||R!=A.split(" ")[0]&&!k))T.push(k?"("+R+")":"on "+R);if(T.length)D.description=T.join(" ");return D}();if(1)N.platform=l,void 0===(h=function(){return l}.call(d,p,d,c))||(c.exports=h)}).call(this)}).call(this,p("dc8447a9c618c1f4")(t),p("0ee4763173a9a955"))},f7942e3ea8ab53f5:function(t,e){var o,i;o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i={rotl:function(t,e){return t<<e|t>>>32-e},rotr:function(t,e){return t<<32-e|t>>>e},endian:function(t){if(t.constructor==Number)return 16711935&i.rotl(t,8)|4278255360&i.rotl(t,24);for(var e=0;e<t.length;e++)t[e]=i.endian(t[e]);return t},randomBytes:function(t){for(var e=[];0<t;t--)e.push(Math.floor(256*Math.random()));return e},bytesToWords:function(t){for(var e=[],i=0,n=0;i<t.length;i++,n+=8)e[n>>>5]|=t[i]<<24-n%32;return e},wordsToBytes:function(t){for(var e=[],i=0;i<32*t.length;i+=8)e.push(t[i>>>5]>>>24-i%32&255);return e},bytesToHex:function(t){for(var e=[],i=0;i<t.length;i++)e.push((t[i]>>>4).toString(16)),e.push((15&t[i]).toString(16));return e.join("")},hexToBytes:function(t){for(var e=[],i=0;i<t.length;i+=2)e.push(parseInt(t.substr(i,2),16));return e},bytesToBase64:function(t){for(var e=[],i=0;i<t.length;i+=3)for(var n=t[i]<<16|t[i+1]<<8|t[i+2],r=0;r<4;r++)if(8*i+6*r<=8*t.length)e.push(o.charAt(n>>>6*(3-r)&63));else e.push("=");return e.join("")},base64ToBytes:function(t){t=t.replace(/[^A-Z0-9+\/]/gi,"");for(var e=[],i=0,n=0;i<t.length;n=++i%4)if(0!=n)e.push((o.indexOf(t.charAt(i-1))&Math.pow(2,-2*n+8)-1)<<2*n|o.indexOf(t.charAt(i))>>>6-2*n);return e}},t.exports=i},ff9c8a971a33458f:function(t,e,i){var n=i("2fa6db0e3e060439"),r=i("537d6b6fa7a8e3cb");function o(){return new Promise(function(t,e){t(function(){var t="__data:sdk-did",e=localStorage.getItem(t);if(e)return e;else{var i=n(r.uuid()).toUpperCase();return localStorage.setItem(t,i),i}}())})}t.exports={getDid:o,getDidSync:o}}}),function(xf){var t;(t=xf.Action||(xf.Action={})).CONFIRM="confirm",t.CANCEL="cancel",t.CLOSE="close";var e=function(){function I(){}return I.createCanvas=function(){var t=document.createElement("canvas");t.width=window.innerWidth,t.height=window.innerHeight,t.style.width=window.innerWidth+"px",t.style.height=window.innerHeight+"px",t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.style.zIndex="1000";var e=t.getContext("2d");I.canvas=t,I.ctx=e,document.body.appendChild(t)},I.drawButton=function(t){var e=t.confirmCallback,i=t.cancelCallback,n=t.showConfirmButton,r=t.hideCancelButton,o=t.confirmButtonText,s=t.cancelButtonText;if(e)I.buttonCb=e;if(i)I.cancelButtonCb=i;var a=I.buttonFontSize,l=I.ctx,c=o||window.trFunc("确认"),u=I.buttonWidth,h=I.buttonHeight,d=I.modalWidth,p=I.modalHeight,f=window.innerWidth/2-d/2,m=window.innerHeight/2-p/2;if(n){var g=I.buttonX=f+190,y=I.buttonY=m+210,v=g+(u-a*xf.getStringLength(c)/2)/2,b=y+8;I.fillRoundRect(l,g,y,u,h,2,"#FC425F"),I.writeText(l,c,{fontSize:a,isBold:!1,fontFamily:"Arial",color:"#ffffff",x:v,y:b})}if(!r){s=s||window.trFunc("取消");var _=I.cancelButtonX=f+108,w=I.cancelButtonY=m+210,x=_+(u-a*xf.getStringLength(s)/2)/2,S=w+8;I.fillRoundRect(l,_,w,u,h,2,"#242741"),I.writeText(l,s,{fontSize:a,isBold:!1,fontFamily:"Arial",color:"#ffffff",x:x,y:S})}I.bindEvent()},I.setButtonCallback=function(t){I.buttonCb=t},I.setCancleBtnCallback=function(t){I.cancelButtonCb=t},I.showAlert=function(t,e){if(!I.ctx)I.createCanvas();I.removeEvent();var i=I.ctx;i.clearRect(0,0,window.innerWidth,window.innerHeight);var n=I.modalWidth,r=I.modalHeight,o=window.innerWidth/2-n/2,s=window.innerHeight/2-r/2;if(I.fillRoundRect(i,o,s,n,r,2,"rgba(250, 250, 250, 1)"),I.writeText(i,window.trFunc("提示"),{fontSize:20,isBold:!0,fontFamily:"SimHei",color:"#161830",x:o+24,y:s+28}),I.writeText(i,t,{fontSize:16,isBold:!1,fontFamily:"Arial",color:"#484A5C",x:o+24,y:s+66,isWrap:!0}),!e)e={};I.drawButton(e)},I.destroyAlert=function(){I.destroyButton()},I.destroyButton=function(){if(I.removeEvent(),I.canvas)I.canvas.parentNode.removeChild(I.canvas),I.ctx=null,I.canvas=null,I.buttonCb=null},I.clickButton=function(t){var e=I.getEventPosition(t);if(I.buttonX<=e.x&&I.buttonX+I.buttonWidth>=e.x&&I.buttonY<=e.y&&I.buttonY+I.buttonHeight>=e.y)I.buttonCb&&I.buttonCb(e),xf.XfLoginCanvas.destroyAlert();if(I.cancelButtonX<=e.x&&I.cancelButtonX+I.buttonWidth>=e.x&&I.cancelButtonY<=e.y&&I.cancelButtonY+I.buttonHeight>=e.y)I.cancelButtonCb&&I.cancelButtonCb(e),xf.XfLoginCanvas.destroyAlert()},I.getEventPosition=function(t){return{x:t.pageX,y:t.pageY}},I.bindEvent=function(){var t=I.canvas;t.addEventListener("click",I.clickButton),t.addEventListener("touch",I.clickButton)},I.removeEvent=function(){var t=I.canvas;if(t)t.removeEventListener("click",I.clickButton),t.removeEventListener("touch",I.clickButton)},I.writeText=function(t,e,i){var n=i.fontSize,r=i.color,o=i.isBold,s=i.fontFamily,a=i.isWrap,l=i.x,c=i.y,u=I.wrapWidth,h=e.split(""),d="",p=[];if(t.font=n+"px "+(o?"bold":"")+" "+s,t.fillStyle=r,t.textBaseline="top",a){for(var f=0,m=h.length;f<m;f++)if(t.measureText(d).width+t.measureText(h[f]).width>u)p.push(d),d=h[f];else d+=h[f];p.push(d);var g=0;for(m=p.length;g<m;g++)t.fillText(p[g],l,c+24*g)}else t.fillText(e,l,c)},I.fillRoundRect=function(t,e,i,n,r,o,s){if(n<2*o||r<2*o)return!1;t.save(),t.translate(e,i),I.drawRoundRectPath(t,n,r,o),t.fillStyle=s||"#000",t.fill(),t.restore()},I.drawRoundRectPath=function(t,e,i,n){t.beginPath(0),t.arc(e-n,i-n,n,0,Math.PI/2),t.lineTo(n,i),t.arc(n,i-n,n,Math.PI/2,Math.PI),t.lineTo(0,n),t.arc(n,n,n,Math.PI,3*Math.PI/2),t.lineTo(e-n,0),t.arc(e-n,n,n,3*Math.PI/2,2*Math.PI),t.lineTo(e,i-n),t.closePath()},I.buttonWidth=70,I.buttonHeight=30,I.buttonFontSize=14,I.modalWidth=280,I.modalHeight=250,I.wrapWidth=232,I}();xf.XfLoginCanvas=e}(xf||(xf={})),function(i){var n={};function r(t){if(n[t])return n[t].exports;var e=n[t]={i:t,l:!1,exports:{}};return i[t].call(e.exports,e,e.exports,r),e.l=!0,e.exports}r.m=i,r.c=n,r.d=function(t,e,i){if(!r.o(t,e))Object.defineProperty(t,e,{enumerable:!0,get:i})},r.r=function(t){if("undefined"!=typeof Symbol&&Symbol.toStringTag)Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(e,t){if(1&t)e=r(e);if(8&t)return e;if(4&t&&"object"===_typeof(e)&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(i,n,function(t){return e[t]}.bind(null,n));return i},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s="96388ee7a1bdcbdb")}({"2eda73dc5810244d":function(t,e,i){Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(){var t=this;if(this.$startTime=0,this.bufferSource=null,this.context=null,this._currentTime=0,this._volume=1,this.onPlayEnd=function(){if(1!=t.$loops){if(0<t.$loops)t.$loops--;t.$play()}else t.stop()},this._startTime=0,window.AudioContext||window.webkitAudioContext||window.mozAudioContext)this.context=new(window.AudioContext||window.webkitAudioContext||window.mozAudioContext);if(this.context.createGain)this.gain=this.context.createGain();else this.gain=this.context.createGainNode()}return t.prototype.$play=function(){if(this.bufferSource)this.bufferSource.onended=null,this.bufferSource=null;var t=this.context,e=this.gain,i=t.createBufferSource();(this.bufferSource=i).buffer=this.$audioBuffer,i.connect(e),e.connect(t.destination),i.onended=this.onPlayEnd,this._startTime=Date.now(),this.gain.gain.value=this._volume,i.start(0,this.$startTime),this._currentTime=0},t.prototype.stop=function(){if(this.bufferSource){var t=this.bufferSource;if(t.stop)t.stop(0);else t.noteOff(0)}},Object.defineProperty(t.prototype,"volume",{get:function(){return this._volume},set:function(t){this._volume=t,this.gain.gain.value=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"position",{get:function(){if(this.bufferSource)return(Date.now()-this._startTime)/1e3+this.$startTime;else return 0},enumerable:!0,configurable:!0}),t}();e.default=n},"58efb290eccd0b6d":function(t,e,i){Object.defineProperty(e,"__esModule",{value:!0});var n=i("2eda73dc5810244d"),r=function(){function i(){}return i.decodeAudios=function(){if(!i.ctx&&(window.AudioContext||window.webkitAudioContext||window.mozAudioContext))i.ctx=new(window.AudioContext||window.webkitAudioContext||window.mozAudioContext);if(!(i.decodeArr.length<=0))if(!i.isDecoding){i.isDecoding=!0;var e=i.decodeArr.shift();i.ctx.decodeAudioData(e.buffer,function(t){if(e.self.audioBuffer=t,e.success)e.success();i.isDecoding=!1,i.decodeAudios()},function(){if(e.fail)e.fail();i.isDecoding=!1,i.decodeAudios()})}},i.ctx=null,i.decodeArr=[],i.isDecoding=!1,i}();e.WebAudioDecode=r;var o=function(){function t(t){var e=this;r.decodeArr.push({buffer:t,success:function(){e.channelInst=new n.default},fail:function(){},self:this}),r.decodeAudios()}return Object.defineProperty(t.prototype,"length",{get:function(){if(this.audioBuffer)return this.audioBuffer.duration;throw new Error("sound not loaded!")},enumerable:!0,configurable:!0}),t.prototype.play=function(t,e){if(this.channelInst)return t=+t||0,e=+e||0,this.channelInst.$loops=e,this.channelInst.$audioBuffer=this.audioBuffer,this.channelInst.$startTime=t,this.channelInst.$play(),this},t.prototype.stop=function(){if(this.channelInst)this.channelInst.stop()},t.prototype.close=function(){this.channelInst=null},Object.defineProperty(t.prototype,"volume",{get:function(){if(!this.channelInst)return 0;else return this.channelInst.volume},set:function(t){if(this.channelInst)this.channelInst.volume=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"position",{get:function(){if(this.channelInst)return this.channelInst.position},enumerable:!0,configurable:!0}),t.MUSIC="music",t.EFFECT="effect",t}();e.default=o},"930e8b72a07f25ce":function(t,e,i){function r(n){return new Promise(function(e,i){var t=window.cordova.file.applicationDirectory+"www/"+n;window.resolveLocalFileSystemURL(t,function(t){t.file(function(t){e(t)},function(t){i(t)})},function(t){i(t)})})}function n(t){return new Promise(function(i,n){r(t).then(function(t){var e=new FileReader;e.onload=function(t){i(t.target.result)},e.onerror=function(t){n(t)},e.readAsText(t)}).catch(function(t){n(t)})})}function o(t){var i=this,r="",e=t.toLowerCase(),n=e.substr(e.length-4),o=e.substr(e.length-5);if(".mp4"===n)r="video/mp4";else if(".webm"===o)r="video/webm";else if(".m4a"===n)r="audio/mp4";else if(".mp3"===n)r="audio/mpeg";return new Promise(function(n,e){i.fetchLocalFileViaCordovaAsArrayBuffer(t).then(function(t){var e=new Blob([t],{type:r}),i=URL.createObjectURL(e);n(i)}).catch(function(t){e(t)})})}function s(t){return new Promise(function(i,e){r(t).then(function(t){var e=new FileReader;e.onload=function(t){i(t.target.result)},e.readAsArrayBuffer(t)}).catch(function(t){e(t)})})}Object.defineProperty(e,"__esModule",{value:!0}),e.fetchLocalFileViaCordova=r,e.fetchLocalFileViaCordovaAsText=n,e.fetchLocalFileViaCordovaAsURL=o;var a={fetchLocalFileViaCordova:r,fetchLocalFileViaCordovaAsText:n,fetchLocalFileViaCordovaAsArrayBuffer:e.fetchLocalFileViaCordovaAsArrayBuffer=s,fetchLocalFileViaCordovaAsURL:o};e.default=a},"96388ee7a1bdcbdb":function(t,e,i){Object.defineProperty(e,"__esModule",{value:!0});var d=i("cf5a96997c0ef8c5"),u=i("c22a4085b35d8da3"),o=i("e818e5d68964a96b"),n=function(){function t(){this.needToRetry=!0,this.waitForLoadList=[],this.groupTotalDic={},this.numLoadedDic={},this.groupErrorDic={},this.groupCompleteDic={},this.groupsDic={},this.groupStatusDic={},this.resourceDic={},this.maxLoadLength=4,this.maxRetryTimes=4,this.retryTimesDic={},this.failedList=[],this.dispatcherDic={},this.reporterDic={},this.totalSize=0,this.loadingCount=0,this.completeSize=0,this.promiseHash={},this.loadItemErrorDic={},this.errorDic={},this.loadingList={},this.debug=-1<location.href.indexOf("showLoadinglist")}return t.prototype.handleResource=function(t,e){var i=this.formatResource(t,e);return this.waitForLoadList.push(i),!e?i.filepath+i.basename:e},t.prototype.loadResItem=function(t){var n=this;if("string"!=typeof t)throw new u.XfLoaderError(1001,t);var r=this.handleResource(t);if(this.promiseHash[r])return this.promiseHash[r];var e=new Promise(function(e,i){var t={complete:function(t){e(t)},error:function(t){i(t)}};n.dispatcherDic[r]=t});return this.promiseHash[r]=e,this.loadNextResource(),e},t.prototype.createGroup=function(r){var o=this;if(this.groupsDic[r])throw new u.XfLoaderError(1003,r);this.groupsDic[r]=[],this.groupStatusDic[r]=0;var s=[];return{id:r,getSource:function(){return d.uniqueArray(o.groupsDic[r])},push:function(t,e){var i=o.groupsDic[r],n=o.groupStatusDic[r];if(!i)return Promise.reject(r+"组不存在");if(1===n)return Promise.reject(r+"组在加载，不可继续添加");if("string"==typeof t)o.groupsDic[r].push(t);else if("[object Array]"===Object.prototype.toString.call(t))o.groupsDic[r]=o.groupsDic[r].concat(t);else throw new u.XfLoaderError(1001,t);e&&s.push(e)},startLoad:function(i){var t=o.groupsDic[r],e=o.groupStatusDic[r];if(!t)return Promise.reject(r+"组不存在");if(1===e)return Promise.reject(r+"组在加载，不可重复加载");if(0==t.length)return Promise.resolve({});o.groupStatusDic[r]=1;var n=d.uniqueArray(t);return new Promise(function(t,e){o.loadResGroup(n,r,i,!0).then(function(e){s.map(function(t){t(e)}),s.length=0,t(e)}).catch(function(t){return e(t)})})}}},t.prototype.loadResGroup=function(t,e,i,n){var r=this;if(void 0===n)n=!1;if(!e)throw new u.XfLoaderError(1002);if(!n&&this.groupsDic[e])throw new u.XfLoaderError(1003,e);if(n&&!this.groupsDic[e])throw new u.XfLoaderError(1005,e);this.groupsDic[e]=t,this.groupTotalDic[e]=t.length,this.numLoadedDic[e]=0;var o="";if(t.map(function(t){o=r.handleResource(t,e)}),o){if(this.promiseHash[o])return this.promiseHash[o];this.reporterDic[e]=i;var s=new Promise(function(e,i){var t={complete:function(t){e(t)},error:function(t){i(t)}};r.dispatcherDic[o]=t});return this.promiseHash[o]=s,this.loadNextResource(),s}},t.prototype.loadNextResource=function(){for(;this.loadingCount<this.maxLoadLength;){if(!this.loadSingleResource())break}},t.prototype.loadSingleResource=function(){var l=this,c=this.getOneResourceFromWaitDic();if(!c)return!1;else return this.loadingCount++,this.loadingList[c.url]=c.url,this.loadResource(c).then(function(t){var e;if(l.loadingCount--,l.loadingList[c.url]=null,l.debug)console.log(l.loadingList);if(u.host.save(c,t),l.promiseHash[c.filepath+c.basename]){l.deleteDispatcher(c.filepath+c.basename).complete(t)}var i=c.gid;if(i){delete c.gid;for(var n=0,r=i;n<r.length;n++){var o=r[n];if(!l.groupCompleteDic[o])l.groupCompleteDic[o]=[];if(l.groupCompleteDic[o].push(((e={})[c.url]=t,e)),l.setGroupProgress(o,c))l.loadGroupEnd(o)}}l.loadNextResource()}).catch(function(t){if(!t)console.warn(c.basename+" load fail");delete u.host.state[c.url];var e=l.retryTimesDic[c.filepath+c.basename]||1;if(e>l.maxRetryTimes){if(delete l.retryTimesDic[c.filepath+c.basename],l.promiseHash[c.filepath+c.basename]){(o=l.deleteDispatcher(c.filepath+c.basename)).error(t)}var i=c.gid;if(i){delete c.gid;for(var n=0,r=i;n<r.length;n++){var o,s=r[n];if(!l.loadItemErrorDic[s])l.loadItemErrorDic[s]=[];if(-1==l.loadItemErrorDic[s].indexOf(c))l.loadItemErrorDic[s].push(c);if(l.groupErrorDic[s]=!0,o=l.deleteDispatcher(s)){var a=l.loadItemErrorDic[s];delete l.loadItemErrorDic[s],o.error({itemList:a,error:t})}}return!1}}else l.retryTimesDic[c.filepath+c.basename]=e+1,l.failedList.push(c),l.loadingCount--,l.loadNextResource()}),!0},t.prototype.setGroupProgress=function(t,e){var i=this.reporterDic[t];this.numLoadedDic[t]++;var n=this.numLoadedDic[t],r=this.groupTotalDic[t];if(i&&i.onProgress)i.onProgress(r,n,e);return n==r},t.prototype.loadGroupEnd=function(t,e){if(delete this.groupTotalDic[t],delete this.numLoadedDic[t],delete this.reporterDic[t],"xfPreloadGroup"==t)this.groupsDic[t]=[],this.groupStatusDic[t]=0;else delete this.groupsDic[t],delete this.groupStatusDic[t];var i=this.groupCompleteDic[t];delete this.groupCompleteDic[t];var n=this.deleteDispatcher(t);if(!e){var r=this.groupErrorDic[t];if(delete this.groupErrorDic[t],r){var o=this.loadItemErrorDic[t];delete this.loadItemErrorDic[t];var s=this.errorDic[t];delete this.errorDic[t],n.error({itemList:o,error:s})}else{var a={};i.map(function(t){for(var e in t)a[e]=t[e]}),n.complete(a)}}else{delete this.groupErrorDic[t];o=this.loadItemErrorDic[t];delete this.loadItemErrorDic[t],n.error({itemList:o,lastError:e})}},t.prototype.deleteDispatcher=function(t){delete this.promiseHash[t];var e=this.dispatcherDic[t];return delete this.dispatcherDic[t],e},t.prototype.loadResource=function(t,e){if(!e){if(1==u.FEATURE_FLAG.FIX_DUPLICATE_LOAD){var i=u.host.state[t.url];if(2==i)return Promise.resolve(u.host.get(t));if(1==i){var n=this.resourceDic[t.filepath+t.basename];if(n&&n.promise)return this.resourceDic[t.filepath+t.basename].promise}}e=o.isSupport(t)}if(!e)throw new u.XfLoaderError(2001,t.basename,t.type);u.host.state[t.url]=1;var r=e.onLoadStart(t);return this.resourceDic[t.filepath+t.basename].promise=r},t.prototype.getOneResourceFromWaitDic=function(){if(0<this.failedList.length)return this.failedList.shift();else return this.waitForLoadList.shift()},t.prototype.formatResource=function(t,e){var i=t.split("?xf?"),n=i[0],r=i[1]?xf.parseQuery(i[1]):null,o=d.xfPath.basename(n),s=d.xfPath.filepath(n),a=d.xfPath.typeSelector(n),l=d.xfPath.prename(n),c=null;if(window.xfruntime&&window.xfruntime.manifest&&window.xfruntime.manifest[n])c=window.xfruntime.manifest[n];if(this.resourceDic[s+o]){var u=this.resourceDic[s+o];if(e)if(u.gid)u.gid.push(e);else u.gid=[e];return u}var h={url:n,type:a,prename:l,filepath:s,basename:o,param:r,md5Url:c};if(e)h.gid=[e];return this.resourceDic[s+o]=h},t.prototype.unloadResource=function(t){if(!u.host.get(t))return console.warn("尝试释放不存在的资源:",t.basename),!1;if(o.isSupport(t))return u.host.remove(t),delete this.resourceDic[t.filepath+t.basename],!0;else return!0},t}();e.XfLoader=n,window.xf.XfLoader=n},c22a4085b35d8da3:function(t,i,e){var n,s=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(i,"__esModule",{value:!0});var r={};i.host={state:{},save:function(t,e){i.host.state[t.url]=2,delete t.promise,r[t.url]=e},get:function(t){return r[t.url]},remove:function(t){delete i.host.state[t.url],delete r[t.url]},cache:function(){return r}},window.xfHost=i.host;var o=function(r){function o(t,e,i){var n=r.call(this)||this;return n.__resource_manager_error__=!0,n.name=t.toString(),n.message=o.errorMessage[t].replace("{0}",e).replace("{1}",i),n}return s(o,r),o.errorMessage={1001:"文件路径格式错误: {0}",1002:"无法获取到组id",1003:"{0}组已经存在，不可重复创建",1004:"{0}队列已经存在，不可重复创建",1005:"{0}组不存在，请先创建",2001:"{0}解析失败,不支持指定解析类型:'{1}'，请编写自定义 Processor",3001:"加载图片{0}失败：{1}"},o}(Error);i.XfLoaderError=o,i.FEATURE_FLAG={FIX_DUPLICATE_LOAD:1}},cf5a96997c0ef8c5:function(t,e,i){function n(t){var i=t.split("/");return i.filter(function(t,e){return!!t||e==i.length-1}).join("/")}function r(t){return t.substr(t.lastIndexOf("/")+1)}function o(t){return t.substr(0,t.lastIndexOf("/"))}function s(t){return r(t).split(".")[0]}function a(t){var e="";switch(t.substr(t.lastIndexOf(".")+1)){case"png":case"jpg":case"gif":case"jpeg":case"bmp":e="image";break;case"json":case"atlas":case"xml":e="http";break;case"mp3":case"ogg":case"mpeg":case"wav":case"m4a":case"mp4":case"aiff":case"wma":case"mid":e="sound";break;case"ttf":e="font";break;case"bin":case"zip":e="binary";break;default:e="http"}return e}var l;Object.defineProperty(e,"__esModule",{value:!0}),e.normalize=n,e.basename=r,e.filepath=o,e.prename=s,e.typeSelector=a,e.xfPath={normalize:n,basename:r,filepath:o,prename:s,typeSelector:a},e.isAbsoluteUrl=function(t){return/^(?:[a-z]+:)?\/\//.test(t)||"data:"===t.substr(0,5)||"blob:"===t.substr(0,5)},e.isWKWebView=function(){if(window.xfruntime)return window.xfruntime.isWKWebView;if(null==l){var t="cordova"===window.xfConfig.exportType,e=/edge\//i.test(navigator.userAgent),i=(/msie/i.test(navigator.userAgent)||/trident/i.test(navigator.userAgent)||/iemobile/i.test(navigator.userAgent))&&!e,n=(/iphone/i.test(navigator.userAgent)||/ipod/i.test(navigator.userAgent))&&!i&&!e,r=xf.isIpad();l=(n||r)&&t}return l},e.uniqueArray=function(t){for(var e=0;e<t.length;e++)for(var i=e+1;i<t.length;i++)if(t[e]==t[i])t.splice(i,1),i--;return t}},e818e5d68964a96b:function(t,e,i){var n=this&&this.__awaiter||function(o,s,a,l){return new(a||(a=Promise))(function(t,e){function i(t){try{r(l.next(t))}catch(t){e(t)}}function n(t){try{r(l.throw(t))}catch(t){e(t)}}function r(e){e.done?t(e.value):new a(function(t){t(e.value)}).then(i,n)}r((l=l.apply(o,s||[])).next())})},h=this&&this.__generator||function(i,n){var r,o,s,t,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;if(o=0,s)e=[2&e[0],s.value];switch(e[0]){case 0:case 1:s=e;break;case 4:return a.label++,{value:e[1],done:!1};case 5:a.label++,o=e[1],e=[0];continue;case 7:e=a.ops.pop(),a.trys.pop();continue;default:if(!(s=0<(s=a.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){a=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){a.label=e[1];break}if(6===e[0]&&a.label<s[1]){a.label=s[1],s=e;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(e);break}if(s[2])a.ops.pop();a.trys.pop();continue}e=n.call(i,a)}catch(t){e=[6,t],o=0}finally{r=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}};Object.defineProperty(e,"__esModule",{value:!0});var d=i("cf5a96997c0ef8c5"),o=i("c22a4085b35d8da3"),p=i("930e8b72a07f25ce"),s=i("fb2954a1e19de01d"),f=i("58efb290eccd0b6d");e.ImageProcessor={onLoadStart:function(r){return new Promise(function(t,e){var i,n=r.md5Url||r.url;if("weChat"===xfConfig.platform)i=wx.createImage(),wx.downloadFile({url:n,success:function(t){i.src=t.tempFilePath},fail:function(){e(r)}});else if((i=new Image).crossOrigin="anonymous",!d.isAbsoluteUrl(n)&&d.isWKWebView())p.default.fetchLocalFileViaCordovaAsURL(n).then(function(t){i.src=t}).catch(function(t){throw new o.XfLoaderError(3001,r.basename,t)});else i.src=n;i.onload=function(){t(i)},i.onerror=function(){e(r)}})}},e.SoundProcessor={onLoadStart:function(u){var t=this;return new Promise(function(l,c){return n(t,void 0,void 0,function(){var e,i,n,r,o,s,a;return h(this,function(t){switch(t.label){case 0:if(e=u.md5Url||u.url,"weChat"===xfConfig.platform)return wx.downloadFile({url:e,success:function(t){l(t.tempFilePath)},fail:function(){c(u)}}),[2];if(i=u.param,n="api_webaudio",i&&"api_html5"==i.api||"undefined"==typeof AudioContext&&"undefined"==typeof webkitAudioContext)n="api_html5";if("api_webaudio"!=n)return[3,7];if(d.isAbsoluteUrl(e)||!d.isWKWebView())return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,p.default.fetchLocalFileViaCordovaAsArrayBuffer(e)];case 2:if(r=t.sent(),i&&"stream"==i.type)l(r);else o=new f.default(r),l(o);return[3,4];case 3:return s=t.sent(),c(s),[3,4];case 4:return[3,6];case 5:window.axios.create({responseType:"arraybuffer"})({method:"GET",url:e}).then(function(t){if(i&&"stream"==i.type)l(t.data);else{var e=new f.default(t.data);l(e)}}).catch(function(t){c(t)}),t.label=6;case 6:return[3,8];case 7:if((a=new Audio).crossOrigin="anonymous",a.muted=!0,a.preload="auto",a.src=e,window.xfruntime.isiOS)a.play();a.oncanplay=function(){l(a)},a.onerror=function(t){c(t)},t.label=8;case 8:return[2]}})})})}},e.HttpProcessor={onLoadStart:function(r){return new Promise(function(e,i){var t=r.md5Url||r.url;if(!d.isAbsoluteUrl(t)&&d.isWKWebView()){var n=r.basename;if(-1<t.indexOf("assets/spine"))n=t;p.default.fetchLocalFileViaCordovaAsText(n).then(function(t){if("string"==typeof t&&-1==r.basename.indexOf(".atlas"))t=JSON.parse(t);e(t)}).catch(function(t){i(t)})}else if("minigame"==xfConfig.exportType&&-1==t.indexOf("http"))s.default.fetchLocalFileViaMiniGameAsText(t).then(function(t){if("string"==typeof t&&-1==r.basename.indexOf(".atlas"))t=JSON.parse(t);e(t)}).catch(function(t){i(t)});else{window.axios.create({timeout:1e4})({method:"GET",url:t}).then(function(t){e(t.data)}).catch(function(t){i(t)})}})}},e.FontProcessor={onLoadStart:function(a){return n(this,void 0,void 0,function(){var e,i,n,r;return h(this,function(t){if(e=a.md5Url||a.url,"undefined"!=typeof wx||"undefined"!=typeof bl||"undefined"!=typeof tt)return[2,Promise.resolve("小游戏暂不支持加载字体")];if(i=window.FontFace)return n=document.fonts,r=new i(a.prename,"url("+e+")"),n.add(r),[2,r.load()];else return[2,new Promise(function(i,n){var r=function t(e){s.removeEventListener("load",t),s.removeEventListener("error",o),i(e)},o=function t(e){s.removeEventListener("load",r),s.removeEventListener("error",t),n(e)},t='@font-face {\n                    font-family: "'+a.prename+'";\n                    src: url("'+e+'") format("truetype")\n                }',s=document.createElement("style");s.innerHTML=t,s.addEventListener("load",r),s.addEventListener("error",o),document.head.appendChild(s)})]})})}},e.BinaryProcessor={onLoadStart:function(e){return n(this,void 0,void 0,function(){var n;return h(this,function(t){return n=e.md5Url||e.url,[2,new Promise(function(e,i){window.axios.create({timeout:1e4})({method:"GET",url:n,responseType:"arraybuffer"}).then(function(t){e(t.data)}).catch(function(t){i(t)})})]})})}},e.isSupport=function(t){return e.processorMap[t.type]},e.processorMap={image:e.ImageProcessor,sound:e.SoundProcessor,http:e.HttpProcessor,font:e.FontProcessor,binary:e.BinaryProcessor}},fb2954a1e19de01d:function(t,e,i){Object.defineProperty(e,"__esModule",{value:!0});var n={fetchLocalFileViaMiniGameAsText:function(n){return new Promise(function(e,i){var t;if("weChat"==xfConfig.platform)t=wx.getFileSystemManager();else if("byteDance"==xfConfig.platform)t=tt.getFileSystemManager();else if("bilibili"==xfConfig.platform)t=bl.getFileSystemManager();t.readFile({filePath:n,encoding:"utf-8",success:function(t){e(t.data)},error:function(t){i(t)}})})}};e.default=n}}),function(i){var n={};function r(t){if(n[t])return n[t].exports;var e=n[t]={i:t,l:!1,exports:{}};return i[t].call(e.exports,e,e.exports,r),e.l=!0,e.exports}r.m=i,r.c=n,r.d=function(t,e,i){if(!r.o(t,e))Object.defineProperty(t,e,{enumerable:!0,get:i})},r.r=function(t){if("undefined"!=typeof Symbol&&Symbol.toStringTag)Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(e,t){if(1&t)e=r(e);if(8&t)return e;if(4&t&&"object"===_typeof(e)&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(i,n,function(t){return e[t]}.bind(null,n));return i},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s="31bc727c5ad94639")}({"081ce22713c044b3":function(t,e,i){Object.defineProperty(e,"__esModule",{value:!0}),e.urlCodeMap={"v1/player/game-initialize":0,"v2/player/game-login":1,"v1/player/order":2,"v1/player/game-data/list":3,"v1/player/game-data/load":4,"v1/player/game-data/save":5,"v1/player/mail":6,"v1/player/order/":7,"v1/player/account":8,"v1/player/purchased-resources/info":9,"v1/player/game-notice":10,"v1/player/game-notice/detail":11,"v1/player/game-activity":12,"v1/player/game-share/info":13,"v1/player/game-share/list":14,"v1/player/h5-config":15,"character/v1/character":101,"character/v1/character/":102,"logic/v1/plugin/result":103,"goods/sync":104,"goods/buy":105},e.errorcodeMap={6001:{code:"GAME_INFO_NULL",message:"%s游戏信息不存在"},6002:{code:"GAME_VERSION_INFO_NULL",message:"游戏版本信息不存在"},6003:{code:"GAME_USER_NOT_MATCH",message:"游戏创建者与当前登录用户不匹配"},6004:{code:"GAME_CONDITION_ERROR",message:"Condition表达式错误"},6005:{code:"GAME_SHARE_ACTION_EXISTS",message:"该分享动作已存在"},6006:{code:"GAME_SHARE_ACTION_NAME_EXISTS",message:"分享动作名称已存在"},6007:{code:"GAME_IS_AGENCY",message:"游戏已申请独家代理"},6008:{code:"GAME_IS_FROZEN",message:"游戏已被封停"},6009:{code:"GAME_IS_NOT_ONLINE_GAME",message:"该游戏不是联机游戏"},6011:{code:"GAME_IS_NOT_PC_GAME",message:"该游戏不是单机游戏"},6012:{code:"GAME_EXP_PLAYER_FULL",message:"游戏体验人数已达上限"},6013:{code:"GAME_PLAYER_FULL",message:"游戏人数已达上限"},6014:{code:"GAME_CREATE_USER_ERROR",message:"游戏创建者信息错误"},6015:{code:"GAME_SECRET_LOGIN_ERROR",message:"私密游戏登录失败"},7016:{code:"GAME_INFO_EXISTS",message:"该工程已有对应作品存在"},7017:{code:"PROJECT_INFO_EXISTS",message:"该作品已有工程ID"},7018:{code:"GAME_GLOBAL_VARIABLE_VERSION_EXISTS",message:"该版本全局变量已发布正式版本"},9004:{code:"NOT_LOGIN",message:"用户未登录"},9005:{code:"INVALID_TOKEN",message:"登录过期"},9006:{code:"ERR_TOKEN",message:"服务器验证token失败"},9007:{code:"TOKEN_ERROR",message:"token有误"},9008:{code:"TEMPLATE_TAG__NOT_EXIST",message:"模板标签不存在"},9011:{code:"USER_NOT_LOGIN_AUTHORITY",message:"无登录权限"},9012:{code:"USER_NOT_MENU_AUTHORITY",message:"没有菜单权限"},1999:{code:"NAME_EXIST",message:"名称已存在"},9013:{code:"GAME_STATUS_CHANGE",message:"游戏状态发生变化"},9014:{code:"PLAYER_STATUS_CHANGE",message:"玩家状态发生变化"},9015:{code:"NOT_SUPPORT_REQUEST_METHOD",message:"请求方式不支持"},9016:{code:"INVALID_FINGERPRINT",message:"指纹无效"},9017:{code:"NOT_FOUND_GOODS",message:"找到不到该内购商品"},9018:{code:"INVALID_EXCHANGE_TYPE",message:"价格档位无效"},9019:{code:"INVALID_GOODS_TYPE",message:"商品类型无效"},9020:{code:"GAME_CURRENCY_EXIST",message:"该游戏已定义货币"},9021:{code:"INVALID_EXCHANGE_RATE",message:"兑换比例无效"},9022:{code:"INVALID_DICT_VALUE",message:"商品类型无效"},9023:{code:"GAME_GOODS_EXIST",message:"该商品已添加过"},9024:{code:"DATA_NOT_EXIST",message:"数据不存在"},9025:{code:"USER_GAME_PLAYER_MISMATCH",message:"用户ID、游戏ID或玩家ID都不能为空"},9026:{code:"PLAYER_INFO_NULL",message:"玩家不存在"},9027:{code:"DATA_MISMATCH_NO_AUTH",message:"抱歉，数据不匹配，不允许操作"},9028:{code:"GAME_ID_OR_PLAYER_ID_NULL",message:"玩家ID或游戏ID不能为空"},9029:{code:"DELETE_DRAMA_ID_ERROR",message:"删除抓马沙盒账号异常"},9030:{code:"CREATE_DRAMA_ID_ERROR",message:"创建抓马沙盒账号异常"},9031:{code:"GAME_NAME_REPEAT",message:"游戏名称已重复，请修改游戏名称"},9032:{code:"GAME_NAME_EXIST",message:"游戏名已存在"},9033:{code:"DELETE_FILE_ERROR",message:"删除临时文件异常"},9034:{code:"GAME_VERSION_ERROR",message:"游戏版本号要大于当前的"},9035:{code:"NO_NEED_RESEND",message:"该商品类型不需要补发货"},9036:{code:"ERROR_OP_TYPE",message:"操作类型错误"},9037:{code:"NO_FOUND_GAME_NOTICE",message:"找到不到游戏公告"},9038:{code:"TIME_OUT_OF_RANGE",message:"时间范围超出3个月"},9039:{code:"GAME_GOODS_PRICE_NOT_MATCH",message:"商品价格不匹配，请重新登录再试"},9040:{code:"GOODS_TYPE_NOT_SUPPORT",message:"不支持消耗型商品购买"},9041:{code:"AMOUNT_GREATER_THAN_ZERO",message:"金额要大于0"},9042:{code:"OP_NOT_SUPPORT",message:"操作不支持"},9043:{code:"TOKEN_INVALID_OR_NO_AUTH",message:"凭证无效或权限不够"},9044:{code:"NOT_CREATE_ROLE",message:"没有创建角色"},9045:{code:"DATA_STATUS_UPDATE_NOT_ALLOWED",message:"数据状态不允许变更"},9046:{code:"END_TIME_IS_EXPIRED",message:"结束时间已无效，请先编辑"},9047:{code:"RECEIVER_IS_NULL",message:"请填写指定接收人"},9048:{code:"SEND_TIME_IS_NULL",message:"请填写指定发送时间"},9049:{code:"AUTH_NAME_EXIST",message:"授权名称已存在"},9050:{code:"GAME_NOT_EXIST",message:"游戏不存在"},9051:{code:"GAME_VERSION_EXIST",message:"该平台对应的游戏版本号已经存在"},9052:{code:"GAME_VERSION_FORMAT_ERROR",message:"游戏版本号格式错误"},9053:{code:"GAME_IS_DELETED",message:"游戏已被删除"},71001:{code:"CHARACTER_NAME_EXIST",message:"角色名已存在"}}},"0d29f351d650372a":function(t,e,i){Object.defineProperty(e,"__esModule",{value:!0});var r=i("4f5d0dbbc4df297a"),o=i("3ef79e4e773762de"),s=xfConfig.serverURL,n=function(){function t(){}return t.getCharacterList=function(t){var e=o.getSignedData({uid:t.uid,gid:t.gid,timestamp:o.getTimestamp(),random:o.getRandom()});return r.gameServer.get(s+"/character/v1/character",{params:e})},t.getCharacterInfo=function(t){var e=t.cid,i=o.getSignedData({gid:t.gid,timestamp:o.getTimestamp(),random:o.getRandom(),cid:e});return r.gameServer.get(s+"/character/v1/character/"+e,{params:i})},t.createCharacter=function(t){var e=s+"/character/v1/character",i=o.getSignedData({uid:t.uid,gid:t.gid,cname:t.cname,timestamp:o.getTimestamp(),random:o.getRandom()});return r.gameServer({method:"POST",url:e,data:i})},t.updateCharacter=function(t){if(!t.cid)throw new Error("【更新游戏角色失败】：当前账号没有获取到角色信息，请先创建角色后才能修改.");var e=s+"/character/v1/character/"+t.cid,i={cid:t.cid,gid:t.gid,cname:t.cname,timestamp:o.getTimestamp(),random:o.getRandom(),gver:t.gver};if(t.glov)i.glov=JSON.stringify(t.glov);var n=o.getSignedData(i);return n.glov=t.glov,r.gameServer({method:"PUT",url:e,data:n})},t.getRankInfo=function(t){var e=s+"/logic/v1/plugin/result/"+t.instanceId;return r.gameServer.get(e,{params:o.getSignedData({gameVersion:t.gameVersion,gameId:t.gameId,timestamp:o.getTimestamp(),random:o.getRandom(),instanceId:t.instanceId})})},t.getCloudSaveData=function(){return r.gameServer.get(s+"/logic/v1/clouddb/storage")},t.syncCloudSaveData=function(t){var e=s+"/logic/v1/clouddb/operations";return r.gameServer.put(e,t,{headers:{"Content-Type":"application/snappy"}})},t.getCloundSaveStatus=function(){return r.gameServer.get(s+"/logic/v1/clouddb/stats")},t.syncCharacterGoods=function(e){if(e)xf.gameInfo.goodsList=e;else{var t=localStorage.getItem("xf_character_goods"+xf.gameInfo.characterId);e=t?JSON.parse(t):xf.gameInfo.goodsList}localStorage.setItem("xf_character_goods"+xf.gameInfo.characterId,JSON.stringify(e));var i=s+"/character/v1/character/"+xf.gameInfo.characterId+"/goods/sync",n=o.getSignedData({cid:xf.gameInfo.characterId,gid:xf.gameInfo.gameId,timestamp:o.getTimestamp(),random:o.getRandom(),goods:e});return r.gameServer({url:i,method:"POST",data:n}).then(function(t){xf.gameInfo.goodsList=t.goods,localStorage.setItem("xf_character_goods"+xf.gameInfo.characterId,JSON.stringify(e))})},t.buyGoods=function(t){var e=s+"/character/v1/character/"+t.cid+"/goods/buy",i=o.getSignedData({cid:t.cid,gid:t.gid,goods_id:t.goods_id,buy_num:t.buy_num,uid:t.uid,request_id:t.request_id,timestamp:o.getTimestamp(),random:o.getRandom()});return r.gameServer({url:e,method:"POST",data:i})},t}();e.serverApi=n,e.default=n},"31bc727c5ad94639":function(t,e,i){Object.defineProperty(e,"__esModule",{value:!0});var n=i("0d29f351d650372a");e.serverApi=n.default;var r=i("7ec4778ef9e4f6b3");e.localApi=r.default;var o=i("8046905752873b0b");e.webApi=o.default,xf.serverApi=n.default,xf.localApi=r.default,xf.webApi=o.default},"3ef79e4e773762de":function(t,e,i){Object.defineProperty(e,"__esModule",{value:!0}),e.getRandom=function(){return 1e4*Math.random()<<0},e.getTimestamp=function(){return.001*Date.now()<<0},e.getSignedData=function(i){var t=Object.keys(i).sort(),n={};t.forEach(function(t){var e=i[t];if("object"===_typeof(e))e=JSON.stringify(e);n[t]=e});var e=xf.stringify(n);return e=e+"&"+xf.gameInfo.secretKey,i.sign=md5(e).toLowerCase(),i},e.getSignedDataByXfConfig=function(i,t){var e=Object.keys(i).sort(),n={};e.forEach(function(t){var e=i[t];if("object"===_typeof(e))e=JSON.stringify(e);n[t]=e});var r=xf.stringify(n);return r=r+"&"+(t||xfConfig.appKey),i.sign=md5(r).toLowerCase(),i},e.getSignedDataStr=function(t){var e=xf.stringify(t),i=e+xf.gameInfo.secretKey;return e+="sign="+md5(i).toLowerCase()},e.logout=function(t){if(void 0===t)t="登录过期，请重新登陆";var e=function(){if(window.cordova)cordova.plugins.SeiyaSdk.logout();else if(window.xsSdk)window.xsSdk.logout();window.location.reload()};if(window.xfruntime)xf.MessageBox.alert(t,{callback:e});else xf.XfLoginCanvas.showAlert(t,{cancelCallback:e,showConfirmButton:!1,cancelButtonText:"重试"})}},"407b4704136fd4d1":function(t,e,i){var n,r;Object.defineProperty(e,"__esModule",{value:!0}),(n=e.PayType||(e.PayType={}))[n.AliPay=1]="AliPay",n[n.WXPay=2]="WXPay",n[n.ApplePay=3]="ApplePay",n[n.Sandbox=4]="Sandbox",(r=e.Platform||(e.Platform={}))[r.Android=1]="Android",r[r.iOS=2]="iOS",r[r.OSX=4]="OSX",r[r.Browser=8]="Browser",r[r.microApp=16]="microApp",r[r.Windows=32]="Windows"},"4f5d0dbbc4df297a":function(t,e,i){Object.defineProperty(e,"__esModule",{value:!0});var l=i("3ef79e4e773762de"),n=i("407b4704136fd4d1"),r=i("081ce22713c044b3"),c=axios.create({timeout:1e4});(e.webServer=c).interceptors.request.use(function(t){if(t.data)if(!t.data.json){var e=new URLSearchParams;for(var i in t.data)if(t.data.hasOwnProperty(i))e.append(i,t.data[i]);t.data=e}else delete t.data.json;return t},function(t){return Promise.reject(t)});c.interceptors.response.use(function(t){var e=t.data;if(1==e.status)return e.data;else if(9005==e.status)l.logout();else{switch(e.errInfo.code+""){case"9053":case"10013":location.href=window.xfConfig.gameNotFound}throw window.Sentry.captureMessage({request:JSON.stringify(t.config),response:JSON.stringify(t.data)}),new Error(JSON.stringify(e))}},function(t){var e=t&&t.config&&t.config.url;if(e){var i=t.config,n=i.headers.pf;if(-1<e.indexOf("/v1/player/game-initialize"))if(4==n&&"post"==i.method.toLowerCase()){var r,o=i.data;if("string"==typeof o)o=xf.parseQuery(i.data);r=l.getSignedData({gameId:o&&o.gameId,timestamp:l.getTimestamp(),random:l.getRandom()}),t.config.data=r}else if("get"==i.method.toLowerCase()){var s={};if("string"==typeof(a=i.params))a=xf.parseQuery(i.params);s=l.getSignedData({gameId:a.gameId,timestamp:l.getTimestamp(),random:l.getRandom(),platform:a.platform,fingerprint:a.fingerprint,gameVersion:a.gameVersion}),t.config.params=s}else return Promise.reject(t);if(-1<e.indexOf("/v2/player/game-login"))if("get"==i.method.toLowerCase()){var a;s={};if("string"==typeof(a=i.params))a=xf.parseQuery(i.params);s=l.getSignedData({playerId:a.playerId,token:a.token,gameId:a.gameId,platform:a.platform,deviceId:a.deviceId,timestamp:l.getTimestamp(),random:l.getRandom(),gameVersion:a.gameVersion}),t.config.params=s}else return Promise.reject(t);return function(t,e){var i=t.config;if(!i)return window.isSeiyaSdkLogining=!1,Promise.reject(t);if(i.__retryCount=i.__retryCount||0,4<=i.__retryCount)return Promise.reject(t);else return i.__retryCount+=1,new Promise(function(t){setTimeout(function(){t()},2e3*i.__retryCount||1)}).then(function(){return e(i)})}(t,c)}else console.log(t)});var o=axios.create({timeout:5e3});(e.gameServer=o).interceptors.request.use(function(t){return t.headers={"Content-Type":"application/json","Dr-Device-Id":xf.gameInfo.deviceId,"Dr-Player-Id":xf.gameInfo.playerId,"Dr-Character-Id":xf.gameInfo.characterId,"Dr-Game-Id":xf.gameInfo.gameId,"Dr-Game-Version":xf.gameInfo.version,"Dr-Token":xf.gameInfo.token,"Dr-Platform":n.Platform[xf.gameInfo.platform]},t},function(t){return Promise.reject(t)});o.interceptors.response.use(function(t){var e=t.data;if(1==e.status)return e.data;else{var i=new Error(JSON.stringify(e));if(i.status=e.status,i.info=e.info,10==e.status)throw l.logout(),i;var n=function(t){var e=-1;for(var i in r.urlCodeMap)if(-1<t.indexOf(i))e=r.urlCodeMap[i];return e}(t.config.url);if(-1===[71001,71103].indexOf(e.status))if(window.xfruntime)if(9005===e.status||9006===e.status||9007===e.status)l.logout(r.errorcodeMap[e.status+""].message);else xf.MessageBox.alert("错误："+e.info+"["+e.status+"]["+n+"]");else xf.XfLoginCanvas.showAlert("错误："+e.info+"["+e.status+"]["+n+"]",{cancelCallback:function(){xf.EvkLogin.start(xf.EvkLogin.startGame)},showConfirmButton:!1});throw window.Sentry.captureMessage({request:JSON.stringify(t.config),response:JSON.stringify(t.data)}),i}},function(t){return window.isSeiyaSdkLogining=!1,Promise.reject(t)})},"7ec4778ef9e4f6b3":function(t,e,i){var r=this&&this.__awaiter||function(o,s,a,l){return new(a||(a=Promise))(function(t,e){function i(t){try{r(l.next(t))}catch(t){e(t)}}function n(t){try{r(l.throw(t))}catch(t){e(t)}}function r(e){e.done?t(e.value):new a(function(t){t(e.value)}).then(i,n)}r((l=l.apply(o,s||[])).next())})},o=this&&this.__generator||function(i,n){var r,o,s,t,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;if(o=0,s)e=[2&e[0],s.value];switch(e[0]){case 0:case 1:s=e;break;case 4:return a.label++,{value:e[1],done:!1};case 5:a.label++,o=e[1],e=[0];continue;case 7:e=a.ops.pop(),a.trys.pop();continue;default:if(!(s=0<(s=a.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){a=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){a.label=e[1];break}if(6===e[0]&&a.label<s[1]){a.label=s[1],s=e;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(e);break}if(s[2])a.ops.pop();a.trys.pop();continue}e=n.call(i,a)}catch(t){e=[6,t],o=0}finally{r=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}};Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function n(){}return n.init=function(){return r(this,void 0,void 0,function(){return o(this,function(t){return[2,new Promise(function(e,i){Promise.all([n.getAppInfo(),n.getAppVersion(),n.getDeviceID(),n.getSHA1Sign()]).then(function(t){if(!(t[0]&&t[0].appId&&t[0].appKey&&t[0].devid&&t[1]&&t[2]&&t[3]))throw new Error("\n                    获取没有游戏信息不全\n                    appId: "+t[0].appId+"\n                    appKey: "+t[0].appKey+"\n                    devid: "+t[0].devid+"\n                    version: "+t[1]+"\n                    deviceID: "+t[2]+"\n                    fingerprint: "+t[3]+"\n                ");else e({appId:t[0].appId,projectId:t[0].projectId,secretKey:t[0].appKey,devId:t[0].devid,version:t[1],deviceId:t[2],fingerprint:t[3]})}).catch(function(t){i(t)})})]})})},n.getAppInfo=function(){return new Promise(function(e,i){try{var t=window.cordova,n=window.xfConfig;if(t)t.plugins.DramaApplication.getAppInfo(function(t){e({appId:t.appid,appKey:t.appkey,devid:t.devid,projectId:t.projectid||n.projectId})},function(t){i(t)});else e(n)}catch(t){i(t)}})},n.getAppVersion=function(){var xfConfig=window.xfConfig;if(!xfConfig.version)return Promise.reject("没有获取到游戏版本");else return Promise.resolve(xfConfig.version)},n.getDeviceID=function(){return new Promise(function(e,t){try{var i=window.cordova;if(i)i.plugins.DramaApplication.getDeviceID(function(t){e(t||"cordova")},function(t){console.log(t),e("cordova")});else e("h5")}catch(t){}})},n.getChannelId=function(){return r(this,void 0,void 0,function(){var e,xfConfig;return o(this,function(t){switch(t.label){case 0:if(e="",xfConfig=window.xfConfig,!window.cordova)return[3,2];else return[4,n.cordovaGetChannelId()];case 1:return e=t.sent(),[3,3];case 2:if(window.eagleSDK)e=window.eagleSDK.getAllChannels().channelId;else if(window.xsSdk)e=window.xsSdk.getAllChannels().channelId;t.label=3;case 3:if(!e&&"preview"!=xfConfig.exportType)throw new Error("没有获取到channleId");else return[2,Promise.resolve(e)]}})})},n.cordovaGetChannelId=function(){return new Promise(function(e,t){window.cordova.plugins.SeiyaSdk.getChannelId(function(t){if(!t)throw new Error("没有获取到channleId");else e(t)},function(t){throw new Error(t)})})},n.getSHA1Sign=function(){if(window.cordova)return Promise.resolve("C7:59:3F:C0:98:E0:5F:C1:86:C5:48:B3:A8:0C:ED:D8:09:8B:D3:5C");else return Promise.resolve("h5")},n.getPreviewInfo=function(){var t=xf.parseQuery();if(!t.token)t=xf.parseQuery(window.localStorage.getItem("xf_debugger_search"));return{appId:t.gameId,projectId:t.projectId,devId:t.id,version:t.gameVersion,editorVersion:t.editorVersion,deviceId:"h5",gameType:t.gameType,channelId:"xingfei",secretKey:t.gameKey,login:void 0!==t.login?t.login:t.gameId?1:0,token:decodeURIComponent(t.token)}},n}();e.localApi=n,e.default=n},"8046905752873b0b":function(t,e,i){var n=this&&this.__assign||function(){return(n=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var r in e=arguments[i])if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r];return t}).apply(this,arguments)},o=this&&this.__awaiter||function(o,s,a,l){return new(a||(a=Promise))(function(t,e){function i(t){try{r(l.next(t))}catch(t){e(t)}}function n(t){try{r(l.throw(t))}catch(t){e(t)}}function r(e){e.done?t(e.value):new a(function(t){t(e.value)}).then(i,n)}r((l=l.apply(o,s||[])).next())})},s=this&&this.__generator||function(i,n){var r,o,s,t,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;if(o=0,s)e=[2&e[0],s.value];switch(e[0]){case 0:case 1:s=e;break;case 4:return a.label++,{value:e[1],done:!1};case 5:a.label++,o=e[1],e=[0];continue;case 7:e=a.ops.pop(),a.trys.pop();continue;default:if(!(s=0<(s=a.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){a=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){a.label=e[1];break}if(6===e[0]&&a.label<s[1]){a.label=s[1],s=e;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(e);break}if(s[2])a.ops.pop();a.trys.pop();continue}e=n.call(i,a)}catch(t){e=[6,t],o=0}finally{r=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}};Object.defineProperty(e,"__esModule",{value:!0});var a=i("4f5d0dbbc4df297a"),l=i("3ef79e4e773762de"),c=i("407b4704136fd4d1"),u=xfConfig.baseURL,r=function(){function t(){}return t.previewLogin=function(t){xf.gameInfo.gameExportType=xf.gameExportType.Preview;var e=l.getSignedData({gameId:t.gameId,timestamp:l.getTimestamp(),random:l.getRandom()});return a.webServer({url:u+"/v1/player/game-initialize",method:"post",data:e,headers:{userId:t.userId,token:t.token,pf:4,version:t.editorVersion}})},t.initGame=function(r){var t=this;return xf.gameInfo.gameExportType=xf.gameExportType.Game,new Promise(function(i,n){return o(t,void 0,void 0,function(){var e;return s(this,function(t){try{e=l.getSignedData({gameId:r.gameId,timestamp:l.getTimestamp(),random:l.getRandom(),platform:c.Platform[r.platform],fingerprint:r.fingerprint,gameVersion:r.version}),a.webServer.get(u+"/v1/player/game-initialize",{params:e}).then(function(t){if(xf.gameInfo.isCommercialized=t.data.flag,0===t.data.status)location.href=window.xfConfig.gameNotFound;else i(t.data)},function(t){n(t)})}catch(t){n(t)}return[2]})})})},t.loginCheck=function(t){var e=u+"/v2/player/game-login";return a.webServer.get(e,{params:l.getSignedData({playerId:t.userID,token:t.token,gameId:t.gameId,platform:c.Platform[t.platform],deviceId:t.deviceId,timestamp:l.getTimestamp(),random:l.getRandom(),gameVersion:t.gameVersion})})},t.refreshToken=function(t){var e=u+"/v2/player/game-login/refresh",i=l.getSignedData({playerId:t.userID,token:t.token,gameId:t.gameId,platform:c.Platform[t.platform],deviceId:t.deviceId,timestamp:l.getTimestamp(),random:l.getRandom(),gameVersion:t.gameVersion});return a.webServer.put(e,i)},t.queryArchive=function(){var t=u+"/v1/player/game-data/list";return new Promise(function(e,i){a.webServer({url:t,method:"get",params:l.getSignedData({playerId:xf.gameInfo.playerId,token:xf.gameInfo.token,gameId:xf.gameInfo.gameId,timestamp:l.getTimestamp(),random:l.getRandom(),gameVersion:xf.gameInfo.version,platform:c.Platform[xf.gameInfo.platform]})}).then(function(t){if(t&&t.gameData)e(t.gameData);i("服务器返回数据不正确")}).catch(function(t){i(t)})})},t.loadArchive=function(t){var e=u+"/v1/player/game-data/load";return a.webServer.get(e,{params:l.getSignedData({slot:t.slot,playerId:xf.gameInfo.playerId,token:xf.gameInfo.token,gameId:xf.gameInfo.gameId,timestamp:l.getTimestamp(),random:l.getRandom(),gameVersion:t.gameVersion,platform:c.Platform[xf.gameInfo.platform]})})},t.saveArchive=function(t){var r=u+"/v1/player/game-data/save",o=xf.sizeOfUTF8Str(t.data)/1024<<0;if(console.log("请求"+t.slot),o<200)return new Promise(function(e,i){var n=l.getSignedData({slot:t.slot,gameStatus:xf.gameInfo.isTest?0:1,isSandbox:xf.gameInfo.isSandbox?1:0,gameVersion:xf.gameInfo.version,md5Code:t.md5Code,dataSize:o,playerId:xf.gameInfo.playerId,dataTimestamp:l.getTimestamp(),token:xf.gameInfo.token,gameId:xf.gameInfo.gameId,timestamp:l.getTimestamp(),random:l.getRandom(),platform:c.Platform[xf.gameInfo.platform]});n.data=t.data,a.webServer.post(r,n).then(function(t){if(t)e(n);else i("没有返回")}).catch(function(t){i(t)})});else return Promise.reject("存档太大了")},t.queryMail=function(){var t=u+"/v1/player/mail";return a.webServer.get(t,{params:l.getSignedData({playerId:xf.gameInfo.playerId,token:xf.gameInfo.token,gameId:xf.gameInfo.gameId,timestamp:l.getTimestamp(),random:l.getRandom(),gameVersion:xf.gameInfo.version,platform:c.Platform[xf.gameInfo.platform]})})},t.queryOrder=function(t){var e=u+"/v1/player/order/"+t;return a.webServer.get(e,{params:l.getSignedData({playerId:xf.gameInfo.playerId,token:xf.gameInfo.token,gameId:xf.gameInfo.gameId,timestamp:l.getTimestamp(),random:l.getRandom()})})},t.queryAccount=function(){var t=u+"/v1/player/account";return a.webServer.get(t,{params:l.getSignedData({playerId:xf.gameInfo.playerId,token:xf.gameInfo.token,gameId:xf.gameInfo.gameId,timestamp:l.getTimestamp(),random:l.getRandom(),gameVersion:xf.gameInfo.version,platform:c.Platform[xf.gameInfo.platform]})})},t.queryBulletinList=function(){var t=u+"/v1/player/game-notice";return a.webServer.get(t,{params:l.getSignedData({playerId:xf.gameInfo.playerId,token:xf.gameInfo.token,gameId:xf.gameInfo.gameId,platform:c.Platform[xf.gameInfo.platform],timestamp:l.getTimestamp(),random:l.getRandom(),gameVersion:xf.gameInfo.version})})},t.queryBulletin=function(t){var e=u+"/v1/player/game-notice/detail";return a.webServer.get(e,{params:l.getSignedData({playerId:xf.gameInfo.playerId,token:xf.gameInfo.token,gameId:xf.gameInfo.gameId,platform:c.Platform[xf.gameInfo.platform],timestamp:l.getTimestamp(),random:l.getRandom(),gameVersion:xf.gameInfo.version,id:t})})},t.queryActivity=function(){var t=u+"/v1/player/game-activity";return a.webServer.get(t,{params:l.getSignedData({playerId:xf.gameInfo.playerId,token:xf.gameInfo.token,gameId:xf.gameInfo.gameId,platform:c.Platform[xf.gameInfo.platform],timestamp:l.getTimestamp(),random:l.getRandom()})})},t.getShareInfo=function(t){return new Promise(function(e,i){a.webServer.get(u+"/v1/player/game-share/info",{params:l.getSignedData({gameId:xf.gameInfo.gameId,id:t,random:l.getRandom(),timestamp:l.getTimestamp()})}).then(function(t){e(t)}).catch(function(t){i(t)})})},t.getAllShareInfo=function(t,n){return new Promise(function(e,i){a.webServer.get(u+"/v1/player/game-share/list",{params:l.getSignedDataByXfConfig({gameId:!t?xfConfig.appId:t,random:l.getRandom(),timestamp:l.getTimestamp()},n)}).then(function(t){e(t)}).catch(function(t){i(t)})})},t.getPcWhiteConfig=function(t){return new Promise(function(e,i){a.webServer.get(u+"/v1/player/h5-config",{params:l.getSignedData({gameId:!t?xfConfig.appId:t,configKey:"background",random:l.getRandom(),timestamp:l.getTimestamp()})}).then(function(t){e(t)}).catch(function(t){i(t)})})},t.getGameUrl=function(t){return a.webServer.get(u+"/v1/app/game-info/get-game-url",{params:{gameId:t,type:1}})},t.getPlayerPurchasedResources=function(t){var e=u+"/v1/player/purchased-resources/info",i=l.getSignedData(n({playerId:xf.gameInfo.playerId,token:xf.gameInfo.token,gameId:xf.gameInfo.gameId,timestamp:l.getTimestamp(),random:l.getRandom()},t));return a.webServer.get(e,{params:i})},t.createOrder=function(t){var e=u+"/v1/player/order",i=l.getSignedData(n({playerId:xf.gameInfo.playerId,token:xf.gameInfo.token,gameId:xf.gameInfo.gameId,platform:c.Platform[xf.gameInfo.platform],timestamp:l.getTimestamp(),random:l.getRandom(),did:xf.gameInfo.deviceId,roleId:xf.gameInfo.characterId,gameVersion:xf.gameInfo.version},t));return a.webServer.post(e,i)},t.getServerTime=function(){return a.webServer.get(u+"/v1/common/currentTime")},t}();e.webApi=r,e.default=r}}),function(i){var n={};function r(t){if(n[t])return n[t].exports;var e=n[t]={i:t,l:!1,exports:{}};return i[t].call(e.exports,e,e.exports,r),e.l=!0,e.exports}r.m=i,r.c=n,r.d=function(t,e,i){if(!r.o(t,e))Object.defineProperty(t,e,{enumerable:!0,get:i})},r.r=function(t){if("undefined"!=typeof Symbol&&Symbol.toStringTag)Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(e,t){if(1&t)e=r(e);if(8&t)return e;if(4&t&&"object"===_typeof(e)&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(i,n,function(t){return e[t]}.bind(null,n));return i},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s="b7d60f75f76873e7")}({"081ce22713c044b3":function(t,e,i){Object.defineProperty(e,"__esModule",{value:!0}),e.urlCodeMap={"v1/player/game-initialize":0,"v2/player/game-login":1,"v1/player/order":2,"v1/player/game-data/list":3,"v1/player/game-data/load":4,"v1/player/game-data/save":5,"v1/player/mail":6,"v1/player/order/":7,"v1/player/account":8,"v1/player/purchased-resources/info":9,"v1/player/game-notice":10,"v1/player/game-notice/detail":11,"v1/player/game-activity":12,"v1/player/game-share/info":13,"v1/player/game-share/list":14,"v1/player/h5-config":15,"character/v1/character":101,"character/v1/character/":102,"logic/v1/plugin/result":103,"goods/sync":104,"goods/buy":105},e.errorcodeMap={6001:{code:"GAME_INFO_NULL",message:"%s游戏信息不存在"},6002:{code:"GAME_VERSION_INFO_NULL",message:"游戏版本信息不存在"},6003:{code:"GAME_USER_NOT_MATCH",message:"游戏创建者与当前登录用户不匹配"},6004:{code:"GAME_CONDITION_ERROR",message:"Condition表达式错误"},6005:{code:"GAME_SHARE_ACTION_EXISTS",message:"该分享动作已存在"},6006:{code:"GAME_SHARE_ACTION_NAME_EXISTS",message:"分享动作名称已存在"},6007:{code:"GAME_IS_AGENCY",message:"游戏已申请独家代理"},6008:{code:"GAME_IS_FROZEN",message:"游戏已被封停"},6009:{code:"GAME_IS_NOT_ONLINE_GAME",message:"该游戏不是联机游戏"},6011:{code:"GAME_IS_NOT_PC_GAME",message:"该游戏不是单机游戏"},6012:{code:"GAME_EXP_PLAYER_FULL",message:"游戏体验人数已达上限"},6013:{code:"GAME_PLAYER_FULL",message:"游戏人数已达上限"},6014:{code:"GAME_CREATE_USER_ERROR",message:"游戏创建者信息错误"},6015:{code:"GAME_SECRET_LOGIN_ERROR",message:"私密游戏登录失败"},7016:{code:"GAME_INFO_EXISTS",message:"该工程已有对应作品存在"},7017:{code:"PROJECT_INFO_EXISTS",message:"该作品已有工程ID"},7018:{code:"GAME_GLOBAL_VARIABLE_VERSION_EXISTS",message:"该版本全局变量已发布正式版本"},9004:{code:"NOT_LOGIN",message:"用户未登录"},9005:{code:"INVALID_TOKEN",message:"登录过期"},9006:{code:"ERR_TOKEN",message:"服务器验证token失败"},9007:{code:"TOKEN_ERROR",message:"token有误"},9008:{code:"TEMPLATE_TAG__NOT_EXIST",message:"模板标签不存在"},9011:{code:"USER_NOT_LOGIN_AUTHORITY",message:"无登录权限"},9012:{code:"USER_NOT_MENU_AUTHORITY",message:"没有菜单权限"},1999:{code:"NAME_EXIST",message:"名称已存在"},9013:{code:"GAME_STATUS_CHANGE",message:"游戏状态发生变化"},9014:{code:"PLAYER_STATUS_CHANGE",message:"玩家状态发生变化"},9015:{code:"NOT_SUPPORT_REQUEST_METHOD",message:"请求方式不支持"},9016:{code:"INVALID_FINGERPRINT",message:"指纹无效"},9017:{code:"NOT_FOUND_GOODS",message:"找到不到该内购商品"},9018:{code:"INVALID_EXCHANGE_TYPE",message:"价格档位无效"},9019:{code:"INVALID_GOODS_TYPE",message:"商品类型无效"},9020:{code:"GAME_CURRENCY_EXIST",message:"该游戏已定义货币"},9021:{code:"INVALID_EXCHANGE_RATE",message:"兑换比例无效"},9022:{code:"INVALID_DICT_VALUE",message:"商品类型无效"},9023:{code:"GAME_GOODS_EXIST",message:"该商品已添加过"},9024:{code:"DATA_NOT_EXIST",message:"数据不存在"},9025:{code:"USER_GAME_PLAYER_MISMATCH",message:"用户ID、游戏ID或玩家ID都不能为空"},9026:{code:"PLAYER_INFO_NULL",message:"玩家不存在"},9027:{code:"DATA_MISMATCH_NO_AUTH",message:"抱歉，数据不匹配，不允许操作"},9028:{code:"GAME_ID_OR_PLAYER_ID_NULL",message:"玩家ID或游戏ID不能为空"},9029:{code:"DELETE_DRAMA_ID_ERROR",message:"删除抓马沙盒账号异常"},9030:{code:"CREATE_DRAMA_ID_ERROR",message:"创建抓马沙盒账号异常"},9031:{code:"GAME_NAME_REPEAT",message:"游戏名称已重复，请修改游戏名称"},9032:{code:"GAME_NAME_EXIST",message:"游戏名已存在"},9033:{code:"DELETE_FILE_ERROR",message:"删除临时文件异常"},9034:{code:"GAME_VERSION_ERROR",message:"游戏版本号要大于当前的"},9035:{code:"NO_NEED_RESEND",message:"该商品类型不需要补发货"},9036:{code:"ERROR_OP_TYPE",message:"操作类型错误"},9037:{code:"NO_FOUND_GAME_NOTICE",message:"找到不到游戏公告"},9038:{code:"TIME_OUT_OF_RANGE",message:"时间范围超出3个月"},9039:{code:"GAME_GOODS_PRICE_NOT_MATCH",message:"商品价格不匹配，请重新登录再试"},9040:{code:"GOODS_TYPE_NOT_SUPPORT",message:"不支持消耗型商品购买"},9041:{code:"AMOUNT_GREATER_THAN_ZERO",message:"金额要大于0"},9042:{code:"OP_NOT_SUPPORT",message:"操作不支持"},9043:{code:"TOKEN_INVALID_OR_NO_AUTH",message:"凭证无效或权限不够"},9044:{code:"NOT_CREATE_ROLE",message:"没有创建角色"},9045:{code:"DATA_STATUS_UPDATE_NOT_ALLOWED",message:"数据状态不允许变更"},9046:{code:"END_TIME_IS_EXPIRED",message:"结束时间已无效，请先编辑"},9047:{code:"RECEIVER_IS_NULL",message:"请填写指定接收人"},9048:{code:"SEND_TIME_IS_NULL",message:"请填写指定发送时间"},9049:{code:"AUTH_NAME_EXIST",message:"授权名称已存在"},9050:{code:"GAME_NOT_EXIST",message:"游戏不存在"},9051:{code:"GAME_VERSION_EXIST",message:"该平台对应的游戏版本号已经存在"},9052:{code:"GAME_VERSION_FORMAT_ERROR",message:"游戏版本号格式错误"},9053:{code:"GAME_IS_DELETED",message:"游戏已被删除"},71001:{code:"CHARACTER_NAME_EXIST",message:"角色名已存在"}}},"0d29f351d650372a":function(t,e,i){Object.defineProperty(e,"__esModule",{value:!0});var r=i("4f5d0dbbc4df297a"),o=i("3ef79e4e773762de"),s=xfConfig.serverURL,n=function(){function t(){}return t.getCharacterList=function(t){var e=o.getSignedData({uid:t.uid,gid:t.gid,timestamp:o.getTimestamp(),random:o.getRandom()});return r.gameServer.get(s+"/character/v1/character",{params:e})},t.getCharacterInfo=function(t){var e=t.cid,i=o.getSignedData({gid:t.gid,timestamp:o.getTimestamp(),random:o.getRandom(),cid:e});return r.gameServer.get(s+"/character/v1/character/"+e,{params:i})},t.createCharacter=function(t){var e=s+"/character/v1/character",i=o.getSignedData({uid:t.uid,gid:t.gid,cname:t.cname,timestamp:o.getTimestamp(),random:o.getRandom()});return r.gameServer({method:"POST",url:e,data:i})},t.updateCharacter=function(t){if(!t.cid)throw new Error("【更新游戏角色失败】：当前账号没有获取到角色信息，请先创建角色后才能修改.");var e=s+"/character/v1/character/"+t.cid,i={cid:t.cid,gid:t.gid,cname:t.cname,timestamp:o.getTimestamp(),random:o.getRandom(),gver:t.gver};if(t.glov)i.glov=JSON.stringify(t.glov);var n=o.getSignedData(i);return n.glov=t.glov,r.gameServer({method:"PUT",url:e,data:n})},t.getRankInfo=function(t){var e=s+"/logic/v1/plugin/result/"+t.instanceId;return r.gameServer.get(e,{params:o.getSignedData({gameVersion:t.gameVersion,gameId:t.gameId,timestamp:o.getTimestamp(),random:o.getRandom(),instanceId:t.instanceId})})},t.getCloudSaveData=function(){return r.gameServer.get(s+"/logic/v1/clouddb/storage")},t.syncCloudSaveData=function(t){var e=s+"/logic/v1/clouddb/operations";return r.gameServer.put(e,t,{headers:{"Content-Type":"application/snappy"}})},t.getCloundSaveStatus=function(){return r.gameServer.get(s+"/logic/v1/clouddb/stats")},t.syncCharacterGoods=function(e){if(e)xf.gameInfo.goodsList=e;else{var t=localStorage.getItem("xf_character_goods"+xf.gameInfo.characterId);e=t?JSON.parse(t):xf.gameInfo.goodsList}localStorage.setItem("xf_character_goods"+xf.gameInfo.characterId,JSON.stringify(e));var i=s+"/character/v1/character/"+xf.gameInfo.characterId+"/goods/sync",n=o.getSignedData({cid:xf.gameInfo.characterId,gid:xf.gameInfo.gameId,timestamp:o.getTimestamp(),random:o.getRandom(),goods:e});return r.gameServer({url:i,method:"POST",data:n}).then(function(t){xf.gameInfo.goodsList=t.goods,localStorage.setItem("xf_character_goods"+xf.gameInfo.characterId,JSON.stringify(e))})},t.buyGoods=function(t){var e=s+"/character/v1/character/"+t.cid+"/goods/buy",i=o.getSignedData({cid:t.cid,gid:t.gid,goods_id:t.goods_id,buy_num:t.buy_num,uid:t.uid,request_id:t.request_id,timestamp:o.getTimestamp(),random:o.getRandom()});return r.gameServer({url:e,method:"POST",data:i})},t}();e.serverApi=n,e.default=n},"3ef79e4e773762de":function(t,e,i){Object.defineProperty(e,"__esModule",{value:!0}),e.getRandom=function(){return 1e4*Math.random()<<0},e.getTimestamp=function(){return.001*Date.now()<<0},e.getSignedData=function(i){var t=Object.keys(i).sort(),n={};t.forEach(function(t){var e=i[t];if("object"===_typeof(e))e=JSON.stringify(e);n[t]=e});var e=xf.stringify(n);return e=e+"&"+xf.gameInfo.secretKey,i.sign=md5(e).toLowerCase(),i},e.getSignedDataByXfConfig=function(i,t){var e=Object.keys(i).sort(),n={};e.forEach(function(t){var e=i[t];if("object"===_typeof(e))e=JSON.stringify(e);n[t]=e});var r=xf.stringify(n);return r=r+"&"+(t||xfConfig.appKey),i.sign=md5(r).toLowerCase(),i},e.getSignedDataStr=function(t){var e=xf.stringify(t),i=e+xf.gameInfo.secretKey;return e+="sign="+md5(i).toLowerCase()},e.logout=function(t){if(void 0===t)t="登录过期，请重新登陆";var e=function(){if(window.cordova)cordova.plugins.SeiyaSdk.logout();else if(window.xsSdk)window.xsSdk.logout();window.location.reload()};if(window.xfruntime)xf.MessageBox.alert(t,{callback:e});else xf.XfLoginCanvas.showAlert(t,{cancelCallback:e,showConfirmButton:!1,cancelButtonText:"重试"})}},"407b4704136fd4d1":function(t,e,i){var n,r;Object.defineProperty(e,"__esModule",{value:!0}),(n=e.PayType||(e.PayType={}))[n.AliPay=1]="AliPay",n[n.WXPay=2]="WXPay",n[n.ApplePay=3]="ApplePay",n[n.Sandbox=4]="Sandbox",(r=e.Platform||(e.Platform={}))[r.Android=1]="Android",r[r.iOS=2]="iOS",r[r.OSX=4]="OSX",r[r.Browser=8]="Browser",r[r.microApp=16]="microApp",r[r.Windows=32]="Windows"},"4f5d0dbbc4df297a":function(t,e,i){Object.defineProperty(e,"__esModule",{value:!0});var l=i("3ef79e4e773762de"),n=i("407b4704136fd4d1"),r=i("081ce22713c044b3"),c=axios.create({timeout:1e4});(e.webServer=c).interceptors.request.use(function(t){if(t.data)if(!t.data.json){var e=new URLSearchParams;for(var i in t.data)if(t.data.hasOwnProperty(i))e.append(i,t.data[i]);t.data=e}else delete t.data.json;return t},function(t){return Promise.reject(t)});c.interceptors.response.use(function(t){var e=t.data;if(1==e.status)return e.data;else if(9005==e.status)l.logout();else{switch(e.errInfo.code+""){case"9053":case"10013":location.href=window.xfConfig.gameNotFound}throw window.Sentry.captureMessage({request:JSON.stringify(t.config),response:JSON.stringify(t.data)}),new Error(JSON.stringify(e))}},function(t){var e=t&&t.config&&t.config.url;if(e){var i=t.config,n=i.headers.pf;if(-1<e.indexOf("/v1/player/game-initialize"))if(4==n&&"post"==i.method.toLowerCase()){var r,o=i.data;if("string"==typeof o)o=xf.parseQuery(i.data);r=l.getSignedData({gameId:o&&o.gameId,timestamp:l.getTimestamp(),random:l.getRandom()}),t.config.data=r}else if("get"==i.method.toLowerCase()){var s={};if("string"==typeof(a=i.params))a=xf.parseQuery(i.params);s=l.getSignedData({gameId:a.gameId,timestamp:l.getTimestamp(),random:l.getRandom(),platform:a.platform,fingerprint:a.fingerprint,gameVersion:a.gameVersion}),t.config.params=s}else return Promise.reject(t);if(-1<e.indexOf("/v2/player/game-login"))if("get"==i.method.toLowerCase()){var a;s={};if("string"==typeof(a=i.params))a=xf.parseQuery(i.params);s=l.getSignedData({playerId:a.playerId,token:a.token,gameId:a.gameId,platform:a.platform,deviceId:a.deviceId,timestamp:l.getTimestamp(),random:l.getRandom(),gameVersion:a.gameVersion}),t.config.params=s}else return Promise.reject(t);return function(t,e){var i=t.config;if(!i)return window.isSeiyaSdkLogining=!1,Promise.reject(t);if(i.__retryCount=i.__retryCount||0,4<=i.__retryCount)return Promise.reject(t);else return i.__retryCount+=1,new Promise(function(t){setTimeout(function(){t()},2e3*i.__retryCount||1)}).then(function(){return e(i)})}(t,c)}else console.log(t)});var o=axios.create({timeout:5e3});(e.gameServer=o).interceptors.request.use(function(t){return t.headers={"Content-Type":"application/json","Dr-Device-Id":xf.gameInfo.deviceId,"Dr-Player-Id":xf.gameInfo.playerId,"Dr-Character-Id":xf.gameInfo.characterId,"Dr-Game-Id":xf.gameInfo.gameId,"Dr-Game-Version":xf.gameInfo.version,"Dr-Token":xf.gameInfo.token,"Dr-Platform":n.Platform[xf.gameInfo.platform]},t},function(t){return Promise.reject(t)});o.interceptors.response.use(function(t){var e=t.data;if(1==e.status)return e.data;else{var i=new Error(JSON.stringify(e));if(i.status=e.status,i.info=e.info,10==e.status)throw l.logout(),i;var n=function(t){var e=-1;for(var i in r.urlCodeMap)if(-1<t.indexOf(i))e=r.urlCodeMap[i];return e}(t.config.url);if(-1===[71001,71103].indexOf(e.status))if(window.xfruntime)if(9005===e.status||9006===e.status||9007===e.status)l.logout(r.errorcodeMap[e.status+""].message);else xf.MessageBox.alert("错误："+e.info+"["+e.status+"]["+n+"]");else xf.XfLoginCanvas.showAlert("错误："+e.info+"["+e.status+"]["+n+"]",{cancelCallback:function(){xf.EvkLogin.start(xf.EvkLogin.startGame)},showConfirmButton:!1});throw window.Sentry.captureMessage({request:JSON.stringify(t.config),response:JSON.stringify(t.data)}),i}},function(t){return window.isSeiyaSdkLogining=!1,Promise.reject(t)})},b7d60f75f76873e7:function(t,e,i){var n=this&&this.__awaiter||function(o,s,a,l){return new(a||(a=Promise))(function(t,e){function i(t){try{r(l.next(t))}catch(t){e(t)}}function n(t){try{r(l.throw(t))}catch(t){e(t)}}function r(e){e.done?t(e.value):new a(function(t){t(e.value)}).then(i,n)}r((l=l.apply(o,s||[])).next())})},s=this&&this.__generator||function(i,n){var r,o,s,t,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;if(o=0,s)e=[2&e[0],s.value];switch(e[0]){case 0:case 1:s=e;break;case 4:return a.label++,{value:e[1],done:!1};case 5:a.label++,o=e[1],e=[0];continue;case 7:e=a.ops.pop(),a.trys.pop();continue;default:if(!(s=0<(s=a.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){a=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){a.label=e[1];break}if(6===e[0]&&a.label<s[1]){a.label=s[1],s=e;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(e);break}if(s[2])a.ops.pop();a.trys.pop();continue}e=n.call(i,a)}catch(t){e=[6,t],o=0}finally{r=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}};Object.defineProperty(e,"__esModule",{value:!0});var a=i("0d29f351d650372a"),r=function(){function o(){}return o.init=function(){return n(this,void 0,void 0,function(){var e,i,n,r;return s(this,function(t){switch(t.label){case 0:if(t.trys.push([0,4,,5]),e=window.xfConfig,i=null,"preview"!=e.exportType)return[3,1];else return i=xf.localApi.getPreviewInfo(),o.previewUserToken=i.token,o.previewUserId=i.devId,o.editorVersion=i.editorVersion,[3,3];case 1:return[4,xf.localApi.init()];case 2:i=t.sent(),o.fingerprint=i.fingerprint,o.editorVersion=e.editorVersion,t.label=3;case 3:return o.secretKey=i.secretKey,o.gameType=i.gameType||e.gameType,o.gameId=i.appId,o.projectId=i.projectId,o.devId=i.devId,o.version=i.version,o.deviceId=i.deviceId,o.purchasedResources=[],o.goodsList={},o.recentlyUpdatedResource={isUpdated:!1,goodsId:""},n=navigator.userAgent.toLowerCase(),o.isEvkApp=-1<n.indexOf("evkworld")&&!/electron/.test(n),o.initPlatform(),[2,Promise.resolve(o)];case 4:return r=t.sent(),[2,Promise.reject(r)];case 5:return[2]}})})},o.initPlatform=function(){var xfConfig=window.xfConfig;if("preview"==xfConfig.exportType)return!(o.platform="Browser");switch(xfConfig.platform){case"h5":o.platform="Browser";break;case"android":o.platform="Android";break;case"ios":o.platform="iOS";break;case"byteDance":case"weChat":case"bilibili":o.platform="microApp";break;case"windows":o.platform="Windows";break;case"mac":o.platform="OSX"}},o.setPreviewPlayerInfo=function(e){return n(this,void 0,void 0,function(){return s(this,function(t){return o.playerId=e.playerId,o.token=e.token,[2]})})},o.setGameInfo=function(i){return n(this,void 0,void 0,function(){var e;return s(this,function(t){if(o.gameStatus=i.status,o.adTag=i.adTag,o.keyStoreValid=i.keystoreValid,o.isRelease=i.flag,o.eagleGameId=i.eagleGameId,o.eagleKey=i.eagleKey,o.eagleChannel=i.eagleChannel,o.isSecret=i.secret,"xingyun"==xfConfig.channel&&"h5"==xfConfig.exportType&&"1"==o.isRelease)window.eConfig={xingfei_c_type:"2",es_e_channelCode:"xingfei",es_e_gameId:o.eagleGameId,es_e_gcid:o.eagleChannel,es_e_subChannel:"0",es_e_extChannel:""};if(e=!1,o.isEvkApp||!o.isSecret&&1==o.gameType)e=!0;return o.isSilenceLogin=e,[2]})})},o.setChannelId=function(t){o.channelId=t},o.setPlayerInfo=function(t){o.playerId=t.selfPlayerId,o.token=t.token,o.isSandbox=t.isSandbox,o.effectiveDate=t.effectiveDate,o.isPaid=t.isPaid,o.payCount=t.payCount,o.isFirstLogin=t.isFirstLogin,o.playerStatus=t.status,o.createTime=t.createTime},o.setCharacterInfo=function(t){if(t.cid)o.characterId=t.cid;if(t.ctime)o.registerTime=t.ctime;if(t.cname)o.characterName=t.cname;if(t.goods)o.goodsList=t.goods;if(t.wallet)o.wallet=t.wallet},o.syncCharacterInfo=function(){return a.default.getCharacterInfo({cid:this.characterId,gid:this.gameId}).then(function(t){return xf.gameInfo.wallet=t.wallet,t})},o.characterBuyGood=function(r){var i=(new Date).getTime(),t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=(i+16*Math.random())%16|0;return i=Math.floor(i/16),("x"==t?e:3&e|8).toString(16)});r.request_id=t,r.cid=xf.gameInfo.characterId,r.gid=xf.gameInfo.gameId,r.uid=xf.gameInfo.playerId;var o=0,s=this;return new Promise(function(t,e){!function e(i,n){a.default.buyGoods(r).then(function(t){s.syncCharacterInfo().then(function(t){i(t)})}).catch(function(t){if(-1!==[71001,71103].indexOf(t.status))n(t);else if(o<=10)++o,setTimeout(function(){e(i,n)},1e3);else n(t)})}(t,e)})},o.isTest=!1,o.eagleGameId="",o.eagleKey="",o.eagleChannel="",o.channelCode="xingfei",o.isCommercialized=0,o.gameExportType=window.xf.gameExportType.Preview,o.isSandbox=0,o.wallet=0,o}();e.gameInfo=r,window.xf.gameInfo=r,e.default=r}}),function(i){var n={};function r(t){if(n[t])return n[t].exports;var e=n[t]={i:t,l:!1,exports:{}};return i[t].call(e.exports,e,e.exports,r),e.l=!0,e.exports}r.m=i,r.c=n,r.d=function(t,e,i){if(!r.o(t,e))Object.defineProperty(t,e,{enumerable:!0,get:i})},r.r=function(t){if("undefined"!=typeof Symbol&&Symbol.toStringTag)Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(e,t){if(1&t)e=r(e);if(8&t)return e;if(4&t&&"object"===_typeof(e)&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(i,n,function(t){return e[t]}.bind(null,n));return i},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s="f4fa0d45fce0792f")}({"044c15f71db71c3a":function(t,e,i){var n=this&&this.__awaiter||function(o,s,a,l){return new(a||(a=Promise))(function(t,e){function i(t){try{r(l.next(t))}catch(t){e(t)}}function n(t){try{r(l.throw(t))}catch(t){e(t)}}function r(e){e.done?t(e.value):new a(function(t){t(e.value)}).then(i,n)}r((l=l.apply(o,s||[])).next())})},a=this&&this.__generator||function(i,n){var r,o,s,t,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;if(o=0,s)e=[2&e[0],s.value];switch(e[0]){case 0:case 1:s=e;break;case 4:return a.label++,{value:e[1],done:!1};case 5:a.label++,o=e[1],e=[0];continue;case 7:e=a.ops.pop(),a.trys.pop();continue;default:if(!(s=0<(s=a.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){a=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){a.label=e[1];break}if(6===e[0]&&a.label<s[1]){a.label=s[1],s=e;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(e);break}if(s[2])a.ops.pop();a.trys.pop();continue}e=n.call(i,a)}catch(t){e=[6,t],o=0}finally{r=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}};Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(){}return t.initXingshiSDK=function(s){var t=this;return new Promise(function(r,o){return n(t,void 0,void 0,function(){var e,i,n;return a(this,function(t){switch(t.label){case 0:if(t.trys.push([0,5,,6]),e={},"h5"!=s)return[3,2];else return[4,this.appendH5SDK("h5")];case 1:return t.sent(),e={share:xfConfig.share,game:{orientation:window.xfConfig.screenDirection,name:window.xfConfig.appName,version:xf.gameInfo.version}},[3,4];case 2:if("electron"!=s)return[3,4];else return[4,this.appendH5SDK("pc")];case 3:t.sent(),t.label=4;case 4:if(i=window.xsSdk)i.init(xf.gameInfo.isRelease,null,function(t){if(t&&1==t.state)console.log("星矢SDK init 后返回数据:",t),r(t);else o(t)},e);else o("星矢 sdk 尚未引入!");return[3,6];case 5:return n=t.sent(),o(n),[3,6];case 6:return[2]}})})})},t.initCordovaSDK=function(){return new Promise(function(e,i){var t=xf.gameInfo,n=t.gameId,r=t.eagleGameId,o=t.eagleKey,s=t.eagleChannel;if("Android"==t.platform){var a={X_SILENT_LOGIN:t.isSilenceLogin?!0:!1,Eagle_Channel:s,Eagle_APPID:r,Eagle_APPKEY:o};cordova.plugins.SeiyaSdk.init(t.isRelease?!0:!1,n,a,function(t){e(t)},function(t){console.log("android sdk初始化失败"+t),cordova.plugins.DramaApplication.showAlert(window.trFunc("SDK初始化失败"),!0),i(t)})}else if("iOS"==t.platform){var l=t.isSilenceLogin?1:0;cordova.plugins.SeiyaSdk.iosInit(n,r,o,s,l,function(t){e(t)},function(t){console.log("ios SDK初始化失败"+t),cordova.plugins.DramaApplication.showAlert("SDK初始化失败",!0),i(t)})}})},t.appendH5SDK=function(o){return new Promise(function(t,e){var i=document.createElement("script"),n=(new Date).getTime(),r="";switch(o){case"h5":r=window.xfConfig.xsSdk+"?t="+n;break;case"pc":r=window.xfConfig.xsSdkPC+"?t="+n}i.src=r,document.body.appendChild(i),i.onload=function(){t()},i.onerror=function(){e()}})},t.initH5SdkShare=function(){var t=window.xsSdk;if(t&&t.share&&xfConfig.share)t.share(xfConfig.share,function(){console.log("h5分享初始化成功")})},t}();e.default=r},"59f9ac1af5091d78":function(t,e,i){Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(){this._encodeChars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",this._decodeChars=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1]}return t.prototype.base64encode=function(t){var e,i,n,r,o,s;for(n=t.length,i=0,e="";i<n;){if(r=255&t.charCodeAt(i++),i==n){e+=this._encodeChars.charAt(r>>2),e+=this._encodeChars.charAt((3&r)<<4),e+="==";break}if(o=t.charCodeAt(i++),i==n){e+=this._encodeChars.charAt(r>>2),e+=this._encodeChars.charAt((3&r)<<4|(240&o)>>4),e+=this._encodeChars.charAt((15&o)<<2),e+="=";break}s=t.charCodeAt(i++),e+=this._encodeChars.charAt(r>>2),e+=this._encodeChars.charAt((3&r)<<4|(240&o)>>4),e+=this._encodeChars.charAt((15&o)<<2|(192&s)>>6),e+=this._encodeChars.charAt(63&s)}return e},t.prototype.base64decode=function(t){var e,i,n,r,o,s,a;for(s=t.length,o=0,a="";o<s;){for(;e=this._decodeChars[255&t.charCodeAt(o++)],o<s&&-1==e;);if(-1==e)break;for(;i=this._decodeChars[255&t.charCodeAt(o++)],o<s&&-1==i;);if(-1==i)break;a+=String.fromCharCode(e<<2|(48&i)>>4);do{if(61==(n=255&t.charCodeAt(o++)))return a;n=this._decodeChars[n]}while(o<s&&-1==n);if(-1==n)break;a+=String.fromCharCode((15&i)<<4|(60&n)>>2);do{if(61==(r=255&t.charCodeAt(o++)))return a;r=this._decodeChars[r]}while(o<s&&-1==r);if(-1==r)break;a+=String.fromCharCode((3&n)<<6|r)}return a},t.prototype.utf16to8=function(t){var e,i,n,r;for(e="",n=t.length,i=0;i<n;i++)if(1<=(r=t.charCodeAt(i))&&r<=127)e+=t.charAt(i);else if(2047<r)e+=String.fromCharCode(224|r>>12&15),e+=String.fromCharCode(128|r>>6&63),e+=String.fromCharCode(128|r>>0&63);else e+=String.fromCharCode(192|r>>6&31),e+=String.fromCharCode(128|r>>0&63);return e},t.prototype.utf8to16=function(t){var e,i,n,r,o,s;for(e="",n=t.length,i=0;i<n;)switch((r=t.charCodeAt(i++))>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:e+=t.charAt(i-1);break;case 12:case 13:o=t.charCodeAt(i++),e+=String.fromCharCode((31&r)<<6|63&o);break;case 14:o=t.charCodeAt(i++),s=t.charCodeAt(i++),e+=String.fromCharCode((15&r)<<12|(63&o)<<6|(63&s)<<0)}return e},t}();e.default=n},e1aed533941ea710:function(t,e,i){var n=this&&this.__awaiter||function(o,s,a,l){return new(a||(a=Promise))(function(t,e){function i(t){try{r(l.next(t))}catch(t){e(t)}}function n(t){try{r(l.throw(t))}catch(t){e(t)}}function r(e){e.done?t(e.value):new a(function(t){t(e.value)}).then(i,n)}r((l=l.apply(o,s||[])).next())})},s=this&&this.__generator||function(i,n){var r,o,s,t,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;if(o=0,s)e=[2&e[0],s.value];switch(e[0]){case 0:case 1:s=e;break;case 4:return a.label++,{value:e[1],done:!1};case 5:a.label++,o=e[1],e=[0];continue;case 7:e=a.ops.pop(),a.trys.pop();continue;default:if(!(s=0<(s=a.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){a=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){a.label=e[1];break}if(6===e[0]&&a.label<s[1]){a.label=s[1],s=e;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(e);break}if(s[2])a.ops.pop();a.trys.pop();continue}e=n.call(i,a)}catch(t){e=[6,t],o=0}finally{r=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}};Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function i(){this.READ_PHONE_STATE=null,this.WRITE_EXTERNAL_STORAGE=null,this.plugins=null,this.plugins=window.cordova.Permissions,this.READ_PHONE_STATE=this.plugins.ANDROID.READ_PHONE_STATE,this.WRITE_EXTERNAL_STORAGE=this.plugins.ANDROID.WRITE_EXTERNAL_STORAGE}return i.prototype.requestGamePermission=function(){var t=this,e=i.getCheckCount();return i.setCheckCount(++e),new Promise(function(r,o){return n(t,void 0,void 0,function(){var e,i,n;return s(this,function(t){switch(t.label){case 0:if(/iphone/i.test(navigator.userAgent)||/ipod/i.test(navigator.userAgent)||xf.isIpad())return r(!0),[2];else return[4,this.has(this.READ_PHONE_STATE)];case 1:return e=t.sent(),[4,this.has(this.WRITE_EXTERNAL_STORAGE)];case 2:if(i=t.sent(),e&&i)return r(!0),[2];if(n=[],!e)n.push(this.READ_PHONE_STATE);if(!i)n.push(this.WRITE_EXTERNAL_STORAGE);return this.plugins.requestPermissions(n,function(t){r(t.hasPermission)},function(t){o(t)}),[2]}})})})},i.prototype.has=function(t){var n=this;return new Promise(function(e,i){n.plugins.checkPermission(t,function(t){e(t.hasPermission)},function(t){i(t)})})},i.getCheckCount=function(){var t=localStorage.getItem(i.key);return t?Number(t):0},i.setCheckCount=function(t){localStorage.setItem(i.key,t.toString())},i.handleNativeSettings=function(){if(i.setCheckCount(0),void 0!==cordova.plugins.settings.openSetting)xf.XfLoginCanvas.showAlert(window.trFunc("为了保证正常游戏体验，需获取设备信息和存储空间的权限。请授权后重试。"),{confirmCallback:function(){i.getApplicationDetails()},hideCancelButton:!0,showConfirmButton:!0,confirmButtonText:window.trFunc("设置权限")})},i.getApplicationDetails=function(){cordova.plugins.settings.openSetting("application_details",function(){var t="hidden"in document?"hidden":"webkitHidden"in document?"webkitHidden":"mozHidden"in document?"mozHidden":null,e=t.replace(/hidden/i,"visibilitychange");document.addEventListener(e,function(){if(!document[t])window.location.reload()})},function(){console.error("failed to open application_details settings")})},i.Shared=function(){if(!this.shared)this.shared=new i;return this.shared},i.key="XF_CHECK_PERMISSION_COUNT",i.shared=null,i}();e.default=r},e8fafa49f5959965:function(t,e,i){Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(){}return t.loginCheck=function(t){var e=t.messageData;console.log("------------ xf 开始登录校验 ------------"),xf.webApi.loginCheck({userID:e.userID,token:e.token,gameId:xf.gameInfo.gameId,platform:xf.gameInfo.platform,deviceId:xf.gameInfo.deviceId,gameVersion:xf.gameInfo.version}).then(function(t){var e=t.data;e.token=t.data.dramaToken,xf.EventCenter.instance.sendEvent(new xf.EventData(xf.EventType.LOGIN_SUCCESS,e))},function(t){var e=t.message?JSON.parse(t.message):t;xf.EventCenter.instance.sendEvent(new xf.EventData(xf.EventType.LOGIN_FAIL,e))})},t.userCordovaLogin=function(){if(cordova.plugins.SeiyaSdk.login(),!t.isCordovaBindEvent)t.isCordovaBindEvent=!0,document.addEventListener("onLoginResult",function(t){if("object"===_typeof(t))xf.EventCenter.instance.sendEvent(new xf.EventData(xf.EventType.SDK_LOGIN_SUCCESS,t));else xf.EventCenter.instance.sendEvent(new xf.EventData(xf.EventType.LOGIN_FAIL,t))},!1),document.addEventListener("onLoginFail",function(t){xf.EventCenter.instance.sendEvent(new xf.EventData(xf.EventType.LOGIN_FAIL,t))},!1),document.addEventListener("onSwitchAccount",function(t){if("object"===_typeof(t))xf.EventCenter.instance.sendEvent(new xf.EventData(xf.EventType.SDK_SWITCH_ACCOUNT,t));else xf.EventCenter.instance.sendEvent(new xf.EventData(xf.EventType.LOGIN_FAIL,t))},!1),document.addEventListener("onLogout",function(t){xf.EventCenter.instance.sendEvent(new xf.EventData(xf.EventType.SDK_LOGOUT,t))},!1),document.addEventListener("backbutton",function(t){cordova.plugins.SeiyaSdk.gameExit()},!1)},t.userXingshiLogin=function(){window.xsSdk.login(function(t){if(t&&1==t.state&&t.data){var e=t.data;e.userID=e.userId,xf.EventCenter.instance.sendEvent(new xf.EventData(xf.EventType.SDK_LOGIN_SUCCESS,e))}else xf.EventCenter.instance.sendEvent(new xf.EventData(xf.EventType.LOGIN_FAIL,t))},xf.gameInfo.isSilenceLogin?1:2)},t.addMIEvent=function(){var t;if(void 0!==document.hidden)t="visibilitychange";else if(void 0!==document.webkitHidden)t="webkitvisibilitychange";document.addEventListener(t,function(){if(document.hidden);},!1),document.addEventListener("JsBridgeResume",function(){}),document.addEventListener("JsBridgePause",function(){})},t.isCordovaBindEvent=!1,t}();e.default=n},f4fa0d45fce0792f:function(t,e,i){var n=this&&this.__awaiter||function(o,s,a,l){return new(a||(a=Promise))(function(t,e){function i(t){try{r(l.next(t))}catch(t){e(t)}}function n(t){try{r(l.throw(t))}catch(t){e(t)}}function r(e){e.done?t(e.value):new a(function(t){t(e.value)}).then(i,n)}r((l=l.apply(o,s||[])).next())})},a=this&&this.__generator||function(i,n){var r,o,s,t,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;if(o=0,s)e=[2&e[0],s.value];switch(e[0]){case 0:case 1:s=e;break;case 4:return a.label++,{value:e[1],done:!1};case 5:a.label++,o=e[1],e=[0];continue;case 7:e=a.ops.pop(),a.trys.pop();continue;default:if(!(s=0<(s=a.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){a=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){a.label=e[1];break}if(6===e[0]&&a.label<s[1]){a.label=s[1],s=e;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(e);break}if(s[2])a.ops.pop();a.trys.pop();continue}e=n.call(i,a)}catch(t){e=[6,t],o=0}finally{r=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}};Object.defineProperty(e,"__esModule",{value:!0});var l,r=i("044c15f71db71c3a"),o=i("e8fafa49f5959965"),c=i("e1aed533941ea710"),u=i("59f9ac1af5091d78"),s=function(){function s(){}return s.start=function(i){return n(this,void 0,void 0,function(){var xfConfig,e;return a(this,function(t){switch(t.label){case 0:return[4,window.i18n.init()];case 1:return t.sent(),[4,window.fbdManager.init()];case 2:if(t.sent(),(xfConfig=window.xfConfig).outline)return console.log("-----游戏不需要登录-----"),i(),[2];else return[4,xf.gameInfo.init()];case 3:return t.sent(),console.log(JSON.stringify(xf.gameInfo)),[4,xf.isOnline()];case 4:if(!t.sent()){if(1===xf.gameInfo.gameType&&!xfConfig.isPrivate)console.log("--- network offline ---"),i(),window.ononline=function(){console.log("--- network online ---"),window.ononline=null,s.showButton=0,s.start(function(){})};else xf.XfLoginCanvas.setCancleBtnCallback(function(){s.start(i)}),xf.XfLoginCanvas.showAlert(window.trFunc("未能检测到网络连接\n\n请确认网络状态~"));return[2]}if(1==s.loginStatus||2==s.loginStatus)return[2];if(s.startGame=i,"preview"!=xfConfig.exportType)return[3,5];if(0==xf.localApi.getPreviewInfo().login)return console.log("------- preveiw 不需要登录 -------"),s.startGame(),[2];else return console.log("------- preview 开始登录 -------"),s.previewLogin().then(function(t){s.xfLoginSuccess(t)}).catch(function(t){s.xfLoginFail(t)}),[3,10];case 5:if(t.trys.push([5,9,,10]),0!=s.loginStatus&&(4!=s.loginStatus||0!=s.sdkStatus))return[3,7];else return[4,s.initGame()];case 6:return t.sent(),s.loginStatus=1,s.initSdk().then(function(t){xf.EventCenter.instance.sendEvent(new xf.EventData(xf.EventType.SDK_INIT_SUCCESS,t))}).catch(function(t){xf.EventCenter.instance.sendEvent(new xf.EventData(xf.EventType.LOGIN_FAIL,t))}),[3,8];case 7:if(4==s.loginStatus&&1==s.sdkStatus)return xf.EventCenter.instance.sendEvent(new xf.EventData(xf.EventType.SDK_INIT_SUCCESS,"")),[2];t.label=8;case 8:return[3,10];case 9:return e=t.sent(),s.xfLoginFail(e),[3,10];case 10:return xf.EventCenter.instance.addEventListener(xf.EventType.LOGIN_SUCCESS,s.xfLoginSuccess,s),xf.EventCenter.instance.addEventListener(xf.EventType.LOGIN_FAIL,s.xfLoginFail,s),xf.EventCenter.instance.addEventListener(xf.EventType.SDK_INIT_SUCCESS,s.sdkInitSuccess,s),xf.EventCenter.instance.addEventListener(xf.EventType.SDK_LOGIN_SUCCESS,s.sdkLoginSuccess,s),xf.EventCenter.instance.addEventListener(xf.EventType.SDK_LOGOUT,s.xfLogout,s),xf.EventCenter.instance.addEventListener(xf.EventType.SDK_SWITCH_ACCOUNT,s.sdkSwitchAccount,s),[2]}})})},s.sdkInitSuccess=function(t){return n(this,void 0,void 0,function(){var e;return a(this,function(t){switch(t.label){case 0:return console.log("----------- sdk初始化成功 -----------"),[4,xf.localApi.getChannelId()];case 1:if(e=t.sent())s.loginStatus=2,s.sdkStatus=1,xf.gameInfo.setChannelId(e),s.loginSdk();else s.xfLoginFail("获取渠道id失败");return[2]}})})},s.sdkLoginSuccess=function(t){console.log("----------- sdk登录成功 -----------"),this.hideH5Ball(),o.default.loginCheck(t)},s.sdkSwitchAccount=function(t){console.log("----------- sdk切换账号 -----------"),o.default.loginCheck(t)},s.xfLoginSuccess=function(i){return n(this,void 0,void 0,function(){var e;return a(this,function(t){if(console.log("----------- 游戏登录成功 -----------"),window.Bugly)window.Bugly.setUserId(i.playerId);if(s.loginStatus=3,s.showButton)xf.XfLoginCanvas.destroyButton();if("preview"==window.xfConfig.exportType)xf.gameInfo.setPreviewPlayerInfo(i);else e=i.messageData?i.messageData:i,xf.gameInfo.setPlayerInfo(e),s.startRefreshTokenTimer(),s.reportSDKLoginSuccess();return s.initCloudLadder().then(function(){var t=xf.gameInfo.createTime||(new Date).getTime();if(0==xf.gameInfo.isFirstLogin)xf.cloudLadderSDK.doReportLogin(xf.gameInfo.playerId,t);else xf.cloudLadderSDK.doReportSignUp(xf.gameInfo.playerId,t)}).catch(function(t){window.Sentry.captureMessage(t)}),console.log("---- 进入游戏 ----"),s.startGame(),[2]})})},s.getCurrentTime=function(){return n(this,void 0,void 0,function(){return a(this,function(t){return[2,new Promise(function(i,t){xf.webApi.getServerTime().then(function(t){var e=new Date(t.currentTime.replace(/-/g,"/")).getTime();console.log("当前服务器时间:",e," 与本机时间差(毫秒):",e-Date.now()),i(e)},function(){t(NaN)})})]})})},s.startRefreshTokenTimer=function(){return n(this,void 0,void 0,function(){var e,i,n,r,o;return a(this,function(t){switch(t.label){case 0:if(!(e=xf.gameInfo.token.split(".")[1]))return[3,2];else return clearTimeout(l),i=new u.default,n=JSON.parse(i.base64decode(e)),[4,s.getCurrentTime()];case 1:r=t.sent(),o=n.expMs-r-12e4,o=isNaN(o)||o<6e5?36e5:o,console.log("刷新token倒计时(毫秒):",o),l=setTimeout(function(){s.refreshToken()},o),t.label=2;case 2:return[2]}})})},s.refreshToken=function(){xf.webApi.refreshToken({userID:xf.gameInfo.playerId,token:xf.gameInfo.token,gameId:xf.gameInfo.gameId,platform:xf.gameInfo.platform,deviceId:xf.gameInfo.deviceId,gameVersion:xf.gameInfo.version}).then(function(t){xf.gameInfo.token=t.dramaToken,s.startRefreshTokenTimer()})},s.hideH5Ball=function(){var t=window.xsSdk;if(1==xf.gameInfo.gameType&&t&&t.hideBall)if(xf.gameInfo.isSecret)console.log("--- h5 显示悬浮 ---"),t.hideBall(!1);else console.log("--- h5 隐藏悬浮 ---"),t.hideBall(!0)},s.xfLoginFail=function(t){console.log("----------- 游戏登录失败 -----------"),s.loginStatus=4;var e=t.messageData?t.messageData:t;if(console.error(e),1==xf.gameInfo.gameType&&!xf.gameInfo.isSecret)s.startGame();else xf.XfLoginCanvas.setCancleBtnCallback(function(){window.location.reload()}),xf.XfLoginCanvas.showAlert(e.errInfo.message)},s.xfLogout=function(t){if(console.log("----------- 游戏登出 -----------"),console.error(t),xf.cloudLadderSDK.doReportLogout(),window.location.reload(),window.Bugly)window.Bugly.setUserId("")},s.previewLogin=function(){return n(this,void 0,void 0,function(){var e,i,n;return a(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),e=xf.gameInfo,[4,xf.webApi.previewLogin({gameId:e.gameId,userId:e.previewUserId,token:e.previewUserToken,editorVersion:e.editorVersion})];case 1:if((i=t.sent())&&i.item)return[2,Promise.resolve(i.item)];else return[2,Promise.reject("登录失败：获取用户信息失败")];case 2:return n=t.sent(),[2,Promise.reject(n)];case 3:return[2]}})})},s.initGame=function(){return n(this,void 0,void 0,function(){var e,i,n;return a(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),e=xf.gameInfo,[4,xf.webApi.initGame({gameId:e.gameId,platform:e.platform,fingerprint:e.fingerprint,gameVersion:e.version})];case 1:return i=t.sent(),console.log("--- init info "+JSON.stringify(i)+" ---"),e.setGameInfo(i),[2,Promise.resolve(e)];case 2:return n=t.sent(),[2,Promise.reject(n)];case 3:return[2]}})})},s.initSdk=function(){return n(this,void 0,void 0,function(){var e;return a(this,function(t){switch((e=window.xfConfig).exportType){case"preview":return[2,Promise.resolve("preview")];case"h5":case"electron":case"minigame":return[2,r.default.initXingshiSDK(e.exportType)];case"cordova":return[2,r.default.initCordovaSDK()]}return[2,Promise.reject("初始化 SDK 失败，渠道参数无效!")]})})},s.loginSdk=function(){switch(window.xfConfig.exportType){case"h5":case"electron":case"minigame":o.default.userXingshiLogin();break;case"cordova":o.default.userCordovaLogin()}},s.reportSDKGameData=function(t){var e={event:t,roleName:xf.gameInfo.characterName||xf.gameInfo.characterId||xf.gameInfo.playerId,roleId:xf.gameInfo.characterId||xf.gameInfo.playerId,roleLevel:"0",serverId:"1",serverName:""};if(window.xsSdk&&window.xsSdk.dataReport)window.xsSdk.dataReport(e)},s.reportSDKLoginSuccess=function(){if(xf.gameInfo.isFirstLogin)s.reportSDKGameData(1);else s.reportSDKGameData(5);s.reportSDKGameData(2)},s.initCloudLadder=function(){return new Promise(function(t,e){if("preview"!=xfConfig.exportType){xf.cloudLadderSDK.init({preview:"browser",h5:"browser",cordova:"cordova",electron:"electron"}[xfConfig.exportType],{uid:xf.gameInfo.playerId||"",appVersion:xf.gameInfo.version||"0.0.0",channelId:xf.gameInfo.channelId,subChannelId:xfConfig.cloudLadder.subChannelId,extChannelId:xfConfig.cloudLadder.extChannelId,globalConfig:{gameid:String(xf.gameInfo.gameId),devid:String(xf.gameInfo.devId),flag:Number(xf.gameInfo.isRelease),pkg:xfConfig.pkgId||""},host:xfConfig.cloudLadder.host,appId:xfConfig.cloudLadder.appId,appSecret:xfConfig.cloudLadder.appSecret}).then(function(){xf.cloudLadderSDK.doReportStartup(),t()}).catch(function(t){e(t)})}else t()})},s.showButton=window.cordova&&1!==window.xfConfig.gameType?1:0,s.loginStatus=0,s.sdkStatus=0,s.Permission=c.default,s}();e.EvkLogin=s,e.default=s,xf.EvkLogin=s}}),function(xf){var t=function(){function c(){}return c.init=function(){var t=this;if(xf.gameInfo.playerId&&!xfConfig.outline)this.getList().then(function(){if(!t.list.length)return!1;t.showBulletin(0)})},c.showBulletin=function(i){var n=this,t=this.list[i],e=t.contentHtml,r=t.buttonHtml,o=t.titleHtml,s=t.id,a=t.displayFreq;if(this.isShowed(s)&&0==a){var l=++i;if(l<c.list.length)c.showBulletin(l);else console.log(i,"最后一个了")}xf.xfBulletin.instance.show({callback:function(t){t.dismiss(),n.savaShowId(s);var e=++i;if(e<c.list.length)c.showBulletin(e);else c.list=[],console.log(i,"最后一个了")},contentText:e,parent:this,title:o,btnText:r})},c.showSingleBulletin=function(t,e){try{var i=t.contentHtml,n=t.buttonHtml,r=t.titleHtml,o=t.id,s=t.displayFreq,a=t.displayType,l=t.status;if(this.isShowed(o)&&0==s||0==a||4!=l)return void(e&&e(2));var c=new xf.xfBulletin;c.show({callback:function(t){c.dismiss(),c=null,e&&e(3)},contentText:i,parent:this,title:r,btnText:n}),e&&e(1)}catch(t){e&&e(2)}},c.isShowed=function(e){var t=window.localStorage.getItem("xf-notice-show-ids");if(t)return(t=JSON.parse(t)).some(function(t){return t=="xf-"+e+"-xf"});else return!1},c.savaShowId=function(t){if(!this.isShowed(t)){var e=window.localStorage.getItem("xf-notice-show-ids");if(!(e=JSON.parse(e)))e=[];e.push("xf-"+t+"-xf"),window.localStorage.setItem("xf-notice-show-ids",JSON.stringify(e))}},c.getList=function(){return new Promise(function(e,i){xf.webApi.queryBulletinList().then(function(t){c.list=t.list,e()}).catch(function(t){i(t)})})},c.getBulletin=function(t,e){xf.webApi.queryBulletin(t).then(function(t){c.bulletin=t.item,c.showSingleBulletin(t.item,e)}).catch(function(t){e&&e(2)})},c.list=[],c}();xf.bulletinManager=t}(xf||(xf={})),function(xf){var i=!1,n=!1,t=function(){function t(){this.gettingConfig=!1}return Object.defineProperty(t,"instance",{get:function(){if(null==t.s_instance)t.s_instance=new t;return t.s_instance},enumerable:!0,configurable:!0}),t.prototype.windowSizeChange=function(){var e=this;if(!window.xfruntime.isMobile&&"h5"===xfConfig.exportType&&this.needToShowBanner()){if(!this.gettingConfig&&!this.h5Config)return this.gettingConfig=!0,void this.getH5WhiteConfig();if(this.h5Config)switch(this.direction){case"top":if(!this.topBannerDom&&!i)i=!0,this.creatParentDom("top").then(function(t){e.topBannerDom=t}),this.creatParentDom("bottom").then(function(t){e.bottomBannerDom=t});else if(this.topBannerDom&&this.bottomBannerDom)this.topBannerDom.parent.style.display="block",this.bottomBannerDom.parent.style.display="block",this.changePositon(this.topBannerDom),this.changePositon(this.bottomBannerDom);break;case"left":if(!this.leftBannerDom&&!n)n=!0,this.creatParentDom("left").then(function(t){e.leftBannerDom=t}),this.creatParentDom("right").then(function(t){e.rightBannerDom=t});else if(this.leftBannerDom&&this.rightBannerDom)this.leftBannerDom.parent.style.display="block",this.rightBannerDom.parent.style.display="block",this.changePositon(this.leftBannerDom),this.changePositon(this.rightBannerDom)}}},t.prototype.changePositon=function(t){var e=t.background,i=t.buttons,n=window.innerWidth/e.attributes.originWidth;if("left"==this.direction)n=window.innerHeight/e.attributes.originHeight,e.style.width=e.attributes.originWidth*n+"px";i.forEach(function(t){t.style.width=t.attributes.originWidth*n+"px",t.style.top=t.attributes.originY*n+"px",t.style.left=t.attributes.originX*n+"px"})},t.prototype.getH5WhiteConfig=function(){var e=this;xf.webApi.getPcWhiteConfig(xf.gameInfo.gameId).then(function(t){if(e.gettingConfig=!1,t.item)e.h5Config=JSON.parse(t.item),e.windowSizeChange()}).catch(function(t){e.gettingConfig=!1,console.log("获取背景banner数据失败",JSON.stringify(t))})},t.prototype.needToShowBanner=function(){var t=window.xfruntime.canvas,e=parseInt(t.style.width),i=parseInt(t.style.height),n=window.innerWidth,r=window.innerHeight;if(this.topHeight=(r-i)/2,this.topWidth=(n-e)/2,this.topHeight/n>1/8)return this.direction="top",this.hideLeftAndRight(),!0;else this.hideTopAndBottom();if(this.topWidth/r>5/9)return this.direction="left",this.hideTopAndBottom(),!0;else this.hideLeftAndRight();return!1},t.prototype.hideTopAndBottom=function(){this.topBannerDom&&(this.topBannerDom.parent.style.display="none"),this.bottomBannerDom&&(this.bottomBannerDom.parent.style.display="none")},t.prototype.hideLeftAndRight=function(){this.leftBannerDom&&(this.leftBannerDom.parent.style.display="none"),this.rightBannerDom&&(this.rightBannerDom.parent.style.display="none")},t.prototype.creatParentDom=function(t){var s=this;return new Promise(function(n){var r=document.createElement("div");r.className="blank-"+t;var o=s.h5Config[t];s.creatBackground(r,o.backgroundImg,function(t,e){var i=s.buttonImage(r,o.button,t);document.body.appendChild(r),n({parent:r,background:e,buttons:i})})})},t.prototype.creatBackground=function(t,e,i){var n=this,r=document.createElement("img");r.src=e,r.className="background",r.onload=function(){r.attributes.originWidth=r.width,r.attributes.originHeight=r.height;var t=window.innerWidth/r.width;if(r.style.width="100%","left"==n.direction)t=window.innerHeight/r.height,r.style.width=r.width*t+"px";i(t,r)},t.appendChild(r)},t.prototype.buttonImage=function(n,t,r){var o=[];if(!([]instanceof Array&&t.length))return null;else return t.forEach(function(t){var e=document.createElement("img"),i=document.createElement("a");i.target="_blank",i.href=t.link,e.className="button-img",e.src=t.images.normal,e.style.top=t.position.y*r+"px",e.style.left=t.position.x*r+"px",e.attributes.firstLoad=1,e.addEventListener("mouseover",function(){e.src=t.images.hover?t.images.hover:t.images.normal}),e.addEventListener("mouseout",function(){e.src=t.images.normal}),e.addEventListener("mousedown",function(){e.src=t.images.pressed?t.images.pressed:t.images.normal}),e.addEventListener("mouseup",function(){e.src=t.images.normal}),e.onload=function(){if(1==e.attributes.firstLoad)e.attributes.firstLoad=0,e.attributes.originWidth=e.width,e.attributes.originX=t.position.x,e.attributes.originY=t.position.y,e.style.width=e.width*r+"px"},o.push(e),i.appendChild(e),n.appendChild(i)}),o},t}();xf.pcWhiteSpace=t}(xf||(xf={}));var __extends=(jDc=function(t,e){return(jDc=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]})(t,e)},function(t,e){function i(){this.constructor=t}jDc(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),jDc,xf,xf;!function(xf){var t=function(i){function t(){var t=i.call(this)||this,e=new xf.xfImage;return t.m_background=e,t.addChild(e),t.m_fillColor="#fafafa",t.m_borderColor="#000000",t.m_shadow=10,t.m_border=0,t.m_radius=0,t}return __extends(t,i),Object.defineProperty(t.prototype,"fillColor",{get:function(){return this.m_fillColor},set:function(t){this.m_fillColor=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"border",{get:function(){return this.m_border},set:function(t){this.m_border=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"borderColor",{get:function(){return this.m_borderColor},set:function(t){this.m_borderColor=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"shadow",{get:function(){return this.m_shadow},set:function(t){this.m_shadow=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"radius",{get:function(){return this.m_radius},set:function(t){this.m_radius=t},enumerable:!0,configurable:!0}),t.prototype.init=function(){i.prototype.init.call(this),this.resize(),this.m_background.source=xf.drawImage(this.width,this.height,this.m_fillColor,this.m_border,this.m_borderColor,this.m_shadow,1,this.radius)},t.prototype.resize=function(){var t=this.m_background;if(t.width=this.width,t.height=this.height,0<this.m_shadow)t.anchorOffsetX=this.m_shadow+this.m_border,t.anchorOffsetY=this.m_shadow+this.m_border,t.width=t.width+2*this.m_shadow+2*this.m_border,t.height=t.height+2*this.m_shadow+2*this.m_border},t.prototype.destory=function(){if(this.m_background)this.m_background.destory(),this.m_background=null;i.prototype.destory.call(this)},t}(xf.xfContainer);xf.xfFrame=t}(xf||(xf={})),function(xf){var n=0,r=0,o=0,s=!1,t=function(){function t(){this.runtime=window.xfruntime;var t=this.runtime.original_width,e=this.runtime.original_height;this.width=e<t?.6*t:.8*t,this.height=e<t?.8*e:.5*t,this.x=(t-this.width)/2,this.y=(e-this.height)/2,this.drawInit()}return t.prototype.drawInit=function(){var t=.15*this.height,e=.7*this.height,i=.15*this.height,n=new xf.xfContainer;(this.container=n).x=this.x,n.y=this.y;var r=new xf.xfFrame;r.fillColor="#242740",r.shadow=0,r.width=this.width,r.height=this.height;var o=xf.TextStyle.create(),s=new xf.xfText(o);(this.titleTextGl=s).width=this.width,s.height=t;var a=new xf.xfContainer;a.x=0,a.y=t,a.width=this.width,a.height=e,this.contentContainer=a;var l=xf.TextStyle.create();l.vAlign=xf.VerticalAlign.TOP,l.hAlign=xf.HorizontalAlign.LEFT;var c=new xf.xfText(l);(this.contentTextGl=c).width=this.width,c.height=e,a.addChild(c);var u=new xf.xfContainer;(this.closeBtnContainer=u).width=.4*this.width,u.height=i,u.x=(this.width-u.width)/2,u.y=.85*this.height;var h=new xf.xfFrame;h.shadow=0,h.fillColor="#FC425F",h.width=.4*this.width,h.height=.8*i,h.y=.1*i;var d=new xf.xfText;(this.buttonTextGl=d).width=.4*this.width,d.height=.8*i,d.y=.1*i,u.addChild(h),u.addChild(d),n.addChild(r),n.addChild(s),n.addChild(a),n.addChild(u)},t.prototype.show=function(t){if(this.showParams=t,this.titleTextGl.richText=t.title,this.contentTextGl.richText=t.contentText,this.textHeight=this.contentTextGl.textHeight,this.scrollRatio=this.contentTextGl.height/this.textHeight,this.buttonTextGl.richText=t.btnText,this.click_ref=this.handleMouseDown.bind(this),this.runtime.isMobile){if(xf.getSupportsPassive())this.runtime.canvas.addEventListener("touchstart",this.click_ref,{passive:!0});else this.runtime.canvas.addEventListener("touchstart",this.click_ref)}else this.runtime.canvas.addEventListener("mousedown",this.click_ref);this.container.addRenderList()},t.prototype.dismiss=function(){if(this.container.removeRenderList(),this.runtime.isMobile)this.runtime.canvas.removeEventListener("touchstart",this.click_ref);else this.runtime.canvas.removeEventListener("mousedown",this.click_ref);this.runtime.redraw=!0},t.prototype.handleMouseDown=function(t){var e,i;if(this.runtime.isMobile)e=t.changedTouches[0].pageX,i=t.changedTouches[0].pageY;else e=t.pageX,i=t.pageY;var n=window.drama.convertPageXY(e,i);e=n.pageX,i=n.pageY;var r,o,s=e-this.runtime.canvas.offsetLeft,a=i-this.runtime.canvas.offsetTop,l=this.runtime.layouts,c=l[Object.keys(l)[0]].layers[0];if(r=c.canvasToLayer(s,a,!0),o=c.canvasToLayer(s,a,!1),r>this.x+this.closeBtnContainer.x&&r<this.x+this.closeBtnContainer.x+this.closeBtnContainer.width&&o>this.y+this.closeBtnContainer.y&&o<this.y+this.closeBtnContainer.y+this.closeBtnContainer.height)this.runtime.is_catch_event=!0,this.showParams.callback&&this.showParams.callback.apply(this.showParams.parent,[this]);else if(r>this.x+this.contentContainer.x&&r<this.x+this.contentContainer.x+this.contentContainer.width&&o>this.y+this.contentContainer.y&&o<this.y+this.contentContainer.y+this.contentContainer.height)this.onContentMouseDown(t)},t.prototype.onContentMouseDown=function(t){t.preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation(),this.onDragStart(t),window.xfruntime.canvas.addEventListener("mousemove",this.onDragging.bind(this)),window.xfruntime.canvas.addEventListener("touchmove",this.onDragging.bind(this)),window.xfruntime.canvas.addEventListener("mouseup",this.onDragEnd.bind(this)),window.xfruntime.canvas.addEventListener("touchend",this.onDragEnd.bind(this)),window.xfruntime.canvas.addEventListener("contextmenu",this.onDragEnd.bind(this))},t.prototype.onDragStart=function(t){if(s=!0,"touchstart"===t.type){var e=window.drama.convertPageXY(t.touches[0].clientX,t.touches[0].clientY);t.clientY=e.pageY,t.clientX=e.pageX}n=t.clientY},t.prototype.onDragging=function(t){if(s){var e;if("touchmove"===t.type){var i=window.drama.convertPageXY(t.touches[0].clientX,t.touches[0].clientY);t.clientY=i.pageY,t.clientX=i.pageX}if(e=(t.clientY-n)/this.scrollRatio*.5,o=r+e,Math.abs(o-this.contentTextGl.height)>this.textHeight)o=this.contentTextGl.height-this.textHeight;if(0<o)o=0;this.contentTextGl.scrollY=o}},t.prototype.resetScroll=function(t){var e=!1;if(0==t)return 0;else if(0<t)t-=10;else t+=10,e=!0;var i=t,n=t;if(Math.abs(t)-10<0){if(0<o)n=0;else n=this.contentTextGl.height-this.textHeight;i=0}if(e)n=this.contentTextGl.height-this.textHeight-t;return console.log(n),this.contentTextGl.scrollY=n,i},t.prototype.onDragEnd=function(){if(s)setTimeout(function(){s=!1},0),r=o,window.xfruntime.canvas.removeEventListener("mousemove",this.onDragging),window.xfruntime.canvas.removeEventListener("touchmove",this.onDragging),window.xfruntime.canvas.removeEventListener("mouseup",this.onDragEnd),window.xfruntime.canvas.removeEventListener("touchend",this.onDragEnd),window.xfruntime.canvas.removeEventListener("contextmenu",this.onDragEnd)},Object.defineProperty(t,"instance",{get:function(){if(!t.s_instance)t.s_instance=new t;return t.s_instance},enumerable:!0,configurable:!0}),t}();xf.xfBulletin=t}(xf||(xf={}));var __extends=(JEc=function(t,e){return(JEc=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]})(t,e)},function(t,e){function i(){this.constructor=t}JEc(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),JEc,__assign=function(){return(__assign=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var r in e=arguments[i])if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r];return t}).apply(this,arguments)},xf;!function(xf){var r,t,o,e,s;t=r=xf.MessageBox||(xf.MessageBox={}),(e=o=t.Action||(t.Action={})).CONFIRM="confirm",e.CANCEL="cancel",e.CLOSE="close",t.alert=function(n,r){if(void 0===r)r={};if(!s)s=new a;return new Promise(function(e,t){var i=__assign({},r,{callback:function(t){if(r.callback&&"function"==typeof r.callback&&r.callback(t),t===o.CONFIRM)e(t);else e(t)},showCancelButton:!1,showConfirmButton:!0});s.show(n,i)})},t.confirm=function(n,r){if(void 0===r)r={};if(!s)s=new a;return new Promise(function(e,t){var i=__assign({},r,{callback:function(t){if(r.callback&&"function"==typeof r.callback&&r.callback(t),t===o.CONFIRM)e(t);else e(t)},showCancelButton:!0,showConfirmButton:!0});s.show(n,i)})},t.isMessageBoxShow=function(){return s&&s.isUnderRenderList()};var i={width:280,height:248,maxHeight:414},h={width:i.width/375,height:i.height/812,maxHeight:i.maxHeight/812,close:{width:26/i.width,height:26/i.height,x:246/i.width,y:8/i.height},title:{width:232/i.width,height:28/i.height,x:24/i.width,y:24/i.height,fontSize:20*window.devicePixelRatio},content:{width:232/i.width,height:140/i.height,maxHeight:280/i.maxHeight,x:24/i.width,y:60/i.height,fontSize:16*window.devicePixelRatio},actBtn:{width:76/i.width,height:30/i.height,x:106/i.width,y:205/i.height,marginRight:7/i.width,fontSize:14*window.devicePixelRatio,radius:4}},d=__assign({},h,{width:i.width/812,height:i.height/375,maxHeight:i.maxHeight/375}),p={width:(i={width:630,height:560,maxHeight:820}).width/1080,height:i.height/1920,maxHeight:i.maxHeight/1920,close:{width:50/i.width,height:50/i.height,x:560/i.width,y:20/i.height},title:{width:520/i.width,height:48/i.height,x:53/i.width,y:80/i.height,fontSize:34},content:{width:520/i.width,height:280/i.height,x:53/i.width,y:150/i.height,fontSize:30},actBtn:{width:193/i.width,height:67/i.height,x:175/i.width,y:463/i.height,marginRight:20/i.width,fontSize:28,radius:4}},f=__assign({},p,{width:i.width/1920,height:i.height/1080}),a=function(u){function t(){var i=u.call(this)||this;i.defaultOpts={showCancelButton:!1,showConfirmButton:!0,confirmButtonText:window.trFunc("确认"),cancelButtonText:window.trFunc("取消")};var t=i.p_runtime;if(1===i.p_runtime.orientations)i.style=window.xfruntime.isMobile?h:p;else if(2===i.p_runtime.orientations)i.style=window.xfruntime.isMobile?d:f;else i.style=f;i.width=t.original_width*i.style.width,i.height=t.original_height*i.style.height,i.x=.5*(t.original_width-i.width),i.y=.5*(t.original_height-i.height),i.radius=4*window.xfruntime.devicePixelRatio,i.shadow=15;var e=xf.TextStyle.create();e.vAlign=xf.VerticalAlign.TOP,e.hAlign=xf.HorizontalAlign.LEFT,e.color="#161830",e.isBold=!0,e.size=i.style.title.fontSize/i.p_runtime.aspect_scale,i.m_title=new xf.xfText(e),i.m_title.alpha=1,i.m_title.text="",i.addChild(i.m_title);var n=xf.TextStyle.create();n.vAlign=xf.VerticalAlign.TOP,n.hAlign=xf.HorizontalAlign.LEFT,n.color="#484A5C",n.size=i.style.content.fontSize/i.p_runtime.aspect_scale,i.m_content=new xf.xfText(n),i.m_content.alpha=1;var r=new xf.xfScroller;i.addChild(r),(i.m_scroller=r).direction=xf.ScrollDirection.VERTICAL,r.touchedOuter=!0;var o=new xf.xfContainer;r.setContentView(o),o.height=i.height,o.addChild(i.m_content),r.autoControl=!1,r.onScroll=function(t){var e=i.m_content.scrollY+t.offsetY;if(!(i.textHeight<=i.m_content.height))if(-e>i.textHeight-i.m_content.height)i.m_content.scrollY=-(i.textHeight-i.m_content.height);else if(0<=e)i.m_content.scrollY=0;else if(e<0)i.m_content.scrollY=e};var s=i.width*i.style.actBtn.width,a=i.width*i.style.actBtn.height,l=i.style.actBtn.radius;i.m_confirmBtn=new xf.xfUIButton(xf.drawImage(s,a,"#FC425F",0,"",0,1,l),xf.drawImage(s,a,"#EE314F",0,"",0,1,l),xf.drawImage(s,a,"#DA1C3A",0,"",0,1,l)),i.addChild(i.m_confirmBtn),i.m_confirmBtn.visible=!1,i.m_cancelBtn=new xf.xfUIButton(xf.drawImage(s,a,"#242741",0,"",0,1,l),xf.drawImage(s,a,"##1C2041",0,"",0,1,l),xf.drawImage(s,a,"#151941",0,"",0,1,l)),i.addChild(i.m_cancelBtn),i.m_cancelBtn.visible=!1;var c="assets/common-images/btn-close.png";return i.m_closeBtn=new xf.xfUIButton(c,c,c,c),i.addChild(i.m_closeBtn),i.m_closeBtn.visible=!1,i}return __extends(t,u),t.prototype.init=function(){if(u.prototype.init.call(this),this.m_title.x=this.width*this.style.title.x,this.m_title.y=this.height*this.style.title.y,this.m_title.width=this.width*this.style.title.width,this.m_title.height=this.height*this.style.title.height,this.m_closeBtn.x=this.width*this.style.close.x,this.m_closeBtn.y=this.height*this.style.close.y,this.m_closeBtn.width=this.width*this.style.close.width,this.m_closeBtn.height=this.width*this.style.close.width,this.m_content.x=0,this.m_content.y=1,this.m_content.width=this.width*this.style.content.width,""===this.m_title.text)this.m_scroller.y=this.height*(this.style.content.y/2),this.m_content.height=this.height*(this.style.content.height+this.style.content.y/2);else this.m_scroller.y=this.height*this.style.content.y,this.m_content.height=this.height*this.style.content.height;this.textHeight=this.m_content.textHeight,this.m_scroller.x=this.width*this.style.content.x,this.m_scroller.width=this.m_content.width,this.m_scroller.height=this.m_content.textHeight,this.m_scroller.setVisibleRect(xf.Rect.create(0,0,this.m_content.width,this.m_content.height)),this.m_cancelBtn.width=this.width*this.style.actBtn.width,this.m_cancelBtn.height=this.height*this.style.actBtn.height,this.m_cancelBtn.x=this.width*this.style.actBtn.x,this.m_cancelBtn.y=this.height*this.style.actBtn.y,this.m_confirmBtn.width=this.width*this.style.actBtn.width,this.m_confirmBtn.height=this.height*this.style.actBtn.height,this.m_confirmBtn.x=this.m_cancelBtn.x+this.m_confirmBtn.width+this.style.actBtn.marginRight*this.width,this.m_confirmBtn.y=this.height*this.style.actBtn.y},t.prototype.show=function(t,e){var i=this,n=__assign({},this.defaultOpts,e);if(this.m_confirmBtn.setText(n.confirmButtonText,this.style.actBtn.fontSize/this.p_runtime.aspect_scale),this.m_cancelBtn.setText(n.cancelButtonText,this.style.actBtn.fontSize/this.p_runtime.aspect_scale),this.m_content.text=t,this.m_title.text=n.title||"",this.m_confirmBtn.setCallback(function(){if(i.m_confirmBtn.state==xf.ButtonState.PRESSED)i.close(n,r.Action.CONFIRM)},this),this.m_cancelBtn.setCallback(function(){if(i.m_cancelBtn.state==xf.ButtonState.PRESSED)i.close(n,r.Action.CANCEL)},this),this.m_closeBtn.setCallback(function(){if(i.m_closeBtn.state==xf.ButtonState.PRESSED)i.close(n,r.Action.CANCEL)},this),n.showConfirmButton)this.m_confirmBtn.visible=!0;if(n.showCancelButton)this.m_cancelBtn.visible=!0;if(n.showCloseButton)this.m_closeBtn.visible=!0;this.addRenderList()},t.prototype.close=function(t,e){this.m_confirmBtn.visible=!1,this.m_cancelBtn.visible=!1,this.m_closeBtn.visible=!1,this.m_confirmBtn.state=xf.ButtonState.NORMAL,this.m_cancelBtn.state=xf.ButtonState.NORMAL,t.callback&&t.callback(e),this.removeRenderList()},t}(xf.xfFrame)}(xf||(xf={}));var __extends=(UFc=function(t,e){return(UFc=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]})(t,e)},function(t,e){function i(){this.constructor=t}UFc(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),UFc,xf;!function(xf){var t=function(n){function t(){var t=n.call(this)||this;t.m_effectTimerID=-1,t.m_delyTimerID=-1,t.fillColor="#888888",t.radius=10;var e=xf.TextStyle.create();e.vAlign=xf.VerticalAlign.MIDDLE,e.hAlign=xf.HorizontalAlign.LEFT,e.size=40,e.color="#FFFFFF";var i=new xf.xfText(e);return t.m_text=i,t.addChild(i),t}return __extends(t,n),t.prototype.destory=function(){if(n.prototype.destory.call(this),this.m_text=null,this.m_text)this.m_text.destory(),this.m_text=null},Object.defineProperty(t,"instance",{get:function(){if(!xf.xfToast.s_instance)xf.xfToast.s_instance=new xf.xfToast;return xf.xfToast.s_instance},enumerable:!0,configurable:!0}),t.prototype.setContext=function(t){var e=this;this.m_text.text=t,this.m_text.width=this.m_text.textWidth+40,this.m_text.height=80,this.width=this.m_text.width,this.height=this.m_text.height;var i=this.p_runtime;this.x=.5*(i.original_width-this.width),this.y=.5*(i.original_height-this.height),this.resize(),this.addRenderList(),clearTimeout(this.m_delyTimerID),clearInterval(this.m_effectTimerID),this.alpha=1,this.m_delyTimerID=setTimeout(function(){e.m_effectTimerID=setInterval(function(){if(e.alpha-=.1,e.alpha<=0)e.removeRenderList()},50)},1e3)},t}(xf.xfFrame);xf.xfToast=t}(xf||(xf={}));var __extends=(oGc=function(t,e){return(oGc=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]})(t,e)},function(t,e){function i(){this.constructor=t}oGc(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),oGc,xf;!function(xf){var t,e=function(s){function t(t,e,i,n){var o=s.call(this)||this;if(o.onMove=function(t){if(o.visible&&o.m_state!==xf.ButtonState.DISABLED){if(o.root.owner){if(!o.root.owner.visible&&o.p_runtime.drawlist.indexOf(o.root)<0)return}else if(!o.root.visible||o.p_runtime.drawlist.indexOf(o.root)<0)return;var e,i;if(o.p_runtime.isMobile)e=t.changedTouches[0].pageX,i=t.changedTouches[0].pageY;else e=t.pageX,i=t.pageY;var n=o.getBounds(),r=xf.pageToGlobal(e,i);if(n.contains(r.x,r.y))o.state=xf.ButtonState.HOVER;else o.state=xf.ButtonState.NORMAL}},o.onPressed=function(t){if(o.visible&&o.m_state!==xf.ButtonState.DISABLED){if(o.root.owner){if(!o.root.owner.visible&&o.p_runtime.drawlist.indexOf(o.root)<0)return}else if(!o.root.visible||o.p_runtime.drawlist.indexOf(o.root)<0)return;var e,i;if(o.p_runtime.isMobile)e=t.changedTouches[0].pageX,i=t.changedTouches[0].pageY;else e=t.pageX,i=t.pageY;var n=o.getBounds(),r=xf.pageToGlobal(e,i);if(n.contains(r.x,r.y))o.state=xf.ButtonState.PRESSED}},o.onTouched=function(t){if(o.visible&&o.m_state!==xf.ButtonState.DISABLED){if(o.root.owner){if(!o.root.owner.visible&&o.p_runtime.drawlist.indexOf(o.root)<0)return}else if(!o.root.visible||o.p_runtime.drawlist.indexOf(o.root)<0)return;var e,i;if(o.p_runtime.isMobile)e=t.changedTouches[0].pageX,i=t.changedTouches[0].pageY;else e=t.pageX,i=t.pageY;var n=o.getBounds(),r=xf.pageToGlobal(e,i);if(n.contains(r.x,r.y))o.state=xf.ButtonState.NORMAL}},o.m_state=xf.ButtonState.NORMAL,t)if("string"==typeof t)xf.createImageLoader(t).then(function(t){if(o.m_normal=t,o.state===xf.ButtonState.NORMAL)o.p_background.source=o.m_normal});else o.m_normal=t;if(e)if("string"==typeof e)xf.createImageLoader(e).then(function(t){if(o.m_hover=t,o.state===xf.ButtonState.HOVER)o.p_background.source=o.m_hover});else o.m_hover=e;if(i)if("string"==typeof i)xf.createImageLoader(i).then(function(t){if(o.m_pressed=t,o.state===xf.ButtonState.PRESSED)o.p_background.source=o.m_pressed});else o.m_pressed=i;if(n)if("string"==typeof n)xf.createImageLoader(n).then(function(t){if(o.m_disabled=t,o.state===xf.ButtonState.DISABLED)o.p_background.source=o.m_disabled});else o.m_disabled=n;o.p_background=new xf.xfImage,o.addChild(o.p_background);var r=xf.TextStyle.create();return r.vAlign="middle",r.hAlign="center",r.color=xf.hexaDecimal([1,1,1,1]),r.size=25,o.p_text=new xf.xfText(r),o.p_text.alpha=1,o.addChild(o.p_text),o}return __extends(t,s),Object.defineProperty(t.prototype,"state",{get:function(){return this.m_state},set:function(t){if(this.m_state!==t)this.m_state=t,this.updateState(this.m_state)},enumerable:!0,configurable:!0}),t.prototype.setText=function(t,e,i,n){if(void 0===n)n=!1;if(n)this.p_text.richText=t;else this.p_text.text=t;if(e)this.p_text.defaultStyle.size=e;if(i)this.p_text.defaultStyle.color=i;this.p_runtime.redraw=!0},t.prototype.setRichText=function(t){this.p_text.richText=t},t.prototype.setCallback=function(t,e){if(t&&e)this.m_callback=t.bind(e)},t.prototype.init=function(){if(s.prototype.init.call(this),!this.m_normal)this.m_normal=xf.drawImage(this.width,this.height,"#fc425f"),this.m_hover=xf.drawImage(this.width,this.height,"#ee314f"),this.m_pressed=xf.drawImage(this.width,this.height,"#da1c3a"),this.m_disabled=xf.drawImage(this.width,this.height,"#d8d8d8");if(this.p_background.width=this.p_width,this.p_background.height=this.p_height,this.p_text.width=this.p_width,this.p_text.height=this.p_height,this.p_runtime.isMobile){if(xf.getSupportsPassive())this.p_runtime.canvas.addEventListener("touchstart",this.onPressed,{passive:!0});else this.p_runtime.canvas.addEventListener("touchstart",this.onPressed);this.p_runtime.canvas.addEventListener("touchend",this.onTouched)}else this.p_runtime.canvas.addEventListener("mousemove",this.onMove),this.p_runtime.canvas.addEventListener("mousedown",this.onPressed),this.p_runtime.canvas.addEventListener("click",this.onTouched);this.updateImage(this.m_state)},t.prototype.updateImage=function(t){switch(t){case xf.ButtonState.NORMAL:this.p_background.source=this.m_normal;break;case xf.ButtonState.HOVER:if(this.m_hover)this.p_background.source=this.m_hover;break;case xf.ButtonState.PRESSED:if(this.m_pressed)this.p_background.source=this.m_pressed;break;case xf.ButtonState.DISABLED:if(this.m_disabled)this.p_background.source=this.m_disabled}},t.prototype.updateState=function(t){if(this.updateImage(t),this.m_callback)this.m_callback(this.state)},t.prototype.destory=function(){if(this.p_background)this.p_background.destory(),this.p_background=null;if(this.p_text)this.p_text.destory(),this.p_text=null;if(this.p_runtime.isMobile)this.p_runtime.canvas.removeEventListener("touchstart",this.onPressed),this.p_runtime.canvas.removeEventListener("touchend",this.onTouched);else this.p_runtime.canvas.removeEventListener("mousemove",this.onMove),this.p_runtime.canvas.removeEventListener("mousedown",this.onPressed),this.p_runtime.canvas.removeEventListener("click",this.onTouched);this.m_callback=null,this.m_normal=null,this.m_hover=null,this.m_pressed=null,this.m_disabled=null,s.prototype.destory.call(this)},t}(xf.xfContainer);xf.xfUIButton=e,(t=xf.ButtonState||(xf.ButtonState={}))[t.NORMAL=0]="NORMAL",t[t.HOVER=1]="HOVER",t[t.PRESSED=2]="PRESSED",t[t.DISABLED=3]="DISABLED"}(xf||(xf={}));var __extends=(pHc=function(t,e){return(pHc=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]})(t,e)},function(t,e){function i(){this.constructor=t}pHc(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),pHc,xf;!function(xf){var t=function(a){function t(){var e=a.call(this)||this;e.m_curNum=1,e.width=390,e.height=300,e.x=e.p_runtime.original_width-e.width>>1,e.y=e.p_runtime.original_height-e.height>>1;var t=xf.TextStyle.create();t.vAlign=xf.VerticalAlign.MIDDLE,t.hAlign=xf.HorizontalAlign.LEFT,t.size=20,t.color="#161830";var i=xf.TextStyle.create();i.vAlign=xf.VerticalAlign.MIDDLE,i.hAlign=xf.HorizontalAlign.CENTER,i.size=25,i.color="#161830";var n=xf.TextStyle.create();n.vAlign=xf.VerticalAlign.MIDDLE,n.hAlign=xf.HorizontalAlign.CENTER,n.size=25,n.color="#909399";var r=xf.TextStyle.create();r.vAlign=xf.VerticalAlign.MIDDLE,r.hAlign=xf.HorizontalAlign.RIGHT,r.size=20,r.color="#484a5c";var o=new xf.xfText(i);o.width=e.width,o.height=60,o.y=20,e.addChild(o),e.m_goodsName=o,(o=new xf.xfText(t)).width=100,o.height=40,o.x=20,o.y=e.m_goodsName.y+e.m_goodsName.height,o.text="购买数量",e.addChild(o);var s=new xf.xfUIButton("assets/common-images/sys_images/subtract-hover.png","assets/common-images/sys_images/subtract-selected.png","assets/common-images/sys_images/subtract.png");s.width=40,s.height=40,s.x=o.x+o.width+20,s.y=o.y,s.setCallback(e.onSubtract,e),e.addChild(s),e.m_subtractBtn=s,(o=new xf.xfText(n)).x=s.x+s.width+10,o.y=s.y,o.width=100,o.height=40,e.addChild(o),e.m_goodsNum=o,(s=new xf.xfUIButton("assets/common-images/sys_images/and-hover.png","assets/common-images/sys_images/and-selecte.png","assets/common-images/sys_images/and.png")).width=40,s.height=40,s.x=o.x+o.width,s.y=o.y,s.setCallback(e.onPlus,e),e.addChild(s),e.m_plusBtn=s,(o=new xf.xfText(t)).width=100,o.height=40,o.x=20,o.y=e.m_goodsNum.y+e.m_goodsNum.height+20,o.text="价格:",e.addChild(o),(o=new xf.xfText(n)).x=e.m_subtractBtn.x,o.y=e.m_goodsNum.y+e.m_goodsNum.height+20,o.width=e.m_plusBtn.x+e.m_plusBtn.width-e.m_subtractBtn.x,o.height=40,e.addChild(o),e.m_goodsPrice=o;return(s=new xf.xfUIButton(xf.drawImage(100,50,"#FC425F",0,"",0,1,4),xf.drawImage(100,50,"#EE314F",0,"",0,1,4),xf.drawImage(100,50,"#DA1C3A",0,"",0,1,4))).setText(window.trFunc("确认")),s.x=e.width-100-60,s.y=e.m_plusBtn.y+e.m_plusBtn.height+100,s.width=100,s.height=50,s.setCallback(function(){if(e.m_confirmBtn.state==xf.ButtonState.PRESSED){e.removeRenderList();var t=e.m_options.callback;if(t)t(xf.MessageBox.Action.CONFIRM,e.m_curNum)}},e),e.addChild(s),e.m_confirmBtn=s,(s=new xf.xfUIButton(xf.drawImage(100,50,"#242741",0,"",0,1,4),xf.drawImage(100,50,"##1C2041",0,"",0,1,4),xf.drawImage(100,50,"#151941",0,"",0,1,4))).setText(window.trFunc("取消")),s.width=100,s.height=50,s.x=60,s.y=e.m_confirmBtn.y,s.setCallback(function(){if(e.m_confirmBtn.state==xf.ButtonState.PRESSED){e.removeRenderList();var t=e.m_options.callback;if(t)t(xf.MessageBox.Action.CANCEL)}},e),e.addChild(s),e.m_cancelBtn=s,e}return __extends(t,a),t.prototype.onSubtract=function(t){if(t===xf.ButtonState.PRESSED)if(1<this.m_curNum)this.m_curNum--,this.updatePrice()},t.prototype.onPlus=function(t){if(t===xf.ButtonState.PRESSED){var e=this.m_goodsInfo.limitNum;if(0===e||this.m_curNum<e)this.m_curNum++,this.updatePrice()}},Object.defineProperty(t,"instance",{get:function(){if(null==t.s_instance)t.s_instance=new t;return t.s_instance},enumerable:!0,configurable:!0}),t.prototype.init=function(){a.prototype.init.call(this);var t=this.m_options;if(t){if(t.confirmButtonText)this.m_confirmBtn.setText(t.confirmButtonText);if(t.cancelButtonText)this.m_confirmBtn.setText(t.cancelButtonText)}var e=this.m_goodsInfo;this.m_goodsName.text=e.goodsName,this.updatePrice()},t.prototype.updatePrice=function(){var t=this.m_goodsInfo;this.m_goodsNum.text=this.m_curNum.toString(),this.m_goodsPrice.text=""+t.price*this.m_curNum+t.currencyType},t.prototype.show=function(t,e){this.m_goodsInfo=t,this.m_options=e,this.m_curNum=1,this.addRenderList()},t.prototype.destory=function(){a.prototype.destory.call(this)},t}(xf.xfFrame);xf.xfGoodsNumSelecter=t}(xf||(xf={}));var __extends=(_Hc=function(t,e){return(_Hc=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]})(t,e)},function(t,e){function i(){this.constructor=t}_Hc(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),_Hc,__assign=function(){return(__assign=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var r in e=arguments[i])if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r];return t}).apply(this,arguments)},xf,xf;!function(xf){var t=function(i){function t(){var t=i.call(this)||this;t.center=!0,t.defaultOpts={showCloseButton:!1},t.radius=4*window.xfruntime.devicePixelRatio,t.shadow=15,t.visible=!1;var e="assets/common-images/btn-close.png";return t.m_closeBtn=new xf.xfUIButton(e,e,e,e),t.addChild(t.m_closeBtn),t.m_closeBtn.visible=!1,t}return __extends(t,i),Object.defineProperty(t.prototype,"height",{get:function(){return this.p_height},set:function(t){if(this.p_height=t,this.center)this.y=.5*(window.xfruntime.original_height-this.height)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this.p_width},set:function(t){if(this.p_width=t,this.center)this.x=.5*(window.xfruntime.original_width-this.width)},enumerable:!0,configurable:!0}),t.prototype.init=function(){i.prototype.init.call(this),this.m_closeBtn.x=246,this.m_closeBtn.y=8,this.m_closeBtn.width=26,this.m_closeBtn.height=26},t.prototype.setContentView=function(t){if(!this.m_contentView)this.m_contentView=t,this.addChild(this.m_contentView),this.m_contentView.x=0,this.m_contentView.y=0},t.prototype.show=function(t){var e=this,i=__assign({},this.defaultOpts,t);if(this.m_closeBtn.setCallback(function(){if(e.m_closeBtn.state==xf.ButtonState.PRESSED)e.close()},this),i.showCloseButton)this.m_closeBtn.visible=!0;this.visible=!0,this.addRenderList()},t.prototype.close=function(){if(this.visible)this.visible=!1,this.m_closeBtn.visible=!1,this.removeRenderList()},t.prototype.destory=function(){if(this.close(),this.m_contentView)this.m_contentView.destory(),this.m_contentView=null;this.m_closeBtn.destory(),this.m_closeBtn=null,i.prototype.destory.call(this)},t}(xf.xfFrame);xf.xfModal=t}(xf||(xf={})),function(xf){var t=function(){function t(){}return t.getRandomInt=function(t){return Math.floor(Math.random()*Math.floor(t))},t.getLastName=function(){if(null===xf.xfNameLibrary.s_LastName){xf.xfNameLibrary.s_LastName="赵钱孙李周吴郑王冯陈褚卫蒋沈韩杨朱秦尤许何吕施张孔曹严华金魏陶姜戚谢邹喻柏水窦章云苏潘葛奚范彭郎鲁韦昌马苗凤花方俞任袁柳酆鲍史唐费廉岑薛雷贺倪汤滕殷罗毕郝邬安常乐于时傅皮卞齐康伍余元卜顾孟平黄和穆萧尹姚邵湛汪祁毛禹狄米贝明臧计伏成戴谈宋茅庞熊纪舒屈项祝董梁杜阮蓝闵席季".split("")}var t=xf.xfNameLibrary.getRandomInt(xf.xfNameLibrary.s_LastName.length);return xf.xfNameLibrary.s_LastName[t]},t.getMaleName=function(){if(null===xf.xfNameLibrary.s_MaleName_s||null===xf.xfNameLibrary.s_MaleName_d){xf.xfNameLibrary.s_MaleName_s="伟刚勇毅俊峰强军平保东文辉力明永健世广志义兴良海山仁波宁贵福生龙元全国胜学祥才发武新利清飞彬".split(""),xf.xfNameLibrary.s_MaleName_d="富顺信子杰涛昌成康星光天达安岩中茂进林有坚和彪博诚先敬震振壮会思群豪心邦承乐绍功松善厚庆磊民友裕河哲江超浩亮政谦亨奇固之轮翰朗伯宏言若鸣朋斌梁栋维启克伦翔旭鹏泽晨辰士以建家致树炎德行时泰盛雄琛钧冠策腾楠榕风航弘".split("")}var t=xf.xfNameLibrary.s_MaleName_s.length+xf.xfNameLibrary.s_MaleName_d.length,e=xf.xfNameLibrary.getRandomInt(2*t),i=xf.xfNameLibrary.getRandomInt(2*t);if(e<xf.xfNameLibrary.s_MaleName_s.length)return xf.xfNameLibrary.s_MaleName_s[e];else if(e<xf.xfNameLibrary.s_MaleName_d.length){var n=e-xf.xfNameLibrary.s_MaleName_s.length;if(n<0)n=0;return xf.xfNameLibrary.s_MaleName_d[n]+xf.xfNameLibrary.s_MaleName_d[n]}else{var r=Math.floor(e%t),o=Math.floor(i%t),s="";if(r<xf.xfNameLibrary.s_MaleName_s.length)s+=xf.xfNameLibrary.s_MaleName_s[r];else{var a=r-xf.xfNameLibrary.s_MaleName_s.length;s+=xf.xfNameLibrary.s_MaleName_d[a]}if(o<xf.xfNameLibrary.s_MaleName_s.length)s+=xf.xfNameLibrary.s_MaleName_s[o];else{a=o-xf.xfNameLibrary.s_MaleName_s.length;s+=xf.xfNameLibrary.s_MaleName_d[a]}return s}},t.getFemaleName=function(){if(null===xf.xfNameLibrary.s_FemaleName_s||null===xf.xfNameLibrary.s_FemaleName_d){xf.xfNameLibrary.s_FemaleName_s="秀娟英华慧巧美娜静淑惠珠翠雅芝玉萍红娥玲芬芳燕彩春菊兰凤洁梅琳素云莲真环雪荣爱妹霞香岚菁梦苑婕馨瑗琰韵融园艺咏卿聪澜纯毓悦昭冰爽琬茗羽希宁欣飘育".split(""),xf.xfNameLibrary.s_FemaleName_d="月莺媛艳瑞凡佳嘉琼勤珍贞莉桂娣叶璧璐娅琦晶妍茜秋珊莎锦黛青倩婷姣婉娴瑾颖露瑶怡婵雁蓓纨仪荷丹蓉眉君琴蕊薇滢馥筠柔竹霭凝晓欢霄枫芸菲寒伊亚宜可姬舒影荔枝思丽".split("")}var t=xf.xfNameLibrary.s_FemaleName_s.length+xf.xfNameLibrary.s_FemaleName_d.length,e=xf.xfNameLibrary.getRandomInt(2*t),i=xf.xfNameLibrary.getRandomInt(2*t);if(e<xf.xfNameLibrary.s_FemaleName_s.length)return xf.xfNameLibrary.s_FemaleName_s[e];else if(e<xf.xfNameLibrary.s_FemaleName_d.length){var n=e-xf.xfNameLibrary.s_FemaleName_s.length;if(n<0)n=0;return xf.xfNameLibrary.s_FemaleName_d[n]+xf.xfNameLibrary.s_FemaleName_d[n]}else{var r=Math.floor(e%t),o=Math.floor(i%t),s="";if(r<xf.xfNameLibrary.s_FemaleName_s.length)s+=xf.xfNameLibrary.s_FemaleName_s[r];else{var a=r-xf.xfNameLibrary.s_FemaleName_s.length;s+=xf.xfNameLibrary.s_FemaleName_d[a]}if(o<xf.xfNameLibrary.s_FemaleName_s.length)s+=xf.xfNameLibrary.s_FemaleName_s[o];else{a=o-xf.xfNameLibrary.s_FemaleName_s.length;s+=xf.xfNameLibrary.s_FemaleName_d[a]}return s}},t.s_LastName=null,t.s_MaleName_s=null,t.s_MaleName_d=null,t.s_FemaleName_s=null,t.s_FemaleName_d=null,t}();xf.xfNameLibrary=t}(xf||(xf={}));var __extends=(cJc=function(t,e){return(cJc=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]})(t,e)},function(t,e){function i(){this.constructor=t}cJc(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),cJc,__assign=function(){return(__assign=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var r in e=arguments[i])if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r];return t}).apply(this,arguments)},xf,xf,window;function _typeof(t){if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator)_typeof=function(t){return typeof t};else _typeof=function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};return _typeof(t)}function _typeof(t){if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator)_typeof=function(t){return typeof t};else _typeof=function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};return _typeof(t)}if(function(xf){var t={width:280,height:92},h={width:t.width/375,height:t.height/812,content:{x:24/t.width,y:8/t.height,width:198/t.width,height:38/t.height,fontSize:14*window.devicePixelRatio},random:{x:230/t.width,y:14/t.height,width:26/t.width,height:26/t.height},actBtn:{y:54/t.height,width:75/t.width,height:30/t.height,fontSize:14*window.devicePixelRatio,radius:4,marginRight:8/t.width}},d=__assign({},h,{width:t.width/812,height:t.height/375}),p={width:(t={width:716,height:207}).width/1080,height:t.height/1920,content:{x:60/t.width,y:20/t.height,width:510/t.width,height:80/t.height,fontSize:30},random:{x:600/t.width,y:20/t.height,width:70/t.width,height:70/t.height},actBtn:{y:120/t.height,width:192/t.width,height:67/t.height,radius:4,fontSize:28,marginRight:20/t.width}},f=__assign({},p,{width:t.width/1920,height:t.height/1080}),e=function(u){function t(){var t=u.call(this)||this,e=t.p_runtime;if(1===t.p_runtime.orientations)t.style=window.xfruntime.isMobile?h:p;else if(2===t.p_runtime.orientations)t.style=window.xfruntime.isMobile?d:f;else t.style=f;t.width=e.original_width*t.style.width,t.height=e.original_height*t.style.height,t.x=.5*(e.original_width-t.width),t.y=.5*(e.original_height-t.height);var i=xf.TextStyle.create();i.vAlign="middle",i.hAlign="center",i.color="#1B1D35",i.backgroundColor="#EEEEEE",i.size=t.style.content.fontSize/t.p_runtime.aspect_scale;var n=new xf.xfText(i);n.x=t.width*t.style.content.x,n.y=t.height*t.style.content.y,n.width=t.width*t.style.content.width,n.height=t.height*t.style.content.height,t.addChild(n),t.m_nickname=n;var r=new xf.xfUIButton("assets/common-images/chance.png","assets/common-images/chance_hover.png","assets/common-images/chance_selected.png");r.width=t.width*t.style.random.width,r.height=t.height*t.style.random.height,r.x=t.width*t.style.random.x,r.y=t.m_nickname.y+.5*(t.m_nickname.height-r.height),r.setCallback(function(){if(t.m_randomBtn.state==xf.ButtonState.PRESSED)t.m_nickname.text=t.getRandomName()},t),t.addChild(r),t.m_randomBtn=r;var o=t.width*t.style.actBtn.width,s=t.height*t.style.actBtn.height,a=t.style.actBtn.radius,l=new xf.xfUIButton(xf.drawImage(o,s,"#FC425F",0,"",0,1,a),xf.drawImage(o,s,"#EE314F",0,"",0,1,a),xf.drawImage(o,s,"#DA1C3A",0,"",0,1,a));(t.cancelBtn=l).width=o,l.height=s,l.x=.5*(t.width-2*l.width-t.style.actBtn.marginRight*t.width),l.y=t.height*t.style.actBtn.y,t.addChild(l),l.setText(window.trFunc("取消"),t.style.actBtn.fontSize/t.p_runtime.aspect_scale),t.cancelBtn.visible=!1;var c=new xf.xfUIButton(xf.drawImage(o,s,"#242741",0,"",0,1,a),xf.drawImage(o,s,"##1C2041",0,"",0,1,a),xf.drawImage(o,s,"#151941",0,"",0,1,a));return(t.m_confirmBtn=c).width=o,c.height=s,c.x=t.cancelBtn.x+t.m_confirmBtn.width+t.style.actBtn.marginRight*t.width,c.y=t.height*t.style.actBtn.y,t.addChild(c),c.setText(window.trFunc("确认"),t.style.actBtn.fontSize/t.p_runtime.aspect_scale),t.m_confirmBtn.visible=!1,t}return __extends(t,u),t.prototype.getRandomName=function(){var t=xf.xfNameLibrary.getRandomInt(2);if(0===t)return xf.xfNameLibrary.getLastName()+xf.xfNameLibrary.getMaleName();else if(1===t)return xf.xfNameLibrary.getLastName()+xf.xfNameLibrary.getFemaleName()},t.prototype.show=function(i,n){var r=this;return new Promise(function(t,e){try{r.m_nickname.text=i||r.getRandomName(),r.m_confirmBtn.setCallback(function(){if(r.m_confirmBtn.state==xf.ButtonState.PRESSED)n.callback&&n.callback(r.m_nickname.text),t(r.m_nickname.text),r.close()},r),r.cancelBtn.setCallback(function(){if(r.cancelBtn.state==xf.ButtonState.PRESSED)t(),r.close()},r),r.m_confirmBtn.visible=!0,r.cancelBtn.visible=!0,r.addRenderList()}catch(t){e(t)}})},t.prototype.close=function(){this.m_confirmBtn.visible=!1,this.cancelBtn.visible=!1,this.m_confirmBtn.state=xf.ButtonState.NORMAL,this.cancelBtn.state=xf.ButtonState.NORMAL,this.removeRenderList()},Object.defineProperty(t,"instance",{get:function(){if(!xf.xfNamePicker.s_instance)xf.xfNamePicker.s_instance=new xf.xfNamePicker;return xf.xfNamePicker.s_instance},enumerable:!0,configurable:!0}),t}(xf.xfFrame);xf.xfNamePicker=e}(xf||(xf={})),function(xf){xf.xfSentry||(xf.xfSentry={}),xf.EventCenter.instance.addEventListener(xf.EventType.SDK_LOGIN_SUCCESS,function(t){Sentry.configureScope(function(t){t.setUser({id:xf.gameInfo.playerId}),t.setExtra("channelId",xf.gameInfo.channelId),t.setExtra("isTest",xf.gameInfo.isTest),t.setExtra("devID",xf.gameInfo.devId),t.setExtra("gameStatus",xf.gameInfo.gameStatus),t.setExtra("gameType",xf.gameInfo.gameType),t.setExtra("isRelease",xf.gameInfo.isRelease),t.setExtra("adTag",xf.gameInfo.adTag),t.setExtra("isSecret",xf.gameInfo.isSecret),t.setExtra("isEvkApp",xf.gameInfo.isEvkApp),t.setExtra("isSilenceLogin",xf.gameInfo.isSilenceLogin),t.setExtra("eagleGameId",xf.gameInfo.eagleGameId),t.setExtra("eagleKey",xf.gameInfo.eagleKey),t.setExtra("eagleChannel",xf.gameInfo.eagleChannel),t.setExtra("channelCode",xf.gameInfo.channelCode),t.setExtra("playerID",xf.gameInfo.playerId),t.setExtra("isFirstLogin",xf.gameInfo.isFirstLogin),t.setExtra("playerStatus",xf.gameInfo.playerStatus),t.setExtra("createTime",xf.gameInfo.createTime),t.setExtra("characterID",xf.gameInfo.characterId),t.setExtra("registerTime",xf.gameInfo.registerTime),t.setExtra("characterName",xf.gameInfo.characterName)})},window)}(xf||(xf={})),assert2(drama,"drama namespace not created"),assert2(drama.plugins_,"drama.plugins_ not created"),drama.plugins_.NinePatch=function(t){this.runtime=t},function(){var t=drama.plugins_.NinePatch.prototype;t.Type=function(t){this.plugin=t,this.runtime=t.runtime};var e=t.Type.prototype;e.onCreate=function(){if(!this.is_family)this.runtime.xfLoadC2Image(this,this.texture_file,this.texture_filesize),this.fillPattern=null,this.leftPattern=null,this.rightPattern=null,this.topPattern=null,this.bottomPattern=null,this.webGL_texture=null,this.webGL_fillTexture=null,this.webGL_leftTexture=null,this.webGL_rightTexture=null,this.webGL_topTexture=null,this.webGL_bottomTexture=null},e.onLostWebGLContext=function(){if(!this.is_family)this.webGL_texture=null,this.webGL_fillTexture=null,this.webGL_leftTexture=null,this.webGL_rightTexture=null,this.webGL_topTexture=null,this.webGL_bottomTexture=null},e.onRestoreWebGLContext=function(){if(!this.is_family&&this.instances.length)if(!this.webGL_texture)this.webGL_texture=this.runtime.glwrap.loadTexture(this.texture_img,!0,this.runtime.linearSampling,this.texture_pixelformat)},e.unloadTextures=function(){if(!this.is_family&&!this.instances.length)if(this.runtime.glwrap)this.runtime.glwrap.deleteTexture(this.webGL_texture),this.runtime.glwrap.deleteTexture(this.webGL_fillTexture),this.runtime.glwrap.deleteTexture(this.webGL_leftTexture),this.runtime.glwrap.deleteTexture(this.webGL_rightTexture),this.runtime.glwrap.deleteTexture(this.webGL_topTexture),this.runtime.glwrap.deleteTexture(this.webGL_bottomTexture),this.webGL_texture=null,this.webGL_fillTexture=null,this.webGL_leftTexture=null,this.webGL_rightTexture=null,this.webGL_topTexture=null,this.webGL_bottomTexture=null},e.slicePatch=function(t,e,i,n){var r=this.texture_data[3],o=this.texture_data[4],s=document.createElement("canvas"),a=i-t,l=n-e;return s.width=a,s.height=l,s.getContext("2d").drawImage(this.texture_img,t+r,e+o,a,l,0,0,a,l),s},e.createPatch=function(t,e,i,n){var r=this.texture_data[5],o=this.texture_data[6],s=r-e,a=o-n;if(this.runtime.glwrap){if(this.webGL_fillTexture)return;var l=this.runtime.glwrap,c=this.runtime.linearSampling,u=this.texture_pixelformat;if(t<s&&i<a)this.webGL_fillTexture=l.loadTexture(this.slicePatch(t,i,s,a),!0,c,u);if(0<t&&i<a)this.webGL_leftTexture=l.loadTexture(this.slicePatch(0,i,t,a),!0,c,u,"repeat-y");if(0<e&&i<a)this.webGL_rightTexture=l.loadTexture(this.slicePatch(s,i,r,a),!0,c,u,"repeat-y");if(0<i&&t<s)this.webGL_topTexture=l.loadTexture(this.slicePatch(t,0,s,i),!0,c,u,"repeat-x");if(0<n&&t<s)this.webGL_bottomTexture=l.loadTexture(this.slicePatch(t,a,s,o),!0,c,u,"repeat-x")}else{if(this.fillPattern)return;var h=this.runtime.ctx;if(t<s&&i<a)this.fillPattern=h.createPattern(this.slicePatch(t,i,s,a),"repeat");if(0<t&&i<a)this.leftPattern=h.createPattern(this.slicePatch(0,i,t,a),"repeat");if(0<e&&i<a)this.rightPattern=h.createPattern(this.slicePatch(s,i,r,a),"repeat");if(0<i&&t<s)this.topPattern=h.createPattern(this.slicePatch(t,0,s,i),"repeat");if(0<n&&t<s)this.bottomPattern=h.createPattern(this.slicePatch(t,a,s,o),"repeat")}},t.Instance=function(t){this.type=t,this.runtime=t.runtime};var i=t.Instance.prototype;function I(t,e,i,n,r,o,s,a,l,c){t.save(),t.fillStyle=e;var u=r%i,h=o%n;if(u<0)u+=i;if(h<0)h+=n;t.translate(u+l,h+c),t.fillRect(r-u-l,o-h-c,s,a),t.restore()}function n(){}function r(){}i.onCreate=function(){if(this.leftMargin=this.properties[0],this.rightMargin=this.properties[1],this.topMargin=this.properties[2],this.bottomMargin=this.properties[3],this.edges=this.properties[4],this.fill=this.properties[5],this.visible=this.properties[6],this.seamless=0!==this.properties[7],this.recycled)this.rcTex.set(0,0,0,0);else this.rcTex=new drama.rect(0,0,0,0);if(this.runtime.glwrap)if(!this.type.webGL_texture)if(!this.type.texture_img)this.runtime.sectionAlert(this.type.name);else this.type.webGL_texture=this.runtime.glwrap.loadTexture(this.type.texture_img,!1,this.runtime.linearSampling,this.type.texture_pixelformat);this.type.createPatch(this.leftMargin,this.rightMargin,this.topMargin,this.bottomMargin)},i.draw=function(t){var e=this.type.texture_img,i=this.leftMargin,n=this.rightMargin,r=this.topMargin,o=this.bottomMargin,s=this.type.texture_data[5],a=this.type.texture_data[6],l=this.type.texture_data[3],c=this.type.texture_data[4],u=s-n,h=a-o;t.globalAlpha=this.opacity,t.save();var d=this.x,p=this.y,f=this.width,m=this.height;if(this.runtime.pixel_rounding)d=Math.round(d),p=Math.round(p);var g=-this.hotspotX*this.width,y=-this.hotspotY*this.height,v=g%s,b=y%a;if(v<0)v+=s;if(b<0)b+=a;t.translate(d+v,p+b);var _=g-v,w=y-b,x=this.seamless?1:0;if(0<i&&0<r)t.drawImage(e,l,c,i+x,r+x,_,w,i+x,r+x);if(0<n&&0<r)t.drawImage(e,l+u-x,c,n+x,r+x,_+f-n-x,w,n+x,r+x);if(0<n&&0<o)t.drawImage(e,l+u-x,c+h-x,n+x,o+x,_+f-n-x,w+m-o-x,n+x,o+x);if(0<i&&0<o)t.drawImage(e,l,c+h-x,i+x,o+x,_,w+m-o-x,i+x,o+x);if(0===this.edges){var S=2===this.fill?0:x;if(0<i&&r<h)I(t,this.type.leftPattern,i,h-r,_,w+r,i+S,m-r-o,0,0);if(0<n&&r<h)I(t,this.type.rightPattern,n,h-r,_+f-n-S,w+r,n+S,m-r-o,S,0);if(0<r&&i<u)I(t,this.type.topPattern,u-i,r,_+i,w,f-i-n,r+S,0,0);if(0<o&&i<u)I(t,this.type.bottomPattern,u-i,o,_+i,w+m-o-S,f-i-n,o+S,0,S)}else if(1===this.edges){if(0<i&&r<h&&0<m-r-o)t.drawImage(e,l,c+r,i,h-r,_,w+r,i,m-r-o);if(0<n&&r<h&&0<m-r-o)t.drawImage(e,l+u,c+r,n,h-r,_+f-n,w+r,n,m-r-o);if(0<r&&i<u&&0<f-i-n)t.drawImage(e,l+i,c,u-i,r,_+i,w,f-i-n,r);if(0<o&&i<u&&0<f-i-n)t.drawImage(e,l+i,c+h,u-i,o,_+i,w+m-o,f-i-n,o)}if(r<h&&i<u)if(0===this.fill)I(t,this.type.fillPattern,u-i,h-r,_+i,w+r,f-i-n,m-r-o,0,0);else if(1===this.fill)if(0<f-i-n&&0<m-r-o)t.drawImage(e,l+i,c+r,u-i,h-r,_+i,w+r,f-i-n,m-r-o);t.restore()},i.drawPatch=function(t,e,i,n,r,o,s,a,l,c){t.setTexture(e);var u=this.rcTex;u.left=i/e.c2width,u.top=n/e.c2height,u.right=(i+r)/e.c2width,u.bottom=(n+o)/e.c2height,t.quadTex(s,a,s+l,a,s+l,a+c,s,a+c,u)},i.tilePatch=function(t,e,i,n,r,o,s,a){t.setTexture(e);var l=this.rcTex;l.left=-s/e.c2width,l.top=-a/e.c2height,l.right=(r-s)/e.c2width,l.bottom=(o-a)/e.c2height,t.quadTex(i,n,i+r,n,i+r,n+o,i,n+o,l)},i.drawGL_earlyZPass=function(t){this.drawGL(t)},i.drawGL=function(t){var e=this.leftMargin,i=this.rightMargin,n=this.topMargin,r=this.bottomMargin,o=this.type.texture_data[5],s=this.type.texture_data[6],a=this.type.texture_data[3],l=this.type.texture_data[4],c=o-i,u=s-r;t.setOpacity(this.opacity);var h=this.bquad,d=h.tlx,p=h.tly,f=this.width,m=this.height;if(this.runtime.pixel_rounding)d=Math.round(d),p=Math.round(p);var g=this.seamless?1:0;if(0<e&&0<n)this.drawPatch(t,this.type.webGL_texture,a,l,e+g,n+g,d,p,e+g,n+g);if(0<i&&0<n)this.drawPatch(t,this.type.webGL_texture,a+c-g,l,i+g,n+g,d+f-i-g,p,i+g,n+g);if(0<i&&0<r)this.drawPatch(t,this.type.webGL_texture,a+c-g,l+u-g,i+g,r+g,d+f-i-g,p+m-r-g,i+g,r+g);if(0<e&&0<r)this.drawPatch(t,this.type.webGL_texture,a,l+u-g,e+g,r+g,d,p+m-r-g,e+g,r+g);if(0===this.edges){var y=2===this.fill?0:g;if(0<e&&n<u)this.tilePatch(t,this.type.webGL_leftTexture,d,p+n,e+y,m-n-r,0,0);if(0<i&&n<u)this.tilePatch(t,this.type.webGL_rightTexture,d+f-i-y,p+n,i+y,m-n-r,y,0);if(0<n&&e<c)this.tilePatch(t,this.type.webGL_topTexture,d+e,p,f-e-i,n+y,0,0);if(0<r&&e<c)this.tilePatch(t,this.type.webGL_bottomTexture,d+e,p+m-r-y,f-e-i,r+y,0,y)}else if(1===this.edges){if(0<e&&n<u)this.drawPatch(t,this.type.webGL_texture,a,l+n,e,u-n,d,p+n,e,m-n-r);if(0<i&&n<u)this.drawPatch(t,this.type.webGL_texture,a+c,l+n,i,u-n,d+f-i,p+n,i,m-n-r);if(0<n&&e<c)this.drawPatch(t,this.type.webGL_texture,a+e,l,c-e,n,d+e,p,f-e-i,n);if(0<r&&e<c)this.drawPatch(t,this.type.webGL_texture,a+e,l+u,c-e,r,d+e,p+m-r,f-e-i,r)}if(n<u&&e<c)if(0===this.fill)this.tilePatch(t,this.type.webGL_fillTexture,d+e,p+n,f-e-i,m-n-r,0,0);else if(1===this.fill)this.drawPatch(t,this.type.webGL_texture,a+e,l+n,c-e,u-n,d+e,p+n,f-e-i,m-n-r)},n.prototype.OnURLLoaded=function(){return!0},t.cnds=new n,r.prototype.SetEffect=function(t){this.blend_mode=t,this.compositeOp=drama.effectToCompositeOp(t),drama.setGLBlend(this,t,this.runtime.gl),this.runtime.redraw=!0},t.acts=new r,t.exps=new function(){}}(),assert2(drama,"drama namespace not created"),assert2(drama.plugins_,"drama.plugins_ not created"),drama.plugins_.admob=function(t){this.runtime=t},function(){var t=drama.plugins_.admob.prototype;t.Type=function(t){this.plugin=t,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t){this.type=t,this.runtime=t.runtime};var e=t.Instance.prototype,n=!1;function i(){}function r(){}e.onCreate=function(){if(window.admob){if(n=!0,this.AdMob=window.admob,this.AdMob.setLicenseKey)this.AdMob.setLicenseKey("support@scirra.com","2ba99d4ff8c219cf7331c88fb3344f80");var t=this.properties[0],e=this.properties[1];if(this.androidBannerId=this.properties[2],this.androidInterstitialId=this.properties[3],this.iosBannerId=this.properties[4],this.iosInterstitialId=this.properties[5],this.wp8BannerId=this.properties[6],this.wp8InterstitialId=this.properties[7],this.runtime.isAndroid)this.bannerId=this.androidBannerId,this.interstitialId=this.androidInterstitialId;else if(this.runtime.isiOS)this.bannerId=this.iosBannerId,this.interstitialId=this.iosInterstitialId;else if(this.runtime.isWindowsPhone8||this.runtime.isWindowsPhone81)this.bannerId=this.wp8BannerId,this.interstitialId=this.wp8InterstitialId;else this.bannerId="",this.interstitialId="";this.isShowingBannerAd=!1,this.isShowingInterstitial=!1,this.AdMob.setUp(this.bannerId,this.interstitialId,t,e);var i=this;this.AdMob.onFullScreenAdLoaded=function(){i.runtime.trigger(drama.plugins_.admob.prototype.cnds.OnInterstitialReceived,i)},this.AdMob.onInterstitialAdLoaded=function(){i.runtime.trigger(drama.plugins_.admob.prototype.cnds.OnInterstitialReceived,i)},this.AdMob.onFullScreenAdShown=function(){i.isShowingInterstitial=!0,i.runtime.trigger(drama.plugins_.admob.prototype.cnds.OnInterstitialPresented,i)},this.AdMob.onInterstitialAdShown=function(){i.isShowingInterstitial=!0,i.runtime.trigger(drama.plugins_.admob.prototype.cnds.OnInterstitialPresented,i)},this.AdMob.onFullScreenAdClosed=function(){i.isShowingInterstitial=!1,i.runtime.trigger(drama.plugins_.admob.prototype.cnds.OnInterstitialDismissed,i)},this.AdMob.onInterstitialAdHidden=function(){i.isShowingInterstitial=!1,i.runtime.trigger(drama.plugins_.admob.prototype.cnds.OnInterstitialDismissed,i)},this.AdMob.onBannerAdPreloaded=function(){i.runtime.trigger(drama.plugins_.admob.prototype.cnds.OnBannerAdReceived,i)}}else drama.logexport(" com.cranberrygame.phonegap.plugin.ad.admob plugin is required to show Admob ads with Cordova; other platforms are not supported")},i.prototype.IsShowingBanner=function(){return this.isShowingBannerAd},i.prototype.IsShowingInterstitial=function(){return this.isShowingInterstitial},i.prototype.OnInterstitialReceived=function(){return!0},i.prototype.OnInterstitialPresented=function(){return!0},i.prototype.OnInterstitialDismissed=function(){return!0},i.prototype.OnBannerAdReceived=function(){return!0},t.cnds=new i,r.prototype.ShowBanner=function(t,e){if(n)this.AdMob.showBannerAd(function(t){switch(t){case 0:return"top-left";case 1:return"top-center";case 2:return"top-right";case 3:return"left";case 4:return"center";case 5:return"right";case 6:return"bottom-left";case 7:return"bottom-center";case 8:return"bottom-right"}return"bottom-center"}(t),function(t){switch(t){case 0:return"SMART_BANNER";case 1:return"BANNER";case 2:return"MEDIUM_RECTANGLE";case 3:return"FULL_BANNER";case 4:return"LEADERBOARD";case 5:return"SKYSCRAPER"}return"SMART_BANNER"}(e)),this.isShowingBannerAd=!0},r.prototype.AutoShowInterstitial=function(){if(n)if(this.AdMob.showInterstitialAd)this.AdMob.showInterstitialAd();else if(this.AdMob.showFullScreenAd)this.AdMob.showFullScreenAd()},r.prototype.PreloadInterstitial=function(){if(n)if(this.AdMob.preloadInterstitialAd)this.AdMob.preloadInterstitialAd();else if(this.AdMob.preloadFullScreenAd)this.AdMob.preloadFullScreenAd()},r.prototype.ShowInterstitial=function(){if(n)if(this.AdMob.showInterstitialAd)this.AdMob.showInterstitialAd();else if(this.AdMob.showFullScreenAd)this.AdMob.showFullScreenAd()},r.prototype.HideBanner=function(){if(n)this.AdMob.hideBannerAd(),this.isShowingBannerAd=!1},r.prototype.ReloadInterstitial=function(){if(n)if(this.AdMob.reloadInterstitialAd)this.AdMob.reloadInterstitialAd();else if(this.AdMob.reloadFullScreenAd)this.AdMob.reloadFullScreenAd()},r.prototype.ReloadBanner=function(){if(n)this.AdMob.reloadBannerAd()},r.prototype.PreloadBanner=function(){if(n)this.AdMob.preloadBannerAd()},t.acts=new r,t.exps=new function(){}}(),function(){var r="busy",i="shown",o="loaded",s=["portrait","landscape","standard","large","medium","full","leaderboard"],a=null,l=!1,n=null,c=null,u=null,h=null,d=null,p=null,f=null,m=null,g=null,y=null,v=null,b=null,_=null,w=null,x=null,S=null,I=null;function T(t){return l?"TEST":t}function C(t){return 0==t}function t(){}function e(){}function O(){}function P(t){this.plugin=t,this.runtime=t.runtime}function E(t){this.type=t,this.runtime=t.runtime,this.errorMessage="",this.rewardType="",this.rewardValue=0}function A(t){this.runtime=t}t.prototype={CreateBanner:function(t,e,i){if(null==c)if(a){t=T(t),e=s[e],i=C(i);var n=this.type.plugin.acts;c=r,a.CreateBannerAdvert(t,e,function(t,e){if(t)c=null,f(t);else if(c=o,d(),i)n.ShowBanner()})}else f("advert plugin is not loaded")},ShowBanner:function(){if(c==o)if(a)c=r,a.ShowBannerAdvert(function(t,e){if(t)c=null,console.error("Failed to show banner advert");else c=i,y()});else console.error("advert plugin is not loaded")},HideBanner:function(){if(c==i)if(a)c=r,a.HideBannerAdvert(function(t,e){if(c=null,t)console.error("Failed to hide banner advert");else _()});else console.error("advert plugin is not loaded")},CreateInterstitial:function(t,i){if(null==u)if(a){t=T(t),i=C(i);var n=this.type.plugin.acts;u=r,a.CreateInterstitialAdvert(t,function(t,e){if(t)u=null,g(t);else if(u=o,p(),i)n.ShowInterstitial()})}else g("advert plugin is not loaded")},ShowInterstitial:function(){if(u==o)if(a)u=i,a.ShowInterstitialAdvert(function(t,e){if(u=null,t)x(t);else b()});else x("advert plugin is not loaded")},CreateVideo:function(t,i){if(null==h)if(a){t=T(t),i=C(i);var n=this.type.plugin.acts;h=r,a.CreateVideoAdvert(t,function(t,e){if(t)h=null,m(t);else if(h=o,i)n.ShowVideo()})}else m("advert plugin is not loaded")},ShowVideo:function(){if(h==o)if(a)h=i,a.ShowVideoAdvert(function(t,e){if(h=null,t)w(t);else{var i=JSON.parse(e);v(i[0],i[1])}});else w("advert plugin is not loaded")},SetPublicKey:function(t){if(null===n)if(a)n=r,a.Configure(t,function(t,e){if(t)n=null,S(t);else n="set",I()});else S("advert plugin is not loaded")}},O.prototype={ErrorMessage:function(t){t.set_string(this.errorMessage||"")},RewardType:function(t){t.set_string(this.rewardType||"")},RewardValue:function(t){t.set_number(this.rewardValue||0)}},e.prototype={OnBannerReady:function(){return!0},OnVideoReady:function(){return!0},OnInterstitialReady:function(){return!0},OnBannerFailedToLoad:function(){return!0},OnVideoFailedToLoad:function(){return!0},OnInterstitialFailedToLoad:function(){return!0},OnBannerShown:function(){return!0},OnVideoComplete:function(){return!0},OnInterstitialComplete:function(){return!0},OnBannerHidden:function(){return!0},OnVideoCancelled:function(){return!0},OnInterstitialCancelled:function(){return!0},OnConfigurationFailed:function(){return!0},OnConfigurationComplete:function(){return!0},IsShowingBanner:function(){return c===i},IsShowingVideo:function(){return h===i},IsShowingInterstitial:function(){return u===i},IsBannerLoaded:function(){return c===o},IsVideoLoaded:function(){return h===o},IsInterstitialLoaded:function(){return u===o},IsConfigured:function(){return"set"===n}},P.prototype={onCreate:function(){}},E.prototype={onCreate:function(){var i=this.runtime,o=this,n=drama.plugins_.advert.prototype.cnds,t=drama.plugins_.advert.prototype.acts,r=function(t,e,i,n){var r;r="Event (".concat(t," Error (").concat(e,") Type (").concat(i,") Amount (").concat(n,"))"),console.log("[C2 advert]",r),o.errorMessage=e||"",o.rewardType=i||"",o.rewardValue=n||0};if(d=function(){r("banner ready"),i.trigger(n.OnBannerReady,o)},function(){r("video ready"),i.trigger(n.OnVideoReady,o)},p=function(){r("interstitial ready"),i.trigger(n.OnInterstitialReady,o)},f=function(t){r("banner load fail",t),i.trigger(n.OnBannerFailedToLoad,o)},m=function(t){r("video load fail",t),i.trigger(n.OnVideoFailedToLoad,o)},g=function(t){r("interstitial load fail",t),i.trigger(n.OnInterstitialFailedToLoad,o)},y=function(){r("banner shown"),i.trigger(n.OnBannerShown,o)},v=function(t,e){r("video reward",null,t,e),i.trigger(n.OnVideoComplete,o)},b=function(){r("interstitial complete"),i.trigger(n.OnInterstitialComplete,o)},_=function(){r("banner hidden"),i.trigger(n.OnBannerHidden,o)},w=function(t){r("video cancelled",t),i.trigger(n.OnVideoCancelled,o)},x=function(t){r("interstitial cancelled",t),i.trigger("interstitial cancelled",n.OnInterstitialCancelled,o)},S=function(t){r("configuration failed",t),i.trigger(n.OnConfigurationFailed,o)},I=function(){r("configuration complete"),i.trigger(n.OnConfigurationComplete,o)},this.runtime.isCordova&&cordova.plugins.ConstructAd)if(this.runtime.isiOS||this.runtime.isAndroid){a=cordova.plugins.ConstructAd,l=!!this.properties[0];var e=this.properties[1];if(e)t.SetPublicKey(e)}},onDestroy:function(){},saveToJSON:function(){return{}},loadFromJSON:function(){},getDebuggerValues:function(){},onDebugValueEdited:function(){}},A.prototype={Type:P,Instance:E,cnds:new e,exps:new O,acts:new t},drama.plugins_.advert=A}(),assert2(drama,"drama namespace not created"),assert2(drama.plugins_,"drama.plugins_ not created"),drama.plugins_.AJAX=function(t){this.runtime=t},function(){var c=!1,i=null,u=null,h="",t=drama.plugins_.AJAX.prototype;t.Type=function(t){this.plugin=t,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t){if(this.type=t,this.runtime=t.runtime,this.lastData="",this.curTag="",this.progress=0,this.timeout=-1,c=this.runtime.isNWjs){i=require("path"),u=require("fs");var e=window.process||nw.process;h=i.dirname(e.execPath)+"\\"}};var e=t.Instance.prototype;e.onCreate=function(){},e.saveToJSON=function(){return{lastData:this.lastData}},e.loadFromJSON=function(t){this.lastData=t.lastData,this.curTag="",this.progress=0};var d={},p="";function n(){}function r(){}function o(){}e.doRequest=function(i,e,t,n){e=this.runtime.manifest[e]?this.runtime.manifest[e]:e;var r=this,o=null,s=function(){r.curTag=i,r.runtime.trigger(drama.plugins_.AJAX.prototype.cnds.OnAnyError,r),r.runtime.trigger(drama.plugins_.AJAX.prototype.cnds.OnError,r)},a=function(){if(c){var t=h+e;if(u.existsSync(t))u.readFile(t,{encoding:"utf8"},function(t,e){if(!t)r.curTag=i,r.lastData=e.replace(/\r\n/g,"\n"),r.runtime.trigger(drama.plugins_.AJAX.prototype.cnds.OnAnyComplete,r),r.runtime.trigger(drama.plugins_.AJAX.prototype.cnds.OnComplete,r);else s()});else s()}else s()};try{if(this.runtime.isWindowsPhone8)o=new window.ActiveXObject("Microsoft.XMLHTTP");else o=new XMLHttpRequest;if(o.onreadystatechange=function(){if(4===o.readyState){if(r.curTag=i,o.responseText)r.lastData=o.responseText.replace(/\r\n/g,"\n");else r.lastData="";if(400<=o.status)r.runtime.trigger(drama.plugins_.AJAX.prototype.cnds.OnAnyError,r),r.runtime.trigger(drama.plugins_.AJAX.prototype.cnds.OnError,r);else if((!c||r.lastData.length)&&(c||0!==o.status||r.lastData.length))r.runtime.trigger(drama.plugins_.AJAX.prototype.cnds.OnAnyComplete,r),r.runtime.trigger(drama.plugins_.AJAX.prototype.cnds.OnComplete,r)}},!this.runtime.isWindowsPhone8)o.onerror=a,o.ontimeout=a,o.onabort=a,o.onprogress=function(t){if(t.lengthComputable)r.progress=t.loaded/t.total,r.curTag=i,r.runtime.trigger(drama.plugins_.AJAX.prototype.cnds.OnProgress,r)};if(o.open(t,e),!this.runtime.isWindowsPhone8)if(0<=this.timeout&&void 0!==o.timeout)o.timeout=this.timeout;if(o.responseType="text",n)if(o.setRequestHeader&&!d.hasOwnProperty("Content-Type"))o.setRequestHeader("Content-Type","application/x-www-form-urlencoded");if(o.setRequestHeader){var l;for(l in d)if(d.hasOwnProperty(l))try{o.setRequestHeader(l,d[l])}catch(t){}d={}}if(p&&o.overrideMimeType){try{o.overrideMimeType(p)}catch(t){}p=""}if(n)o.send(n);else o.send()}catch(t){a()}},e.getDebuggerValues=function(t){t.push({title:"AJAX",properties:[{name:"Last data",value:this.lastData,readonly:!0}]})},n.prototype.OnComplete=function(t){return drama.equals_nocase(t,this.curTag)},n.prototype.OnAnyComplete=function(t){return!0},n.prototype.OnError=function(t){return drama.equals_nocase(t,this.curTag)},n.prototype.OnAnyError=function(t){return!0},n.prototype.OnProgress=function(t){return drama.equals_nocase(t,this.curTag)},t.cnds=new n,r.prototype.Request=function(e,t){var i=this;if(t=this.runtime.manifest[t]?this.runtime.manifest[t]:t,this.runtime.isWKWebView&&!this.runtime.isAbsoluteUrl(t))this.runtime.fetchLocalFileViaCordovaAsText(t,function(t){i.curTag=e,i.lastData=t.replace(/\r\n/g,"\n"),i.runtime.trigger(drama.plugins_.AJAX.prototype.cnds.OnAnyComplete,i),i.runtime.trigger(drama.plugins_.AJAX.prototype.cnds.OnComplete,i)},function(){i.curTag=e,i.runtime.trigger(drama.plugins_.AJAX.prototype.cnds.OnAnyError,i),i.runtime.trigger(drama.plugins_.AJAX.prototype.cnds.OnError,i)});else if(this.runtime.isPreview&&!this.runtime.isAbsoluteUrl(t))this.doRequest(e,this.runtime.getLocalFileUrl(t),"GET");else this.doRequest(e,t,"GET")},r.prototype.RequestFile=function(e,t){var i=this;if(t=this.runtime.manifest[t]?this.runtime.manifest[t]:t,this.runtime.isWKWebView)this.runtime.fetchLocalFileViaCordovaAsText(t,function(t){i.curTag=e,i.lastData=t.replace(/\r\n/g,"\n"),i.runtime.trigger(drama.plugins_.AJAX.prototype.cnds.OnAnyComplete,i),i.runtime.trigger(drama.plugins_.AJAX.prototype.cnds.OnComplete,i)},function(){i.curTag=e,i.runtime.trigger(drama.plugins_.AJAX.prototype.cnds.OnAnyError,i),i.runtime.trigger(drama.plugins_.AJAX.prototype.cnds.OnError,i)});else this.doRequest(e,this.runtime.getLocalFileUrl(t),"GET")},r.prototype.Post=function(t,e,i,n){this.doRequest(t,e,n,i)},r.prototype.SetTimeout=function(t){this.timeout=1e3*t},r.prototype.SetHeader=function(t,e){d[t]=e},r.prototype.OverrideMIMEType=function(t){p=t},t.acts=new r,o.prototype.LastData=function(t){t.set_string(this.lastData)},o.prototype.Progress=function(t){t.set_float(this.progress)},o.prototype.Tag=function(t){t.set_string(this.curTag)},t.exps=new o}(),assert2(drama,"drama namespace not created"),assert2(drama.plugins_,"drama.plugins_ not created"),drama.plugins_.appMobi=function(t){this.runtime=t},function(){var t=drama.plugins_.appMobi.prototype;t.Type=function(t){this.plugin=t,this.runtime=t.runtime};var e=!(t.Type.prototype.onCreate=function(){}),a={},o="",i="",l="idle",n=null,r=null,s=null;t.Instance=function(t){this.type=t,this.runtime=t.runtime};var c={},u=!1;c.getRemoteDataEvent=function(t){try{if(t.success)o=t.response,n.trigger(drama.plugins_.appMobi.prototype.cnds.OnRemoteData,r)}catch(t){}},c.barcodeScanned=function(t){try{if(t.success)i=t.codedata,n.trigger(drama.plugins_.appMobi.prototype.cnds.OnBarcodeScanned,r)}catch(t){}},c.connectionUpdate=function(t){try{if(t.success)t.connection}catch(t){}},c.remoteClosed=function(t){try{if(t.success)l="closed",n.trigger(drama.plugins_.appMobi.prototype.cnds.OnRemoteSiteClosed,r)}catch(t){}},c.onBack=function(t){n.trigger(drama.plugins_.appMobi.prototype.cnds.OnBack,r)},c.barcodeScanned=function(t){try{if(t.success)i=t.codedata}catch(t){}},c.connectionUpdate=function(t){try{if(t.success)t.connection}catch(t){}},c.remoteClosed=function(t){try{l="closed"}catch(t){}};var h=t.Instance.prototype;function d(){}h.onCreate=function(){if(n=this.runtime,u=(r=this).runtime.isDirectCanvas)s=AppMobi.webview.execute;if(void 0!==window.AppMobi&&!u)a=window.AppMobi,e=!0,document.addEventListener("appMobi.device.remote.data",c.getRemoteDataEvent,!1),document.addEventListener("appMobi.device.barcode.scan",c.barcodeScanned,!1),document.addEventListener("appMobi.device.connection.update",c.connectionUpdate,!1),document.addEventListener("appMobi.device.remote.close",c.remoteClosed,!1),document.addEventListener("appMobi.device.hardware.back",c.onBack,!1)},h.onLayoutChange=function(){},d.prototype.deviceHasCaching=function(){if(!e||u)return!1;else return a.device.hasCaching},d.prototype.deviceHasPush=function(){if(!e||u)return!1;else return a.device.hasPush},d.prototype.deviceHasStreaming=function(){if(!e||u)return!1;else return a.device.hasStreaming},d.prototype.deviceHasUpdates=function(){if(!e||u)return!1;else return a.device.hasUpdates},d.prototype.isInAppMobi=function(){return e||u};var p=[0,-90,90,180];function f(){}function m(){}d.prototype.compareOrientation=function(t){if(!e||u)return 0===t;else return p[t]===parseInt(a.device.orientation)},d.prototype.compareInitialOrientation=function(t){if(!e||u)return 0===t;else return p[t]===parseInt(a.device.initialOrientation)},d.prototype.OnBarcodeScanned=function(){return!0},d.prototype.OnRemoteSiteClosed=function(){return!0},d.prototype.OnRemoteData=function(){return!0},d.prototype.OnBack=function(){return!0},t.cnds=new d,f.prototype.deviceCloseRemoteSite=function(){try{if(u)s("AppMobi['device']['closeRemoteSite']();");else a.device.closeRemoteSite()}catch(t){}},f.prototype.deviceGetRemoteData=function(t,e,i,n){if(!u)try{o="";var r=new a.Device.RemoteDataParameters;r.url=e,r.id=n,r.method=t,r.body=i,a.device.getRemoteDataExt(r)}catch(t){}},f.prototype.deviceHideSplashScreen=function(){try{if(u)s("AppMobi['device']['hideSplashScreen']();");else a.device.hideSplashScreen()}catch(t){}},f.prototype.deviceInstallUpdate=function(){try{if(u)s("AppMobi['device']['installUpdate']();");else a.device.installUpdate()}catch(t){}},f.prototype.deviceLaunchExternal=function(t){try{if(u)s("AppMobi['device']['launchExternal']('"+t+"');");else a.device.launchExternal(t)}catch(t){}},f.prototype.deviceMainViewExecute=function(t){try{a.device.mainViewExecute(t)}catch(t){}},f.prototype.deviceScanBarcode=function(){if(!u)try{i="",a.device.scanBarcode()}catch(t){}},f.prototype.deviceUpdateConnection=function(){if(!u)try{"",a.device.updateConnection()}catch(t){}},f.prototype.deviceShowRemoteSite=function(t,e,i,n,r,o,s){if(!u)try{l="open",a.device.showRemoteSiteExt(t,n,r,o,s,e,i)}catch(t){}},f.prototype.deviceSetAutoRotate=function(t){if(e||u)if(u)s("AppMobi['device']['setAutoRotate']("+(t?"true":"false")+");");else a.device.setAutoRotate(0!==t)},f.prototype.deviceSetRotateOrientation=function(t){if(e||u)if(u)s("AppMobi['device']['setRotateOrientation']("+(0===t?"'portrait'":"'landscape'")+");");else a.device.setRotateOrientation(0===t?"portrait":"landscape")},f.prototype.analyticsLogEvent=function(t,e){try{if(t="/application/"+t+".event",u)s("AppMobi['analytics']['logPageEvent']('"+t+"', '"+e+"', 200, 'GET', 0, 'index.html');");else a.analytics.logPageEvent(t,e,200,"GET",0,"index.html")}catch(t){console.log(t)}},f.prototype.cacheAddToMediaCache=function(t){if(!u)try{a.cache.addToMediaCache(t)}catch(t){console.log(t)}},f.prototype.cacheClearAllCookies=function(){if(!u)try{a.cache.clearAllCookies()}catch(t){console.log(t)}},f.prototype.cacheClearMediaCache=function(){if(!u)try{a.cache.clearMediaCache()}catch(t){console.log(t)}},f.prototype.cacheRemoveCookie=function(t){if(!u)try{a.cache.removeCookie(t)}catch(t){console.log(t)}},f.prototype.cacheRemoveFromMediaCache=function(t){if(!u)try{a.cache.removeFromMediaCache(t)}catch(t){console.log(t)}},f.prototype.cacheSetCookie=function(t,e,i){if(!u)try{a.cache.setCookie(t,e,i)}catch(t){console.log(t)}},f.prototype.AddVirtualPage=function(){if(e||u)if(u)s("AppMobi['device']['addVirtualPage']();");else a.device.addVirtualPage()},f.prototype.RemoveVirtualPage=function(){if(e||u)if(u)s("AppMobi['device']['removeVirtualPage']();");else a.device.removeVirtualPage()},f.prototype.HideStatusBar=function(){try{if(u)s("AppMobi['device']['hideStatusBar']();");else a.device.hideStatusBar()}catch(t){}},t.acts=new f,m.prototype.AppMobiVersion=function(e){try{e.set_string(a.device.appmobiversion)}catch(t){e.set_string("")}},m.prototype.DeviceConnection=function(e){try{e.set_string(a.device.connection)}catch(t){e.set_string("")}},m.prototype.InitialOrientation=function(e){try{e.set_int(parseInt(a.device.initialOrientation))}catch(t){e.set_int(0)}},m.prototype.DeviceLastStation=function(e){try{e.set_string(a.device.lastStation)}catch(t){e.set_string("")}},m.prototype.DeviceModel=function(e){try{e.set_string(a.device.model)}catch(t){e.set_string("")}},m.prototype.Orientation=function(e){try{e.set_int(parseInt(a.device.orientation))}catch(t){e.set_int(0)}},m.prototype.DeviceOSVersion=function(e){try{e.set_string(a.device.osversion)}catch(t){e.set_string("")}},m.prototype.DevicePhonegapVersion=function(e){try{e.set_string(a.device.phonegapversion)}catch(t){e.set_string("")}},m.prototype.DevicePlatform=function(e){try{e.set_string(a.device.platform)}catch(t){e.set_string("")}},m.prototype.DeviceQueryString=function(e){try{e.set_string(a.device.queryString)}catch(t){e.set_string("")}},m.prototype.DeviceUUID=function(e){try{e.set_string(a.device.uuid)}catch(t){e.set_string("")}},m.prototype.DeviceRemoteData=function(e){try{e.set_string(o)}catch(t){e.set_string("")}},m.prototype.DeviceBarcodeData=function(e){try{e.set_string(i)}catch(t){e.set_string("")}},m.prototype.DeviceRemoteStatus=function(e){try{e.set_string(l)}catch(t){e.set_string("")}},m.prototype.Cookie=function(e,t){try{e.set_string(a.cache.getCookie(t))}catch(t){e.set_string("")}},m.prototype.LocalMediaCacheURL=function(e,t){try{e.set_string(a.cache.getMediaCacheLocalURL(t))}catch(t){e.set_string("")}},t.exps=new m}(),drama.plugins_.ScirraArcade=function(t){this.runtime=t},function(){function i(t,e){var i="userID="+r("u")+"&gameID="+r("gameID")+"&score="+t+"&time="+e,n=function(t,e){for(var i="",n=t;0<n;--n)i+=e[Math.round(Math.random()*(e.length-1))];return i}(i.length,"0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ,.[]{}/;&-=+_");i=function(t,e){for(var i=t.split(","),n="",r=0;r<i.length;r++){var o=String.fromCharCode(i[r]),s=e.charAt(r);o=o.charCodeAt(0)^s.charCodeAt(0),n+=o.toString()+","}return n.substring(0,n.length-1)}(function(t){for(var e="",i=0;i<t.length;i++)e+=t.charCodeAt(i)+",";return e.substring(0,e.length-1)}(i),n)}function r(t){return t=t.replace(/[[]/,"\\[").replace(/[\]]/,"\\]"),null==(t=RegExp("[\\?&]"+t+"=([^&#]*)").exec(window.location.search))?"":decodeURIComponent(t[1].replace(/\+/g," "))}var t=drama.plugins_.ScirraArcade.prototype;t.Type=function(t){this.plugin=t,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t){this.type=t,this.runtime=t.runtime};var e=t.Instance.prototype;function n(){}function o(){}function s(){}e.onCreate=function(){this.hiscoreResult={},this.is_arcade=void 0!==window.is_scirra_arcade},e.draw=function(t){},e.drawGL=function(t){},n.prototype.OnReceiveScores=function(){return!0},t.cnds=new n,o.prototype.SubmitSingleScore=function(t){if(this.is_arcade)i(t,0)},o.prototype.SubmitTimeScore=function(t){if(this.is_arcade)i(0,Math.round(1e3*t))},o.prototype.SubmitSingleScoreTimed=function(t,e){if(this.is_arcade)i(t,Math.round(1e3*e))},o.prototype.RequestHiScores=function(t,e,i){},t.acts=new o,s.prototype.HiScoreCount=function(t){if(this.hiscoreResult.scores)t.set_int(this.hiscoreResult.scores.length);else t.set_int(0)},s.prototype.HiScoreAt=function(t,e){if(e=Math.floor(e),this.hiscoreResult.scores)if(e<0||e>=this.hiscoreResult.scores.length)t.set_float(0);else t.set_float(this.hiscoreResult.scores[e].Score);else t.set_float(0)},s.prototype.HiScoreNameAt=function(t,e){if(e=Math.floor(e),this.hiscoreResult.scores)if(e<0||e>=this.hiscoreResult.scores.length)t.set_string(0);else t.set_string(this.hiscoreResult.scores[e].Username);else t.set_int(0)},s.prototype.HiScoreTimeAt=function(t,e){if(e=Math.floor(e),this.hiscoreResult.scores)if(e<0||e>=this.hiscoreResult.scores.length)t.set_float(0);else t.set_float(this.hiscoreResult.scores[e].Time/1e3);else t.set_float(0)},s.prototype.HiScoreRankAt=function(t,e){if(e=Math.floor(e),this.hiscoreResult.scores)if(e<0||e>=this.hiscoreResult.scores.length)t.set_int(0);else t.set_int(this.hiscoreResult.scores[e].Rank);else t.set_int(0)},t.exps=new s}(),drama.plugins_.ScirraArcadeV4=function(t){this.runtime=t},function(){var t=drama.plugins_.ScirraArcadeV4.prototype;function e(){}t.Type=function(t){this.plugin=t,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t){this.type=t,this.runtime=t.runtime},t.Instance.prototype.onCreate=function(){this.hiscoreResult={},this.is_arcade=void 0!==window.is_scirra_arcade},t.cnds=new function(){},e.prototype.SubmitScore=function(t,e){if(this.is_arcade&&(this.runtime.isRunningEvents||0!==this.runtime.trigger_depth)){var i=new XMLHttpRequest;i.onreadystatechange=function(){if(4===i.readyState&&200===i.status){var t=new XMLHttpRequest;t.onreadystatechange=function(){4===t.readyState&&200===t.status&&parent.postMessage("highscore|"+t.responseText.split("|")[1],"*")},t.open("POST","/handlers/leaderboard.ashx",!0),t.send("mode=auth&token="+i.responseText.split("|")[1])}},i.open("POST","/handlers/leaderboard.ashx",!0),i.send("gameID="+window.V4Arcade.gameID+"&token="+window.V4Arcade.playIdentity+"&leaderboard="+t+"&score="+e+"&mode=init")}},t.acts=new e,t.exps=new function(){}}(),assert2(drama,"drama namespace not created"),assert2(drama.plugins_,"drama.plugins_ not created"),drama.plugins_.Arr=function(t){this.runtime=t},function(){var t=drama.plugins_.Arr.prototype;t.Type=function(t){this.plugin=t,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t){this.type=t,this.runtime=t.runtime};var e=t.Instance.prototype,n=[];function a(){if(n.length)return n.pop();else return[]}if(!Array.isArray)Array.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)};function o(t){var e,i;for(e=0,i=t.length;e<i;e++)if(Array.isArray(t[e]))o(t[e]);drama.clearArray(t),n.push(t)}function i(){}function r(){}function l(t,e){if(drama.is_number(t)&&drama.is_number(e))return t-e;else{var i=""+t,n=""+e;if(i<n)return-1;else if(n<i)return 1;else return 0}}function s(){}e.onCreate=function(){this.cx=this.properties[0],this.cy=this.properties[1],this.cz=this.properties[2],this.total=this.properties[3];var t=this.properties[4]||[];if(!this.recycled)this.arr=a();var e,i,n,r=this.arr;for(r.length=this.cx,n=0;n<this.cz;n++)for(i=0;i<this.cy;i++)for(e=0;e<this.cx;e++){if(!r[e])r[e]=a();if(!r[e][i])r[e][i]=a();if(t[n]&&t[n][i]&&t[n][i][e])r[e][i][n]=t[n][i][e]}this.forX=[],this.forY=[],this.forZ=[],this.forDepth=-1},e.onDestroy=function(){var t;for(t=0;t<this.cx;t++)o(this.arr[t]);drama.clearArray(this.arr)},e.at=function(t,e,i){if(t=Math.floor(t),e=Math.floor(e),i=Math.floor(i),isNaN(t)||t<0||t>this.cx-1)return 0;if(isNaN(e)||e<0||e>this.cy-1)return 0;if(isNaN(i)||i<0||i>this.cz-1)return 0;else return this.arr[t][e][i]},e.set=function(t,e,i,n){if(t=Math.floor(t),e=Math.floor(e),i=Math.floor(i),!(isNaN(t)||t<0||t>this.cx-1))if(!(isNaN(e)||e<0||e>this.cy-1))if(!(isNaN(i)||i<0||i>this.cz-1))this.arr[t][e][i]=n},e.getAsJSON=function(){return JSON.stringify({xfarray:!0,size:[this.cx,this.cy,this.cz],data:this.arr})},e.saveToJSON=function(){return{size:[this.cx,this.cy,this.cz],data:this.arr}},e.loadFromJSON=function(t){var e=t.size;this.cx=e[0],this.cy=e[1],this.cz=e[2],this.arr=t.data},e.setSize=function(t,e,i){if(t<0)t=0;if(e<0)e=0;if(i<0)i=0;if(this.cx!==t||this.cy!==e||this.cz!==i){var n,r,o;this.cx=t,this.cy=e,this.cz=i;var s=this.arr;for(s.length=t,n=0;n<this.cx;n++){if(drama.is_undefined(s[n]))s[n]=a();for(s[n].length=e,r=0;r<this.cy;r++){if(drama.is_undefined(s[n][r]))s[n][r]=a();for(s[n][r].length=i,o=0;o<this.cz;o++)if(drama.is_undefined(s[n][r][o]))s[n][r][o]=0}}}},e.getDebuggerValues=function(t){t.push({title:"Array",properties:[{name:"Width",value:this.cx},{name:"Height",value:this.cy},{name:"Depth",value:this.cz},{name:"Total elements",value:this.cx*this.cy*this.cz,readonly:!0}]});var e,i=[];if(1===this.cy&&1===this.cz)for(e=0;e<this.cx;e++)i.push({name:e.toString(),value:this.arr[e][0][0]});else for(e=0;e<this.cx;e++)i.push({name:e.toString(),value:(this.arr[e]||[]).toString(),readonly:!0});if(i.length)t.push({title:"Array data",properties:i})},e.onDebugValueEdited=function(t,e,i){if("Array"===t){if("Width"===e)this.setSize(i,this.cy,this.cz);else if("Height"===e)this.setSize(this.cx,i,this.cz);else if("Depth"===e)this.setSize(this.cx,this.cy,i)}else if("Array data"===t)if(1===this.cy&&1===this.cz)this.set(parseInt(e,10),0,0,i)},e.getForX=function(){if(0<=this.forDepth&&this.forDepth<this.forX.length)return this.forX[this.forDepth];else return 0},e.getForY=function(){if(0<=this.forDepth&&this.forDepth<this.forY.length)return this.forY[this.forDepth];else return 0},e.getForZ=function(){if(0<=this.forDepth&&this.forDepth<this.forZ.length)return this.forZ[this.forDepth];else return 0},i.prototype.CompareX=function(t,e,i){return drama.do_cmp(this.at(t,0,0),e,i)},i.prototype.CompareXY=function(t,e,i,n){return drama.do_cmp(this.at(t,e,0),i,n)},i.prototype.CompareXYZ=function(t,e,i,n,r){return drama.do_cmp(this.at(t,e,i),n,r)},e.doForEachTrigger=function(t){this.runtime.pushCopySol(t.solModifiers),t.retrigger(),this.runtime.popSol(t.solModifiers)},i.prototype.ArrForEach=function(t){var e=this.runtime.getCurrentEventStack().current_event;this.forDepth++;var i=this.forDepth;if(i===this.forX.length)this.forX.push(0),this.forY.push(0),this.forZ.push(0);else this.forX[i]=0,this.forY[i]=0,this.forZ[i]=0;switch(t){case 0:for(this.forX[i]=0;this.forX[i]<this.cx;this.forX[i]++)for(this.forY[i]=0;this.forY[i]<this.cy;this.forY[i]++)for(this.forZ[i]=0;this.forZ[i]<this.cz;this.forZ[i]++)this.doForEachTrigger(e);break;case 1:for(this.forX[i]=0;this.forX[i]<this.cx;this.forX[i]++)for(this.forY[i]=0;this.forY[i]<this.cy;this.forY[i]++)this.doForEachTrigger(e);break;case 2:for(this.forX[i]=0;this.forX[i]<this.cx;this.forX[i]++)this.doForEachTrigger(e)}return this.forDepth--,!1},i.prototype.CompareCurrent=function(t,e){return drama.do_cmp(this.at(this.getForX(),this.getForY(),this.getForZ()),t,e)},i.prototype.Contains=function(t){var e,i,n;for(e=0;e<this.cx;e++)for(i=0;i<this.cy;i++)for(n=0;n<this.cz;n++)if(this.arr[e][i][n]===t)return!0;return!1},i.prototype.IsEmpty=function(){return 0===this.cx||0===this.cy||0===this.cz},i.prototype.CompareSize=function(t,e,i){var n=0;switch(t){case 0:n=this.cx;break;case 1:n=this.cy;break;case 2:n=this.cz}return drama.do_cmp(n,e,i)},t.cnds=new i,r.prototype.Clear=function(){var t,e,i;for(t=0;t<this.cx;t++)for(e=0;e<this.cy;e++)for(i=0;i<this.cz;i++)this.arr[t][e][i]=0},r.prototype.SetSize=function(t,e,i){this.setSize(t,e,i)},r.prototype.SetX=function(t,e){this.set(t,0,0,e)},r.prototype.SetXY=function(t,e,i){this.set(t,e,0,i)},r.prototype.SetXYZ=function(t,e,i,n){this.set(t,e,i,n)},r.prototype.Push=function(t,e,i){var n=0,r=0,o=0,s=this.arr;switch(i){case 0:if(0===t)n=s.length,s.push(a());else n=0,s.unshift(a());for(s[n].length=this.cy;r<this.cy;r++)for(s[n][r]=a(),s[n][r].length=this.cz,o=0;o<this.cz;o++)s[n][r][o]=e;this.cx++;break;case 1:for(;n<this.cx;n++){if(0===t)r=s[n].length,s[n].push(a());else r=0,s[n].unshift(a());for(s[n][r].length=this.cz,o=0;o<this.cz;o++)s[n][r][o]=e}this.cy++;break;case 2:for(;n<this.cx;n++)for(r=0;r<this.cy;r++)if(0===t)s[n][r].push(e);else s[n][r].unshift(e);this.cz++}},r.prototype.Pop=function(t,e){var i=0,n=0,r=this.arr;switch(e){case 0:if(0===this.cx)break;if(0===t)o(r.pop());else o(r.shift());this.cx--;break;case 1:if(0===this.cy)break;for(;i<this.cx;i++)if(0===t)o(r[i].pop());else o(r[i].shift());this.cy--;break;case 2:if(0===this.cz)break;for(;i<this.cx;i++)for(n=0;n<this.cy;n++)if(0===t)r[i][n].pop();else r[i][n].shift();this.cz--}},r.prototype.Reverse=function(t){var e=0,i=0,n=this.arr;if(0!==this.cx&&0!==this.cy&&0!==this.cz)switch(t){case 0:n.reverse();break;case 1:for(;e<this.cx;e++)n[e].reverse();break;case 2:for(;e<this.cx;e++)for(i=0;i<this.cy;i++)n[e][i].reverse()}},r.prototype.Sort=function(t){var e=0,i=0,n=this.arr;if(0!==this.cx&&0!==this.cy&&0!==this.cz)switch(t){case 0:n.sort(function(t,e){return l(t[0][0],e[0][0])});break;case 1:for(;e<this.cx;e++)n[e].sort(function(t,e){return l(t[0],e[0])});break;case 2:for(;e<this.cx;e++)for(i=0;i<this.cy;i++)n[e][i].sort(l)}},r.prototype.SortAll=function(r,o,s){var t=this.arr;if(0!==this.cx&&0!==this.cy&&0!==this.cz)t.sort(function(t,e){if(void 0!==t[r]&&void 0!==e[r]&&void 0!==t[r][o]&&void 0!==e[r][o]){var i=t[r][o],n=e[r][o];if(0==s)return l(i,n);else if(1==s)return function(t,e){if(drama.is_number(t)&&drama.is_number(e))return e-t;else{var i=""+t,n=""+e;if(n<i)return-1;else if(i<n)return 1;else return 0}}(i,n)}})},r.prototype.Delete=function(t,e){var i=0,n=0;t=Math.floor(t);var r=this.arr;if(!(t<0))switch(e){case 0:if(t>=this.cx)break;o(r[t]),r.splice(t,1),this.cx--;break;case 1:if(t>=this.cy)break;for(;i<this.cx;i++)o(r[i][t]),r[i].splice(t,1);this.cy--;break;case 2:if(t>=this.cz)break;for(;i<this.cx;i++)for(n=0;n<this.cy;n++)r[i][n].splice(t,1);this.cz--}},r.prototype.Insert=function(t,e,i){var n=0,r=0,o=0;e=Math.floor(e);var s=this.arr;if(!(e<0))switch(i){case 0:if(e>this.cx)return;for(n=e,s.splice(n,0,a()),s[n].length=this.cy;r<this.cy;r++)for(s[n][r]=a(),s[n][r].length=this.cz,o=0;o<this.cz;o++)s[n][r][o]=t;this.cx++;break;case 1:if(e>this.cy)return;for(;n<this.cx;n++)for(r=e,s[n].splice(r,0,a()),s[n][r].length=this.cz,o=0;o<this.cz;o++)s[n][r][o]=t;this.cy++;break;case 2:if(e>this.cz)return;for(;n<this.cx;n++)for(r=0;r<this.cy;r++)s[n][r].splice(e,0,t);this.cz++}},r.prototype.JSONLoad=function(t){var e;try{e=JSON.parse(t)}catch(t){return}if(e.xfarray||e.c2array){var i=e.size;this.cx=i[0],this.cy=i[1],this.cz=i[2],this.arr=e.data}},r.prototype.JSONDownload=function(t){var e=document.createElement("a");if(void 0===e.download){var i="data:text/html,"+encodeURIComponent("<p><a download='"+t+"' href=\"data:application/json,"+encodeURIComponent(this.getAsJSON())+'">Download link</a></p>');window.open(i)}else{var n=document.getElementsByTagName("body")[0];e.textContent=t,e.href="data:application/json,"+encodeURIComponent(this.getAsJSON()),e.download=t,n.appendChild(e);var r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),e.dispatchEvent(r),n.removeChild(e)}},t.acts=new r,s.prototype.At=function(t,e,i,n){var r=i||0,o=n||0;t.set_any(this.at(e,r,o))},s.prototype.Width=function(t){t.set_int(this.cx)},s.prototype.Height=function(t){t.set_int(this.cy)},s.prototype.Depth=function(t){t.set_int(this.cz)},s.prototype.CurX=function(t){t.set_int(this.getForX())},s.prototype.CurY=function(t){t.set_int(this.getForY())},s.prototype.CurZ=function(t){t.set_int(this.getForZ())},s.prototype.CurValue=function(t){t.set_any(this.at(this.getForX(),this.getForY(),this.getForZ()))},s.prototype.Front=function(t){t.set_any(this.at(0,0,0))},s.prototype.Back=function(t){t.set_any(this.at(this.cx-1,0,0))},s.prototype.IndexOf=function(t,e){for(var i=0;i<this.cx;i++)if(this.arr[i][0][0]===e)return void t.set_int(i);t.set_int(-1)},s.prototype.LastIndexOf=function(t,e){for(var i=this.cx-1;0<=i;i--)if(this.arr[i][0][0]===e)return void t.set_int(i);t.set_int(-1)},s.prototype.AsJSON=function(t){t.set_string(this.getAsJSON())},t.exps=new s}(),assert2(drama,"drama namespace not created"),assert2(drama.plugins_,"drama.plugins_ not created"),drama.plugins_.Audio=function(t){this.runtime=t},function(){var t=drama.plugins_.Audio.prototype;t.Type=function(t){this.plugin=t,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){};var l=null,o=null,s="",a="",c=0,u=1,h=2,d=c,p=null,f=[];drama.audioBuffers=f;var S=[];drama.audioInstances=S;var m=null,g=0,I=!1,T=1,y=0,v=0,b=!1,e=new Audio,_=!!e.canPlayType("audio/webm; codecs=opus"),n=1,r=1,w=10,x=1e4,C=1,O=e=null,P="",E=!1,A=[],k=!1,M=!1,R=!1;function L(t){if(-1===A.indexOf(t))A.push(t)}function D(e){var t,i=e.instanceObject;try{t=i.play()}catch(t){return void L(e)}if(t)t.catch(function(){L(e)});else if(E&&!l.isInUserInputEvent)L(e)}function i(){var t,e,i,n;if(!R&&!b&&p)if(function(){if("suspended"===p.state&&p.resume)p.resume();if(!p.createBuffer)return;var t=p.createBuffer(1,220,22050),e=p.createBufferSource();e.buffer=t,e.connect(p.destination),e.loop=window.xfruntime.isiOS,W(e)}(),"running"===p.state)R=!0;var r=A.slice(0);if(drama.clearArray(A),!I)for(t=0,e=r.length;t<e;++t)if(!(i=r[t]).stopped&&!i.is_paused)if(n=i.instanceObject.play())n.catch(function(){L(i)})}function N(t){var e=F(t);if(!isFinite(e))e=0;if(e<0)e=0;if(1<e)e=1;return e}function B(t){if(t<0)t=0;if(1<t)t=1;return e=t,Math.log(e)/Math.log(10)*20;var e}function F(t){return Math.pow(10,t/20)}document.addEventListener("touchend",i,!0),document.addEventListener("click",i,!0),document.addEventListener("keydown",i,!0);var j={};function G(t){if(t=t.toLowerCase(),j.hasOwnProperty(t))if(j[t].length)return j[t][0].getInputNode();return p.destination}function V(){if(p.createGain)return p.createGain();else return p.createGainNode()}function U(t){if(p.createDelay)return p.createDelay(t);else return p.createDelayNode(t)}function W(t,e){if(t.start)t.start(e||0);else t.noteOn(e||0)}function $(t,e,i,n){if(t.start)t.start(n||0,e);else t.noteGrainOn(n||0,e,i-e)}function H(t){try{if(t.stop)t.stop(0);else t.noteOff(0)}catch(t){}}function J(t,e,i,n){if(t)if(t.cancelScheduledValues(0),0!==n){var r=p.currentTime;switch(n+=r,i){case 0:t.setValueAtTime(e,n);break;case 1:t.setValueAtTime(t.value,r),t.linearRampToValueAtTime(e,n);break;case 2:t.setValueAtTime(t.value,r),t.exponentialRampToValueAtTime(e,n)}}else t.value=e}var K=["lowpass","highpass","bandpass","lowshelf","highshelf","peaking","notch","allpass"];function q(t,e,i,n,r,o){if(this.type="filter",this.params=[t,e,i,n,r,o],this.inputNode=V(),this.wetNode=V(),this.wetNode.gain.value=o,this.dryNode=V(),this.dryNode.gain.value=1-o,this.filterNode=p.createBiquadFilter(),"number"==typeof this.filterNode.type)this.filterNode.type=t;else this.filterNode.type=K[t];if(this.filterNode.frequency.value=e,this.filterNode.detune)this.filterNode.detune.value=i;this.filterNode.Q.value=n,this.filterNode.gain.value=r,this.inputNode.connect(this.filterNode),this.inputNode.connect(this.dryNode),this.filterNode.connect(this.wetNode)}function z(t,e,i){this.type="delay",this.params=[t,e,i],this.inputNode=V(),this.wetNode=V(),this.wetNode.gain.value=i,this.dryNode=V(),this.dryNode.gain.value=1-i,this.mainNode=V(),this.delayNode=U(t),this.delayNode.delayTime.value=t,this.delayGainNode=V(),this.delayGainNode.gain.value=e,this.inputNode.connect(this.mainNode),this.inputNode.connect(this.dryNode),this.mainNode.connect(this.wetNode),this.mainNode.connect(this.delayNode),this.delayNode.connect(this.delayGainNode),this.delayGainNode.connect(this.mainNode)}function X(t,e,i,n){if(this.type="convolve",this.params=[e,i,n],this.inputNode=V(),this.wetNode=V(),this.wetNode.gain.value=i,this.dryNode=V(),this.dryNode.gain.value=1-i,this.convolveNode=p.createConvolver(),t)this.convolveNode.normalize=e,this.convolveNode.buffer=t;this.inputNode.connect(this.convolveNode),this.inputNode.connect(this.dryNode),this.convolveNode.connect(this.wetNode)}function Y(t,e,i,n,r){this.type="flanger",this.params=[t,e,i,n,r],this.inputNode=V(),this.dryNode=V(),this.dryNode.gain.value=1-r/2,this.wetNode=V(),this.wetNode.gain.value=r/2,this.feedbackNode=V(),this.feedbackNode.gain.value=n,this.delayNode=U(t+e),this.delayNode.delayTime.value=t,this.oscNode=p.createOscillator(),this.oscNode.frequency.value=i,this.oscGainNode=V(),this.oscGainNode.gain.value=e,this.inputNode.connect(this.delayNode),this.inputNode.connect(this.dryNode),this.delayNode.connect(this.wetNode),this.delayNode.connect(this.feedbackNode),this.feedbackNode.connect(this.delayNode),this.oscNode.connect(this.oscGainNode),this.oscGainNode.connect(this.delayNode.delayTime),W(this.oscNode)}function Q(t,e,i,n,r,o){if(this.type="phaser",this.params=[t,e,i,n,r,o],this.inputNode=V(),this.dryNode=V(),this.dryNode.gain.value=1-o/2,this.wetNode=V(),this.wetNode.gain.value=o/2,this.filterNode=p.createBiquadFilter(),"number"==typeof this.filterNode.type)this.filterNode.type=7;else this.filterNode.type="allpass";if(this.filterNode.frequency.value=t,this.filterNode.detune)this.filterNode.detune.value=e;this.filterNode.Q.value=i,this.oscNode=p.createOscillator(),this.oscNode.frequency.value=r,this.oscGainNode=V(),this.oscGainNode.gain.value=n,this.inputNode.connect(this.filterNode),this.inputNode.connect(this.dryNode),this.filterNode.connect(this.wetNode),this.oscNode.connect(this.oscGainNode),this.oscGainNode.connect(this.filterNode.frequency),W(this.oscNode)}function Z(t){this.type="gain",this.params=[t],this.node=V(),this.node.gain.value=t}function tt(t,e){this.type="tremolo",this.params=[t,e],this.node=V(),this.node.gain.value=1-e/2,this.oscNode=p.createOscillator(),this.oscNode.frequency.value=t,this.oscGainNode=V(),this.oscGainNode.gain.value=e/2,this.oscNode.connect(this.oscGainNode),this.oscGainNode.connect(this.node.gain),W(this.oscNode)}function et(t,e){this.type="ringmod",this.params=[t,e],this.inputNode=V(),this.wetNode=V(),this.wetNode.gain.value=e,this.dryNode=V(),this.dryNode.gain.value=1-e,this.ringNode=V(),this.ringNode.gain.value=0,this.oscNode=p.createOscillator(),this.oscNode.frequency.value=t,this.oscNode.connect(this.ringNode.gain),W(this.oscNode),this.inputNode.connect(this.ringNode),this.inputNode.connect(this.dryNode),this.ringNode.connect(this.wetNode)}function it(t,e,i,n,r){this.type="distortion",this.params=[t,e,i,n,r],this.inputNode=V(),this.preGain=V(),this.postGain=V(),this.setDrive(i,F(n)),this.wetNode=V(),this.wetNode.gain.value=r,this.dryNode=V(),this.dryNode.gain.value=1-r,this.waveShaper=p.createWaveShaper(),this.curve=new Float32Array(65536),this.generateColortouchCurve(t,e),this.waveShaper.curve=this.curve,this.inputNode.connect(this.preGain),this.inputNode.connect(this.dryNode),this.preGain.connect(this.waveShaper),this.waveShaper.connect(this.postGain),this.postGain.connect(this.wetNode)}function nt(t,e,i,n,r){this.type="compressor",this.params=[t,e,i,n,r],this.node=p.createDynamicsCompressor();try{this.node.threshold.value=t,this.node.knee.value=e,this.node.ratio.value=i,this.node.attack.value=n,this.node.release.value=r}catch(t){}}function rt(t,e){this.type="analyser",this.params=[t,e],this.node=p.createAnalyser(),this.node.fftSize=t,this.node.smoothingTimeConstant=e,this.freqBins=new Float32Array(this.node.frequencyBinCount),this.signal=new Uint8Array(t),this.peak=0,this.rms=0}function ot(){this.obj=null,this.loadUid=0}function st(e,t,i){var n=this,r=this;if(this.src=e,this.type=t,this.myapi=d,this.is_music=i,this.added_end_listener=!1,this.outNode=null,this.mediaSourceNode=null,this.panWhenReady=[],this.seekWhenReady=0,this.pauseWhenReady=!1,this.supportWebAudioAPI=!1,this.failedToLoad=!1,this.needsSoftwareDecode="audio/webm; codecs=opus"===this.type&&!_,this.wasEverReady=!1,this.is_music&&this.needsSoftwareDecode)M=!0;if(d===u&&i&&!k&&!this.needsSoftwareDecode)this.myapi=c,this.outNode=V();switch(this.bufferObject=null,this.audioData=null,this.myapi){case c:if(this.is_music){if(this.bufferObject=new Audio,this.bufferObject.crossOrigin="anonymous",this.bufferObject.addEventListener("canplaythrough",function(){r.wasEverReady=!0}),d===u&&p.createMediaElementSource&&!/wiiu/i.test(navigator.userAgent))this.supportWebAudioAPI=!0,this.bufferObject.addEventListener("canplay",function(){if(!r.mediaSourceNode&&r.bufferObject)r.mediaSourceNode=p.createMediaElementSource(r.bufferObject),r.mediaSourceNode.connect(r.outNode)});this.bufferObject.autoplay=!1,this.bufferObject.preload="auto",e=xfruntime.manifest[e]?xfruntime.manifest[e]:e,this.bufferObject.src=e,this.bufferObject.load()}else xfruntime.xfPreloadGroup.push(e+"?xf?api=api_html5&type=stream",function(t){n.handleHtml5Source(e,t)});break;case u:if(this.is_music){(new xf.XfLoader).loadResItem(e+"?xf?api=api_webaudio&type=stream").then(function(t){n.handleWebAudio5Source(t)})}else xfruntime.xfPreloadGroup.push(e+"?xf?api=api_webaudio&type=stream",function(t){n.handleWebAudio5Source(t[e])});break;case h:this.bufferObject=!0}}function at(t,e){var i=this;this.tag=e,this.fresh=!0,this.stopped=!0,this.src=t.src,this.buffer=t,this.myapi=d,this.is_music=t.is_music,this.playbackRate=1,this.hasPlaybackEnded=!0,this.resume_me=!1,this.is_paused=!1,this.resume_position=0,this.looping=!1,this.is_muted=!1,this.is_silent=!1,this.volume=1,this.onended_handler=function(t){if(!i.is_paused&&!i.resume_me){var e=this;if(!e)e=t.target;if(e===i.active_buffer)i.hasPlaybackEnded=!0,i.stopped=!0,s=i.tag,l.trigger(drama.plugins_.Audio.prototype.cnds.OnEnded,o)}},this.active_buffer=null,this.isTimescaled=1===g&&!this.is_music||2===g,this.mutevol=1,this.startTime=this.isTimescaled?l.kahanTime.sum:l.wallTime.sum,this.gainNode=null,this.pannerNode=null,this.pannerEnabled=!1,this.objectTracker=null,this.panX=0,this.panY=0,this.panAngle=0,this.panConeInner=0,this.panConeOuter=0,this.panConeOuterGain=0,this.instanceObject=null;var n=!1;if("weChat"===xfConfig.platform){var r=wx.createInnerAudioContext();return r.autoplay=!1,r.src=t.bufferObject,r.onPlay(function(){console.log("开始播放")}),r.onError(function(t){console.log(t.errMsg),console.log(t.errCode)}),r.onEnded(function(){s=i.tag,i.stopped=!0,l.trigger(drama.plugins_.Audio.prototype.cnds.OnEnded,o)}),void(this.instanceObject=r)}if(this.myapi===u&&this.buffer.myapi===c&&!this.buffer.supportWebAudioAPI)this.myapi=c;switch(this.myapi){case c:if(this.is_music)this.instanceObject=t.bufferObject,n=!t.added_end_listener,t.added_end_listener=!0;else this.instanceObject=new Audio,this.instanceObject.crossOrigin="anonymous",this.instanceObject.autoplay=!1,this.instanceObject.src=t.bufferObject.src,n=!0;if(n)this.instanceObject.addEventListener("ended",function(){s=i.tag,i.stopped=!0,l.trigger(drama.plugins_.Audio.prototype.cnds.OnEnded,o)});break;case u:if(this.gainNode=V(),this.gainNode.connect(G(e)),this.buffer.myapi===u){if(t.bufferObject)this.instanceObject=p.createBufferSource(),this.instanceObject.buffer=t.bufferObject,this.instanceObject.connect(this.gainNode)}else if(this.instanceObject=this.buffer.bufferObject,this.buffer.outNode.connect(this.gainNode),!this.buffer.added_end_listener)this.buffer.added_end_listener=!0,this.buffer.bufferObject.addEventListener("ended",function(){s=i.tag,i.stopped=!0,l.trigger(drama.plugins_.Audio.prototype.cnds.OnEnded,o)});break;case h:this.instanceObject=new window.Media(a+this.src,null,null,function(t){if(t===window.Media.MEDIA_STOPPED)i.hasPlaybackEnded=!0,i.stopped=!0,s=i.tag,l.trigger(drama.plugins_.Audio.prototype.cnds.OnEnded,o)})}}q.prototype.connectTo=function(t){this.wetNode.disconnect(),this.wetNode.connect(t),this.dryNode.disconnect(),this.dryNode.connect(t)},q.prototype.remove=function(){this.inputNode.disconnect(),this.filterNode.disconnect(),this.wetNode.disconnect(),this.dryNode.disconnect()},q.prototype.getInputNode=function(){return this.inputNode},q.prototype.setParam=function(t,e,i,n){switch(t){case 0:if((e/=100)<0)e=0;if(1<e)e=1;this.params[5]=e,J(this.wetNode.gain,e,i,n),J(this.dryNode.gain,1-e,i,n);break;case 1:this.params[1]=e,J(this.filterNode.frequency,e,i,n);break;case 2:this.params[2]=e,J(this.filterNode.detune,e,i,n);break;case 3:this.params[3]=e,J(this.filterNode.Q,e,i,n);break;case 4:this.params[4]=e,J(this.filterNode.gain,e,i,n)}},z.prototype.connectTo=function(t){this.wetNode.disconnect(),this.wetNode.connect(t),this.dryNode.disconnect(),this.dryNode.connect(t)},z.prototype.remove=function(){this.inputNode.disconnect(),this.mainNode.disconnect(),this.delayNode.disconnect(),this.delayGainNode.disconnect(),this.wetNode.disconnect(),this.dryNode.disconnect()},z.prototype.getInputNode=function(){return this.inputNode},z.prototype.setParam=function(t,e,i,n){switch(t){case 0:if((e/=100)<0)e=0;if(1<e)e=1;this.params[2]=e,J(this.wetNode.gain,e,i,n),J(this.dryNode.gain,1-e,i,n);break;case 4:this.params[1]=N(e),J(this.delayGainNode.gain,N(e),i,n);break;case 5:this.params[0]=e,J(this.delayNode.delayTime,e,i,n)}},X.prototype.connectTo=function(t){this.wetNode.disconnect(),this.wetNode.connect(t),this.dryNode.disconnect(),this.dryNode.connect(t)},X.prototype.remove=function(){this.inputNode.disconnect(),this.convolveNode.disconnect(),this.wetNode.disconnect(),this.dryNode.disconnect()},X.prototype.getInputNode=function(){return this.inputNode},X.prototype.setParam=function(t,e,i,n){switch(t){case 0:if((e/=100)<0)e=0;if(1<e)e=1;this.params[1]=e,J(this.wetNode.gain,e,i,n),J(this.dryNode.gain,1-e,i,n)}},Y.prototype.connectTo=function(t){this.dryNode.disconnect(),this.dryNode.connect(t),this.wetNode.disconnect(),this.wetNode.connect(t)},Y.prototype.remove=function(){this.inputNode.disconnect(),this.delayNode.disconnect(),this.oscNode.disconnect(),this.oscGainNode.disconnect(),this.dryNode.disconnect(),this.wetNode.disconnect(),this.feedbackNode.disconnect()},Y.prototype.getInputNode=function(){return this.inputNode},Y.prototype.setParam=function(t,e,i,n){switch(t){case 0:if((e/=100)<0)e=0;if(1<e)e=1;this.params[4]=e,J(this.wetNode.gain,e/2,i,n),J(this.dryNode.gain,1-e/2,i,n);break;case 6:this.params[1]=e/1e3,J(this.oscGainNode.gain,e/1e3,i,n);break;case 7:this.params[2]=e,J(this.oscNode.frequency,e,i,n);break;case 8:this.params[3]=e/100,J(this.feedbackNode.gain,e/100,i,n)}},Q.prototype.connectTo=function(t){this.dryNode.disconnect(),this.dryNode.connect(t),this.wetNode.disconnect(),this.wetNode.connect(t)},Q.prototype.remove=function(){this.inputNode.disconnect(),this.filterNode.disconnect(),this.oscNode.disconnect(),this.oscGainNode.disconnect(),this.dryNode.disconnect(),this.wetNode.disconnect()},Q.prototype.getInputNode=function(){return this.inputNode},Q.prototype.setParam=function(t,e,i,n){switch(t){case 0:if((e/=100)<0)e=0;if(1<e)e=1;this.params[5]=e,J(this.wetNode.gain,e/2,i,n),J(this.dryNode.gain,1-e/2,i,n);break;case 1:this.params[0]=e,J(this.filterNode.frequency,e,i,n);break;case 2:this.params[1]=e,J(this.filterNode.detune,e,i,n);break;case 3:this.params[2]=e,J(this.filterNode.Q,e,i,n);break;case 6:this.params[3]=e,J(this.oscGainNode.gain,e,i,n);break;case 7:this.params[4]=e,J(this.oscNode.frequency,e,i,n)}},Z.prototype.connectTo=function(t){this.node.disconnect(),this.node.connect(t)},Z.prototype.remove=function(){this.node.disconnect()},Z.prototype.getInputNode=function(){return this.node},Z.prototype.setParam=function(t,e,i,n){switch(t){case 4:this.params[0]=N(e),J(this.node.gain,N(e),i,n)}},tt.prototype.connectTo=function(t){this.node.disconnect(),this.node.connect(t)},tt.prototype.remove=function(){this.oscNode.disconnect(),this.oscGainNode.disconnect(),this.node.disconnect()},tt.prototype.getInputNode=function(){return this.node},tt.prototype.setParam=function(t,e,i,n){switch(t){case 0:if((e/=100)<0)e=0;if(1<e)e=1;this.params[1]=e,J(this.node.gain.value,1-e/2,i,n),J(this.oscGainNode.gain.value,e/2,i,n);break;case 7:this.params[0]=e,J(this.oscNode.frequency,e,i,n)}},et.prototype.connectTo=function(t){this.wetNode.disconnect(),this.wetNode.connect(t),this.dryNode.disconnect(),this.dryNode.connect(t)},et.prototype.remove=function(){this.oscNode.disconnect(),this.ringNode.disconnect(),this.inputNode.disconnect(),this.wetNode.disconnect(),this.dryNode.disconnect()},et.prototype.getInputNode=function(){return this.inputNode},et.prototype.setParam=function(t,e,i,n){switch(t){case 0:if((e/=100)<0)e=0;if(1<e)e=1;this.params[1]=e,J(this.wetNode.gain,e,i,n),J(this.dryNode.gain,1-e,i,n);break;case 7:this.params[0]=e,J(this.oscNode.frequency,e,i,n)}},it.prototype.setDrive=function(t,e){if(t<.01)t=.01;this.preGain.gain.value=t,this.postGain.gain.value=Math.pow(1/t,.6)*e},it.prototype.shape=function(t,e,i){var n,r,o=1.05*i*e-e,s=t<0?-1:1,a=t<0?-t:t,l=a<e?a:e+o*(n=a-e,r=1/o,1-Math.exp(-r*n));return l*=s},it.prototype.generateColortouchCurve=function(t,e){for(var i=F(t),n=F(e),r=0,o=0;o<32768;++o)r=o/32768,r=this.shape(r,i,n),this.curve[32768+o]=r,this.curve[32768-o-1]=-r},it.prototype.connectTo=function(t){this.wetNode.disconnect(),this.wetNode.connect(t),this.dryNode.disconnect(),this.dryNode.connect(t)},it.prototype.remove=function(){this.inputNode.disconnect(),this.preGain.disconnect(),this.waveShaper.disconnect(),this.postGain.disconnect(),this.wetNode.disconnect(),this.dryNode.disconnect()},it.prototype.getInputNode=function(){return this.inputNode},it.prototype.setParam=function(t,e,i,n){switch(t){case 0:if((e/=100)<0)e=0;if(1<e)e=1;this.params[4]=e,J(this.wetNode.gain,e,i,n),J(this.dryNode.gain,1-e,i,n)}},nt.prototype.connectTo=function(t){this.node.disconnect(),this.node.connect(t)},nt.prototype.remove=function(){this.node.disconnect()},nt.prototype.getInputNode=function(){return this.node},nt.prototype.setParam=function(t,e,i,n){},rt.prototype.tick=function(){this.node.getFloatFrequencyData(this.freqBins),this.node.getByteTimeDomainData(this.signal);for(var t=this.node.fftSize,e=0,i=this.peak=0,n=0;e<t;e++){if((n=(this.signal[e]-128)/128)<0)n=-n;if(this.peak<n)this.peak=n;i+=n*n}this.peak=B(this.peak),this.rms=B(Math.sqrt(i/t))},rt.prototype.connectTo=function(t){this.node.disconnect(),this.node.connect(t)},rt.prototype.remove=function(){this.node.disconnect()},rt.prototype.getInputNode=function(){return this.node},rt.prototype.setParam=function(t,e,i,n){},ot.prototype.setObject=function(t){this.obj=t},ot.prototype.hasObject=function(){return!!this.obj},ot.prototype.tick=function(t){},st.prototype.handleHtml5Source=function(t,e){var i=e[t];if(i){if(this.bufferObject=i,this.wasEverReady=!0,d===u&&p.createMediaElementSource&&!/wiiu/i.test(navigator.userAgent))if(this.supportWebAudioAPI=!0,!this.mediaSourceNode&&this.bufferObject)this.mediaSourceNode=p.createMediaElementSource(this.bufferObject),this.mediaSourceNode.connect(this.outNode)}else this.failedToLoad=!0},st.prototype.handleWebAudio5Source=function(t){var e=t;if(e)this.audioData=e,this.decodeAudioBuffer();else this.failedToLoad=!0},st.prototype.release=function(){var t,e,i,n;for(i=t=0,e=S.length;t<e;++t)if(n=S[t],(S[i]=n).buffer===this)n.stop();else++i;if(S.length=i,this.mediaSourceNode)this.mediaSourceNode.disconnect(),this.mediaSourceNode=null;if(this.outNode)this.outNode.disconnect(),this.outNode=null;this.bufferObject=null,this.audioData=null},st.prototype.decodeAudioBuffer=function(){if(!this.bufferObject&&this.audioData){var n=this;if(this.needsSoftwareDecode){var t=this.audioData;this.audioData=null,window.OpusDecoder(t,function(t,e){if(!t){var i=p.createBuffer(1,e.length,48e3);i.getChannelData(0).set(e),n.onDecodeComplete(i)}else n.onDecodeError(t)})}else this.decode({buf:this.audioData,sync:0,retry:0})}},st.prototype.decode=function(e){var i=this;try{p.decodeAudioData(e.buf,function(t){i.onDecodeComplete(t)},function(t){if(i.syncStream(e))i.decode(e);else i.onDecodeError(t)})}catch(t){console.log("decode exception",t.message)}},st.prototype.syncStream=function(t){var e=new Uint8Array(t.buf);e.indexOf=Array.prototype.indexOf;for(var i=t.sync,n=e;t.retry++,!(-1==(i=n.indexOf(255,i))||!0&n[i+1]);)i++;if(-1==i)return!1;var r=t.buf.slice(i);return delete t.buf,t.buf=null,t.buf=r,t.sync=i,!0},st.prototype.onDecodeComplete=function(t){var e,i,n,r;if(this.bufferObject=t,this.audioData=null,!drama.is_undefined(this.playTagWhenReady)&&!I)if(this.panWhenReady.length){for(i=0,n=this.panWhenReady.length;i<n;i++){if((r=new at(this,(e=this.panWhenReady[i]).thistag)).setPannerEnabled(!0),void 0!==e.objUid)if(e.obj=l.getObjectByUID(e.objUid),!e.obj)continue;if(e.obj){var o=drama.rotatePtAround(e.obj.x,e.obj.y,-e.obj.layer.getAngle(),y,v,!0),s=drama.rotatePtAround(e.obj.x,e.obj.y,-e.obj.layer.getAngle(),y,v,!1);r.setPan(o,s,drama.to_degrees(e.obj.angle-e.obj.layer.getAngle()),e.ia,e.oa,e.og),r.setObject(e.obj)}else r.setPan(e.x,e.y,e.a,e.ia,e.oa,e.og);if(r.play(this.loopWhenReady,this.volumeWhenReady,this.seekWhenReady),this.pauseWhenReady)r.pause();S.push(r)}drama.clearArray(this.panWhenReady)}else{if((r=new at(this,this.playTagWhenReady||"")).play(this.loopWhenReady,this.volumeWhenReady,this.seekWhenReady),this.pauseWhenReady)r.pause();S.push(r)}else if(!drama.is_undefined(this.convolveWhenReady)){var a=this.convolveWhenReady.convolveNode;a.normalize=this.normalizeWhenReady,a.buffer=t}},st.prototype.onDecodeError=function(t){self.failedToLoad=!0,console.error("Failed to decode audio '"+this.src+"': "+t)},st.prototype.isLoaded=function(){switch(this.myapi){case c:var t=4<=this.bufferObject.readyState;if(t)this.wasEverReady=!0;return t||this.wasEverReady;case u:return!!this.audioData||!!this.bufferObject;case h:return!0}return!1},st.prototype.isLoadedAndDecoded=function(){switch(this.myapi){case c:return this.isLoaded();case u:return!!this.bufferObject;case h:return!0}return!1},st.prototype.hasFailedToLoad=function(){switch(this.myapi){case c:return!!this.bufferObject.error;case u:return this.failedToLoad}return!1},at.prototype.hasEnded=function(){if("weChat"===xfConfig.platform){if(!this.fresh&&!this.stopped&&this.instanceObject.loop)return!1;if(this.is_paused)return!1;else return this.instanceObject.currentTime>=this.instanceObject.duration}switch(this.myapi){case c:return this.instanceObject.ended;case u:if(this.buffer.myapi===u){if(!this.fresh&&!this.stopped&&this.instanceObject.loop)return!1;if(this.is_paused)return!1;else return this.hasPlaybackEnded}else return this.instanceObject.ended;case h:return this.hasPlaybackEnded}return!0},at.prototype.canBeRecycled=function(){if(this.fresh||this.stopped)return!0;else return this.hasEnded()},at.prototype.setPannerEnabled=function(t){if(d===u)if(!this.pannerEnabled&&t){if(!this.gainNode)return;if(!this.pannerNode){if(this.pannerNode=p.createPanner(),"number"==typeof this.pannerNode.panningModel)this.pannerNode.panningModel=n;else this.pannerNode.panningModel=["equalpower","HRTF","soundfield"][n];if("number"==typeof this.pannerNode.distanceModel)this.pannerNode.distanceModel=r;else this.pannerNode.distanceModel=["linear","inverse","exponential"][r];this.pannerNode.refDistance=w,this.pannerNode.maxDistance=x,this.pannerNode.rolloffFactor=C}this.gainNode.disconnect(),this.gainNode.connect(this.pannerNode),this.pannerNode.connect(G(this.tag)),this.pannerEnabled=!0}else if(this.pannerEnabled&&!t){if(!this.gainNode)return;this.pannerNode.disconnect(),this.gainNode.disconnect(),this.gainNode.connect(G(this.tag)),this.pannerEnabled=!1}},at.prototype.setPan=function(t,e,i,n,r,o){if(this.pannerEnabled&&d===u)this.pannerNode.setPosition(t,e,0),this.pannerNode.setOrientation(Math.cos(drama.to_radians(i)),Math.sin(drama.to_radians(i)),0),this.pannerNode.coneInnerAngle=n,this.pannerNode.coneOuterAngle=r,this.pannerNode.coneOuterGain=o,this.panX=t,this.panY=e,this.panAngle=i,this.panConeInner=n,this.panConeOuter=r,this.panConeOuterGain=o},at.prototype.setObject=function(t){if(this.pannerEnabled&&d===u){if(!this.objectTracker)this.objectTracker=new ot;this.objectTracker.setObject(t)}},at.prototype.tick=function(t){if(this.pannerEnabled&&d===u&&this.objectTracker&&this.objectTracker.hasObject()&&this.isPlaying()){this.objectTracker.tick(t);var e=this.objectTracker.obj,i=drama.rotatePtAround(e.x,e.y,-e.layer.getAngle(),y,v,!0),n=drama.rotatePtAround(e.x,e.y,-e.layer.getAngle(),y,v,!1);this.pannerNode.setPosition(i,n,0);var r=0;if(void 0!==this.objectTracker.obj.angle)r=e.angle-e.layer.getAngle(),this.pannerNode.setOrientation(Math.cos(r),Math.sin(r),0)}},at.prototype.play=function(t,e,i,n){var r=this.instanceObject;this.looping=t||this.looping,this.volume=e||this.volume;var o=i||0;if(n=n||0,"weChat"===xfConfig.platform)r.playbackRate=1,r.volume=this.volume*T,r.loop=this.looping,r.startTime=o,r.play();else switch(this.myapi){case c:if(1!==r.playbackRate)r.playbackRate=1;if(r.volume!==e*T)r.volume=this.volume*T;if(r.loop!==t)r.loop=this.looping;if(r.muted)r.muted=!1;if(r.currentTime!==o)try{r.currentTime=o}catch(t){log("Exception rewinding audio: "+t)}D(this);break;case u:if(this.muted=!1,this.mutevol=1,this.buffer.myapi===u){if(this.gainNode.gain.value=e*T,!this.fresh)this.instanceObject=p.createBufferSource(),this.instanceObject.buffer=this.buffer.bufferObject,this.instanceObject.connect(this.gainNode);if(this.instanceObject.onended=this.onended_handler,this.active_buffer=this.instanceObject,this.instanceObject.loop=t,this.hasPlaybackEnded=!1,0===o)W(this.instanceObject,n);else $(this.instanceObject,o,this.getDuration(),n)}else{if(1!==r.playbackRate)r.playbackRate=1;if(r.loop!==t)r.loop=t;if(r.volume=e*T,r.currentTime!==o)try{r.currentTime=o}catch(t){log("Exception rewinding audio: "+t)}D(this)}break;case h:if(!this.fresh&&this.stopped||0!==o)r.seekTo(o);r.play(),this.hasPlaybackEnded=!1}this.playbackRate=1,this.startTime=(this.isTimescaled?l.kahanTime.sum:l.wallTime.sum)-o,this.fresh=!1,this.stopped=!1,this.is_paused=!1},at.prototype.stop=function(){if("weChat"===xfConfig.platform)this.instanceObject.pause();else switch(this.myapi){case c:if(!this.instanceObject.paused)this.instanceObject.pause();break;case u:if(this.buffer.myapi===u)H(this.instanceObject);else if(!this.instanceObject.paused)this.instanceObject.pause();break;case h:this.instanceObject.stop()}this.stopped=!0,this.is_paused=!1},at.prototype.pause=function(){if(!(this.fresh||this.stopped||this.hasEnded()||this.is_paused)){if("weChat"===xfConfig.platform)this.instanceObject.pause();else switch(this.myapi){case c:if(!this.instanceObject.paused)this.instanceObject.pause();break;case u:if(this.buffer.myapi===u){if(this.resume_position=this.getPlaybackTime(!0),this.looping)this.resume_position=this.resume_position%this.getDuration();this.is_paused=!0,H(this.instanceObject)}else if(!this.instanceObject.paused)this.instanceObject.pause();break;case h:this.instanceObject.pause()}this.is_paused=!0}},at.prototype.resume=function(){if(!(this.fresh||this.stopped||this.hasEnded())&&this.is_paused){if("weChat"===xfConfig.platform)this.instanceObject.play();else switch(this.myapi){case c:D(this);break;case u:if(this.buffer.myapi===u)this.instanceObject=p.createBufferSource(),this.instanceObject.buffer=this.buffer.bufferObject,this.instanceObject.connect(this.gainNode),this.instanceObject.onended=this.onended_handler,this.active_buffer=this.instanceObject,this.instanceObject.loop=this.looping,this.gainNode.gain.value=T*this.volume*this.mutevol,this.updatePlaybackRate(),this.startTime=(this.isTimescaled?l.kahanTime.sum:l.wallTime.sum)-this.resume_position/(this.playbackRate||.001),$(this.instanceObject,this.resume_position,this.getDuration());else D(this);break;case h:this.instanceObject.play()}this.is_paused=!1}},at.prototype.seek=function(t){if(!(this.fresh||this.stopped||this.hasEnded()))if("weChat"===xfConfig.platform)this.instanceObject.currentTime=t;else switch(this.myapi){case c:try{this.instanceObject.currentTime=t}catch(t){}break;case u:if(this.buffer.myapi===u)if(this.is_paused)this.resume_position=t;else this.pause(),this.resume_position=t,this.resume();else try{this.instanceObject.currentTime=t}catch(t){}}},at.prototype.reconnect=function(t){if(this.myapi===u)if(this.pannerEnabled)this.pannerNode.disconnect(),this.pannerNode.connect(t);else this.gainNode.disconnect(),this.gainNode.connect(t)},at.prototype.getDuration=function(t){var e=0;if("weChat"===xfConfig.platform)e=this.instanceObject.duration;else switch(this.myapi){case c:if(void 0!==this.instanceObject.duration)e=this.instanceObject.duration;break;case u:e=this.buffer.bufferObject.duration;break;case h:e=this.instanceObject.getDuration()}if(t)e/=this.playbackRate||.001;return e},at.prototype.getPlaybackTime=function(t){var e=this.getDuration(),i=0;if("weChat"===xfConfig.platform)i=this.instanceObject.currentTime;else switch(this.myapi){case c:if(void 0!==this.instanceObject.currentTime)i=this.instanceObject.currentTime;break;case u:if(this.buffer.myapi===u)if(this.is_paused)return this.resume_position;else i=(this.isTimescaled?l.kahanTime.sum:l.wallTime.sum)-this.startTime;else if(void 0!==this.instanceObject.currentTime)i=this.instanceObject.currentTime}if(t)i*=this.playbackRate;if(!this.looping&&e<i)i=e;return i},at.prototype.isPlaying=function(){return!(this.is_paused||this.fresh||this.stopped||this.hasEnded())},at.prototype.shouldSave=function(){return!this.fresh&&!this.stopped&&!this.hasEnded()},at.prototype.setVolume=function(t){this.volume=t,this.updateVolume()},at.prototype.updateVolume=function(){var t=this.volume*T;if(!isFinite(t))t=0;if("weChat"!==xfConfig.platform)switch(this.myapi){case c:if(void 0!==this.instanceObject.volume&&this.instanceObject.volume!==t)this.instanceObject.volume=t;break;case u:if(this.buffer.myapi===u)this.gainNode.gain.value=t*this.mutevol;else if(void 0!==this.instanceObject.volume&&this.instanceObject.volume!==t)this.instanceObject.volume=t}else this.instanceObject.volume=t},at.prototype.getVolume=function(){return this.volume},at.prototype.doSetMuted=function(t){if("weChat"!==xfConfig.platform)switch(this.myapi){case c:if(this.instanceObject.muted!==!!t){if(t)this.instanceObject.pause();else this.instanceObject.play();this.instanceObject.muted=!!t}break;case u:if(this.buffer.myapi===u){var e=t?0:1;if(this.mutevol!==e)this.mutevol=e,this.gainNode.gain.value=T*this.volume*this.mutevol}else if(this.instanceObject.muted!==!!t)this.instanceObject.muted=!!t}else if(this.instanceObject.muted!==!!t){if(t)this.instanceObject.pause();else this.instanceObject.play();this.instanceObject.muted=!!t}},at.prototype.setMuted=function(t){this.is_muted=!!t,this.doSetMuted(this.is_muted||this.is_silent)},at.prototype.setSilent=function(t){this.is_silent=!!t,this.doSetMuted(this.is_muted||this.is_silent)},at.prototype.setLooping=function(t){if(this.looping=t,"weChat"!==xfConfig.platform)switch(this.myapi){case c:case u:if(this.instanceObject.loop!==!!t)this.instanceObject.loop=!!t}else this.instanceObject.loop=!!t},at.prototype.setPlaybackRate=function(t){this.playbackRate=t,this.updatePlaybackRate()},at.prototype.getPlaybackRate=function(t){return this.playbackRate},at.prototype.updatePlaybackRate=function(){var t=this.playbackRate;if(this.isTimescaled)t*=l.timescale;if("weChat"!==xfConfig.platform)switch(this.myapi){case c:if(this.instanceObject.playbackRate!==t)this.instanceObject.playbackRate=t;break;case u:if(this.buffer.myapi===u){if(this.instanceObject.playbackRate.value!==t)this.instanceObject.playbackRate.value=t}else if(this.instanceObject.playbackRate!==t)this.instanceObject.playbackRate=t}else this.instanceObject.playbackRate=t},at.prototype.setSuspended=function(t){if("weChat"!==xfConfig.platform)switch(this.myapi){case c:if(t)if(this.isPlaying())this.resume_me=!0,this.instanceObject.pause();else this.resume_me=!1;else if(this.resume_me)this.instanceObject.play(),this.resume_me=!1;break;case u:if(t)if(this.isPlaying())if(this.resume_me=!0,this.buffer.myapi===u){if(this.resume_position=this.getPlaybackTime(!0),this.looping)this.resume_position=this.resume_position%this.getDuration();H(this.instanceObject)}else this.instanceObject.pause();else this.resume_me=!1;else if(this.resume_me){if(this.buffer.myapi===u)this.instanceObject=p.createBufferSource(),this.instanceObject.buffer=this.buffer.bufferObject,this.instanceObject.connect(this.gainNode),this.instanceObject.onended=this.onended_handler,this.active_buffer=this.instanceObject,this.instanceObject.loop=this.looping,this.gainNode.gain.value=T*this.volume*this.mutevol,this.updatePlaybackRate(),this.startTime=(this.isTimescaled?l.kahanTime.sum:l.wallTime.sum)-this.resume_position/(this.playbackRate||.001),$(this.instanceObject,this.resume_position,this.getDuration());else this.instanceObject.play();this.resume_me=!1}break;case h:if(t)if(this.isPlaying())this.instanceObject.pause(),this.resume_me=!0;else this.resume_me=!1;else if(this.resume_me)this.resume_me=!1,this.instanceObject.play()}else if(t)if(this.isPlaying())this.resume_me=!0,this.instanceObject.pause();else this.resume_me=!1;else if(this.resume_me)this.instanceObject.play(),this.resume_me=!1},t.Instance=function(t){if(this.type=t,this.runtime=t.runtime,l=this.runtime,(o=this).listenerTracker=null,this.listenerZ=-600,this.runtime.isWKWebView)k=!0;if((this.runtime.isiOS||this.runtime.isAndroid&&(this.runtime.isChrome||this.runtime.isAndroidStockBrowser))&&!this.runtime.isCrosswalk&&!this.runtime.isAmazonWebApp&&!k)E=!0;if(p=null,"undefined"!=typeof AudioContext)d=u,p=new window.AudioContext;else if("undefined"!=typeof webkitAudioContext)d=u,p=new window.webkitAudioContext;if(this.runtime.isiOS&&p){if(p.close)p.close();if("undefined"!=typeof AudioContext)p=new AudioContext;else if(void 0!==window.webkitAudioContext)p=new window.webkitAudioContext}if(d!==u)if(this.runtime.isCordova&&void 0!==window.Media)d=h;if(d===h){var e=(a=location.href).lastIndexOf("/");if(-1<e)a=a.substr(0,e+1);a=a.replace("file://","")}this.runtime.tickMe(this)};var lt=t.Instance.prototype;lt.onCreate=function(){this.runtime.audioInstance=this,g=this.properties[0],this.saveload=this.properties[1],this.playinbackground=this.properties[2],this.nextPlayTime=0,n=this.properties[3],r=this.properties[4],this.listenerZ=-this.properties[5],w=this.properties[6],x=this.properties[7],C=this.properties[8],this.listenerTracker=new ot;var t=this.runtime.draw_width||this.runtime.width,e=this.runtime.draw_height||this.runtime.height;if(d===u)p.listener.setPosition(t/2,e/2,this.listenerZ),p.listener.setOrientation(0,0,1,0,-1,0),window.c2OnAudioMicStream=function(t,e){if(O)O.disconnect();P=e.toLowerCase(),(O=p.createMediaStreamSource(t)).connect(G(P))};if(!this.runtime.isiOS)this.runtime.addSuspendCallback(function(t){o.onSuspend(t)});var i=this;this.runtime.addDestroyCallback(function(t){i.onInstanceDestroyed(t)})},lt.onInstanceDestroyed=function(t){var e,i,n;for(e=0,i=S.length;e<i;e++)if((n=S[e]).objectTracker)if(n.objectTracker.obj===t)if(n.objectTracker.obj=null,n.pannerEnabled&&n.isPlaying()&&n.looping)n.stop();if(this.listenerTracker.obj===t)this.listenerTracker.obj=null},lt.saveToJSON=function(){var t,e,i,n,r,o,s,a={silent:I,masterVolume:T,listenerZ:this.listenerZ,listenerUid:this.listenerTracker.hasObject()?this.listenerTracker.obj.uid:-1,playing:[],effects:{}},l=a.playing;for(t=0,e=S.length;t<e;t++)if((i=S[t]).shouldSave())if(3!==this.saveload)if(!i.is_music||1!==this.saveload)if(i.is_music||2!==this.saveload){if(s=i.getPlaybackTime(),i.looping)s%=i.getDuration();if(n={tag:i.tag,buffersrc:i.buffer.src,buffertype:i.buffer.type,is_music:i.is_music,playbackTime:s,volume:i.volume,looping:i.looping,muted:i.is_muted,playbackRate:i.playbackRate,paused:i.is_paused,resume_position:i.resume_position},i.pannerEnabled){if(n.pan={},o=n.pan,i.objectTracker&&i.objectTracker.hasObject())o.objUid=i.objectTracker.obj.uid;else o.x=i.panX,o.y=i.panY,o.a=i.panAngle;o.ia=i.panConeInner,o.oa=i.panConeOuter,o.og=i.panConeOuterGain}l.push(n)}var c,u=a.effects;for(r in j)if(j.hasOwnProperty(r)){for(c=[],t=0,e=j[r].length;t<e;t++)c.push({type:j[r][t].type,params:j[r][t].params});u[r]=c}return a};var ct=[];lt.loadFromJSON=function(t){var e=t.silent;T=t.masterVolume,this.listenerZ=t.listenerZ,this.listenerTracker.setObject(null);var i=t.listenerUid;if(-1!==i)this.listenerTracker.loadUid=i,ct.push(this.listenerTracker);var n,r,o,s,a,l,c,u,h,d,p,f,m,g,y,v,b,_,w,x=t.playing;if(3!==this.saveload)for(n=0,r=S.length;n<r;n++)if(!(f=S[n]).is_music||1!==this.saveload)if(f.is_music||2!==this.saveload)f.stop();for(m in j)if(j.hasOwnProperty(m))for(n=0,r=j[m].length;n<r;n++)j[m][n].remove();for(m in drama.wipe(j),t.effects)if(t.effects.hasOwnProperty(m))for(n=0,r=(v=t.effects[m]).length;n<r;n++)switch(b=v[n].type,_=v[n].params,b){case"filter":mt(m,new q(_[0],_[1],_[2],_[3],_[4],_[5]));break;case"delay":mt(m,new z(_[0],_[1],_[2]));break;case"convolve":if(s=_[2],(p=this.getAudioBuffer(s,!1)).bufferObject)w=new X(p.bufferObject,_[0],_[1],s);else w=new X(null,_[0],_[1],s),p.normalizeWhenReady=_[0],p.convolveWhenReady=w;mt(m,w);break;case"flanger":mt(m,new Y(_[0],_[1],_[2],_[3],_[4]));break;case"phaser":mt(m,new Q(_[0],_[1],_[2],_[3],_[4],_[5]));break;case"gain":mt(m,new Z(_[0]));break;case"tremolo":mt(m,new tt(_[0],_[1]));break;case"ringmod":mt(m,new et(_[0],_[1]));break;case"distortion":mt(m,new it(_[0],_[1],_[2],_[3],_[4]));break;case"compressor":mt(m,new nt(_[0],_[1],_[2],_[3],_[4]));break;case"analyser":mt(m,new rt(_[0],_[1]))}for(n=0,r=x.length;n<r;n++)if(3!==this.saveload)if(s=(o=x[n]).buffersrc,a=o.buffertype||"",l=o.is_music,c=o.tag,u=o.playbackTime,h=o.looping,d=o.volume,y=(g=o.pan)&&g.hasOwnProperty("objUid")?g.objUid:-1,!l||1!==this.saveload)if(l||2!==this.saveload)if(f=this.getAudioInstance({url:s,type:a},c,l,h,d)){if(f.resume_position=o.resume_position,f.setPannerEnabled(!!g),f.play(h,d,u),f.updatePlaybackRate(),f.updateVolume(),f.doSetMuted(f.is_muted||f.is_silent),o.paused)f.pause();if(o.muted)f.setMuted(!0);if(f.doSetMuted(f.is_muted||f.is_silent),g)if(-1!==y)f.objectTracker=f.objectTracker||new ot,f.objectTracker.loadUid=y,ct.push(f.objectTracker);else f.setPan(g.x,g.y,g.a,g.ia,g.oa,g.og)}else if((p=this.getAudioBuffer({url:s,type:""},l)).seekWhenReady=u,p.pauseWhenReady=o.paused,g)if(-1!==y)p.panWhenReady.push({objUid:y,ia:g.ia,oa:g.oa,og:g.og,thistag:c});else p.panWhenReady.push({x:g.x,y:g.y,a:g.a,ia:g.ia,oa:g.oa,og:g.og,thistag:c});if(e&&!I){for(n=0,r=S.length;n<r;n++)S[n].setSilent(!0);I=!0}else if(!e&&I){for(n=0,r=S.length;n<r;n++)S[n].setSilent(!1);I=!1}},lt.afterLoad=function(){var t,e,i,n;for(t=0,e=ct.length;t<e;t++)if(i=ct[t],n=this.runtime.getObjectByUID(i.loadUid),i.setObject(n),i.loadUid=-1,n)y=n.x,v=n.y;drama.clearArray(ct)},lt.onSuspend=function(t){if(!this.playinbackground){if(!t&&p&&p.resume)p.resume(),b=!1;var e,i;for(e=0,i=S.length;e<i;e++)S[e].setSuspended(t);if(t&&p&&p.suspend)p.suspend(),b=!0}},lt.tick=function(){var t,e,i,n,r,o,s=this.runtime.dt;for(t=0,e=S.length;t<e;t++)if((i=S[t]).tick(s),0!==g)i.updatePlaybackRate();for(n in j)if(j.hasOwnProperty(n))for(t=0,e=(r=j[n]).length;t<e;t++)if((o=r[t]).tick)o.tick();if(d===u&&this.listenerTracker.hasObject())this.listenerTracker.tick(s),y=this.listenerTracker.obj.x,v=this.listenerTracker.obj.y,p.listener.setPosition(this.listenerTracker.obj.x,this.listenerTracker.obj.y,this.listenerZ)};var ut=[];lt.setPreloadList=function(t){var e,i,n,r,o=0;for(e=0,i=t.length;e<i;++e)r=2*(n=t[e]).size,ut.push({filename:n.filename,size:r,type:n.type,obj:null}),o+=r;return o},lt.startPreloads=function(){var t,e,i,n;for(t=0,e=ut.length;t<e;++t)i=ut[t],n=this.runtime.getProjectFileUrl(i.filename),i.obj=this.getAudioBuffer({url:n,type:i.type},!1)},lt.getPreloadedSize=function(){var t,e,i,n=0;for(t=0,e=ut.length;t<e;++t)if((i=ut[t]).obj.isLoadedAndDecoded()||i.obj.hasFailedToLoad()||this.runtime.isAndroidStockBrowser)n+=i.size;else if(i.obj.isLoaded())n+=Math.floor(i.size/2);return n},lt.releaseAllMusicBuffers=function(){var t,e,i,n;for(i=t=0,e=f.length;t<e;++t)if(n=f[t],(f[i]=n).is_music)n.release();else++i;f.length=i},lt.getAudioBuffer=function(t,e,i){var n,r,o,s=null,a=t.url;for(n=0,r=f.length;n<r;n++)if((o=f[n]).src===a){s=o;break}if(!s&&!i){if((k||M)&&e)this.releaseAllMusicBuffers();s=new st(a,t.type,e),f.push(s)}return s},lt.getAudioInstance=function(t,e,i,n,r){var o,s,a,l=t.url;for(o=0,s=S.length;o<s;o++)if((a=S[o]).src===l&&(a.canBeRecycled()||i))return a.tag=e,a;var c=this.getAudioBuffer(t,i);if(c.bufferObject)return a=new at(c,e),S.push(a),a;if("<preload>"!==e)c.playTagWhenReady=e,c.loopWhenReady=n,c.volumeWhenReady=r;return null};var ht=[];function dt(t,e){var i=t.isPlaying()?1:0,n=e.isPlaying()?1:0;if(i===n)return 0;else if(i<n)return 1;else return-1}function pt(t,e){if(drama.clearArray(ht),!t.length)if(!m||m.hasEnded())return;else return drama.clearArray(ht),void(ht[0]=m);var i,n,r;for(i=0,n=S.length;i<n;i++)if(r=S[i],drama.equals_nocase(t,r.tag))ht.push(r);if(e)ht.sort(dt)}function ft(t){var e,i,n,r,o=p.destination;if(j.hasOwnProperty(t))if((n=j[t]).length)for(o=n[0].getInputNode(),e=0,i=n.length;e<i;e++)if(r=n[e],e+1===i)r.connectTo(p.destination);else r.connectTo(n[e+1].getInputNode());for(pt(t),e=0,i=ht.length;e<i;e++)ht[e].reconnect(o);if(O&&P===t)O.disconnect(),O.connect(o)}function mt(t,e){if(!j.hasOwnProperty(t))j[t]=[e];else j[t].push(e);ft(t)}function gt(){}function yt(){}function vt(){}function bt(t,e){var i=null;if(j.hasOwnProperty(t))i=j[t];if(i&&0<=e&&e<i.length&&i[e].freqBins)return i[e];else return null}lt.getDebuggerValues=function(t){var e,i,n,r,o=[],s="",a=0;for(r in j)if(j.hasOwnProperty(r)&&j[r].length){for(s="",e=0,i=j[r].length;e<i;++e)if(s+=j[r][e].type,e<i-1)s+=" -> ";o.push({name:"Tag '"+r+"' effects",value:s,readonly:!0})}if(o.length)t.push({title:"Effects",properties:o});for(s="",e=0,i=S.length;e<i;++e)if((n=S[e]).isPlaying()){if(a++,s+="<strong>"+n.src+"</strong>",n.tag.length)s+=" (tag <em>"+n.tag+"</em>)";s+=": "+Math.round(100*n.getPlaybackTime(!0))/100+" s / "+Math.round(100*n.getDuration())/100+" s<br/>"}s=a.toString()+" playing"+(0<a?":":"")+"<br/>"+s,t.push({title:"Audio",properties:[{name:"Audio engine",value:d===u?"Web Audio API":"HTML5 audio",readonly:!0},{name:"Currently playing",value:s,html:!0,readonly:!0}]})},xf.audioInstance=function(){return window.xfruntime.audioInstance},lt.Play=function(t,e,i,n){try{if(I)return;var r=i,o=this.runtime.audio_files_info_map[t[0]],s=this.runtime.getProjectAudioFileUrl(t[0]);if(!s)return;if(!(m=this.getAudioInstance(s,n,o,0!==e,r)))return;m.setPannerEnabled(!1),m.play(0!==e,r,0,this.nextPlayTime),this.nextPlayTime=0}catch(t){}},lt.SetVolume=function(t){var e,i;for(e=0,i=S.length;e<i;e++)S[e].setVolume(t)},lt.Stop=function(t){var e,i;for(pt(t),e=0,i=ht.length;e<i;e++)ht[e].stop()},lt.SetPaused=function(t,e){var i,n;for(pt(t),i=0,n=ht.length;i<n;i++)if(0===e)ht[i].pause();else ht[i].resume()},gt.prototype.OnEnded=function(t){return drama.equals_nocase(s,t)},gt.prototype.PreloadsComplete=function(){var t,e;for(t=0,e=f.length;t<e;t++)if(!f[t].isLoadedAndDecoded()&&!f[t].hasFailedToLoad())return!1;return!0},gt.prototype.AdvancedAudioSupported=function(){return d===u},gt.prototype.IsSilent=function(){return I},gt.prototype.IsAnyPlaying=function(){var t,e;for(t=0,e=S.length;t<e;t++)if(S[t].isPlaying())return!0;return!1},gt.prototype.IsTagPlaying=function(t){var e,i;for(pt(t),e=0,i=ht.length;e<i;e++)if(ht[e].isPlaying())return!0;return!1},t.cnds=new gt,yt.prototype.Play=function(t,e,i,n){if(!I){var r=N(i),o=t[1],s=this.runtime.getProjectAudioFileUrl(t[0]);if(s)if(m=this.getAudioInstance(s,n,o,0!==e,r))m.setPannerEnabled(!1),m.play(0!==e,r,0,this.nextPlayTime),this.nextPlayTime=0}},yt.prototype.PlayPercent=function(t,e,i,n){if(!I){if(i<0)i=0;else if(100<i)i=100;var r=i/100,o=t[1],s=this.runtime.getProjectAudioFileUrl(t[0]);if(s)if(m=this.getAudioInstance(s,n,o,0!==e,r))m.setPannerEnabled(!1),m.play(0!==e,r,0,this.nextPlayTime),this.nextPlayTime=0}},yt.prototype.PlayAtPosition=function(t,e,i,n,r,o,s,a,l,c){if(!I){var u=N(i),h=t[1],d=this.runtime.getProjectAudioFileUrl(t[0]);if(d)if(m=this.getAudioInstance(d,c,h,0!==e,u))m.setPannerEnabled(!0),m.setPan(n,r,o,s,a,N(l)),m.play(0!==e,u,0,this.nextPlayTime),this.nextPlayTime=0;else{this.getAudioBuffer(d,h).panWhenReady.push({x:n,y:r,a:o,ia:s,oa:a,og:N(l),thistag:c})}}},yt.prototype.PlayAtObject=function(t,e,i,n,r,o,s,a){if(!I&&n){var l=n.getFirstPicked();if(l){var c=N(i),u=t[1],h=this.runtime.getProjectAudioFileUrl(t[0]);if(h)if(m=this.getAudioInstance(h,a,u,0!==e,c)){m.setPannerEnabled(!0);var d=drama.rotatePtAround(l.x,l.y,-l.layer.getAngle(),y,v,!0),p=drama.rotatePtAround(l.x,l.y,-l.layer.getAngle(),y,v,!1);m.setPan(d,p,drama.to_degrees(l.angle-l.layer.getAngle()),r,o,N(s)),m.setObject(l),m.play(0!==e,c,0,this.nextPlayTime),this.nextPlayTime=0}else{this.getAudioBuffer(h,u).panWhenReady.push({obj:l,ia:r,oa:o,og:N(s),thistag:a})}}}},yt.prototype.PlayByName=function(t,e,i,n,r){if(!I){var o=N(n),s=1===t,a=this.runtime.getProjectAudioFileUrl(e);if(a)if(m=this.getAudioInstance(a,r,s,0!==i,o))m.setPannerEnabled(!1),m.play(0!==i,o,0,this.nextPlayTime),this.nextPlayTime=0}},yt.prototype.PlayByNamePercent=function(t,e,i,n,r){if(!I){var o=function(t){var e=t;if(t<0)e=0;else if(100<t)e=100;return e/100}(n),s=1===t,a=this.runtime.getProjectAudioFileUrl(e);if(a)if(m=this.getAudioInstance(a,r,s,0!==i,o))m.setPannerEnabled(!1),console.log(e,a,o),m.play(0!==i,o,0,this.nextPlayTime),this.nextPlayTime=0}},yt.prototype.PlayAtPositionByName=function(t,e,i,n,r,o,s,a,l,c,u){if(!I){var h=N(n),d=1===t,p=this.runtime.getProjectAudioFileUrl(e);if(p)if(m=this.getAudioInstance(p,u,d,0!==i,h))m.setPannerEnabled(!0),m.setPan(r,o,s,a,l,N(c)),m.play(0!==i,h,0,this.nextPlayTime),this.nextPlayTime=0;else{this.getAudioBuffer(p,d).panWhenReady.push({x:r,y:o,a:s,ia:a,oa:l,og:N(c),thistag:u})}}},yt.prototype.PlayAtObjectByName=function(t,e,i,n,r,o,s,a,l){if(!I&&r){var c=r.getFirstPicked();if(c){var u=N(n),h=1===t,d=this.runtime.getProjectAudioFileUrl(e);if(d)if(m=this.getAudioInstance(d,l,h,0!==i,u)){m.setPannerEnabled(!0);var p=drama.rotatePtAround(c.x,c.y,-c.layer.getAngle(),y,v,!0),f=drama.rotatePtAround(c.x,c.y,-c.layer.getAngle(),y,v,!1);m.setPan(p,f,drama.to_degrees(c.angle-c.layer.getAngle()),o,s,N(a)),m.setObject(c),m.play(0!==i,u,0,this.nextPlayTime),this.nextPlayTime=0}else{this.getAudioBuffer(d,h).panWhenReady.push({obj:c,ia:o,oa:s,og:N(a),thistag:l})}}}},yt.prototype.SetLooping=function(t,e){var i,n;for(pt(t),i=0,n=ht.length;i<n;i++)ht[i].setLooping(0===e)},yt.prototype.SetMuted=function(t,e){var i,n;for(pt(t),i=0,n=ht.length;i<n;i++)ht[i].setMuted(0===e)},yt.prototype.SetVolume=function(t,e){pt(t);var i,n,r=N(e);for(i=0,n=ht.length;i<n;i++)ht[i].setVolume(r)},yt.prototype.SetVolumePercent=function(t,e){if(pt(t),e<0)e=0;else if(100<e)e=100;var i,n,r=e/100;for(i=0,n=ht.length;i<n;i++)ht[i].setVolume(r)},yt.prototype.Preload=function(t){if(!I){var e=t[1],i=this.runtime.getProjectAudioFileUrl(t[0]);if(i)if(d!==h)this.getAudioInstance(i,"<preload>",e,!1)}},yt.prototype.PreloadByName=function(t,e){if(!I){var i=1===t,n=this.runtime.getProjectAudioFileUrl(e);if(n)if(d!==h)this.getAudioInstance(n,"<preload>",i,!1)}},yt.prototype.SetPlaybackRate=function(t,e){if(pt(t),e<0)e=0;var i,n;for(i=0,n=ht.length;i<n;i++)ht[i].setPlaybackRate(e)},yt.prototype.Stop=function(t){var e,i;for(pt(t),e=0,i=ht.length;e<i;e++)ht[e].stop()},yt.prototype.StopAll=function(){var t,e;for(t=0,e=S.length;t<e;t++)S[t].stop()},yt.prototype.SetPaused=function(t,e){var i,n;for(pt(t),i=0,n=ht.length;i<n;i++)if(0===e)ht[i].pause();else ht[i].resume()},yt.prototype.Seek=function(t,e){var i,n;for(pt(t),i=0,n=ht.length;i<n;i++)ht[i].seek(e)},yt.prototype.SetSilent=function(t){var e,i;if(2===t)t=I?1:0;if(0===t&&!I){for(e=0,i=S.length;e<i;e++)S[e].setSilent(!0);I=!0}else if(1===t&&I){for(e=0,i=S.length;e<i;e++)S[e].setSilent(!1);I=!1}},yt.prototype.SetMasterVolume=function(t){var e,i;for(T=N(t),e=0,i=S.length;e<i;e++)S[e].updateVolume()},yt.prototype.SetMasterVolumePercent=function(t){if(t<0)t=0;else if(100<t)t=100;var e,i;for(T=t/100,e=0,i=S.length;e<i;e++)S[e].updateVolume()},yt.prototype.AddFilterEffect=function(t,e,i,n,r,o,s){if(!(d!==u||e<0||K.length<=e)&&p.createBiquadFilter){if((s/=100)<0)s=0;if(1<s)s=1;mt(t=t.toLowerCase(),new q(e,i,n,r,o,s))}},yt.prototype.AddDelayEffect=function(t,e,i,n){if(d===u){if((n/=100)<0)n=0;if(1<n)n=1;mt(t=t.toLowerCase(),new z(e,N(i),n))}},yt.prototype.AddFlangerEffect=function(t,e,i,n,r,o){if(d===u&&p.createOscillator){if((o/=100)<0)o=0;if(1<o)o=1;mt(t=t.toLowerCase(),new Y(e/1e3,i/1e3,n,r/100,o))}},yt.prototype.AddPhaserEffect=function(t,e,i,n,r,o,s){if(d===u&&p.createOscillator){if((s/=100)<0)s=0;if(1<s)s=1;mt(t=t.toLowerCase(),new Q(e,i,n,r,o,s))}},yt.prototype.AddConvolutionEffect=function(t,e,i,n){if(d===u&&p.createConvolver){var r=0===i,o=this.runtime.getProjectAudioFileUrl(e[0]);if(o){var s,a=this.getAudioBuffer(o,!1);if(t=t.toLowerCase(),(n/=100)<0)n=0;if(1<n)n=1;if(a.bufferObject)s=new X(a.bufferObject,r,n,o.url);else s=new X(null,r,n,o.url),a.normalizeWhenReady=r,a.convolveWhenReady=s;mt(t,s)}}},yt.prototype.AddGainEffect=function(t,e){if(d===u)mt(t=t.toLowerCase(),new Z(N(e)))},yt.prototype.AddMuteEffect=function(t){if(d===u)mt(t=t.toLowerCase(),new Z(0))},yt.prototype.AddTremoloEffect=function(t,e,i){if(d===u&&p.createOscillator){if((i/=100)<0)i=0;if(1<i)i=1;mt(t=t.toLowerCase(),new tt(e,i))}},yt.prototype.AddRingModEffect=function(t,e,i){if(d===u&&p.createOscillator){if((i/=100)<0)i=0;if(1<i)i=1;mt(t=t.toLowerCase(),new et(e,i))}},yt.prototype.AddDistortionEffect=function(t,e,i,n,r,o){if(d===u&&p.createWaveShaper){if((o/=100)<0)o=0;if(1<o)o=1;mt(t=t.toLowerCase(),new it(e,i,n,r,o))}},yt.prototype.AddCompressorEffect=function(t,e,i,n,r,o){if(d===u&&p.createDynamicsCompressor)mt(t=t.toLowerCase(),new nt(e,i,n,r/1e3,o/1e3))},yt.prototype.AddAnalyserEffect=function(t,e,i){if(d===u)mt(t=t.toLowerCase(),new rt(e,i))},yt.prototype.RemoveEffects=function(t){if(d===u){var e,i,n;if(t=t.toLowerCase(),j.hasOwnProperty(t))if((n=j[t]).length){for(e=0,i=n.length;e<i;e++)n[e].remove();drama.clearArray(n),ft(t)}}},yt.prototype.SetEffectParameter=function(t,e,i,n,r,o){if(d===u){var s;if(t=t.toLowerCase(),e=Math.floor(e),j.hasOwnProperty(t))if(s=j[t],!(e<0||e>=s.length))s[e].setParam(i,n,r,o)}},yt.prototype.SetListenerObject=function(t){if(t&&d===u){var e=t.getFirstPicked();if(e)this.listenerTracker.setObject(e),y=e.x,v=e.y}},yt.prototype.SetListenerZ=function(t){this.listenerZ=t},yt.prototype.ScheduleNextPlay=function(t){if(p)this.nextPlayTime=t},yt.prototype.UnloadAudio=function(t){var e=t[1],i=this.runtime.getProjectAudioFileUrl(t[0]);if(i){var n=this.getAudioBuffer(i,e,!0);if(n)n.release(),drama.arrayFindRemove(f,n)}},yt.prototype.UnloadAudioByName=function(t,e){var i=1===t,n=this.runtime.getProjectAudioFileUrl(e);if(n){var r=this.getAudioBuffer(n,i,!0);if(r)r.release(),drama.arrayFindRemove(f,r)}},yt.prototype.UnloadAll=function(){var t,e;for(t=0,e=f.length;t<e;++t)f[t].release();drama.clearArray(f)},t.acts=new yt,vt.prototype.Duration=function(t,e){if(pt(e,!0),ht.length)t.set_float(ht[0].getDuration());else t.set_float(0)},vt.prototype.PlaybackTime=function(t,e){if(pt(e,!0),ht.length)t.set_float(ht[0].getPlaybackTime(!0));else t.set_float(0)},vt.prototype.PlaybackRate=function(t,e){if(pt(e,!0),ht.length)t.set_float(ht[0].getPlaybackRate());else t.set_float(0)},vt.prototype.Volume=function(t,e){if(pt(e,!0),ht.length){var i=ht[0].getVolume();t.set_float(B(i))}else t.set_float(0)},vt.prototype.MasterVolume=function(t){t.set_float(B(T))},vt.prototype.VolumePercent=function(t,e){if(pt(e,!0),ht.length){var i=ht[0].getVolume();t.set_float(100*i)}else t.set_float(0)},vt.prototype.MasterVolumePercent=function(t){t.set_float(100*T)},vt.prototype.EffectCount=function(t,e){e=e.toLowerCase();var i=null;if(j.hasOwnProperty(e))i=j[e];t.set_int(i?i.length:0)},vt.prototype.AnalyserFreqBinCount=function(t,e,i){var n=bt(e=e.toLowerCase(),i=Math.floor(i));t.set_int(n?n.node.frequencyBinCount:0)},vt.prototype.AnalyserFreqBinAt=function(t,e,i,n){e=e.toLowerCase(),i=Math.floor(i),n=Math.floor(n);var r=bt(e,i);if(!r)t.set_float(0);else if(n<0||n>=r.node.frequencyBinCount)t.set_float(0);else t.set_float(r.freqBins[n])},vt.prototype.AnalyserPeakLevel=function(t,e,i){var n=bt(e=e.toLowerCase(),i=Math.floor(i));if(n)t.set_float(n.peak);else t.set_float(0)},vt.prototype.AnalyserRMSLevel=function(t,e,i){var n=bt(e=e.toLowerCase(),i=Math.floor(i));if(n)t.set_float(n.rms);else t.set_float(0)},vt.prototype.SampleRate=function(t){t.set_int(p?p.sampleRate:0)},vt.prototype.CurrentTime=function(t){t.set_float(p?p.currentTime:drama.performance_now())},t.exps=new vt}(),assert2(drama,"drama namespace not created"),assert2(drama.plugins_,"drama.plugins_ not created"),drama.plugins_.Browser=function(t){this.runtime=t},function(){var pluginProto=drama.plugins_.Browser.prototype;pluginProto.Type=function(t){this.plugin=t,this.runtime=t.runtime};var typeProto=pluginProto.Type.prototype;typeProto.onCreate=function(){};var offlineScriptReady=!1,browserPluginReady=!1;document.addEventListener("DOMContentLoaded",function(){if(window.C3_RegisterSW&&navigator.serviceWorker){var t=document.createElement("script");t.onload=function(){offlineScriptReady=!0,checkReady()},t.src="offlineClient.js",document.head.appendChild(t)}});var browserInstance=null;function checkReady(){if(offlineScriptReady&&browserPluginReady&&window.OfflineClientInfo)window.OfflineClientInfo.SetMessageCallback(function(t){browserInstance.onSWMessage(t)})}typeProto.onAppBegin=function(){browserPluginReady=!0,checkReady()},pluginProto.Instance=function(t){this.type=t,this.runtime=t.runtime};var instanceProto=pluginProto.Instance.prototype;instanceProto.onCreate=function(){var e=this;if(window.addEventListener("resize",function(){e.runtime.trigger(drama.plugins_.Browser.prototype.cnds.OnResize,e)}),browserInstance=this,void 0!==navigator.onLine)window.addEventListener("online",function(){e.runtime.trigger(drama.plugins_.Browser.prototype.cnds.OnOnline,e)}),window.addEventListener("offline",function(){e.runtime.trigger(drama.plugins_.Browser.prototype.cnds.OnOffline,e)});if(void 0!==window.applicationCache)window.applicationCache.addEventListener("updateready",function(){e.runtime.loadingprogress=1,e.runtime.trigger(drama.plugins_.Browser.prototype.cnds.OnUpdateReady,e)}),window.applicationCache.addEventListener("progress",function(t){e.runtime.loadingprogress=t.loaded/t.total||0});if(document.addEventListener("backbutton",function(){e.runtime.trigger(drama.plugins_.Browser.prototype.cnds.OnBackButton,e)}),document.addEventListener("menubutton",function(){e.runtime.trigger(drama.plugins_.Browser.prototype.cnds.OnMenuButton,e)}),document.addEventListener("searchbutton",function(){e.runtime.trigger(drama.plugins_.Browser.prototype.cnds.OnSearchButton,e)}),document.addEventListener("tizenhwkey",function(t){switch(t.keyName){case"back":if(!e.runtime.trigger(drama.plugins_.Browser.prototype.cnds.OnBackButton,e))if(window.tizen)window.tizen.application.getCurrentApplication().exit();break;case"menu":if(!e.runtime.trigger(drama.plugins_.Browser.prototype.cnds.OnMenuButton,e))t.preventDefault()}}),this.runtime.isWindows10&&"undefined"!=typeof Windows)Windows.UI.Core.SystemNavigationManager.getForCurrentView().addEventListener("backrequested",function(t){if(e.runtime.trigger(drama.plugins_.Browser.prototype.cnds.OnBackButton,e))t.handled=!0});else if(this.runtime.isWinJS&&WinJS.Application)WinJS.Application.onbackclick=function(t){return!!e.runtime.trigger(drama.plugins_.Browser.prototype.cnds.OnBackButton,e)};this.runtime.addSuspendCallback(function(t){if(t)e.runtime.trigger(drama.plugins_.Browser.prototype.cnds.OnPageHidden,e);else e.runtime.trigger(drama.plugins_.Browser.prototype.cnds.OnPageVisible,e)}),this.is_arcade=void 0!==window.is_scirra_arcade},instanceProto.onSWMessage=function(t){var e=t.data.type;if("downloading-update"===e)this.runtime.trigger(drama.plugins_.Browser.prototype.cnds.OnUpdateFound,this);else if("update-ready"===e||"update-pending"===e)this.runtime.trigger(drama.plugins_.Browser.prototype.cnds.OnUpdateReady,this);else if("offline-ready"===e)this.runtime.trigger(drama.plugins_.Browser.prototype.cnds.OnOfflineReady,this)},instanceProto.getDebuggerValues=function(t){t.push({title:"Browser",properties:[{name:"User agent string",value:navigator.userAgent,readonly:!0},{name:"Document title",value:document.title,readonly:!0},{name:"Referrer",value:document.referrer,readonly:!0},{name:"Is online",value:!!navigator.onLine,readonly:!0},{name:"Is fullscreen",value:!!(document.mozFullScreen||document.webkitIsFullScreen||document.fullScreen||this.runtime.isNodeFullscreen),readonly:!0},{name:"Current URL",value:window.location.toString(),readonly:!0},{name:"Protocol",value:window.location.protocol,readonly:!0},{name:"Domain",value:window.location.hostname,readonly:!0},{name:"Path name",value:window.location.pathname,readonly:!0},{name:"Hash",value:window.location.hash,readonly:!0},{name:"Query string",value:window.location.search,readonly:!0}]})};var batteryManager=null,loadedBatteryManager=!1;function maybeLoadBatteryManager(){if(!loadedBatteryManager)if(navigator.getBattery){var t=navigator.getBattery();if(loadedBatteryManager=!0,t)t.then(function(t){batteryManager=t})}}function Cnds(){}function Acts(){}Cnds.prototype.CookiesEnabled=function(){return navigator?navigator.cookieEnabled:!1},Cnds.prototype.IsOnline=function(){return navigator?navigator.onLine:!1},Cnds.prototype.HasJava=function(){return navigator?navigator.javaEnabled():!1},Cnds.prototype.OnOnline=function(){return!0},Cnds.prototype.OnOffline=function(){return!0},Cnds.prototype.IsDownloadingUpdate=function(){if(void 0===window.applicationCache)return!1;else return window.applicationCache.status===window.applicationCache.DOWNLOADING},Cnds.prototype.PageVisible=function(){return!this.runtime.isSuspended},Cnds.prototype.OnPageVisible=function(){return!0},Cnds.prototype.OnPageHidden=function(){return!0},Cnds.prototype.OnResize=function(){return!0},Cnds.prototype.IsFullscreen=function(){return!!(document.mozFullScreen||document.webkitIsFullScreen||document.fullScreen||this.runtime.isNodeFullscreen)},Cnds.prototype.OnBackButton=function(){return!0},Cnds.prototype.OnMenuButton=function(){return!0},Cnds.prototype.OnSearchButton=function(){return!0},Cnds.prototype.IsMetered=function(){var t=navigator.connection||navigator.mozConnection||navigator.webkitConnection;if(!t)return!1;else return!!t.metered},Cnds.prototype.IsCharging=function(){var t=navigator.battery||navigator.mozBattery||navigator.webkitBattery;if(t)return!!t.charging;else if(maybeLoadBatteryManager(),batteryManager)return!!batteryManager.charging;else return!0},Cnds.prototype.IsPortraitLandscape=function(t){return(window.innerWidth<=window.innerHeight?0:1)===t},Cnds.prototype.SupportsFullscreen=function(){if(this.runtime.isNWjs)return!0;var t=this.runtime.canvas;return!!(t.requestFullscreen||t.mozRequestFullScreen||t.msRequestFullscreen||t.webkitRequestFullScreen)},Cnds.prototype.OnUpdateFound=function(){return!0},Cnds.prototype.OnUpdateReady=function(){return!0},Cnds.prototype.OnOfflineReady=function(){return!0},pluginProto.cnds=new Cnds,Acts.prototype.Alert=function(t){alert(t.toString())},Acts.prototype.Close=function(){if(window.tizen)window.tizen.application.getCurrentApplication().exit();else if(navigator.app&&navigator.app.exitApp)navigator.app.exitApp();else if(navigator.device&&navigator.device.exitApp)navigator.device.exitApp();else if(!this.is_arcade)window.close()},Acts.prototype.Focus=function(){if(this.runtime.isNWjs){nw.Window.get().focus()}else if(!this.is_arcade)window.focus()},Acts.prototype.Blur=function(){if(this.runtime.isNWjs){nw.Window.get().blur()}else if(!this.is_arcade)window.blur()},Acts.prototype.GoBack=function(){if(navigator.app&&navigator.app.backHistory)navigator.app.backHistory();else if(!this.is_arcade&&window.back)window.back()},Acts.prototype.GoForward=function(){if(!this.is_arcade&&window.forward)window.forward()},Acts.prototype.GoHome=function(){if(!this.is_arcade&&window.home)window.home()},Acts.prototype.GoToURL=function(t,e){if(this.runtime.isWinJS)Windows.System.Launcher.launchUriAsync(new Windows.Foundation.Uri(t));else if(navigator.app&&navigator.app.loadUrl)navigator.app.loadUrl(t,{openExternal:!0});else if(this.runtime.isCordova)window.open(t,"_system");else if(this.runtime.isPreview)window.open(t,"_blank");else if(!this.is_arcade)if(2===e&&!this.is_arcade)window.top.location=t;else if(1===e&&!this.is_arcade)window.parent.location=t;else window.location=t},Acts.prototype.GoToURLWindow=function(t,e){if(this.runtime.isWinJS)Windows.System.Launcher.launchUriAsync(new Windows.Foundation.Uri(t));else if(navigator.app&&navigator.app.loadUrl)navigator.app.loadUrl(t,{openExternal:!0});else if(this.runtime.isCordova)window.open(t,"_system");else if(!this.is_arcade)window.open(t,e)},Acts.prototype.Reload=function(){if(!this.is_arcade)window.location.reload()};var firstRequestFullscreen=!0,crruntime=null;function onFullscreenError(t){if(console&&console.warn)console.warn("Fullscreen request failed: ",t);crruntime.setSize(window.innerWidth,window.innerHeight)}Acts.prototype.RequestFullScreen=function(t){if(2<=t)t+=1;if(6===t)t=2;if(this.runtime.isNodeWebkit){if(this.runtime.isDebug)window.DebuggerFullscreen(!0);else if(!this.runtime.isNodeFullscreen)nw.Window.get().enterFullscreen(),this.runtime.isNodeFullscreen=!0,this.runtime.fullscreen_scaling=2<=t?t:0}else{if(document.mozFullScreen||document.webkitIsFullScreen||document.msFullscreenElement||document.fullScreen||document.fullScreenElement)return;this.runtime.fullscreen_scaling=2<=t?t:0;var e=document.documentElement;if(firstRequestFullscreen)firstRequestFullscreen=!1,crruntime=this.runtime,e.addEventListener("mozfullscreenerror",onFullscreenError),e.addEventListener("webkitfullscreenerror",onFullscreenError),e.addEventListener("MSFullscreenError",onFullscreenError),e.addEventListener("fullscreenerror",onFullscreenError);if(e.requestFullscreen)e.requestFullscreen();else if(e.mozRequestFullScreen)e.mozRequestFullScreen();else if(e.msRequestFullscreen)e.msRequestFullscreen();else if(e.webkitRequestFullScreen)if("undefined"!=typeof Element&&void 0!==Element.ALLOW_KEYBOARD_INPUT)e.webkitRequestFullScreen(Element.ALLOW_KEYBOARD_INPUT);else e.webkitRequestFullScreen()}},Acts.prototype.CancelFullScreen=function(){if(this.runtime.isNWjs){if(this.runtime.isDebug)window.DebuggerFullscreen(!1);else if(this.runtime.isNodeFullscreen)nw.Window.get().leaveFullscreen(),this.runtime.isNodeFullscreen=!1}else if(document.exitFullscreen)document.exitFullscreen();else if(document.mozCancelFullScreen)document.mozCancelFullScreen();else if(document.msExitFullscreen)document.msExitFullscreen();else if(document.webkitCancelFullScreen)document.webkitCancelFullScreen()},Acts.prototype.Vibrate=function(t){try{var e,i,n=t.split(",");for(e=0,i=n.length;e<i;e++)n[e]=parseInt(n[e],10);if(navigator.vibrate)navigator.vibrate(n);else if(navigator.mozVibrate)navigator.mozVibrate(n);else if(navigator.webkitVibrate)navigator.webkitVibrate(n);else if(navigator.msVibrate)navigator.msVibrate(n)}catch(t){}},Acts.prototype.InvokeDownload=function(t,e){var i=document.createElement("a");if(void 0===i.download)window.open(t);else{var n=document.getElementsByTagName("body")[0];i.textContent=e,i.href=t,i.download=e,n.appendChild(i);var r=new MouseEvent("click");i.dispatchEvent(r),n.removeChild(i)}},Acts.prototype.InvokeDownloadString=function(t,e,i){var n="data:"+e+","+encodeURIComponent(t),r=document.createElement("a");if(void 0===r.download)window.open(n);else{var o=document.getElementsByTagName("body")[0];r.textContent=i,r.href=n,r.download=i,o.appendChild(r);var s=new MouseEvent("click");r.dispatchEvent(s),o.removeChild(r)}},Acts.prototype.ConsoleLog=function(t,e){if("undefined"!=typeof console){if(0===t&&console.log)console.log(e.toString());if(1===t&&console.warn)console.warn(e.toString());if(2===t&&console.error)console.error(e.toString())}},Acts.prototype.ConsoleGroup=function(t){if(console&&console.group)console.group(t)},Acts.prototype.ConsoleGroupEnd=function(){if(console&&console.groupEnd)console.groupEnd()},Acts.prototype.ExecJs=function(js_){try{if(eval)eval(js_)}catch(t){if(console&&console.error)console.error("Error executing Javascript: ",t)}};var orientations=["portrait","landscape","portrait-primary","portrait-secondary","landscape-primary","landscape-secondary"];function Exps(){}Acts.prototype.LockOrientation=function(t){if(!((t=Math.floor(t))<0||t>=orientations.length)){this.runtime.autoLockOrientation=!1;var e=orientations[t];if(screen.orientation&&screen.orientation.lock)screen.orientation.lock(e);else if(screen.lockOrientation)screen.lockOrientation(e);else if(screen.webkitLockOrientation)screen.webkitLockOrientation(e);else if(screen.mozLockOrientation)screen.mozLockOrientation(e);else if(screen.msLockOrientation)screen.msLockOrientation(e)}},Acts.prototype.UnlockOrientation=function(){if(this.runtime.autoLockOrientation=!1,screen.orientation&&screen.orientation.unlock)screen.orientation.unlock();else if(screen.unlockOrientation)screen.unlockOrientation();else if(screen.webkitUnlockOrientation)screen.webkitUnlockOrientation();else if(screen.mozUnlockOrientation)screen.mozUnlockOrientation();else if(screen.msUnlockOrientation)screen.msUnlockOrientation()},pluginProto.acts=new Acts,Exps.prototype.URL=function(t){t.set_string(window.location.toString())},Exps.prototype.Protocol=function(t){t.set_string(window.location.protocol)},Exps.prototype.Domain=function(t){t.set_string(window.location.hostname)},Exps.prototype.PathName=function(t){t.set_string(window.location.pathname)},Exps.prototype.Hash=function(t){t.set_string(window.location.hash)},Exps.prototype.Referrer=function(t){t.set_string(document.referrer)},Exps.prototype.Title=function(t){t.set_string(document.title)},Exps.prototype.Name=function(t){t.set_string(navigator.appName)},Exps.prototype.Version=function(t){t.set_string(navigator.appVersion)},Exps.prototype.Language=function(t){if(navigator&&navigator.language)t.set_string(navigator.language);else t.set_string("")},Exps.prototype.Platform=function(t){t.set_string(navigator.platform)},Exps.prototype.Product=function(t){if(navigator&&navigator.product)t.set_string(navigator.product);else t.set_string("")},Exps.prototype.Vendor=function(t){if(navigator&&navigator.vendor)t.set_string(navigator.vendor);else t.set_string("")},Exps.prototype.UserAgent=function(t){t.set_string(navigator.userAgent)},Exps.prototype.QueryString=function(t){t.set_string(window.location.search)},Exps.prototype.QueryParam=function(t,e){var i=RegExp("[?&]"+e+"=([^&]*)").exec(window.location.search);if(i)t.set_string(decodeURIComponent(i[1].replace(/\+/g," ")));else t.set_string("")},Exps.prototype.Bandwidth=function(t){var e=navigator.connection||navigator.mozConnection||navigator.webkitConnection;if(!e)t.set_float(Number.POSITIVE_INFINITY);else if(void 0!==e.bandwidth)t.set_float(e.bandwidth);else if(void 0!==e.downlinkMax)t.set_float(e.downlinkMax);else t.set_float(Number.POSITIVE_INFINITY)},Exps.prototype.ConnectionType=function(t){var e=navigator.connection||navigator.mozConnection||navigator.webkitConnection;if(!e)t.set_string("unknown");else t.set_string(e.type||"unknown")},Exps.prototype.BatteryLevel=function(t){var e=navigator.battery||navigator.mozBattery||navigator.webkitBattery;if(e)t.set_float(e.level);else if(maybeLoadBatteryManager(),batteryManager)t.set_float(batteryManager.level);else t.set_float(1)},Exps.prototype.BatteryTimeLeft=function(t){var e=navigator.battery||navigator.mozBattery||navigator.webkitBattery;if(e)t.set_float(e.dischargingTime);else if(maybeLoadBatteryManager(),batteryManager)t.set_float(batteryManager.dischargingTime);else t.set_float(Number.POSITIVE_INFINITY)},Exps.prototype.ExecJS=function(ret,js_){if(eval){var result=0;try{result=eval(js_)}catch(t){if(console&&console.error)console.error("Error executing Javascript: ",t)}if("number"==typeof result)ret.set_any(result);else if("string"==typeof result)ret.set_any(result);else if("boolean"==typeof result)ret.set_any(result?1:0);else ret.set_any(0)}else ret.set_any(0)},Exps.prototype.ScreenWidth=function(t){t.set_int(screen.width)},Exps.prototype.ScreenHeight=function(t){t.set_int(screen.height)},Exps.prototype.DevicePixelRatio=function(t){t.set_float(this.runtime.devicePixelRatio)},Exps.prototype.WindowInnerWidth=function(t){t.set_int(window.innerWidth)},Exps.prototype.WindowInnerHeight=function(t){t.set_int(window.innerHeight)},Exps.prototype.WindowOuterWidth=function(t){t.set_int(window.outerWidth)},Exps.prototype.WindowOuterHeight=function(t){t.set_int(window.outerHeight)},pluginProto.exps=new Exps}(),assert2(drama,"drama namespace not created"),assert2(drama.plugins_,"drama.plugins_ not created"),drama.plugins_.Button=function(t){this.runtime=t},function(){var t=drama.plugins_.Button.prototype;t.Type=function(t){this.plugin=t,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t){this.type=t,this.runtime=t.runtime};var e=t.Instance.prototype;function i(){}function n(){}e.onCreate=function(){if(this.isCheckbox=1===this.properties[0],this.inputElem=document.createElement("input"),this.isCheckbox)this.elem=document.createElement("label");else this.elem=this.inputElem;if(this.labelText=null,this.inputElem.type=this.isCheckbox?"checkbox":"button",this.inputElem.id=this.properties[7],document.body.appendChild(this.elem),this.isCheckbox)this.elem.appendChild(this.inputElem),this.labelText=document.createTextNode(this.properties[1]),this.elem.appendChild(this.labelText),this.inputElem.checked=this.properties[6],this.elem.style.fontFamily="sans-serif",this.elem.style.display="inline-block",this.elem.style.color="black";else this.inputElem.value=this.properties[1];if(this.elem.title=this.properties[2],this.inputElem.disabled=!this.properties[4],this.autoFontSize=this.properties[5],this.element_hidden=!1,!this.properties[3])this.elem.style.display="none",this.visible=!1,this.element_hidden=!0;var e;this.inputElem.onclick=(e=this,function(t){t.stopPropagation(),e.runtime.isInUserInputEvent=!0,e.runtime.trigger(drama.plugins_.Button.prototype.cnds.OnClicked,e),e.runtime.isInUserInputEvent=!1}),this.elem.addEventListener("touchstart",function(t){t.stopPropagation()},!1),this.elem.addEventListener("touchmove",function(t){t.stopPropagation()},!1),this.elem.addEventListener("touchend",function(t){t.stopPropagation()},!1),this.elem.addEventListener("mousedown",function(t){t.stopPropagation()}),this.elem.addEventListener("mouseup",function(t){t.stopPropagation()}),this.elem.addEventListener("keydown",function(t){t.stopPropagation()}),this.elem.addEventListener("keyup",function(t){t.stopPropagation()}),this.lastLeft=0,this.lastTop=0,this.lastRight=0,this.lastBottom=0,this.lastWinWidth=0,this.lastWinHeight=0,this.updatePosition(!0),this.runtime.tickMe(this)},e.saveToJSON=function(){var t={tooltip:this.elem.title,disabled:!!this.inputElem.disabled};if(this.isCheckbox)t.checked=!!this.inputElem.checked,t.text=this.labelText.nodeValue;else t.text=this.elem.value;return t},e.loadFromJSON=function(t){if(this.elem.title=t.tooltip,this.inputElem.disabled=t.disabled,this.isCheckbox)this.inputElem.checked=t.checked,this.labelText.nodeValue=t.text;else this.elem.value=t.text},e.onDestroy=function(){this.elem.parentElement.removeChild(this.elem),this.elem=null},e.tick=function(){this.updatePosition()},e.updatePosition=function(t){var e=this.layer.layerToCanvas(this.x,this.y,!0),i=this.layer.layerToCanvas(this.x,this.y,!1),n=this.layer.layerToCanvas(this.x+this.width,this.y+this.height,!0),r=this.layer.layerToCanvas(this.x+this.width,this.y+this.height,!1),o=this.runtime.width/this.runtime.devicePixelRatio,s=this.runtime.height/this.runtime.devicePixelRatio;if(!(!this.visible||!this.layer.visible||n<=0||r<=0||o<=e||s<=i)){if(e<1)e=1;if(i<1)i=1;if(o<=n)n=o-1;if(s<=r)r=s-1;var a=window.innerWidth,l=window.innerHeight;if(t||this.lastLeft!==e||this.lastTop!==i||this.lastRight!==n||this.lastBottom!==r||this.lastWinWidth!==a||this.lastWinHeight!==l){if(this.lastLeft=e,this.lastTop=i,this.lastRight=n,this.lastBottom=r,this.lastWinWidth=a,this.lastWinHeight=l,this.element_hidden)this.elem.style.display="",this.element_hidden=!1;var c=Math.round(e)+this.runtime.canvas.offsetLeft,u=Math.round(i)+this.runtime.canvas.offsetTop;if(this.elem.style.position="absolute",this.elem.style.left=c+"px",this.elem.style.top=u+"px",this.elem.style.width=Math.round(n-e)+"px",this.elem.style.height=Math.round(r-i)+"px",this.autoFontSize)this.elem.style.fontSize=this.layer.getScale(!0)/this.runtime.devicePixelRatio-.2+"em"}else if(this.element_hidden)this.elem.style.display="",this.element_hidden=!1}else{if(!this.element_hidden)this.elem.style.display="none";this.element_hidden=!0}},e.draw=function(t){},e.drawGL=function(t){},e.getDebuggerValues=function(t){t.push({title:"Button",properties:[{name:"Text",value:this.isCheckbox?this.labelText.nodeValue:this.elem.value},{name:"Checked",value:this.isCheckbox?this.inputElem.checked:!1,readonly:!this.isCheckbox}]})},e.onDebugValueEdited=function(t,e,i){if("Text"===e)if(this.isCheckbox)this.labelText.nodeValue=i;else this.elem.value=i;else if("Checked"===e&&this.isCheckbox)this.inputElem.checked=i},i.prototype.OnClicked=function(){return!0},i.prototype.IsChecked=function(){return this.isCheckbox&&this.inputElem.checked},t.cnds=new i,n.prototype.SetText=function(t){if(this.isCheckbox)this.labelText.nodeValue=t;else this.elem.value=t},n.prototype.SetTooltip=function(t){this.elem.title=t},n.prototype.SetVisible=function(t){this.visible=0!==t},n.prototype.SetEnabled=function(t){this.inputElem.disabled=0===t},n.prototype.SetFocus=function(){this.inputElem.focus()},n.prototype.SetBlur=function(){this.inputElem.blur()},n.prototype.SetCSSStyle=function(t,e){this.elem.style[drama.cssToCamelCase(t)]=e},n.prototype.SetChecked=function(t){if(this.isCheckbox)this.inputElem.checked=1===t},n.prototype.ToggleChecked=function(){if(this.isCheckbox)this.inputElem.checked=!this.inputElem.checked},t.acts=new n,t.exps=new function(){}}(),assert2(drama,"drama namespace not created"),assert2(drama.plugins_,"drama.plugins_ not created"),drama.plugins_.aaXe_Chance=function(t){this.runtime=t},function(){var o=9007199254740992,r="0123456789",s="abcdefghijklmnopqrstuvwxyz",a=s.toUpperCase(),i=r+"abcdef";function n(t){this.name="UnsupportedError",this.message=t||"This feature is not supported on this platform"}(n.prototype=new Error).constructor=n;var u=Array.prototype.slice;function l(t){if(!(this instanceof l)){if(!t)t=null;return null===t?new l:new l(t)}if("function"==typeof t)return this.random=t,this;if(arguments.length)this.seed=0;for(var e=0;e<arguments.length;e++){var i=0;if("[object String]"===Object.prototype.toString.call(arguments[e]))for(var n=0;n<arguments[e].length;n++){for(var r=0,o=0;o<arguments[e].length;o++)r=arguments[e].charCodeAt(o)+(r<<6)+(r<<16)-r;i+=r}else i=arguments[e];this.seed+=(arguments.length-e)*i}return this.mt=this.mersenne_twister(this.seed),this.bimd5=this.blueimp_md5(),this.random=function(){return this.mt.random(this.seed)},this}function g(t,e){if(t=t||{},e)for(var i in e)if(void 0===t[i])t[i]=e[i];return t}function h(t,e){if(t)throw new RangeError(e)}l.prototype.VERSION="1.0.16";var t=function(){throw new Error("No Base64 encoder available.")};function e(t){return function(){return this.natural(t)}}!function(){if("function"==typeof btoa)t=btoa;else if("function"==typeof Buffer)t=function(t){return new Buffer(t).toString("base64")}}(),l.prototype.bool=function(t){return h((t=g(t,{likelihood:50})).likelihood<0||100<t.likelihood,"Chance: Likelihood accepts values from 0 to 100."),100*this.random()<t.likelihood},l.prototype.animal=function(t){if(void 0!==(t=g(t)).type)return h(!this.get("animals")[t.type.toLowerCase()],"Please pick from desert, ocean, grassland, forest, zoo, pets, farm."),this.pick(this.get("animals")[t.type.toLowerCase()]);return this.pick(this.get("animals")[this.pick(["desert","forest","ocean","zoo","farm","pet","grassland"])])},l.prototype.character=function(t){h((t=g(t)).alpha&&t.symbols,"Chance: Cannot specify both alpha and symbols.");var e,i,n="!@#$%^&*()[]";if("lower"===t.casing)e=s;else if("upper"===t.casing)e=a;else e=s+a;if(t.pool)i=t.pool;else if(t.alpha)i=e;else if(t.symbols)i=n;else i=e+r+n;return i.charAt(this.natural({max:i.length-1}))},l.prototype.floating=function(t){h((t=g(t,{fixed:4})).fixed&&t.precision,"Chance: Cannot specify both fixed and precision.");var e=Math.pow(10,t.fixed),i=o/e,n=-i;h(t.min&&t.fixed&&t.min<n,"Chance: Min specified is out of range with fixed. Min should be, at least, "+n),h(t.max&&t.fixed&&t.max>i,"Chance: Max specified is out of range with fixed. Max should be, at most, "+i),t=g(t,{min:n,max:i});var r=(this.integer({min:t.min*e,max:t.max*e})/e).toFixed(t.fixed);return parseFloat(r)},l.prototype.integer=function(t){return h((t=g(t,{min:-9007199254740992,max:o})).min>t.max,"Chance: Min cannot be greater than Max."),Math.floor(this.random()*(t.max-t.min+1)+t.min)},l.prototype.natural=function(t){if("number"==typeof(t=g(t,{min:0,max:o})).numerals)h(t.numerals<1,"Chance: Numerals cannot be less than one."),t.min=Math.pow(10,t.numerals-1),t.max=Math.pow(10,t.numerals)-1;return h(t.min<0,"Chance: Min cannot be less than zero."),this.integer(t)},l.prototype.hex=function(t){h((t=g(t,{min:0,max:o,casing:"lower"})).min<0,"Chance: Min cannot be less than zero.");var e=this.natural({min:t.min,max:t.max});if("upper"===t.casing)return e.toString(16).toUpperCase();else return e.toString(16)},l.prototype.letter=function(t){t=g(t,{casing:"lower"});var e=this.character({pool:"abcdefghijklmnopqrstuvwxyz"});if("upper"===t.casing)e=e.toUpperCase();return e},l.prototype.string=function(t){h((t=g(t,{length:this.natural({min:5,max:20})})).length<0,"Chance: Length cannot be less than zero.");var e=t.length;return this.n(this.character,e,t).join("")},l.prototype.buffer=function(t){if("undefined"==typeof Buffer)throw new n("Sorry, the buffer() function is not supported on your platform");h((t=g(t,{length:this.natural({min:5,max:20})})).length<0,"Chance: Length cannot be less than zero.");var e=t.length,i=this.n(this.character,e,t);return Buffer.from(i)},l.prototype.capitalize=function(t){return t.charAt(0).toUpperCase()+t.substr(1)},l.prototype.mixin=function(t){for(var e in t)l.prototype[e]=t[e];return this},l.prototype.unique=function(t,e,i){h("function"!=typeof t,"Chance: The first argument must be a function.");var n=function(t,e){return-1!==t.indexOf(e)};if(i)n=i.comparator||n;for(var r,o=[],s=0,a=50*e,l=u.call(arguments,2);o.length<e;){var c=JSON.parse(JSON.stringify(l));if(!n(o,r=t.apply(this,c)))o.push(r),s=0;if(++s>a)throw new RangeError("Chance: num is likely too large for sample set")}return o},l.prototype.n=function(t,e){if(h("function"!=typeof t,"Chance: The first argument must be a function."),void 0===e)e=1;var i=e,n=[],r=u.call(arguments,2);for(i=Math.max(0,i);i--;null)n.push(t.apply(this,r));return n},l.prototype.pad=function(t,e,i){return i=i||"0",(t+="").length>=e?t:new Array(e-t.length+1).join(i)+t},l.prototype.pick=function(t,e){if(0===t.length)throw new RangeError("Chance: Cannot pick() from an empty array");if(!e||1===e)return t[this.natural({max:t.length-1})];else return this.shuffle(t).slice(0,e)},l.prototype.pickone=function(t){if(0===t.length)throw new RangeError("Chance: Cannot pickone() from an empty array");return t[this.natural({max:t.length-1})]},l.prototype.pickset=function(t,e){if(0===e)return[];if(0===t.length)throw new RangeError("Chance: Cannot pickset() from an empty array");if(e<0)throw new RangeError("Chance: Count must be a positive number");if(!e||1===e)return[this.pickone(t)];else return this.shuffle(t).slice(0,e)},l.prototype.shuffle=function(t){for(var e,i,n=[],r=0,o=Number(t.length),s=(e=o,Array.apply(null,Array(e)).map(function(t,e){return e})),a=o-1,l=0;l<o;l++)r=s[i=this.natural({max:a})],n[l]=t[r],s[i]=s[a],a-=1;return n},l.prototype.weighted=function(t,e,i){if(t.length!==e.length)throw new RangeError("Chance: Length of array and weights must match");for(var n,r=0,o=0;o<e.length;++o){if(n=e[o],isNaN(n))throw new RangeError("Chance: All weights must be numbers");if(0<n)r+=n}if(0===r)throw new RangeError("Chance: No valid entries in array weights");var s,a=this.random()*r,l=0,c=-1;for(o=0;o<e.length;++o){if(l+=n=e[o],0<n){if(a<=l){s=o;break}c=o}if(o===e.length-1)s=c}var u=t[s];if(i=void 0===i?!1:i)t.splice(s,1),e.splice(s,1);return u},l.prototype.paragraph=function(t){var e=(t=g(t)).sentences||this.natural({min:3,max:7});return this.n(this.sentence,e).join(" ")},l.prototype.sentence=function(t){var e,i=(t=g(t)).words||this.natural({min:12,max:18}),n=t.punctuation;if(e=this.n(this.word,i).join(" "),e=this.capitalize(e),!1!==n&&!/^[.?;!:]$/.test(n))n=".";if(n)e+=n;return e},l.prototype.syllable=function(t){for(var e,i=(t=g(t)).length||this.natural({min:2,max:3}),n="bcdfghjklmnprstvwz",r="",o=0;o<i;o++){if(0===o)e=this.character({pool:"bcdfghjklmnprstvwzaeiou"});else if(-1===n.indexOf(e))e=this.character({pool:n});else e=this.character({pool:"aeiou"});r+=e}if(t.capitalize)r=this.capitalize(r);return r},l.prototype.word=function(t){h((t=g(t)).syllables&&t.length,"Chance: Cannot specify both syllables AND length.");var e=t.syllables||this.natural({min:1,max:3}),i="";if(t.length){for(;(i+=this.syllable()).length<t.length;);i=i.substring(0,t.length)}else for(var n=0;n<e;n++)i+=this.syllable();if(t.capitalize)i=this.capitalize(i);return i},l.prototype.age=function(t){var e;switch((t=g(t)).type){case"child":e={min:0,max:12};break;case"teen":e={min:13,max:19};break;case"adult":e={min:18,max:65};break;case"senior":e={min:65,max:100};break;case"all":e={min:0,max:100};break;default:e={min:18,max:65}}return this.natural(e)},l.prototype.birthday=function(t){var e=this.age(t),i=(new Date).getFullYear();if(t&&t.type){var n=new Date,r=new Date;n.setFullYear(i-e-1),r.setFullYear(i-e),t=g(t,{min:n,max:r})}else t=g(t,{year:i-e});return this.date(t)},l.prototype.cpf=function(t){t=g(t,{formatted:!0});var e=this.n(this.natural,9,{max:9}),i=2*e[8]+3*e[7]+4*e[6]+5*e[5]+6*e[4]+7*e[3]+8*e[2]+9*e[1]+10*e[0];if(10<=(i=11-i%11))i=0;var n=2*i+3*e[8]+4*e[7]+5*e[6]+6*e[5]+7*e[4]+8*e[3]+9*e[2]+10*e[1]+11*e[0];if(10<=(n=11-n%11))n=0;var r=""+e[0]+e[1]+e[2]+"."+e[3]+e[4]+e[5]+"."+e[6]+e[7]+e[8]+"-"+i+n;return t.formatted?r:r.replace(/\D/g,"")},l.prototype.cnpj=function(t){t=g(t,{formatted:!0});var e=this.n(this.natural,12,{max:12}),i=2*e[11]+3*e[10]+4*e[9]+5*e[8]+6*e[7]+7*e[6]+8*e[5]+9*e[4]+2*e[3]+3*e[2]+4*e[1]+5*e[0];if((i=11-i%11)<2)i=0;var n=2*i+3*e[11]+4*e[10]+5*e[9]+6*e[8]+7*e[7]+8*e[6]+9*e[5]+2*e[4]+3*e[3]+4*e[2]+5*e[1]+6*e[0];if((n=11-n%11)<2)n=0;var r=""+e[0]+e[1]+"."+e[2]+e[3]+e[4]+"."+e[5]+e[6]+e[7]+"/"+e[8]+e[9]+e[10]+e[11]+"-"+i+n;return t.formatted?r:r.replace(/\D/g,"")},l.prototype.first=function(t){return t=g(t,{gender:this.gender(),nationality:"en"}),this.pick(this.get("firstNames")[t.gender.toLowerCase()][t.nationality.toLowerCase()])},l.prototype.profession=function(t){if((t=g(t)).rank)return this.pick(["Apprentice ","Junior ","Senior ","Lead "])+this.pick(this.get("profession"));else return this.pick(this.get("profession"))},l.prototype.company=function(){return this.pick(this.get("company"))},l.prototype.gender=function(t){return t=g(t,{extraGenders:[]}),this.pick(["Male","Female"].concat(t.extraGenders))},l.prototype.last=function(t){if("*"===(t=g(t,{nationality:"*"})).nationality){var i=[],n=this.get("lastNames");return Object.keys(n).forEach(function(t,e){i=i.concat(n[t])}),this.pick(i)}else return this.pick(this.get("lastNames")[t.nationality.toLowerCase()])},l.prototype.israelId=function(){for(var t=this.string({pool:"0123456789",length:8}),e=0,i=0;i<t.length;i++){var n=t[i]*(i/2===parseInt(i/2)?1:2);n=this.pad(n,2).toString(),e+=n=parseInt(n[0])+parseInt(n[1])}return t+=(10-parseInt(e.toString().slice(-1))).toString().slice(-1)},l.prototype.mrz=function(t){var e,i,n,r,o,s=function(t){var n="<ABCDEFGHIJKLMNOPQRSTUVWXYXZ".split(""),r=[7,3,1],o=0;if("string"!=typeof t)t=t.toString();return t.split("").forEach(function(t,e){var i=n.indexOf(t);if(-1!==i)t=0===i?0:i+9;else t=parseInt(t,10);o+=t*=r[e%r.length]}),o%10},a=this;return t=g(t,{first:this.first(),last:this.last(),passportNumber:this.integer({min:1e8,max:999999999}),dob:(i=a.birthday({type:"adult"}),[i.getFullYear().toString().substr(2),a.pad(i.getMonth()+1,2),a.pad(i.getDate(),2)].join("")),expiry:(e=new Date,[(e.getFullYear()+5).toString().substr(2),a.pad(e.getMonth()+1,2),a.pad(e.getDate(),2)].join("")),gender:"Female"===this.gender()?"F":"M",issuer:"GBR",nationality:"GBR"}),r=function(t){return new Array(t+1).join("<")},(o=["P<",(n=t).issuer,n.last.toUpperCase(),"<<",n.first.toUpperCase(),r(39-(n.last.length+n.first.length+2)),n.passportNumber,s(n.passportNumber),n.nationality,n.dob,s(n.dob),n.gender,n.expiry,s(n.expiry),r(14),s(r(14))].join(""))+s(o.substr(44,10)+o.substr(57,7)+o.substr(65,7))},l.prototype.name=function(t){t=g(t);var e,i=this.first(t),n=this.last(t);if(t.middle)e=i+" "+this.first(t)+" "+n;else if(t.middle_initial)e=i+" "+this.character({alpha:!0,casing:"upper"})+". "+n;else e=i+" "+n;if(t.prefix)e=this.prefix(t)+" "+e;if(t.suffix)e=e+" "+this.suffix(t);return e},l.prototype.name_prefixes=function(t){var e=[{name:"Doctor",abbreviation:"Dr."}];if("male"===(t=(t=t||"all").toLowerCase())||"all"===t)e.push({name:"Mister",abbreviation:"Mr."});if("female"===t||"all"===t)e.push({name:"Miss",abbreviation:"Miss"}),e.push({name:"Misses",abbreviation:"Mrs."});return e},l.prototype.prefix=function(t){return this.name_prefix(t)},l.prototype.name_prefix=function(t){return(t=g(t,{gender:"all"})).full?this.pick(this.name_prefixes(t.gender)).name:this.pick(this.name_prefixes(t.gender)).abbreviation},l.prototype.HIDN=function(){var t="";return t+=this.string({pool:"0123456789",length:6}),t+=this.string({pool:"ABCDEFGHIJKLMNOPQRSTUVWXYXZ",length:2})},l.prototype.ssn=function(t){var e,i="1234567890",n=(t=g(t,{ssnFour:!1,dashes:!0})).dashes?"-":"";if(!t.ssnFour)e=this.string({pool:i,length:3})+n+this.string({pool:i,length:2})+n+this.string({pool:i,length:4});else e=this.string({pool:i,length:4});return e},l.prototype.aadhar=function(t){var e,i="1234567890",n=(t=g(t,{onlyLastFour:!1,separatedByWhiteSpace:!0})).separatedByWhiteSpace?" ":"";if(!t.onlyLastFour)e=this.string({pool:i,length:4})+n+this.string({pool:i,length:4})+n+this.string({pool:i,length:4});else e=this.string({pool:i,length:4});return e},l.prototype.name_suffixes=function(){return[{name:"Doctor of Osteopathic Medicine",abbreviation:"D.O."},{name:"Doctor of Philosophy",abbreviation:"Ph.D."},{name:"Esquire",abbreviation:"Esq."},{name:"Junior",abbreviation:"Jr."},{name:"Juris Doctor",abbreviation:"J.D."},{name:"Master of Arts",abbreviation:"M.A."},{name:"Master of Business Administration",abbreviation:"M.B.A."},{name:"Master of Science",abbreviation:"M.S."},{name:"Medical Doctor",abbreviation:"M.D."},{name:"Senior",abbreviation:"Sr."},{name:"The Third",abbreviation:"III"},{name:"The Fourth",abbreviation:"IV"},{name:"Bachelor of Engineering",abbreviation:"B.E"},{name:"Bachelor of Technology",abbreviation:"B.TECH"}]},l.prototype.suffix=function(t){return this.name_suffix(t)},l.prototype.name_suffix=function(t){return(t=g(t)).full?this.pick(this.name_suffixes()).name:this.pick(this.name_suffixes()).abbreviation},l.prototype.nationalities=function(){return this.get("nationalities")},l.prototype.nationality=function(){return this.pick(this.nationalities()).name},l.prototype.android_id=function(){return"APA91"+this.string({pool:"0123456789abcefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ-_",length:178})},l.prototype.apple_token=function(){return this.string({pool:"abcdef1234567890",length:64})},l.prototype.wp8_anid2=function(){return t(this.hash({length:32}))},l.prototype.wp7_anid=function(){return"A="+this.guid().replace(/-/g,"").toUpperCase()+"&E="+this.hash({length:3})+"&W="+this.integer({min:0,max:9})},l.prototype.bb_pin=function(){return this.hash({length:8})},l.prototype.avatar=function(t){var e={protocol:null,email:null,fileExtension:null,size:null,fallback:null,rating:null};if(!t)e.email=this.email(),t={};else if("string"==typeof t)e.email=t,t={};else if("object"!==_typeof(t))return null;else if("Array"===t.constructor)return null;if(!(e=g(t,e)).email)e.email=this.email();return e.protocol={http:"http",https:"https"}[e.protocol]?e.protocol+":":"",e.size=parseInt(e.size,0)?e.size:"",e.rating={g:"g",pg:"pg",r:"r",x:"x"}[e.rating]?e.rating:"",e.fallback={404:"404",mm:"mm",identicon:"identicon",monsterid:"monsterid",wavatar:"wavatar",retro:"retro",blank:"blank"}[e.fallback]?e.fallback:"",e.fileExtension={bmp:"bmp",gif:"gif",jpg:"jpg",png:"png"}[e.fileExtension]?e.fileExtension:"",e.protocol+"//www.gravatar.com/avatar/"+this.bimd5.md5(e.email)+(e.fileExtension?"."+e.fileExtension:"")+(e.size||e.rating||e.fallback?"?":"")+(e.size?"&s="+e.size.toString():"")+(e.rating?"&r="+e.rating:"")+(e.fallback?"&d="+e.fallback:"")},l.prototype.color=function(o){function s(t,e){return[t,t,t].join(e||"")}function t(t){var e=t?"rgba":"rgb",i=t?","+this.floating({min:n,max:r}):"";return e+"("+(a?s(this.natural({min:l,max:c}),","):this.natural({min:d,max:p})+","+this.natural({min:f,max:m})+","+this.natural({max:255}))+i+")"}function e(t,e,i){var n=i?"#":"",r="";if(a){if(r=s(this.pad(this.hex({min:l,max:c}),2)),"shorthex"===o.format)r=s(this.hex({min:0,max:15}))}else if("shorthex"===o.format)r=this.pad(this.hex({min:Math.floor(u/16),max:Math.floor(h/16)}),1)+this.pad(this.hex({min:Math.floor(d/16),max:Math.floor(p/16)}),1)+this.pad(this.hex({min:Math.floor(f/16),max:Math.floor(m/16)}),1);else if(void 0!==u||void 0!==h||void 0!==d||void 0!==p||void 0!==f||void 0!==m)r=this.pad(this.hex({min:u,max:h}),2)+this.pad(this.hex({min:d,max:p}),2)+this.pad(this.hex({min:f,max:m}),2);else r=this.pad(this.hex({min:l,max:c}),2)+this.pad(this.hex({min:l,max:c}),2)+this.pad(this.hex({min:l,max:c}),2);return n+r}var i,a=(o=g(o,{format:this.pick(["hex","shorthex","rgb","rgba","0x","name"]),grayscale:!1,casing:"lower",min:0,max:255,min_red:void 0,max_red:void 0,min_green:void 0,max_green:void 0,min_blue:void 0,max_blue:void 0,min_alpha:0,max_alpha:1})).grayscale,l=o.min,c=o.max,u=o.min_red,h=o.max_red,d=o.min_green,p=o.max_green,f=o.min_blue,m=o.max_blue,n=o.min_alpha,r=o.max_alpha;if(void 0===o.min_red)u=l;if(void 0===o.max_red)h=c;if(void 0===o.min_green)d=l;if(void 0===o.max_green)p=c;if(void 0===o.min_blue)f=l;if(void 0===o.max_blue)m=c;if(void 0===o.min_alpha)n=0;if(void 0===o.max_alpha)r=1;if(a&&0===l&&255===c&&void 0!==u&&void 0!==h)l=(u+d+f)/3,c=(h+p+m)/3;if("hex"===o.format)i=e.call(this,2,6,!0);else if("shorthex"===o.format)i=e.call(this,1,3,!0);else if("rgb"===o.format)i=t.call(this,!1);else if("rgba"===o.format)i=t.call(this,!0);else if("0x"===o.format)i="0x"+e.call(this,2,6);else if("name"===o.format)return this.pick(this.get("colorNames"));else throw new RangeError('Invalid format provided. Please provide one of "hex", "shorthex", "rgb", "rgba", "0x" or "name".');if("upper"===o.casing)i=i.toUpperCase();return i},l.prototype.domain=function(t){return t=g(t),this.word()+"."+(t.tld||this.tld())},l.prototype.email=function(t){return t=g(t),this.word({length:t.length})+"@"+(t.domain||this.domain())},l.prototype.fbid=function(){return"10000"+this.string({pool:"1234567890",length:11})},l.prototype.google_analytics=function(){return"UA-"+this.pad(this.natural({max:999999}),6)+"-"+this.pad(this.natural({max:99}),2)},l.prototype.hashtag=function(){return"#"+this.word()},l.prototype.ip=function(){return this.natural({min:1,max:254})+"."+this.natural({max:255})+"."+this.natural({max:255})+"."+this.natural({min:1,max:254})},l.prototype.ipv6=function(){return this.n(this.hash,8,{length:4}).join(":")},l.prototype.klout=function(){return this.natural({min:1,max:99})},l.prototype.semver=function(t){t=g(t,{include_prerelease:!0});var e=this.pickone(["^","~","<",">","<=",">=","="]);if(t.range)e=t.range;var i="";if(t.include_prerelease)i=this.weighted(["","-dev","-beta","-alpha"],[50,10,5,1]);return e+this.rpg("3d10").join(".")+i},l.prototype.tlds=function(){return["com","org","edu","gov","co.uk","net","io","ac","ad","ae","af","ag","ai","al","am","an","ao","aq","ar","as","at","au","aw","ax","az","ba","bb","bd","be","bf","bg","bh","bi","bj","bm","bn","bo","bq","br","bs","bt","bv","bw","by","bz","ca","cc","cd","cf","cg","ch","ci","ck","cl","cm","cn","co","cr","cu","cv","cw","cx","cy","cz","de","dj","dk","dm","do","dz","ec","ee","eg","eh","er","es","et","eu","fi","fj","fk","fm","fo","fr","ga","gb","gd","ge","gf","gg","gh","gi","gl","gm","gn","gp","gq","gr","gs","gt","gu","gw","gy","hk","hm","hn","hr","ht","hu","id","ie","il","im","in","io","iq","ir","is","it","je","jm","jo","jp","ke","kg","kh","ki","km","kn","kp","kr","kw","ky","kz","la","lb","lc","li","lk","lr","ls","lt","lu","lv","ly","ma","mc","md","me","mg","mh","mk","ml","mm","mn","mo","mp","mq","mr","ms","mt","mu","mv","mw","mx","my","mz","na","nc","ne","nf","ng","ni","nl","no","np","nr","nu","nz","om","pa","pe","pf","pg","ph","pk","pl","pm","pn","pr","ps","pt","pw","py","qa","re","ro","rs","ru","rw","sa","sb","sc","sd","se","sg","sh","si","sj","sk","sl","sm","sn","so","sr","ss","st","su","sv","sx","sy","sz","tc","td","tf","tg","th","tj","tk","tl","tm","tn","to","tp","tr","tt","tv","tw","tz","ua","ug","uk","us","uy","uz","va","vc","ve","vg","vi","vn","vu","wf","ws","ye","yt","za","zm","zw"]},l.prototype.tld=function(){return this.pick(this.tlds())},l.prototype.twitter=function(){return"@"+this.word()},l.prototype.url=function(t){var e=0<(t=g(t,{protocol:"http",domain:this.domain(t),domain_prefix:"",path:this.word(),extensions:[]})).extensions.length?"."+this.pick(t.extensions):"",i=t.domain_prefix?t.domain_prefix+"."+t.domain:t.domain;return t.protocol+"://"+i+"/"+t.path+e},l.prototype.port=function(){return this.integer({min:0,max:65535})},l.prototype.locale=function(t){if((t=g(t)).region)return this.pick(this.get("locale_regions"));else return this.pick(this.get("locale_languages"))},l.prototype.locales=function(t){if((t=g(t)).region)return this.get("locale_regions");else return this.get("locale_languages")},l.prototype.loremPicsum=function(t){var e=(t=g(t,{width:500,height:500,greyscale:!1,blurred:!1})).greyscale?"g/":"",i=t.blurred?"/?blur":"/?random";return"https://picsum.photos/"+e+t.width+"/"+t.height+i},l.prototype.address=function(t){return t=g(t),this.natural({min:5,max:2e3})+" "+this.street(t)},l.prototype.altitude=function(t){return t=g(t,{fixed:5,min:0,max:8848}),this.floating({min:t.min,max:t.max,fixed:t.fixed})},l.prototype.areacode=function(t){t=g(t,{parens:!0});var e=this.natural({min:2,max:9}).toString()+this.natural({min:0,max:8}).toString()+this.natural({min:0,max:9}).toString();return t.parens?"("+e+")":e},l.prototype.city=function(){return this.capitalize(this.word({syllables:3}))},l.prototype.coordinates=function(t){return this.latitude(t)+", "+this.longitude(t)},l.prototype.countries=function(){return this.get("countries")},l.prototype.country=function(t){t=g(t);var e=this.pick(this.countries());return t.raw?e:t.full?e.name:e.abbreviation},l.prototype.depth=function(t){return t=g(t,{fixed:5,min:-10994,max:0}),this.floating({min:t.min,max:t.max,fixed:t.fixed})},l.prototype.geohash=function(t){return t=g(t,{length:7}),this.string({length:t.length,pool:"0123456789bcdefghjkmnpqrstuvwxyz"})},l.prototype.geojson=function(t){return this.latitude(t)+", "+this.longitude(t)+", "+this.altitude(t)},l.prototype.latitude=function(t){return t=g(t,{fixed:5,min:-90,max:90}),this.floating({min:t.min,max:t.max,fixed:t.fixed})},l.prototype.longitude=function(t){return t=g(t,{fixed:5,min:-180,max:180}),this.floating({min:t.min,max:t.max,fixed:t.fixed})},l.prototype.phone=function(t){var e,i,n=this,r=function(t){var e=[];return t.sections.forEach(function(t){e.push(n.string({pool:"0123456789",length:t}))}),t.area+e.join(" ")};if(!(t=g(t,{formatted:!0,country:"us",mobile:!1})).formatted)t.parens=!1;switch(t.country){case"fr":if(!t.mobile)e=this.pick(["01"+this.pick(["30","34","39","40","41","42","43","44","45","46","47","48","49","53","55","56","58","60","64","69","70","72","73","74","75","76","77","78","79","80","81","82","83"])+n.string({pool:"0123456789",length:6}),"02"+this.pick(["14","18","22","23","28","29","30","31","32","33","34","35","36","37","38","40","41","43","44","45","46","47","48","49","50","51","52","53","54","56","57","61","62","69","72","76","77","78","85","90","96","97","98","99"])+n.string({pool:"0123456789",length:6}),"03"+this.pick(["10","20","21","22","23","24","25","26","27","28","29","39","44","45","51","52","54","55","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","80","81","82","83","84","85","86","87","88","89","90"])+n.string({pool:"0123456789",length:6}),"04"+this.pick(["11","13","15","20","22","26","27","30","32","34","37","42","43","44","50","56","57","63","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","88","89","90","91","92","93","94","95","97","98"])+n.string({pool:"0123456789",length:6}),"05"+this.pick(["08","16","17","19","24","31","32","33","34","35","40","45","46","47","49","53","55","56","57","58","59","61","62","63","64","65","67","79","81","82","86","87","90","94"])+n.string({pool:"0123456789",length:6}),"09"+n.string({pool:"0123456789",length:8})]),i=t.formatted?e.match(/../g).join(" "):e;else e=this.pick(["06","07"])+n.string({pool:"0123456789",length:8}),i=t.formatted?e.match(/../g).join(" "):e;break;case"uk":if(!t.mobile)e=this.pick([{area:"01"+this.character({pool:"234569"})+"1 ",sections:[3,4]},{area:"020 "+this.character({pool:"378"}),sections:[3,4]},{area:"023 "+this.character({pool:"89"}),sections:[3,4]},{area:"024 7",sections:[3,4]},{area:"028 "+this.pick(["25","28","37","71","82","90","92","95"]),sections:[2,4]},{area:"012"+this.pick(["04","08","54","76","97","98"])+" ",sections:[6]},{area:"013"+this.pick(["63","64","84","86"])+" ",sections:[6]},{area:"014"+this.pick(["04","20","60","61","80","88"])+" ",sections:[6]},{area:"015"+this.pick(["24","27","62","66"])+" ",sections:[6]},{area:"016"+this.pick(["06","29","35","47","59","95"])+" ",sections:[6]},{area:"017"+this.pick(["26","44","50","68"])+" ",sections:[6]},{area:"018"+this.pick(["27","37","84","97"])+" ",sections:[6]},{area:"019"+this.pick(["00","05","35","46","49","63","95"])+" ",sections:[6]}]),i=t.formatted?r(e):r(e).replace(" ","","g");else e=this.pick([{area:"07"+this.pick(["4","5","7","8","9"]),sections:[2,6]},{area:"07624 ",sections:[6]}]),i=t.formatted?r(e):r(e).replace(" ","");break;case"za":if(!t.mobile)e=this.pick(["01"+this.pick(["0","1","2","3","4","5","6","7","8"])+n.string({pool:"0123456789",length:7}),"02"+this.pick(["1","2","3","4","7","8"])+n.string({pool:"0123456789",length:7}),"03"+this.pick(["1","2","3","5","6","9"])+n.string({pool:"0123456789",length:7}),"04"+this.pick(["1","2","3","4","5","6","7","8","9"])+n.string({pool:"0123456789",length:7}),"05"+this.pick(["1","3","4","6","7","8"])+n.string({pool:"0123456789",length:7})]),i=t.formatted||e;else e=this.pick(["060"+this.pick(["3","4","5","6","7","8","9"])+n.string({pool:"0123456789",length:6}),"061"+this.pick(["0","1","2","3","4","5","8"])+n.string({pool:"0123456789",length:6}),"06"+n.string({pool:"0123456789",length:7}),"071"+this.pick(["0","1","2","3","4","5","6","7","8","9"])+n.string({pool:"0123456789",length:6}),"07"+this.pick(["2","3","4","6","7","8","9"])+n.string({pool:"0123456789",length:7}),"08"+this.pick(["0","1","2","3","4","5"])+n.string({pool:"0123456789",length:7})]),i=t.formatted||e;break;case"us":var o=this.areacode(t).toString(),s=this.natural({min:2,max:9}).toString()+this.natural({min:0,max:9}).toString()+this.natural({min:0,max:9}).toString(),a=this.natural({min:1e3,max:9999}).toString();i=t.formatted?o+" "+s+"-"+a:o+s+a;break;case"br":var l,c=this.pick(["11","12","13","14","15","16","17","18","19","21","22","24","27","28","31","32","33","34","35","37","38","41","42","43","44","45","46","47","48","49","51","53","54","55","61","62","63","64","65","66","67","68","69","71","73","74","75","77","79","81","82","83","84","85","86","87","88","89","91","92","93","94","95","96","97","98","99"]);if(t.mobile)l="9"+n.string({pool:"0123456789",length:4});else l=this.natural({min:2e3,max:5999}).toString();var u=n.string({pool:"0123456789",length:4});i=t.formatted?"("+c+") "+l+"-"+u:c+l+u}return i},l.prototype.postal=function(){return this.character({pool:"XVTSRPNKLMHJGECBA"})+this.natural({max:9})+this.character({alpha:!0,casing:"upper"})+" "+(this.natural({max:9})+this.character({alpha:!0,casing:"upper"})+this.natural({max:9}))},l.prototype.counties=function(t){return t=g(t,{country:"uk"}),this.get("counties")[t.country.toLowerCase()]},l.prototype.county=function(t){return this.pick(this.counties(t)).name},l.prototype.provinces=function(t){return t=g(t,{country:"ca"}),this.get("provinces")[t.country.toLowerCase()]},l.prototype.province=function(t){return t&&t.full?this.pick(this.provinces(t)).name:this.pick(this.provinces(t)).abbreviation},l.prototype.state=function(t){return t&&t.full?this.pick(this.states(t)).name:this.pick(this.states(t)).abbreviation},l.prototype.states=function(t){var e;switch((t=g(t,{country:"us",us_states_and_dc:!0})).country.toLowerCase()){case"us":var i=this.get("us_states_and_dc"),n=this.get("territories"),r=this.get("armed_forces");if(e=[],t.us_states_and_dc)e=e.concat(i);if(t.territories)e=e.concat(n);if(t.armed_forces)e=e.concat(r);break;case"it":e=this.get("country_regions")[t.country.toLowerCase()];break;case"uk":e=this.get("counties")[t.country.toLowerCase()]}return e},l.prototype.street=function(t){var e;switch((t=g(t,{country:"us",syllables:2})).country.toLowerCase()){case"us":e=this.word({syllables:t.syllables}),e=this.capitalize(e),e+=" ",e+=t.short_suffix?this.street_suffix(t).abbreviation:this.street_suffix(t).name;break;case"it":e=this.word({syllables:t.syllables}),e=this.capitalize(e),e=(t.short_suffix?this.street_suffix(t).abbreviation:this.street_suffix(t).name)+" "+e}return e},l.prototype.street_suffix=function(t){return t=g(t,{country:"us"}),this.pick(this.street_suffixes(t))},l.prototype.street_suffixes=function(t){return t=g(t,{country:"us"}),this.get("street_suffixes")[t.country.toLowerCase()]},l.prototype.zip=function(t){var e=this.n(this.natural,5,{max:9});if(t&&!0===t.plusfour)e.push("-"),e=e.concat(this.n(this.natural,4,{max:9}));return e.join("")},l.prototype.ampm=function(){return this.bool()?"am":"pm"},l.prototype.date=function(t){var e,i;if(t&&(t.min||t.max)){var n=void 0!==(t=g(t,{american:!0,string:!1})).min?t.min.getTime():1,r=void 0!==t.max?t.max.getTime():864e13;i=new Date(this.integer({min:n,max:r}))}else{var o=this.month({raw:!0}),s=o.days;if(t&&t.month)s=this.get("months")[(t.month%12+12)%12].days;t=g(t,{year:parseInt(this.year(),10),month:o.numeric-1,day:this.natural({min:1,max:s}),hour:this.hour({twentyfour:!0}),minute:this.minute(),second:this.second(),millisecond:this.millisecond(),american:!0,string:!1}),i=new Date(t.year,t.month,t.day,t.hour,t.minute,t.second,t.millisecond)}if(t.american)e=i.getMonth()+1+"/"+i.getDate()+"/"+i.getFullYear();else e=i.getDate()+"/"+(i.getMonth()+1)+"/"+i.getFullYear();return t.string?e:i},l.prototype.hammertime=function(t){return this.date(t).getTime()},l.prototype.hour=function(t){return h((t=g(t,{min:t&&t.twentyfour?0:1,max:t&&t.twentyfour?23:12})).min<0,"Chance: Min cannot be less than 0."),h(t.twentyfour&&23<t.max,"Chance: Max cannot be greater than 23 for twentyfour option."),h(!t.twentyfour&&12<t.max,"Chance: Max cannot be greater than 12."),h(t.min>t.max,"Chance: Min cannot be greater than Max."),this.natural({min:t.min,max:t.max})},l.prototype.millisecond=function(){return this.natural({max:999})},l.prototype.minute=l.prototype.second=function(t){return h((t=g(t,{min:0,max:59})).min<0,"Chance: Min cannot be less than 0."),h(59<t.max,"Chance: Max cannot be greater than 59."),h(t.min>t.max,"Chance: Min cannot be greater than Max."),this.natural({min:t.min,max:t.max})},l.prototype.month=function(t){h((t=g(t,{min:1,max:12})).min<1,"Chance: Min cannot be less than 1."),h(12<t.max,"Chance: Max cannot be greater than 12."),h(t.min>t.max,"Chance: Min cannot be greater than Max.");var e=this.pick(this.months().slice(t.min-1,t.max));return t.raw?e:e.name},l.prototype.months=function(){return this.get("months")},l.prototype.second=function(){return this.natural({max:59})},l.prototype.timestamp=function(){return this.natural({min:1,max:parseInt((new Date).getTime()/1e3,10)})},l.prototype.weekday=function(t){var e=["Monday","Tuesday","Wednesday","Thursday","Friday"];if(!(t=g(t,{weekday_only:!1})).weekday_only)e.push("Saturday"),e.push("Sunday");return this.pickone(e)},l.prototype.year=function(t){return(t=g(t,{min:(new Date).getFullYear()})).max=void 0!==t.max?t.max:t.min+100,this.natural(t).toString()},l.prototype.cc=function(t){var e,i,n;return i=(e=(t=g(t)).type?this.cc_type({name:t.type,raw:!0}):this.cc_type({raw:!0})).prefix.split(""),n=e.length-e.prefix.length-1,(i=i.concat(this.n(this.integer,n,{min:0,max:9}))).push(this.luhn_calculate(i.join(""))),i.join("")},l.prototype.cc_types=function(){return this.get("cc_types")},l.prototype.cc_type=function(t){t=g(t);var e=this.cc_types(),i=null;if(t.name){for(var n=0;n<e.length;n++)if(e[n].name===t.name||e[n].short_name===t.name){i=e[n];break}if(null===i)throw new RangeError("Chance: Credit card type '"+t.name+"' is not supported")}else i=this.pick(e);return t.raw?i:i.name},l.prototype.currency_types=function(){return this.get("currency_types")},l.prototype.currency=function(){return this.pick(this.currency_types())},l.prototype.timezones=function(){return this.get("timezones")},l.prototype.timezone=function(){return this.pick(this.timezones())},l.prototype.currency_pair=function(t){var e=this.unique(this.currency,2,{comparator:function(t,i){return t.reduce(function(t,e){return t||e.code===i.code},!1)}});if(t)return e[0].code+"/"+e[1].code;else return e},l.prototype.dollar=function(t){t=g(t,{max:1e4,min:0});var e=this.floating({min:t.min,max:t.max,fixed:2}).toString(),i=e.split(".")[1];if(void 0===i)e+=".00";else if(i.length<2)e+="0";if(e<0)return"-$"+e.replace("-","");else return"$"+e},l.prototype.euro=function(t){return Number(this.dollar(t).replace("$","")).toLocaleString()+"€"},l.prototype.exp=function(t){t=g(t);var e={};if(e.year=this.exp_year(),e.year===(new Date).getFullYear().toString())e.month=this.exp_month({future:!0});else e.month=this.exp_month();return t.raw?e:e.month+"/"+e.year},l.prototype.exp_month=function(t){var e;t=g(t);var i=(new Date).getMonth()+1;if(t.future&&12!==i)for(;e=this.month({raw:!0}).numeric,parseInt(e,10)<=i;);else e=this.month({raw:!0}).numeric;return e},l.prototype.exp_year=function(){var t=(new Date).getMonth()+1,e=(new Date).getFullYear();return this.year({min:12===t?e+1:e,max:e+10})},l.prototype.vat=function(t){switch((t=g(t,{country:"it"})).country.toLowerCase()){case"it":return this.it_vat()}},l.prototype.iban=function(){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZ";return this.string({length:2,pool:t})+this.pad(this.integer({min:0,max:99}),2)+this.string({length:4,pool:"ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789"})+this.pad(this.natural(),this.natural({min:6,max:26}))},l.prototype.it_vat=function(){var t=this.natural({min:1,max:18e5});return(t=this.pad(t,7)+this.pad(this.pick(this.provinces({country:"it"})).code,3))+this.luhn_calculate(t)},l.prototype.cf=function(t){var e,i,n,r=(t=t||{}).gender?t.gender:this.gender(),o=t.first?t.first:this.first({gender:r,nationality:"it"}),s=t.last?t.last:this.last({nationality:"it"}),a=t.birthday?t.birthday:this.birthday(),l=t.city?t.city:this.pickone(["A","B","C","D","E","F","G","H","I","L","M","Z"])+this.pad(this.natural({max:999}),3),c=[],u=function(t,e){var i,n=[];if(t.length<3)n=t.split("").concat("XXX".split("")).splice(0,3);else{if(3<(i=t.toUpperCase().split("").map(function(t){return-1!=="BCDFGHJKLMNPRSTVWZ".indexOf(t)?t:void 0}).join("")).length)if(e)i=i.substr(0,3);else i=i[0]+i.substr(2,2);if(i.length<3)n=i,i=t.toUpperCase().split("").map(function(t){return-1!=="AEIOU".indexOf(t)?t:void 0}).join("").substr(0,3-n.length);n+=i}return n};return c=c.concat(u(s,!0),u(o),(e=a,i=r,n=this,e.getFullYear().toString().substr(2)+["A","B","C","D","E","H","L","M","P","R","S","T"][e.getMonth()]+n.pad(e.getDate()+("female"===i.toLowerCase()?40:0),2)),l.toUpperCase().split("")).join(""),(c+=function(t){for(var e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ",i="ABCDEFGHIJABCDEFGHIJKLMNOPQRSTUVWXYZ",n="ABCDEFGHIJKLMNOPQRSTUVWXYZ",r=0,o=0;o<15;o++)if(o%2!=0)r+=n.indexOf(i[e.indexOf(t[o])]);else r+="BAKPLCQDREVOSFTGUHMINJWZYX".indexOf(i[e.indexOf(t[o])]);return n[r%26]}(c.toUpperCase())).toUpperCase()},l.prototype.pl_pesel=function(){for(var t=this.natural({min:1,max:9999999999}),e=this.pad(t,10).split(""),i=0;i<e.length;i++)e[i]=parseInt(e[i]);var n=(1*e[0]+3*e[1]+7*e[2]+9*e[3]+1*e[4]+3*e[5]+7*e[6]+9*e[7]+1*e[8]+3*e[9])%10;if(0!==n)n=10-n;return e.join("")+n},l.prototype.pl_nip=function(){for(var t=this.natural({min:1,max:999999999}),e=this.pad(t,9).split(""),i=0;i<e.length;i++)e[i]=parseInt(e[i]);var n=(6*e[0]+5*e[1]+7*e[2]+2*e[3]+3*e[4]+4*e[5]+5*e[6]+6*e[7]+7*e[8])%11;if(10===n)return this.pl_nip();else return e.join("")+n},l.prototype.pl_regon=function(){for(var t=this.natural({min:1,max:99999999}),e=this.pad(t,8).split(""),i=0;i<e.length;i++)e[i]=parseInt(e[i]);var n=(8*e[0]+9*e[1]+2*e[2]+3*e[3]+4*e[4]+5*e[5]+6*e[6]+7*e[7])%11;if(10===n)n=0;return e.join("")+n},l.prototype.note=function(t){t=g(t,{notes:"flatKey"});var e={naturals:["C","D","E","F","G","A","B"],flats:["D♭","E♭","G♭","A♭","B♭"],sharps:["C♯","D♯","F♯","G♯","A♯"]};return e.all=e.naturals.concat(e.flats.concat(e.sharps)),e.flatKey=e.naturals.concat(e.flats),e.sharpKey=e.naturals.concat(e.sharps),this.pickone(e[t.notes])},l.prototype.midi_note=function(t){return t=g(t,{min:0,max:127}),this.integer({min:t.min,max:t.max})},l.prototype.chord_quality=function(t){var e=["maj","min","aug","dim"];if((t=g(t,{jazz:!0})).jazz)e=["maj7","min7","7","sus","dim","ø"];return this.pickone(e)},l.prototype.chord=function(t){return t=g(t),this.note(t)+this.chord_quality(t)},l.prototype.tempo=function(t){return t=g(t,{min:40,max:320}),this.integer({min:t.min,max:t.max})},l.prototype.coin=function(t){return this.bool()?"heads":"tails"},l.prototype.d4=e({min:1,max:4}),l.prototype.d6=e({min:1,max:6}),l.prototype.d8=e({min:1,max:8}),l.prototype.d10=e({min:1,max:10}),l.prototype.d12=e({min:1,max:12}),l.prototype.d20=e({min:1,max:20}),l.prototype.d30=e({min:1,max:30}),l.prototype.d100=e({min:1,max:100}),l.prototype.rpg=function(t,e){if(e=g(e),!t)throw new RangeError("Chance: A type of die roll must be included");else{var i=t.toLowerCase().split("d"),n=[];if(2!==i.length||!parseInt(i[0],10)||!parseInt(i[1],10))throw new Error("Chance: Invalid format provided. Please provide #d# where the first # is the number of dice to roll, the second # is the max of each die");for(var r=i[0];0<r;r--)n[r-1]=this.natural({min:1,max:i[1]});return void 0!==e.sum&&e.sum?n.reduce(function(t,e){return t+e}):n}},l.prototype.guid=function(t){t=g(t,{version:5});var e="abcdef1234567890";return this.string({pool:e,length:8})+"-"+this.string({pool:e,length:4})+"-"+t.version+this.string({pool:e,length:3})+"-"+this.string({pool:"ab89",length:1})+this.string({pool:e,length:3})+"-"+this.string({pool:e,length:12})},l.prototype.hash=function(t){var e="upper"===(t=g(t,{length:40,casing:"lower"})).casing?i.toUpperCase():i;return this.string({pool:e,length:t.length})},l.prototype.luhn_check=function(t){var e=t.toString();return+e.substring(e.length-1)===this.luhn_calculate(+e.substring(0,e.length-1))},l.prototype.luhn_calculate=function(t){for(var e,i=t.toString().split("").reverse(),n=0,r=0,o=i.length;r<o;++r){if(e=+i[r],r%2==0)if(9<(e*=2))e-=9;n+=e}return 9*n%10},l.prototype.md5=function(t){var e={str:"",key:null,raw:!1};if(!t)e.str=this.string(),t={};else if("string"==typeof t)e.str=t,t={};else if("object"!==_typeof(t))return null;else if("Array"===t.constructor)return null;if(!(e=g(t,e)).str)throw new Error("A parameter is required to return an md5 hash.");return this.bimd5.md5(e.str,e.key,e.raw)};var c={firstNames:{male:{en:["James","John","Robert","Michael","William","David","Richard","Joseph","Charles","Thomas","Christopher","Daniel","Matthew","George","Donald","Anthony","Paul","Mark","Edward","Steven","Kenneth","Andrew","Brian","Joshua","Kevin","Ronald","Timothy","Jason","Jeffrey","Frank","Gary","Ryan","Nicholas","Eric","Stephen","Jacob","Larry","Jonathan","Scott","Raymond","Justin","Brandon","Gregory","Samuel","Benjamin","Patrick","Jack","Henry","Walter","Dennis","Jerry","Alexander","Peter","Tyler","Douglas","Harold","Aaron","Jose","Adam","Arthur","Zachary","Carl","Nathan","Albert","Kyle","Lawrence","Joe","Willie","Gerald","Roger","Keith","Jeremy","Terry","Harry","Ralph","Sean","Jesse","Roy","Louis","Billy","Austin","Bruce","Eugene","Christian","Bryan","Wayne","Russell","Howard","Fred","Ethan","Jordan","Philip","Alan","Juan","Randy","Vincent","Bobby","Dylan","Johnny","Phillip","Victor","Clarence","Ernest","Martin","Craig","Stanley","Shawn","Travis","Bradley","Leonard","Earl","Gabriel","Jimmy","Francis","Todd","Noah","Danny","Dale","Cody","Carlos","Allen","Frederick","Logan","Curtis","Alex","Joel","Luis","Norman","Marvin","Glenn","Tony","Nathaniel","Rodney","Melvin","Alfred","Steve","Cameron","Chad","Edwin","Caleb","Evan","Antonio","Lee","Herbert","Jeffery","Isaac","Derek","Ricky","Marcus","Theodore","Elijah","Luke","Jesus","Eddie","Troy","Mike","Dustin","Ray","Adrian","Bernard","Leroy","Angel","Randall","Wesley","Ian","Jared","Mason","Hunter","Calvin","Oscar","Clifford","Jay","Shane","Ronnie","Barry","Lucas","Corey","Manuel","Leo","Tommy","Warren","Jackson","Isaiah","Connor","Don","Dean","Jon","Julian","Miguel","Bill","Lloyd","Charlie","Mitchell","Leon","Jerome","Darrell","Jeremiah","Alvin","Brett","Seth","Floyd","Jim","Blake","Micheal","Gordon","Trevor","Lewis","Erik","Edgar","Vernon","Devin","Gavin","Jayden","Chris","Clyde","Tom","Derrick","Mario","Brent","Marc","Herman","Chase","Dominic","Ricardo","Franklin","Maurice","Max","Aiden","Owen","Lester","Gilbert","Elmer","Gene","Francisco","Glen","Cory","Garrett","Clayton","Sam","Jorge","Chester","Alejandro","Jeff","Harvey","Milton","Cole","Ivan","Andre","Duane","Landon"],it:["Adolfo","Alberto","Aldo","Alessandro","Alessio","Alfredo","Alvaro","Andrea","Angelo","Angiolo","Antonino","Antonio","Attilio","Benito","Bernardo","Bruno","Carlo","Cesare","Christian","Claudio","Corrado","Cosimo","Cristian","Cristiano","Daniele","Dario","David","Davide","Diego","Dino","Domenico","Duccio","Edoardo","Elia","Elio","Emanuele","Emiliano","Emilio","Enrico","Enzo","Ettore","Fabio","Fabrizio","Federico","Ferdinando","Fernando","Filippo","Francesco","Franco","Gabriele","Giacomo","Giampaolo","Giampiero","Giancarlo","Gianfranco","Gianluca","Gianmarco","Gianni","Gino","Giorgio","Giovanni","Giuliano","Giulio","Giuseppe","Graziano","Gregorio","Guido","Iacopo","Jacopo","Lapo","Leonardo","Lorenzo","Luca","Luciano","Luigi","Manuel","Marcello","Marco","Marino","Mario","Massimiliano","Massimo","Matteo","Mattia","Maurizio","Mauro","Michele","Mirko","Mohamed","Nello","Neri","Niccolò","Nicola","Osvaldo","Otello","Paolo","Pier Luigi","Piero","Pietro","Raffaele","Remo","Renato","Renzo","Riccardo","Roberto","Rolando","Romano","Salvatore","Samuele","Sandro","Sergio","Silvano","Simone","Stefano","Thomas","Tommaso","Ubaldo","Ugo","Umberto","Valerio","Valter","Vasco","Vincenzo","Vittorio"],nl:["Aaron","Abel","Adam","Adriaan","Albert","Alexander","Ali","Arjen","Arno","Bart","Bas","Bastiaan","Benjamin","Bob","Boris","Bram","Brent","Cas","Casper","Chris","Christiaan","Cornelis","Daan","Daley","Damian","Dani","Daniel","Daniël","David","Dean","Dirk","Dylan","Egbert","Elijah","Erik","Erwin","Evert","Ezra","Fabian","Fedde","Finn","Florian","Floris","Frank","Frans","Frederik","Freek","Geert","Gerard","Gerben","Gerrit","Gijs","Guus","Hans","Hendrik","Henk","Herman","Hidde","Hugo","Jaap","Jan Jaap","Jan-Willem","Jack","Jacob","Jan","Jason","Jasper","Jayden","Jelle","Jelte","Jens","Jeroen","Jesse","Jim","Job","Joep","Johannes","John","Jonathan","Joris","Joshua","Joël","Julian","Kees","Kevin","Koen","Lars","Laurens","Leendert","Lennard","Lodewijk","Luc","Luca","Lucas","Lukas","Luuk","Maarten","Marcus","Martijn","Martin","Matthijs","Maurits","Max","Mees","Melle","Mick","Mika","Milan","Mohamed","Mohammed","Morris","Muhammed","Nathan","Nick","Nico","Niek","Niels","Noah","Noud","Olivier","Oscar","Owen","Paul","Pepijn","Peter","Pieter","Pim","Quinten","Reinier","Rens","Robin","Ruben","Sam","Samuel","Sander","Sebastiaan","Sem","Sep","Sepp","Siem","Simon","Stan","Stef","Steven","Stijn","Sven","Teun","Thijmen","Thijs","Thomas","Tijn","Tim","Timo","Tobias","Tom","Victor","Vince","Willem","Wim","Wouter","Yusuf"],fr:["Aaron","Abdon","Abel","Abélard","Abelin","Abondance","Abraham","Absalon","Acace","Achaire","Achille","Adalard","Adalbald","Adalbéron","Adalbert","Adalric","Adam","Adegrin","Adel","Adelin","Andelin","Adelphe","Adam","Adéodat","Adhémar","Adjutor","Adolphe","Adonis","Adon","Adrien","Agapet","Agathange","Agathon","Agilbert","Agénor","Agnan","Aignan","Agrippin","Aimable","Aimé","Alain","Alban","Albin","Aubin","Albéric","Albert","Albertet","Alcibiade","Alcide","Alcée","Alcime","Aldonce","Aldric","Aldéric","Aleaume","Alexandre","Alexis","Alix","Alliaume","Aleaume","Almine","Almire","Aloïs","Alphée","Alphonse","Alpinien","Alverède","Amalric","Amaury","Amandin","Amant","Ambroise","Amédée","Amélien","Amiel","Amour","Anaël","Anastase","Anatole","Ancelin","Andéol","Andoche","André","Andoche","Ange","Angelin","Angilbe","Anglebert","Angoustan","Anicet","Anne","Annibal","Ansbert","Anselme","Anthelme","Antheaume","Anthime","Antide","Antoine","Antonius","Antonin","Apollinaire","Apollon","Aquilin","Arcade","Archambaud","Archambeau","Archange","Archibald","Arian","Ariel","Ariste","Aristide","Armand","Armel","Armin","Arnould","Arnaud","Arolde","Arsène","Arsinoé","Arthaud","Arthème","Arthur","Ascelin","Athanase","Aubry","Audebert","Audouin","Audran","Audric","Auguste","Augustin","Aurèle","Aurélien","Aurian","Auxence","Axel","Aymard","Aymeric","Aymon","Aymond","Balthazar","Baptiste","Barnabé","Barthélemy","Bartimée","Basile","Bastien","Baudouin","Bénigne","Benjamin","Benoît","Bérenger","Bérard","Bernard","Bertrand","Blaise","Bon","Boniface","Bouchard","Brice","Brieuc","Bruno","Brunon","Calixte","Calliste","Camélien","Camille","Camillien","Candide","Caribert","Carloman","Cassandre","Cassien","Cédric","Céleste","Célestin","Célien","Césaire","César","Charles","Charlemagne","Childebert","Chilpéric","Chrétien","Christian","Christodule","Christophe","Chrysostome","Clarence","Claude","Claudien","Cléandre","Clément","Clotaire","Côme","Constance","Constant","Constantin","Corentin","Cyprien","Cyriaque","Cyrille","Cyril","Damien","Daniel","David","Delphin","Denis","Désiré","Didier","Dieudonné","Dimitri","Dominique","Dorian","Dorothée","Edgard","Edmond","Édouard","Éleuthère","Élie","Élisée","Émeric","Émile","Émilien","Emmanuel","Enguerrand","Épiphane","Éric","Esprit","Ernest","Étienne","Eubert","Eudes","Eudoxe","Eugène","Eusèbe","Eustache","Évariste","Évrard","Fabien","Fabrice","Falba","Félicité","Félix","Ferdinand","Fiacre","Fidèle","Firmin","Flavien","Flodoard","Florent","Florentin","Florestan","Florian","Fortuné","Foulques","Francisque","François","Français","Franciscus","Francs","Frédéric","Fulbert","Fulcran","Fulgence","Gabin","Gabriel","Gaël","Garnier","Gaston","Gaspard","Gatien","Gaud","Gautier","Gédéon","Geoffroy","Georges","Géraud","Gérard","Gerbert","Germain","Gervais","Ghislain","Gilbert","Gilles","Girart","Gislebert","Gondebaud","Gonthier","Gontran","Gonzague","Grégoire","Guérin","Gui","Guillaume","Gustave","Guy","Guyot","Hardouin","Hector","Hédelin","Hélier","Henri","Herbert","Herluin","Hervé","Hilaire","Hildebert","Hincmar","Hippolyte","Honoré","Hubert","Hugues","Innocent","Isabeau","Isidore","Jacques","Japhet","Jason","Jean","Jeannel","Jeannot","Jérémie","Jérôme","Joachim","Joanny","Job","Jocelyn","Joël","Johan","Jonas","Jonathan","Joseph","Josse","Josselin","Jourdain","Jude","Judicaël","Jules","Julien","Juste","Justin","Lambert","Landry","Laurent","Lazare","Léandre","Léon","Léonard","Léopold","Leu","Loup","Leufroy","Libère","Liétald","Lionel","Loïc","Longin","Lorrain","Lorraine","Lothaire","Louis","Loup","Luc","Lucas","Lucien","Ludolphe","Ludovic","Macaire","Malo","Mamert","Manassé","Marc","Marceau","Marcel","Marcelin","Marius","Marseille","Martial","Martin","Mathurin","Matthias","Mathias","Matthieu","Maugis","Maurice","Mauricet","Maxence","Maxime","Maximilien","Mayeul","Médéric","Melchior","Mence","Merlin","Mérovée","Michaël","Michel","Moïse","Morgan","Nathan","Nathanaël","Narcisse","Néhémie","Nestor","Nestor","Nicéphore","Nicolas","Noé","Noël","Norbert","Normand","Normands","Octave","Odilon","Odon","Oger","Olivier","Oury","Pacôme","Palémon","Parfait","Pascal","Paterne","Patrice","Paul","Pépin","Perceval","Philémon","Philibert","Philippe","Philothée","Pie","Pierre","Pierrick","Prosper","Quentin","Raoul","Raphaël","Raymond","Régis","Réjean","Rémi","Renaud","René","Reybaud","Richard","Robert","Roch","Rodolphe","Rodrigue","Roger","Roland","Romain","Romuald","Roméo","Rome","Ronan","Roselin","Salomon","Samuel","Savin","Savinien","Scholastique","Sébastien","Séraphin","Serge","Séverin","Sidoine","Sigebert","Sigismond","Silvère","Simon","Siméon","Sixte","Stanislas","Stéphane","Stephan","Sylvain","Sylvestre","Tancrède","Tanguy","Taurin","Théodore","Théodose","Théophile","Théophraste","Thibault","Thibert","Thierry","Thomas","Timoléon","Timothée","Titien","Tonnin","Toussaint","Trajan","Tristan","Turold","Tim","Ulysse","Urbain","Valentin","Valère","Valéry","Venance","Venant","Venceslas","Vianney","Victor","Victorien","Victorin","Vigile","Vincent","Vital","Vitalien","Vivien","Waleran","Wandrille","Xavier","Xénophon","Yves","Zacharie","Zaché","Zéphirin"]},female:{en:["Mary","Emma","Elizabeth","Minnie","Margaret","Ida","Alice","Bertha","Sarah","Annie","Clara","Ella","Florence","Cora","Martha","Laura","Nellie","Grace","Carrie","Maude","Mabel","Bessie","Jennie","Gertrude","Julia","Hattie","Edith","Mattie","Rose","Catherine","Lillian","Ada","Lillie","Helen","Jessie","Louise","Ethel","Lula","Myrtle","Eva","Frances","Lena","Lucy","Edna","Maggie","Pearl","Daisy","Fannie","Josephine","Dora","Rosa","Katherine","Agnes","Marie","Nora","May","Mamie","Blanche","Stella","Ellen","Nancy","Effie","Sallie","Nettie","Della","Lizzie","Flora","Susie","Maud","Mae","Etta","Harriet","Sadie","Caroline","Katie","Lydia","Elsie","Kate","Susan","Mollie","Alma","Addie","Georgia","Eliza","Lulu","Nannie","Lottie","Amanda","Belle","Charlotte","Rebecca","Ruth","Viola","Olive","Amelia","Hannah","Jane","Virginia","Emily","Matilda","Irene","Kathryn","Esther","Willie","Henrietta","Ollie","Amy","Rachel","Sara","Estella","Theresa","Augusta","Ora","Pauline","Josie","Lola","Sophia","Leona","Anne","Mildred","Ann","Beulah","Callie","Lou","Delia","Eleanor","Barbara","Iva","Louisa","Maria","Mayme","Evelyn","Estelle","Nina","Betty","Marion","Bettie","Dorothy","Luella","Inez","Lela","Rosie","Allie","Millie","Janie","Cornelia","Victoria","Ruby","Winifred","Alta","Celia","Christine","Beatrice","Birdie","Harriett","Mable","Myra","Sophie","Tillie","Isabel","Sylvia","Carolyn","Isabelle","Leila","Sally","Ina","Essie","Bertie","Nell","Alberta","Katharine","Lora","Rena","Mina","Rhoda","Mathilda","Abbie","Eula","Dollie","Hettie","Eunice","Fanny","Ola","Lenora","Adelaide","Christina","Lelia","Nelle","Sue","Johanna","Lilly","Lucinda","Minerva","Lettie","Roxie","Cynthia","Helena","Hilda","Hulda","Bernice","Genevieve","Jean","Cordelia","Marian","Francis","Jeanette","Adeline","Gussie","Leah","Lois","Lura","Mittie","Hallie","Isabella","Olga","Phoebe","Teresa","Hester","Lida","Lina","Winnie","Claudia","Marguerite","Vera","Cecelia","Bess","Emilie","Rosetta","Verna","Myrtie","Cecilia","Elva","Olivia","Ophelia","Georgie","Elnora","Violet","Adele","Lily","Linnie","Loretta","Madge","Polly","Virgie","Eugenia","Lucile","Lucille","Mabelle","Rosalie"],it:["Ada","Adriana","Alessandra","Alessia","Alice","Angela","Anna","Anna Maria","Annalisa","Annita","Annunziata","Antonella","Arianna","Asia","Assunta","Aurora","Barbara","Beatrice","Benedetta","Bianca","Bruna","Camilla","Carla","Carlotta","Carmela","Carolina","Caterina","Catia","Cecilia","Chiara","Cinzia","Clara","Claudia","Costanza","Cristina","Daniela","Debora","Diletta","Dina","Donatella","Elena","Eleonora","Elisa","Elisabetta","Emanuela","Emma","Eva","Federica","Fernanda","Fiorella","Fiorenza","Flora","Franca","Francesca","Gabriella","Gaia","Gemma","Giada","Gianna","Gina","Ginevra","Giorgia","Giovanna","Giulia","Giuliana","Giuseppa","Giuseppina","Grazia","Graziella","Greta","Ida","Ilaria","Ines","Iolanda","Irene","Irma","Isabella","Jessica","Laura","Lea","Letizia","Licia","Lidia","Liliana","Lina","Linda","Lisa","Livia","Loretta","Luana","Lucia","Luciana","Lucrezia","Luisa","Manuela","Mara","Marcella","Margherita","Maria","Maria Cristina","Maria Grazia","Maria Luisa","Maria Pia","Maria Teresa","Marina","Marisa","Marta","Martina","Marzia","Matilde","Melissa","Michela","Milena","Mirella","Monica","Natalina","Nella","Nicoletta","Noemi","Olga","Paola","Patrizia","Piera","Pierina","Raffaella","Rebecca","Renata","Rina","Rita","Roberta","Rosa","Rosanna","Rossana","Rossella","Sabrina","Sandra","Sara","Serena","Silvana","Silvia","Simona","Simonetta","Sofia","Sonia","Stefania","Susanna","Teresa","Tina","Tiziana","Tosca","Valentina","Valeria","Vanda","Vanessa","Vanna","Vera","Veronica","Vilma","Viola","Virginia","Vittoria"],nl:["Ada","Arianne","Afke","Amanda","Amber","Amy","Aniek","Anita","Anja","Anna","Anne","Annelies","Annemarie","Annette","Anouk","Astrid","Aukje","Barbara","Bianca","Carla","Carlijn","Carolien","Chantal","Charlotte","Claudia","Daniëlle","Debora","Diane","Dora","Eline","Elise","Ella","Ellen","Emma","Esmee","Evelien","Esther","Erica","Eva","Femke","Fleur","Floor","Froukje","Gea","Gerda","Hanna","Hanneke","Heleen","Hilde","Ilona","Ina","Inge","Ingrid","Iris","Isabel","Isabelle","Janneke","Jasmijn","Jeanine","Jennifer","Jessica","Johanna","Joke","Julia","Julie","Karen","Karin","Katja","Kim","Lara","Laura","Lena","Lianne","Lieke","Lilian","Linda","Lisa","Lisanne","Lotte","Louise","Maaike","Manon","Marga","Maria","Marissa","Marit","Marjolein","Martine","Marleen","Melissa","Merel","Miranda","Michelle","Mirjam","Mirthe","Naomi","Natalie","Nienke","Nina","Noortje","Olivia","Patricia","Paula","Paulien","Ramona","Ria","Rianne","Roos","Rosanne","Ruth","Sabrina","Sandra","Sanne","Sara","Saskia","Silvia","Sofia","Sophie","Sonja","Suzanne","Tamara","Tess","Tessa","Tineke","Valerie","Vanessa","Veerle","Vera","Victoria","Wendy","Willeke","Yvonne","Zoë"],fr:["Abdon","Abel","Abigaëlle","Abigaïl","Acacius","Acanthe","Adalbert","Adalsinde","Adegrine","Adélaïde","Adèle","Adélie","Adeline","Adeltrude","Adolphe","Adonis","Adrastée","Adrehilde","Adrienne","Agathe","Agilbert","Aglaé","Aignan","Agneflète","Agnès","Agrippine","Aimé","Alaine","Alaïs","Albane","Albérade","Alberte","Alcide","Alcine","Alcyone","Aldegonde","Aleth","Alexandrine","Alexine","Alice","Aliénor","Aliette","Aline","Alix","Alizé","Aloïse","Aloyse","Alphonsine","Althée","Amaliane","Amalthée","Amande","Amandine","Amant","Amarande","Amaranthe","Amaryllis","Ambre","Ambroisie","Amélie","Améthyste","Aminte","Anaël","Anaïs","Anastasie","Anatole","Ancelin","Andrée","Anémone","Angadrême","Angèle","Angeline","Angélique","Angilbert","Anicet","Annabelle","Anne","Annette","Annick","Annie","Annonciade","Ansbert","Anstrudie","Anthelme","Antigone","Antoinette","Antonine","Aphélie","Apolline","Apollonie","Aquiline","Arabelle","Arcadie","Archange","Argine","Ariane","Aricie","Ariel","Arielle","Arlette","Armance","Armande","Armandine","Armelle","Armide","Armelle","Armin","Arnaud","Arsène","Arsinoé","Artémis","Arthur","Ascelin","Ascension","Assomption","Astarté","Astérie","Astrée","Astrid","Athalie","Athanasie","Athina","Aube","Albert","Aude","Audrey","Augustine","Aure","Aurélie","Aurélien","Aurèle","Aurore","Auxence","Aveline","Abigaëlle","Avoye","Axelle","Aymard","Azalée","Adèle","Adeline","Barbe","Basilisse","Bathilde","Béatrice","Béatrix","Bénédicte","Bérengère","Bernadette","Berthe","Bertille","Beuve","Blanche","Blanc","Blandine","Brigitte","Brune","Brunehilde","Callista","Camille","Capucine","Carine","Caroline","Cassandre","Catherine","Cécile","Céleste","Célestine","Céline","Chantal","Charlène","Charline","Charlotte","Chloé","Christelle","Christiane","Christine","Claire","Clara","Claude","Claudine","Clarisse","Clémence","Clémentine","Cléo","Clio","Clotilde","Coline","Conception","Constance","Coralie","Coraline","Corentine","Corinne","Cyrielle","Daniel","Daniel","Daphné","Débora","Delphine","Denise","Diane","Dieudonné","Dominique","Doriane","Dorothée","Douce","Édith","Edmée","Éléonore","Éliane","Élia","Éliette","Élisabeth","Élise","Ella","Élodie","Éloïse","Elsa","Émeline","Émérance","Émérentienne","Émérencie","Émilie","Emma","Emmanuelle","Emmelie","Ernestine","Esther","Estelle","Eudoxie","Eugénie","Eulalie","Euphrasie","Eusébie","Évangéline","Eva","Ève","Évelyne","Fanny","Fantine","Faustine","Félicie","Fernande","Flavie","Fleur","Flore","Florence","Florie","Fortuné","France","Francia","Françoise","Francine","Gabrielle","Gaëlle","Garance","Geneviève","Georgette","Gerberge","Germaine","Gertrude","Gisèle","Guenièvre","Guilhemine","Guillemette","Gustave","Gwenael","Hélène","Héloïse","Henriette","Hermine","Hermione","Hippolyte","Honorine","Hortense","Huguette","Ines","Irène","Irina","Iris","Isabeau","Isabelle","Iseult","Isolde","Ismérie","Jacinthe","Jacqueline","Jade","Janine","Jeanne","Jocelyne","Joëlle","Joséphine","Judith","Julia","Julie","Jules","Juliette","Justine","Katy","Kathy","Katie","Laura","Laure","Laureline","Laurence","Laurene","Lauriane","Laurianne","Laurine","Léa","Léna","Léonie","Léon","Léontine","Lorraine","Lucie","Lucienne","Lucille","Ludivine","Lydie","Lydie","Megane","Madeleine","Magali","Maguelone","Mallaury","Manon","Marceline","Margot","Marguerite","Marianne","Marie","Myriam","Marie","Marine","Marion","Marlène","Marthe","Martine","Mathilde","Maud","Maureen","Mauricette","Maxime","Mélanie","Melissa","Mélissandre","Mélisande","Mélodie","Michel","Micheline","Mireille","Miriam","Moïse","Monique","Morgane","Muriel","Mylène","Nadège","Nadine","Nathalie","Nicole","Nicolette","Nine","Noël","Noémie","Océane","Odette","Odile","Olive","Olivia","Olympe","Ombline","Ombeline","Ophélie","Oriande","Oriane","Ozanne","Pascale","Pascaline","Paule","Paulette","Pauline","Priscille","Prisca","Prisque","Pécine","Pélagie","Pénélope","Perrine","Pétronille","Philippine","Philomène","Philothée","Primerose","Prudence","Pulchérie","Quentine","Quiéta","Quintia","Quintilla","Rachel","Raphaëlle","Raymonde","Rebecca","Régine","Réjeanne","René","Rita","Rita","Rolande","Romane","Rosalie","Rose","Roseline","Sabine","Salomé","Sandra","Sandrine","Sarah","Ségolène","Séverine","Sibylle","Simone","Sixt","Solange","Soline","Solène","Sophie","Stéphanie","Suzanne","Sylvain","Sylvie","Tatiana","Thaïs","Théodora","Thérèse","Tiphaine","Ursule","Valentine","Valérie","Véronique","Victoire","Victorine","Vinciane","Violette","Virginie","Viviane","Xavière","Yolande","Ysaline","Yvette","Yvonne","Zélie","Zita","Zoé"]}},lastNames:{en:["Smith","Johnson","Williams","Jones","Brown","Davis","Miller","Wilson","Moore","Taylor","Anderson","Thomas","Jackson","White","Harris","Martin","Thompson","Garcia","Martinez","Robinson","Clark","Rodriguez","Lewis","Lee","Walker","Hall","Allen","Young","Hernandez","King","Wright","Lopez","Hill","Scott","Green","Adams","Baker","Gonzalez","Nelson","Carter","Mitchell","Perez","Roberts","Turner","Phillips","Campbell","Parker","Evans","Edwards","Collins","Stewart","Sanchez","Morris","Rogers","Reed","Cook","Morgan","Bell","Murphy","Bailey","Rivera","Cooper","Richardson","Cox","Howard","Ward","Torres","Peterson","Gray","Ramirez","James","Watson","Brooks","Kelly","Sanders","Price","Bennett","Wood","Barnes","Ross","Henderson","Coleman","Jenkins","Perry","Powell","Long","Patterson","Hughes","Flores","Washington","Butler","Simmons","Foster","Gonzales","Bryant","Alexander","Russell","Griffin","Diaz","Hayes","Myers","Ford","Hamilton","Graham","Sullivan","Wallace","Woods","Cole","West","Jordan","Owens","Reynolds","Fisher","Ellis","Harrison","Gibson","McDonald","Cruz","Marshall","Ortiz","Gomez","Murray","Freeman","Wells","Webb","Simpson","Stevens","Tucker","Porter","Hunter","Hicks","Crawford","Henry","Boyd","Mason","Morales","Kennedy","Warren","Dixon","Ramos","Reyes","Burns","Gordon","Shaw","Holmes","Rice","Robertson","Hunt","Black","Daniels","Palmer","Mills","Nichols","Grant","Knight","Ferguson","Rose","Stone","Hawkins","Dunn","Perkins","Hudson","Spencer","Gardner","Stephens","Payne","Pierce","Berry","Matthews","Arnold","Wagner","Willis","Ray","Watkins","Olson","Carroll","Duncan","Snyder","Hart","Cunningham","Bradley","Lane","Andrews","Ruiz","Harper","Fox","Riley","Armstrong","Carpenter","Weaver","Greene","Lawrence","Elliott","Chavez","Sims","Austin","Peters","Kelley","Franklin","Lawson","Fields","Gutierrez","Ryan","Schmidt","Carr","Vasquez","Castillo","Wheeler","Chapman","Oliver","Montgomery","Richards","Williamson","Johnston","Banks","Meyer","Bishop","McCoy","Howell","Alvarez","Morrison","Hansen","Fernandez","Garza","Harvey","Little","Burton","Stanley","Nguyen","George","Jacobs","Reid","Kim","Fuller","Lynch","Dean","Gilbert","Garrett","Romero","Welch","Larson","Frazier","Burke","Hanson","Day","Mendoza","Moreno","Bowman","Medina","Fowler","Brewer","Hoffman","Carlson","Silva","Pearson","Holland","Douglas","Fleming","Jensen","Vargas","Byrd","Davidson","Hopkins","May","Terry","Herrera","Wade","Soto","Walters","Curtis","Neal","Caldwell","Lowe","Jennings","Barnett","Graves","Jimenez","Horton","Shelton","Barrett","Obrien","Castro","Sutton","Gregory","McKinney","Lucas","Miles","Craig","Rodriquez","Chambers","Holt","Lambert","Fletcher","Watts","Bates","Hale","Rhodes","Pena","Beck","Newman","Haynes","McDaniel","Mendez","Bush","Vaughn","Parks","Dawson","Santiago","Norris","Hardy","Love","Steele","Curry","Powers","Schultz","Barker","Guzman","Page","Munoz","Ball","Keller","Chandler","Weber","Leonard","Walsh","Lyons","Ramsey","Wolfe","Schneider","Mullins","Benson","Sharp","Bowen","Daniel","Barber","Cummings","Hines","Baldwin","Griffith","Valdez","Hubbard","Salazar","Reeves","Warner","Stevenson","Burgess","Santos","Tate","Cross","Garner","Mann","Mack","Moss","Thornton","Dennis","McGee","Farmer","Delgado","Aguilar","Vega","Glover","Manning","Cohen","Harmon","Rodgers","Robbins","Newton","Todd","Blair","Higgins","Ingram","Reese","Cannon","Strickland","Townsend","Potter","Goodwin","Walton","Rowe","Hampton","Ortega","Patton","Swanson","Joseph","Francis","Goodman","Maldonado","Yates","Becker","Erickson","Hodges","Rios","Conner","Adkins","Webster","Norman","Malone","Hammond","Flowers","Cobb","Moody","Quinn","Blake","Maxwell","Pope","Floyd","Osborne","Paul","McCarthy","Guerrero","Lindsey","Estrada","Sandoval","Gibbs","Tyler","Gross","Fitzgerald","Stokes","Doyle","Sherman","Saunders","Wise","Colon","Gill","Alvarado","Greer","Padilla","Simon","Waters","Nunez","Ballard","Schwartz","McBride","Houston","Christensen","Klein","Pratt","Briggs","Parsons","McLaughlin","Zimmerman","French","Buchanan","Moran","Copeland","Roy","Pittman","Brady","McCormick","Holloway","Brock","Poole","Frank","Logan","Owen","Bass","Marsh","Drake","Wong","Jefferson","Park","Morton","Abbott","Sparks","Patrick","Norton","Huff","Clayton","Massey","Lloyd","Figueroa","Carson","Bowers","Roberson","Barton","Tran","Lamb","Harrington","Casey","Boone","Cortez","Clarke","Mathis","Singleton","Wilkins","Cain","Bryan","Underwood","Hogan","McKenzie","Collier","Luna","Phelps","McGuire","Allison","Bridges","Wilkerson","Nash","Summers","Atkins"],it:["Acciai","Aglietti","Agostini","Agresti","Ahmed","Aiazzi","Albanese","Alberti","Alessi","Alfani","Alinari","Alterini","Amato","Ammannati","Ancillotti","Andrei","Andreini","Andreoni","Angeli","Anichini","Antonelli","Antonini","Arena","Ariani","Arnetoli","Arrighi","Baccani","Baccetti","Bacci","Bacherini","Badii","Baggiani","Baglioni","Bagni","Bagnoli","Baldassini","Baldi","Baldini","Ballerini","Balli","Ballini","Balloni","Bambi","Banchi","Bandinelli","Bandini","Bani","Barbetti","Barbieri","Barchielli","Bardazzi","Bardelli","Bardi","Barducci","Bargellini","Bargiacchi","Barni","Baroncelli","Baroncini","Barone","Baroni","Baronti","Bartalesi","Bartoletti","Bartoli","Bartolini","Bartoloni","Bartolozzi","Basagni","Basile","Bassi","Batacchi","Battaglia","Battaglini","Bausi","Becagli","Becattini","Becchi","Becucci","Bellandi","Bellesi","Belli","Bellini","Bellucci","Bencini","Benedetti","Benelli","Beni","Benini","Bensi","Benucci","Benvenuti","Berlincioni","Bernacchioni","Bernardi","Bernardini","Berni","Bernini","Bertelli","Berti","Bertini","Bessi","Betti","Bettini","Biagi","Biagini","Biagioni","Biagiotti","Biancalani","Bianchi","Bianchini","Bianco","Biffoli","Bigazzi","Bigi","Biliotti","Billi","Binazzi","Bindi","Bini","Biondi","Bizzarri","Bocci","Bogani","Bolognesi","Bonaiuti","Bonanni","Bonciani","Boncinelli","Bondi","Bonechi","Bongini","Boni","Bonini","Borchi","Boretti","Borghi","Borghini","Borgioli","Borri","Borselli","Boschi","Bottai","Bracci","Braccini","Brandi","Braschi","Bravi","Brazzini","Breschi","Brilli","Brizzi","Brogelli","Brogi","Brogioni","Brunelli","Brunetti","Bruni","Bruno","Brunori","Bruschi","Bucci","Bucciarelli","Buccioni","Bucelli","Bulli","Burberi","Burchi","Burgassi","Burroni","Bussotti","Buti","Caciolli","Caiani","Calabrese","Calamai","Calamandrei","Caldini","Calo'","Calonaci","Calosi","Calvelli","Cambi","Camiciottoli","Cammelli","Cammilli","Campolmi","Cantini","Capanni","Capecchi","Caponi","Cappelletti","Cappelli","Cappellini","Cappugi","Capretti","Caputo","Carbone","Carboni","Cardini","Carlesi","Carletti","Carli","Caroti","Carotti","Carrai","Carraresi","Carta","Caruso","Casalini","Casati","Caselli","Casini","Castagnoli","Castellani","Castelli","Castellucci","Catalano","Catarzi","Catelani","Cavaciocchi","Cavallaro","Cavallini","Cavicchi","Cavini","Ceccarelli","Ceccatelli","Ceccherelli","Ceccherini","Cecchi","Cecchini","Cecconi","Cei","Cellai","Celli","Cellini","Cencetti","Ceni","Cenni","Cerbai","Cesari","Ceseri","Checcacci","Checchi","Checcucci","Cheli","Chellini","Chen","Cheng","Cherici","Cherubini","Chiaramonti","Chiarantini","Chiarelli","Chiari","Chiarini","Chiarugi","Chiavacci","Chiesi","Chimenti","Chini","Chirici","Chiti","Ciabatti","Ciampi","Cianchi","Cianfanelli","Cianferoni","Ciani","Ciapetti","Ciappi","Ciardi","Ciatti","Cicali","Ciccone","Cinelli","Cini","Ciobanu","Ciolli","Cioni","Cipriani","Cirillo","Cirri","Ciucchi","Ciuffi","Ciulli","Ciullini","Clemente","Cocchi","Cognome","Coli","Collini","Colombo","Colzi","Comparini","Conforti","Consigli","Conte","Conti","Contini","Coppini","Coppola","Corsi","Corsini","Corti","Cortini","Cosi","Costa","Costantini","Costantino","Cozzi","Cresci","Crescioli","Cresti","Crini","Curradi","D'Agostino","D'Alessandro","D'Amico","D'Angelo","Daddi","Dainelli","Dallai","Danti","Davitti","De Angelis","De Luca","De Marco","De Rosa","De Santis","De Simone","De Vita","Degl'Innocenti","Degli Innocenti","Dei","Del Lungo","Del Re","Di Marco","Di Stefano","Dini","Diop","Dobre","Dolfi","Donati","Dondoli","Dong","Donnini","Ducci","Dumitru","Ermini","Esposito","Evangelisti","Fabbri","Fabbrini","Fabbrizzi","Fabbroni","Fabbrucci","Fabiani","Facchini","Faggi","Fagioli","Failli","Faini","Falciani","Falcini","Falcone","Fallani","Falorni","Falsini","Falugiani","Fancelli","Fanelli","Fanetti","Fanfani","Fani","Fantappie'","Fantechi","Fanti","Fantini","Fantoni","Farina","Fattori","Favilli","Fedi","Fei","Ferrante","Ferrara","Ferrari","Ferraro","Ferretti","Ferri","Ferrini","Ferroni","Fiaschi","Fibbi","Fiesoli","Filippi","Filippini","Fini","Fioravanti","Fiore","Fiorentini","Fiorini","Fissi","Focardi","Foggi","Fontana","Fontanelli","Fontani","Forconi","Formigli","Forte","Forti","Fortini","Fossati","Fossi","Francalanci","Franceschi","Franceschini","Franchi","Franchini","Franci","Francini","Francioni","Franco","Frassineti","Frati","Fratini","Frilli","Frizzi","Frosali","Frosini","Frullini","Fusco","Fusi","Gabbrielli","Gabellini","Gagliardi","Galanti","Galardi","Galeotti","Galletti","Galli","Gallo","Gallori","Gambacciani","Gargani","Garofalo","Garuglieri","Gashi","Gasperini","Gatti","Gelli","Gensini","Gentile","Gentili","Geri","Gerini","Gheri","Ghini","Giachetti","Giachi","Giacomelli","Gianassi","Giani","Giannelli","Giannetti","Gianni","Giannini","Giannoni","Giannotti","Giannozzi","Gigli","Giordano","Giorgetti","Giorgi","Giovacchini","Giovannelli","Giovannetti","Giovannini","Giovannoni","Giuliani","Giunti","Giuntini","Giusti","Gonnelli","Goretti","Gori","Gradi","Gramigni","Grassi","Grasso","Graziani","Grazzini","Greco","Grifoni","Grillo","Grimaldi","Grossi","Gualtieri","Guarducci","Guarino","Guarnieri","Guasti","Guerra","Guerri","Guerrini","Guidi","Guidotti","He","Hoxha","Hu","Huang","Iandelli","Ignesti","Innocenti","Jin","La Rosa","Lai","Landi","Landini","Lanini","Lapi","Lapini","Lari","Lascialfari","Lastrucci","Latini","Lazzeri","Lazzerini","Lelli","Lenzi","Leonardi","Leoncini","Leone","Leoni","Lepri","Li","Liao","Lin","Linari","Lippi","Lisi","Livi","Lombardi","Lombardini","Lombardo","Longo","Lopez","Lorenzi","Lorenzini","Lorini","Lotti","Lu","Lucchesi","Lucherini","Lunghi","Lupi","Madiai","Maestrini","Maffei","Maggi","Maggini","Magherini","Magini","Magnani","Magnelli","Magni","Magnolfi","Magrini","Malavolti","Malevolti","Manca","Mancini","Manetti","Manfredi","Mangani","Mannelli","Manni","Mannini","Mannucci","Manuelli","Manzini","Marcelli","Marchese","Marchetti","Marchi","Marchiani","Marchionni","Marconi","Marcucci","Margheri","Mari","Mariani","Marilli","Marinai","Marinari","Marinelli","Marini","Marino","Mariotti","Marsili","Martelli","Martinelli","Martini","Martino","Marzi","Masi","Masini","Masoni","Massai","Materassi","Mattei","Matteini","Matteucci","Matteuzzi","Mattioli","Mattolini","Matucci","Mauro","Mazzanti","Mazzei","Mazzetti","Mazzi","Mazzini","Mazzocchi","Mazzoli","Mazzoni","Mazzuoli","Meacci","Mecocci","Meini","Melani","Mele","Meli","Mengoni","Menichetti","Meoni","Merlini","Messeri","Messina","Meucci","Miccinesi","Miceli","Micheli","Michelini","Michelozzi","Migliori","Migliorini","Milani","Miniati","Misuri","Monaco","Montagnani","Montagni","Montanari","Montelatici","Monti","Montigiani","Montini","Morandi","Morandini","Morelli","Moretti","Morganti","Mori","Morini","Moroni","Morozzi","Mugnai","Mugnaini","Mustafa","Naldi","Naldini","Nannelli","Nanni","Nannini","Nannucci","Nardi","Nardini","Nardoni","Natali","Ndiaye","Nencetti","Nencini","Nencioni","Neri","Nesi","Nesti","Niccolai","Niccoli","Niccolini","Nigi","Nistri","Nocentini","Noferini","Novelli","Nucci","Nuti","Nutini","Oliva","Olivieri","Olmi","Orlandi","Orlandini","Orlando","Orsini","Ortolani","Ottanelli","Pacciani","Pace","Paci","Pacini","Pagani","Pagano","Paggetti","Pagliai","Pagni","Pagnini","Paladini","Palagi","Palchetti","Palloni","Palmieri","Palumbo","Pampaloni","Pancani","Pandolfi","Pandolfini","Panerai","Panichi","Paoletti","Paoli","Paolini","Papi","Papini","Papucci","Parenti","Parigi","Parisi","Parri","Parrini","Pasquini","Passeri","Pecchioli","Pecorini","Pellegrini","Pepi","Perini","Perrone","Peruzzi","Pesci","Pestelli","Petri","Petrini","Petrucci","Pettini","Pezzati","Pezzatini","Piani","Piazza","Piazzesi","Piazzini","Piccardi","Picchi","Piccini","Piccioli","Pieraccini","Pieraccioni","Pieralli","Pierattini","Pieri","Pierini","Pieroni","Pietrini","Pini","Pinna","Pinto","Pinzani","Pinzauti","Piras","Pisani","Pistolesi","Poggesi","Poggi","Poggiali","Poggiolini","Poli","Pollastri","Porciani","Pozzi","Pratellesi","Pratesi","Prosperi","Pruneti","Pucci","Puccini","Puccioni","Pugi","Pugliese","Puliti","Querci","Quercioli","Raddi","Radu","Raffaelli","Ragazzini","Ranfagni","Ranieri","Rastrelli","Raugei","Raveggi","Renai","Renzi","Rettori","Ricci","Ricciardi","Ridi","Ridolfi","Rigacci","Righi","Righini","Rinaldi","Risaliti","Ristori","Rizzo","Rocchi","Rocchini","Rogai","Romagnoli","Romanelli","Romani","Romano","Romei","Romeo","Romiti","Romoli","Romolini","Rontini","Rosati","Roselli","Rosi","Rossetti","Rossi","Rossini","Rovai","Ruggeri","Ruggiero","Russo","Sabatini","Saccardi","Sacchetti","Sacchi","Sacco","Salerno","Salimbeni","Salucci","Salvadori","Salvestrini","Salvi","Salvini","Sanesi","Sani","Sanna","Santi","Santini","Santoni","Santoro","Santucci","Sardi","Sarri","Sarti","Sassi","Sbolci","Scali","Scarpelli","Scarselli","Scopetani","Secci","Selvi","Senatori","Senesi","Serafini","Sereni","Serra","Sestini","Sguanci","Sieni","Signorini","Silvestri","Simoncini","Simonetti","Simoni","Singh","Sodi","Soldi","Somigli","Sorbi","Sorelli","Sorrentino","Sottili","Spina","Spinelli","Staccioli","Staderini","Stefanelli","Stefani","Stefanini","Stella","Susini","Tacchi","Tacconi","Taddei","Tagliaferri","Tamburini","Tanganelli","Tani","Tanini","Tapinassi","Tarchi","Tarchiani","Targioni","Tassi","Tassini","Tempesti","Terzani","Tesi","Testa","Testi","Tilli","Tinti","Tirinnanzi","Toccafondi","Tofanari","Tofani","Tognaccini","Tonelli","Tonini","Torelli","Torrini","Tosi","Toti","Tozzi","Trambusti","Trapani","Tucci","Turchi","Ugolini","Ulivi","Valente","Valenti","Valentini","Vangelisti","Vanni","Vannini","Vannoni","Vannozzi","Vannucchi","Vannucci","Ventura","Venturi","Venturini","Vestri","Vettori","Vichi","Viciani","Vieri","Vigiani","Vignoli","Vignolini","Vignozzi","Villani","Vinci","Visani","Vitale","Vitali","Viti","Viviani","Vivoli","Volpe","Volpi","Wang","Wu","Xu","Yang","Ye","Zagli","Zani","Zanieri","Zanobini","Zecchi","Zetti","Zhang","Zheng","Zhou","Zhu","Zingoni","Zini","Zoppi"],nl:["Albers","Alblas","Appelman","Baars","Baas","Bakker","Blank","Bleeker","Blok","Blom","Boer","Boers","Boldewijn","Boon","Boot","Bos","Bosch","Bosma","Bosman","Bouma","Bouman","Bouwman","Brands","Brouwer","Burger","Buijs","Buitenhuis","Ceder","Cohen","Dekker","Dekkers","Dijkman","Dijkstra","Driessen","Drost","Engel","Evers","Faber","Franke","Gerritsen","Goedhart","Goossens","Groen","Groenenberg","Groot","Haan","Hart","Heemskerk","Hendriks","Hermans","Hoekstra","Hofman","Hopman","Huisman","Jacobs","Jansen","Janssen","Jonker","Jaspers","Keijzer","Klaassen","Klein","Koek","Koenders","Kok","Kool","Koopman","Koopmans","Koning","Koster","Kramer","Kroon","Kuijpers","Kuiper","Kuipers","Kurt","Koster","Kwakman","Los","Lubbers","Maas","Markus","Martens","Meijer","Mol","Molenaar","Mulder","Nieuwenhuis","Peeters","Peters","Pengel","Pieters","Pool","Post","Postma","Prins","Pronk","Reijnders","Rietveld","Roest","Roos","Sanders","Schaap","Scheffer","Schenk","Schilder","Schipper","Schmidt","Scholten","Schouten","Schut","Schutte","Schuurman","Simons","Smeets","Smit","Smits","Snel","Swinkels","Tas","Terpstra","Timmermans","Tol","Tromp","Troost","Valk","Veenstra","Veldkamp","Verbeek","Verheul","Verhoeven","Vermeer","Vermeulen","Verweij","Vink","Visser","Voorn","Vos","Wagenaar","Wiersema","Willems","Willemsen","Witteveen","Wolff","Wolters","Zijlstra","Zwart","de Beer","de Boer","de Bruijn","de Bruin","de Graaf","de Groot","de Haan","de Haas","de Jager","de Jong","de Jonge","de Koning","de Lange","de Leeuw","de Ridder","de Rooij","de Ruiter","de Vos","de Vries","de Waal","de Wit","de Zwart","van Beek","van Boven","van Dam","van Dijk","van Dongen","van Doorn","van Egmond","van Eijk","van Es","van Gelder","van Gelderen","van Houten","van Hulst","van Kempen","van Kesteren","van Leeuwen","van Loon","van Mill","van Noord","van Ommen","van Ommeren","van Oosten","van Oostveen","van Rijn","van Schaik","van Veen","van Vliet","van Wijk","van Wijngaarden","van den Poel","van de Pol","van den Ploeg","van de Ven","van den Berg","van den Bosch","van den Brink","van den Broek","van den Heuvel","van der Heijden","van der Horst","van der Hulst","van der Kroon","van der Laan","van der Linden","van der Meer","van der Meij","van der Meulen","van der Molen","van der Sluis","van der Spek","van der Veen","van der Velde","van der Velden","van der Vliet","van der Wal"],uk:["Smith","Jones","Williams","Taylor","Brown","Davies","Evans","Wilson","Thomas","Johnson","Roberts","Robinson","Thompson","Wright","Walker","White","Edwards","Hughes","Green","Hall","Lewis","Harris","Clarke","Patel","Jackson","Wood","Turner","Martin","Cooper","Hill","Ward","Morris","Moore","Clark","Lee","King","Baker","Harrison","Morgan","Allen","James","Scott","Phillips","Watson","Davis","Parker","Price","Bennett","Young","Griffiths","Mitchell","Kelly","Cook","Carter","Richardson","Bailey","Collins","Bell","Shaw","Murphy","Miller","Cox","Richards","Khan","Marshall","Anderson","Simpson","Ellis","Adams","Singh","Begum","Wilkinson","Foster","Chapman","Powell","Webb","Rogers","Gray","Mason","Ali","Hunt","Hussain","Campbell","Matthews","Owen","Palmer","Holmes","Mills","Barnes","Knight","Lloyd","Butler","Russell","Barker","Fisher","Stevens","Jenkins","Murray","Dixon","Harvey","Graham","Pearson","Ahmed","Fletcher","Walsh","Kaur","Gibson","Howard","Andrews","Stewart","Elliott","Reynolds","Saunders","Payne","Fox","Ford","Pearce","Day","Brooks","West","Lawrence","Cole","Atkinson","Bradley","Spencer","Gill","Dawson","Ball","Burton","O'brien","Watts","Rose","Booth","Perry","Ryan","Grant","Wells","Armstrong","Francis","Rees","Hayes","Hart","Hudson","Newman","Barrett","Webster","Hunter","Gregory","Carr","Lowe","Page","Marsh","Riley","Dunn","Woods","Parsons","Berry","Stone","Reid","Holland","Hawkins","Harding","Porter","Robertson","Newton","Oliver","Reed","Kennedy","Williamson","Bird","Gardner","Shah","Dean","Lane","Cooke","Bates","Henderson","Parry","Burgess","Bishop","Walton","Burns","Nicholson","Shepherd","Ross","Cross","Long","Freeman","Warren","Nicholls","Hamilton","Byrne","Sutton","Mcdonald","Yates","Hodgson","Robson","Curtis","Hopkins","O'connor","Harper","Coleman","Watkins","Moss","Mccarthy","Chambers","O'neill","Griffin","Sharp","Hardy","Wheeler","Potter","Osborne","Johnston","Gordon","Doyle","Wallace","George","Jordan","Hutchinson","Rowe","Burke","May","Pritchard","Gilbert","Willis","Higgins","Read","Miles","Stevenson","Stephenson","Hammond","Arnold","Buckley","Walters","Hewitt","Barber","Nelson","Slater","Austin","Sullivan","Whitehead","Mann","Frost","Lambert","Stephens","Blake","Akhtar","Lynch","Goodwin","Barton","Woodward","Thomson","Cunningham","Quinn","Barnett","Baxter","Bibi","Clayton","Nash","Greenwood","Jennings","Holt","Kemp","Poole","Gallagher","Bond","Stokes","Tucker","Davidson","Fowler","Heath","Norman","Middleton","Lawson","Banks","French","Stanley","Jarvis","Gibbs","Ferguson","Hayward","Carroll","Douglas","Dickinson","Todd","Barlow","Peters","Lucas","Knowles","Hartley","Miah","Simmons","Morton","Alexander","Field","Morrison","Norris","Townsend","Preston","Hancock","Thornton","Baldwin","Burrows","Briggs","Parkinson","Reeves","Macdonald","Lamb","Black","Abbott","Sanders","Thorpe","Holden","Tomlinson","Perkins","Ashton","Rhodes","Fuller","Howe","Bryant","Vaughan","Dale","Davey","Weston","Bartlett","Whittaker","Davison","Kent","Skinner","Birch","Morley","Daniels","Glover","Howell","Cartwright","Pugh","Humphreys","Goddard","Brennan","Wall","Kirby","Bowen","Savage","Bull","Wong","Dobson","Smart","Wilkins","Kirk","Fraser","Duffy","Hicks","Patterson","Bradshaw","Little","Archer","Warner","Waters","O'sullivan","Farrell","Brookes","Atkins","Kay","Dodd","Bentley","Flynn","John","Schofield","Short","Haynes","Wade","Butcher","Henry","Sanderson","Crawford","Sheppard","Bolton","Coates","Giles","Gould","Houghton","Gibbons","Pratt","Manning","Law","Hooper","Noble","Dyer","Rahman","Clements","Moran","Sykes","Chan","Doherty","Connolly","Joyce","Franklin","Hobbs","Coles","Herbert","Steele","Kerr","Leach","Winter","Owens","Duncan","Naylor","Fleming","Horton","Finch","Fitzgerald","Randall","Carpenter","Marsden","Browne","Garner","Pickering","Hale","Dennis","Vincent","Chadwick","Chandler","Sharpe","Nolan","Lyons","Hurst","Collier","Peacock","Howarth","Faulkner","Rice","Pollard","Welch","Norton","Gough","Sinclair","Blackburn","Bryan","Conway","Power","Cameron","Daly","Allan","Hanson","Gardiner","Boyle","Myers","Turnbull","Wallis","Mahmood","Sims","Swift","Iqbal","Pope","Brady","Chamberlain","Rowley","Tyler","Farmer","Metcalfe","Hilton","Godfrey","Holloway","Parkin","Bray","Talbot","Donnelly","Nixon","Charlton","Benson","Whitehouse","Barry","Hope","Lord","North","Storey","Connor","Potts","Bevan","Hargreaves","Mclean","Mistry","Bruce","Howells","Hyde","Parkes","Wyatt","Fry","Lees","O'donnell","Craig","Forster","Mckenzie","Humphries","Mellor","Carey","Ingram","Summers","Leonard"],de:["Müller","Schmidt","Schneider","Fischer","Weber","Meyer","Wagner","Becker","Schulz","Hoffmann","Schäfer","Koch","Bauer","Richter","Klein","Wolf","Schröder","Neumann","Schwarz","Zimmermann","Braun","Krüger","Hofmann","Hartmann","Lange","Schmitt","Werner","Schmitz","Krause","Meier","Lehmann","Schmid","Schulze","Maier","Köhler","Herrmann","König","Walter","Mayer","Huber","Kaiser","Fuchs","Peters","Lang","Scholz","Möller","Weiß","Jung","Hahn","Schubert","Vogel","Friedrich","Keller","Günther","Frank","Berger","Winkler","Roth","Beck","Lorenz","Baumann","Franke","Albrecht","Schuster","Simon","Ludwig","Böhm","Winter","Kraus","Martin","Schumacher","Krämer","Vogt","Stein","Jäger","Otto","Sommer","Groß","Seidel","Heinrich","Brandt","Haas","Schreiber","Graf","Schulte","Dietrich","Ziegler","Kuhn","Kühn","Pohl","Engel","Horn","Busch","Bergmann","Thomas","Voigt","Sauer","Arnold","Wolff","Pfeiffer"],jp:["Sato","Suzuki","Takahashi","Tanaka","Watanabe","Ito","Yamamoto","Nakamura","Kobayashi","Kato","Yoshida","Yamada","Sasaki","Yamaguchi","Saito","Matsumoto","Inoue","Kimura","Hayashi","Shimizu","Yamazaki","Mori","Abe","Ikeda","Hashimoto","Yamashita","Ishikawa","Nakajima","Maeda","Fujita","Ogawa","Goto","Okada","Hasegawa","Murakami","Kondo","Ishii","Saito","Sakamoto","Endo","Aoki","Fujii","Nishimura","Fukuda","Ota","Miura","Fujiwara","Okamoto","Matsuda","Nakagawa","Nakano","Harada","Ono","Tamura","Takeuchi","Kaneko","Wada","Nakayama","Ishida","Ueda","Morita","Hara","Shibata","Sakai","Kudo","Yokoyama","Miyazaki","Miyamoto","Uchida","Takagi","Ando","Taniguchi","Ohno","Maruyama","Imai","Takada","Fujimoto","Takeda","Murata","Ueno","Sugiyama","Masuda","Sugawara","Hirano","Kojima","Otsuka","Chiba","Kubo","Matsui","Iwasaki","Sakurai","Kinoshita","Noguchi","Matsuo","Nomura","Kikuchi","Sano","Onishi","Sugimoto","Arai"],es:["Garcia","Fernandez","Lopez","Martinez","Gonzalez","Rodriguez","Sanchez","Perez","Martin","Gomez","Ruiz","Diaz","Hernandez","Alvarez","Jimenez","Moreno","Munoz","Alonso","Romero","Navarro","Gutierrez","Torres","Dominguez","Gil","Vazquez","Blanco","Serrano","Ramos","Castro","Suarez","Sanz","Rubio","Ortega","Molina","Delgado","Ortiz","Morales","Ramirez","Marin","Iglesias","Santos","Castillo","Garrido","Calvo","Pena","Cruz","Cano","Nunez","Prieto","Diez","Lozano","Vidal","Pascual","Ferrer","Medina","Vega","Leon","Herrero","Vicente","Mendez","Guerrero","Fuentes","Campos","Nieto","Cortes","Caballero","Ibanez","Lorenzo","Pastor","Gimenez","Saez","Soler","Marquez","Carrasco","Herrera","Montero","Arias","Crespo","Flores","Andres","Aguilar","Hidalgo","Cabrera","Mora","Duran","Velasco","Rey","Pardo","Roman","Vila","Bravo","Merino","Moya","Soto","Izquierdo","Reyes","Redondo","Marcos","Carmona","Menendez"],fr:["Martin","Bernard","Thomas","Petit","Robert","Richard","Durand","Dubois","Moreau","Laurent","Simon","Michel","Lefèvre","Leroy","Roux","David","Bertrand","Morel","Fournier","Girard","Bonnet","Dupont","Lambert","Fontaine","Rousseau","Vincent","Müller","Lefèvre","Faure","André","Mercier","Blanc","Guérin","Boyer","Garnier","Chevalier","François","Legrand","Gauthier","Garcia","Perrin","Robin","Clément","Morin","Nicolas","Henry","Roussel","Matthieu","Gautier","Masson","Marchand","Duval","Denis","Dumont","Marie","Lemaire","Noël","Meyer","Dufour","Meunier","Brun","Blanchard","Giraud","Joly","Rivière","Lucas","Brunet","Gaillard","Barbier","Arnaud","Martínez","Gérard","Roche","Renard","Schmitt","Roy","Leroux","Colin","Vidal","Caron","Picard","Roger","Fabre","Aubert","Lemoine","Renaud","Dumas","Lacroix","Olivier","Philippe","Bourgeois","Pierre","Benoît","Rey","Leclerc","Payet","Rolland","Leclercq","Guillaume","Lecomte","López","Jean","Dupuy","Guillot","Hubert","Berger","Carpentier","Sánchez","Dupuis","Moulin","Louis","Deschamps","Huet","Vasseur","Perez","Boucher","Fleury","Royer","Klein","Jacquet","Adam","Paris","Poirier","Marty","Aubry","Guyot","Carré","Charles","Renault","Charpentier","Ménard","Maillard","Baron","Bertin","Bailly","Hervé","Schneider","Fernández","Le GallGall","Collet","Léger","Bouvier","Julien","Prévost","Millet","Perrot","Daniel","Le RouxRoux","Cousin","Germain","Breton","Besson","Langlois","Rémi","Le GoffGoff","Pelletier","Lévêque","Perrier","Leblanc","Barré","Lebrun","Marchal","Weber","Mallet","Hamon","Boulanger","Jacob","Monnier","Michaud","Rodríguez","Guichard","Gillet","Étienne","Grondin","Poulain","Tessier","Chevallier","Collin","Chauvin","Da SilvaSilva","Bouchet","Gay","Lemaître","Bénard","Maréchal","Humbert","Reynaud","Antoine","Hoarau","Perret","Barthélemy","Cordier","Pichon","Lejeune","Gilbert","Lamy","Delaunay","Pasquier","Carlier","LaporteLaporte"]},countries:[{name:"Afghanistan",abbreviation:"AF"},{name:"Åland Islands",abbreviation:"AX"},{name:"Albania",abbreviation:"AL"},{name:"Algeria",abbreviation:"DZ"},{name:"American Samoa",abbreviation:"AS"},{name:"Andorra",abbreviation:"AD"},{name:"Angola",abbreviation:"AO"},{name:"Anguilla",abbreviation:"AI"},{name:"Antarctica",abbreviation:"AQ"},{name:"Antigua & Barbuda",abbreviation:"AG"},{name:"Argentina",abbreviation:"AR"},{name:"Armenia",abbreviation:"AM"},{name:"Aruba",abbreviation:"AW"},{name:"Ascension Island",abbreviation:"AC"},{name:"Australia",abbreviation:"AU"},{name:"Austria",abbreviation:"AT"},{name:"Azerbaijan",abbreviation:"AZ"},{name:"Bahamas",abbreviation:"BS"},{name:"Bahrain",abbreviation:"BH"},{name:"Bangladesh",abbreviation:"BD"},{name:"Barbados",abbreviation:"BB"},{name:"Belarus",abbreviation:"BY"},{name:"Belgium",abbreviation:"BE"},{name:"Belize",abbreviation:"BZ"},{name:"Benin",abbreviation:"BJ"},{name:"Bermuda",abbreviation:"BM"},{name:"Bhutan",abbreviation:"BT"},{name:"Bolivia",abbreviation:"BO"},{name:"Bosnia & Herzegovina",abbreviation:"BA"},{name:"Botswana",abbreviation:"BW"},{name:"Brazil",abbreviation:"BR"},{name:"British Indian Ocean Territory",abbreviation:"IO"},{name:"British Virgin Islands",abbreviation:"VG"},{name:"Brunei",abbreviation:"BN"},{name:"Bulgaria",abbreviation:"BG"},{name:"Burkina Faso",abbreviation:"BF"},{name:"Burundi",abbreviation:"BI"},{name:"Cambodia",abbreviation:"KH"},{name:"Cameroon",abbreviation:"CM"},{name:"Canada",abbreviation:"CA"},{name:"Canary Islands",abbreviation:"IC"},{name:"Cape Verde",abbreviation:"CV"},{name:"Caribbean Netherlands",abbreviation:"BQ"},{name:"Cayman Islands",abbreviation:"KY"},{name:"Central African Republic",abbreviation:"CF"},{name:"Ceuta & Melilla",abbreviation:"EA"},{name:"Chad",abbreviation:"TD"},{name:"Chile",abbreviation:"CL"},{name:"China",abbreviation:"CN"},{name:"Christmas Island",abbreviation:"CX"},{name:"Cocos (Keeling) Islands",abbreviation:"CC"},{name:"Colombia",abbreviation:"CO"},{name:"Comoros",abbreviation:"KM"},{name:"Congo - Brazzaville",abbreviation:"CG"},{name:"Congo - Kinshasa",abbreviation:"CD"},{name:"Cook Islands",abbreviation:"CK"},{name:"Costa Rica",abbreviation:"CR"},{name:"Côte d'Ivoire",abbreviation:"CI"},{name:"Croatia",abbreviation:"HR"},{name:"Cuba",abbreviation:"CU"},{name:"Curaçao",abbreviation:"CW"},{name:"Cyprus",abbreviation:"CY"},{name:"Czech Republic",abbreviation:"CZ"},{name:"Denmark",abbreviation:"DK"},{name:"Diego Garcia",abbreviation:"DG"},{name:"Djibouti",abbreviation:"DJ"},{name:"Dominica",abbreviation:"DM"},{name:"Dominican Republic",abbreviation:"DO"},{name:"Ecuador",abbreviation:"EC"},{name:"Egypt",abbreviation:"EG"},{name:"El Salvador",abbreviation:"SV"},{name:"Equatorial Guinea",abbreviation:"GQ"},{name:"Eritrea",abbreviation:"ER"},{name:"Estonia",abbreviation:"EE"},{name:"Ethiopia",abbreviation:"ET"},{name:"Falkland Islands",abbreviation:"FK"},{name:"Faroe Islands",abbreviation:"FO"},{name:"Fiji",abbreviation:"FJ"},{name:"Finland",abbreviation:"FI"},{name:"France",abbreviation:"FR"},{name:"French Guiana",abbreviation:"GF"},{name:"French Polynesia",abbreviation:"PF"},{name:"French Southern Territories",abbreviation:"TF"},{name:"Gabon",abbreviation:"GA"},{name:"Gambia",abbreviation:"GM"},{name:"Georgia",abbreviation:"GE"},{name:"Germany",abbreviation:"DE"},{name:"Ghana",abbreviation:"GH"},{name:"Gibraltar",abbreviation:"GI"},{name:"Greece",abbreviation:"GR"},{name:"Greenland",abbreviation:"GL"},{name:"Grenada",abbreviation:"GD"},{name:"Guadeloupe",abbreviation:"GP"},{name:"Guam",abbreviation:"GU"},{name:"Guatemala",abbreviation:"GT"},{name:"Guernsey",abbreviation:"GG"},{name:"Guinea",abbreviation:"GN"},{name:"Guinea-Bissau",abbreviation:"GW"},{name:"Guyana",abbreviation:"GY"},{name:"Haiti",abbreviation:"HT"},{name:"Honduras",abbreviation:"HN"},{name:"Hong Kong SAR China",abbreviation:"HK"},{name:"Hungary",abbreviation:"HU"},{name:"Iceland",abbreviation:"IS"},{name:"India",abbreviation:"IN"},{name:"Indonesia",abbreviation:"ID"},{name:"Iran",abbreviation:"IR"},{name:"Iraq",abbreviation:"IQ"},{name:"Ireland",abbreviation:"IE"},{name:"Isle of Man",abbreviation:"IM"},{name:"Israel",abbreviation:"IL"},{name:"Italy",abbreviation:"IT"},{name:"Jamaica",abbreviation:"JM"},{name:"Japan",abbreviation:"JP"},{name:"Jersey",abbreviation:"JE"},{name:"Jordan",abbreviation:"JO"},{name:"Kazakhstan",abbreviation:"KZ"},{name:"Kenya",abbreviation:"KE"},{name:"Kiribati",abbreviation:"KI"},{name:"Kosovo",abbreviation:"XK"},{name:"Kuwait",abbreviation:"KW"},{name:"Kyrgyzstan",abbreviation:"KG"},{name:"Laos",abbreviation:"LA"},{name:"Latvia",abbreviation:"LV"},{name:"Lebanon",abbreviation:"LB"},{name:"Lesotho",abbreviation:"LS"},{name:"Liberia",abbreviation:"LR"},{name:"Libya",abbreviation:"LY"},{name:"Liechtenstein",abbreviation:"LI"},{name:"Lithuania",abbreviation:"LT"},{name:"Luxembourg",abbreviation:"LU"},{name:"Macau SAR China",abbreviation:"MO"},{name:"Macedonia",abbreviation:"MK"},{name:"Madagascar",abbreviation:"MG"},{name:"Malawi",abbreviation:"MW"},{name:"Malaysia",abbreviation:"MY"},{name:"Maldives",abbreviation:"MV"},{name:"Mali",abbreviation:"ML"},{name:"Malta",abbreviation:"MT"},{name:"Marshall Islands",abbreviation:"MH"},{name:"Martinique",abbreviation:"MQ"},{name:"Mauritania",abbreviation:"MR"},{name:"Mauritius",abbreviation:"MU"},{name:"Mayotte",abbreviation:"YT"},{name:"Mexico",abbreviation:"MX"},{name:"Micronesia",abbreviation:"FM"},{name:"Moldova",abbreviation:"MD"},{name:"Monaco",abbreviation:"MC"},{name:"Mongolia",abbreviation:"MN"},{name:"Montenegro",abbreviation:"ME"},{name:"Montserrat",abbreviation:"MS"},{name:"Morocco",abbreviation:"MA"},{name:"Mozambique",abbreviation:"MZ"},{name:"Myanmar (Burma)",abbreviation:"MM"},{name:"Namibia",abbreviation:"NA"},{name:"Nauru",abbreviation:"NR"},{name:"Nepal",abbreviation:"NP"},{name:"Netherlands",abbreviation:"NL"},{name:"New Caledonia",abbreviation:"NC"},{name:"New Zealand",abbreviation:"NZ"},{name:"Nicaragua",abbreviation:"NI"},{name:"Niger",abbreviation:"NE"},{name:"Nigeria",abbreviation:"NG"},{name:"Niue",abbreviation:"NU"},{name:"Norfolk Island",abbreviation:"NF"},{name:"North Korea",abbreviation:"KP"},{name:"Northern Mariana Islands",abbreviation:"MP"},{name:"Norway",abbreviation:"NO"},{name:"Oman",abbreviation:"OM"},{name:"Pakistan",abbreviation:"PK"},{name:"Palau",abbreviation:"PW"},{name:"Palestinian Territories",abbreviation:"PS"},{name:"Panama",abbreviation:"PA"},{name:"Papua New Guinea",abbreviation:"PG"},{name:"Paraguay",abbreviation:"PY"},{name:"Peru",abbreviation:"PE"},{name:"Philippines",abbreviation:"PH"},{name:"Pitcairn Islands",abbreviation:"PN"},{name:"Poland",abbreviation:"PL"},{name:"Portugal",abbreviation:"PT"},{name:"Puerto Rico",abbreviation:"PR"},{name:"Qatar",abbreviation:"QA"},{name:"Réunion",abbreviation:"RE"},{name:"Romania",abbreviation:"RO"},{name:"Russia",abbreviation:"RU"},{name:"Rwanda",abbreviation:"RW"},{name:"Samoa",abbreviation:"WS"},{name:"San Marino",abbreviation:"SM"},{name:"São Tomé and Príncipe",abbreviation:"ST"},{name:"Saudi Arabia",abbreviation:"SA"},{name:"Senegal",abbreviation:"SN"},{name:"Serbia",abbreviation:"RS"},{name:"Seychelles",abbreviation:"SC"},{name:"Sierra Leone",abbreviation:"SL"},{name:"Singapore",abbreviation:"SG"},{name:"Sint Maarten",abbreviation:"SX"},{name:"Slovakia",abbreviation:"SK"},{name:"Slovenia",abbreviation:"SI"},{name:"Solomon Islands",abbreviation:"SB"},{name:"Somalia",abbreviation:"SO"},{name:"South Africa",abbreviation:"ZA"},{name:"South Georgia & South Sandwich Islands",abbreviation:"GS"},{name:"South Korea",abbreviation:"KR"},{name:"South Sudan",abbreviation:"SS"},{name:"Spain",abbreviation:"ES"},{name:"Sri Lanka",abbreviation:"LK"},{name:"St. Barthélemy",abbreviation:"BL"},{name:"St. Helena",abbreviation:"SH"},{name:"St. Kitts & Nevis",abbreviation:"KN"},{name:"St. Lucia",abbreviation:"LC"},{name:"St. Martin",abbreviation:"MF"},{name:"St. Pierre & Miquelon",abbreviation:"PM"},{name:"St. Vincent & Grenadines",abbreviation:"VC"},{name:"Sudan",abbreviation:"SD"},{name:"Suriname",abbreviation:"SR"},{name:"Svalbard & Jan Mayen",abbreviation:"SJ"},{name:"Swaziland",abbreviation:"SZ"},{name:"Sweden",abbreviation:"SE"},{name:"Switzerland",abbreviation:"CH"},{name:"Syria",abbreviation:"SY"},{name:"Taiwan",abbreviation:"TW"},{name:"Tajikistan",abbreviation:"TJ"},{name:"Tanzania",abbreviation:"TZ"},{name:"Thailand",abbreviation:"TH"},{name:"Timor-Leste",abbreviation:"TL"},{name:"Togo",abbreviation:"TG"},{name:"Tokelau",abbreviation:"TK"},{name:"Tonga",abbreviation:"TO"},{name:"Trinidad & Tobago",abbreviation:"TT"},{name:"Tristan da Cunha",abbreviation:"TA"},{name:"Tunisia",abbreviation:"TN"},{name:"Turkey",abbreviation:"TR"},{name:"Turkmenistan",abbreviation:"TM"},{name:"Turks & Caicos Islands",abbreviation:"TC"},{name:"Tuvalu",abbreviation:"TV"},{name:"U.S. Outlying Islands",abbreviation:"UM"},{name:"U.S. Virgin Islands",abbreviation:"VI"},{name:"Uganda",abbreviation:"UG"},{name:"Ukraine",abbreviation:"UA"},{name:"United Arab Emirates",abbreviation:"AE"},{name:"United Kingdom",abbreviation:"GB"},{name:"United States",abbreviation:"US"},{name:"Uruguay",abbreviation:"UY"},{name:"Uzbekistan",abbreviation:"UZ"},{name:"Vanuatu",abbreviation:"VU"},{name:"Vatican City",abbreviation:"VA"},{name:"Venezuela",abbreviation:"VE"},{name:"Vietnam",abbreviation:"VN"},{name:"Wallis & Futuna",abbreviation:"WF"},{name:"Western Sahara",abbreviation:"EH"},{name:"Yemen",abbreviation:"YE"},{name:"Zambia",abbreviation:"ZM"},{name:"Zimbabwe",abbreviation:"ZW"}],counties:{uk:[{name:"Bath and North East Somerset"},{name:"Aberdeenshire"},{name:"Anglesey"},{name:"Angus"},{name:"Bedford"},{name:"Blackburn with Darwen"},{name:"Blackpool"},{name:"Bournemouth"},{name:"Bracknell Forest"},{name:"Brighton & Hove"},{name:"Bristol"},{name:"Buckinghamshire"},{name:"Cambridgeshire"},{name:"Carmarthenshire"},{name:"Central Bedfordshire"},{name:"Ceredigion"},{name:"Cheshire East"},{name:"Cheshire West and Chester"},{name:"Clackmannanshire"},{name:"Conwy"},{name:"Cornwall"},{name:"County Antrim"},{name:"County Armagh"},{name:"County Down"},{name:"County Durham"},{name:"County Fermanagh"},{name:"County Londonderry"},{name:"County Tyrone"},{name:"Cumbria"},{name:"Darlington"},{name:"Denbighshire"},{name:"Derby"},{name:"Derbyshire"},{name:"Devon"},{name:"Dorset"},{name:"Dumfries and Galloway"},{name:"Dundee"},{name:"East Lothian"},{name:"East Riding of Yorkshire"},{name:"East Sussex"},{name:"Edinburgh?"},{name:"Essex"},{name:"Falkirk"},{name:"Fife"},{name:"Flintshire"},{name:"Gloucestershire"},{name:"Greater London"},{name:"Greater Manchester"},{name:"Gwent"},{name:"Gwynedd"},{name:"Halton"},{name:"Hampshire"},{name:"Hartlepool"},{name:"Herefordshire"},{name:"Hertfordshire"},{name:"Highlands"},{name:"Hull"},{name:"Isle of Wight"},{name:"Isles of Scilly"},{name:"Kent"},{name:"Lancashire"},{name:"Leicester"},{name:"Leicestershire"},{name:"Lincolnshire"},{name:"Lothian"},{name:"Luton"},{name:"Medway"},{name:"Merseyside"},{name:"Mid Glamorgan"},{name:"Middlesbrough"},{name:"Milton Keynes"},{name:"Monmouthshire"},{name:"Moray"},{name:"Norfolk"},{name:"North East Lincolnshire"},{name:"North Lincolnshire"},{name:"North Somerset"},{name:"North Yorkshire"},{name:"Northamptonshire"},{name:"Northumberland"},{name:"Nottingham"},{name:"Nottinghamshire"},{name:"Oxfordshire"},{name:"Pembrokeshire"},{name:"Perth and Kinross"},{name:"Peterborough"},{name:"Plymouth"},{name:"Poole"},{name:"Portsmouth"},{name:"Powys"},{name:"Reading"},{name:"Redcar and Cleveland"},{name:"Rutland"},{name:"Scottish Borders"},{name:"Shropshire"},{name:"Slough"},{name:"Somerset"},{name:"South Glamorgan"},{name:"South Gloucestershire"},{name:"South Yorkshire"},{name:"Southampton"},{name:"Southend-on-Sea"},{name:"Staffordshire"},{name:"Stirlingshire"},{name:"Stockton-on-Tees"},{name:"Stoke-on-Trent"},{name:"Strathclyde"},{name:"Suffolk"},{name:"Surrey"},{name:"Swindon"},{name:"Telford and Wrekin"},{name:"Thurrock"},{name:"Torbay"},{name:"Tyne and Wear"},{name:"Warrington"},{name:"Warwickshire"},{name:"West Berkshire"},{name:"West Glamorgan"},{name:"West Lothian"},{name:"West Midlands"},{name:"West Sussex"},{name:"West Yorkshire"},{name:"Western Isles"},{name:"Wiltshire"},{name:"Windsor and Maidenhead"},{name:"Wokingham"},{name:"Worcestershire"},{name:"Wrexham"},{name:"York"}]},provinces:{ca:[{name:"Alberta",abbreviation:"AB"},{name:"British Columbia",abbreviation:"BC"},{name:"Manitoba",abbreviation:"MB"},{name:"New Brunswick",abbreviation:"NB"},{name:"Newfoundland and Labrador",abbreviation:"NL"},{name:"Nova Scotia",abbreviation:"NS"},{name:"Ontario",abbreviation:"ON"},{name:"Prince Edward Island",abbreviation:"PE"},{name:"Quebec",abbreviation:"QC"},{name:"Saskatchewan",abbreviation:"SK"},{name:"Northwest Territories",abbreviation:"NT"},{name:"Nunavut",abbreviation:"NU"},{name:"Yukon",abbreviation:"YT"}],it:[{name:"Agrigento",abbreviation:"AG",code:84},{name:"Alessandria",abbreviation:"AL",code:6},{name:"Ancona",abbreviation:"AN",code:42},{name:"Aosta",abbreviation:"AO",code:7},{name:"L'Aquila",abbreviation:"AQ",code:66},{name:"Arezzo",abbreviation:"AR",code:51},{name:"Ascoli-Piceno",abbreviation:"AP",code:44},{name:"Asti",abbreviation:"AT",code:5},{name:"Avellino",abbreviation:"AV",code:64},{name:"Bari",abbreviation:"BA",code:72},{name:"Barletta-Andria-Trani",abbreviation:"BT",code:72},{name:"Belluno",abbreviation:"BL",code:25},{name:"Benevento",abbreviation:"BN",code:62},{name:"Bergamo",abbreviation:"BG",code:16},{name:"Biella",abbreviation:"BI",code:96},{name:"Bologna",abbreviation:"BO",code:37},{name:"Bolzano",abbreviation:"BZ",code:21},{name:"Brescia",abbreviation:"BS",code:17},{name:"Brindisi",abbreviation:"BR",code:74},{name:"Cagliari",abbreviation:"CA",code:92},{name:"Caltanissetta",abbreviation:"CL",code:85},{name:"Campobasso",abbreviation:"CB",code:70},{name:"Carbonia Iglesias",abbreviation:"CI",code:70},{name:"Caserta",abbreviation:"CE",code:61},{name:"Catania",abbreviation:"CT",code:87},{name:"Catanzaro",abbreviation:"CZ",code:79},{name:"Chieti",abbreviation:"CH",code:69},{name:"Como",abbreviation:"CO",code:13},{name:"Cosenza",abbreviation:"CS",code:78},{name:"Cremona",abbreviation:"CR",code:19},{name:"Crotone",abbreviation:"KR",code:101},{name:"Cuneo",abbreviation:"CN",code:4},{name:"Enna",abbreviation:"EN",code:86},{name:"Fermo",abbreviation:"FM",code:86},{name:"Ferrara",abbreviation:"FE",code:38},{name:"Firenze",abbreviation:"FI",code:48},{name:"Foggia",abbreviation:"FG",code:71},{name:"Forli-Cesena",abbreviation:"FC",code:71},{name:"Frosinone",abbreviation:"FR",code:60},{name:"Genova",abbreviation:"GE",code:10},{name:"Gorizia",abbreviation:"GO",code:31},{name:"Grosseto",abbreviation:"GR",code:53},{name:"Imperia",abbreviation:"IM",code:8},{name:"Isernia",abbreviation:"IS",code:94},{name:"La-Spezia",abbreviation:"SP",code:66},{name:"Latina",abbreviation:"LT",code:59},{name:"Lecce",abbreviation:"LE",code:75},{name:"Lecco",abbreviation:"LC",code:97},{name:"Livorno",abbreviation:"LI",code:49},{name:"Lodi",abbreviation:"LO",code:98},{name:"Lucca",abbreviation:"LU",code:46},{name:"Macerata",abbreviation:"MC",code:43},{name:"Mantova",abbreviation:"MN",code:20},{name:"Massa-Carrara",abbreviation:"MS",code:45},{name:"Matera",abbreviation:"MT",code:77},{name:"Medio Campidano",abbreviation:"VS",code:77},{name:"Messina",abbreviation:"ME",code:83},{name:"Milano",abbreviation:"MI",code:15},{name:"Modena",abbreviation:"MO",code:36},{name:"Monza-Brianza",abbreviation:"MB",code:36},{name:"Napoli",abbreviation:"NA",code:63},{name:"Novara",abbreviation:"NO",code:3},{name:"Nuoro",abbreviation:"NU",code:91},{name:"Ogliastra",abbreviation:"OG",code:91},{name:"Olbia Tempio",abbreviation:"OT",code:91},{name:"Oristano",abbreviation:"OR",code:95},{name:"Padova",abbreviation:"PD",code:28},{name:"Palermo",abbreviation:"PA",code:82},{name:"Parma",abbreviation:"PR",code:34},{name:"Pavia",abbreviation:"PV",code:18},{name:"Perugia",abbreviation:"PG",code:54},{name:"Pesaro-Urbino",abbreviation:"PU",code:41},{name:"Pescara",abbreviation:"PE",code:68},{name:"Piacenza",abbreviation:"PC",code:33},{name:"Pisa",abbreviation:"PI",code:50},{name:"Pistoia",abbreviation:"PT",code:47},{name:"Pordenone",abbreviation:"PN",code:93},{name:"Potenza",abbreviation:"PZ",code:76},{name:"Prato",abbreviation:"PO",code:100},{name:"Ragusa",abbreviation:"RG",code:88},{name:"Ravenna",abbreviation:"RA",code:39},{name:"Reggio-Calabria",abbreviation:"RC",code:35},{name:"Reggio-Emilia",abbreviation:"RE",code:35},{name:"Rieti",abbreviation:"RI",code:57},{name:"Rimini",abbreviation:"RN",code:99},{name:"Roma",abbreviation:"Roma",code:58},{name:"Rovigo",abbreviation:"RO",code:29},{name:"Salerno",abbreviation:"SA",code:65},{name:"Sassari",abbreviation:"SS",code:90},{name:"Savona",abbreviation:"SV",code:9},{name:"Siena",abbreviation:"SI",code:52},{name:"Siracusa",abbreviation:"SR",code:89},{name:"Sondrio",abbreviation:"SO",code:14},{name:"Taranto",abbreviation:"TA",code:73},{name:"Teramo",abbreviation:"TE",code:67},{name:"Terni",abbreviation:"TR",code:55},{name:"Torino",abbreviation:"TO",code:1},{name:"Trapani",abbreviation:"TP",code:81},{name:"Trento",abbreviation:"TN",code:22},{name:"Treviso",abbreviation:"TV",code:26},{name:"Trieste",abbreviation:"TS",code:32},{name:"Udine",abbreviation:"UD",code:30},{name:"Varese",abbreviation:"VA",code:12},{name:"Venezia",abbreviation:"VE",code:27},{name:"Verbania",abbreviation:"VB",code:27},{name:"Vercelli",abbreviation:"VC",code:2},{name:"Verona",abbreviation:"VR",code:23},{name:"Vibo-Valentia",abbreviation:"VV",code:102},{name:"Vicenza",abbreviation:"VI",code:24},{name:"Viterbo",abbreviation:"VT",code:56}]},nationalities:[{name:"Afghan"},{name:"Albanian"},{name:"Algerian"},{name:"American"},{name:"Andorran"},{name:"Angolan"},{name:"Antiguans"},{name:"Argentinean"},{name:"Armenian"},{name:"Australian"},{name:"Austrian"},{name:"Azerbaijani"},{name:"Bahami"},{name:"Bahraini"},{name:"Bangladeshi"},{name:"Barbadian"},{name:"Barbudans"},{name:"Batswana"},{name:"Belarusian"},{name:"Belgian"},{name:"Belizean"},{name:"Beninese"},{name:"Bhutanese"},{name:"Bolivian"},{name:"Bosnian"},{name:"Brazilian"},{name:"British"},{name:"Bruneian"},{name:"Bulgarian"},{name:"Burkinabe"},{name:"Burmese"},{name:"Burundian"},{name:"Cambodian"},{name:"Cameroonian"},{name:"Canadian"},{name:"Cape Verdean"},{name:"Central African"},{name:"Chadian"},{name:"Chilean"},{name:"Chinese"},{name:"Colombian"},{name:"Comoran"},{name:"Congolese"},{name:"Costa Rican"},{name:"Croatian"},{name:"Cuban"},{name:"Cypriot"},{name:"Czech"},{name:"Danish"},{name:"Djibouti"},{name:"Dominican"},{name:"Dutch"},{name:"East Timorese"},{name:"Ecuadorean"},{name:"Egyptian"},{name:"Emirian"},{name:"Equatorial Guinean"},{name:"Eritrean"},{name:"Estonian"},{name:"Ethiopian"},{name:"Fijian"},{name:"Filipino"},{name:"Finnish"},{name:"French"},{name:"Gabonese"},{name:"Gambian"},{name:"Georgian"},{name:"German"},{name:"Ghanaian"},{name:"Greek"},{name:"Grenadian"},{name:"Guatemalan"},{name:"Guinea-Bissauan"},{name:"Guinean"},{name:"Guyanese"},{name:"Haitian"},{name:"Herzegovinian"},{name:"Honduran"},{name:"Hungarian"},{name:"I-Kiribati"},{name:"Icelander"},{name:"Indian"},{name:"Indonesian"},{name:"Iranian"},{name:"Iraqi"},{name:"Irish"},{name:"Israeli"},{name:"Italian"},{name:"Ivorian"},{name:"Jamaican"},{name:"Japanese"},{name:"Jordanian"},{name:"Kazakhstani"},{name:"Kenyan"},{name:"Kittian and Nevisian"},{name:"Kuwaiti"},{name:"Kyrgyz"},{name:"Laotian"},{name:"Latvian"},{name:"Lebanese"},{name:"Liberian"},{name:"Libyan"},{name:"Liechtensteiner"},{name:"Lithuanian"},{name:"Luxembourger"},{name:"Macedonian"},{name:"Malagasy"},{name:"Malawian"},{name:"Malaysian"},{name:"Maldivan"},{name:"Malian"},{name:"Maltese"},{name:"Marshallese"},{name:"Mauritanian"},{name:"Mauritian"},{name:"Mexican"},{name:"Micronesian"},{name:"Moldovan"},{name:"Monacan"},{name:"Mongolian"},{name:"Moroccan"},{name:"Mosotho"},{name:"Motswana"},{name:"Mozambican"},{name:"Namibian"},{name:"Nauruan"},{name:"Nepalese"},{name:"New Zealander"},{name:"Nicaraguan"},{name:"Nigerian"},{name:"Nigerien"},{name:"North Korean"},{name:"Northern Irish"},{name:"Norwegian"},{name:"Omani"},{name:"Pakistani"},{name:"Palauan"},{name:"Panamanian"},{name:"Papua New Guinean"},{name:"Paraguayan"},{name:"Peruvian"},{name:"Polish"},{name:"Portuguese"},{name:"Qatari"},{name:"Romani"},{name:"Russian"},{name:"Rwandan"},{name:"Saint Lucian"},{name:"Salvadoran"},{name:"Samoan"},{name:"San Marinese"},{name:"Sao Tomean"},{name:"Saudi"},{name:"Scottish"},{name:"Senegalese"},{name:"Serbian"},{name:"Seychellois"},{name:"Sierra Leonean"},{name:"Singaporean"},{name:"Slovakian"},{name:"Slovenian"},{name:"Solomon Islander"},{name:"Somali"},{name:"South African"},{name:"South Korean"},{name:"Spanish"},{name:"Sri Lankan"},{name:"Sudanese"},{name:"Surinamer"},{name:"Swazi"},{name:"Swedish"},{name:"Swiss"},{name:"Syrian"},{name:"Taiwanese"},{name:"Tajik"},{name:"Tanzanian"},{name:"Thai"},{name:"Togolese"},{name:"Tongan"},{name:"Trinidadian or Tobagonian"},{name:"Tunisian"},{name:"Turkish"},{name:"Tuvaluan"},{name:"Ugandan"},{name:"Ukrainian"},{name:"Uruguaya"},{name:"Uzbekistani"},{name:"Venezuela"},{name:"Vietnamese"},{name:"Wels"},{name:"Yemenit"},{name:"Zambia"},{name:"Zimbabwe"}],locale_languages:["aa","ab","ae","af","ak","am","an","ar","as","av","ay","az","ba","be","bg","bh","bi","bm","bn","bo","br","bs","ca","ce","ch","co","cr","cs","cu","cv","cy","da","de","dv","dz","ee","el","en","eo","es","et","eu","fa","ff","fi","fj","fo","fr","fy","ga","gd","gl","gn","gu","gv","ha","he","hi","ho","hr","ht","hu","hy","hz","ia","id","ie","ig","ii","ik","io","is","it","iu","ja","jv","ka","kg","ki","kj","kk","kl","km","kn","ko","kr","ks","ku","kv","kw","ky","la","lb","lg","li","ln","lo","lt","lu","lv","mg","mh","mi","mk","ml","mn","mr","ms","mt","my","na","nb","nd","ne","ng","nl","nn","no","nr","nv","ny","oc","oj","om","or","os","pa","pi","pl","ps","pt","qu","rm","rn","ro","ru","rw","sa","sc","sd","se","sg","si","sk","sl","sm","sn","so","sq","sr","ss","st","su","sv","sw","ta","te","tg","th","ti","tk","tl","tn","to","tr","ts","tt","tw","ty","ug","uk","ur","uz","ve","vi","vo","wa","wo","xh","yi","yo","za","zh","zu"],locale_regions:["agq-CM","asa-TZ","ast-ES","bas-CM","bem-ZM","bez-TZ","brx-IN","cgg-UG","chr-US","dav-KE","dje-NE","dsb-DE","dua-CM","dyo-SN","ebu-KE","ewo-CM","fil-PH","fur-IT","gsw-CH","gsw-FR","gsw-LI","guz-KE","haw-US","hsb-DE","jgo-CM","jmc-TZ","kab-DZ","kam-KE","kde-TZ","kea-CV","khq-ML","kkj-CM","kln-KE","kok-IN","ksb-TZ","ksf-CM","ksh-DE","lag-TZ","lkt-US","luo-KE","luy-KE","mas-KE","mas-TZ","mer-KE","mfe-MU","mgh-MZ","mgo-CM","mua-CM","naq-NA","nmg-CM","nnh-CM","nus-SD","nyn-UG","rof-TZ","rwk-TZ","sah-RU","saq-KE","sbp-TZ","seh-MZ","ses-ML","shi-Latn","shi-Latn-MA","shi-Tfng","shi-Tfng-MA","smn-FI","teo-KE","teo-UG","twq-NE","tzm-Latn","tzm-Latn-MA","vai-Latn","vai-Latn-LR","vai-Vaii","vai-Vaii-LR","vun-TZ","wae-CH","xog-UG","yav-CM","zgh-MA","af-NA","af-ZA","ak-GH","am-ET","ar-001","ar-AE","ar-BH","ar-DJ","ar-DZ","ar-EG","ar-EH","ar-ER","ar-IL","ar-IQ","ar-JO","ar-KM","ar-KW","ar-LB","ar-LY","ar-MA","ar-MR","ar-OM","ar-PS","ar-QA","ar-SA","ar-SD","ar-SO","ar-SS","ar-SY","ar-TD","ar-TN","ar-YE","as-IN","az-Cyrl","az-Cyrl-AZ","az-Latn","az-Latn-AZ","be-BY","bg-BG","bm-Latn","bm-Latn-ML","bn-BD","bn-IN","bo-CN","bo-IN","br-FR","bs-Cyrl","bs-Cyrl-BA","bs-Latn","bs-Latn-BA","ca-AD","ca-ES","ca-ES-VALENCIA","ca-FR","ca-IT","cs-CZ","cy-GB","da-DK","da-GL","de-AT","de-BE","de-CH","de-DE","de-LI","de-LU","dz-BT","ee-GH","ee-TG","el-CY","el-GR","en-001","en-150","en-AG","en-AI","en-AS","en-AU","en-BB","en-BE","en-BM","en-BS","en-BW","en-BZ","en-CA","en-CC","en-CK","en-CM","en-CX","en-DG","en-DM","en-ER","en-FJ","en-FK","en-FM","en-GB","en-GD","en-GG","en-GH","en-GI","en-GM","en-GU","en-GY","en-HK","en-IE","en-IM","en-IN","en-IO","en-JE","en-JM","en-KE","en-KI","en-KN","en-KY","en-LC","en-LR","en-LS","en-MG","en-MH","en-MO","en-MP","en-MS","en-MT","en-MU","en-MW","en-MY","en-NA","en-NF","en-NG","en-NR","en-NU","en-NZ","en-PG","en-PH","en-PK","en-PN","en-PR","en-PW","en-RW","en-SB","en-SC","en-SD","en-SG","en-SH","en-SL","en-SS","en-SX","en-SZ","en-TC","en-TK","en-TO","en-TT","en-TV","en-TZ","en-UG","en-UM","en-US","en-US-POSIX","en-VC","en-VG","en-VI","en-VU","en-WS","en-ZA","en-ZM","en-ZW","eo-001","es-419","es-AR","es-BO","es-CL","es-CO","es-CR","es-CU","es-DO","es-EA","es-EC","es-ES","es-GQ","es-GT","es-HN","es-IC","es-MX","es-NI","es-PA","es-PE","es-PH","es-PR","es-PY","es-SV","es-US","es-UY","es-VE","et-EE","eu-ES","fa-AF","fa-IR","ff-CM","ff-GN","ff-MR","ff-SN","fi-FI","fo-FO","fr-BE","fr-BF","fr-BI","fr-BJ","fr-BL","fr-CA","fr-CD","fr-CF","fr-CG","fr-CH","fr-CI","fr-CM","fr-DJ","fr-DZ","fr-FR","fr-GA","fr-GF","fr-GN","fr-GP","fr-GQ","fr-HT","fr-KM","fr-LU","fr-MA","fr-MC","fr-MF","fr-MG","fr-ML","fr-MQ","fr-MR","fr-MU","fr-NC","fr-NE","fr-PF","fr-PM","fr-RE","fr-RW","fr-SC","fr-SN","fr-SY","fr-TD","fr-TG","fr-TN","fr-VU","fr-WF","fr-YT","fy-NL","ga-IE","gd-GB","gl-ES","gu-IN","gv-IM","ha-Latn","ha-Latn-GH","ha-Latn-NE","ha-Latn-NG","he-IL","hi-IN","hr-BA","hr-HR","hu-HU","hy-AM","id-ID","ig-NG","ii-CN","is-IS","it-CH","it-IT","it-SM","ja-JP","ka-GE","ki-KE","kk-Cyrl","kk-Cyrl-KZ","kl-GL","km-KH","kn-IN","ko-KP","ko-KR","ks-Arab","ks-Arab-IN","kw-GB","ky-Cyrl","ky-Cyrl-KG","lb-LU","lg-UG","ln-AO","ln-CD","ln-CF","ln-CG","lo-LA","lt-LT","lu-CD","lv-LV","mg-MG","mk-MK","ml-IN","mn-Cyrl","mn-Cyrl-MN","mr-IN","ms-Latn","ms-Latn-BN","ms-Latn-MY","ms-Latn-SG","mt-MT","my-MM","nb-NO","nb-SJ","nd-ZW","ne-IN","ne-NP","nl-AW","nl-BE","nl-BQ","nl-CW","nl-NL","nl-SR","nl-SX","nn-NO","om-ET","om-KE","or-IN","os-GE","os-RU","pa-Arab","pa-Arab-PK","pa-Guru","pa-Guru-IN","pl-PL","ps-AF","pt-AO","pt-BR","pt-CV","pt-GW","pt-MO","pt-MZ","pt-PT","pt-ST","pt-TL","qu-BO","qu-EC","qu-PE","rm-CH","rn-BI","ro-MD","ro-RO","ru-BY","ru-KG","ru-KZ","ru-MD","ru-RU","ru-UA","rw-RW","se-FI","se-NO","se-SE","sg-CF","si-LK","sk-SK","sl-SI","sn-ZW","so-DJ","so-ET","so-KE","so-SO","sq-AL","sq-MK","sq-XK","sr-Cyrl","sr-Cyrl-BA","sr-Cyrl-ME","sr-Cyrl-RS","sr-Cyrl-XK","sr-Latn","sr-Latn-BA","sr-Latn-ME","sr-Latn-RS","sr-Latn-XK","sv-AX","sv-FI","sv-SE","sw-CD","sw-KE","sw-TZ","sw-UG","ta-IN","ta-LK","ta-MY","ta-SG","te-IN","th-TH","ti-ER","ti-ET","to-TO","tr-CY","tr-TR","ug-Arab","ug-Arab-CN","uk-UA","ur-IN","ur-PK","uz-Arab","uz-Arab-AF","uz-Cyrl","uz-Cyrl-UZ","uz-Latn","uz-Latn-UZ","vi-VN","yi-001","yo-BJ","yo-NG","zh-Hans","zh-Hans-CN","zh-Hans-HK","zh-Hans-MO","zh-Hans-SG","zh-Hant","zh-Hant-HK","zh-Hant-MO","zh-Hant-TW","zu-ZA"],us_states_and_dc:[{name:"Alabama",abbreviation:"AL"},{name:"Alaska",abbreviation:"AK"},{name:"Arizona",abbreviation:"AZ"},{name:"Arkansas",abbreviation:"AR"},{name:"California",abbreviation:"CA"},{name:"Colorado",abbreviation:"CO"},{name:"Connecticut",abbreviation:"CT"},{name:"Delaware",abbreviation:"DE"},{name:"District of Columbia",abbreviation:"DC"},{name:"Florida",abbreviation:"FL"},{name:"Georgia",abbreviation:"GA"},{name:"Hawaii",abbreviation:"HI"},{name:"Idaho",abbreviation:"ID"},{name:"Illinois",abbreviation:"IL"},{name:"Indiana",abbreviation:"IN"},{name:"Iowa",abbreviation:"IA"},{name:"Kansas",abbreviation:"KS"},{name:"Kentucky",abbreviation:"KY"},{name:"Louisiana",abbreviation:"LA"},{name:"Maine",abbreviation:"ME"},{name:"Maryland",abbreviation:"MD"},{name:"Massachusetts",abbreviation:"MA"},{name:"Michigan",abbreviation:"MI"},{name:"Minnesota",abbreviation:"MN"},{name:"Mississippi",abbreviation:"MS"},{name:"Missouri",abbreviation:"MO"},{name:"Montana",abbreviation:"MT"},{name:"Nebraska",abbreviation:"NE"},{name:"Nevada",abbreviation:"NV"},{name:"New Hampshire",abbreviation:"NH"},{name:"New Jersey",abbreviation:"NJ"},{name:"New Mexico",abbreviation:"NM"},{name:"New York",abbreviation:"NY"},{name:"North Carolina",abbreviation:"NC"},{name:"North Dakota",abbreviation:"ND"},{name:"Ohio",abbreviation:"OH"},{name:"Oklahoma",abbreviation:"OK"},{name:"Oregon",abbreviation:"OR"},{name:"Pennsylvania",abbreviation:"PA"},{name:"Rhode Island",abbreviation:"RI"},{name:"South Carolina",abbreviation:"SC"},{name:"South Dakota",abbreviation:"SD"},{name:"Tennessee",abbreviation:"TN"},{name:"Texas",abbreviation:"TX"},{name:"Utah",abbreviation:"UT"},{name:"Vermont",abbreviation:"VT"},{name:"Virginia",abbreviation:"VA"},{name:"Washington",abbreviation:"WA"},{name:"West Virginia",abbreviation:"WV"},{name:"Wisconsin",abbreviation:"WI"},{name:"Wyoming",abbreviation:"WY"}],territories:[{name:"American Samoa",abbreviation:"AS"},{name:"Federated States of Micronesia",abbreviation:"FM"},{name:"Guam",abbreviation:"GU"},{name:"Marshall Islands",abbreviation:"MH"},{name:"Northern Mariana Islands",abbreviation:"MP"},{name:"Puerto Rico",abbreviation:"PR"},{name:"Virgin Islands, U.S.",abbreviation:"VI"}],armed_forces:[{name:"Armed Forces Europe",abbreviation:"AE"},{name:"Armed Forces Pacific",abbreviation:"AP"},{name:"Armed Forces the Americas",abbreviation:"AA"}],country_regions:{it:[{name:"Valle d'Aosta",abbreviation:"VDA"},{name:"Piemonte",abbreviation:"PIE"},{name:"Lombardia",abbreviation:"LOM"},{name:"Veneto",abbreviation:"VEN"},{name:"Trentino Alto Adige",abbreviation:"TAA"},{name:"Friuli Venezia Giulia",abbreviation:"FVG"},{name:"Liguria",abbreviation:"LIG"},{name:"Emilia Romagna",abbreviation:"EMR"},{name:"Toscana",abbreviation:"TOS"},{name:"Umbria",abbreviation:"UMB"},{name:"Marche",abbreviation:"MAR"},{name:"Abruzzo",abbreviation:"ABR"},{name:"Lazio",abbreviation:"LAZ"},{name:"Campania",abbreviation:"CAM"},{name:"Puglia",abbreviation:"PUG"},{name:"Basilicata",abbreviation:"BAS"},{name:"Molise",abbreviation:"MOL"},{name:"Calabria",abbreviation:"CAL"},{name:"Sicilia",abbreviation:"SIC"},{name:"Sardegna",abbreviation:"SAR"}]},street_suffixes:{us:[{name:"Avenue",abbreviation:"Ave"},{name:"Boulevard",abbreviation:"Blvd"},{name:"Center",abbreviation:"Ctr"},{name:"Circle",abbreviation:"Cir"},{name:"Court",abbreviation:"Ct"},{name:"Drive",abbreviation:"Dr"},{name:"Extension",abbreviation:"Ext"},{name:"Glen",abbreviation:"Gln"},{name:"Grove",abbreviation:"Grv"},{name:"Heights",abbreviation:"Hts"},{name:"Highway",abbreviation:"Hwy"},{name:"Junction",abbreviation:"Jct"},{name:"Key",abbreviation:"Key"},{name:"Lane",abbreviation:"Ln"},{name:"Loop",abbreviation:"Loop"},{name:"Manor",abbreviation:"Mnr"},{name:"Mill",abbreviation:"Mill"},{name:"Park",abbreviation:"Park"},{name:"Parkway",abbreviation:"Pkwy"},{name:"Pass",abbreviation:"Pass"},{name:"Path",abbreviation:"Path"},{name:"Pike",abbreviation:"Pike"},{name:"Place",abbreviation:"Pl"},{name:"Plaza",abbreviation:"Plz"},{name:"Point",abbreviation:"Pt"},{name:"Ridge",abbreviation:"Rdg"},{name:"River",abbreviation:"Riv"},{name:"Road",abbreviation:"Rd"},{name:"Square",abbreviation:"Sq"},{name:"Street",abbreviation:"St"},{name:"Terrace",abbreviation:"Ter"},{name:"Trail",abbreviation:"Trl"},{name:"Turnpike",abbreviation:"Tpke"},{name:"View",abbreviation:"Vw"},{name:"Way",abbreviation:"Way"}],it:[{name:"Accesso",abbreviation:"Acc."},{name:"Alzaia",abbreviation:"Alz."},{name:"Arco",abbreviation:"Arco"},{name:"Archivolto",abbreviation:"Acv."},{name:"Arena",abbreviation:"Arena"},{name:"Argine",abbreviation:"Argine"},{name:"Bacino",abbreviation:"Bacino"},{name:"Banchi",abbreviation:"Banchi"},{name:"Banchina",abbreviation:"Ban."},{name:"Bastioni",abbreviation:"Bas."},{name:"Belvedere",abbreviation:"Belv."},{name:"Borgata",abbreviation:"B.ta"},{name:"Borgo",abbreviation:"B.go"},{name:"Calata",abbreviation:"Cal."},{name:"Calle",abbreviation:"Calle"},{name:"Campiello",abbreviation:"Cam."},{name:"Campo",abbreviation:"Cam."},{name:"Canale",abbreviation:"Can."},{name:"Carraia",abbreviation:"Carr."},{name:"Cascina",abbreviation:"Cascina"},{name:"Case sparse",abbreviation:"c.s."},{name:"Cavalcavia",abbreviation:"Cv."},{name:"Circonvallazione",abbreviation:"Cv."},{name:"Complanare",abbreviation:"C.re"},{name:"Contrada",abbreviation:"C.da"},{name:"Corso",abbreviation:"C.so"},{name:"Corte",abbreviation:"C.te"},{name:"Cortile",abbreviation:"C.le"},{name:"Diramazione",abbreviation:"Dir."},{name:"Fondaco",abbreviation:"F.co"},{name:"Fondamenta",abbreviation:"F.ta"},{name:"Fondo",abbreviation:"F.do"},{name:"Frazione",abbreviation:"Fr."},{name:"Isola",abbreviation:"Is."},{name:"Largo",abbreviation:"L.go"},{name:"Litoranea",abbreviation:"Lit."},{name:"Lungolago",abbreviation:"L.go lago"},{name:"Lungo Po",abbreviation:"l.go Po"},{name:"Molo",abbreviation:"Molo"},{name:"Mura",abbreviation:"Mura"},{name:"Passaggio privato",abbreviation:"pass. priv."},{name:"Passeggiata",abbreviation:"Pass."},{name:"Piazza",abbreviation:"P.zza"},{name:"Piazzale",abbreviation:"P.le"},{name:"Ponte",abbreviation:"P.te"},{name:"Portico",abbreviation:"P.co"},{name:"Rampa",abbreviation:"Rampa"},{name:"Regione",abbreviation:"Reg."},{name:"Rione",abbreviation:"R.ne"},{name:"Rio",abbreviation:"Rio"},{name:"Ripa",abbreviation:"Ripa"},{name:"Riva",abbreviation:"Riva"},{name:"Rondò",abbreviation:"Rondò"},{name:"Rotonda",abbreviation:"Rot."},{name:"Sagrato",abbreviation:"Sagr."},{name:"Salita",abbreviation:"Sal."},{name:"Scalinata",abbreviation:"Scal."},{name:"Scalone",abbreviation:"Scal."},{name:"Slargo",abbreviation:"Sl."},{name:"Sottoportico",abbreviation:"Sott."},{name:"Strada",abbreviation:"Str."},{name:"Stradale",abbreviation:"Str.le"},{name:"Strettoia",abbreviation:"Strett."},{name:"Traversa",abbreviation:"Trav."},{name:"Via",abbreviation:"V."},{name:"Viale",abbreviation:"V.le"},{name:"Vicinale",abbreviation:"Vic.le"},{name:"Vicolo",abbreviation:"Vic."}],uk:[{name:"Avenue",abbreviation:"Ave"},{name:"Close",abbreviation:"Cl"},{name:"Court",abbreviation:"Ct"},{name:"Crescent",abbreviation:"Cr"},{name:"Drive",abbreviation:"Dr"},{name:"Garden",abbreviation:"Gdn"},{name:"Gardens",abbreviation:"Gdns"},{name:"Green",abbreviation:"Gn"},{name:"Grove",abbreviation:"Gr"},{name:"Lane",abbreviation:"Ln"},{name:"Mount",abbreviation:"Mt"},{name:"Place",abbreviation:"Pl"},{name:"Park",abbreviation:"Pk"},{name:"Ridge",abbreviation:"Rdg"},{name:"Road",abbreviation:"Rd"},{name:"Square",abbreviation:"Sq"},{name:"Street",abbreviation:"St"},{name:"Terrace",abbreviation:"Ter"},{name:"Valley",abbreviation:"Val"}]},months:[{name:"January",short_name:"Jan",numeric:"01",days:31},{name:"February",short_name:"Feb",numeric:"02",days:28},{name:"March",short_name:"Mar",numeric:"03",days:31},{name:"April",short_name:"Apr",numeric:"04",days:30},{name:"May",short_name:"May",numeric:"05",days:31},{name:"June",short_name:"Jun",numeric:"06",days:30},{name:"July",short_name:"Jul",numeric:"07",days:31},{name:"August",short_name:"Aug",numeric:"08",days:31},{name:"September",short_name:"Sep",numeric:"09",days:30},{name:"October",short_name:"Oct",numeric:"10",days:31},{name:"November",short_name:"Nov",numeric:"11",days:30},{name:"December",short_name:"Dec",numeric:"12",days:31}],cc_types:[{name:"American Express",short_name:"amex",prefix:"34",length:15},{name:"Bankcard",short_name:"bankcard",prefix:"5610",length:16},{name:"China UnionPay",short_name:"chinaunion",prefix:"62",length:16},{name:"Diners Club Carte Blanche",short_name:"dccarte",prefix:"300",length:14},{name:"Diners Club enRoute",short_name:"dcenroute",prefix:"2014",length:15},{name:"Diners Club International",short_name:"dcintl",prefix:"36",length:14},{name:"Diners Club United States & Canada",short_name:"dcusc",prefix:"54",length:16},{name:"Discover Card",short_name:"discover",prefix:"6011",length:16},{name:"InstaPayment",short_name:"instapay",prefix:"637",length:16},{name:"JCB",short_name:"jcb",prefix:"3528",length:16},{name:"Laser",short_name:"laser",prefix:"6304",length:16},{name:"Maestro",short_name:"maestro",prefix:"5018",length:16},{name:"Mastercard",short_name:"mc",prefix:"51",length:16},{name:"Solo",short_name:"solo",prefix:"6334",length:16},{name:"Switch",short_name:"switch",prefix:"4903",length:16},{name:"Visa",short_name:"visa",prefix:"4",length:16},{name:"Visa Electron",short_name:"electron",prefix:"4026",length:16}],currency_types:[{code:"AED",name:"United Arab Emirates Dirham"},{code:"AFN",name:"Afghanistan Afghani"},{code:"ALL",name:"Albania Lek"},{code:"AMD",name:"Armenia Dram"},{code:"ANG",name:"Netherlands Antilles Guilder"},{code:"AOA",name:"Angola Kwanza"},{code:"ARS",name:"Argentina Peso"},{code:"AUD",name:"Australia Dollar"},{code:"AWG",name:"Aruba Guilder"},{code:"AZN",name:"Azerbaijan New Manat"},{code:"BAM",name:"Bosnia and Herzegovina Convertible Marka"},{code:"BBD",name:"Barbados Dollar"},{code:"BDT",name:"Bangladesh Taka"},{code:"BGN",name:"Bulgaria Lev"},{code:"BHD",name:"Bahrain Dinar"},{code:"BIF",name:"Burundi Franc"},{code:"BMD",name:"Bermuda Dollar"},{code:"BND",name:"Brunei Darussalam Dollar"},{code:"BOB",name:"Bolivia Boliviano"},{code:"BRL",name:"Brazil Real"},{code:"BSD",name:"Bahamas Dollar"},{code:"BTN",name:"Bhutan Ngultrum"},{code:"BWP",name:"Botswana Pula"},{code:"BYR",name:"Belarus Ruble"},{code:"BZD",name:"Belize Dollar"},{code:"CAD",name:"Canada Dollar"},{code:"CDF",name:"Congo/Kinshasa Franc"},{code:"CHF",name:"Switzerland Franc"},{code:"CLP",name:"Chile Peso"},{code:"CNY",name:"China Yuan Renminbi"},{code:"COP",name:"Colombia Peso"},{code:"CRC",name:"Costa Rica Colon"},{code:"CUC",name:"Cuba Convertible Peso"},{code:"CUP",name:"Cuba Peso"},{code:"CVE",name:"Cape Verde Escudo"},{code:"CZK",name:"Czech Republic Koruna"},{code:"DJF",name:"Djibouti Franc"},{code:"DKK",name:"Denmark Krone"},{code:"DOP",name:"Dominican Republic Peso"},{code:"DZD",name:"Algeria Dinar"},{code:"EGP",name:"Egypt Pound"},{code:"ERN",name:"Eritrea Nakfa"},{code:"ETB",name:"Ethiopia Birr"},{code:"EUR",name:"Euro Member Countries"},{code:"FJD",name:"Fiji Dollar"},{code:"FKP",name:"Falkland Islands (Malvinas) Pound"},{code:"GBP",name:"United Kingdom Pound"},{code:"GEL",name:"Georgia Lari"},{code:"GGP",name:"Guernsey Pound"},{code:"GHS",name:"Ghana Cedi"},{code:"GIP",name:"Gibraltar Pound"},{code:"GMD",name:"Gambia Dalasi"},{code:"GNF",name:"Guinea Franc"},{code:"GTQ",name:"Guatemala Quetzal"},{code:"GYD",name:"Guyana Dollar"},{code:"HKD",name:"Hong Kong Dollar"},{code:"HNL",name:"Honduras Lempira"},{code:"HRK",name:"Croatia Kuna"},{code:"HTG",name:"Haiti Gourde"},{code:"HUF",name:"Hungary Forint"},{code:"IDR",name:"Indonesia Rupiah"},{code:"ILS",name:"Israel Shekel"},{code:"IMP",name:"Isle of Man Pound"},{code:"INR",name:"India Rupee"},{code:"IQD",name:"Iraq Dinar"},{code:"IRR",name:"Iran Rial"},{code:"ISK",name:"Iceland Krona"},{code:"JEP",name:"Jersey Pound"},{code:"JMD",name:"Jamaica Dollar"},{code:"JOD",name:"Jordan Dinar"},{code:"JPY",name:"Japan Yen"},{code:"KES",name:"Kenya Shilling"},{code:"KGS",name:"Kyrgyzstan Som"},{code:"KHR",name:"Cambodia Riel"},{code:"KMF",name:"Comoros Franc"},{code:"KPW",name:"Korea (North) Won"},{code:"KRW",name:"Korea (South) Won"},{code:"KWD",name:"Kuwait Dinar"},{code:"KYD",name:"Cayman Islands Dollar"},{code:"KZT",name:"Kazakhstan Tenge"},{code:"LAK",name:"Laos Kip"},{code:"LBP",name:"Lebanon Pound"},{code:"LKR",name:"Sri Lanka Rupee"},{code:"LRD",name:"Liberia Dollar"},{code:"LSL",name:"Lesotho Loti"},{code:"LTL",name:"Lithuania Litas"},{code:"LYD",name:"Libya Dinar"},{code:"MAD",name:"Morocco Dirham"},{code:"MDL",name:"Moldova Leu"},{code:"MGA",name:"Madagascar Ariary"},{code:"MKD",name:"Macedonia Denar"},{code:"MMK",name:"Myanmar (Burma) Kyat"},{code:"MNT",name:"Mongolia Tughrik"},{code:"MOP",name:"Macau Pataca"},{code:"MRO",name:"Mauritania Ouguiya"},{code:"MUR",name:"Mauritius Rupee"},{code:"MVR",name:"Maldives (Maldive Islands) Rufiyaa"},{code:"MWK",name:"Malawi Kwacha"},{code:"MXN",name:"Mexico Peso"},{code:"MYR",name:"Malaysia Ringgit"},{code:"MZN",name:"Mozambique Metical"},{code:"NAD",name:"Namibia Dollar"},{code:"NGN",name:"Nigeria Naira"},{code:"NIO",name:"Nicaragua Cordoba"},{code:"NOK",name:"Norway Krone"},{code:"NPR",name:"Nepal Rupee"},{code:"NZD",name:"New Zealand Dollar"},{code:"OMR",name:"Oman Rial"},{code:"PAB",name:"Panama Balboa"},{code:"PEN",name:"Peru Nuevo Sol"},{code:"PGK",name:"Papua New Guinea Kina"},{code:"PHP",name:"Philippines Peso"},{code:"PKR",name:"Pakistan Rupee"},{code:"PLN",name:"Poland Zloty"},{code:"PYG",name:"Paraguay Guarani"},{code:"QAR",name:"Qatar Riyal"},{code:"RON",name:"Romania New Leu"},{code:"RSD",name:"Serbia Dinar"},{code:"RUB",name:"Russia Ruble"},{code:"RWF",name:"Rwanda Franc"},{code:"SAR",name:"Saudi Arabia Riyal"},{code:"SBD",name:"Solomon Islands Dollar"},{code:"SCR",name:"Seychelles Rupee"},{code:"SDG",name:"Sudan Pound"},{code:"SEK",name:"Sweden Krona"},{code:"SGD",name:"Singapore Dollar"},{code:"SHP",name:"Saint Helena Pound"},{code:"SLL",name:"Sierra Leone Leone"},{code:"SOS",name:"Somalia Shilling"},{code:"SPL",name:"Seborga Luigino"},{code:"SRD",name:"Suriname Dollar"},{code:"STD",name:"São Tomé and Príncipe Dobra"},{code:"SVC",name:"El Salvador Colon"},{code:"SYP",name:"Syria Pound"},{code:"SZL",name:"Swaziland Lilangeni"},{code:"THB",name:"Thailand Baht"},{code:"TJS",name:"Tajikistan Somoni"},{code:"TMT",name:"Turkmenistan Manat"},{code:"TND",name:"Tunisia Dinar"},{code:"TOP",name:"Tonga Pa'anga"},{code:"TRY",name:"Turkey Lira"},{code:"TTD",name:"Trinidad and Tobago Dollar"},{code:"TVD",name:"Tuvalu Dollar"},{code:"TWD",name:"Taiwan New Dollar"},{code:"TZS",name:"Tanzania Shilling"},{code:"UAH",name:"Ukraine Hryvnia"},{code:"UGX",name:"Uganda Shilling"},{code:"USD",name:"United States Dollar"},{code:"UYU",name:"Uruguay Peso"},{code:"UZS",name:"Uzbekistan Som"},{code:"VEF",name:"Venezuela Bolivar"},{code:"VND",name:"Viet Nam Dong"},{code:"VUV",name:"Vanuatu Vatu"},{code:"WST",name:"Samoa Tala"},{code:"XAF",name:"Communauté Financière Africaine (BEAC) CFA Franc BEAC"},{code:"XCD",name:"East Caribbean Dollar"},{code:"XDR",name:"International Monetary Fund (IMF) Special Drawing Rights"},{code:"XOF",name:"Communauté Financière Africaine (BCEAO) Franc"},{code:"XPF",name:"Comptoirs Français du Pacifique (CFP) Franc"},{code:"YER",name:"Yemen Rial"},{code:"ZAR",name:"South Africa Rand"},{code:"ZMW",name:"Zambia Kwacha"},{code:"ZWD",name:"Zimbabwe Dollar"}],colorNames:["AliceBlue","Black","Navy","DarkBlue","MediumBlue","Blue","DarkGreen","Green","Teal","DarkCyan","DeepSkyBlue","DarkTurquoise","MediumSpringGreen","Lime","SpringGreen","Aqua","Cyan","MidnightBlue","DodgerBlue","LightSeaGreen","ForestGreen","SeaGreen","DarkSlateGray","LimeGreen","MediumSeaGreen","Turquoise","RoyalBlue","SteelBlue","DarkSlateBlue","MediumTurquoise","Indigo","DarkOliveGreen","CadetBlue","CornflowerBlue","RebeccaPurple","MediumAquaMarine","DimGray","SlateBlue","OliveDrab","SlateGray","LightSlateGray","MediumSlateBlue","LawnGreen","Chartreuse","Aquamarine","Maroon","Purple","Olive","Gray","SkyBlue","LightSkyBlue","BlueViolet","DarkRed","DarkMagenta","SaddleBrown","Ivory","White","DarkSeaGreen","LightGreen","MediumPurple","DarkViolet","PaleGreen","DarkOrchid","YellowGreen","Sienna","Brown","DarkGray","LightBlue","GreenYellow","PaleTurquoise","LightSteelBlue","PowderBlue","FireBrick","DarkGoldenRod","MediumOrchid","RosyBrown","DarkKhaki","Silver","MediumVioletRed","IndianRed","Peru","Chocolate","Tan","LightGray","Thistle","Orchid","GoldenRod","PaleVioletRed","Crimson","Gainsboro","Plum","BurlyWood","LightCyan","Lavender","DarkSalmon","Violet","PaleGoldenRod","LightCoral","Khaki","AliceBlue","HoneyDew","Azure","SandyBrown","Wheat","Beige","WhiteSmoke","MintCream","GhostWhite","Salmon","AntiqueWhite","Linen","LightGoldenRodYellow","OldLace","Red","Fuchsia","Magenta","DeepPink","OrangeRed","Tomato","HotPink","Coral","DarkOrange","LightSalmon","Orange","LightPink","Pink","Gold","PeachPuff","NavajoWhite","Moccasin","Bisque","MistyRose","BlanchedAlmond","PapayaWhip","LavenderBlush","SeaShell","Cornsilk","LemonChiffon","FloralWhite","Snow","Yellow","LightYellow"],company:["3Com Corp","3M Company","A.G. Edwards Inc.","Abbott Laboratories","Abercrombie & Fitch Co.","ABM Industries Incorporated","Ace Hardware Corporation","ACT Manufacturing Inc.","Acterna Corp.","Adams Resources & Energy, Inc.","ADC Telecommunications, Inc.","Adelphia Communications Corporation","Administaff, Inc.","Adobe Systems Incorporated","Adolph Coors Company","Advance Auto Parts, Inc.","Advanced Micro Devices, Inc.","AdvancePCS, Inc.","Advantica Restaurant Group, Inc.","The AES Corporation","Aetna Inc.","Affiliated Computer Services, Inc.","AFLAC Incorporated","AGCO Corporation","Agilent Technologies, Inc.","Agway Inc.","Apartment Investment and Management Company","Air Products and Chemicals, Inc.","Airborne, Inc.","Airgas, Inc.","AK Steel Holding Corporation","Alaska Air Group, Inc.","Alberto-Culver Company","Albertson's, Inc.","Alcoa Inc.","Alleghany Corporation","Allegheny Energy, Inc.","Allegheny Technologies Incorporated","Allergan, Inc.","ALLETE, Inc.","Alliant Energy Corporation","Allied Waste Industries, Inc.","Allmerica Financial Corporation","The Allstate Corporation","ALLTEL Corporation","The Alpine Group, Inc.","Amazon.com, Inc.","AMC Entertainment Inc.","American Power Conversion Corporation","Amerada Hess Corporation","AMERCO","Ameren Corporation","America West Holdings Corporation","American Axle & Manufacturing Holdings, Inc.","American Eagle Outfitters, Inc.","American Electric Power Company, Inc.","American Express Company","American Financial Group, Inc.","American Greetings Corporation","American International Group, Inc.","American Standard Companies Inc.","American Water Works Company, Inc.","AmerisourceBergen Corporation","Ames Department Stores, Inc.","Amgen Inc.","Amkor Technology, Inc.","AMR Corporation","AmSouth Bancorp.","Amtran, Inc.","Anadarko Petroleum Corporation","Analog Devices, Inc.","Anheuser-Busch Companies, Inc.","Anixter International Inc.","AnnTaylor Inc.","Anthem, Inc.","AOL Time Warner Inc.","Aon Corporation","Apache Corporation","Apple Computer, Inc.","Applera Corporation","Applied Industrial Technologies, Inc.","Applied Materials, Inc.","Aquila, Inc.","ARAMARK Corporation","Arch Coal, Inc.","Archer Daniels Midland Company","Arkansas Best Corporation","Armstrong Holdings, Inc.","Arrow Electronics, Inc.","ArvinMeritor, Inc.","Ashland Inc.","Astoria Financial Corporation","AT&T Corp.","Atmel Corporation","Atmos Energy Corporation","Audiovox Corporation","Autoliv, Inc.","Automatic Data Processing, Inc.","AutoNation, Inc.","AutoZone, Inc.","Avaya Inc.","Avery Dennison Corporation","Avista Corporation","Avnet, Inc.","Avon Products, Inc.","Baker Hughes Incorporated","Ball Corporation","Bank of America Corporation","The Bank of New York Company, Inc.","Bank One Corporation","Banknorth Group, Inc.","Banta Corporation","Barnes & Noble, Inc.","Bausch & Lomb Incorporated","Baxter International Inc.","BB&T Corporation","The Bear Stearns Companies Inc.","Beazer Homes USA, Inc.","Beckman Coulter, Inc.","Becton, Dickinson and Company","Bed Bath & Beyond Inc.","Belk, Inc.","Bell Microproducts Inc.","BellSouth Corporation","Belo Corp.","Bemis Company, Inc.","Benchmark Electronics, Inc.","Berkshire Hathaway Inc.","Best Buy Co., Inc.","Bethlehem Steel Corporation","Beverly Enterprises, Inc.","Big Lots, Inc.","BJ Services Company","BJ's Wholesale Club, Inc.","The Black & Decker Corporation","Black Hills Corporation","BMC Software, Inc.","The Boeing Company","Boise Cascade Corporation","Borders Group, Inc.","BorgWarner Inc.","Boston Scientific Corporation","Bowater Incorporated","Briggs & Stratton Corporation","Brightpoint, Inc.","Brinker International, Inc.","Bristol-Myers Squibb Company","Broadwing, Inc.","Brown Shoe Company, Inc.","Brown-Forman Corporation","Brunswick Corporation","Budget Group, Inc.","Burlington Coat Factory Warehouse Corporation","Burlington Industries, Inc.","Burlington Northern Santa Fe Corporation","Burlington Resources Inc.","C. H. Robinson Worldwide Inc.","Cablevision Systems Corp","Cabot Corp","Cadence Design Systems, Inc.","Calpine Corp.","Campbell Soup Co.","Capital One Financial Corp.","Cardinal Health Inc.","Caremark Rx Inc.","Carlisle Cos. Inc.","Carpenter Technology Corp.","Casey's General Stores Inc.","Caterpillar Inc.","CBRL Group Inc.","CDI Corp.","CDW Computer Centers Inc.","CellStar Corp.","Cendant Corp","Cenex Harvest States Cooperatives","Centex Corp.","CenturyTel Inc.","Ceridian Corp.","CH2M Hill Cos. Ltd.","Champion Enterprises Inc.","Charles Schwab Corp.","Charming Shoppes Inc.","Charter Communications Inc.","Charter One Financial Inc.","ChevronTexaco Corp.","Chiquita Brands International Inc.","Chubb Corp","Ciena Corp.","Cigna Corp","Cincinnati Financial Corp.","Cinergy Corp.","Cintas Corp.","Circuit City Stores Inc.","Cisco Systems Inc.","Citigroup, Inc","Citizens Communications Co.","CKE Restaurants Inc.","Clear Channel Communications Inc.","The Clorox Co.","CMGI Inc.","CMS Energy Corp.","CNF Inc.","Coca-Cola Co.","Coca-Cola Enterprises Inc.","Colgate-Palmolive Co.","Collins & Aikman Corp.","Comcast Corp.","Comdisco Inc.","Comerica Inc.","Comfort Systems USA Inc.","Commercial Metals Co.","Community Health Systems Inc.","Compass Bancshares Inc","Computer Associates International Inc.","Computer Sciences Corp.","Compuware Corp.","Comverse Technology Inc.","ConAgra Foods Inc.","Concord EFS Inc.","Conectiv, Inc","Conoco Inc","Conseco Inc.","Consolidated Freightways Corp.","Consolidated Edison Inc.","Constellation Brands Inc.","Constellation Emergy Group Inc.","Continental Airlines Inc.","Convergys Corp.","Cooper Cameron Corp.","Cooper Industries Ltd.","Cooper Tire & Rubber Co.","Corn Products International Inc.","Corning Inc.","Costco Wholesale Corp.","Countrywide Credit Industries Inc.","Coventry Health Care Inc.","Cox Communications Inc.","Crane Co.","Crompton Corp.","Crown Cork & Seal Co. Inc.","CSK Auto Corp.","CSX Corp.","Cummins Inc.","CVS Corp.","Cytec Industries Inc.","D&K Healthcare Resources, Inc.","D.R. Horton Inc.","Dana Corporation","Danaher Corporation","Darden Restaurants Inc.","DaVita Inc.","Dean Foods Company","Deere & Company","Del Monte Foods Co","Dell Computer Corporation","Delphi Corp.","Delta Air Lines Inc.","Deluxe Corporation","Devon Energy Corporation","Di Giorgio Corporation","Dial Corporation","Diebold Incorporated","Dillard's Inc.","DIMON Incorporated","Dole Food Company, Inc.","Dollar General Corporation","Dollar Tree Stores, Inc.","Dominion Resources, Inc.","Domino's Pizza LLC","Dover Corporation, Inc.","Dow Chemical Company","Dow Jones & Company, Inc.","DPL Inc.","DQE Inc.","Dreyer's Grand Ice Cream, Inc.","DST Systems, Inc.","DTE Energy Co.","E.I. Du Pont de Nemours and Company","Duke Energy Corp","Dun & Bradstreet Inc.","DURA Automotive Systems Inc.","DynCorp","Dynegy Inc.","E*Trade Group, Inc.","E.W. Scripps Company","Earthlink, Inc.","Eastman Chemical Company","Eastman Kodak Company","Eaton Corporation","Echostar Communications Corporation","Ecolab Inc.","Edison International","EGL Inc.","El Paso Corporation","Electronic Arts Inc.","Electronic Data Systems Corp.","Eli Lilly and Company","EMC Corporation","Emcor Group Inc.","Emerson Electric Co.","Encompass Services Corporation","Energizer Holdings Inc.","Energy East Corporation","Engelhard Corporation","Enron Corp.","Entergy Corporation","Enterprise Products Partners L.P.","EOG Resources, Inc.","Equifax Inc.","Equitable Resources Inc.","Equity Office Properties Trust","Equity Residential Properties Trust","Estee Lauder Companies Inc.","Exelon Corporation","Exide Technologies","Expeditors International of Washington Inc.","Express Scripts Inc.","ExxonMobil Corporation","Fairchild Semiconductor International Inc.","Family Dollar Stores Inc.","Farmland Industries Inc.","Federal Mogul Corp.","Federated Department Stores Inc.","Federal Express Corp.","Felcor Lodging Trust Inc.","Ferro Corp.","Fidelity National Financial Inc.","Fifth Third Bancorp","First American Financial Corp.","First Data Corp.","First National of Nebraska Inc.","First Tennessee National Corp.","FirstEnergy Corp.","Fiserv Inc.","Fisher Scientific International Inc.","FleetBoston Financial Co.","Fleetwood Enterprises Inc.","Fleming Companies Inc.","Flowers Foods Inc.","Flowserv Corp","Fluor Corp","FMC Corp","Foamex International Inc","Foot Locker Inc","Footstar Inc.","Ford Motor Co","Forest Laboratories Inc.","Fortune Brands Inc.","Foster Wheeler Ltd.","FPL Group Inc.","Franklin Resources Inc.","Freeport McMoran Copper & Gold Inc.","Frontier Oil Corp","Furniture Brands International Inc.","Gannett Co., Inc.","Gap Inc.","Gateway Inc.","GATX Corporation","Gemstar-TV Guide International Inc.","GenCorp Inc.","General Cable Corporation","General Dynamics Corporation","General Electric Company","General Mills Inc","General Motors Corporation","Genesis Health Ventures Inc.","Gentek Inc.","Gentiva Health Services Inc.","Genuine Parts Company","Genuity Inc.","Genzyme Corporation","Georgia Gulf Corporation","Georgia-Pacific Corporation","Gillette Company","Gold Kist Inc.","Golden State Bancorp Inc.","Golden West Financial Corporation","Goldman Sachs Group Inc.","Goodrich Corporation","The Goodyear Tire & Rubber Company","Granite Construction Incorporated","Graybar Electric Company Inc.","Great Lakes Chemical Corporation","Great Plains Energy Inc.","GreenPoint Financial Corp.","Greif Bros. Corporation","Grey Global Group Inc.","Group 1 Automotive Inc.","Guidant Corporation","H&R Block Inc.","H.B. Fuller Company","H.J. Heinz Company","Halliburton Co.","Harley-Davidson Inc.","Harman International Industries Inc.","Harrah's Entertainment Inc.","Harris Corp.","Harsco Corp.","Hartford Financial Services Group Inc.","Hasbro Inc.","Hawaiian Electric Industries Inc.","HCA Inc.","Health Management Associates Inc.","Health Net Inc.","Healthsouth Corp","Henry Schein Inc.","Hercules Inc.","Herman Miller Inc.","Hershey Foods Corp.","Hewlett-Packard Company","Hibernia Corp.","Hillenbrand Industries Inc.","Hilton Hotels Corp.","Hollywood Entertainment Corp.","Home Depot Inc.","Hon Industries Inc.","Honeywell International Inc.","Hormel Foods Corp.","Host Marriott Corp.","Household International Corp.","Hovnanian Enterprises Inc.","Hub Group Inc.","Hubbell Inc.","Hughes Supply Inc.","Humana Inc.","Huntington Bancshares Inc.","Idacorp Inc.","IDT Corporation","IKON Office Solutions Inc.","Illinois Tool Works Inc.","IMC Global Inc.","Imperial Sugar Company","IMS Health Inc.","Ingles Market Inc","Ingram Micro Inc.","Insight Enterprises Inc.","Integrated Electrical Services Inc.","Intel Corporation","International Paper Co.","Interpublic Group of Companies Inc.","Interstate Bakeries Corporation","International Business Machines Corp.","International Flavors & Fragrances Inc.","International Multifoods Corporation","Intuit Inc.","IT Group Inc.","ITT Industries Inc.","Ivax Corp.","J.B. Hunt Transport Services Inc.","J.C. Penny Co.","J.P. Morgan Chase & Co.","Jabil Circuit Inc.","Jack In The Box Inc.","Jacobs Engineering Group Inc.","JDS Uniphase Corp.","Jefferson-Pilot Co.","John Hancock Financial Services Inc.","Johnson & Johnson","Johnson Controls Inc.","Jones Apparel Group Inc.","KB Home","Kellogg Company","Kellwood Company","Kelly Services Inc.","Kemet Corp.","Kennametal Inc.","Kerr-McGee Corporation","KeyCorp","KeySpan Corp.","Kimball International Inc.","Kimberly-Clark Corporation","Kindred Healthcare Inc.","KLA-Tencor Corporation","K-Mart Corp.","Knight-Ridder Inc.","Kohl's Corp.","KPMG Consulting Inc.","Kroger Co.","L-3 Communications Holdings Inc.","Laboratory Corporation of America Holdings","Lam Research Corporation","LandAmerica Financial Group Inc.","Lands' End Inc.","Landstar System Inc.","La-Z-Boy Inc.","Lear Corporation","Legg Mason Inc.","Leggett & Platt Inc.","Lehman Brothers Holdings Inc.","Lennar Corporation","Lennox International Inc.","Level 3 Communications Inc.","Levi Strauss & Co.","Lexmark International Inc.","Limited Inc.","Lincoln National Corporation","Linens 'n Things Inc.","Lithia Motors Inc.","Liz Claiborne Inc.","Lockheed Martin Corporation","Loews Corporation","Longs Drug Stores Corporation","Louisiana-Pacific Corporation","Lowe's Companies Inc.","LSI Logic Corporation","The LTV Corporation","The Lubrizol Corporation","Lucent Technologies Inc.","Lyondell Chemical Company","M & T Bank Corporation","Magellan Health Services Inc.","Mail-Well Inc.","Mandalay Resort Group","Manor Care Inc.","Manpower Inc.","Marathon Oil Corporation","Mariner Health Care Inc.","Markel Corporation","Marriott International Inc.","Marsh & McLennan Companies Inc.","Marsh Supermarkets Inc.","Marshall & Ilsley Corporation","Martin Marietta Materials Inc.","Masco Corporation","Massey Energy Company","MasTec Inc.","Mattel Inc.","Maxim Integrated Products Inc.","Maxtor Corporation","Maxxam Inc.","The May Department Stores Company","Maytag Corporation","MBNA Corporation","McCormick & Company Incorporated","McDonald's Corporation","The McGraw-Hill Companies Inc.","McKesson Corporation","McLeodUSA Incorporated","M.D.C. Holdings Inc.","MDU Resources Group Inc.","MeadWestvaco Corporation","Medtronic Inc.","Mellon Financial Corporation","The Men's Wearhouse Inc.","Merck & Co., Inc.","Mercury General Corporation","Merrill Lynch & Co. Inc.","Metaldyne Corporation","Metals USA Inc.","MetLife Inc.","Metris Companies Inc","MGIC Investment Corporation","MGM Mirage","Michaels Stores Inc.","Micron Technology Inc.","Microsoft Corporation","Milacron Inc.","Millennium Chemicals Inc.","Mirant Corporation","Mohawk Industries Inc.","Molex Incorporated","The MONY Group Inc.","Morgan Stanley Dean Witter & Co.","Motorola Inc.","MPS Group Inc.","Murphy Oil Corporation","Nabors Industries Inc","Nacco Industries Inc","Nash Finch Company","National City Corp.","National Commerce Financial Corporation","National Fuel Gas Company","National Oilwell Inc","National Rural Utilities Cooperative Finance Corporation","National Semiconductor Corporation","National Service Industries Inc","Navistar International Corporation","NCR Corporation","The Neiman Marcus Group Inc.","New Jersey Resources Corporation","New York Times Company","Newell Rubbermaid Inc","Newmont Mining Corporation","Nextel Communications Inc","Nicor Inc","Nike Inc","NiSource Inc","Noble Energy Inc","Nordstrom Inc","Norfolk Southern Corporation","Nortek Inc","North Fork Bancorporation Inc","Northeast Utilities System","Northern Trust Corporation","Northrop Grumman Corporation","NorthWestern Corporation","Novellus Systems Inc","NSTAR","NTL Incorporated","Nucor Corp","Nvidia Corp","NVR Inc","Northwest Airlines Corp","Occidental Petroleum Corp","Ocean Energy Inc","Office Depot Inc.","OfficeMax Inc","OGE Energy Corp","Oglethorpe Power Corp.","Ohio Casualty Corp.","Old Republic International Corp.","Olin Corp.","OM Group Inc","Omnicare Inc","Omnicom Group","On Semiconductor Corp","ONEOK Inc","Oracle Corp","Oshkosh Truck Corp","Outback Steakhouse Inc.","Owens & Minor Inc.","Owens Corning","Owens-Illinois Inc","Oxford Health Plans Inc","Paccar Inc","PacifiCare Health Systems Inc","Packaging Corp. of America","Pactiv Corp","Pall Corp","Pantry Inc","Park Place Entertainment Corp","Parker Hannifin Corp.","Pathmark Stores Inc.","Paychex Inc","Payless Shoesource Inc","Penn Traffic Co.","Pennzoil-Quaker State Company","Pentair Inc","Peoples Energy Corp.","PeopleSoft Inc","Pep Boys Manny, Moe & Jack","Potomac Electric Power Co.","Pepsi Bottling Group Inc.","PepsiAmericas Inc.","PepsiCo Inc.","Performance Food Group Co.","Perini Corp","PerkinElmer Inc","Perot Systems Corp","Petco Animal Supplies Inc.","Peter Kiewit Sons', Inc.","PETsMART Inc","Pfizer Inc","Pacific Gas & Electric Corp.","Pharmacia Corp","Phar Mor Inc.","Phelps Dodge Corp.","Philip Morris Companies Inc.","Phillips Petroleum Co","Phillips Van Heusen Corp.","Phoenix Companies Inc","Pier 1 Imports Inc.","Pilgrim's Pride Corporation","Pinnacle West Capital Corp","Pioneer-Standard Electronics Inc.","Pitney Bowes Inc.","Pittston Brinks Group","Plains All American Pipeline LP","PNC Financial Services Group Inc.","PNM Resources Inc","Polaris Industries Inc.","Polo Ralph Lauren Corp","PolyOne Corp","Popular Inc","Potlatch Corp","PPG Industries Inc","PPL Corp","Praxair Inc","Precision Castparts Corp","Premcor Inc.","Pride International Inc","Primedia Inc","Principal Financial Group Inc.","Procter & Gamble Co.","Pro-Fac Cooperative Inc.","Progress Energy Inc","Progressive Corporation","Protective Life Corp","Provident Financial Group","Providian Financial Corp.","Prudential Financial Inc.","PSS World Medical Inc","Public Service Enterprise Group Inc.","Publix Super Markets Inc.","Puget Energy Inc.","Pulte Homes Inc","Qualcomm Inc","Quanta Services Inc.","Quantum Corp","Quest Diagnostics Inc.","Questar Corp","Quintiles Transnational","Qwest Communications Intl Inc","R.J. Reynolds Tobacco Company","R.R. Donnelley & Sons Company","Radio Shack Corporation","Raymond James Financial Inc.","Raytheon Company","Reader's Digest Association Inc.","Reebok International Ltd.","Regions Financial Corp.","Regis Corporation","Reliance Steel & Aluminum Co.","Reliant Energy Inc.","Rent A Center Inc","Republic Services Inc","Revlon Inc","RGS Energy Group Inc","Rite Aid Corp","Riverwood Holding Inc.","RoadwayCorp","Robert Half International Inc.","Rock-Tenn Co","Rockwell Automation Inc","Rockwell Collins Inc","Rohm & Haas Co.","Ross Stores Inc","RPM Inc.","Ruddick Corp","Ryder System Inc","Ryerson Tull Inc","Ryland Group Inc.","Sabre Holdings Corp","Safeco Corp","Safeguard Scientifics Inc.","Safeway Inc","Saks Inc","Sanmina-SCI Inc","Sara Lee Corp","SBC Communications Inc","Scana Corp.","Schering-Plough Corp","Scholastic Corp","SCI Systems Onc.","Science Applications Intl. Inc.","Scientific-Atlanta Inc","Scotts Company","Seaboard Corp","Sealed Air Corp","Sears Roebuck & Co","Sempra Energy","Sequa Corp","Service Corp. International","ServiceMaster Co","Shaw Group Inc","Sherwin-Williams Company","Shopko Stores Inc","Siebel Systems Inc","Sierra Health Services Inc","Sierra Pacific Resources","Silgan Holdings Inc.","Silicon Graphics Inc","Simon Property Group Inc","SLM Corporation","Smith International Inc","Smithfield Foods Inc","Smurfit-Stone Container Corp","Snap-On Inc","Solectron Corp","Solutia Inc","Sonic Automotive Inc.","Sonoco Products Co.","Southern Company","Southern Union Company","SouthTrust Corp.","Southwest Airlines Co","Southwest Gas Corp","Sovereign Bancorp Inc.","Spartan Stores Inc","Spherion Corp","Sports Authority Inc","Sprint Corp.","SPX Corp","St. Jude Medical Inc","St. Paul Cos.","Staff Leasing Inc.","StanCorp Financial Group Inc","Standard Pacific Corp.","Stanley Works","Staples Inc","Starbucks Corp","Starwood Hotels & Resorts Worldwide Inc","State Street Corp.","Stater Bros. Holdings Inc.","Steelcase Inc","Stein Mart Inc","Stewart & Stevenson Services Inc","Stewart Information Services Corp","Stilwell Financial Inc","Storage Technology Corporation","Stryker Corp","Sun Healthcare Group Inc.","Sun Microsystems Inc.","SunGard Data Systems Inc.","Sunoco Inc.","SunTrust Banks Inc","Supervalu Inc","Swift Transportation, Co., Inc","Symbol Technologies Inc","Synovus Financial Corp.","Sysco Corp","Systemax Inc.","Target Corp.","Tech Data Corporation","TECO Energy Inc","Tecumseh Products Company","Tektronix Inc","Teleflex Incorporated","Telephone & Data Systems Inc","Tellabs Inc.","Temple-Inland Inc","Tenet Healthcare Corporation","Tenneco Automotive Inc.","Teradyne Inc","Terex Corp","Tesoro Petroleum Corp.","Texas Industries Inc.","Texas Instruments Incorporated","Textron Inc","Thermo Electron Corporation","Thomas & Betts Corporation","Tiffany & Co","Timken Company","TJX Companies Inc","TMP Worldwide Inc","Toll Brothers Inc","Torchmark Corporation","Toro Company","Tower Automotive Inc.","Toys 'R' Us Inc","Trans World Entertainment Corp.","TransMontaigne Inc","Transocean Inc","TravelCenters of America Inc.","Triad Hospitals Inc","Tribune Company","Trigon Healthcare Inc.","Trinity Industries Inc","Trump Hotels & Casino Resorts Inc.","TruServ Corporation","TRW Inc","TXU Corp","Tyson Foods Inc","U.S. Bancorp","U.S. Industries Inc.","UAL Corporation","UGI Corporation","Unified Western Grocers Inc","Union Pacific Corporation","Union Planters Corp","Unisource Energy Corp","Unisys Corporation","United Auto Group Inc","United Defense Industries Inc.","United Parcel Service Inc","United Rentals Inc","United Stationers Inc","United Technologies Corporation","UnitedHealth Group Incorporated","Unitrin Inc","Universal Corporation","Universal Forest Products Inc","Universal Health Services Inc","Unocal Corporation","Unova Inc","UnumProvident Corporation","URS Corporation","US Airways Group Inc","US Oncology Inc","USA Interactive","USFreighways Corporation","USG Corporation","UST Inc","Valero Energy Corporation","Valspar Corporation","Value City Department Stores Inc","Varco International Inc","Vectren Corporation","Veritas Software Corporation","Verizon Communications Inc","VF Corporation","Viacom Inc","Viad Corp","Viasystems Group Inc","Vishay Intertechnology Inc","Visteon Corporation","Volt Information Sciences Inc","Vulcan Materials Company","W.R. Berkley Corporation","W.R. Grace & Co","W.W. Grainger Inc","Wachovia Corporation","Wakenhut Corporation","Walgreen Co","Wallace Computer Services Inc","Wal-Mart Stores Inc","Walt Disney Co","Walter Industries Inc","Washington Mutual Inc","Washington Post Co.","Waste Management Inc","Watsco Inc","Weatherford International Inc","Weis Markets Inc.","Wellpoint Health Networks Inc","Wells Fargo & Company","Wendy's International Inc","Werner Enterprises Inc","WESCO International Inc","Western Digital Inc","Western Gas Resources Inc","WestPoint Stevens Inc","Weyerhauser Company","WGL Holdings Inc","Whirlpool Corporation","Whole Foods Market Inc","Willamette Industries Inc.","Williams Companies Inc","Williams Sonoma Inc","Winn Dixie Stores Inc","Wisconsin Energy Corporation","Wm Wrigley Jr Company","World Fuel Services Corporation","WorldCom Inc","Worthington Industries Inc","WPS Resources Corporation","Wyeth","Wyndham International Inc","Xcel Energy Inc","Xerox Corp","Xilinx Inc","XO Communications Inc","Yellow Corporation","York International Corp","Yum Brands Inc.","Zale Corporation","Zions Bancorporation"],fileExtension:{raster:["bmp","gif","gpl","ico","jpeg","psd","png","psp","raw","tiff"],vector:["3dv","amf","awg","ai","cgm","cdr","cmx","dxf","e2d","egt","eps","fs","odg","svg","xar"],"3d":["3dmf","3dm","3mf","3ds","an8","aoi","blend","cal3d","cob","ctm","iob","jas","max","mb","mdx","obj","x","x3d"],document:["doc","docx","dot","html","xml","odt","odm","ott","csv","rtf","tex","xhtml","xps"]},timezones:[{name:"Dateline Standard Time",abbr:"DST",offset:-12,isdst:!(l.prototype.file=function(t){var e,i=t||{},n="fileExtension",r=Object.keys(this.get("fileExtension"));if(e=this.word({length:i.length}),i.extension)return e+"."+i.extension;if(i.extensions){if(Array.isArray(i.extensions))return e+"."+this.pickone(i.extensions);else if(i.extensions.constructor===Object){var o=i.extensions,s=Object.keys(o);return e+"."+this.pickone(o[this.pickone(s)])}throw new Error("Chance: Extensions must be an Array or Object")}if(i.fileType){var a=i.fileType;if(-1!==r.indexOf(a))return e+"."+this.pickone(this.get(n)[a]);throw new RangeError("Chance: Expect file type value to be 'raster', 'vector', '3d' or 'document'")}return e+"."+this.pickone(this.get(n)[this.pickone(r)])}),text:"(UTC-12:00) International Date Line West",utc:["Etc/GMT+12"]},{name:"UTC-11",abbr:"U",offset:-11,isdst:!1,text:"(UTC-11:00) Coordinated Universal Time-11",utc:["Etc/GMT+11","Pacific/Midway","Pacific/Niue","Pacific/Pago_Pago"]},{name:"Hawaiian Standard Time",abbr:"HST",offset:-10,isdst:!1,text:"(UTC-10:00) Hawaii",utc:["Etc/GMT+10","Pacific/Honolulu","Pacific/Johnston","Pacific/Rarotonga","Pacific/Tahiti"]},{name:"Alaskan Standard Time",abbr:"AKDT",offset:-8,isdst:!0,text:"(UTC-09:00) Alaska",utc:["America/Anchorage","America/Juneau","America/Nome","America/Sitka","America/Yakutat"]},{name:"Pacific Standard Time (Mexico)",abbr:"PDT",offset:-7,isdst:!0,text:"(UTC-08:00) Baja California",utc:["America/Santa_Isabel"]},{name:"Pacific Standard Time",abbr:"PDT",offset:-7,isdst:!0,text:"(UTC-08:00) Pacific Time (US & Canada)",utc:["America/Dawson","America/Los_Angeles","America/Tijuana","America/Vancouver","America/Whitehorse","PST8PDT"]},{name:"US Mountain Standard Time",abbr:"UMST",offset:-7,isdst:!1,text:"(UTC-07:00) Arizona",utc:["America/Creston","America/Dawson_Creek","America/Hermosillo","America/Phoenix","Etc/GMT+7"]},{name:"Mountain Standard Time (Mexico)",abbr:"MDT",offset:-6,isdst:!0,text:"(UTC-07:00) Chihuahua, La Paz, Mazatlan",utc:["America/Chihuahua","America/Mazatlan"]},{name:"Mountain Standard Time",abbr:"MDT",offset:-6,isdst:!0,text:"(UTC-07:00) Mountain Time (US & Canada)",utc:["America/Boise","America/Cambridge_Bay","America/Denver","America/Edmonton","America/Inuvik","America/Ojinaga","America/Yellowknife","MST7MDT"]},{name:"Central America Standard Time",abbr:"CAST",offset:-6,isdst:!1,text:"(UTC-06:00) Central America",utc:["America/Belize","America/Costa_Rica","America/El_Salvador","America/Guatemala","America/Managua","America/Tegucigalpa","Etc/GMT+6","Pacific/Galapagos"]},{name:"Central Standard Time",abbr:"CDT",offset:-5,isdst:!0,text:"(UTC-06:00) Central Time (US & Canada)",utc:["America/Chicago","America/Indiana/Knox","America/Indiana/Tell_City","America/Matamoros","America/Menominee","America/North_Dakota/Beulah","America/North_Dakota/Center","America/North_Dakota/New_Salem","America/Rainy_River","America/Rankin_Inlet","America/Resolute","America/Winnipeg","CST6CDT"]},{name:"Central Standard Time (Mexico)",abbr:"CDT",offset:-5,isdst:!0,text:"(UTC-06:00) Guadalajara, Mexico City, Monterrey",utc:["America/Bahia_Banderas","America/Cancun","America/Merida","America/Mexico_City","America/Monterrey"]},{name:"Canada Central Standard Time",abbr:"CCST",offset:-6,isdst:!1,text:"(UTC-06:00) Saskatchewan",utc:["America/Regina","America/Swift_Current"]},{name:"SA Pacific Standard Time",abbr:"SPST",offset:-5,isdst:!1,text:"(UTC-05:00) Bogota, Lima, Quito",utc:["America/Bogota","America/Cayman","America/Coral_Harbour","America/Eirunepe","America/Guayaquil","America/Jamaica","America/Lima","America/Panama","America/Rio_Branco","Etc/GMT+5"]},{name:"Eastern Standard Time",abbr:"EDT",offset:-4,isdst:!0,text:"(UTC-05:00) Eastern Time (US & Canada)",utc:["America/Detroit","America/Havana","America/Indiana/Petersburg","America/Indiana/Vincennes","America/Indiana/Winamac","America/Iqaluit","America/Kentucky/Monticello","America/Louisville","America/Montreal","America/Nassau","America/New_York","America/Nipigon","America/Pangnirtung","America/Port-au-Prince","America/Thunder_Bay","America/Toronto","EST5EDT"]},{name:"US Eastern Standard Time",abbr:"UEDT",offset:-4,isdst:!0,text:"(UTC-05:00) Indiana (East)",utc:["America/Indiana/Marengo","America/Indiana/Vevay","America/Indianapolis"]},{name:"Venezuela Standard Time",abbr:"VST",offset:-4.5,isdst:!1,text:"(UTC-04:30) Caracas",utc:["America/Caracas"]},{name:"Paraguay Standard Time",abbr:"PST",offset:-4,isdst:!1,text:"(UTC-04:00) Asuncion",utc:["America/Asuncion"]},{name:"Atlantic Standard Time",abbr:"ADT",offset:-3,isdst:!0,text:"(UTC-04:00) Atlantic Time (Canada)",utc:["America/Glace_Bay","America/Goose_Bay","America/Halifax","America/Moncton","America/Thule","Atlantic/Bermuda"]},{name:"Central Brazilian Standard Time",abbr:"CBST",offset:-4,isdst:!1,text:"(UTC-04:00) Cuiaba",utc:["America/Campo_Grande","America/Cuiaba"]},{name:"SA Western Standard Time",abbr:"SWST",offset:-4,isdst:!1,text:"(UTC-04:00) Georgetown, La Paz, Manaus, San Juan",utc:["America/Anguilla","America/Antigua","America/Aruba","America/Barbados","America/Blanc-Sablon","America/Boa_Vista","America/Curacao","America/Dominica","America/Grand_Turk","America/Grenada","America/Guadeloupe","America/Guyana","America/Kralendijk","America/La_Paz","America/Lower_Princes","America/Manaus","America/Marigot","America/Martinique","America/Montserrat","America/Port_of_Spain","America/Porto_Velho","America/Puerto_Rico","America/Santo_Domingo","America/St_Barthelemy","America/St_Kitts","America/St_Lucia","America/St_Thomas","America/St_Vincent","America/Tortola","Etc/GMT+4"]},{name:"Pacific SA Standard Time",abbr:"PSST",offset:-4,isdst:!1,text:"(UTC-04:00) Santiago",utc:["America/Santiago","Antarctica/Palmer"]},{name:"Newfoundland Standard Time",abbr:"NDT",offset:-2.5,isdst:!0,text:"(UTC-03:30) Newfoundland",utc:["America/St_Johns"]},{name:"E. South America Standard Time",abbr:"ESAST",offset:-3,isdst:!1,text:"(UTC-03:00) Brasilia",utc:["America/Sao_Paulo"]},{name:"Argentina Standard Time",abbr:"AST",offset:-3,isdst:!1,text:"(UTC-03:00) Buenos Aires",utc:["America/Argentina/La_Rioja","America/Argentina/Rio_Gallegos","America/Argentina/Salta","America/Argentina/San_Juan","America/Argentina/San_Luis","America/Argentina/Tucuman","America/Argentina/Ushuaia","America/Buenos_Aires","America/Catamarca","America/Cordoba","America/Jujuy","America/Mendoza"]},{name:"SA Eastern Standard Time",abbr:"SEST",offset:-3,isdst:!1,text:"(UTC-03:00) Cayenne, Fortaleza",utc:["America/Araguaina","America/Belem","America/Cayenne","America/Fortaleza","America/Maceio","America/Paramaribo","America/Recife","America/Santarem","Antarctica/Rothera","Atlantic/Stanley","Etc/GMT+3"]},{name:"Greenland Standard Time",abbr:"GDT",offset:-2,isdst:!0,text:"(UTC-03:00) Greenland",utc:["America/Godthab"]},{name:"Montevideo Standard Time",abbr:"MST",offset:-3,isdst:!1,text:"(UTC-03:00) Montevideo",utc:["America/Montevideo"]},{name:"Bahia Standard Time",abbr:"BST",offset:-3,isdst:!1,text:"(UTC-03:00) Salvador",utc:["America/Bahia"]},{name:"UTC-02",abbr:"U",offset:-2,isdst:!1,text:"(UTC-02:00) Coordinated Universal Time-02",utc:["America/Noronha","Atlantic/South_Georgia","Etc/GMT+2"]},{name:"Mid-Atlantic Standard Time",abbr:"MDT",offset:-1,isdst:!0,text:"(UTC-02:00) Mid-Atlantic - Old"},{name:"Azores Standard Time",abbr:"ADT",offset:0,isdst:!0,text:"(UTC-01:00) Azores",utc:["America/Scoresbysund","Atlantic/Azores"]},{name:"Cape Verde Standard Time",abbr:"CVST",offset:-1,isdst:!1,text:"(UTC-01:00) Cape Verde Is.",utc:["Atlantic/Cape_Verde","Etc/GMT+1"]},{name:"Morocco Standard Time",abbr:"MDT",offset:1,isdst:!0,text:"(UTC) Casablanca",utc:["Africa/Casablanca","Africa/El_Aaiun"]},{name:"UTC",abbr:"CUT",offset:0,isdst:!1,text:"(UTC) Coordinated Universal Time",utc:["America/Danmarkshavn","Etc/GMT"]},{name:"GMT Standard Time",abbr:"GDT",offset:1,isdst:!0,text:"(UTC) Dublin, Edinburgh, Lisbon, London",utc:["Atlantic/Canary","Atlantic/Faeroe","Atlantic/Madeira","Europe/Dublin","Europe/Guernsey","Europe/Isle_of_Man","Europe/Jersey","Europe/Lisbon","Europe/London"]},{name:"Greenwich Standard Time",abbr:"GST",offset:0,isdst:!1,text:"(UTC) Monrovia, Reykjavik",utc:["Africa/Abidjan","Africa/Accra","Africa/Bamako","Africa/Banjul","Africa/Bissau","Africa/Conakry","Africa/Dakar","Africa/Freetown","Africa/Lome","Africa/Monrovia","Africa/Nouakchott","Africa/Ouagadougou","Africa/Sao_Tome","Atlantic/Reykjavik","Atlantic/St_Helena"]},{name:"W. Europe Standard Time",abbr:"WEDT",offset:2,isdst:!0,text:"(UTC+01:00) Amsterdam, Berlin, Bern, Rome, Stockholm, Vienna",utc:["Arctic/Longyearbyen","Europe/Amsterdam","Europe/Andorra","Europe/Berlin","Europe/Busingen","Europe/Gibraltar","Europe/Luxembourg","Europe/Malta","Europe/Monaco","Europe/Oslo","Europe/Rome","Europe/San_Marino","Europe/Stockholm","Europe/Vaduz","Europe/Vatican","Europe/Vienna","Europe/Zurich"]},{name:"Central Europe Standard Time",abbr:"CEDT",offset:2,isdst:!0,text:"(UTC+01:00) Belgrade, Bratislava, Budapest, Ljubljana, Prague",utc:["Europe/Belgrade","Europe/Bratislava","Europe/Budapest","Europe/Ljubljana","Europe/Podgorica","Europe/Prague","Europe/Tirane"]},{name:"Romance Standard Time",abbr:"RDT",offset:2,isdst:!0,text:"(UTC+01:00) Brussels, Copenhagen, Madrid, Paris",utc:["Africa/Ceuta","Europe/Brussels","Europe/Copenhagen","Europe/Madrid","Europe/Paris"]},{name:"Central European Standard Time",abbr:"CEDT",offset:2,isdst:!0,text:"(UTC+01:00) Sarajevo, Skopje, Warsaw, Zagreb",utc:["Europe/Sarajevo","Europe/Skopje","Europe/Warsaw","Europe/Zagreb"]},{name:"W. Central Africa Standard Time",abbr:"WCAST",offset:1,isdst:!1,text:"(UTC+01:00) West Central Africa",utc:["Africa/Algiers","Africa/Bangui","Africa/Brazzaville","Africa/Douala","Africa/Kinshasa","Africa/Lagos","Africa/Libreville","Africa/Luanda","Africa/Malabo","Africa/Ndjamena","Africa/Niamey","Africa/Porto-Novo","Africa/Tunis","Etc/GMT-1"]},{name:"Namibia Standard Time",abbr:"NST",offset:1,isdst:!1,text:"(UTC+01:00) Windhoek",utc:["Africa/Windhoek"]},{name:"GTB Standard Time",abbr:"GDT",offset:3,isdst:!0,text:"(UTC+02:00) Athens, Bucharest",utc:["Asia/Nicosia","Europe/Athens","Europe/Bucharest","Europe/Chisinau"]},{name:"Middle East Standard Time",abbr:"MEDT",offset:3,isdst:!0,text:"(UTC+02:00) Beirut",utc:["Asia/Beirut"]},{name:"Egypt Standard Time",abbr:"EST",offset:2,isdst:!1,text:"(UTC+02:00) Cairo",utc:["Africa/Cairo"]},{name:"Syria Standard Time",abbr:"SDT",offset:3,isdst:!0,text:"(UTC+02:00) Damascus",utc:["Asia/Damascus"]},{name:"E. Europe Standard Time",abbr:"EEDT",offset:3,isdst:!0,text:"(UTC+02:00) E. Europe"},{name:"South Africa Standard Time",abbr:"SAST",offset:2,isdst:!1,text:"(UTC+02:00) Harare, Pretoria",utc:["Africa/Blantyre","Africa/Bujumbura","Africa/Gaborone","Africa/Harare","Africa/Johannesburg","Africa/Kigali","Africa/Lubumbashi","Africa/Lusaka","Africa/Maputo","Africa/Maseru","Africa/Mbabane","Etc/GMT-2"]},{name:"FLE Standard Time",abbr:"FDT",offset:3,isdst:!0,text:"(UTC+02:00) Helsinki, Kyiv, Riga, Sofia, Tallinn, Vilnius",utc:["Europe/Helsinki","Europe/Kiev","Europe/Mariehamn","Europe/Riga","Europe/Sofia","Europe/Tallinn","Europe/Uzhgorod","Europe/Vilnius","Europe/Zaporozhye"]},{name:"Turkey Standard Time",abbr:"TDT",offset:3,isdst:!0,text:"(UTC+02:00) Istanbul",utc:["Europe/Istanbul"]},{name:"Israel Standard Time",abbr:"JDT",offset:3,isdst:!0,text:"(UTC+02:00) Jerusalem",utc:["Asia/Jerusalem"]},{name:"Libya Standard Time",abbr:"LST",offset:2,isdst:!1,text:"(UTC+02:00) Tripoli",utc:["Africa/Tripoli"]},{name:"Jordan Standard Time",abbr:"JST",offset:3,isdst:!1,text:"(UTC+03:00) Amman",utc:["Asia/Amman"]},{name:"Arabic Standard Time",abbr:"AST",offset:3,isdst:!1,text:"(UTC+03:00) Baghdad",utc:["Asia/Baghdad"]},{name:"Kaliningrad Standard Time",abbr:"KST",offset:3,isdst:!1,text:"(UTC+03:00) Kaliningrad, Minsk",utc:["Europe/Kaliningrad","Europe/Minsk"]},{name:"Arab Standard Time",abbr:"AST",offset:3,isdst:!1,text:"(UTC+03:00) Kuwait, Riyadh",utc:["Asia/Aden","Asia/Bahrain","Asia/Kuwait","Asia/Qatar","Asia/Riyadh"]},{name:"E. Africa Standard Time",abbr:"EAST",offset:3,isdst:!1,text:"(UTC+03:00) Nairobi",utc:["Africa/Addis_Ababa","Africa/Asmera","Africa/Dar_es_Salaam","Africa/Djibouti","Africa/Juba","Africa/Kampala","Africa/Khartoum","Africa/Mogadishu","Africa/Nairobi","Antarctica/Syowa","Etc/GMT-3","Indian/Antananarivo","Indian/Comoro","Indian/Mayotte"]},{name:"Iran Standard Time",abbr:"IDT",offset:4.5,isdst:!0,text:"(UTC+03:30) Tehran",utc:["Asia/Tehran"]},{name:"Arabian Standard Time",abbr:"AST",offset:4,isdst:!1,text:"(UTC+04:00) Abu Dhabi, Muscat",utc:["Asia/Dubai","Asia/Muscat","Etc/GMT-4"]},{name:"Azerbaijan Standard Time",abbr:"ADT",offset:5,isdst:!0,text:"(UTC+04:00) Baku",utc:["Asia/Baku"]},{name:"Russian Standard Time",abbr:"RST",offset:4,isdst:!1,text:"(UTC+04:00) Moscow, St. Petersburg, Volgograd",utc:["Europe/Moscow","Europe/Samara","Europe/Simferopol","Europe/Volgograd"]},{name:"Mauritius Standard Time",abbr:"MST",offset:4,isdst:!1,text:"(UTC+04:00) Port Louis",utc:["Indian/Mahe","Indian/Mauritius","Indian/Reunion"]},{name:"Georgian Standard Time",abbr:"GST",offset:4,isdst:!1,text:"(UTC+04:00) Tbilisi",utc:["Asia/Tbilisi"]},{name:"Caucasus Standard Time",abbr:"CST",offset:4,isdst:!1,text:"(UTC+04:00) Yerevan",utc:["Asia/Yerevan"]},{name:"Afghanistan Standard Time",abbr:"AST",offset:4.5,isdst:!1,text:"(UTC+04:30) Kabul",utc:["Asia/Kabul"]},{name:"West Asia Standard Time",abbr:"WAST",offset:5,isdst:!1,text:"(UTC+05:00) Ashgabat, Tashkent",utc:["Antarctica/Mawson","Asia/Aqtau","Asia/Aqtobe","Asia/Ashgabat","Asia/Dushanbe","Asia/Oral","Asia/Samarkand","Asia/Tashkent","Etc/GMT-5","Indian/Kerguelen","Indian/Maldives"]},{name:"Pakistan Standard Time",abbr:"PST",offset:5,isdst:!1,text:"(UTC+05:00) Islamabad, Karachi",utc:["Asia/Karachi"]},{name:"India Standard Time",abbr:"IST",offset:5.5,isdst:!1,text:"(UTC+05:30) Chennai, Kolkata, Mumbai, New Delhi",utc:["Asia/Calcutta"]},{name:"Sri Lanka Standard Time",abbr:"SLST",offset:5.5,isdst:!1,text:"(UTC+05:30) Sri Jayawardenepura",utc:["Asia/Colombo"]},{name:"Nepal Standard Time",abbr:"NST",offset:5.75,isdst:!1,text:"(UTC+05:45) Kathmandu",utc:["Asia/Katmandu"]},{name:"Central Asia Standard Time",abbr:"CAST",offset:6,isdst:!1,text:"(UTC+06:00) Astana",utc:["Antarctica/Vostok","Asia/Almaty","Asia/Bishkek","Asia/Qyzylorda","Asia/Urumqi","Etc/GMT-6","Indian/Chagos"]},{name:"Bangladesh Standard Time",abbr:"BST",offset:6,isdst:!1,text:"(UTC+06:00) Dhaka",utc:["Asia/Dhaka","Asia/Thimphu"]},{name:"Ekaterinburg Standard Time",abbr:"EST",offset:6,isdst:!1,text:"(UTC+06:00) Ekaterinburg",utc:["Asia/Yekaterinburg"]},{name:"Myanmar Standard Time",abbr:"MST",offset:6.5,isdst:!1,text:"(UTC+06:30) Yangon (Rangoon)",utc:["Asia/Rangoon","Indian/Cocos"]},{name:"SE Asia Standard Time",abbr:"SAST",offset:7,isdst:!1,text:"(UTC+07:00) Bangkok, Hanoi, Jakarta",utc:["Antarctica/Davis","Asia/Bangkok","Asia/Hovd","Asia/Jakarta","Asia/Phnom_Penh","Asia/Pontianak","Asia/Saigon","Asia/Vientiane","Etc/GMT-7","Indian/Christmas"]},{name:"N. Central Asia Standard Time",abbr:"NCAST",offset:7,isdst:!1,text:"(UTC+07:00) Novosibirsk",utc:["Asia/Novokuznetsk","Asia/Novosibirsk","Asia/Omsk"]},{name:"China Standard Time",abbr:"CST",offset:8,isdst:!1,text:"(UTC+08:00) Beijing, Chongqing, Hong Kong, Urumqi",utc:["Asia/Hong_Kong","Asia/Macau","Asia/Shanghai"]},{name:"North Asia Standard Time",abbr:"NAST",offset:8,isdst:!1,text:"(UTC+08:00) Krasnoyarsk",utc:["Asia/Krasnoyarsk"]},{name:"Singapore Standard Time",abbr:"MPST",offset:8,isdst:!1,text:"(UTC+08:00) Kuala Lumpur, Singapore",utc:["Asia/Brunei","Asia/Kuala_Lumpur","Asia/Kuching","Asia/Makassar","Asia/Manila","Asia/Singapore","Etc/GMT-8"]},{name:"W. Australia Standard Time",abbr:"WAST",offset:8,isdst:!1,text:"(UTC+08:00) Perth",utc:["Antarctica/Casey","Australia/Perth"]},{name:"Taipei Standard Time",abbr:"TST",offset:8,isdst:!1,text:"(UTC+08:00) Taipei",utc:["Asia/Taipei"]},{name:"Ulaanbaatar Standard Time",abbr:"UST",offset:8,isdst:!1,text:"(UTC+08:00) Ulaanbaatar",utc:["Asia/Choibalsan","Asia/Ulaanbaatar"]},{name:"North Asia East Standard Time",abbr:"NAEST",offset:9,isdst:!1,text:"(UTC+09:00) Irkutsk",utc:["Asia/Irkutsk"]},{name:"Tokyo Standard Time",abbr:"TST",offset:9,isdst:!1,text:"(UTC+09:00) Osaka, Sapporo, Tokyo",utc:["Asia/Dili","Asia/Jayapura","Asia/Tokyo","Etc/GMT-9","Pacific/Palau"]},{name:"Korea Standard Time",abbr:"KST",offset:9,isdst:!1,text:"(UTC+09:00) Seoul",utc:["Asia/Pyongyang","Asia/Seoul"]},{name:"Cen. Australia Standard Time",abbr:"CAST",offset:9.5,isdst:!1,text:"(UTC+09:30) Adelaide",utc:["Australia/Adelaide","Australia/Broken_Hill"]},{name:"AUS Central Standard Time",abbr:"ACST",offset:9.5,isdst:!1,text:"(UTC+09:30) Darwin",utc:["Australia/Darwin"]},{name:"E. Australia Standard Time",abbr:"EAST",offset:10,isdst:!1,text:"(UTC+10:00) Brisbane",utc:["Australia/Brisbane","Australia/Lindeman"]},{name:"AUS Eastern Standard Time",abbr:"AEST",offset:10,isdst:!1,text:"(UTC+10:00) Canberra, Melbourne, Sydney",utc:["Australia/Melbourne","Australia/Sydney"]},{name:"West Pacific Standard Time",abbr:"WPST",offset:10,isdst:!1,text:"(UTC+10:00) Guam, Port Moresby",utc:["Antarctica/DumontDUrville","Etc/GMT-10","Pacific/Guam","Pacific/Port_Moresby","Pacific/Saipan","Pacific/Truk"]},{name:"Tasmania Standard Time",abbr:"TST",offset:10,isdst:!1,text:"(UTC+10:00) Hobart",utc:["Australia/Currie","Australia/Hobart"]},{name:"Yakutsk Standard Time",abbr:"YST",offset:10,isdst:!1,text:"(UTC+10:00) Yakutsk",utc:["Asia/Chita","Asia/Khandyga","Asia/Yakutsk"]},{name:"Central Pacific Standard Time",abbr:"CPST",offset:11,isdst:!1,text:"(UTC+11:00) Solomon Is., New Caledonia",utc:["Antarctica/Macquarie","Etc/GMT-11","Pacific/Efate","Pacific/Guadalcanal","Pacific/Kosrae","Pacific/Noumea","Pacific/Ponape"]},{name:"Vladivostok Standard Time",abbr:"VST",offset:11,isdst:!1,text:"(UTC+11:00) Vladivostok",utc:["Asia/Sakhalin","Asia/Ust-Nera","Asia/Vladivostok"]},{name:"New Zealand Standard Time",abbr:"NZST",offset:12,isdst:!1,text:"(UTC+12:00) Auckland, Wellington",utc:["Antarctica/McMurdo","Pacific/Auckland"]},{name:"UTC+12",abbr:"U",offset:12,isdst:!1,text:"(UTC+12:00) Coordinated Universal Time+12",utc:["Etc/GMT-12","Pacific/Funafuti","Pacific/Kwajalein","Pacific/Majuro","Pacific/Nauru","Pacific/Tarawa","Pacific/Wake","Pacific/Wallis"]},{name:"Fiji Standard Time",abbr:"FST",offset:12,isdst:!1,text:"(UTC+12:00) Fiji",utc:["Pacific/Fiji"]},{name:"Magadan Standard Time",abbr:"MST",offset:12,isdst:!1,text:"(UTC+12:00) Magadan",utc:["Asia/Anadyr","Asia/Kamchatka","Asia/Magadan","Asia/Srednekolymsk"]},{name:"Kamchatka Standard Time",abbr:"KDT",offset:13,isdst:!0,text:"(UTC+12:00) Petropavlovsk-Kamchatsky - Old"},{name:"Tonga Standard Time",abbr:"TST",offset:13,isdst:!1,text:"(UTC+13:00) Nuku'alofa",utc:["Etc/GMT-13","Pacific/Enderbury","Pacific/Fakaofo","Pacific/Tongatapu"]},{name:"Samoa Standard Time",abbr:"SST",offset:13,isdst:!1,text:"(UTC+13:00) Samoa",utc:["Pacific/Apia"]}],profession:["Airline Pilot","Academic Team","Accountant","Account Executive","Actor","Actuary","Acquisition Analyst","Administrative Asst.","Administrative Analyst","Administrator","Advertising Director","Aerospace Engineer","Agent","Agricultural Inspector","Agricultural Scientist","Air Traffic Controller","Animal Trainer","Anthropologist","Appraiser","Architect","Art Director","Artist","Astronomer","Athletic Coach","Auditor","Author","Baker","Banker","Bankruptcy Attorney","Benefits Manager","Biologist","Bio-feedback Specialist","Biomedical Engineer","Biotechnical Researcher","Broadcaster","Broker","Building Manager","Building Contractor","Building Inspector","Business Analyst","Business Planner","Business Manager","Buyer","Call Center Manager","Career Counselor","Cash Manager","Ceramic Engineer","Chief Executive Officer","Chief Operation Officer","Chef","Chemical Engineer","Chemist","Child Care Manager","Chief Medical Officer","Chiropractor","Cinematographer","City Housing Manager","City Manager","Civil Engineer","Claims Manager","Clinical Research Assistant","Collections Manager.","Compliance Manager","Comptroller","Computer Manager","Commercial Artist","Communications Affairs Director","Communications Director","Communications Engineer","Compensation Analyst","Computer Programmer","Computer Ops. Manager","Computer Engineer","Computer Operator","Computer Graphics Specialist","Construction Engineer","Construction Manager","Consultant","Consumer Relations Manager","Contract Administrator","Copyright Attorney","Copywriter","Corporate Planner","Corrections Officer","Cosmetologist","Credit Analyst","Cruise Director","Chief Information Officer","Chief Technology Officer","Customer Service Manager","Cryptologist","Dancer","Data Security Manager","Database Manager","Day Care Instructor","Dentist","Designer","Design Engineer","Desktop Publisher","Developer","Development Officer","Diamond Merchant","Dietitian","Direct Marketer","Director","Distribution Manager","Diversity Manager","Economist","EEO Compliance Manager","Editor","Education Adminator","Electrical Engineer","Electro Optical Engineer","Electronics Engineer","Embassy Management","Employment Agent","Engineer Technician","Entrepreneur","Environmental Analyst","Environmental Attorney","Environmental Engineer","Environmental Specialist","Escrow Officer","Estimator","Executive Assistant","Executive Director","Executive Recruiter","Facilities Manager","Family Counselor","Fashion Events Manager","Fashion Merchandiser","Fast Food Manager","Film Producer","Film Production Assistant","Financial Analyst","Financial Planner","Financier","Fine Artist","Wildlife Specialist","Fitness Consultant","Flight Attendant","Flight Engineer","Floral Designer","Food & Beverage Director","Food Service Manager","Forestry Technician","Franchise Management","Franchise Sales","Fraud Investigator","Freelance Writer","Fund Raiser","General Manager","Geologist","General Counsel","Geriatric Specialist","Gerontologist","Glamour Photographer","Golf Club Manager","Gourmet Chef","Graphic Designer","Grounds Keeper","Hazardous Waste Manager","Health Care Manager","Health Therapist","Health Service Administrator","Hearing Officer","Home Economist","Horticulturist","Hospital Administrator","Hotel Manager","Human Resources Manager","Importer","Industrial Designer","Industrial Engineer","Information Director","Inside Sales","Insurance Adjuster","Interior Decorator","Internal Controls Director","International Acct.","International Courier","International Lawyer","Interpreter","Investigator","Investment Banker","Investment Manager","IT Architect","IT Project Manager","IT Systems Analyst","Jeweler","Joint Venture Manager","Journalist","Labor Negotiator","Labor Organizer","Labor Relations Manager","Lab Services Director","Lab Technician","Land Developer","Landscape Architect","Law Enforcement Officer","Lawyer","Lead Software Engineer","Lead Software Test Engineer","Leasing Manager","Legal Secretary","Library Manager","Litigation Attorney","Loan Officer","Lobbyist","Logistics Manager","Maintenance Manager","Management Consultant","Managed Care Director","Managing Partner","Manufacturing Director","Manpower Planner","Marine Biologist","Market Res. Analyst","Marketing Director","Materials Manager","Mathematician","Membership Chairman","Mechanic","Mechanical Engineer","Media Buyer","Medical Investor","Medical Secretary","Medical Technician","Mental Health Counselor","Merchandiser","Metallurgical Engineering","Meteorologist","Microbiologist","MIS Manager","Motion Picture Director","Multimedia Director","Musician","Network Administrator","Network Specialist","Network Operator","New Product Manager","Novelist","Nuclear Engineer","Nuclear Specialist","Nutritionist","Nursing Administrator","Occupational Therapist","Oceanographer","Office Manager","Operations Manager","Operations Research Director","Optical Technician","Optometrist","Organizational Development Manager","Outplacement Specialist","Paralegal","Park Ranger","Patent Attorney","Payroll Specialist","Personnel Specialist","Petroleum Engineer","Pharmacist","Photographer","Physical Therapist","Physician","Physician Assistant","Physicist","Planning Director","Podiatrist","Political Analyst","Political Scientist","Politician","Portfolio Manager","Preschool Management","Preschool Teacher","Principal","Private Banker","Private Investigator","Probation Officer","Process Engineer","Producer","Product Manager","Product Engineer","Production Engineer","Production Planner","Professional Athlete","Professional Coach","Professor","Project Engineer","Project Manager","Program Manager","Property Manager","Public Administrator","Public Safety Director","PR Specialist","Publisher","Purchasing Agent","Publishing Director","Quality Assurance Specialist","Quality Control Engineer","Quality Control Inspector","Radiology Manager","Railroad Engineer","Real Estate Broker","Recreational Director","Recruiter","Redevelopment Specialist","Regulatory Affairs Manager","Registered Nurse","Rehabilitation Counselor","Relocation Manager","Reporter","Research Specialist","Restaurant Manager","Retail Store Manager","Risk Analyst","Safety Engineer","Sales Engineer","Sales Trainer","Sales Promotion Manager","Sales Representative","Sales Manager","Service Manager","Sanitation Engineer","Scientific Programmer","Scientific Writer","Securities Analyst","Security Consultant","Security Director","Seminar Presenter","Ship's Officer","Singer","Social Director","Social Program Planner","Social Research","Social Scientist","Social Worker","Sociologist","Software Developer","Software Engineer","Software Test Engineer","Soil Scientist","Special Events Manager","Special Education Teacher","Special Projects Director","Speech Pathologist","Speech Writer","Sports Event Manager","Statistician","Store Manager","Strategic Alliance Director","Strategic Planning Director","Stress Reduction Specialist","Stockbroker","Surveyor","Structural Engineer","Superintendent","Supply Chain Director","System Engineer","Systems Analyst","Systems Programmer","System Administrator","Tax Specialist","Teacher","Technical Support Specialist","Technical Illustrator","Technical Writer","Technology Director","Telecom Analyst","Telemarketer","Theatrical Director","Title Examiner","Tour Escort","Tour Guide Director","Traffic Manager","Trainer Translator","Transportation Manager","Travel Agent","Treasurer","TV Programmer","Underwriter","Union Representative","University Administrator","University Dean","Urban Planner","Veterinarian","Vendor Relations Director","Viticulturist","Warehouse Manager"],animals:{ocean:["Acantharea","Anemone","Angelfish King","Ahi Tuna","Albacore","American Oyster","Anchovy","Armored Snail","Arctic Char","Atlantic Bluefin Tuna","Atlantic Cod","Atlantic Goliath Grouper","Atlantic Trumpetfish","Atlantic Wolffish","Baleen Whale","Banded Butterflyfish","Banded Coral Shrimp","Banded Sea Krait","Barnacle","Barndoor Skate","Barracuda","Basking Shark","Bass","Beluga Whale","Bluebanded Goby","Bluehead Wrasse","Bluefish","Bluestreak Cleaner-Wrasse","Blue Marlin","Blue Shark","Blue Spiny Lobster","Blue Tang","Blue Whale","Broadclub Cuttlefish","Bull Shark","Chambered Nautilus","Chilean Basket Star","Chilean Jack Mackerel","Chinook Salmon","Christmas Tree Worm","Clam","Clown Anemonefish","Clown Triggerfish","Cod","Coelacanth","Cockscomb Cup Coral","Common Fangtooth","Conch","Cookiecutter Shark","Copepod","Coral","Corydoras","Cownose Ray","Crab","Crown-of-Thorns Starfish","Cushion Star","Cuttlefish","California Sea Otters","Dolphin","Dolphinfish","Dory","Devil Fish","Dugong","Dumbo Octopus","Dungeness Crab","Eccentric Sand Dollar","Edible Sea Cucumber","Eel","Elephant Seal","Elkhorn Coral","Emperor Shrimp","Estuarine Crocodile","Fathead Sculpin","Fiddler Crab","Fin Whale","Flameback","Flamingo Tongue Snail","Flashlight Fish","Flatback Turtle","Flatfish","Flying Fish","Flounder","Fluke","French Angelfish","Frilled Shark","Fugu (also called Pufferfish)","Gar","Geoduck","Giant Barrel Sponge","Giant Caribbean Sea Anemone","Giant Clam","Giant Isopod","Giant Kingfish","Giant Oarfish","Giant Pacific Octopus","Giant Pyrosome","Giant Sea Star","Giant Squid","Glowing Sucker Octopus","Giant Tube Worm","Goblin Shark","Goosefish","Great White Shark","Greenland Shark","Grey Atlantic Seal","Grouper","Grunion","Guineafowl Puffer","Haddock","Hake","Halibut","Hammerhead Shark","Hapuka","Harbor Porpoise","Harbor Seal","Hatchetfish","Hawaiian Monk Seal","Hawksbill Turtle","Hector's Dolphin","Hermit Crab","Herring","Hoki","Horn Shark","Horseshoe Crab","Humpback Anglerfish","Humpback Whale","Icefish","Imperator Angelfish","Irukandji Jellyfish","Isopod","Ivory Bush Coral","Japanese Spider Crab","Jellyfish","John Dory","Juan Fernandez Fur Seal","Killer Whale","Kiwa Hirsuta","Krill","Lagoon Triggerfish","Lamprey","Leafy Seadragon","Leopard Seal","Limpet","Ling","Lionfish","Lions Mane Jellyfish","Lobe Coral","Lobster","Loggerhead Turtle","Longnose Sawshark","Longsnout Seahorse","Lophelia Coral","Marrus Orthocanna","Manatee","Manta Ray","Marlin","Megamouth Shark","Mexican Lookdown","Mimic Octopus","Moon Jelly","Mollusk","Monkfish","Moray Eel","Mullet","Mussel","Megaladon","Napoleon Wrasse","Nassau Grouper","Narwhal","Nautilus","Needlefish","Northern Seahorse","North Atlantic Right Whale","Northern Red Snapper","Norway Lobster","Nudibranch","Nurse Shark","Oarfish","Ocean Sunfish","Oceanic Whitetip Shark","Octopus","Olive Sea Snake","Orange Roughy","Ostracod","Otter","Oyster","Pacific Angelshark","Pacific Blackdragon","Pacific Halibut","Pacific Sardine","Pacific Sea Nettle Jellyfish","Pacific White Sided Dolphin","Pantropical Spotted Dolphin","Patagonian Toothfish","Peacock Mantis Shrimp","Pelagic Thresher Shark","Penguin","Peruvian Anchoveta","Pilchard","Pink Salmon","Pinniped","Plankton","Porpoise","Polar Bear","Portuguese Man o' War","Pycnogonid Sea Spider","Quahog","Queen Angelfish","Queen Conch","Queen Parrotfish","Queensland Grouper","Ragfish","Ratfish","Rattail Fish","Ray","Red Drum","Red King Crab","Ringed Seal","Risso's Dolphin","Ross Seals","Sablefish","Salmon","Sand Dollar","Sandbar Shark","Sawfish","Sarcastic Fringehead","Scalloped Hammerhead Shark","Seahorse","Sea Cucumber","Sea Lion","Sea Urchin","Seal","Shark","Shortfin Mako Shark","Shovelnose Guitarfish","Shrimp","Silverside Fish","Skipjack Tuna","Slender Snipe Eel","Smalltooth Sawfish","Smelts","Sockeye Salmon","Southern Stingray","Sponge","Spotted Porcupinefish","Spotted Dolphin","Spotted Eagle Ray","Spotted Moray","Squid","Squidworm","Starfish","Stickleback","Stonefish","Stoplight Loosejaw","Sturgeon","Swordfish","Tan Bristlemouth","Tasseled Wobbegong","Terrible Claw Lobster","Threespot Damselfish","Tiger Prawn","Tiger Shark","Tilefish","Toadfish","Tropical Two-Wing Flyfish","Tuna","Umbrella Squid","Velvet Crab","Venus Flytrap Sea Anemone","Vigtorniella Worm","Viperfish","Vampire Squid","Vaquita","Wahoo","Walrus","West Indian Manatee","Whale","Whale Shark","Whiptail Gulper","White-Beaked Dolphin","White-Ring Garden Eel","White Shrimp","Wobbegong","Wrasse","Wreckfish","Xiphosura","Yellowtail Damselfish","Yelloweye Rockfish","Yellow Cup Black Coral","Yellow Tube Sponge","Yellowfin Tuna","Zebrashark","Zooplankton"],desert:["Aardwolf","Addax","African Wild Ass","Ant","Antelope","Armadillo","Baboon","Badger","Bat","Bearded Dragon","Beetle","Bird","Black-footed Cat","Boa","Brown Bear","Bustard","Butterfly","Camel","Caracal","Caracara","Caterpillar","Centipede","Cheetah","Chipmunk","Chuckwalla","Climbing Mouse","Coati","Cobra","Cotton Rat","Cougar","Courser","Crane Fly","Crow","Dassie Rat","Dove","Dunnart","Eagle","Echidna","Elephant","Emu","Falcon","Fly","Fox","Frogmouth","Gecko","Geoffroy's Cat","Gerbil","Grasshopper","Guanaco","Gundi","Hamster","Hawk","Hedgehog","Hyena","Hyrax","Jackal","Kangaroo","Kangaroo Rat","Kestrel","Kowari","Kultarr","Leopard","Lion","Macaw","Meerkat","Mouse","Oryx","Ostrich","Owl","Pronghorn","Python","Rabbit","Raccoon","Rattlesnake","Rhinoceros","Sand Cat","Spectacled Bear","Spiny Mouse","Starling","Stick Bug","Tarantula","Tit","Toad","Tortoise","Tyrant Flycatcher","Viper","Vulture","Waxwing","Xerus","Zebra"],grassland:["Aardvark","Aardwolf","Accentor","African Buffalo","African Wild Dog","Alpaca","Anaconda","Ant","Anteater","Antelope","Armadillo","Baboon","Badger","Bandicoot","Barbet","Bat","Bee","Bee-eater","Beetle","Bird","Bison","Black-footed Cat","Black-footed Ferret","Bluebird","Boa","Bowerbird","Brown Bear","Bush Dog","Bushshrike","Bustard","Butterfly","Buzzard","Caracal","Caracara","Cardinal","Caterpillar","Cheetah","Chipmunk","Civet","Climbing Mouse","Clouded Leopard","Coati","Cobra","Cockatoo","Cockroach","Common Genet","Cotton Rat","Cougar","Courser","Coyote","Crane","Crane Fly","Cricket","Crow","Culpeo","Death Adder","Deer","Deer Mouse","Dingo","Dinosaur","Dove","Drongo","Duck","Duiker","Dunnart","Eagle","Echidna","Elephant","Elk","Emu","Falcon","Finch","Flea","Fly","Flying Frog","Fox","Frog","Frogmouth","Garter Snake","Gazelle","Gecko","Geoffroy's Cat","Gerbil","Giant Tortoise","Giraffe","Grasshopper","Grison","Groundhog","Grouse","Guanaco","Guinea Pig","Hamster","Harrier","Hartebeest","Hawk","Hedgehog","Helmetshrike","Hippopotamus","Hornbill","Hyena","Hyrax","Impala","Jackal","Jaguar","Jaguarundi","Kangaroo","Kangaroo Rat","Kestrel","Kultarr","Ladybug","Leopard","Lion","Macaw","Meerkat","Mouse","Newt","Oryx","Ostrich","Owl","Pangolin","Pheasant","Prairie Dog","Pronghorn","Przewalski's Horse","Python","Quoll","Rabbit","Raven","Rhinoceros","Shelduck","Sloth Bear","Spectacled Bear","Squirrel","Starling","Stick Bug","Tamandua","Tasmanian Devil","Thornbill","Thrush","Toad","Tortoise"],forest:["Agouti","Anaconda","Anoa","Ant","Anteater","Antelope","Armadillo","Asian Black Bear","Aye-aye","Babirusa","Baboon","Badger","Bandicoot","Banteng","Barbet","Basilisk","Bat","Bearded Dragon","Bee","Bee-eater","Beetle","Bettong","Binturong","Bird-of-paradise","Bongo","Bowerbird","Bulbul","Bush Dog","Bushbaby","Bushshrike","Butterfly","Buzzard","Caecilian","Cardinal","Cassowary","Caterpillar","Centipede","Chameleon","Chimpanzee","Cicada","Civet","Clouded Leopard","Coati","Cobra","Cockatoo","Cockroach","Colugo","Cotinga","Cotton Rat","Cougar","Crane Fly","Cricket","Crocodile","Crow","Cuckoo","Cuscus","Death Adder","Deer","Dhole","Dingo","Dinosaur","Drongo","Duck","Duiker","Eagle","Echidna","Elephant","Finch","Flat-headed Cat","Flea","Flowerpecker","Fly","Flying Frog","Fossa","Frog","Frogmouth","Gaur","Gecko","Gorilla","Grison","Hawaiian Honeycreeper","Hawk","Hedgehog","Helmetshrike","Hornbill","Hyrax","Iguana","Jackal","Jaguar","Jaguarundi","Kestrel","Ladybug","Lemur","Leopard","Lion","Macaw","Mandrill","Margay","Monkey","Mouse","Mouse Deer","Newt","Okapi","Old World Flycatcher","Orangutan","Owl","Pangolin","Peafowl","Pheasant","Possum","Python","Quokka","Rabbit","Raccoon","Red Panda","Red River Hog","Rhinoceros","Sloth Bear","Spectacled Bear","Squirrel","Starling","Stick Bug","Sun Bear","Tamandua","Tamarin","Tapir","Tarantula","Thrush","Tiger","Tit","Toad","Tortoise","Toucan","Trogon","Trumpeter","Turaco","Turtle","Tyrant Flycatcher","Viper","Vulture","Wallaby","Warbler","Wasp","Waxwing","Weaver","Weaver-finch","Whistler","White-eye","Whydah","Woodswallow","Worm","Wren","Xenops","Yellowjacket","Accentor","African Buffalo","American Black Bear","Anole","Bird","Bison","Boa","Brown Bear","Chipmunk","Common Genet","Copperhead","Coyote","Deer Mouse","Dormouse","Elk","Emu","Fisher","Fox","Garter Snake","Giant Panda","Giant Tortoise","Groundhog","Grouse","Guanaco","Himalayan Tahr","Kangaroo","Koala","Numbat","Quoll","Raccoon dog","Tasmanian Devil","Thornbill","Turkey","Vole","Weasel","Wildcat","Wolf","Wombat","Woodchuck","Woodpecker"],farm:["Alpaca","Buffalo","Banteng","Cow","Cat","Chicken","Carp","Camel","Donkey","Dog","Duck","Emu","Goat","Gayal","Guinea","Goose","Horse","Honey","Llama","Pig","Pigeon","Rhea","Rabbit","Sheep","Silkworm","Turkey","Yak","Zebu"],pet:["Bearded Dragon","Birds","Burro","Cats","Chameleons","Chickens","Chinchillas","Chinese Water Dragon","Cows","Dogs","Donkey","Ducks","Ferrets","Fish","Geckos","Geese","Gerbils","Goats","Guinea Fowl","Guinea Pigs","Hamsters","Hedgehogs","Horses","Iguanas","Llamas","Lizards","Mice","Mule","Peafowl","Pigs and Hogs","Pigeons","Ponies","Pot Bellied Pig","Rabbits","Rats","Sheep","Skinks","Snakes","Stick Insects","Sugar Gliders","Tarantula","Turkeys","Turtles"],zoo:["Aardvark","African Wild Dog","Aldabra Tortoise","American Alligator","American Bison","Amur Tiger","Anaconda","Andean Condor","Asian Elephant","Baby Doll Sheep","Bald Eagle","Barred Owl","Blue Iguana","Boer Goat","California Sea Lion","Caribbean Flamingo","Chinchilla","Collared Lemur","Coquerel's Sifaka","Cuban Amazon Parrot","Ebony Langur","Fennec Fox","Fossa","Gelada","Giant Anteater","Giraffe","Gorilla","Grizzly Bear","Henkel's Leaf-tailed Gecko","Indian Gharial","Indian Rhinoceros","King Cobra","King Vulture","Komodo Dragon","Linne's Two-toed Sloth","Lion","Little Penguin","Madagascar Tree Boa","Magellanic Penguin","Malayan Tapir","Malayan Tiger","Matschies Tree Kangaroo","Mini Donkey","Monarch Butterfly","Nile crocodile","North American Porcupine","Nubian Ibex","Okapi","Poison Dart Frog","Polar Bear","Pygmy Marmoset","Radiated Tortoise","Red Panda","Red Ruffed Lemur","Ring-tailed Lemur","Ring-tailed Mongoose","Rock Hyrax","Small Clawed Asian Otter","Snow Leopard","Snowy Owl","Southern White-faced Owl","Southern White Rhinocerous","Squirrel Monkey","Tufted Puffin","White Cheeked Gibbon","White-throated Bee Eater","Zebra"]}},d=Object.prototype.hasOwnProperty,p=Object.keys||function(t){var e=[];for(var i in t)if(d.call(t,i))e.push(i);return e};function f(t,e){var i=Array.isArray(t),n=e||(i?new Array(t.length):{});if(i)!function(t,e){for(var i=0,n=t.length;i<n;i++)e[i]=t[i]}(t,n);else!function(t,e){for(var i,n=p(t),r=0,o=n.length;r<o;r++)e[i=n[r]]=t[i]||e[i]}(t,n);return n}l.prototype.get=function(t){return f(c[t])},l.prototype.mac_address=function(t){if(!(t=g(t)).separator)t.separator=t.networkVersion?".":":";var e="ABCDEF1234567890",i="";if(!t.networkVersion)i=this.n(this.string,6,{pool:e,length:2}).join(t.separator);else i=this.n(this.string,3,{pool:e,length:4}).join(t.separator);return i},l.prototype.normal=function(t){if(h((t=g(t,{mean:0,dev:1,pool:[]})).pool.constructor!==Array,"Chance: The pool option must be a valid array."),h("number"!=typeof t.mean,"Chance: Mean (mean) must be a number"),h("number"!=typeof t.dev,"Chance: Standard deviation (dev) must be a number"),0<t.pool.length)return this.normal_pool(t);for(var e,i,n,r=t.mean,o=t.dev;1<=(e=(i=2*this.random()-1)*i+(n=2*this.random()-1)*n););return o*(i*Math.sqrt(-2*Math.log(e)/e))+r},l.prototype.normal_pool=function(t){var e=0;do{var i=Math.round(this.normal({mean:t.mean,dev:t.dev}));if(i<t.pool.length&&0<=i)return t.pool[i];else e++}while(e<100);throw new RangeError("Chance: Your pool is too small for the given mean and standard deviation. Please adjust.")},l.prototype.radio=function(t){var e="";switch((t=g(t,{side:"?"})).side.toLowerCase()){case"east":case"e":e="W";break;case"west":case"w":e="K";break;default:e=this.character({pool:"KW"})}return e+this.character({alpha:!0,casing:"upper"})+this.character({alpha:!0,casing:"upper"})+this.character({alpha:!0,casing:"upper"})},l.prototype.set=function(t,e){if("string"==typeof t)c[t]=e;else c=f(t,c)},l.prototype.tv=function(t){return this.radio(t)},l.prototype.cnpj=function(){var t=this.n(this.natural,8,{max:9}),e=2+6*t[7]+7*t[6]+8*t[5]+9*t[4]+2*t[3]+3*t[2]+4*t[1]+5*t[0];if(10<=(e=11-e%11))e=0;var i=2*e+3+7*t[7]+8*t[6]+9*t[5]+2*t[4]+3*t[3]+4*t[2]+5*t[1]+6*t[0];if(10<=(i=11-i%11))i=0;return""+t[0]+t[1]+"."+t[2]+t[3]+t[4]+"."+t[5]+t[6]+t[7]+"/0001-"+e+i},l.prototype.mersenne_twister=function(t){return new m(t)},l.prototype.blueimp_md5=function(){return new y};var m=function(t){if(void 0===t)t=Math.floor(Math.random()*Math.pow(10,13));this.N=624,this.M=397,this.MATRIX_A=2567483615,this.UPPER_MASK=2147483648,this.LOWER_MASK=2147483647,this.mt=new Array(this.N),this.mti=this.N+1,this.seed=t,this.init_genrand(t)};m.prototype.init_genrand=function(t){for(this.mt[0]=t>>>0,this.mti=1;this.mti<this.N;this.mti++)t=this.mt[this.mti-1]^this.mt[this.mti-1]>>>30,this.mt[this.mti]=(1812433253*((4294901760&t)>>>16)<<16)+1812433253*(65535&t)+this.mti,this.mt[this.mti]>>>=0},m.prototype.init_by_array=function(t,e){var i,n,r=1,o=0;for(this.init_genrand(19650218),i=this.N>e?this.N:e;i;i--){if(n=this.mt[r-1]^this.mt[r-1]>>>30,this.mt[r]=(this.mt[r]^(1664525*((4294901760&n)>>>16)<<16)+1664525*(65535&n))+t[o]+o,this.mt[r]>>>=0,o++,++r>=this.N)this.mt[0]=this.mt[this.N-1],r=1;if(e<=o)o=0}for(i=this.N-1;i;i--)if(n=this.mt[r-1]^this.mt[r-1]>>>30,this.mt[r]=(this.mt[r]^(1566083941*((4294901760&n)>>>16)<<16)+1566083941*(65535&n))-r,this.mt[r]>>>=0,++r>=this.N)this.mt[0]=this.mt[this.N-1],r=1;this.mt[0]=2147483648},m.prototype.genrand_int32=function(){var t,e=[0,this.MATRIX_A];if(this.mti>=this.N){var i;if(this.mti===this.N+1)this.init_genrand(5489);for(i=0;i<this.N-this.M;i++)t=this.mt[i]&this.UPPER_MASK|this.mt[i+1]&this.LOWER_MASK,this.mt[i]=this.mt[i+this.M]^t>>>1^e[1&t];for(;i<this.N-1;i++)t=this.mt[i]&this.UPPER_MASK|this.mt[i+1]&this.LOWER_MASK,this.mt[i]=this.mt[i+(this.M-this.N)]^t>>>1^e[1&t];t=this.mt[this.N-1]&this.UPPER_MASK|this.mt[0]&this.LOWER_MASK,this.mt[this.N-1]=this.mt[this.M-1]^t>>>1^e[1&t],this.mti=0}return t=this.mt[this.mti++],t^=t>>>11,t^=t<<7&2636928640,t^=t<<15&4022730752,(t^=t>>>18)>>>0},m.prototype.genrand_int31=function(){return this.genrand_int32()>>>1},m.prototype.genrand_real1=function(){return this.genrand_int32()*(1/4294967295)},m.prototype.random=function(){return this.genrand_int32()*(1/4294967296)},m.prototype.genrand_real3=function(){return(this.genrand_int32()+.5)*(1/4294967296)},m.prototype.genrand_res53=function(){return(67108864*(this.genrand_int32()>>>5)+(this.genrand_int32()>>>6))*(1/9007199254740992)};var y=function(){};if(y.prototype.VERSION="1.0.1",y.prototype.safe_add=function(t,e){var i=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(i>>16)<<16|65535&i},y.prototype.bit_roll=function(t,e){return t<<e|t>>>32-e},y.prototype.md5_cmn=function(t,e,i,n,r,o){return this.safe_add(this.bit_roll(this.safe_add(this.safe_add(e,t),this.safe_add(n,o)),r),i)},y.prototype.md5_ff=function(t,e,i,n,r,o,s){return this.md5_cmn(e&i|~e&n,t,e,r,o,s)},y.prototype.md5_gg=function(t,e,i,n,r,o,s){return this.md5_cmn(e&n|i&~n,t,e,r,o,s)},y.prototype.md5_hh=function(t,e,i,n,r,o,s){return this.md5_cmn(e^i^n,t,e,r,o,s)},y.prototype.md5_ii=function(t,e,i,n,r,o,s){return this.md5_cmn(i^(e|~n),t,e,r,o,s)},y.prototype.binl_md5=function(t,e){var i,n,r,o,s;t[e>>5]|=128<<e%32,t[14+(e+64>>>9<<4)]=e;var a=1732584193,l=-271733879,c=-1732584194,u=271733878;for(i=0;i<t.length;i+=16)n=a,r=l,o=c,s=u,a=this.md5_ff(a,l,c,u,t[i],7,-680876936),u=this.md5_ff(u,a,l,c,t[i+1],12,-389564586),c=this.md5_ff(c,u,a,l,t[i+2],17,606105819),l=this.md5_ff(l,c,u,a,t[i+3],22,-1044525330),a=this.md5_ff(a,l,c,u,t[i+4],7,-176418897),u=this.md5_ff(u,a,l,c,t[i+5],12,1200080426),c=this.md5_ff(c,u,a,l,t[i+6],17,-1473231341),l=this.md5_ff(l,c,u,a,t[i+7],22,-45705983),a=this.md5_ff(a,l,c,u,t[i+8],7,1770035416),u=this.md5_ff(u,a,l,c,t[i+9],12,-1958414417),c=this.md5_ff(c,u,a,l,t[i+10],17,-42063),l=this.md5_ff(l,c,u,a,t[i+11],22,-1990404162),a=this.md5_ff(a,l,c,u,t[i+12],7,1804603682),u=this.md5_ff(u,a,l,c,t[i+13],12,-40341101),c=this.md5_ff(c,u,a,l,t[i+14],17,-1502002290),l=this.md5_ff(l,c,u,a,t[i+15],22,1236535329),a=this.md5_gg(a,l,c,u,t[i+1],5,-165796510),u=this.md5_gg(u,a,l,c,t[i+6],9,-1069501632),c=this.md5_gg(c,u,a,l,t[i+11],14,643717713),l=this.md5_gg(l,c,u,a,t[i],20,-373897302),a=this.md5_gg(a,l,c,u,t[i+5],5,-701558691),u=this.md5_gg(u,a,l,c,t[i+10],9,38016083),c=this.md5_gg(c,u,a,l,t[i+15],14,-660478335),l=this.md5_gg(l,c,u,a,t[i+4],20,-405537848),a=this.md5_gg(a,l,c,u,t[i+9],5,568446438),u=this.md5_gg(u,a,l,c,t[i+14],9,-1019803690),c=this.md5_gg(c,u,a,l,t[i+3],14,-187363961),l=this.md5_gg(l,c,u,a,t[i+8],20,1163531501),a=this.md5_gg(a,l,c,u,t[i+13],5,-1444681467),u=this.md5_gg(u,a,l,c,t[i+2],9,-51403784),c=this.md5_gg(c,u,a,l,t[i+7],14,1735328473),l=this.md5_gg(l,c,u,a,t[i+12],20,-1926607734),a=this.md5_hh(a,l,c,u,t[i+5],4,-378558),u=this.md5_hh(u,a,l,c,t[i+8],11,-2022574463),c=this.md5_hh(c,u,a,l,t[i+11],16,1839030562),l=this.md5_hh(l,c,u,a,t[i+14],23,-35309556),a=this.md5_hh(a,l,c,u,t[i+1],4,-1530992060),u=this.md5_hh(u,a,l,c,t[i+4],11,1272893353),c=this.md5_hh(c,u,a,l,t[i+7],16,-155497632),l=this.md5_hh(l,c,u,a,t[i+10],23,-1094730640),a=this.md5_hh(a,l,c,u,t[i+13],4,681279174),u=this.md5_hh(u,a,l,c,t[i],11,-358537222),c=this.md5_hh(c,u,a,l,t[i+3],16,-722521979),l=this.md5_hh(l,c,u,a,t[i+6],23,76029189),a=this.md5_hh(a,l,c,u,t[i+9],4,-640364487),u=this.md5_hh(u,a,l,c,t[i+12],11,-421815835),c=this.md5_hh(c,u,a,l,t[i+15],16,530742520),l=this.md5_hh(l,c,u,a,t[i+2],23,-995338651),a=this.md5_ii(a,l,c,u,t[i],6,-198630844),u=this.md5_ii(u,a,l,c,t[i+7],10,1126891415),c=this.md5_ii(c,u,a,l,t[i+14],15,-1416354905),l=this.md5_ii(l,c,u,a,t[i+5],21,-57434055),a=this.md5_ii(a,l,c,u,t[i+12],6,1700485571),u=this.md5_ii(u,a,l,c,t[i+3],10,-1894986606),c=this.md5_ii(c,u,a,l,t[i+10],15,-1051523),l=this.md5_ii(l,c,u,a,t[i+1],21,-2054922799),a=this.md5_ii(a,l,c,u,t[i+8],6,1873313359),u=this.md5_ii(u,a,l,c,t[i+15],10,-30611744),c=this.md5_ii(c,u,a,l,t[i+6],15,-1560198380),l=this.md5_ii(l,c,u,a,t[i+13],21,1309151649),a=this.md5_ii(a,l,c,u,t[i+4],6,-145523070),u=this.md5_ii(u,a,l,c,t[i+11],10,-1120210379),c=this.md5_ii(c,u,a,l,t[i+2],15,718787259),l=this.md5_ii(l,c,u,a,t[i+9],21,-343485551),a=this.safe_add(a,n),l=this.safe_add(l,r),c=this.safe_add(c,o),u=this.safe_add(u,s);return[a,l,c,u]},y.prototype.binl2rstr=function(t){var e,i="";for(e=0;e<32*t.length;e+=8)i+=String.fromCharCode(t[e>>5]>>>e%32&255);return i},y.prototype.rstr2binl=function(t){var e,i=[];for(i[(t.length>>2)-1]=void 0,e=0;e<i.length;e+=1)i[e]=0;for(e=0;e<8*t.length;e+=8)i[e>>5]|=(255&t.charCodeAt(e/8))<<e%32;return i},y.prototype.rstr_md5=function(t){return this.binl2rstr(this.binl_md5(this.rstr2binl(t),8*t.length))},y.prototype.rstr_hmac_md5=function(t,e){var i,n,r=this.rstr2binl(t),o=[],s=[];if(o[15]=s[15]=void 0,16<r.length)r=this.binl_md5(r,8*t.length);for(i=0;i<16;i+=1)o[i]=909522486^r[i],s[i]=1549556828^r[i];return n=this.binl_md5(o.concat(this.rstr2binl(e)),512+8*e.length),this.binl2rstr(this.binl_md5(s.concat(n),640))},y.prototype.rstr2hex=function(t){var e,i,n="0123456789abcdef",r="";for(i=0;i<t.length;i+=1)e=t.charCodeAt(i),r+=n.charAt(e>>>4&15)+n.charAt(15&e);return r},y.prototype.str2rstr_utf8=function(t){return unescape(encodeURIComponent(t))},y.prototype.raw_md5=function(t){return this.rstr_md5(this.str2rstr_utf8(t))},y.prototype.hex_md5=function(t){return this.rstr2hex(this.raw_md5(t))},y.prototype.raw_hmac_md5=function(t,e){return this.rstr_hmac_md5(this.str2rstr_utf8(t),this.str2rstr_utf8(e))},y.prototype.hex_hmac_md5=function(t,e){return this.rstr2hex(this.raw_hmac_md5(t,e))},y.prototype.md5=function(t,e,i){if(!e)if(!i)return this.hex_md5(t);else return this.raw_md5(t);if(!i)return this.hex_hmac_md5(e,t);else return this.raw_hmac_md5(e,t)},"undefined"!=typeof exports){if("undefined"!=typeof module&&module.exports)exports=module.exports=l;exports.Chance=l}if("function"==typeof define&&define.amd)define([],function(){return l});if("undefined"!=typeof importScripts)window.chance=new l,self.Chance=l;if("object"===(void 0===window?"undefined":_typeof(window))&&"object"===_typeof(window.document))window.Chance=l,window.chance=new l;var v=drama.plugins_.aaXe_Chance.prototype;function b(){}function _(){}function w(){}v.Type=function(t){this.plugin=t,this.runtime=t.runtime},v.Type.prototype.onCreate=function(){},v.Instance=function(t){this.type=t,this.runtime=t.runtime,this._seed=0,this._useSeed=!1,this._lastDiceRoll=[],this._lastDiceSum=0,this._lastDiceTag=null,this._diceRoll={}},v.Instance.prototype.onCreate=function(){if(this._seed=this.properties[0],this._useSeed=this.properties[1],this._useSeed)this.chance=new l(this._seed);else this.chance=new l},b.prototype.GetChance=function(t){if(t<0)t=0;else if(100<t)t=100;return this.chance.bool({likelihood:t})},b.prototype.OnRoll=function(t){if(""===t)t="default";return this._lastDiceTag===t},b.prototype.OnRollContains=function(t,e){if(""===t)t="default";if(this._lastDiceTag===t)return this._diceRoll[t].roll.includes(e);else return!1},v.cnds=new b,_.prototype.SetSeed=function(t){if(this._useSeed)this._seed=t,this.chance=new l(this._seed)},_.prototype.RollDice=function(t,e,i){var n=this;if(""===i)i="default";if(this._diceRoll.hasOwnProperty(i))this._diceRoll[i].sum=0,this._diceRoll[i].roll=this.chance.rpg(t+"d"+e);else this._diceRoll[i]={sum:0,roll:this.chance.rpg(t+"d"+e)};this._diceRoll[i].roll.forEach(function(t){n._diceRoll[i].sum+=t}),this._lastDiceRoll=this._diceRoll[i].roll,this._lastDiceSum=this._diceRoll[i].sum,this._lastDiceTag=i,this.runtime.trigger(drama.plugins_.aaXe_Chance.prototype.cnds.OnRoll,this),this.runtime.trigger(drama.plugins_.aaXe_Chance.prototype.cnds.OnRollContains,this)},v.acts=new _,w.prototype.GetSeed=function(t){t.set_int(this.chance.mt.seed)},w.prototype.GetCharacter=function(t){t.set_string(this.chance.character())},w.prototype.GetCharacterLower=function(t){t.set_string(this.chance.character({pool:"abcdefghijklmnopqrstuvwxyz"}))},w.prototype.GetCharacterUpper=function(t){t.set_string(this.chance.character({pool:"ABCDEFGHIJKLMNOPQRSTUVWXYZ"}))},w.prototype.GetCharacterPool=function(t,e){if(""===e)t.set_string(this.chance.character());else t.set_string(this.chance.character({pool:e}))},w.prototype.GetCurrentDiceSum=function(t){t.set_int(this._lastDiceSum)},w.prototype.GetCurrentDiceAt=function(t,e){if(e<0||e>this._lastDiceRoll.length-1)t.set_int(-1);else t.set_int(this._lastDiceRoll[e])},w.prototype.GetDiceSum=function(t,e){if(this._diceRoll.hasOwnProperty(e))t.set_int(this._diceRoll[e].sum);else t.set_int(-1)},w.prototype.GetDiceAt=function(t,e,i){if(this._diceRoll.hasOwnProperty(i))if(e<0||e>this._diceRoll[i].roll.length-1)t.set_int(-1);else t.set_int(this._diceRoll[i].roll[e]);else t.set_int(-1)},w.prototype.GetStringUpper=function(t,e){t.set_string(this.chance.string({length:e,pool:"ABCDEFGHIJKLMNOPQRSTUVWXYZ"}))},w.prototype.GetStringLower=function(t,e){t.set_string(this.chance.string({length:e,pool:"abcdefghijklmnopqrstuvwxyz"}))},w.prototype.GetStringPool=function(t,e,i){t.set_string(this.chance.string({length:e,pool:i}))},w.prototype.GetWeighted=function(t,e,i){var n=e.split(","),r=i.split(",").map(Number);t.set_any(this.chance.weighted(n,r))},v.exps=new w}(),assert2(drama,"drama namespace not created"),assert2(drama.plugins_,"drama.plugins_ not created"),drama.plugins_.CJSAds=function(t){this.runtime=t},function(){var e="",i=[],n=0,r=0,o=!1,s=!1,t=!1,a=!1,l=drama.plugins_.CJSAds.prototype;function c(){}function u(){}function h(){}l.Type=function(t){this.plugin=t,this.runtime=t.runtime},l.Type.prototype.onCreate=function(){},l.Instance=function(t){this.type=t,this.runtime=t.runtime},l.Instance.prototype.onCreate=function(){this.isShowingBanner=!1,this.isShowingFullscreen=!1,this.triggerProduct="",this.socialService=null,this.socialServiceAvailable=!1,this.storeServiceAvailable=this.runtime.isCocoonJs&&void 0!==CocoonJS.Store.nativeExtensionObjectAvailable,this.storeManaged=1!==this.properties[0],this.storeSandboxed=0!==this.properties[1],this.onConsumePurchaseFailedTransactionId="",this.onConsumePurchaseCompleted="";var i=this;if(this.runtime.isCocoonJs){if(CocoonJS.App.onTextDialogFinished.addEventListener(function(t){e=t,i.runtime.trigger(drama.plugins_.CJSAds.prototype.cnds.OnKeyboardOK,i)}),CocoonJS.App.onTextDialogCancelled.addEventListener(function(){i.runtime.trigger(drama.plugins_.CJSAds.prototype.cnds.OnKeyboardCancelled,i)}),CocoonJS.Ad.onBannerShown.addEventListener(function(){i.isShowingBanner=!0,i.runtime.trigger(drama.plugins_.CJSAds.prototype.cnds.OnBannerShown,i)}),CocoonJS.Ad.onBannerReady.addEventListener(function(){if(s=!0,!o)CocoonJS.Ad.setBannerLayout(r),CocoonJS.Ad.showBanner()}),CocoonJS.Ad.onFullScreenShown.addEventListener(function(){i.isShowingFullscreen=!0,i.runtime.trigger(drama.plugins_.CJSAds.prototype.cnds.OnFullscreenShown,i)}),CocoonJS.Ad.onFullScreenHidden.addEventListener(function(){i.isShowingFullscreen=!1,i.runtime.trigger(drama.plugins_.CJSAds.prototype.cnds.OnFullscreenHidden,i)}),CocoonJS.Ad.onFullScreenReady.addEventListener(function(){if(a=!0,!t)CocoonJS.Ad.showFullScreen()}),this.storeServiceAvailable)CocoonJS.Store.onProductPurchaseCompleted.addEventListener(function(t){i.triggerProduct=t.productId,i.runtime.trigger(drama.plugins_.CJSAds.prototype.cnds.OnPurchaseComplete,i),CocoonJS.Store.addPurchase(t),CocoonJS.Store.consumePurchase(t.transactionId,t.productId),CocoonJS.Store.finishPurchase(t.transactionId)}),CocoonJS.Store.onConsumePurchaseFailed.addEventListener(function(t,e){this.onConsumePurchaseFailedTransactionId=t,i.runtime.trigger(drama.plugins_.CJSAds.prototype.cnds.onConsumePurchaseFailed,i)}),CocoonJS.Store.onConsumePurchaseCompleted.addEventListener(function(t){this.onConsumePurchaseCompleted=t,i.runtime.trigger(drama.plugins_.CJSAds.prototype.cnds.onConsumePurchaseCompleted,i)}),CocoonJS.Store.onProductPurchaseFailed.addEventListener(function(t,e){i.triggerProduct=t,i.runtime.trigger(drama.plugins_.CJSAds.prototype.cnds.OnPurchaseFail,i)}),CocoonJS.Store.onProductPurchaseStarted.addEventListener(function(t){i.triggerProduct=t.productId,i.runtime.trigger(drama.plugins_.CJSAds.prototype.cnds.OnPurchaseStart,i)}),CocoonJS.Store.onProductsFetchStarted.addEventListener(function(){i.runtime.trigger(drama.plugins_.CJSAds.prototype.cnds.onProductsFetchStarted,i)}),CocoonJS.Store.onProductsFetchFailed.addEventListener(function(){i.runtime.trigger(drama.plugins_.CJSAds.prototype.cnds.onProductsFetchFailed,i)}),CocoonJS.Store.onProductsFetchCompleted.addEventListener(function(t){i.runtime.trigger(drama.plugins_.CJSAds.prototype.cnds.onProductsFetchCompleted,i)}),CocoonJS.Store.requestInitialization({managed:this.storeManaged,sandbox:this.storeSandboxed}),CocoonJS.Store.start();this.socialService=CocoonJS.SocialGaming.GameCenter,this.socialServiceAvailable=!!this.socialService.nativeExtensionObjectAvailable,this.socialService.onRequestLoginSucceed.addEventListener(function(){i.runtime.trigger(drama.plugins_.CJSAds.prototype.cnds.OnGCLoginSuccess,i)}),this.socialService.onRequestLoginFailed.addEventListener(function(){i.runtime.trigger(drama.plugins_.CJSAds.prototype.cnds.OnGCLoginFail,i)}),this.socialService.onLogout.addEventListener(function(){i.runtime.trigger(drama.plugins_.CJSAds.prototype.cnds.OnGCLogout,i)}),this.socialService.onRequestUserScoreSucceed.addEventListener(function(t){n=t.score||0,i.runtime.trigger(drama.plugins_.CJSAds.prototype.cnds.OnGCScoreReceived,i)}),this.socialService.onRequestUserScoreFailed.addEventListener(function(){i.runtime.trigger(drama.plugins_.CJSAds.prototype.cnds.OnGCScoreUnavailable,i)}),this.socialService.onSubmitUserScoreSucceed.addEventListener(function(){i.runtime.trigger(drama.plugins_.CJSAds.prototype.cnds.OnGCScoreSubmitSuccess,i)}),this.socialService.onSubmitUserScoreFailed.addEventListener(function(){i.runtime.trigger(drama.plugins_.CJSAds.prototype.cnds.OnGCScoreSubmitFail,i)}),this.socialService.onLeaderboardViewSucceed.addEventListener(function(){i.runtime.trigger(drama.plugins_.CJSAds.prototype.cnds.OnGCLeaderboardOpen,i)}),this.socialService.onLeaderboardViewClosed.addEventListener(function(){i.runtime.trigger(drama.plugins_.CJSAds.prototype.cnds.OnGCLeaderboardClose,i)})}},c.prototype.IsShowingBanner=function(){return this.isShowingBanner},c.prototype.IsCocoonJS=function(){return this.runtime.isCocoonJs},c.prototype.OnBannerShown=function(){return!0},c.prototype.OnFullscreenShown=function(){return!0},c.prototype.OnFullscreenHidden=function(){return!0},c.prototype.IsShowingFullscreen=function(){return this.isShowingFullscreen},c.prototype.IsStoreAvailable=function(){if(this.runtime.isCocoonJs)return this.storeServiceAvailable&&CocoonJS.Store.canPurchase();else return!1},c.prototype.OnPurchaseStart=function(t){return this.triggerProduct===t},c.prototype.OnPurchaseComplete=function(t){return this.triggerProduct===t},c.prototype.OnPurchaseFail=function(t){return this.triggerProduct===t},c.prototype.onProductsFetchStarted=function(){return!0},c.prototype.onConsumePurchaseFailed=function(){return!0},c.prototype.onProductsFetchCompleted=function(){return!0},c.prototype.onProductsFetchFailed=function(){return!0},c.prototype.IsProductPurchased=function(t){if(this.runtime.isCocoonJs)return CocoonJS.Store.isProductPurchased(t);else return!1},c.prototype.OnKeyboardCancelled=function(){return!0},c.prototype.OnKeyboardOK=function(){return!0},c.prototype.IsGCAvailable=function(){return this.socialServiceAvailable},c.prototype.IsGCLoggedIn=function(){if(!this.socialServiceAvailable)return!1;else return this.socialService.isLoggedIn()},c.prototype.OnGCLoginSuccess=function(){return!0},c.prototype.OnGCLoginFail=function(){return!0},c.prototype.OnGCLogout=function(){return!0},c.prototype.OnGCScoreReceived=function(){return!0},c.prototype.OnGCScoreUnavailable=function(){return!0},c.prototype.OnGCScoreSubmitSuccess=function(){return!0},c.prototype.OnGCScoreSubmitFail=function(){return!0},c.prototype.OnGCLeaderboardOpen=function(){return!0},c.prototype.OnGCLeaderboardClose=function(){return!0},l.cnds=new c,u.prototype.ShowBanner=function(t){if(this.runtime.isCocoonJs)if(r=0===t?CocoonJS.Ad.BannerLayout.TOP_CENTER:CocoonJS.Ad.BannerLayout.BOTTOM_CENTER,o=!1,s)CocoonJS.Ad.setBannerLayout(r),CocoonJS.Ad.showBanner();else CocoonJS.Ad.preloadBanner()},u.prototype.ShowFullscreen=function(){if(this.runtime.isCocoonJs)if(t=!1,a)CocoonJS.Ad.showFullScreen();else CocoonJS.Ad.preloadFullScreen()},u.prototype.HideBanner=function(){if(this.runtime.isCocoonJs)CocoonJS.Ad.hideBanner(),this.isShowingBanner=!1},u.prototype.PreloadBanner=function(){if(this.runtime.isCocoonJs)o=!0,CocoonJS.Ad.preloadBanner()},u.prototype.PreloadFullscreen=function(){if(this.runtime.isCocoonJs)t=!0,CocoonJS.Ad.preloadFullScreen()},u.prototype.RefreshBanner=function(){if(this.runtime.isCocoonJs)CocoonJS.Ad.refreshBanner()},u.prototype.RefreshFullscreen=function(){if(this.runtime.isCocoonJs)CocoonJS.Ad.refreshFullScreen()},u.prototype.Purchase=function(t){if(this.runtime.isCocoonJs)CocoonJS.Store.purchaseProduct(t)},u.prototype.fetchProductsFromStore=function(t){if(this.runtime.isCocoonJs)CocoonJS.Store.fetchProductsFromStore(t.split(","))},u.prototype.restorePurchases=function(){if(this.runtime.isCocoonJs)return CocoonJS.Store.restorePurchases()},u.prototype.PurchasePreview=function(t){if(this.runtime.isCocoonJs)CocoonJS.Store.purchaseProductModalWithPreview(t)},u.prototype.RestorePurchases=function(){if(this.runtime.isCocoonJs)CocoonJS.Store.restorePurchases()},u.prototype.PromptKeyboard=function(t,e,i,n,r,o){if(this.runtime.isCocoonJs){var s=["text","num","phone","email","url"][n];CocoonJS.App.showTextDialog(t,e,i,s,r,o)}},u.prototype.UpdateProductsList=function(){if(this.runtime.isCocoonJs)if(CocoonJS.Store.canPurchase())i=CocoonJS.Store.getProducts()},u.prototype.GCLogin=function(){if(this.socialServiceAvailable&&!this.socialService.isLoggedIn())this.socialService.requestLogin()},u.prototype.GCLogout=function(){if(this.socialServiceAvailable&&this.socialService.isLoggedIn())this.socialService.requestLogout()},u.prototype.GCSubmitScore=function(t,e){if(this.socialServiceAvailable&&this.socialService.isLoggedIn())this.socialService.submitUserScore(t,e)},u.prototype.GCRequestScore=function(t){if(this.socialServiceAvailable&&this.socialService.isLoggedIn())this.socialService.requestUserScore(t)},u.prototype.GCOpenLeaderboard=function(t){if(this.socialServiceAvailable&&this.socialService.isLoggedIn())this.socialService.showLeaderboardView(t)},l.acts=new u,h.prototype.InputText=function(t){t.set_string(e)},h.prototype.ProductCount=function(t){t.set_int(i.length)},h.prototype.ProductDescription=function(t,e){if(!((e=Math.floor(e))<0||e>=i.length))t.set_string(i[e].description);else t.set_string("")},h.prototype.ProductLocalizedPrice=function(t,e){if(!((e=Math.floor(e))<0||e>=i.length))t.set_string(i[e].localizedPrice);else t.set_string("")},h.prototype.ProductPrice=function(t,e){if(!((e=Math.floor(e))<0||e>=i.length))t.set_string(i[e].price);else t.set_string("")},h.prototype.ProductAlias=function(t,e){if(!((e=Math.floor(e))<0||e>=i.length))t.set_string(i[e].productAlias);else t.set_string("")},h.prototype.ProductID=function(t,e){if(!((e=Math.floor(e))<0||e>=i.length))t.set_string(i[e].productId);else t.set_string("")},h.prototype.ProductTitle=function(t,e){if(!((e=Math.floor(e))<0||e>=i.length))t.set_string(i[e].title);else t.set_string("")},h.prototype.GameCenterScore=function(t){t.set_float(n)},l.exps=new h}(),assert2(drama,"drama namespace not created"),assert2(drama.plugins_,"drama.plugins_ not created"),drama.plugins_.Dictionary=function(t){this.runtime=t},function(){var t=drama.plugins_.Dictionary.prototype;t.Type=function(t){this.plugin=t,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t){this.type=t,this.runtime=t.runtime};var e=t.Instance.prototype;function i(){}function n(){}function r(){}e.onCreate=function(){this.dictionary={};for(var t=this.properties[0]||[],e=0;e<t.length;e++){var i=t[e];this.dictionary[i[0]]=i[1]}this.cur_key="",this.key_count=0},e.saveToJSON=function(){return this.dictionary},e.loadFromJSON=function(t){for(var e in this.dictionary=t,this.key_count=0,this.dictionary)if(this.dictionary.hasOwnProperty(e))this.key_count++},e.getDebuggerValues=function(t){var e=[];for(var i in e.push({name:"Key count",value:this.key_count,readonly:!0}),this.dictionary)if(this.dictionary.hasOwnProperty(i))e.push({name:i,value:this.dictionary[i]});t.push({title:"Dictionary",properties:e})},e.onDebugValueEdited=function(t,e,i){this.dictionary[e]=i},i.prototype.CompareValue=function(t,e,i){return drama.do_cmp(this.dictionary[t],e,i)},i.prototype.ForEachKey=function(){var t=this.runtime.getCurrentEventStack().current_event;for(var e in this.dictionary)if(this.dictionary.hasOwnProperty(e))this.cur_key=e,this.runtime.pushCopySol(t.solModifiers),t.retrigger(),this.runtime.popSol(t.solModifiers);return this.cur_key="",!1},i.prototype.CompareCurrentValue=function(t,e){return drama.do_cmp(this.dictionary[this.cur_key],t,e)},i.prototype.HasKey=function(t){return this.dictionary.hasOwnProperty(t)},i.prototype.IsEmpty=function(){return 0===this.key_count},t.cnds=new i,n.prototype.AddKey=function(t,e){if(!this.dictionary.hasOwnProperty(t))this.key_count++;this.dictionary[t]=e},n.prototype.SetKey=function(t,e){if(this.dictionary.hasOwnProperty(t))this.dictionary[t]=e},n.prototype.DeleteKey=function(t){if(this.dictionary.hasOwnProperty(t))delete this.dictionary[t],this.key_count--},n.prototype.Clear=function(){drama.wipe(this.dictionary),this.key_count=0},n.prototype.JSONLoad=function(t){var e;try{e=JSON.parse(t)}catch(t){return}if(e.xfdictionary||e.c2dictionary)for(var i in this.dictionary=e.data,this.key_count=0,this.dictionary)if(this.dictionary.hasOwnProperty(i))this.key_count++},n.prototype.JSONDownload=function(t){var e=document.createElement("a");if(void 0===e.download){var i="data:text/html,"+encodeURIComponent("<p><a download='data.json' href=\"data:application/json,"+encodeURIComponent(JSON.stringify({xfdictionary:!0,data:this.dictionary}))+'">Download link</a></p>');window.open(i)}else{var n=document.getElementsByTagName("body")[0];e.textContent=t,e.href="data:application/json,"+encodeURIComponent(JSON.stringify({xfdictionary:!0,data:this.dictionary})),e.download=t,n.appendChild(e);var r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),e.dispatchEvent(r),n.removeChild(e)}},t.acts=new n,r.prototype.Get=function(t,e){if(this.dictionary.hasOwnProperty(e))t.set_any(this.dictionary[e]);else t.set_int(0)},r.prototype.GetDefault=function(t,e,i){if(this.dictionary.hasOwnProperty(e))t.set_any(this.dictionary[e]);else t.set_any(i)},r.prototype.KeyCount=function(t){t.set_int(this.key_count)},r.prototype.CurrentKey=function(t){t.set_string(this.cur_key)},r.prototype.CurrentValue=function(t){if(this.dictionary.hasOwnProperty(this.cur_key))t.set_any(this.dictionary[this.cur_key]);else t.set_int(0)},r.prototype.AsJSON=function(t){t.set_string(JSON.stringify({xfdictionary:!0,data:this.dictionary}))},t.exps=new r}(),assert2(drama,"drama namespace not created"),assert2(drama.plugins_,"drama.plugins_ not created"),drama.plugins_.C2Ejecta=function(t){this.runtime=t},function(){var t=drama.plugins_.C2Ejecta.prototype;t.Type=function(t){this.plugin=t,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t){this.type=t,this.runtime=t.runtime};var e=t.Instance.prototype;function i(){}function n(){}function r(){}e.onCreate=function(){this.textInput="",this.adBanner=null,this.gameCenter=null},e.getGameCenter=function(){if(!this.runtime.isEjecta)return null;if(!this.gameCenter)this.gameCenter=new Ejecta.GameCenter;return this.gameCenter},e.onDestroy=function(){},e.saveToJSON=function(){return{}},e.loadFromJSON=function(t){},e.getDebuggerValues=function(t){},e.onDebugValueEdited=function(t,e,i){},i.prototype.OnTextInput=function(){return!0},i.prototype.OnAdLoad=function(){return!0},i.prototype.OnAdError=function(){return!0},i.prototype.OnGCAuthed=function(){return!0},i.prototype.OnGCAuthError=function(){return!0},i.prototype.OnGCAchievementSuccess=function(){return!0},i.prototype.OnGCAchievementError=function(){return!0},i.prototype.OnGCScoreSuccess=function(){return!0},i.prototype.OnGCScoreError=function(){return!0},i.prototype.IsGCAuthed=function(){var t=this.getGameCenter();if(!t)return!1;else return t.authed},t.cnds=new i,n.prototype.PromptForText=function(t,e){if(this.runtime.isEjecta){var i=this;ejecta.getText(t,e,function(t){i.textInput=t||"",i.runtime.trigger(drama.plugins_.C2Ejecta.prototype.cnds.OnTextInput,i)})}},n.prototype.ShowAd=function(t){if(this.runtime.isEjecta){var e=this;if(!this.adBanner)this.adBanner=new Ejecta.AdBanner,this.adBanner.onload=function(){e.runtime.trigger(drama.plugins_.C2Ejecta.prototype.cnds.OnAdLoad,e)},this.adBanner.onerror=function(){e.runtime.trigger(drama.plugins_.C2Ejecta.prototype.cnds.OnAdError,e)};this.adBanner.isAtBottom=0!==t,this.adBanner.show()}},n.prototype.HideAd=function(){if(this.runtime.isEjecta&&this.adBanner)this.adBanner.hide()},n.prototype.GCSoftAuth=function(){var t=this.getGameCenter();if(t){var e=this;t.softAuthenticate(function(t){if(t)e.runtime.trigger(drama.plugins_.C2Ejecta.prototype.cnds.OnGCAuthError,e);else e.runtime.trigger(drama.plugins_.C2Ejecta.prototype.cnds.OnGCAuthed,e)})}},n.prototype.GCAuth=function(){var t=this.getGameCenter();if(t){var e=this;t.authenticate(function(t){if(t)e.runtime.trigger(drama.plugins_.C2Ejecta.prototype.cnds.OnGCAuthError,e);else e.runtime.trigger(drama.plugins_.C2Ejecta.prototype.cnds.OnGCAuthed,e)})}},n.prototype.GCReportAchievement=function(t,e){var i=this.getGameCenter();if(i){var n=this;i.reportAchievement(t,e,function(t){if(t)n.runtime.trigger(drama.plugins_.C2Ejecta.prototype.cnds.OnGCAchievementError,n);else n.runtime.trigger(drama.plugins_.C2Ejecta.prototype.cnds.OnGCAchievementSuccess,n)})}},n.prototype.GCReportAchievementAdd=function(t,e){var i=this.getGameCenter();if(i){var n=this;i.reportAchievementAdd(t,e,function(t){if(t)n.runtime.trigger(drama.plugins_.C2Ejecta.prototype.cnds.OnGCAchievementError,n);else n.runtime.trigger(drama.plugins_.C2Ejecta.prototype.cnds.OnGCAchievementSuccess,n)})}},n.prototype.GCShowAchievements=function(){var t=this.getGameCenter();if(t)t.showAchievements()},n.prototype.GCReportScore=function(t,e){var i=this.getGameCenter();if(i){var n=this;i.reportScore(t,e,function(t){if(t)n.runtime.trigger(drama.plugins_.C2Ejecta.prototype.cnds.OnGCScoreError,n);else n.runtime.trigger(drama.plugins_.C2Ejecta.prototype.cnds.OnGCScoreSuccess,n)})}},n.prototype.GCShowLeaderboard=function(t){var e=this.getGameCenter();if(e)e.showLeaderboard(t)},t.acts=new n,r.prototype.TextInput=function(t){t.set_string(this.textInput)},t.exps=new r}(),assert2(drama,"drama namespace not created"),assert2(drama.plugins_,"drama.plugins_ not created"),drama.plugins_.Facebook=function(t){this.runtime=t},function(){var t=drama.plugins_.Facebook.prototype;t.Type=function(t){this.plugin=t,this.runtime=t.runtime};var e=t.Type.prototype,i="",n="",r=!1,a=!1,o="",s="",l="",c="",u=null,h=null,d=0,p="",f=0,m=0,g=!1,y="",v=!1;function b(){if(!a)a=!0,u.trigger(drama.plugins_.Facebook.prototype.cnds.OnLogIn,h),FB.api("/me?fields=name,first_name,last_name",function(t){s=t.name,l=t.first_name,c=t.last_name,u.trigger(drama.plugins_.Facebook.prototype.cnds.OnNameAvailable,h)})}e.onCreate=function(){},t.Instance=function(t){this.type=t,this.runtime=t.runtime};var _=t.Instance.prototype;function w(){}function x(){}function S(){}_.onCreate=function(){if(this.runtime.tickMe(this),i=this.properties[0],n=this.properties[1],u=this.runtime,h=this,window.fbAsyncInit=function(){var t=location.pathname;if("/"!==t.substr(t.length-1))t=t.substr(0,t.lastIndexOf("/")+1);if(FB.init({version:"v2.11",appId:i,channelURL:"//"+location.hostname+t+"channel.html",status:!0,cookie:!0,oauth:!0,xfbml:!1}),r=!0,FB.Event.subscribe("auth.login",function(t){if(t.authResponse)log("User ID = "+(o=t.authResponse.userID)),b()}),FB.Event.subscribe("auth.logout",function(t){if(a)a=!1,c=l=s="",u.trigger(drama.plugins_.Facebook.prototype.cnds.OnLogOut,h)}),FB.getLoginStatus(function(t){if(t.authResponse)log("User ID = "+(o=t.authResponse.userID)),b()}),!v)v=!0,u.trigger(drama.plugins_.Facebook.prototype.cnds.OnReady,h)},i.length)!function(t){var e,i="facebook-jssdk";if(!t.getElementById(i))(e=t.createElement("script")).id=i,e.async=!0,e.src="//connect.facebook.net/en_US/sdk.js",t.getElementsByTagName("head")[0].appendChild(e)}(document);else log("Facebook object: no App ID provided.  Please enter an App ID before using the object.")},_.tick=function(){if(!v)if(r)v=!0,u.trigger(drama.plugins_.Facebook.prototype.cnds.OnReady,h)},_.onLayoutChange=function(){if(a)u.trigger(drama.plugins_.Facebook.prototype.cnds.OnLogIn,h);if(s.length)u.trigger(drama.plugins_.Facebook.prototype.cnds.OnNameAvailable,h)},w.prototype.IsReady=function(){return r},w.prototype.OnReady=function(){return!0},w.prototype.IsLoggedIn=function(){return a},w.prototype.OnLogIn=function(){return!0},w.prototype.OnLogOut=function(){return!0},w.prototype.OnNameAvailable=function(){return!0},w.prototype.OnUserTopScoreAvailable=function(){return!0},w.prototype.OnHiscore=function(){return!0},w.prototype.OnScoreSubmitted=function(){return!0},t.cnds=new w,x.prototype.LogIn=function(t,e){if(r){g=1===e;var i=[];if(1===t)i.push("publish_stream");if(g)i.push("publish_actions");var n=i.join();y=n,FB.login(function(t){if(t.authResponse)b()},{scope:y})}},x.prototype.LogIn2=function(t){if(r)y=t,FB.login(function(t){if(t.authResponse)b()},{scope:y})},x.prototype.LogOut=function(){if(a)FB.logout(function(t){})},x.prototype.PromptWallPost=function(){if(a)FB.ui({method:"feed"},function(t){if(!t||t.error)console.error(t)})},x.prototype.PromptToShareApp=function(){if(a)FB.ui({method:"feed",link:"http://apps.facebook.com/"+i+"/"},function(t){if(!t||t.error)console.error(t)})},x.prototype.PromptToShareLink=function(t){if(a)FB.ui({method:"feed",link:t},function(t){if(!t||t.error)console.error(t)})},x.prototype.PublishToWall=function(t){if(a){var e={method:"stream.publish",message:t};FB.api("/me/feed","POST",e,function(t){if(!t||t.error)console.error(t)})}},x.prototype.PublishLink=function(t,e,i,n,r,o){if(a){var s={method:"stream.publish",message:t,link:e,name:i,caption:n,description:r};if(o.length)s.picture=o;FB.api("/me/feed","POST",s,function(t){if(!t||t.error)console.error(t)})}},x.prototype.PublishScore=function(t){if(a)FB.api("/"+o+"/scores","POST",{score:Math.floor(t),access_token:i+"|"+n},function(t){if(u.trigger(drama.plugins_.Facebook.prototype.cnds.OnScoreSubmitted,h),!t||t.error)console.error(t)})},x.prototype.RequestUserHiscore=function(){if(a)FB.api("/me/scores","GET",{},function(t){d=0;var e=t.data;if(e){var i,n;for(i=0,n=e.length;i<n;i++)if(e[i].score>d)d=e[i].score;if(u.trigger(drama.plugins_.Facebook.prototype.cnds.OnUserTopScoreAvailable,h),!t||t.error)console.error(t);else log(t)}else console.error("Request for user hi-score failed: "+t)})},x.prototype.RequestHiscores=function(r){if(a)FB.api("/"+i+"/scores","GET",{},function(t){var e=t.data;if(e){e.sort(function(t,e){return e.score-t.score});for(var i=0,n=Math.min(e.length,r);i<n;i++)d=e[i].score,p=e[i].user.name,f=e[i].user.id,m=i+1,u.trigger(drama.plugins_.Facebook.prototype.cnds.OnHiscore,h);if(!t||t.error)console.error(t);else log(t)}else console.error("Hi-scores request failed: "+t)})},t.acts=new x,S.prototype.FullName=function(t){t.set_string(s)},S.prototype.FirstName=function(t){t.set_string(l)},S.prototype.LastName=function(t){t.set_string(c)},S.prototype.Score=function(t){t.set_int(d)},S.prototype.HiscoreName=function(t){t.set_string(p)},S.prototype.HiscoreUserID=function(t){t.set_int(parseFloat(f))},S.prototype.HiscoreUserIDStr=function(t){t.set_string(f)},S.prototype.HiscoreRank=function(t){t.set_int(m)},S.prototype.UserID=function(t){t.set_float(parseFloat(o))},S.prototype.UserIDStr=function(t){t.set_string(o)},t.exps=new S}(),assert2(drama,"drama namespace not created"),assert2(drama.plugins_,"drama.plugins_ not created"),drama.plugins_.filechooser=function(t){this.runtime=t},function(){var t=drama.plugins_.filechooser.prototype;t.Type=function(t){this.plugin=t,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t){this.type=t,this.runtime=t.runtime};var e=t.Instance.prototype,n=window.URL||window.webkitURL||window.mozURL||window.msURL;function i(){}function r(){}function o(){}function s(t,e){if(!t)return null;if((e=Math.floor(e))<0||e>=t.length)return null;else return t[e]}e.onCreate=function(){if(this.elem=document.createElement("input"),this.elem.type="file",this.elem.setAttribute("accept",this.properties[0]),1===this.properties[1])this.elem.setAttribute("multiple","");if(this.elem.id=this.properties[3],document.body.appendChild(this.elem),this.element_hidden=!1,!this.properties[2])this.elem.style.display="none",this.visible=!1,this.element_hidden=!0;var t=this;this.elem.onchange=function(){t.runtime.trigger(drama.plugins_.filechooser.prototype.cnds.OnChanged,t)},this.lastLeft=0,this.lastTop=0,this.lastRight=0,this.lastBottom=0,this.lastWinWidth=0,this.lastWinHeight=0,this.updatePosition(!0),this.runtime.tickMe(this)},e.onDestroy=function(){this.elem.parentElement.removeChild(this.elem),this.elem=null},e.tick=function(){this.updatePosition()},e.updatePosition=function(t){var e=this.layer.layerToCanvas(this.x,this.y,!0),i=this.layer.layerToCanvas(this.x,this.y,!1),n=this.layer.layerToCanvas(this.x+this.width,this.y+this.height,!0),r=this.layer.layerToCanvas(this.x+this.width,this.y+this.height,!1),o=this.runtime.width/this.runtime.devicePixelRatio,s=this.runtime.height/this.runtime.devicePixelRatio;if(!(!this.visible||!this.layer.visible||n<=0||r<=0||o<=e||s<=i)){if(e<1)e=1;if(i<1)i=1;if(o<=n)n=o-1;if(s<=r)r=s-1;var a=window.innerWidth,l=window.innerHeight;if(t||this.lastLeft!==e||this.lastTop!==i||this.lastRight!==n||this.lastBottom!==r||this.lastWinWidth!==a||this.lastWinHeight!==l){if(this.lastLeft=e,this.lastTop=i,this.lastRight=n,this.lastBottom=r,this.lastWinWidth=a,this.lastWinHeight=l,this.element_hidden)this.elem.style.display="",this.element_hidden=!1;var c=Math.round(e)+this.runtime.canvas.offsetLeft,u=Math.round(i)+this.runtime.canvas.offsetTop;this.elem.style.position="absolute",this.elem.style.left=c+"px",this.elem.style.top=u+"px",this.elem.style.width=Math.round(n-e)+"px",this.elem.style.height=Math.round(r-i)+"px"}else if(this.element_hidden)this.elem.style.display="",this.element_hidden=!1}else{if(!this.element_hidden)this.elem.style.display="none";this.element_hidden=!0}},e.draw=function(t){},e.drawGL=function(t){},e.getDebuggerValues=function(t){},e.onDebugValueEdited=function(t,e,i){},i.prototype.OnChanged=function(){return!0},t.cnds=new i,r.prototype.SetVisible=function(t){this.visible=0!==t},r.prototype.SetCSSStyle=function(t,e){this.elem.style[drama.cssToCamelCase(t)]=e},r.prototype.ReleaseFile=function(t){if(n&&n.revokeObjectURL)n.revokeObjectURL(t)},t.acts=new r,o.prototype.FileCount=function(t){t.set_int(this.elem.files.length||0)},o.prototype.FileNameAt=function(t,e){var i=s(this.elem.files,e);t.set_string(i?i.name||"":"")},o.prototype.FileSizeAt=function(t,e){var i=s(this.elem.files,e);t.set_int(i?i.size||0:0)},o.prototype.FileTypeAt=function(t,e){var i=s(this.elem.files,e);t.set_string(i?i.type||"":"")},o.prototype.FileURLAt=function(t,e){var i=s(this.elem.files,e);if(!i)t.set_string("");else if(i.url)t.set_string(i.url);else if(n&&n.createObjectURL)i.url=n.createObjectURL(i),t.set_string(i.url);else t.set_string("")},t.exps=new o}(),assert2(drama,"drama namespace not created"),assert2(drama.plugins_,"drama.plugins_ not created"),drama.plugins_.Function=function(t){this.runtime=t},function(){var t=drama.plugins_.Function.prototype;t.Type=function(t){this.plugin=t,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t){this.type=t,this.runtime=t.runtime};var e=t.Instance.prototype,i=[],n=-1,a=!1;function r(){this.name="",this.retVal=0,this.params=[]}function l(){if(++n===i.length)i.push(new r);return i[n]}function o(){if(n<0)return null;else return i[n]}function c(){assert2(0<=n,"Popping empty function stack"),n--}function s(){}function u(){}function h(){}e.onCreate=function(){a=this.runtime.isPreview;var s=this;window.c2_callFunction=function(t,e){var i,n,r,o=l();if(o.name=t.toLowerCase(),o.retVal=0,e)for(o.params.length=e.length,i=0,n=e.length;i<n;++i)if("number"==typeof(r=e[i])||"string"==typeof r)o.params[i]=r;else if("boolean"==typeof r)o.params[i]=r?1:0;else o.params[i]=0;else drama.clearArray(o.params);return s.runtime.trigger(drama.plugins_.Function.prototype.cnds.OnFunction,s,o.name),c(),o.retVal}},s.prototype.OnFunction=function(t){var e=o();if(!e)return!1;else return drama.equals_nocase(t,e.name)},s.prototype.CompareParam=function(t,e,i){var n=o();if(!n)return!1;if((t=drama.floor(t))<0||t>=n.params.length)return!1;else return drama.do_cmp(n.params[t],e,i)},t.cnds=new s,u.prototype.CallFunction=function(t,e){var i=l();i.name=t.toLowerCase(),i.retVal=0,drama.shallowAssignArray(i.params,e);var n=this.runtime.trigger(drama.plugins_.Function.prototype.cnds.OnFunction,this,i.name);if(a&&!n)log(" Function object: called function '"+t+"', but no event was triggered. Is the function call spelt incorrectly or no longer used?","warn");c()},u.prototype.SetReturnValue=function(t){var e=o();if(e)e.retVal=t;else log(" Function object: used 'Set return value' when not in a function call","warn")},u.prototype.CallExpression=function(t){},t.acts=new u,h.prototype.ReturnValue=function(t){var e=function(){if(!i.length)return null;var t=n+1;if(t>=i.length)t=i.length-1;return i[t]}();if(e)t.set_any(e.retVal);else t.set_int(0)},h.prototype.ParamCount=function(t){var e=o();if(e)t.set_int(e.params.length);else log(" Function object: used 'ParamCount' expression when not in a function call","warn"),t.set_int(0)},h.prototype.Param=function(t,e){e=drama.floor(e);var i=o();if(i)if(0<=e&&e<i.params.length)t.set_any(i.params[e]);else log(" Function object: in function '"+i.name+"', accessed parameter out of bounds (accessed index "+e+", "+i.params.length+" params available)","warn"),t.set_int(0);else log(" Function object: used 'Param' expression when not in a function call","warn"),t.set_int(0)},h.prototype.Call=function(t,e){var i,n,r=l();for(r.name=e.toLowerCase(),r.retVal=0,drama.clearArray(r.params),i=2,n=arguments.length;i<n;i++)r.params.push(arguments[i]);var o=this.runtime.trigger(drama.plugins_.Function.prototype.cnds.OnFunction,this,r.name);if(a&&!o)log(" Function object: expression Function.Call('"+e+"' ...) was used, but no event was triggered. Is the function call spelt incorrectly or no longer used?","warn");c(),t.set_any(r.retVal)},t.exps=new h}(),assert2(drama,"drama namespace not created"),assert2(drama.plugins_,"drama.plugins_ not created"),drama.plugins_.gamecenter=function(t){this.runtime=t},function(){var t=drama.plugins_.gamecenter.prototype;t.Type=function(t){this.plugin=t,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t){this.type=t,this.runtime=t.runtime};var e=t.Instance.prototype,r=!1,o=!1;function i(){}function n(){}function s(){}e.onCreate=function(){if(!(r=void 0!==window.gamecenter))drama.logexport("[JS] Note: Game Center plugin not supported on this platform (only iOS via Cordova)");this.userAlias="",this.playerId="",this.displayName="",this.playerImageURL="",this.achievementList=[]},e.onDestroy=function(){},e.saveToJSON=function(){return{}},e.loadFromJSON=function(t){},e.draw=function(t){},e.drawGL=function(t){},e.getDebuggerValues=function(t){},e.onDebugValueEdited=function(t,e,i){},i.prototype.OnAuthSuccess=function(){return!0},i.prototype.OnAuthFail=function(){return!0},i.prototype.OnPlayerImageSuccess=function(){return!0},i.prototype.OnPlayerImageError=function(){return!0},i.prototype.OnScoreSubmitSuccess=function(){return!0},i.prototype.OnScoreSubmitFail=function(){return!0},i.prototype.OnShowLeaderboardSuccess=function(){return!0},i.prototype.OnShowLeaderboardError=function(){return!0},i.prototype.OnAchievementReportSuccess=function(){return!0},i.prototype.OnAchievementReportError=function(){return!0},i.prototype.OnAchievementResetSuccess=function(){return!0},i.prototype.OnAchievementResetError=function(){return!0},i.prototype.OnAchievementList=function(){return!0},i.prototype.OnAchievementListError=function(){return!0},t.cnds=new i,n.prototype.Auth=function(){if(r){var e=this;window.gamecenter.auth(function(t){e.userAlias=t.alias||"",e.playerId=t.playerID||"",e.displayName=t.displayName||"",o=!0,e.runtime.trigger(drama.plugins_.gamecenter.prototype.cnds.OnAuthSuccess,e)},function(){e.runtime.trigger(drama.plugins_.gamecenter.prototype.cnds.OnAuthFail,e)})}},n.prototype.RequestPlayerImage=function(){if(r&&o){var e=this;window.gamecenter.getPlayerImage(function(t){e.playerImageURL=t||"",e.runtime.trigger(drama.plugins_.gamecenter.prototype.cnds.OnPlayerImageSuccess,e)},function(){e.runtime.trigger(drama.plugins_.gamecenter.prototype.cnds.OnPlayerImageError,e)})}},n.prototype.SubmitScore=function(t,e){if(r&&o){var i=this,n={score:t,leaderboardId:e};window.gamecenter.submitScore(function(){i.runtime.trigger(drama.plugins_.gamecenter.prototype.cnds.OnScoreSubmitSuccess,i)},function(){i.runtime.trigger(drama.plugins_.gamecenter.prototype.cnds.OnScoreSubmitFail,i)},n)}},n.prototype.ShowLeaderboard=function(t){if(r&&o){var e=this,i={leaderboardId:t};window.gamecenter.showLeaderboard(function(){e.runtime.trigger(drama.plugins_.gamecenter.prototype.cnds.OnShowLeaderboardSuccess,e)},function(){e.runtime.trigger(drama.plugins_.gamecenter.prototype.cnds.OnShowLeaderboardError,e)},i)}},n.prototype.ReportAchievement=function(t,e){if(r&&o){var i=this,n={achievementId:t,percent:Math.floor(e).toString()};window.gamecenter.reportAchievement(function(){i.runtime.trigger(drama.plugins_.gamecenter.prototype.cnds.OnAchievementReportSuccess,i)},function(){i.runtime.trigger(drama.plugins_.gamecenter.prototype.cnds.OnAchievementReportError,i)},n)}},n.prototype.ResetAchievements=function(){if(r&&o){var t=this;window.gamecenter.resetAchievements(function(){t.runtime.trigger(drama.plugins_.gamecenter.prototype.cnds.OnAchievementResetSuccess,t)},function(){t.runtime.trigger(drama.plugins_.gamecenter.prototype.cnds.OnAchievementResetError,t)})}},n.prototype.RequestAchievements=function(){if(r&&o){var i=this;window.gamecenter.getAchievements(function(t){if(i.achievementList.length=0,t)for(var e=0;e<t.length;++e)i.achievementList.push(t[e]||"");i.runtime.trigger(drama.plugins_.gamecenter.prototype.cnds.OnAchievementList,i)},function(){i.runtime.trigger(drama.plugins_.gamecenter.prototype.cnds.OnAchievementListError,i)},{})}},t.acts=new n,s.prototype.UserAlias=function(t){t.set_string(this.userAlias)},s.prototype.PlayerID=function(t){t.set_string(this.playerId)},s.prototype.UserDisplayName=function(t){t.set_string(this.displayName)},s.prototype.PlayerImageURL=function(t){t.set_string(this.playerImageURL)},s.prototype.AchievementCount=function(t){t.set_int(this.achievementList.length)},s.prototype.AchievementAt=function(t,e){if((e=Math.floor(e))<0||e>this.achievementList.length)t.set_string("");else t.set_string(this.achievementList[e])},t.exps=new s}(),assert2(drama,"drama namespace not created"),assert2(drama.plugins_,"drama.plugins_ not created"),drama.plugins_.gamepad=function(t){this.runtime=t},function(){var t=drama.plugins_.gamepad.prototype,e=!1;t.Type=function(t){this.plugin=t,this.runtime=t.runtime,e=!!(navigator.getGamepads||navigator.webkitGetGamepads||navigator.mozGetGamepads||navigator.gamepads||navigator.webkitGamepads||navigator.MozGamepads)},t.Type.prototype.onCreate=function(){};var i=null,n=null,h=new Array(16),r=new Array(16),o=new Array(16),s="",a="";function d(t){var e;if(!r[t])for(r[t]=new Array(20),e=0;e<20;++e)r[t][e]=0;return r[t]}function p(t){var e;if(!o[t])for(o[t]=new Array(20),e=0;e<20;++e)o[t][e]=0;return o[t]}function f(t){var e,i=d(t),n=p(t);for(e=0;e<20;++e)n[e]=i[e]}function m(t){r[t]=null,o[t]=null}var l=16,c=null,u={};function g(t,e,i,n){if(e){if(t>=n.length)return-1;if(drama.is_number(n[t]))return n[t]+l;else return n[t]}else if(t>=i.length)return-1;else return i[t]}u.windows={},u.windows.firefox={};var y=[0,1,2,3,4,5,8,9,10,11],v=[0,1,[7,6],2,3,[14,15],[12,13]];u.windows.firefox.xbox360=function(t,e){return g(t,e,y,v)};var b=[2,0,1,3,4,6,5,7,8,9],_=[0,1,2,3,[14,15],[12,13]];function w(t,e){if(e)if(4<=t)return-1;else return t+l;else if(16<=t)return-1;else return t}function x(t){if(!c)return w;var e="",i=t.toLowerCase();if(-1<i.indexOf("xbox 360"))e="xbox360";else if(-1<i.indexOf("logitech dual action"))e="logitechdualaction";return c[e]||w}function S(t){h[t.gamepad.index]=t.gamepad,i.trigger(drama.plugins_.gamepad.prototype.cnds.OnGamepadConnected,n)}function I(t){i.trigger(drama.plugins_.gamepad.prototype.cnds.OnGamepadDisconnected,n),h[t.gamepad.index]=null}u.windows.firefox.logitechdualaction=function(t,e){return g(t,e,b,_)},t.Instance=function(t){this.type=t,this.runtime=t.runtime,i=this.runtime,n=this};var T=t.Instance.prototype;function C(){}function O(){}T.onCreate=function(){this.deadzone=this.properties[0],this.lastButton=0;var t=navigator.userAgent;if(s="windows",/mac/i.test(t))s="mac";if(c=u[s],a="chrome",/firefox/i.test(t))a="firefox";if(c)c=c[a];window.addEventListener("webkitgamepadconnected",S,!1),window.addEventListener("webkitgamepaddisconnected",I,!1),window.addEventListener("MozGamepadConnected",S,!1),window.addEventListener("MozGamepadDisconnected",I,!1),window.addEventListener("gamepadconnected",S,!1),window.addEventListener("gamepaddisconnected",I,!1),this.runtime.tickMe(this),this.activeControllers=[]},T.tick=function(){this.activeControllers.length=0;var t=null;if(navigator.getGamepads)t=navigator.getGamepads();else if(navigator.webkitGetGamepads)t=navigator.webkitGetGamepads();else if(navigator.mozGetGamepads)t=navigator.mozGetGamepads();else if(navigator.msGetGamepads)t=navigator.msGetGamepads();else t=navigator.gamepads||navigator.webkitGamepads||navigator.MozGamepads||h;if(t){var e,i,n,r,o,s,a;for(e=0,i=t.length;e<i;e++){var l=t[e];if(l){var c=d(e),u=p(e);for(f(e),o=x(l.id),n=0,r=l.buttons.length;n<r;n++){if(void 0!==l.buttons[n].value)a=l.buttons[n].value;else a=l.buttons[n];if(0<=(s=o(n,!1,a))&&s<20)if(c[s]=100*a,50<=c[s]&&u[s]<50)this.lastButton=s}for(n=0,r=l.axes.length;n<r;n++)if(s=o(n,!0,a=l.axes[n]),drama.is_number(s)){if(0<=s&&s<20)c[s]=100*a}else if(c[s[0]]=0,a<=(c[s[1]]=0))c[s[0]]=Math.abs(100*a);else c[s[1]]=Math.abs(100*a);this.activeControllers.push(l)}else m(e)}for(;e<20;++e)m(e)}},T.saveToJSON=function(){return{lastButton:this.lastButton}},T.loadFromJSON=function(t){this.lastButton=t.lastButton},T.getDebuggerValues=function(t){t.push({title:"Gamepad",properties:[{name:"Last button",value:this.lastButton,readonly:!0}]})},C.prototype.SupportsGamepad=function(){return e},C.prototype.OnGamepadConnected=function(){return!0},C.prototype.OnGamepadDisconnected=function(){return!0},C.prototype.IsButtonDown=function(t,e){if((t=Math.floor(t))<0||t>=this.activeControllers.length)return!1;var i=d(t);if(!i)return!1;var n=50<=i[e];if(n)this.lastButton=e;return n},C.prototype.OnButtonDown=function(t,e){if((t=Math.floor(t))<0||t>=this.activeControllers.length)return!1;var i=d(t),n=p(t);if(!i||!n)return!1;var r=50<=i[e]&&n[e]<50;if(r)this.lastButton=e;return r},C.prototype.OnButtonUp=function(t,e){if((t=Math.floor(t))<0||t>=this.activeControllers.length)return!1;var i=d(t),n=p(t);if(!i||!n)return!1;var r=i[e]<50&&50<=n[e];if(r)this.lastButton=e;return r},C.prototype.HasGamepads=function(){return 0<this.activeControllers.length},C.prototype.CompareAxis=function(t,e,i,n){if(t=Math.floor(t),e=Math.floor(e),t<0||t>=this.activeControllers.length)return!1;var r=d(t);if(r){var o=r[e+l],s=0;if(e%2==0)s=r[e+l+1];else s=r[e+l-1];if(Math.sqrt(o*o+s*s)<=this.deadzone)o=0;return drama.do_cmp(o,i,n)}},C.prototype.OnAnyButtonDown=function(t){if((t=Math.floor(t))<0||t>=this.activeControllers.length)return!1;var e,i,n=d(t),r=p(t);if(!n||!r)return!1;for(e=0,i=n.length;e<i;e++)if(50<=n[e]&&r[e]<50)return this.lastButton=e,!0;return!1},C.prototype.OnAnyButtonUp=function(t){if((t=Math.floor(t))<0||t>=this.activeControllers.length)return!1;var e,i,n=d(t),r=p(t);if(!n||!r)return!1;for(e=0,i=n.length;e<i;e++)if(n[e]<50&&50<=r[e])return this.lastButton=e,!0;return!1},C.prototype.IsButtonIndexDown=function(t,e){if((t=Math.floor(t))<0||t>=this.activeControllers.length)return!1;var i=d(t);if(!i)return!1;if((e=Math.floor(e))<0||e>=i.length)return!1;var n=50<=i[e];if(n)this.lastButton=e;return n},C.prototype.OnButtonIndexDown=function(t,e){if((t=Math.floor(t))<0||t>=this.activeControllers.length)return!1;var i=d(t),n=p(t);if(!i||!n)return!1;if((e=Math.floor(e))<0||e>=i.length)return!1;var r=50<=i[e]&&n[e]<50;if(r)this.lastButton=e;return r},C.prototype.OnButtonIndexUp=function(t,e){if((t=Math.floor(t))<0||t>=this.activeControllers.length)return!1;var i=d(t),n=p(t);if(!i||!n)return!1;if((e=Math.floor(e))<0||e>=i.length)return!1;var r=i[e]<50&&50<=n[e];if(r)this.lastButton=e;return r},t.cnds=new C,t.acts=new function(){},O.prototype.GamepadCount=function(t){t.set_int(this.activeControllers.length)},O.prototype.GamepadID=function(t,e){if(!(e<0||e>=this.activeControllers.length))t.set_string(this.activeControllers[e].id);else t.set_string("")},O.prototype.GamepadAxes=function(t,e){if(!(e<0||e>=this.activeControllers.length)){var i,n,r=this.activeControllers[e].axes,o="";for(i=0,n=r.length;i<n;i++)o+="Axis "+i+": "+Math.round(100*r[i])+"\n";t.set_string(o)}else t.set_string("")},O.prototype.GamepadButtons=function(t,e){if(!(e<0||e>=this.activeControllers.length)){var i,n,r,o=this.activeControllers[e].buttons,s="";for(i=0,n=o.length;i<n;i++){if(void 0!==o[i].value)r=o[i].value;else r=o[i];s+="Button "+i+": "+Math.round(100*r)+"\n"}t.set_string(s)}else t.set_string("")},O.prototype.RawButton=function(t,e,i){if(e=Math.floor(e),i=Math.floor(i),!(e<0||e>=this.activeControllers.length)){var n=this.activeControllers[e].buttons;if(!(!n||i<0||i>=n.length))if(void 0!==n[i].value)t.set_float(n[i].value);else t.set_float(n[i]);else t.set_float(0)}else t.set_float(0)},O.prototype.RawAxis=function(t,e,i){if(e=Math.floor(e),i=Math.floor(i),!(e<0||e>=this.activeControllers.length)){var n=this.activeControllers[e].axes;if(!(!n||i<0||i>=n.length))t.set_float(n[i]);else t.set_float(0)}else t.set_float(0)},O.prototype.RawButtonCount=function(t,e){if(!((e=Math.floor(e))<0||e>=this.activeControllers.length))t.set_int(this.activeControllers[e].buttons.length);else t.set_int(0)},O.prototype.RawAxisCount=function(t,e){if(!((e=Math.floor(e))<0||e>=this.activeControllers.length))t.set_int(this.activeControllers[e].axes.length);else t.set_int(0)},O.prototype.Button=function(t,e,i){if(e=Math.floor(e),i=Math.floor(i),!(e<0||e>=this.activeControllers.length)){var n=d(e);if(!(!n||i<0||l<=i))t.set_float(n[i]);else t.set_float(0)}else t.set_float(0)},O.prototype.Axis=function(t,e,i){if(e=Math.floor(e),i=Math.floor(i),!(e<0||e>=this.activeControllers.length)){var n=d(e);if(!(!n||i<0||4<=i)){var r=n[i+l],o=0;if(i%2==0)o=n[i+l+1];else o=n[i+l-1];if(Math.sqrt(r*r+o*o)<=this.deadzone)r=0;t.set_float(r)}else t.set_float(0)}else t.set_float(0)},O.prototype.LastButton=function(t){t.set_int(this.lastButton)},t.exps=new O}(),assert2(drama,"drama namespace not created"),assert2(drama.plugins_,"drama.plugins_ not created"),drama.plugins_.Geolocation=function(t){this.runtime=t},function(){var t=drama.plugins_.Geolocation.prototype;t.Type=function(t){this.plugin=t,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){};var r="geolocation"in navigator;t.Instance=function(t){this.type=t,this.runtime=t.runtime};var e=t.Instance.prototype;function i(){}function n(){}function o(){}e.onCreate=function(){this.watchId=-1,this.errorMsg="",this.timestamp=0,this.latitude=0,this.longitude=0,this.altitude=0,this.accuracy=0,this.altitudeaccuracy=0,this.heading=0,this.speed=0;var i=this;this.updateFunction=function(t){i.timestamp=t.timestamp;var e=t.coords;i.latitude=e.latitude||0,i.longitude=e.longitude||0,i.altitude=e.altitude||0,i.accuracy=e.accuracy||0,i.altitudeaccuracy=e.altitudeAccuracy||0,i.heading=e.heading||0,i.speed=e.speed||0,i.runtime.trigger(drama.plugins_.Geolocation.prototype.cnds.OnUpdate,i)},this.errorFunction=function(t){i.errorMsg=t.message||"Unknown error",i.runtime.trigger(drama.plugins_.Geolocation.prototype.cnds.OnError,i)}},e.onDestroy=function(){},e.saveToJSON=function(){return{}},e.loadFromJSON=function(t){},e.getDebuggerValues=function(t){t.push({title:"Geolocation",properties:[{name:"Is watching",value:-1<this.watchId,readonly:!0},{name:"Last error message",value:this.errorMsg,readonly:!0},{name:"Latitude",value:this.latitude,readonly:!0},{name:"Longitude",value:this.longitude,readonly:!0},{name:"Altitude",value:this.altitude,readonly:!0},{name:"Accuracy",value:this.accuracy,readonly:!0},{name:"Altitude accuracy",value:this.altitudeaccuracy,readonly:!0},{name:"Heading",value:this.heading,readonly:!0},{name:"Speed",value:this.speed,readonly:!0},{name:"Timestamp",value:this.timestamp,readonly:!0}]})},i.prototype.IsSupported=function(){return r},i.prototype.IsWatching=function(){return-1<this.watchId},i.prototype.OnUpdate=function(){return!0},i.prototype.OnError=function(){return!0},t.cnds=new i,n.prototype.RequestLocation=function(t,e,i){if(r)if(this.runtime.isNWjs){var n=this;fetch("https://maps.googleapis.com/maps/api/browserlocation/json?browser=chromium&sensor=true").then(function(t){if(!t.ok)throw new Error("bad response");return t.json()}).then(function(t){if(!t||!t.location)throw new Error("no location");n.updateFunction({timestamp:Date.now(),coords:{latitude:t.location.lat,longitude:t.location.lng,accuracy:t.accuracy||0}})}).catch(function(){n.errorFunction()})}else navigator.geolocation.getCurrentPosition(this.updateFunction,this.errorFunction,{enableHighAccuracy:0!==t,timeout:1e3*e,maximumAge:1e3*i})},n.prototype.WatchLocation=function(t,e,i){if(r){if(-1<this.watchId)navigator.geolocation.clearWatch(this.watchId);this.watchId=navigator.geolocation.watchPosition(this.updateFunction,this.errorFunction,{enableHighAccuracy:0!==t,timeout:1e3*e,maximumAge:1e3*i})}},n.prototype.StopWatching=function(){if(-1<this.watchId)navigator.geolocation.clearWatch(this.watchId);this.watchId=-1},t.acts=new n,o.prototype.ErrorMessage=function(t){t.set_string(this.errorMsg)},o.prototype.Timestamp=function(t){t.set_float(this.timestamp)},o.prototype.Latitude=function(t){t.set_float(this.latitude)},o.prototype.Longitude=function(t){t.set_float(this.longitude)},o.prototype.Altitude=function(t){t.set_float(this.altitude)},o.prototype.Accuracy=function(t){t.set_float(this.accuracy)},o.prototype.AltitudeAccuracy=function(t){t.set_float(this.altitudeaccuracy)},o.prototype.Heading=function(t){t.set_float(this.heading)},o.prototype.Speed=function(t){t.set_float(this.speed)},t.exps=new o}(),assert2(drama,"drama namespace not created"),assert2(drama.plugins_,"drama.plugins_ not created"),drama.plugins_.googleplay=function(t){this.runtime=t},function(){var t=drama.plugins_.googleplay.prototype;t.Type=function(t){this.plugin=t,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){};var i="",c=!1,n=!1,u=!1,h="",d=null,p=null,r="",o="",s="",a="",l="",f=0,m=0,g="",y="",v=0,b="",_=null,w=null,x={},S="";t.Instance=function(t){this.type=t,this.runtime=t.runtime};var e=t.Instance.prototype;function I(t,e){var i=document.createElement("meta");i.name=t,i.content=e,document.head.appendChild(i)}function T(){}function C(){}function O(t){if("string"==typeof t)return t;else if("string"==typeof t.message)return t.message;else return"unknown"}function P(){}function E(t){if(!_)return null;if((t=Math.floor(t))<0||t>=_.length)return null;else return _[t]}function A(t){if(!w)return null;if((t=Math.floor(t))<0||t>=w.length)return null;else return w[t]}function k(t){var e=A(t);if(!e)return null;var i=e.id;if(!x.hasOwnProperty(i))return null;else return x[i]}e.onCreate=function(){if(i=this.properties[1],(d=this).runtime.isCordova){if(window.cordova&&window.cordova.plugins&&window.cordova.plugins.ConstructPlayGames)p=window.cordova.plugins.ConstructPlayGames,n=c=!0;if(!p)return;p.setCallback(function(t,e){if(t)d.runtime.trigger(drama.plugins_.googleplay.prototype.cnds.OnAccountError,d);else if(u=e)d.runtime.trigger(drama.plugins_.googleplay.prototype.cnds.OnSignedIn,d);else d.runtime.trigger(drama.plugins_.googleplay.prototype.cnds.OnSignedOut,d)}),p.silentSignIn()}else window.googlePlayLoadCallback=function(){if(c=!0,d.runtime.running_layout)d.runtime.trigger(drama.plugins_.googleplay.prototype.cnds.OnLoaded,d);else n=!0},window.googlePlaySigninCallback=function(t){if(t.status&&t.status.signed_in)u=!0,d.runtime.trigger(drama.plugins_.googleplay.prototype.cnds.OnSignedIn,d);else if("user_signed_out"===t.error)u=!1,h="user_signed_out",d.runtime.trigger(drama.plugins_.googleplay.prototype.cnds.OnSignedOut,d);else if("immediate_failed"===t.error)u=!1,h="immediate_failed",d.runtime.trigger(drama.plugins_.googleplay.prototype.cnds.OnAutoSignInFailed,d);else u=!1,h=t.error.toString(),d.runtime.trigger(drama.plugins_.googleplay.prototype.cnds.OnError,d)},I("google-signin-clientid",i),I("google-signin-cookiepolicy","single_host_origin"),I("google-signin-callback","googlePlaySigninCallback"),I("google-signin-scope","https://www.googleapis.com/auth/games"),t="https://apis.google.com/js/client.js?onload=googlePlayLoadCallback",(e=document.createElement("script")).type="text/javascript",e.async=!0,e.src=t,document.head.appendChild(e);var t,e;this.runtime.tickMe(this)},e.onDestroy=function(){},e.saveToJSON=function(){return{}},e.loadFromJSON=function(t){},e.onLayoutChange=function(){if(c)this.runtime.trigger(drama.plugins_.googleplay.prototype.cnds.OnLoaded,this);if(u)this.runtime.trigger(drama.plugins_.googleplay.prototype.cnds.OnSignedIn,this)},e.tick=function(){if(n)n=!1,this.runtime.trigger(drama.plugins_.googleplay.prototype.cnds.OnLoaded,this)},e.getDebuggerValues=function(t){},e.onDebugValueEdited=function(t,e,i){},T.prototype.OnLoaded=function(){return!0},T.prototype.IsLoaded=function(){return c},T.prototype.OnSignedIn=function(){return!0},T.prototype.OnSignedOut=function(){return!0},T.prototype.IsSignedIn=function(){return u},T.prototype.OnError=function(){return!0},T.prototype.OnPlayerDetails=function(){return!0},T.prototype.OnAutoSignInFailed=function(){return!0},T.prototype.OnScoreSubmitSuccess=function(){return!0},T.prototype.OnScoreSubmitFail=function(){return!0},T.prototype.OnHiScoreRequestSuccess=function(){return!0},T.prototype.OnHiScoreRequestFail=function(){return!0},T.prototype.OnAchievementsRequestSuccess=function(){return!0},T.prototype.OnAchievementsRequestFail=function(){return!0},T.prototype.CompareAchievementState=function(t,e){var i=A(t);if(!i)return!1;var n=i.achievementState;if(0===e)return"HIDDEN"===n;if(1===e)return"REVEALED"===n;if(2===e)return"UNLOCKED"===n;else return!1},T.prototype.OnAchievementsMetadataSuccess=function(){return!0},T.prototype.OnAchievementsMetadataFail=function(){return!0},T.prototype.OnAchievementRevealed=function(t){return S===t},T.prototype.OnAchievementUnlocked=function(t){return S===t},t.cnds=new T,C.prototype.RequestPlayerDetails=function(){if(u)if(this.runtime.isCordova)p.getPlayerData(function(t,e){if(t)return h=O(t),void d.runtime.trigger(drama.plugins_.googleplay.prototype.cnds.OnError,d);if(r=e.playerId||"",o=e.displayName||"",s=e.avatarImageUrl||"",e.name)a=e.name.givenName||"",l=e.name.familyName||"";else l=a="";d.runtime.trigger(drama.plugins_.googleplay.prototype.cnds.OnPlayerDetails,d)});else gapi.client.request({path:"/games/v1/players/me",callback:function(t){if(!t)return h="no_response",void d.runtime.trigger(drama.plugins_.googleplay.prototype.cnds.OnError,d);if(t.error)return h=O(t.error),void d.runtime.trigger(drama.plugins_.googleplay.prototype.cnds.OnError,d);if(r=t.playerId||"",o=t.displayName||"",s=t.avatarImageUrl||"",t.name)a=t.name.givenName||"",l=t.name.familyName||"";else l=a="";d.runtime.trigger(drama.plugins_.googleplay.prototype.cnds.OnPlayerDetails,d)}})},C.prototype.SignIn=function(){if(c&&!u)if(this.runtime.isCordova)p.signin();else gapi.auth.signIn({callback:window.googlePlaySigninCallback})},C.prototype.SignOut=function(){if(c&&u)if(this.runtime.isCordova)p.signout();else gapi.auth.signOut()},C.prototype.SubmitScore=function(t,e,i){if(c&&u){var n={leaderboardId:t,score:e};if(i)n.scoreTag=i;if(this.runtime.isCordova)p.submitScore(n,function(t){if(t)return h=t,void d.runtime.trigger(drama.plugins_.googleplay.prototype.cnds.OnScoreSubmitFail,d);d.runtime.trigger(drama.plugins_.googleplay.prototype.cnds.OnScoreSubmitSuccess,d)});else gapi.client.request({path:"/games/v1/leaderboards/"+t+"/scores",params:n,method:"post",callback:function(t){if(!t)return h="no_response",void d.runtime.trigger(drama.plugins_.googleplay.prototype.cnds.OnScoreSubmitFail,d);if(t.error)return h=O(t.error),void d.runtime.trigger(drama.plugins_.googleplay.prototype.cnds.OnScoreSubmitFail,d);else d.runtime.trigger(drama.plugins_.googleplay.prototype.cnds.OnScoreSubmitSuccess,d)}})}},C.prototype.RequestHiScores=function(t,e,i,n,r){if(c&&u){var o=0===e?"PUBLIC":"SOCIAL",s="ALL_TIME";if(1===i)s="WEEKLY";else if(2===i)s="DAILY";var a="scores";if(1===r)a="window";var l={leaderboardId:t,collection:o,timeSpan:s,maxResults:n};if(this.runtime.isCordova)l.type=a,p.getHiScores(l,function(t,e){if(t)return h=O(t),void d.runtime.trigger(drama.plugins_.googleplay.prototype.cnds.OnHiScoreRequestFail,d);if(f=parseInt(e.numScores,10)||0,e.playerScore)m=parseInt(e.playerScore.scoreValue,10)||0,g=e.playerScore.formattedScore||"",y=e.playerScore.scoreTag||"",v=parseInt(e.playerScore.scoreRank,10)||0,b=e.playerScore.formattedScoreRank||"";else v=m=0,b=y=g="";_=e.items,d.runtime.trigger(drama.plugins_.googleplay.prototype.cnds.OnHiScoreRequestSuccess,d)});else gapi.client.request({path:"/games/v1/leaderboards/"+t+"/"+a+"/"+o,params:l,callback:function(t){if(!t)return h="no_response",void d.runtime.trigger(drama.plugins_.googleplay.prototype.cnds.OnHiScoreRequestFail,d);if(t.error)return h=O(t.error),void d.runtime.trigger(drama.plugins_.googleplay.prototype.cnds.OnHiScoreRequestFail,d);if(f=parseInt(t.numScores,10)||0,t.playerScore)m=parseInt(t.playerScore.scoreValue,10)||0,g=t.playerScore.formattedScore||"",y=t.playerScore.scoreTag||"",v=parseInt(t.playerScore.scoreRank,10)||0,b=t.playerScore.formattedScoreRank||"";else v=m=0,b=y=g="";_=t.items,d.runtime.trigger(drama.plugins_.googleplay.prototype.cnds.OnHiScoreRequestSuccess,d)}})}},C.prototype.RequestAchievements=function(o){if(c&&u){var s="ALL";if(1===o)s="HIDDEN";else if(2===o)s="REVEALED";else if(3===o)s="UNLOCKED";if(this.runtime.isCordova)p.getAchievements({},function(t,e){if(t)return h=O(t),d.runtime.trigger(drama.plugins_.googleplay.prototype.cnds.OnAchievementsRequestFail,d),void d.runtime.trigger(drama.plugins_.googleplay.prototype.cnds.OnAchievementsMetadataFail,d);var i,n,r;for(w=e.items,x={},i=0,n=w.length;i<n;++i)r=w[i],x[r.id]={name:r.name,description:r.description,type:r.achievementType,totalSteps:r.totalSteps,revealedUrl:r.revealedIconUrl,unlockedUrl:r.unlockedIconUrl};if(s!==o)w=w.filter(function(t){return t.state===s});d.runtime.trigger(drama.plugins_.googleplay.prototype.cnds.OnAchievementsMetadataSuccess,d),d.runtime.trigger(drama.plugins_.googleplay.prototype.cnds.OnAchievementsRequestSuccess,d)});else gapi.client.request({path:"/games/v1/players/me/achievements",callback:function(t){if(!t)return h="no_response",void d.runtime.trigger(drama.plugins_.googleplay.prototype.cnds.OnAchievementsRequestFail,d);if(t.error)return h=O(t.error),void d.runtime.trigger(drama.plugins_.googleplay.prototype.cnds.OnAchievementsRequestFail,d);else return w=t.items,void d.runtime.trigger(drama.plugins_.googleplay.prototype.cnds.OnAchievementsRequestSuccess,d)}})}},C.prototype.RequestAchievementMetadata=function(){if(c&&u)if(this.runtime.isCordova)C.prototype.RequestAchievements.call(this,0);else gapi.client.request({path:"/games/v1/achievements",callback:function(t){if(!t)return h="no_response",void d.runtime.trigger(drama.plugins_.googleplay.prototype.cnds.OnAchievementsMetadataFail,d);if(t.error)return h=O(t.error),void d.runtime.trigger(drama.plugins_.googleplay.prototype.cnds.OnAchievementsMetadataFail,d);var e,i,n;x={};var r=t.items;for(e=0,i=r.length;e<i;++e)n=r[e],x[n.id]={name:n.name,description:n.description,type:n.achievementType,totalSteps:n.totalSteps,revealedUrl:n.revealedIconUrl,unlockedUrl:n.unlockedIconUrl};d.runtime.trigger(drama.plugins_.googleplay.prototype.cnds.OnAchievementsMetadataSuccess,d)}})},C.prototype.RevealAchievement=function(i){if(c&&u)if(this.runtime.isCordova){var t={achievementId:i};p.revealAchievement(t,function(t){if(t)return h=t,void d.runtime.trigger(drama.plugins_.googleplay.prototype.cnds.OnAchievementsRequestFail,d);var e=x[i];if(e&&"HIDDEN"==e.achievementState)e.achievementState="REVEALED";d.runtime.trigger(drama.plugins_.googleplay.prototype.cnds.OnAchievementRevealed,d)})}else gapi.client.request({path:"/games/v1/achievements/"+i+"/reveal",method:"post",callback:function(t){if(!t)return h="no_response",void d.runtime.trigger(drama.plugins_.googleplay.prototype.cnds.OnError,d);if(t.error)return h=O(t.error),void d.runtime.trigger(drama.plugins_.googleplay.prototype.cnds.OnError,d);else return S=i,void d.runtime.trigger(drama.plugins_.googleplay.prototype.cnds.OnAchievementRevealed,d)}})},C.prototype.UnlockAchievement=function(i){if(c&&u)if(this.runtime.isCordova){var t={achievementId:i};p.unlockAchievement(t,function(t){if(t)return h=t,void d.runtime.trigger(drama.plugins_.googleplay.prototype.cnds.OnError,d);var e=x[i];if(e&&"unlocked"!=e.achievementState)S=i,e.achievementState="unlocked",d.runtime.trigger(drama.plugins_.googleplay.prototype.cnds.OnAchievementUnlocked,d)})}else gapi.client.request({path:"/games/v1/achievements/"+i+"/unlock",method:"post",callback:function(t){if(!t)return h="no_response",void d.runtime.trigger(drama.plugins_.googleplay.prototype.cnds.OnError,d);if(t.error)return h=O(t.error),void d.runtime.trigger(drama.plugins_.googleplay.prototype.cnds.OnError,d);if(t.newlyUnlocked)S=i,d.runtime.trigger(drama.plugins_.googleplay.prototype.cnds.OnAchievementUnlocked,d)}})},C.prototype.IncrementAchievement=function(i,n){if(c&&u)if(this.runtime.isCordova){var t={achievementId:i,numSteps:n};p.incrementAchievement(t,function(t){if(t)return h=t,void d.runtime.trigger(drama.plugins_.googleplay.prototype.cnds.OnError,d);var e=x[i];if(e&&"unlocked"!=e.achievementState)if(e.currentSteps+=n,e.currentSteps+n>=e.totalSteps)S=i,e.currentSteps=e.totalSteps,e.achievementState="unlocked",d.runtime.trigger(drama.plugins_.googleplay.prototype.cnds.OnAchievementUnlocked,d)})}else gapi.client.request({path:"/games/v1/achievements/"+i+"/increment",method:"post",params:{stepsToIncrement:n},callback:function(t){if(!t)return h="no_response",void d.runtime.trigger(drama.plugins_.googleplay.prototype.cnds.OnError,d);if(t.error)return h=O(t.error),void d.runtime.trigger(drama.plugins_.googleplay.prototype.cnds.OnError,d);if(t.newlyUnlocked)S=i,d.runtime.trigger(drama.plugins_.googleplay.prototype.cnds.OnAchievementUnlocked,d)}})},C.prototype.SetStepsAchievement=function(i,n){if(c&&u)if(this.runtime.isCordova){var t={achievementId:i,numSteps:n};p.setStepsAchievement(t,function(t){if(t)return h=t,void d.runtime.trigger(drama.plugins_.googleplay.prototype.cnds.OnError,d);var e=x[i];if(e&&"unlocked"!=e.achievementState)if((e.currentSteps=n)>=e.totalSteps)S=i,e.currentSteps=e.totalSteps,e.achievementState="unlocked",d.runtime.trigger(drama.plugins_.googleplay.prototype.cnds.OnAchievementUnlocked,d)})}else gapi.client.request({path:"/games/v1/achievements/"+i+"/setStepsAtLeast",method:"post",params:{steps:n},callback:function(t){if(!t)return h="no_response",void d.runtime.trigger(drama.plugins_.googleplay.prototype.cnds.OnError,d);if(t.error)return h=O(t.error),void d.runtime.trigger(drama.plugins_.googleplay.prototype.cnds.OnError,d);if(t.newlyUnlocked)S=i,d.runtime.trigger(drama.plugins_.googleplay.prototype.cnds.OnAchievementUnlocked,d)}})},C.prototype.ShowLeaderboards=function(){if(c&&u)if(this.runtime.isCordova)p.showLeaderboards(function(t){if(t)h=t,d.runtime.trigger(drama.plugins_.googleplay.prototype.cnds.OnError,d)})},C.prototype.ShowLeaderboard=function(t){if(c&&u)if(this.runtime.isCordova){var e={leaderboardId:t};p.showLeaderboard(e,function(t){if(t)h=t,d.runtime.trigger(drama.plugins_.googleplay.prototype.cnds.OnError,d)})}},C.prototype.ShowAchievements=function(){if(c&&u)if(this.runtime.isCordova)p.showAchievements(function(t){if(t)h=t,d.runtime.trigger(drama.plugins_.googleplay.prototype.cnds.OnError,d)})},t.acts=new C,P.prototype.ErrorMessage=function(t){t.set_string(h)},P.prototype.MyID=function(t){t.set_string(r)},P.prototype.MyDisplayName=function(t){t.set_string(o)},P.prototype.MyAvatarUrl=function(t){t.set_string(s)},P.prototype.MyGivenName=function(t){t.set_string(a)},P.prototype.MyFamilyName=function(t){t.set_string(l)},P.prototype.HiScoreTotalCount=function(t){t.set_int(f)},P.prototype.HiScoreMyBest=function(t){t.set_int(m)},P.prototype.HiScoreMyBestTag=function(t){t.set_string(y)},P.prototype.HiScoreMyFormattedBest=function(t){t.set_string(g)},P.prototype.HiScoreMyBestRank=function(t){t.set_int(v)},P.prototype.HiScoreMyBestFormattedRank=function(t){t.set_string(b)},P.prototype.HiScoreCount=function(t){t.set_int(_?_.length||0:0)},P.prototype.HiScoreNameAt=function(t,e){var i=E(e);t.set_string(i&&i.player?i.player.displayName||"":"")},P.prototype.HiScoreRankAt=function(t,e){var i=E(e);t.set_int(i?parseInt(i.scoreRank,10)||0:0)},P.prototype.HiScoreAt=function(t,e){var i=E(e);t.set_int(i?parseInt(i.scoreValue,10)||0:0)},P.prototype.HiScoreTagAt=function(t,e){var i=E(e);t.set_string(i&&i.scoreTag?i.scoreTag||"":"")},P.prototype.HiScoreFormattedAt=function(t,e){var i=E(e);t.set_string(i&&i.formattedScore?i.formattedScore||"":"")},P.prototype.HiScoreFormattedRankAt=function(t,e){var i=E(e);t.set_string(i&&i.formattedScoreRank?i.formattedScoreRank||"":"")},P.prototype.AchievementsCount=function(t){t.set_int(w?w.length||0:0)},P.prototype.AchievementIDAt=function(t,e){var i=A(e);t.set_string(i?i.id||"":"")},P.prototype.AchievementStepsAt=function(t,e){var i=A(e);t.set_int(i?i.currentSteps||0:0)},P.prototype.AchievementNameAt=function(t,e){var i=k(e);t.set_string(i?i.name||"":"")},P.prototype.AchievementDescriptionAt=function(t,e){var i=k(e);t.set_string(i?i.description||"":"")},P.prototype.AchievementTypeAt=function(t,e){var i=k(e);t.set_string(i?(i.type||"").toLowerCase():"")},P.prototype.AchievementTotalStepsAt=function(t,e){var i=k(e);t.set_int(i?i.totalSteps||0:0)},P.prototype.AchievementRevealedIconURLAt=function(t,e){var i=k(e);t.set_string(i?i.revealedUrl||"":"")},P.prototype.AchievementUnlockedIconURLAt=function(t,e){var i=k(e);t.set_string(i?i.unlockedUrl||"":"")},t.exps=new P}(),assert2(drama,"drama namespace not created"),assert2(drama.plugins_,"drama.plugins_ not created"),drama.plugins_.iad=function(t){this.runtime=t},function(){var t=drama.plugins_.iad.prototype;t.Type=function(t){this.plugin=t,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t){this.type=t,this.runtime=t.runtime};var e=t.Instance.prototype,o=!1;function i(){}function n(){}e.onCreate=function(){if(window.plugins&&window.plugins.iAd){o=!0,this.iAd=window.plugins.iAd;var t=this;document.addEventListener("onReceiveAd",function(){t.runtime.trigger(drama.plugins_.iad.prototype.cnds.OnBannerReceived,t)},!1),document.addEventListener("onFailedToReceiveAd",function(){t.runtime.trigger(drama.plugins_.iad.prototype.cnds.OnBannerError,t)},!1)}else drama.logexport(" com.rjfun.cordova.plugin.iad plugin is required to show iAd ads with Cordova; other platforms are not supported")},e.onDestroy=function(){},e.saveToJSON=function(){return{}},e.loadFromJSON=function(t){},e.draw=function(t){},e.drawGL=function(t){},e.getDebuggerValues=function(t){},e.onDebugValueEdited=function(t,e,i){},i.prototype.OnBannerReceived=function(){return!0},i.prototype.OnBannerError=function(){return!0},t.cnds=new i,n.prototype.LoadBanner=function(t,e,i,n){if(o){var r=this;this.iAd.createBannerView({bannerAtTop:0!==t,overlap:0!==e,offsetTopBar:0!==i},function(){r.iAd.showAd(0!==n)},function(){r.runtime.trigger(drama.plugins_.iad.prototype.cnds.OnBannerError,r)})}},n.prototype.ShowBannerAd=function(t){if(o)this.iAd.showAd(0!==t)},t.acts=new n,t.exps=new function(){}}(),assert2(drama,"drama namespace not created"),assert2(drama.plugins_,"drama.plugins_ not created"),drama.plugins_.IAP=function(t){this.runtime=t},function(){var n=!1;function t(){var t=Windows.ApplicationModel.Store;if(this.currentApp=n?t.CurrentAppSimulator:t.CurrentApp,this.onpurchasesuccess=null,this.onpurchasefail=null,this.onconsumesuccess=null,this.onconsumefail=null,this.onstorelistingsuccess=null,this.onstorelistingfail=null,this.appName="",this.appFormattedPrice="",this.product_id_list=[],this.lastProductListings=null,n)new Windows.UI.Popups.MessageDialog("Note: IAP is in Test Mode, designed for testing purchases. Before publishing, be sure to set Test Mode to 'No' in the object's properties.").showAsync(),Windows.ApplicationModel.Package.current.installedLocation.getFileAsync("WindowsStoreProxy.xml").done(function(t){Windows.ApplicationModel.Store.CurrentAppSimulator.reloadSimulatorAsync(t).done(function(){console.log(" Test mode; loaded WindowsStoreProxy.xml")},function(t){console.log(" Error loading WindowsStoreProxy.xml: "+t)})},function(t){console.log(" Error loading WindowsStoreProxy.xml: "+t)})}function e(){if(this.onpurchasesuccess=null,this.onpurchasefail=null,this.onconsumesuccess=null,this.onconsumefail=null,this.onstorelistingsuccess=null,this.onstorelistingfail=null,this.product_id_list=[],this.existing_purchases=[],this.product_info={},this.isAvailable())blackberry.payment.developmentMode=n}function r(){this.onpurchasesuccess=null,this.onpurchasefail=null,this.onconsumesuccess=null,this.onconsumefail=null,this.onstorelistingsuccess=null,this.onstorelistingfail=null,this.product_id_list=[],this.owned_products=[],this.product_info={};var r=this;if(this.isAvailable()){if(n)amzn_wa.enableApiTester(amzn_wa_tester);amzn_wa.IAP.registerObserver({onSdkAvailable:function(t){if(t.isSandboxMode)alert("Note: running in test mode. Be sure to set 'Test mode' to 'No' before publishing.");amzn_wa.IAP.getPurchaseUpdates(amzn_wa.IAP.Offset.BEGINNING)},onItemDataResponse:function(t){var e,i,n;for(e=0,i=t.itemData.length;e<i;++e)n=t.itemData[e],r.product_info[n.sku]={title:n.title,description:n.description,price:n.price};if(r.onstorelistingsuccess)r.onstorelistingsuccess()},onPurchaseResponse:function(t){var e=t.receipt?t.receipt.sku:"";if(t.purchaseRequestStatus==amzn_wa.IAP.PurchaseStatus.SUCCESSFUL){if(-1===r.owned_products.indexOf(e))r.owned_products.push(e);if(r.onpurchasesuccess)r.onpurchasesuccess(e)}else if(r.onpurchasefail)r.onpurchasefail(e,"purchase was not successful")},onPurchaseUpdatesResponse:function(t){var e,i,n;for(e=0,i=t.receipts.length;e<i;++e)if((n=t.receipts[e]).sku&&-1===r.owned_products.indexOf(n.sku))r.owned_products.push(n.sku)}}),this.restorePurchases()}}function o(t){this.onpurchasesuccess=null,this.onpurchasefail=null,this.onconsumesuccess=null,this.onconsumefail=null,this.onstorelistingsuccess=null,this.onstorelistingfail=null,this.product_id_list=[],this.owned_products=[],this.product_info={},this.nextTransId=1,this.groupId=t;var u=this;if(this.isAvailable())window.tizen_iap.RegisterCallback({OnItemInformationListReceived:function(t,e,i){if(h(e)){for(var n=parseInt(i._startNumber),r=parseInt(i._endNumber)+1;n<r;++n){var o=i[n+"_itemId"]+"",s=i[n+"_itemGroupId"]+"",a=i[n+"_itemName"]+"",l=i[n+"_itemPrice"]+"",c=i[n+"_itemDescription"]+"";u.product_info[o]={title:a,groupId:s,price:l,description:c}}if(u.onstorelistingsuccess)u.onstorelistingsuccess()}else if(u.onstorelistingfail)u.onstorelistingfail()},OnPurchasedItemInformationListReceived:function(t,e,i){if(h(e))for(var n=parseInt(i._startNumber),r=parseInt(i._endNumber)+1;n<r;++n){var o=i[n+"_itemId"]+"";if(-1===u.owned_products.indexOf(o))u.owned_products.push(o)}},OnPurchaseItemInitialized:function(t,e,i){return!0},OnPurchaseItemFinished:function(t,e,i){var n=i._itemId;if(h(e)){if(-1===u.owned_products.indexOf(n))u.owned_products.push(n);if(u.onpurchasesuccess)u.onpurchasesuccess(n)}else if(u.onpurchasefail)u.onpurchasefail(n,"purchase failed")},OnCountryListReceived:function(t,e,i){}}),this.restorePurchases()}function h(t){return 0==parseInt(t,10)}function s(){this.onpurchasesuccess=null,this.onpurchasefail=null,this.onconsumesuccess=null,this.onconsumefail=null,this.onstorelistingsuccess=null,this.onstorelistingfail=null,this.product_id_list=[],this.product_info={},this.owned_products={},this.restorePurchases()}function a(){this.onpurchasesuccess=null,this.onpurchasefail=null,this.onconsumesuccess=null,this.onconsumefail=null,this.onstorelistingsuccess=null,this.onstorelistingfail=null,this.product_id_list=[],this.iap=window.store,this.iap.verbosity=this.iap.INFO,this.loaded=!1,this.isReady=!1,this.lastProductId="";var t=this;console.log("[C2 IAP] Start"),this.iap.ready(function(){if(t.isReady=!0,console.log("[C2 IAP] On store ready"),t.onstorelistingsuccess)t.onstorelistingsuccess()})}function l(){this.onpurchasesuccess=null,this.onpurchasefail=null,this.onconsumesuccess=null,this.onconsumefail=null,this.onstorelistingsuccess=null,this.onstorelistingfail=null,this.product_id_list=[],this.product_info={},this.owned_products={},this.iap=window.inappbilling;var t=this;this.iap.init(function(){window.setTimeout(function(){t.restorePurchases()},100)},function(t){drama.logexport("[C2] Error initialising Android IAP: "+t)},{showLog:n})}t.prototype.isAvailable=function(){return!0},t.prototype.supportsConsumables=function(){return!1},t.prototype.addProductIds=function(t){if(-1===t.indexOf(","))this.product_id_list.push(t);else this.product_id_list.push.apply(this.product_id_list,t.split(","))},t.prototype.isTrial=function(){return this.currentApp.licenseInformation.isTrial&&this.currentApp.licenseInformation.isActive},t.prototype.isLicensed=function(){return!this.currentApp.licenseInformation.isTrial&&this.currentApp.licenseInformation.isActive},t.prototype.hasProduct=function(t){if("app"===t)return this.isLicensed();var e=this.currentApp.licenseInformation.productLicenses;if(!e.hasKey(t))return!1;else return e.lookup(t).isActive},t.prototype.purchaseApp=function(){var e=this;this.currentApp.requestAppPurchaseAsync(!1).then(function(){if(console.log(" App purchased OK"),e.onpurchasesuccess)e.onpurchasesuccess("app")},function(t){if(console.log(" App purchase failed: "+t),e.onpurchasefail)e.onpurchasefail("app",t)})},t.prototype.purchaseProduct=function(e){if("app"!==e){var i=this,t=this.currentApp.licenseInformation.productLicenses;this.currentApp.requestProductPurchaseAsync(e,!1).then(function(){if(t.hasKey(e)&&t.lookup(e).isActive){if(console.log(" Product '"+e+"' purchased OK"),i.onpurchasesuccess)i.onpurchasesuccess(e)}else if(console.log(" Product '"+e+"' purchase failed (cancelled?)"),i.onpurchasefail)i.onpurchasefail(e,"")},function(t){if(console.log(" Product '"+e+"' purchase failed: "+t),i.onpurchasefail)i.onpurchasefail(e,t)})}else this.purchaseApp()},t.prototype.restorePurchases=function(){},t.prototype.requestStoreListing=function(){var e=this;this.currentApp.loadListingInformationAsync().then(function(t){if(console.log(" Listing information loaded"),e.appName=t.name,e.appFormattedPrice=t.formattedPrice,e.lastProductListings=t.productListings,e.onstorelistingsuccess)e.onstorelistingsuccess()})},t.prototype.getAppName=function(){return this.appName},t.prototype.getAppFormattedPrice=function(){return this.appFormattedPrice},t.prototype.getProductName=function(t){if(!this.lastProductListings)return"";if(this.lastProductListings.hasKey(t))return this.lastProductListings.lookup(t).name;else return""},t.prototype.getProductFormattedPrice=function(t){if("app"===t)return this.getAppFormattedPrice();if(!this.lastProductListings)return"";if(this.lastProductListings.hasKey(t))return this.lastProductListings.lookup(t).formattedPrice;else return""},e.prototype.isAvailable=function(){return"undefined"!=typeof blackberry},e.prototype.supportsConsumables=function(){return!1},e.prototype.addProductIds=function(t){if(-1===t.indexOf(","))this.product_id_list.push(t);else this.product_id_list.push.apply(this.product_id_list,t.split(","))},e.prototype.isTrial=function(){return!this.isLicensed()},e.prototype.isLicensed=function(){return this.hasProduct("app")},e.prototype.hasProduct=function(t){return-1!==this.existing_purchases.indexOf(t)},e.prototype.purchaseApp=function(){this.purchaseProduct("app")},e.prototype.purchaseProduct=function(e){if(this.isAvailable()){var i=this;blackberry.payment.purchase({digitalGoodID:e},function(t){if(-1===i.existing_purchases.indexOf(e))i.existing_purchases.push(e);if(i.onpurchasesuccess)i.onpurchasesuccess(e)},function(t){if(i.onpurchasefail)i.onpurchasefail(e,t.errorText)})}},e.prototype.restorePurchases=function(){if(this.isAvailable())blackberry.payment.getExistingPurchases(!0,function(t){var e,i,n;for(e=0,i=t.length;e<i;++e)if(n=t[e].digitalGoodID,-1===self.existing_purchases.indexOf(n))self.existing_purchases.push(n)},function(t){})},e.prototype.requestStoreListing=function(){if(this.isAvailable()){var t,e,r=this;for(t=0,e=this.product_id_list.length;t<e;++t)!function(e){blackberry.payment.getPrice({id:e,digitalGoodID:e},function(t){r.product_info[e]={price:t.price}},function(t){})}(this.product_id_list[t]);blackberry.payment.getExistingPurchases(!0,function(t){var e,i,n;for(e=0,i=t.length;e<i;++e)if(n=t[e].digitalGoodID,-1===r.existing_purchases.indexOf(n))r.existing_purchases.push(n);if(r.onstorelistingsuccess)r.onstorelistingsuccess()},function(t){if(r.onstorelistingfail)r.onstorelistingfail()})}},e.prototype.getAppName=function(){return this.getProductName("app")},e.prototype.getAppFormattedPrice=function(){return this.getProductFormattedPrice("app")},e.prototype.getProductName=function(t){return t},e.prototype.getProductFormattedPrice=function(t){if(this.product_info.hasOwnProperty(t))return this.product_info[t].price.toString();else return""},r.prototype.isAvailable=function(){return"undefined"!=typeof amzn_wa&&amzn_wa.IAP},r.prototype.supportsConsumables=function(){return!1},r.prototype.addProductIds=function(t){if(-1===t.indexOf(","))this.product_id_list.push(t);else this.product_id_list.push.apply(this.product_id_list,t.split(","))},r.prototype.isTrial=function(){return!this.isLicensed()},r.prototype.isLicensed=function(){return this.hasProduct("app")},r.prototype.hasProduct=function(t){return-1!==this.owned_products.indexOf(t)},r.prototype.purchaseApp=function(){this.purchaseProduct("app")},r.prototype.purchaseProduct=function(t){if(this.isAvailable())amzn_wa.IAP.purchaseItem(t)},r.prototype.restorePurchases=function(){if(this.isAvailable())amzn_wa.IAP.getPurchaseUpdates(amzn_wa.IAP.Offset.BEGINNING)},r.prototype.requestStoreListing=function(){if(this.isAvailable())amzn_wa.IAP.getItemData(this.product_id_list)},r.prototype.getAppName=function(){return this.getProductName("app")},r.prototype.getAppFormattedPrice=function(){return this.getProductFormattedPrice("app")},r.prototype.getProductName=function(t){if(this.product_info.hasOwnProperty(t))return this.product_info[t].title;else return""},r.prototype.getProductFormattedPrice=function(t){if(this.product_info.hasOwnProperty(t))return this.product_info[t].price.toString();else return""},o.prototype.isAvailable=function(){return void 0!==window.tizen_iap},o.prototype.supportsConsumables=function(){return!1},o.prototype.addProductIds=function(t){if(-1===t.indexOf(","))this.product_id_list.push(t);else this.product_id_list.push.apply(this.product_id_list,t.split(","))},o.prototype.isTrial=function(){return!this.isLicensed()},o.prototype.isLicensed=function(){return this.hasProduct("app")},o.prototype.hasProduct=function(t){return-1!==this.owned_products.indexOf(t)},o.prototype.purchaseApp=function(){this.purchaseProduct("app")},o.prototype.purchaseProduct=function(t){if(this.isAvailable()){if(!this.product_info.hasOwnProperty(t))if(this.onpurchasefail)this.onpurchasefail(t,"unrecognized product id");var e=this.product_info[t],i={};if(i._itemId=t,i._itemGroupId=e.groupId,i._transactionId=this.nextTransId++,n)i._mode=1,i._mcc="",i._mnc="";else i._mode=0;i._deviceModel="tizen",window.tizen_iap.RequestPurchaseItem(i)}},o.prototype.restorePurchases=function(){var t={};if(t._transactionId=this.nextTransId++,t._startNumber=1,t._endNumber=100,t._itemGroupId=this.groupId,n)t._mode=1,t._mcc="",t._mnc="";else t._mode=0;t._deviceModel="tizen",window.tizen_iap.RequestPurchasedItemInformationList(t)},o.prototype.requestStoreListing=function(){var t={};if(t._transactionId=this.nextTransId++,t._startNumber=1,t._endNumber=100,t._itemGroupId=this.groupId,n)t._mode=1,t._mcc="",t._mnc="";else t._mode=0;t._deviceModel="tizen",window.tizen_iap.RequestItemInformationList(t)},o.prototype.getAppName=function(){return this.getProductName("app")},o.prototype.getAppFormattedPrice=function(){return this.getProductFormattedPrice("app")},o.prototype.getProductName=function(t){if(this.product_info.hasOwnProperty(t))return this.product_info[t].title;else return""},o.prototype.getProductFormattedPrice=function(t){if(this.product_info.hasOwnProperty(t))return this.product_info[t].price;else return""},s.prototype.isAvailable=function(){return!0},s.prototype.supportsConsumables=function(){return!1},s.prototype.addProductIds=function(t){if(-1===t.indexOf(","))this.product_id_list.push(t);else this.product_id_list.push.apply(this.product_id_list,t.split(","))},s.prototype.isTrial=function(){return!this.isLicensed()},s.prototype.isLicensed=function(){return this.hasProduct("app")},s.prototype.hasProduct=function(t){return this.owned_products.hasOwnProperty(t)&&this.owned_products[t]},s.prototype.purchaseApp=function(){this.purchaseProduct("app")},s.prototype.purchaseProduct=function(e){var i=this;google.payments.inapp.buy({parameters:{env:"prod"},sku:e,success:function(t){if(i.owned_products[e]=!0,i.onpurchasesuccess)i.onpurchasesuccess(e)},failure:function(t){if(i.onpurchasefail)i.onpurchasefail(e,t.response.errorType.toString())}})},s.prototype.restorePurchases=function(){var o=this;google.payments.inapp.getPurchases({parameters:{env:"prod"},success:function(t){var e,i,n,r=t.response.details;for(e=0,i=r.length;e<i;++e)if("ACTIVE"===(n=r[e]).state)o.owned_products[n.sku]=!0},failure:function(t){console.log("Failed to restore purchases",t)}})},s.prototype.requestStoreListing=function(){var o=this;google.payments.inapp.getSkuDetails({parameters:{env:"prod"},success:function(t){var e,i,n,r=t.response.details.inAppProducts;for(e=0,i=r.length;e<i;++e)if("ACTIVE"===(n=r[e]).state)o.product_info[n.sku]={title:n.localeData[0].title,price:(parseFloat(n.prices[0].valueMicros)/1e3).toString()};if(o.onstorelistingsuccess)o.onstorelistingsuccess()},failure:function(t){if(o.onstorelistingfail)o.onstorelistingfail()}})},s.prototype.getAppName=function(){return this.getProductName("app")},s.prototype.getAppFormattedPrice=function(){return this.getProductFormattedPrice("app")},s.prototype.getProductName=function(t){if(this.product_info.hasOwnProperty(t))return this.product_info[t].title;else return""},s.prototype.getProductFormattedPrice=function(t){if(this.product_info.hasOwnProperty(t))return this.product_info[t].price;else return""},a.prototype.loadProductIds=function(){console.log("[C2 IAP] Loading product IDs");var t,e,i=this;for(t=0,e=this.product_id_list.length;t<e;++t)console.log("[C2 IAP] Registering product ID: "+this.product_id_list[t]),this.iap.register({id:this.product_id_list[t],alias:this.product_id_list[t],type:this.iap.NON_CONSUMABLE});this.iap.when("product").approved(function(t){console.log("[C2 IAP] Product approved, finishing... ["+t.alias+"]"),t.finish()}),this.iap.when("product").owned(function(t){if(console.log("[C2 IAP] Product owned, calling 'On purchase success' ["+t.alias+"]"),i.onpurchasesuccess)i.onpurchasesuccess(i.lastProductId)}),this.iap.when("product").error(function(t){if(console.log("[C2 IAP] Product error"),i.onpurchasefail)i.onpurchasefail(i.lastProductId,"Error "+t.code+": "+t.message)}),this.iap.error(function(t){console.log("[C2 IAP] Error: "+t.code+": "+t.message)})},a.prototype.isAvailable=function(){return!0},a.prototype.supportsConsumables=function(){return!1},a.prototype.addProductIds=function(t){if(-1===t.indexOf(","))this.product_id_list.push(t);else this.product_id_list.push.apply(this.product_id_list,t.split(","))},a.prototype.isTrial=function(){return!this.isLicensed()},a.prototype.isLicensed=function(){return this.hasProduct("app")},a.prototype.hasProduct=function(t){var e=this.iap.get(t);return e&&e.owned},a.prototype.purchaseApp=function(){this.purchaseProduct("app")},a.prototype.purchaseProduct=function(t){if(this.loaded)console.log("[C2 IAP] Purchasing '"+t+"'..."),this.lastProductId=t,this.iap.order(t)},a.prototype.restorePurchases=function(){if(this.loaded)console.log("[C2 IAP] Restoring purchases..."),this.iap.refresh()},a.prototype.requestStoreListing=function(){if(console.log("[C2 IAP] Requesting store listing..."),!this.loaded)this.loadProductIds(),this.loaded=!0;console.log("[C2 IAP] Requesting store listing: 'refresh'..."),this.iap.refresh()},a.prototype.getAppName=function(){return this.getProductName("app")},a.prototype.getAppFormattedPrice=function(){return this.getProductFormattedPrice("app")},a.prototype.getProductName=function(t){var e=this.iap.get(t);if(!e)return"<unknown product id>";else return e.title},a.prototype.getProductFormattedPrice=function(t){var e=this.iap.get(t);if(!e)return"<unknown product id>";else return e.price},l.prototype.isAvailable=function(){return!0},l.prototype.supportsConsumables=function(){return!1},l.prototype.addProductIds=function(t){if(-1===t.indexOf(","))this.product_id_list.push(t);else this.product_id_list.push.apply(this.product_id_list,t.split(","))},l.prototype.isTrial=function(){return!this.isLicensed()},l.prototype.isLicensed=function(){return this.hasProduct("app")},l.prototype.hasProduct=function(t){return this.owned_products.hasOwnProperty(t)&&this.owned_products[t]},l.prototype.purchaseApp=function(){this.purchaseProduct("app")},l.prototype.purchaseProduct=function(e){var i=this;this.iap.buy(function(t){if(i.owned_products[e]=!0,i.onpurchasesuccess)i.onpurchasesuccess(e)},function(t){if(i.onpurchasefail)i.onpurchasefail(e,"purchase failed")},e)},l.prototype.restorePurchases=function(){var r=this;this.iap.getPurchases(function(t){var e,i,n;for(e=0,i=t.length;e<i;++e)n=t[e],r.owned_products[n.productId]=!0},function(t){drama.logexport("[C2] Android IAP restore purchases error: "+t)})},l.prototype.requestStoreListing=function(){var n=this;this.iap.getAvailableProducts(function(t){var e,i;for(e in t)i=t[e],n.product_info[i.productId]=i;if(n.onstorelistingsuccess)n.onstorelistingsuccess()},function(t){if(n.onstorelistingfail)n.onstorelistingfail()})},l.prototype.getAppName=function(){return this.getProductName("app")},l.prototype.getAppFormattedPrice=function(){return this.getProductFormattedPrice("app")},l.prototype.getProductName=function(t){if(this.product_info.hasOwnProperty(t))return this.product_info[t].title;else return""},l.prototype.getProductFormattedPrice=function(t){if(this.product_info.hasOwnProperty(t))return this.product_info[t].price;else return""};var i=drama.plugins_.IAP.prototype;i.Type=function(t){this.plugin=t,this.runtime=t.runtime},i.Type.prototype.onCreate=function(){},i.Instance=function(t){this.type=t,this.runtime=t.runtime};var c=i.Instance.prototype;function u(){}function d(){}function p(){}c.onCreate=function(){if(this.store=null,n=this.properties[0],this.tizenGroupId=this.properties[1],this.productId="",this.errorMessage="",this.runtime.isWinJS)this.store=new t;else if(this.runtime.isBlackberry10)this.store=new e;else if(this.runtime.isAmazonWebApp)this.store=new r;else if(this.runtime.isTizen)this.store=new o(this.tizenGroupId);else if(this.runtime.isCordova){if(this.runtime.isiOS&&window.store)this.store=new a;else if(this.runtime.isAndroid&&window.inappbilling)this.store=new l}else if(window.google&&window.google.payments&&window.google.payments.inapp)this.store=new s;var i=this;if(this.store)this.store.onpurchasesuccess=function(t){i.productId=t,i.errorMessage="",i.runtime.trigger(drama.plugins_.IAP.prototype.cnds.OnPurchaseSuccess,i),i.runtime.trigger(drama.plugins_.IAP.prototype.cnds.OnAnyPurchaseSuccess,i)},this.store.onpurchasefail=function(t,e){i.productId=t,i.errorMessage=e,i.runtime.trigger(drama.plugins_.IAP.prototype.cnds.OnPurchaseFail,i),i.runtime.trigger(drama.plugins_.IAP.prototype.cnds.OnAnyPurchaseFail,i)},this.store.onstorelistingsuccess=function(){i.runtime.trigger(drama.plugins_.IAP.prototype.cnds.OnStoreListingSuccess,i)},this.store.onstorelistingfail=function(){i.runtime.trigger(drama.plugins_.IAP.prototype.cnds.OnStoreListingFail,i)}},c.onDestroy=function(){},c.saveToJSON=function(){return{}},c.loadFromJSON=function(t){},c.getDebuggerValues=function(t){},c.onDebugValueEdited=function(t,e,i){},u.prototype.OnPurchaseSuccess=function(t){return t===this.productId},u.prototype.OnAnyPurchaseSuccess=function(){return!0},u.prototype.OnPurchaseFail=function(t){return t===this.productId},u.prototype.OnAnyPurchaseFail=function(){return!0},u.prototype.OnStoreListingSuccess=function(){return!0},u.prototype.OnStoreListingFail=function(){return!0},u.prototype.HasProduct=function(t){return this.store&&this.store.hasProduct(t)},u.prototype.IsAvailable=function(){return this.store&&this.store.isAvailable()},u.prototype.IsAppPurchased=function(){return this.store&&this.store.isLicensed()},i.cnds=new u,d.prototype.AddProductID=function(t){if(this.store)this.store.addProductIds(t)},d.prototype.PurchaseProduct=function(t){if(this.store)this.store.purchaseProduct(t)},d.prototype.PurchaseApp=function(){if(this.store)this.store.purchaseApp()},d.prototype.RestorePurchases=function(){if(this.store)this.store.restorePurchases()},d.prototype.RequestStoreListing=function(){if(this.store)this.store.requestStoreListing()},i.acts=new d,p.prototype.ProductName=function(t,e){t.set_string(this.store?this.store.getProductName(e):"")},p.prototype.ProductPrice=function(t,e){t.set_string(this.store?this.store.getProductFormattedPrice(e):"")},p.prototype.AppName=function(t){t.set_string(this.store?this.store.getAppName():"")},p.prototype.AppPrice=function(t){t.set_string(this.store?this.store.getAppFormattedPrice():"")},p.prototype.ProductID=function(t){t.set_string(this.productId)},p.prototype.ErrorMessage=function(t){t.set_string(this.errorMessage)},i.exps=new p}(),void 0===window)window=void 0===window?"undefined"==typeof global?"undefined"==typeof self?void 0:self:global:window;var __CONSTRUCT2_RUNTIME2__=!0,__CONSTRUCT3_RUNTIME2__=!1,__CONSTRUCT3_RUNTIME3__=!1,__DEBUG__=!1;function _typeof2(t){if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator)_typeof2=function(t){return typeof t};else _typeof2=function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};return _typeof2(t)}function _typeof(t){if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator)_typeof=function(t){return typeof t};else _typeof=function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};return _typeof(t)}function _typeof(t){if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator)_typeof=function(t){return typeof t};else _typeof=function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};return _typeof(t)}function _typeof(t){if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator)_typeof=function(t){return typeof t};else _typeof=function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};return _typeof(t)}assert2(drama,"drama namespace not created"),assert2(drama.plugins_,"drama.plugins_ not created"),drama.plugins_.ValerypopoffJSPlugin=function(t){this.runtime=t},function(){var pluginProto=drama.plugins_.ValerypopoffJSPlugin.prototype;pluginProto.Type=function(t){this.plugin=t,this.runtime=t.runtime};var typeProto=pluginProto.Type.prototype;typeProto.onCreate=function(){},pluginProto.Instance=function(t){this.type=t,this.runtime=t.runtime};var instanceProto=pluginProto.Instance.prototype;instanceProto.onCreate=function(){function e(t,e){if(void 0===document)t.ShowError({debug_caller:"Including '"+e+"' script to the page",caller_name:"Including '"+e+"' script to the page",error_message:"'document' is not defined. You're probably launching the game in a Worker. Workers are not supported yet. Export project with 'Use worker' option unchecked in the 'Advanced' section of the 'Project properties' panel."})}if(this.returnValue=void 0,this.sciptsToLoad=0,this.Aliases={},this.construct_compare_function_prefix="ConstructCompare_",this.AliasDotpartsCache={count:0,max_count:4096,Dotparts:{},AliasNames:{},AliasTrailers:{},IsAlias:{}},this.NonAliasDotpartsCache={count:0,max_count:2048,Dotparts:{}},""!=this.properties[0]){var i=[];if(__CONSTRUCT2_RUNTIME2__)i=this.properties[0].split(";");else i=this.properties[0].split(/[;\n\r]/);for(var n=0;n<i.length;n++)if(i[n]=i[n].trim(),0!=i[n].length){if(this.sciptsToLoad++,__CONSTRUCT2_RUNTIME2__)e(this,i[n]);if(__CONSTRUCT3_RUNTIME2__)e(this,this.runtime.getLocalFileUrl(i[n]));if(__CONSTRUCT3_RUNTIME3__){var r=this;if(void 0!==r._runtime.GetAssetManager().LoadProjectFileUrl)r._runtime.GetAssetManager().LoadProjectFileUrl(i[n]).then(function(t){e(r,t)},function(t){r.ShowError({debug_caller:"Including '"+i[n]+"' script to the page",caller_name:"Including '"+i[n]+"' script to the page",error_message:t.message})}).catch(function(t){r.ShowError({debug_caller:"Including '"+i[n]+"' script to the page",caller_name:"Including '"+i[n]+"' script to the page",error_message:t.message})});else e(r,r._runtime.GetAssetManager().GetLocalFileUrl(i[n]))}}}},instanceProto.saveToJSON=function(){return{}},instanceProto.loadFromJSON=function(t){},instanceProto.getDebuggerValues=function(t){};var IsValidIdentifier=function(t){return/^[$A-Z_][0-9A-Z_$]*$/i.test(t)},DotStringToDotArray=function n(o){for(var s=[],t=0,e=0,i=0,r=o.length;i<r;i++)if("["!=o[i])if("]"!=o[i]){if("."==o[i]&&t==e)s.push(i)}else e++;else t++;var a=[],l=s.length-1;if(s.forEach(function(t,e,i){var n=s[e-1],r=o.substring(n+1,t);if(""!=r)a.push(r);if(e==l)if(""!=(r=o.substring(t+1)))a.push(r)}),0==a.length)a.push(o);return a.forEach(function(t,e,i){if("["==t[0])i[e]=n(t.substring(1,t.length-1))}),a},HashtagParamsToCode=function(t,i){return t=t.replace(/#[0-9]+/g,function(t){var e=i[t.substr(1)];if("string"==typeof e)return"'"+e+"'";else return e})},MakeCallString=function(t,e){var i=t+"(";if(e)for(var n=0,r=e.length;n<r;++n){if("string"==typeof e[n])i=i+"'"+e[n]+"'";else i+=e[n];if(n!=e.length-1)i+=","}return i+=")"},InstanceFunctionsObject={Value:function(t,e){e.splice(0,1)},CallJSfunction:function(e,i,t,n,r){if(void 0===t)t=!0;if(void 0===n)n="'Call function' action";var o;if(void 0===r)o=this.ParseJS(e,!0,n);else o=r;if(!o.error){var s;if(!(0<=e.indexOf("(")||0<=e.indexOf(")"))){var a;try{a=o.end.apply(o.context,i)}catch(t){if(t instanceof TypeError&&0<=t.message.indexOf("apply")&&0<=t.message.indexOf("undefined"))t.message=e+" is undefined";if(s={debug_caller:"CallJSfunction",caller_name:n,error_message:t.message},o.alias_found)s["show-alias-expression"]=!0,s.alias_expression=MakeCallString(o.trimmed_code,i),s["show-code"]=!0,s.code=MakeCallString(this.Aliases[o.alias_name].js+o.alias_trailer,i);else s["show-code"]=!0,s.code=MakeCallString(o.trimmed_code,i);return void this.ShowError(s)}if(t)this.returnValue=a;return a}else{if(s={debug_caller:"CallJSfunction",caller_name:n,error_message:"'"+o.trimmed_code+"' must be a function name, not a function call. Remove parentheses."},o.alias_found)s["show-alias-expression"]=!0,s.alias_expression=o.trimmed_code;this.ShowError(s)}}},CallAlias:function(t,e,i,n){if(void 0===i)i=!0;if(void 0===n)n="'Call alias' action";var r=this.ParseJS(t,!0,n);if(!r.error){return this.CallJSfunction(this.Aliases[r.alias_name].js+r.alias_trailer,e,i,n,r)}},ShowError:function(t){var e="ValerypopoffJS plugin: Error in "+t.caller_name+"\n";if(e+="--------------------- \n",__DEBUG__)e+="DEBUG CALLER: "+t.debug_caller+"\n",e+="--------------------- \n";if(t["show-alias-expression"])e+="Alias expression: "+t.alias_expression+"\n",e+="--------------------- \n";if(t["show-code"])e+="JS code: "+t.code+"\n",e+="--------------------- \n";e+=t.error_message,console.error(e)},Resolve:function(t,e,i,n,r){for(var o,s=window,a=s,l="",c=0,u=t.length;c<u;c++){if(l=t[c],"object"===_typeof(l)){var h=this.Resolve(l,e,i,n,r);if(h.error)return{error:!0};l=h.end;try{a=a[l]}catch(t){if(o={debug_caller:"Resolve",caller_name:e,error_message:t.message,"show-code":!0,code:i},n)o["show-alias-expression"]=!0,o.code=this.Aliases[n].js+r,o.alias_expression=i;return this.ShowError(o),{error:!0}}}else try{if(s==window)if(!IsValidIdentifier(l)){if("'"==l[0])l=l.substring(1,l.length-1);a=l}else a=a[l];else a=a[l]}catch(t){if(o={debug_caller:"Resolve",caller_name:e,error_message:t.message,"show-code":!0,code:i},n)o["show-alias-expression"]=!0,o.code=this.Aliases[n].js+r,o.alias_expression=i;return this.ShowError(o),{error:!0}}if(c<u-1)s=a}return{error:!1,context:s,end:a,endname:l}},ParseJS:function(t,e,i){var n,r,o,s=!1,a=[],l=t.trim().replace(/\s*([.[\]])\s*/g,"$1");if((o=this.AliasDotpartsCache).Dotparts[l]){if(a=o.Dotparts[l],o.IsAlias[l])s=!0,n=o.AliasNames[l],r=o.AliasTrailers[l]}else{if(o.count>=o.max_count)for(var c in o.Dotparts){if(delete o.Dotparts[c],o.IsAlias[c])delete o.AliasNames[c],delete o.AliasTrailers[c],delete o.IsAlias[c];if(o.count--,o.count<=o.max_count)break}if(o.Dotparts[l]=a,s)o.AliasNames[l]=n,o.AliasTrailers[l]=r,o.IsAlias[l]=!0;o.count++}var u=this.Resolve(a,i,l,n,r);return{error:u.error,end:u.end,endname:u.endname,context:u.context,trimmed_code:l,alias_found:s,alias_name:n,alias_trailer:r}}};for(var o in InstanceFunctionsObject)instanceProto[o]=InstanceFunctionsObject[o];function Cnds(){}var CndsObject={C2CompareFunctionReturnValue:function(t,e,i,n){switch(e){case 2:e=4;break;case 3:e=5;break;case 4:e=2;break;case 5:e=3}return this.CNDS.CompareFunctionReturnValue.call(this,i,n,e,t)},C2CompareAliasCallReturnValue:function(t,e,i,n){switch(e){case 2:e=4;break;case 3:e=5;break;case 4:e=2;break;case 5:e=3}return this.CNDS.CompareAliasCallReturnValue.call(this,i,n,e,t)},C2CompareExecReturnWithParams:function(t,e,i,n){switch(e){case 2:e=4;break;case 3:e=5;break;case 4:e=2;break;case 5:e=3}return this.CNDS.CompareExecReturnWithParams.call(this,i,n,e,t)},C2CompareValue:function(t,e,i,n){switch(e){case 2:e=4;break;case 3:e=5;break;case 4:e=2;break;case 5:e=3}return this.CNDS.CompareValue.call(this,i,n,e,t)},CompareExecReturnWithParams:function CompareExecReturnWithParams(code_,params_,cmp_,value_){var ret,caller_name_="'Compare JS code Completion value' condition";if(params_.length)code_=HashtagParamsToCode(code_,params_);try{ret=eval(code_)}catch(t){var info={debug_caller:"CompareExecReturnWithParams",caller_name:caller_name_,error_message:t.message,"show-code":!0,code:code_};return void this.ShowError(info)}if("boolean"==typeof ret)ret=ret?1:0;return drama.do_cmp(ret,cmp_,value_)},CompareFunctionReturnValue:function(t,e,i,n){var r;if("boolean"==typeof(r=this.CallJSfunction(t,e,!1,"'Compare Function return value' condition")))r=r?1:0;return drama.do_cmp(r,i,n)},CompareStoredReturnValue:function(t,e){var i=this.returnValue;if("boolean"==typeof i)i=i?1:0;return drama.do_cmp(i,t,e)},AllScriptsLoaded:function(){return this.sciptsToLoad<=0},CompareValue:function(t,e,i,n){var r;if("boolean"==typeof(r=this.Value("'Compare Value' condition",[].concat(t,e))))r=r?1:0;return drama.do_cmp(r,i,n)},CompareAliasValue:function(t,e,i){var n,r="'Compare alias' condition",o=this.ParseJS(t,!0,"'Set alias' action");if(!o.alias_found)return n={debug_caller:"CompareAliasValue",caller_name:r,error_message:"No such alias '"+t+"'"},void this.ShowError(n);if(!o.error){var s=o.context[this.construct_compare_function_prefix+o.endname];if(s&&"object"===_typeof(o.context))try{return s.call(o.context,e,i)}catch(t){n={debug_caller:"CompareAliasValue",caller_name:r,"show-alias-expression":!0,alias_expression:o.trimmed_code,error_message:"Error in user defined '"+this.construct_compare_function_prefix+o.endname+"' function: "+t.message},this.ShowError(n)}else{var a=o.end;if("boolean"==typeof a)a=a?1:0;return drama.do_cmp(a,e,i)}}},CompareAliasCallReturnValue:function(t,e,i,n){var r;if("boolean"==typeof(r=this.CallAlias(t,e,!1,"'Compare Alias Call return value' condition")))r=r?1:0;return drama.do_cmp(r,i,n)}};for(var k in CndsObject)Cnds.prototype[k]=CndsObject[k];function Acts(){}pluginProto.cnds=new Cnds;var ActsObject={ExecuteJSWithParams:function ExecuteJSWithParams(code,params_){var caller_name_="'Execute JS code' action";this.returnValue=void 0,code=code.replace(/#[0-9]+/g,function(t){var e=params_[t.substr(1)];if("string"==typeof e)return"'"+e+"'";else return e});try{this.returnValue=eval(code)}catch(t){this.ShowError({debug_caller:"ExecuteJSWithParams",caller_name:caller_name_,"show-code":!0,code:code,error_message:t.message})}},CallJSfunction:function(t,e,i,n,r){this.CallJSfunction(t,e,i,n,r)},SetValue:function(e,i){var n="'Set value' action",r=this.ParseJS(e,!0,n);if(!r.error)try{r.context[r.endname]=i}catch(t){var o=e+"=";if("string"==typeof i)o=o+"'"+i+"'";else o+=i;var s={debug_caller:"SetValue",caller_name:n,"show-alias-expression":r.alias_found,alias_expression:r.trimmed_code,"show-code":!0,code:o,error_message:t.message};this.ShowError(s)}},Call:function(t,e,i,n){this.CallJSfunction(t,e,!0,"'Call' action")},InitAlias:function(t,e){var i,n="'Init alias' action";if(t=t.trim(),0==(e=e.trim()).length)return i={debug_caller:"InitAlias",caller_name:n,error_message:"Javascript string of alias '"+t+"' must not be empty."},void this.ShowError(i);if(0<=t.indexOf(".")||0<=t.indexOf("[")||0<=t.indexOf("]"))return i={debug_caller:"InitAlias",caller_name:n,error_message:"Alias name must not contain '.', '[' or ']' signs: '"+t+"'"},void this.ShowError(i);if(null!=this.Aliases[t])return i={debug_caller:"InitAlias",caller_name:n,error_message:"Alias '"+t+"' already exists"},void this.ShowError(i);var r={};r.js=e,r.dotstring=e.split("[").join(".["),this.Aliases[t]=r},SetAlias:function(e,i){var n="'Set alias' action",r=this.ParseJS(e,!0,"'Set alias' action");if(r.alias_found){if(!r.error)try{r.context[r.endname]=i}catch(t){var o=e+"=";if("string"==typeof i)o=o+"'"+i+"'";else o+=i;s={debug_caller:"SetAlias",caller_name:n,"show-alias-expression":!0,alias_expression:r.trimmed_code,"show-code":!0,code:o,error_message:t.message},this.ShowError(s)}}else{var s={debug_caller:"SetAlias",caller_name:n,error_message:"No such alias '"+r.trimmed_code+"'"};this.ShowError(s)}},CallAlias:function(t,e,i,n){this.CallAlias(t,e,i,n)}};for(var a in ActsObject)Acts.prototype[a]=ActsObject[a];function Exps(){}pluginProto.acts=new Acts;var ExpsObject={JSCodeValue:function JSCodeValue(){var params_=Array.prototype.slice.call(arguments),ret;if(__CONSTRUCT3_RUNTIME3__)ret={set_int:function(){},set_float:function(){},set_string:function(){},set_any:function(){}};else{ret=params_[0];for(var i=0;i<params_.length-1;i++)params_[i]=params_[i+1];params_.pop()}var code_=params_[0],caller_name_="'JSCodeValue' expression",jscode=code_,jsret;if(params_.splice(0,1),params_.length)jscode=HashtagParamsToCode(jscode,params_);try{jsret=eval(jscode)}catch(t){return this.ShowError({debug_caller:"JSCodeValue",caller_name:caller_name_,"show-code":!0,code:jscode,error_message:t.message}),void ret.set_any(void 0)}if("boolean"==typeof jsret){if(ret.set_any(jsret?1:0),__CONSTRUCT3_RUNTIME3__)return jsret?1:0}else if(ret.set_any(jsret),__CONSTRUCT3_RUNTIME3__)return jsret},StoredReturnValue:function(){var t,e=Array.prototype.slice.call(arguments);if(__CONSTRUCT3_RUNTIME3__)t={set_int:function(){},set_float:function(){},set_string:function(){},set_any:function(){}};else{t=e[0];for(var i=0;i<e.length-1;i++)e[i]=e[i+1];e.pop()}if("boolean"==typeof this.returnValue){if(t.set_any(this.returnValue?1:0),__CONSTRUCT3_RUNTIME3__)return this.returnValue?1:0}else if(t.set_any(this.returnValue),__CONSTRUCT3_RUNTIME3__)return this.returnValue},FunctionReturnValue:function(){var t,e=Array.prototype.slice.call(arguments);if(__CONSTRUCT3_RUNTIME3__)t={set_int:function(){},set_float:function(){},set_string:function(){},set_any:function(){}};else{t=e[0];for(var i=0;i<e.length-1;i++)e[i]=e[i+1];e.pop()}var n=e[0],r="'FunctionReturnValue' expression",o=this.ParseJS(n,!1,r);if(e.splice(0,1),!o.error){var s;if("boolean"==typeof(s=this.CallJSfunction(n,e,!1,r,o))){if(t.set_any(s?1:0),__CONSTRUCT3_RUNTIME3__)return s?1:0}else if(t.set_any(s),__CONSTRUCT3_RUNTIME3__)return s}else t.set_any(void 0)},Value:function(){var t,e=Array.prototype.slice.call(arguments);if(__CONSTRUCT3_RUNTIME3__)t={set_int:function(){},set_float:function(){},set_string:function(){},set_any:function(){}};else{t=e[0];for(var i=0;i<e.length-1;i++)e[i]=e[i+1];e.pop()}var n=this.Value("'Value' expression",e);if("boolean"==typeof n){if(t.set_any(n?1:0),__CONSTRUCT3_RUNTIME3__)return n?1:0}else if(t.set_any(n),__CONSTRUCT3_RUNTIME3__)return n},AliasValue:function(){var e,t=Array.prototype.slice.call(arguments);if(__CONSTRUCT3_RUNTIME3__)e={set_int:function(){},set_float:function(){},set_string:function(){},set_any:function(){}};else{e=t[0];for(var i=0;i<t.length-1;i++)t[i]=t[i+1];t.pop()}var n,r=t[0],o="'AliasValue' expression",s=this.ParseJS(r,!0,o);if(!s.alias_found)return n={debug_caller:"AliasValue",caller_name:o,error_message:"No such alias '"+s.trimmed_code+"'"},this.ShowError(n),void e.set_any(void 0);if(!s.error){var a;try{a=s.end}catch(t){return n={debug_caller:"AliasValue",caller_name:o,"show-alias-expression":!0,alias_expression:s.trimmed_code,error_message:t.message},this.ShowError(n),void e.set_any(void 0)}if("boolean"==typeof a){if(e.set_any(a?1:0),__CONSTRUCT3_RUNTIME3__)return a?1:0}else if(e.set_any(a),__CONSTRUCT3_RUNTIME3__)return a}else e.set_any(void 0)},AliasCallReturnValue:function(){var t,e=Array.prototype.slice.call(arguments);if(__CONSTRUCT3_RUNTIME3__)t={set_int:function(){},set_float:function(){},set_string:function(){},set_any:function(){}};else{t=e[0];for(var i=0;i<e.length-1;i++)e[i]=e[i+1];e.pop()}var n=e[0],r="'AliasCallValue' expression",o=this.ParseJS(n,!0,r);if(e.splice(0,1),!o.alias_found){var s={debug_caller:"AliasCallValue",caller_name:r,error_message:"No such alias '"+o.trimmed_code+"'"};return this.ShowError(s),void t.set_any(void 0)}if(!o.error){var a;if("boolean"==typeof(a=this.CallJSfunction(n,e,!1,r,o))){if(t.set_any(a?1:0),__CONSTRUCT3_RUNTIME3__)return a?1:0}else if(t.set_any(a),__CONSTRUCT3_RUNTIME3__)return a}else t.set_any(void 0)}};for(var e in ExpsObject)Exps.prototype[e]=ExpsObject[e];pluginProto.exps=new Exps,instanceProto.EXPS=pluginProto.exps,instanceProto.CNDS=pluginProto.cnds,instanceProto.ACTS=pluginProto.acts}(),assert2(drama,"drama namespace not created"),assert2(drama.plugins_,"drama.plugins_ not created"),drama.plugins_.Keyboard=function(t){this.runtime=t},function(){var t=drama.plugins_.Keyboard.prototype;t.Type=function(t){this.plugin=t,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t){this.type=t,this.runtime=t.runtime,this.keyMap=new Array(256),this.typedKeyMap=new Array(256),this.usedKeys=new Array(256),this.triggerKey=0};var e=t.Instance.prototype;e.onCreate=function(){var e=this;document.addEventListener("keydown",function(t){e.onKeyDown(t)}),document.addEventListener("keyup",function(t){e.onKeyUp(t)})};var o=[32,33,34,35,36,37,38,39,40,44];function i(){}function n(){}function r(){}function s(t){switch(t=Math.floor(t)){case 8:return"backspace";case 9:return"tab";case 13:return"enter";case 16:return"shift";case 17:return"control";case 18:return"alt";case 19:return"pause";case 20:return"capslock";case 27:return"esc";case 33:return"pageup";case 34:return"pagedown";case 35:return"end";case 36:return"home";case 37:return"←";case 38:return"↑";case 39:return"→";case 40:return"↓";case 45:return"insert";case 46:return"del";case 91:return"left window key";case 92:return"right window key";case 93:return"select";case 96:return"numpad 0";case 97:return"numpad 1";case 98:return"numpad 2";case 99:return"numpad 3";case 100:return"numpad 4";case 101:return"numpad 5";case 102:return"numpad 6";case 103:return"numpad 7";case 104:return"numpad 8";case 105:return"numpad 9";case 106:return"numpad *";case 107:return"numpad +";case 109:return"numpad -";case 110:return"numpad .";case 111:return"numpad /";case 112:return"F1";case 113:return"F2";case 114:return"F3";case 115:return"F4";case 116:return"F5";case 117:return"F6";case 118:return"F7";case 119:return"F8";case 120:return"F9";case 121:return"F10";case 122:return"F11";case 123:return"F12";case 144:return"numlock";case 145:return"scroll lock";case 186:return";";case 187:return"=";case 188:return",";case 189:return"-";case 190:return".";case 191:return"/";case 192:return"'";case 219:return"[";case 220:return"\\";case 221:return"]";case 222:return"#";case 223:return"`";default:return String.fromCharCode(t)}}e.onKeyDown=function(t){var e=!1;if(window!=window.top&&-1<o.indexOf(t.which)&&document.activeElement&&!/TEXTAREA|INPUT/.test(document.activeElement.tagName))t.preventDefault(),e=!0,t.stopPropagation();if(!this.keyMap[t.which]){var i=t.which;this.typedKeyMap[i]=t.key,this.keyMap[i]=!0,this.triggerKey=i,this.runtime.isInUserInputEvent=!0,this.runtime.trigger(drama.plugins_.Keyboard.prototype.cnds.OnAnyKey,this);var n=this.runtime.trigger(drama.plugins_.Keyboard.prototype.cnds.OnKey,this),r=this.runtime.trigger(drama.plugins_.Keyboard.prototype.cnds.OnKeyCode,this);if(this.runtime.isInUserInputEvent=!1,n||r)if(this.usedKeys[i]=!0,!e)t.preventDefault()}else if(this.usedKeys[t.which]&&!e)t.preventDefault()},e.onKeyUp=function(t){var e=t.which;this.typedKeyMap[e]=t.key,this.keyMap[e]=!1,this.triggerKey=e,this.runtime.isInUserInputEvent=!0,this.runtime.trigger(drama.plugins_.Keyboard.prototype.cnds.OnAnyKeyReleased,this);var i=this.runtime.trigger(drama.plugins_.Keyboard.prototype.cnds.OnKeyReleased,this),n=this.runtime.trigger(drama.plugins_.Keyboard.prototype.cnds.OnKeyCodeReleased,this);if(this.runtime.isInUserInputEvent=!1,i||n||this.usedKeys[t.which])this.usedKeys[e]=!0,t.preventDefault()},e.onWindowBlur=function(){var t;for(t=0;t<256;++t)if(this.keyMap[t]){this.keyMap[t]=!1,this.triggerKey=t,this.runtime.trigger(drama.plugins_.Keyboard.prototype.cnds.OnAnyKeyReleased,this);var e=this.runtime.trigger(drama.plugins_.Keyboard.prototype.cnds.OnKeyReleased,this),i=this.runtime.trigger(drama.plugins_.Keyboard.prototype.cnds.OnKeyCodeReleased,this);if(e||i)this.usedKeys[t]=!0}},e.saveToJSON=function(){return{triggerKey:this.triggerKey}},e.loadFromJSON=function(t){this.triggerKey=t.triggerKey},e.getDebuggerValues=function(t){t.push({title:"Keyboard",properties:[{name:"Last key code",value:this.triggerKey,readonly:!0},{name:"Last key name",value:"'"+s(this.triggerKey)+"'",readonly:!0}]})},i.prototype.IsKeyDown=function(t){return this.keyMap[t]},i.prototype.OnKey=function(t){return t===this.triggerKey},i.prototype.OnAnyKey=function(t){return!0},i.prototype.OnAnyKeyReleased=function(t){return!0},i.prototype.OnKeyReleased=function(t){return t===this.triggerKey},i.prototype.IsKeyCodeDown=function(t){if((t=Math.floor(t))<0||t>=this.keyMap.length)return!1;else return this.keyMap[t]},i.prototype.OnKeyCode=function(t){return t===this.triggerKey},i.prototype.OnKeyCodeReleased=function(t){return t===this.triggerKey},t.cnds=new i,n.prototype.SimulateControl=function(t,e){if(this.triggerKey=e,this.typedKeyMap[e]=s(e),0==t){if(this.keyMap[e])return;this.keyMap[e]=!0,this.typedKeyMap[e]=s(e),this.runtime.isInUserInputEvent=!0,this.runtime.trigger(drama.plugins_.Keyboard.prototype.cnds.OnAnyKey,this),this.runtime.trigger(drama.plugins_.Keyboard.prototype.cnds.OnKey,this),this.runtime.trigger(drama.plugins_.Keyboard.prototype.cnds.OnKeyCode,this),this.runtime.isInUserInputEvent=!1}else if(1==t)this.keyMap[e]=!0;else if(2==t)this.keyMap[e]=!1,this.runtime.isInUserInputEvent=!0,this.runtime.trigger(drama.plugins_.Keyboard.prototype.cnds.OnAnyKeyReleased,this),this.runtime.trigger(drama.plugins_.Keyboard.prototype.cnds.OnKeyReleased,this),this.runtime.trigger(drama.plugins_.Keyboard.prototype.cnds.OnKeyCodeReleased,this),this.runtime.isInUserInputEvent=!1},t.acts=new n,r.prototype.TypedKey=function(t){t.set_string(this.typedKeyMap[this.triggerKey]||"")},r.prototype.LastKeyCode=function(t){t.set_int(this.triggerKey)},r.prototype.StringFromKeyCode=function(t,e){t.set_string(s(e))},t.exps=new r}(),assert2(drama,"drama namespace not created"),assert2(drama.plugins_,"drama.plugins_ not created"),drama.plugins_.Kongregate=function(t){this.runtime=t},function(){var t=drama.plugins_.Kongregate.prototype;t.Type=function(t){this.plugin=t,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){};var i=null,e=null,n=null,r=0,o="Guest";function s(){r=i.services.getUserId(),o=i.services.getUsername(),e.trigger(drama.plugins_.Kongregate.prototype.cnds.OnLogin,n)}function a(){if((i=window.kongregateAPI.getAPI()).services.connect(),i.services.addEventListener("login",s),r=i.services.getUserId(),o=i.services.getUsername(),0<r)e.trigger(drama.plugins_.Kongregate.prototype.cnds.OnLogin,n)}t.Instance=function(t){if(this.type=t,this.runtime=t.runtime,e=this.runtime,n=this,void 0!==window.kongregateAPI)window.kongregateAPI.loadAPI(a)};var l=t.Instance.prototype;function c(){}function u(){}function h(){}l.onCreate=function(){},l.onLayoutChange=function(){if(0<r)e.trigger(drama.plugins_.Kongregate.prototype.cnds.OnLogin,n)},c.prototype.IsGuest=function(){if(!i)return!0;else return i.services.isGuest()},c.prototype.OnLogin=function(){return!0},t.cnds=new c,u.prototype.ShowRegBox=function(){if(i&&0===r)i.services.showRegistrationBox()},u.prototype.SubmitStat=function(t,e){if(i)i.stats.submit(t,e)},u.prototype.ShowShoutBox=function(t){if(0<r)i.services.showShoutBox(t)},u.prototype.ShowSignInBox=function(){if(i&&0===r)i.services.showSignInBox()},t.acts=new u,h.prototype.UserID=function(t){t.set_int(r)},h.prototype.UserName=function(t){t.set_string(o)},t.exps=new h}(),assert2(drama,"drama namespace not created"),assert2(drama.plugins_,"drama.plugins_ not created"),drama.plugins_.List=function(t){this.runtime=t},function(){var t=drama.plugins_.List.prototype;t.Type=function(t){this.plugin=t,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t){this.type=t,this.runtime=t.runtime};var e=t.Instance.prototype;function i(){}function n(){}function r(){}e.onCreate=function(){if(this.elem=document.createElement("select"),this.elem.id=this.properties[7],document.body.appendChild(this.elem),this.elem.title=this.properties[1],this.elem.disabled=!this.properties[3],0===this.properties[4])this.elem.size=2;if(this.elem.multiple=this.properties[5],this.autoFontSize=this.properties[6],!this.properties[2])this.elem.style.display="none",this.visible=!1;if(this.properties[0]){var t,e,i,n=this.properties[0].split("\n");for(t=0,e=n.length;t<e;t++)(i=document.createElement("option")).text=n[t],this.elem.add(i)}var r=this;this.elem.onchange=function(){r.runtime.trigger(drama.plugins_.List.prototype.cnds.OnSelectionChanged,r)},this.elem.onclick=function(t){t.stopPropagation(),r.runtime.isInUserInputEvent=!0,r.runtime.trigger(drama.plugins_.List.prototype.cnds.OnClicked,r),r.runtime.isInUserInputEvent=!1},this.elem.ondblclick=function(t){t.stopPropagation(),r.runtime.isInUserInputEvent=!0,r.runtime.trigger(drama.plugins_.List.prototype.cnds.OnDoubleClicked,r),r.runtime.isInUserInputEvent=!1},this.elem.addEventListener("touchstart",function(t){t.stopPropagation()},!1),this.elem.addEventListener("touchmove",function(t){t.stopPropagation()},!1),this.elem.addEventListener("touchend",function(t){t.stopPropagation()},!1),this.elem.addEventListener("mousedown",function(t){t.stopPropagation()}),this.elem.addEventListener("mouseup",function(t){t.stopPropagation()}),this.lastLeft=0,this.lastTop=0,this.lastRight=0,this.lastBottom=0,this.lastWinWidth=0,this.lastWinHeight=0,this.isVisible=!0,this.updatePosition(!0),this.runtime.tickMe(this)},e.saveToJSON=function(){var t,e,i={tooltip:this.elem.title,disabled:!!this.elem.disabled,items:[],sel:[]},n=i.items;for(t=0,e=this.elem.length;t<e;t++)n.push(this.elem.options[t].text);var r=i.sel;if(this.elem.multiple){for(t=0,e=this.elem.length;t<e;t++)if(this.elem.options[t].selected)r.push(t)}else r.push(this.elem.selectedIndex);return i},e.loadFromJSON=function(t){this.elem.title=t.tooltip,this.elem.disabled=t.disabled;for(var e,i,n,r=t.items;this.elem.length;)this.elem.remove(this.elem.length-1);for(e=0,i=r.length;e<i;e++)(n=document.createElement("option")).text=r[e],this.elem.add(n);var o=t.sel;if(this.elem.multiple){for(e=0,i=o.length;e<i;e++)if(o[e]<this.elem.length)this.elem.options[o[e]].selected=!0}else if(1<=o.length)this.elem.selectedIndex=o[0]},e.onDestroy=function(){this.elem.parentElement.removeChild(this.elem),this.elem=null},e.tick=function(){this.updatePosition()},e.updatePosition=function(t){var e=this.layer.layerToCanvas(this.x,this.y,!0),i=this.layer.layerToCanvas(this.x,this.y,!1),n=this.layer.layerToCanvas(this.x+this.width,this.y+this.height,!0),r=this.layer.layerToCanvas(this.x+this.width,this.y+this.height,!1),o=this.runtime.width/this.runtime.devicePixelRatio,s=this.runtime.height/this.runtime.devicePixelRatio;if(!(!this.visible||!this.layer.visible||n<=0||r<=0||o<=e||s<=i)){if(e<1)e=1;if(i<1)i=1;if(o<=n)n=o-1;if(s<=r)r=s-1;var a=window.innerWidth,l=window.innerHeight;if(t||this.lastLeft!==e||this.lastTop!==i||this.lastRight!==n||this.lastBottom!==r||this.lastWinWidth!==a||this.lastWinHeight!==l){if(this.lastLeft=e,this.lastTop=i,this.lastRight=n,this.lastBottom=r,this.lastWinWidth=a,this.lastWinHeight=l,!this.isVisible)this.elem.style.display="",this.isVisible=!0;var c=Math.round(e)+this.runtime.canvas.offsetLeft,u=Math.round(i)+this.runtime.canvas.offsetTop;if(this.elem.style.position="absolute",this.elem.style.left=c+"px",this.elem.style.top=u+"px",this.elem.style.width=Math.round(n-e)+"px",this.elem.style.height=Math.round(r-i)+"px",this.autoFontSize)this.elem.style.fontSize=this.layer.getScale(!0)/this.runtime.devicePixelRatio-.2+"em"}else if(!this.isVisible)this.elem.style.display="",this.isVisible=!0}else{if(this.isVisible)this.elem.style.display="none";this.isVisible=!1}},e.draw=function(t){},e.drawGL=function(t){},e.getDebuggerValues=function(t){t.push({title:"List",properties:[{name:"Item count",value:this.elem.length,readonly:!0},{name:"Enabled",value:!this.elem.disabled},{name:"Tooltip",value:this.elem.title},{name:"Selected index",value:this.elem.selectedIndex}]});var e,i,n=[];for(e=0,i=this.elem.length;e<i;++e)n.push({name:e.toString(),value:this.elem.options[e].text});t.push({title:"Items",properties:n})},e.onDebugValueEdited=function(t,e,i){if("List"===t)switch(e){case"Enabled":this.elem.disabled=!i;break;case"Tooltip":this.elem.title=i;break;case"Selected index":this.elem.selectedIndex=i}else if("Items"===t)this.elem.options[parseInt(e,10)].text=i},i.prototype.CompareSelection=function(t,e){return drama.do_cmp(this.elem.selectedIndex,t,e)},i.prototype.OnSelectionChanged=function(){return!0},i.prototype.OnClicked=function(){return!0},i.prototype.OnDoubleClicked=function(){return!0},i.prototype.CompareSelectedText=function(t,e){var i,n=this.elem.selectedIndex;if(n<0||n>=this.elem.length)return!1;if(i=this.elem.options[n].text,e)return i==t;else return drama.equals_nocase(i,t)},i.prototype.CompareTextAt=function(t,e,i){var n,r=Math.floor(t);if(r<0||r>=this.elem.length)return!1;if(n=this.elem.options[r].text,i)return n==e;else return drama.equals_nocase(n,e)},t.cnds=new i,n.prototype.Select=function(t){this.elem.selectedIndex=t},n.prototype.SetTooltip=function(t){this.elem.title=t},n.prototype.SetVisible=function(t){this.visible=0!==t},n.prototype.SetEnabled=function(t){this.elem.disabled=0===t},n.prototype.SetFocus=function(){this.elem.focus()},n.prototype.SetBlur=function(){this.elem.blur()},n.prototype.SetCSSStyle=function(t,e){this.elem.style[drama.cssToCamelCase(t)]=e},n.prototype.AddItem=function(t){var e=document.createElement("option");e.text=t,this.elem.add(e)},n.prototype.AddItemAt=function(t,e){if((t=Math.floor(t))<0)t=0;var i=document.createElement("option");if(i.text=e,t>=this.elem.length)this.elem.add(i);else this.elem.add(i,this.elem.options[t])},n.prototype.Remove=function(t){t=Math.floor(t),this.elem.remove(t)},n.prototype.SetItemText=function(t,e){if(!((t=Math.floor(t))<0||t>=this.elem.length))this.elem.options[t].text=e},n.prototype.Clear=function(){this.elem.innerHTML=""},t.acts=new n,r.prototype.ItemCount=function(t){t.set_int(this.elem.length)},r.prototype.ItemTextAt=function(t,e){if(!((e=Math.floor(e))<0||e>=this.elem.length))t.set_string(this.elem.options[e].text);else t.set_string("")},r.prototype.SelectedIndex=function(t){t.set_int(this.elem.selectedIndex)},r.prototype.SelectedText=function(t){var e=this.elem.selectedIndex;if(!(e<0||e>=this.elem.length))t.set_string(this.elem.options[e].text);else t.set_string("")},r.prototype.SelectedCount=function(t){var e,i,n=0;for(e=0,i=this.elem.length;e<i;e++)if(this.elem.options[e].selected)n++;t.set_int(n)},r.prototype.SelectedIndexAt=function(t,e){var i,n;e=Math.floor(e);var r=0,o=0;for(i=0,n=this.elem.length;i<n;i++)if(this.elem.options[i].selected){if(r===e){o=i;break}r++}t.set_int(o)},r.prototype.SelectedTextAt=function(t,e){var i,n;e=Math.floor(e);var r=0,o="";for(i=0,n=this.elem.length;i<n;i++)if(this.elem.options[i].selected){if(r===e){o=this.elem.options[i].text;break}r++}t.set_string(o)},t.exps=new r}(),function(i){var n={};function r(t){if(n[t])return n[t].exports;var e=n[t]={i:t,l:!1,exports:{}};return i[t].call(e.exports,e,e.exports,r),e.l=!0,e.exports}r.m=i,r.c=n,r.d=function(t,e,i){if(!r.o(t,e))Object.defineProperty(t,e,{enumerable:!0,get:i})},r.r=function(t){if("undefined"!=typeof Symbol&&Symbol.toStringTag)Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(e,t){if(1&t)e=r(e);if(8&t)return e;if(4&t&&"object"===_typeof2(e)&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(i,n,function(t){return e[t]}.bind(null,n));return i},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s="02b0c7e731708819")}({"02b0c7e731708819":function(t,e,i){var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i("e7b602c229ac5b71"),s=i("493167127ad7b1c1"),a=i("8463ce3906bbfa07"),l=i("f4d1d714ef51ea26"),c=i("4ca6727dd4a532e6"),u=i("460a446489d1f21f");window.assert2(drama,"drama namespace not created"),window.assert2(drama.plugins_,"drama.plugins_ not created");var h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e}(o.SDKPluginBase);h.prototype.Instance=a.default,h.prototype.Type=s.default,h.prototype.cnds=new l.default({}),h.prototype.exps=new u.default({}),h.prototype.acts=new c.default({}),window.drama.plugins_.LocalStorage=h},"0330f9384c2c8825":function(t,e,i){var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=function(i){function t(t){var e=i.call(this)||this;return e._runtime=t.runtime,e._plugin=t,e}return r(t,i),Object.defineProperty(t.prototype,"runtime",{get:function(){return this._runtime},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"plugin",{get:function(){return this._plugin},enumerable:!0,configurable:!0}),t.prototype.onCreate=function(){},t.prototype.Release=function(){this._runtime=null,this._plugin=null},t.prototype.FinishCondition=function(){},t.prototype.LoadTextures=function(){},t.prototype.ReleaseTextures=function(){},t.prototype.OnDynamicTextureLoadComplete=function(){},t.prototype.LoadTilePolyData=function(){},t}(i("d27c30dad6345543").DefendedBase);e.SDKTypeBase=o},"03ce133e39706a78":function(t,e,i){var r=i("0bc040fdd7e131b0");function c(){}var u={},o=["REJECTED"],s=["FULFILLED"],n=["PENDING"];function a(t){if("function"!=typeof t)throw new TypeError("resolver must be a function");if(this.state=n,this.queue=[],this.outcome=void 0,t!==c)p(this,t)}function l(t,e,i){if(this.promise=t,"function"==typeof e)this.onFulfilled=e,this.callFulfilled=this.otherCallFulfilled;if("function"==typeof i)this.onRejected=i,this.callRejected=this.otherCallRejected}function h(e,i,n){r(function(){var t;try{t=i(n)}catch(t){return u.reject(e,t)}if(t===e)u.reject(e,new TypeError("Cannot resolve promise with itself"));else u.resolve(e,t)})}function d(t){var e=t&&t.then;if(t&&("object"===_typeof2(t)||"function"==typeof t)&&"function"==typeof e)return function(){e.apply(t,arguments)}}function p(e,t){var i=!1;function n(t){if(!i)i=!0,u.reject(e,t)}function r(t){if(!i)i=!0,u.resolve(e,t)}var o=f(function(){t(r,n)});if("error"===o.status)n(o.value)}function f(t,e){var i={};try{i.value=t(e),i.status="success"}catch(t){i.status="error",i.value=t}return i}(t.exports=a).prototype.catch=function(t){return this.then(null,t)},a.prototype.then=function(t,e){if("function"!=typeof t&&this.state===s||"function"!=typeof e&&this.state===o)return this;var i=new this.constructor(c);if(this.state!==n){h(i,this.state===s?t:e,this.outcome)}else this.queue.push(new l(i,t,e));return i},l.prototype.callFulfilled=function(t){u.resolve(this.promise,t)},l.prototype.otherCallFulfilled=function(t){h(this.promise,this.onFulfilled,t)},l.prototype.callRejected=function(t){u.reject(this.promise,t)},l.prototype.otherCallRejected=function(t){h(this.promise,this.onRejected,t)},u.resolve=function(t,e){var i=f(d,e);if("error"===i.status)return u.reject(t,i.value);var n=i.value;if(n)p(t,n);else{t.state=s,t.outcome=e;for(var r=-1,o=t.queue.length;++r<o;)t.queue[r].callFulfilled(e)}return t},u.reject=function(t,e){t.state=o,t.outcome=e;for(var i=-1,n=t.queue.length;++i<n;)t.queue[i].callRejected(e);return t},a.resolve=function(t){if(t instanceof this)return t;return u.resolve(new this(c),t)},a.reject=function(t){var e=new this(c);return u.reject(e,t)},a.all=function(t){var i=this;if("[object Array]"!==Object.prototype.toString.call(t))return this.reject(new TypeError("must be an array"));var n=t.length,r=!1;if(!n)return this.resolve([]);var o=new Array(n),s=0,e=-1,a=new this(c);for(;++e<n;)l(t[e],e);return a;function l(t,e){i.resolve(t).then(function(t){if(o[e]=t,++s===n&&!r)r=!0,u.resolve(a,o)},function(t){if(!r)r=!0,u.reject(a,t)})}},a.race=function(t){var e=this;if("[object Array]"!==Object.prototype.toString.call(t))return this.reject(new TypeError("must be an array"));var i=t.length,n=!1;if(!i)return this.resolve([]);var r=-1,o=new this(c);for(;++r<i;)s=t[r],e.resolve(s).then(function(t){if(!n)n=!0,u.resolve(o,t)},function(t){if(!n)n=!0,u.reject(o,t)});var s;return o}},"04f59f2d8d55de90":function(t,e,i){var n,r;Object.defineProperty(e,"__esModule",{value:!0}),(n=e.Identifier||(e.Identifier={})).UTIME="LOCALFORAGE_UTIME",n.WAITINGSYNC="LOCALFORAGE_WAITINGSYNC",(r=e.Operator||(e.Operator={}))[r.UNSET=0]="UNSET",r[r.SET=1]="SET"},"081ce22713c044b3":function(t,e,i){Object.defineProperty(e,"__esModule",{value:!0}),e.urlCodeMap={"v1/player/game-initialize":0,"v2/player/game-login":1,"v1/player/order":2,"v1/player/game-data/list":3,"v1/player/game-data/load":4,"v1/player/game-data/save":5,"v1/player/mail":6,"v1/player/order/":7,"v1/player/account":8,"v1/player/purchased-resources/info":9,"v1/player/game-notice":10,"v1/player/game-notice/detail":11,"v1/player/game-activity":12,"v1/player/game-share/info":13,"v1/player/game-share/list":14,"v1/player/h5-config":15,"character/v1/character":101,"character/v1/character/":102,"logic/v1/plugin/result":103,"goods/sync":104,"goods/buy":105},e.errorcodeMap={6001:{code:"GAME_INFO_NULL",message:"%s游戏信息不存在"},6002:{code:"GAME_VERSION_INFO_NULL",message:"游戏版本信息不存在"},6003:{code:"GAME_USER_NOT_MATCH",message:"游戏创建者与当前登录用户不匹配"},6004:{code:"GAME_CONDITION_ERROR",message:"Condition表达式错误"},6005:{code:"GAME_SHARE_ACTION_EXISTS",message:"该分享动作已存在"},6006:{code:"GAME_SHARE_ACTION_NAME_EXISTS",message:"分享动作名称已存在"},6007:{code:"GAME_IS_AGENCY",message:"游戏已申请独家代理"},6008:{code:"GAME_IS_FROZEN",message:"游戏已被封停"},6009:{code:"GAME_IS_NOT_ONLINE_GAME",message:"该游戏不是联机游戏"},6011:{code:"GAME_IS_NOT_PC_GAME",message:"该游戏不是单机游戏"},6012:{code:"GAME_EXP_PLAYER_FULL",message:"游戏体验人数已达上限"},6013:{code:"GAME_PLAYER_FULL",message:"游戏人数已达上限"},6014:{code:"GAME_CREATE_USER_ERROR",message:"游戏创建者信息错误"},6015:{code:"GAME_SECRET_LOGIN_ERROR",message:"私密游戏登录失败"},7016:{code:"GAME_INFO_EXISTS",message:"该工程已有对应作品存在"},7017:{code:"PROJECT_INFO_EXISTS",message:"该作品已有工程ID"},7018:{code:"GAME_GLOBAL_VARIABLE_VERSION_EXISTS",message:"该版本全局变量已发布正式版本"},9004:{code:"NOT_LOGIN",message:"用户未登录"},9005:{code:"INVALID_TOKEN",message:"登录过期"},9006:{code:"ERR_TOKEN",message:"服务器验证token失败"},9007:{code:"TOKEN_ERROR",message:"token有误"},9008:{code:"TEMPLATE_TAG__NOT_EXIST",message:"模板标签不存在"},9011:{code:"USER_NOT_LOGIN_AUTHORITY",message:"无登录权限"},9012:{code:"USER_NOT_MENU_AUTHORITY",message:"没有菜单权限"},1999:{code:"NAME_EXIST",message:"名称已存在"},9013:{code:"GAME_STATUS_CHANGE",message:"游戏状态发生变化"},9014:{code:"PLAYER_STATUS_CHANGE",message:"玩家状态发生变化"},9015:{code:"NOT_SUPPORT_REQUEST_METHOD",message:"请求方式不支持"},9016:{code:"INVALID_FINGERPRINT",message:"指纹无效"},9017:{code:"NOT_FOUND_GOODS",message:"找到不到该内购商品"},9018:{code:"INVALID_EXCHANGE_TYPE",message:"价格档位无效"},9019:{code:"INVALID_GOODS_TYPE",message:"商品类型无效"},9020:{code:"GAME_CURRENCY_EXIST",message:"该游戏已定义货币"},9021:{code:"INVALID_EXCHANGE_RATE",message:"兑换比例无效"},9022:{code:"INVALID_DICT_VALUE",message:"商品类型无效"},9023:{code:"GAME_GOODS_EXIST",message:"该商品已添加过"},9024:{code:"DATA_NOT_EXIST",message:"数据不存在"},9025:{code:"USER_GAME_PLAYER_MISMATCH",message:"用户ID、游戏ID或玩家ID都不能为空"},9026:{code:"PLAYER_INFO_NULL",message:"玩家不存在"},9027:{code:"DATA_MISMATCH_NO_AUTH",message:"抱歉，数据不匹配，不允许操作"},9028:{code:"GAME_ID_OR_PLAYER_ID_NULL",message:"玩家ID或游戏ID不能为空"},9029:{code:"DELETE_DRAMA_ID_ERROR",message:"删除抓马沙盒账号异常"},9030:{code:"CREATE_DRAMA_ID_ERROR",message:"创建抓马沙盒账号异常"},9031:{code:"GAME_NAME_REPEAT",message:"游戏名称已重复，请修改游戏名称"},9032:{code:"GAME_NAME_EXIST",message:"游戏名已存在"},9033:{code:"DELETE_FILE_ERROR",message:"删除临时文件异常"},9034:{code:"GAME_VERSION_ERROR",message:"游戏版本号要大于当前的"},9035:{code:"NO_NEED_RESEND",message:"该商品类型不需要补发货"},9036:{code:"ERROR_OP_TYPE",message:"操作类型错误"},9037:{code:"NO_FOUND_GAME_NOTICE",message:"找到不到游戏公告"},9038:{code:"TIME_OUT_OF_RANGE",message:"时间范围超出3个月"},9039:{code:"GAME_GOODS_PRICE_NOT_MATCH",message:"商品价格不匹配，请重新登录再试"},9040:{code:"GOODS_TYPE_NOT_SUPPORT",message:"不支持消耗型商品购买"},9041:{code:"AMOUNT_GREATER_THAN_ZERO",message:"金额要大于0"},9042:{code:"OP_NOT_SUPPORT",message:"操作不支持"},9043:{code:"TOKEN_INVALID_OR_NO_AUTH",message:"凭证无效或权限不够"},9044:{code:"NOT_CREATE_ROLE",message:"没有创建角色"},9045:{code:"DATA_STATUS_UPDATE_NOT_ALLOWED",message:"数据状态不允许变更"},9046:{code:"END_TIME_IS_EXPIRED",message:"结束时间已无效，请先编辑"},9047:{code:"RECEIVER_IS_NULL",message:"请填写指定接收人"},9048:{code:"SEND_TIME_IS_NULL",message:"请填写指定发送时间"},9049:{code:"AUTH_NAME_EXIST",message:"授权名称已存在"},9050:{code:"GAME_NOT_EXIST",message:"游戏不存在"},9051:{code:"GAME_VERSION_EXIST",message:"该平台对应的游戏版本号已经存在"},9052:{code:"GAME_VERSION_FORMAT_ERROR",message:"游戏版本号格式错误"},9053:{code:"GAME_IS_DELETED",message:"游戏已被删除"},71001:{code:"CHARACTER_NAME_EXIST",message:"角色名已存在"}}},"0bc040fdd7e131b0":function(u,t,e){(function(e){var i,n,t=e.MutationObserver||e.WebKitMutationObserver;if(t){var r=0,o=new t(c),s=e.document.createTextNode("");o.observe(s,{characterData:!0}),i=function(){s.data=r=++r%2}}else if(!e.setImmediate&&void 0!==e.MessageChannel){var a=new e.MessageChannel;a.port1.onmessage=c,i=function(){a.port2.postMessage(0)}}else if("document"in e&&"onreadystatechange"in e.document.createElement("script"))i=function(){var t=e.document.createElement("script");t.onreadystatechange=function(){c(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},e.document.documentElement.appendChild(t)};else i=function(){setTimeout(c,0)};var l=[];function c(){var t,e;n=!0;for(var i=l.length;i;){for(e=l,l=[],t=-1;++t<i;)e[t]();i=l.length}n=!1}u.exports=function(t){if(1===l.push(t)&&!n)i()}}).call(this,e("0ee4763173a9a955"))},"0d29f351d650372a":function(t,e,i){Object.defineProperty(e,"__esModule",{value:!0});var r=i("4f5d0dbbc4df297a"),o=i("3ef79e4e773762de"),s=xfConfig.serverURL,n=function(){function t(){}return t.getCharacterList=function(t){var e=o.getSignedData({uid:t.uid,gid:t.gid,timestamp:o.getTimestamp(),random:o.getRandom()});return r.gameServer.get(s+"/character/v1/character",{params:e})},t.getCharacterInfo=function(t){var e=t.cid,i=o.getSignedData({gid:t.gid,timestamp:o.getTimestamp(),random:o.getRandom(),cid:e});return r.gameServer.get(s+"/character/v1/character/"+e,{params:i})},t.createCharacter=function(t){var e=s+"/character/v1/character",i=o.getSignedData({uid:t.uid,gid:t.gid,cname:t.cname,timestamp:o.getTimestamp(),random:o.getRandom()});return r.gameServer({method:"POST",url:e,data:i})},t.updateCharacter=function(t){if(!t.cid)throw new Error("【更新游戏角色失败】：当前账号没有获取到角色信息，请先创建角色后才能修改.");var e=s+"/character/v1/character/"+t.cid,i={cid:t.cid,gid:t.gid,cname:t.cname,timestamp:o.getTimestamp(),random:o.getRandom(),gver:t.gver};if(t.glov)i.glov=JSON.stringify(t.glov);var n=o.getSignedData(i);return n.glov=t.glov,r.gameServer({method:"PUT",url:e,data:n})},t.getRankInfo=function(t){var e=s+"/logic/v1/plugin/result/"+t.instanceId;return r.gameServer.get(e,{params:o.getSignedData({gameVersion:t.gameVersion,gameId:t.gameId,timestamp:o.getTimestamp(),random:o.getRandom(),instanceId:t.instanceId})})},t.getCloudSaveData=function(){return r.gameServer.get(s+"/logic/v1/clouddb/storage")},t.syncCloudSaveData=function(t){var e=s+"/logic/v1/clouddb/operations";return r.gameServer.put(e,t,{headers:{"Content-Type":"application/snappy"}})},t.getCloundSaveStatus=function(){return r.gameServer.get(s+"/logic/v1/clouddb/stats")},t.syncCharacterGoods=function(e){if(e)xf.gameInfo.goodsList=e;else{var t=localStorage.getItem("xf_character_goods"+xf.gameInfo.characterId);e=t?JSON.parse(t):xf.gameInfo.goodsList}localStorage.setItem("xf_character_goods"+xf.gameInfo.characterId,JSON.stringify(e));var i=s+"/character/v1/character/"+xf.gameInfo.characterId+"/goods/sync",n=o.getSignedData({cid:xf.gameInfo.characterId,gid:xf.gameInfo.gameId,timestamp:o.getTimestamp(),random:o.getRandom(),goods:e});return r.gameServer({url:i,method:"POST",data:n}).then(function(t){xf.gameInfo.goodsList=t.goods,localStorage.setItem("xf_character_goods"+xf.gameInfo.characterId,JSON.stringify(e))})},t.buyGoods=function(t){var e=s+"/character/v1/character/"+t.cid+"/goods/buy",i=o.getSignedData({cid:t.cid,gid:t.gid,goods_id:t.goods_id,buy_num:t.buy_num,uid:t.uid,request_id:t.request_id,timestamp:o.getTimestamp(),random:o.getRandom()});return r.gameServer({url:e,method:"POST",data:i})},t}();e.serverApi=n,e.default=n},"0ee4763173a9a955":function(t,e){var i;i=function(){return this}();try{i=i||new Function("return this")()}catch(t){if("object"===(void 0===window?"undefined":_typeof2(window)))i=window}t.exports=i},"1799653e8ebaa01e":function(t,e,i){i.r(e);var n=function(){try{if("undefined"!=typeof indexedDB)return indexedDB;if("undefined"!=typeof webkitIndexedDB)return webkitIndexedDB;if("undefined"!=typeof mozIndexedDB)return mozIndexedDB;if("undefined"!=typeof OIndexedDB)return OIndexedDB;if("undefined"!=typeof msIndexedDB)return msIndexedDB}catch(t){return}}();e.default=n},"1f9dc66ac05d14e4":function(t,e,i){function n(t){if("string"!=typeof t)console.warn("".concat(t," used as a key, but it is not a string.")),t=String(t);return t}i.r(e),i.d(e,"default",function(){return n})},"31bc727c5ad94639":function(t,e,i){Object.defineProperty(e,"__esModule",{value:!0});var n=i("0d29f351d650372a");e.serverApi=n.default;var r=i("7ec4778ef9e4f6b3");e.localApi=r.default;var o=i("8046905752873b0b");e.webApi=o.default,xf.serverApi=n.default,xf.localApi=r.default,xf.webApi=o.default},"32e7c8b6a69ee838":function(t,e,i){if(Object.defineProperty(e,"__esModule",{value:!0}),e.prefix="",e.is_arcade=void 0!==window.is_scirra_arcade,e.is_arcade)e.prefix="sa"+window.scirra_arcade_id+"_";e.getErrorString=function(t){if(!t)return"unknown error";else if("string"==typeof t)return t;else if("string"==typeof t.message)return t.message;else if("string"==typeof t.name)return t.name;else if("string"==typeof t.data)return t.data;else return"unknown error"},e.hasRequiredPrefix=function(t){if(!e.prefix)return!0;else return t.substr(0,e.prefix.length)===e.prefix},e.removePrefix=function(t){if(!e.prefix)return t;if(this.hasRequiredPrefix(t))return t.substr(e.prefix.length);else return},e.sortPropertiesAZ=function(t,e){var i=t.name.toLowerCase(),n=e.name.toLowerCase();if(i<n)return-1;else if(n<i)return 1;else return 0},e.removeItem=function(t,e){for(var i=0;i<t.length;i++)if("string"==typeof e){if(t[i]===e)t.splice(i,1),i--}else if("[object Array]"===Object.prototype.toString.call(e))for(var n=0;n<e.length;n++)if(t[i]===e[n])t.splice(i,1),i--},e.versionToNumber=function(t){var e=t.split("."),i=e[0]+".";return e.shift(),i+=e.join("")}},"3ef79e4e773762de":function(t,e,i){Object.defineProperty(e,"__esModule",{value:!0}),e.getRandom=function(){return 1e4*Math.random()<<0},e.getTimestamp=function(){return.001*Date.now()<<0},e.getSignedData=function(i){var t=Object.keys(i).sort(),n={};t.forEach(function(t){var e=i[t];if("object"===_typeof2(e))e=JSON.stringify(e);n[t]=e});var e=xf.stringify(n);return e=e+"&"+xf.gameInfo.secretKey,i.sign=md5(e).toLowerCase(),i},e.getSignedDataByXfConfig=function(i,t){var e=Object.keys(i).sort(),n={};e.forEach(function(t){var e=i[t];if("object"===_typeof2(e))e=JSON.stringify(e);n[t]=e});var r=xf.stringify(n);return r=r+"&"+(t||xfConfig.appKey),i.sign=md5(r).toLowerCase(),i},e.getSignedDataStr=function(t){var e=xf.stringify(t),i=e+xf.gameInfo.secretKey;return e+="sign="+md5(i).toLowerCase()},e.logout=function(t){if(void 0===t)t="登录过期，请重新登陆";var e=function(){if(window.cordova)cordova.plugins.SeiyaSdk.logout();else if(window.xsSdk)window.xsSdk.logout();window.location.reload()};if(window.xfruntime)xf.MessageBox.alert(t,{callback:e});else xf.XfLoginCanvas.showAlert(t,{cancelCallback:e,showConfirmButton:!1,cancelButtonText:"重试"})}},"3f35f1f171b3ae13":function(t,e,i){if(i.r(e),"undefined"==typeof Promise)i("97b40a908b612952");e.default=Promise},"407b4704136fd4d1":function(t,e,i){var n,r;Object.defineProperty(e,"__esModule",{value:!0}),(n=e.PayType||(e.PayType={}))[n.AliPay=1]="AliPay",n[n.WXPay=2]="WXPay",n[n.ApplePay=3]="ApplePay",n[n.Sandbox=4]="Sandbox",(r=e.Platform||(e.Platform={}))[r.Android=1]="Android",r[r.iOS=2]="iOS",r[r.OSX=4]="OSX",r[r.Browser=8]="Browser",r[r.microApp=16]="microApp",r[r.Windows=32]="Windows"},"460a446489d1f21f":function(t,e,i){var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.ItemValue=function(t){t.set_any(this.lastValue)},e.prototype.Key=function(t){t.set_string(this.currentKey)},e.prototype.KeyCount=function(t){t.set_int(this.keyNamesList.length)},e.prototype.KeyAt=function(t,e){if(!((e=Math.floor(e))<0||e>=this.keyNamesList.length))t.set_string(this.keyNamesList[e]);else t.set_string("")},e.prototype.ErrorMessage=function(t){t.set_string(this.errorMessage)},e}(i("8463ce3906bbfa07").Property);e.default=o},"493167127ad7b1c1":function(t,e,i){var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.onCreate=function(){},e}(i("0330f9384c2c8825").SDKTypeBase);e.default=o},"4a7767f772d695fe":function(t,e,i){i.r(e),e.default=function(t,e){if(e)t.then(function(t){e(null,t)},function(t){e(t)})}},"4ca6727dd4a532e6":function(t,e,i){var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=this&&this.__awaiter||function(o,s,a,l){return new(a||(a=Promise))(function(t,e){function i(t){try{r(l.next(t))}catch(t){e(t)}}function n(t){try{r(l.throw(t))}catch(t){e(t)}}function r(e){e.done?t(e.value):new a(function(t){t(e.value)}).then(i,n)}r((l=l.apply(o,s||[])).next())})},c=this&&this.__generator||function(i,n){var r,o,s,t,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;if(o=0,s)e=[2&e[0],s.value];switch(e[0]){case 0:case 1:s=e;break;case 4:return a.label++,{value:e[1],done:!1};case 5:a.label++,o=e[1],e=[0];continue;case 7:e=a.ops.pop(),a.trys.pop();continue;default:if(!(s=0<(s=a.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){a=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){a.label=e[1];break}if(6===e[0]&&a.label<s[1]){a.label=s[1],s=e;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(e);break}if(s[2])a.ops.pop();a.trys.pop();continue}e=n.call(i,a)}catch(t){e=[6,t],o=0}finally{r=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}};Object.defineProperty(e,"__esModule",{value:!0});var o=i("8463ce3906bbfa07"),u=i("04f59f2d8d55de90"),h=i("db60b47823f837ac"),d=i("32e7c8b6a69ee838"),a=i("31bc727c5ad94639"),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.SetItem=function(e,i){return s(this,void 0,void 0,function(){return c(this,function(t){if(this.localForageInitFailed)return this.triggerStorageError("storage failed to initialise - may be disabled in browser settings"),[2];if(this.pendingSets++,this.storageCache[e]!==i)this.storageCache[e]=i,this.writeQueue[e]=e;return[2]})})},e.prototype.GetItem=function(r){return s(this,void 0,void 0,function(){var e,i,n;return c(this,function(t){switch(t.label){case 0:if(this.localForageInitFailed)return this.triggerStorageError("storage failed to initialise - may be disabled in browser settings"),[2];e=d.prefix+r,this.pendingGets++,t.label=1;case 1:return t.trys.push([1,3,4,5]),[4,h.getItem(e)];case 2:if(i=t.sent(),this.pendingGets--,this.currentKey=r,this.lastValue=i,void 0===this.lastValue||null===this.lastValue)this.lastValue="";return this.runtime.trigger(drama.plugins_.LocalStorage.prototype.cnds.OnAnyItemGet,this),this.runtime.trigger(drama.plugins_.LocalStorage.prototype.cnds.OnItemGet,this),this.currentKey="",this.lastValue="",[3,5];case 3:return n=t.sent(),this.errorMessage=d.getErrorString(n),this.runtime.trigger(drama.plugins_.LocalStorage.prototype.cnds.OnError,this),[3,5];case 4:if(0===this.pendingGets)this.runtime.trigger(drama.plugins_.LocalStorage.prototype.cnds.OnAllGetsComplete,this);return[7];case 5:return[2]}})})},e.prototype.CheckItemExists=function(o){return s(this,void 0,void 0,function(){var e,i,n,r;return c(this,function(t){switch(t.label){case 0:if(this.localForageInitFailed)return this.triggerStorageError("storage failed to initialise - may be disabled in browser settings"),[2];e=d.prefix+o,i=this,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,h.getItem(e)];case 2:if(n=t.sent(),this.currentKey=o,null===n||""===n)this.lastValue="",i.runtime.trigger(drama.plugins_.LocalStorage.prototype.cnds.OnItemMissing,i);else this.lastValue=n,i.runtime.trigger(drama.plugins_.LocalStorage.prototype.cnds.OnItemExists,i);return this.currentKey="",this.lastValue="",[3,4];case 3:return r=t.sent(),this.errorMessage=d.getErrorString(r),i.runtime.trigger(drama.plugins_.LocalStorage.prototype.cnds.OnError,i),[3,4];case 4:return[2]}})})},e.prototype.RemoveItem=function(r){return s(this,void 0,void 0,function(){var e,i,n;return c(this,function(t){switch(t.label){case 0:if(this.localForageInitFailed)return this.triggerStorageError("storage failed to initialise - may be disabled in browser settings"),[2];e=d.prefix+r,t.label=1;case 1:return t.trys.push([1,5,,6]),[4,h.removeItem(e)];case 2:return t.sent(),this.debugDataChanged=!0,this.currentKey=r,this.lastValue="",[4,h.getItem(u.Identifier.WAITINGSYNC)];case 3:return(i=t.sent()||{})[e]=u.Operator.UNSET,[4,h.setItem(u.Identifier.WAITINGSYNC,i)];case 4:return t.sent(),this.runtime.trigger(drama.plugins_.LocalStorage.prototype.cnds.OnAnyItemRemoved,this),this.runtime.trigger(drama.plugins_.LocalStorage.prototype.cnds.OnItemRemoved,this),this.currentKey="",[3,6];case 5:return n=t.sent(),this.errorMessage=d.getErrorString(n),this.runtime.trigger(drama.plugins_.LocalStorage.prototype.cnds.OnError,this),[3,6];case 6:return[2]}})})},e.prototype.ClearStorage=function(){return s(this,void 0,void 0,function(){var e,i;return c(this,function(t){switch(t.label){case 0:if(this.localForageInitFailed)return this.triggerStorageError("storage failed to initialise - may be disabled in browser settings"),[2];if(d.is_arcade)return[2];t.label=1;case 1:return t.trys.push([1,7,,8]),[4,h.getItem(u.Identifier.UTIME)];case 2:return e=t.sent(),[4,h.clear()];case 3:if(t.sent(),this.debugDataChanged=!0,this.currentKey="",this.lastValue="",this.clear=!0,!e)return[3,5];else return[4,h.setItem(u.Identifier.UTIME,e)];case 4:t.sent(),t.label=5;case 5:return[4,h.setItem(u.Identifier.WAITINGSYNC,{})];case 6:return t.sent(),drama.clearArray(this.keyNamesList),this.trigger(drama.plugins_.LocalStorage.prototype.cnds.OnCleared),[3,8];case 7:return i=t.sent(),this.errorMessage=d.getErrorString(i),this.trigger(drama.plugins_.LocalStorage.prototype.cnds.OnError),[3,8];case 8:return[2]}})})},e.prototype.GetAllKeyNames=function(){return s(this,void 0,void 0,function(){var e,i,n,r,o;return c(this,function(t){switch(t.label){case 0:if(this.localForageInitFailed)return this.triggerStorageError("storage failed to initialise - may be disabled in browser settings"),[2];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,h.keys()];case 2:for(e=t.sent(),drama.clearArray(this.keyNamesList),i=0,n=e.length;i<n;++i)if(r=e[i],d.hasRequiredPrefix(r))this.keyNamesList.push(d.removePrefix(r));return this.runtime.trigger(drama.plugins_.LocalStorage.prototype.cnds.OnAllKeyNamesLoaded,this),[3,4];case 3:return o=t.sent(),this.errorMessage=d.getErrorString(o),this.runtime.trigger(drama.plugins_.LocalStorage.prototype.cnds.OnError,this),[3,4];case 4:return[2]}})})},e.prototype.upload=function(){return s(this,void 0,void 0,function(){return c(this,function(t){return[2]})})},e.prototype.download=function(){return s(this,void 0,void 0,function(){return c(this,function(t){return[2]})})},e.prototype.checkRemoteStorageExists=function(){return s(this,void 0,void 0,function(){var e;return c(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,a.serverApi.getCloundSaveStatus()];case 1:if(t.sent().utime)this.trigger(drama.plugins_.LocalStorage.prototype.cnds.OnRemoteStorageExists);else this.trigger(drama.plugins_.LocalStorage.prototype.cnds.OnRemoteStorageNotExists);return[3,3];case 2:return e=t.sent(),console.error(e),[3,3];case 3:return[2]}})})},e.prototype.synchronize=function(){return s(this,void 0,void 0,function(){var e,i,n,r,o,s,a,l;return c(this,function(t){switch(t.label){case 0:if(this.synchronizing)return[2];this.synchronizing=!0,t.label=1;case 1:return t.trys.push([1,23,24,25]),[4,h.getItem(u.Identifier.UTIME)];case 2:return e=t.sent(),[4,xf.serverApi.getCloundSaveStatus()];case 3:if(i=t.sent(),n=void 0,localStorage.getItem("xf_localstorage_characterId")!==xf.gameInfo.characterId)e=null;if(e)return[3,8];if(!i.utime)return[3,5];else return[4,this.downloadData(i)];case 4:return n=t.sent(),[3,7];case 5:if(i.utime)return[3,7];else return[4,this.uploadData(i,!0)];case 6:n=t.sent(),t.label=7;case 7:return[3,22];case 8:if(!(i.utime&&i.utime>e))return[3,20];else return[4,this.updateModalTime(i,e)];case 9:return t.sent(),[4,this.showModal()];case 10:return r=t.sent(),o="local"===r?"云端数据将被覆盖\n确定要使用本地游戏数据吗？":"本地数据将被覆盖\n确定要使用云端游戏数据吗？",[4,xf.MessageBox.alert(o)];case 11:if("confirm"!==t.sent())return[3,18];if("local"!==r)return[3,13];else return[4,this.uploadData(i,!0)];case 12:return n=t.sent(),[3,17];case 13:if("cloud"!==r)return[3,17];if(s=d.versionToNumber(i.game_version),a=d.versionToNumber(xf.gameInfo.version),!("cloud"===r&&parseFloat(s)<=parseFloat(a)))return[3,15];else return[4,this.downloadData(i)];case 14:return n=t.sent(),[3,17];case 15:return[4,xf.MessageBox.alert(window.trFunc("抱歉，您当前的游戏版本过旧\n请更新游戏后再使用云端数据。"))];case 16:throw t.sent(),new Error("当前游戏版本过旧, 取消同步。");case 17:return[3,19];case 18:throw new Error("用户取消同步。");case 19:return[3,22];case 20:return[4,this.uploadData(i,this.clear)];case 21:n=t.sent(),t.label=22;case 22:if(n)h.setItem(u.Identifier.UTIME,n.utime);return this.clear=!1,this.trigger(drama.plugins_.LocalStorage.prototype.cnds.onSynchronizeSuccess),[3,25];case 23:return l=t.sent(),console.error(l),this.errorMessage=d.getErrorString(l),this.trigger(drama.plugins_.LocalStorage.prototype.cnds.onSynchronizeError),this.trigger(drama.plugins_.LocalStorage.prototype.cnds.OnError),[3,25];case 24:return this.synchronizing=!1,localStorage.setItem("xf_localstorage_characterId",xf.gameInfo.characterId),[7];case 25:return[2]}})})},e}(o.default);e.default=l},"4f5d0dbbc4df297a":function(t,e,i){Object.defineProperty(e,"__esModule",{value:!0});var l=i("3ef79e4e773762de"),n=i("407b4704136fd4d1"),r=i("081ce22713c044b3"),c=axios.create({timeout:1e4});(e.webServer=c).interceptors.request.use(function(t){if(t.data)if(!t.data.json){var e=new URLSearchParams;for(var i in t.data)if(t.data.hasOwnProperty(i))e.append(i,t.data[i]);t.data=e}else delete t.data.json;return t},function(t){return Promise.reject(t)});c.interceptors.response.use(function(t){var e=t.data;if(1==e.status)return e.data;else if(9005==e.status)l.logout();else{switch(e.errInfo.code+""){case"9053":case"10013":location.href=window.xfConfig.gameNotFound}throw window.Sentry.captureMessage({request:JSON.stringify(t.config),response:JSON.stringify(t.data)}),new Error(JSON.stringify(e))}},function(t){var e=t&&t.config&&t.config.url;if(e){var i=t.config,n=i.headers.pf;if(-1<e.indexOf("/v1/player/game-initialize"))if(4==n&&"post"==i.method.toLowerCase()){var r,o=i.data;if("string"==typeof o)o=xf.parseQuery(i.data);r=l.getSignedData({gameId:o&&o.gameId,timestamp:l.getTimestamp(),random:l.getRandom()}),t.config.data=r}else if("get"==i.method.toLowerCase()){var s={};if("string"==typeof(a=i.params))a=xf.parseQuery(i.params);s=l.getSignedData({gameId:a.gameId,timestamp:l.getTimestamp(),random:l.getRandom(),platform:a.platform,fingerprint:a.fingerprint,gameVersion:a.gameVersion}),t.config.params=s}else return Promise.reject(t);if(-1<e.indexOf("/v2/player/game-login"))if("get"==i.method.toLowerCase()){var a;s={};if("string"==typeof(a=i.params))a=xf.parseQuery(i.params);s=l.getSignedData({playerId:a.playerId,token:a.token,gameId:a.gameId,platform:a.platform,deviceId:a.deviceId,timestamp:l.getTimestamp(),random:l.getRandom(),gameVersion:a.gameVersion}),t.config.params=s}else return Promise.reject(t);return function(t,e){var i=t.config;if(!i)return window.isSeiyaSdkLogining=!1,Promise.reject(t);if(i.__retryCount=i.__retryCount||0,4<=i.__retryCount)return Promise.reject(t);else return i.__retryCount+=1,new Promise(function(t){setTimeout(function(){t()},2e3*i.__retryCount||1)}).then(function(){return e(i)})}(t,c)}else console.log(t)});var o=axios.create({timeout:5e3});(e.gameServer=o).interceptors.request.use(function(t){return t.headers={"Content-Type":"application/json","Dr-Device-Id":xf.gameInfo.deviceId,"Dr-Player-Id":xf.gameInfo.playerId,"Dr-Character-Id":xf.gameInfo.characterId,"Dr-Game-Id":xf.gameInfo.gameId,"Dr-Game-Version":xf.gameInfo.version,"Dr-Token":xf.gameInfo.token,"Dr-Platform":n.Platform[xf.gameInfo.platform]},t},function(t){return Promise.reject(t)});o.interceptors.response.use(function(t){var e=t.data;if(1==e.status)return e.data;else{var i=new Error(JSON.stringify(e));if(i.status=e.status,i.info=e.info,10==e.status)throw l.logout(),i;var n=function(t){var e=-1;for(var i in r.urlCodeMap)if(-1<t.indexOf(i))e=r.urlCodeMap[i];return e}(t.config.url);if(-1===[71001,71103].indexOf(e.status))if(window.xfruntime)if(9005===e.status||9006===e.status||9007===e.status)l.logout(r.errorcodeMap[e.status+""].message);else xf.MessageBox.alert("错误："+e.info+"["+e.status+"]["+n+"]");else xf.XfLoginCanvas.showAlert("错误："+e.info+"["+e.status+"]["+n+"]",{cancelCallback:function(){xf.EvkLogin.start(xf.EvkLogin.startGame)},showConfirmButton:!1});throw window.Sentry.captureMessage({request:JSON.stringify(t.config),response:JSON.stringify(t.data)}),i}},function(t){return window.isSeiyaSdkLogining=!1,Promise.reject(t)})},"5609bc4b47cca1b4":function(t,e,i){i.r(e),e.default=function(t,e,i){if("function"==typeof e)t.then(e);if("function"==typeof i)t.catch(i)}},"7ec4778ef9e4f6b3":function(t,e,i){var r=this&&this.__awaiter||function(o,s,a,l){return new(a||(a=Promise))(function(t,e){function i(t){try{r(l.next(t))}catch(t){e(t)}}function n(t){try{r(l.throw(t))}catch(t){e(t)}}function r(e){e.done?t(e.value):new a(function(t){t(e.value)}).then(i,n)}r((l=l.apply(o,s||[])).next())})},o=this&&this.__generator||function(i,n){var r,o,s,t,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;if(o=0,s)e=[2&e[0],s.value];switch(e[0]){case 0:case 1:s=e;break;case 4:return a.label++,{value:e[1],done:!1};case 5:a.label++,o=e[1],e=[0];continue;case 7:e=a.ops.pop(),a.trys.pop();continue;default:if(!(s=0<(s=a.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){a=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){a.label=e[1];break}if(6===e[0]&&a.label<s[1]){a.label=s[1],s=e;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(e);break}if(s[2])a.ops.pop();a.trys.pop();continue}e=n.call(i,a)}catch(t){e=[6,t],o=0}finally{r=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}};Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function n(){}return n.init=function(){return r(this,void 0,void 0,function(){return o(this,function(t){return[2,new Promise(function(e,i){Promise.all([n.getAppInfo(),n.getAppVersion(),n.getDeviceID(),n.getSHA1Sign()]).then(function(t){if(!(t[0]&&t[0].appId&&t[0].appKey&&t[0].devid&&t[1]&&t[2]&&t[3]))throw new Error("\n                    获取没有游戏信息不全\n                    appId: "+t[0].appId+"\n                    appKey: "+t[0].appKey+"\n                    devid: "+t[0].devid+"\n                    version: "+t[1]+"\n                    deviceID: "+t[2]+"\n                    fingerprint: "+t[3]+"\n                ");else e({appId:t[0].appId,projectId:t[0].projectId,secretKey:t[0].appKey,devId:t[0].devid,version:t[1],deviceId:t[2],fingerprint:t[3]})}).catch(function(t){i(t)})})]})})},n.getAppInfo=function(){return new Promise(function(e,i){try{var t=window.cordova,n=window.xfConfig;if(t)t.plugins.DramaApplication.getAppInfo(function(t){e({appId:t.appid,appKey:t.appkey,devid:t.devid,projectId:t.projectid||n.projectId})},function(t){i(t)});else e(n)}catch(t){i(t)}})},n.getAppVersion=function(){var xfConfig=window.xfConfig;if(!xfConfig.version)return Promise.reject("没有获取到游戏版本");else return Promise.resolve(xfConfig.version)},n.getDeviceID=function(){return new Promise(function(e,t){try{var i=window.cordova;if(i)i.plugins.DramaApplication.getDeviceID(function(t){e(t||"cordova")},function(t){console.log(t),e("cordova")});else e("h5")}catch(t){}})},n.getChannelId=function(){return r(this,void 0,void 0,function(){var e,xfConfig;return o(this,function(t){switch(t.label){case 0:if(e="",xfConfig=window.xfConfig,!window.cordova)return[3,2];else return[4,n.cordovaGetChannelId()];case 1:return e=t.sent(),[3,3];case 2:if(window.eagleSDK)e=window.eagleSDK.getAllChannels().channelId;else if(window.xsSdk)e=window.xsSdk.getAllChannels().channelId;t.label=3;case 3:if(!e&&"preview"!=xfConfig.exportType)throw new Error("没有获取到channleId");else return[2,Promise.resolve(e)]}})})},n.cordovaGetChannelId=function(){return new Promise(function(e,t){window.cordova.plugins.SeiyaSdk.getChannelId(function(t){if(!t)throw new Error("没有获取到channleId");else e(t)},function(t){throw new Error(t)})})},n.getSHA1Sign=function(){if(window.cordova)return Promise.resolve("C7:59:3F:C0:98:E0:5F:C1:86:C5:48:B3:A8:0C:ED:D8:09:8B:D3:5C");else return Promise.resolve("h5")},n.getPreviewInfo=function(){var t=xf.parseQuery();if(!t.token)t=xf.parseQuery(window.localStorage.getItem("xf_debugger_search"));return{appId:t.gameId,projectId:t.projectId,devId:t.id,version:t.gameVersion,editorVersion:t.editorVersion,deviceId:"h5",gameType:t.gameType,channelId:"xingfei",secretKey:t.gameKey,login:void 0!==t.login?t.login:t.gameId?1:0,token:decodeURIComponent(t.token)}},n}();e.localApi=n,e.default=n},"8046905752873b0b":function(t,e,i){var n=this&&this.__assign||function(){return(n=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var r in e=arguments[i])if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r];return t}).apply(this,arguments)},o=this&&this.__awaiter||function(o,s,a,l){return new(a||(a=Promise))(function(t,e){function i(t){try{r(l.next(t))}catch(t){e(t)}}function n(t){try{r(l.throw(t))}catch(t){e(t)}}function r(e){e.done?t(e.value):new a(function(t){t(e.value)}).then(i,n)}r((l=l.apply(o,s||[])).next())})},s=this&&this.__generator||function(i,n){var r,o,s,t,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;if(o=0,s)e=[2&e[0],s.value];switch(e[0]){case 0:case 1:s=e;break;case 4:return a.label++,{value:e[1],done:!1};case 5:a.label++,o=e[1],e=[0];continue;case 7:e=a.ops.pop(),a.trys.pop();continue;default:if(!(s=0<(s=a.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){a=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){a.label=e[1];break}if(6===e[0]&&a.label<s[1]){a.label=s[1],s=e;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(e);break}if(s[2])a.ops.pop();a.trys.pop();continue}e=n.call(i,a)}catch(t){e=[6,t],o=0}finally{r=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}};Object.defineProperty(e,"__esModule",{value:!0});var a=i("4f5d0dbbc4df297a"),l=i("3ef79e4e773762de"),c=i("407b4704136fd4d1"),u=xfConfig.baseURL,r=function(){function t(){}return t.previewLogin=function(t){xf.gameInfo.gameExportType=xf.gameExportType.Preview;var e=l.getSignedData({gameId:t.gameId,timestamp:l.getTimestamp(),random:l.getRandom()});return a.webServer({url:u+"/v1/player/game-initialize",method:"post",data:e,headers:{userId:t.userId,token:t.token,pf:4,version:t.editorVersion}})},t.initGame=function(r){var t=this;return xf.gameInfo.gameExportType=xf.gameExportType.Game,new Promise(function(i,n){return o(t,void 0,void 0,function(){var e;return s(this,function(t){try{e=l.getSignedData({gameId:r.gameId,timestamp:l.getTimestamp(),random:l.getRandom(),platform:c.Platform[r.platform],fingerprint:r.fingerprint,gameVersion:r.version}),a.webServer.get(u+"/v1/player/game-initialize",{params:e}).then(function(t){if(xf.gameInfo.isCommercialized=t.data.flag,0===t.data.status)location.href=window.xfConfig.gameNotFound;else i(t.data)},function(t){n(t)})}catch(t){n(t)}return[2]})})})},t.loginCheck=function(t){var e=u+"/v2/player/game-login";return a.webServer.get(e,{params:l.getSignedData({playerId:t.userID,token:t.token,gameId:t.gameId,platform:c.Platform[t.platform],deviceId:t.deviceId,timestamp:l.getTimestamp(),random:l.getRandom(),gameVersion:t.gameVersion})})},t.refreshToken=function(t){var e=u+"/v2/player/game-login/refresh",i=l.getSignedData({playerId:t.userID,token:t.token,gameId:t.gameId,platform:c.Platform[t.platform],deviceId:t.deviceId,timestamp:l.getTimestamp(),random:l.getRandom(),gameVersion:t.gameVersion});return a.webServer.put(e,i)},t.queryArchive=function(){var t=u+"/v1/player/game-data/list";return new Promise(function(e,i){a.webServer({url:t,method:"get",params:l.getSignedData({playerId:xf.gameInfo.playerId,token:xf.gameInfo.token,gameId:xf.gameInfo.gameId,timestamp:l.getTimestamp(),random:l.getRandom(),gameVersion:xf.gameInfo.version,platform:c.Platform[xf.gameInfo.platform]})}).then(function(t){if(t&&t.gameData)e(t.gameData);i("服务器返回数据不正确")}).catch(function(t){i(t)})})},t.loadArchive=function(t){var e=u+"/v1/player/game-data/load";return a.webServer.get(e,{params:l.getSignedData({slot:t.slot,playerId:xf.gameInfo.playerId,token:xf.gameInfo.token,gameId:xf.gameInfo.gameId,timestamp:l.getTimestamp(),random:l.getRandom(),gameVersion:t.gameVersion,platform:c.Platform[xf.gameInfo.platform]})})},t.saveArchive=function(t){var r=u+"/v1/player/game-data/save",o=xf.sizeOfUTF8Str(t.data)/1024<<0;if(console.log("请求"+t.slot),o<200)return new Promise(function(e,i){var n=l.getSignedData({slot:t.slot,gameStatus:xf.gameInfo.isTest?0:1,isSandbox:xf.gameInfo.isSandbox?1:0,gameVersion:xf.gameInfo.version,md5Code:t.md5Code,dataSize:o,playerId:xf.gameInfo.playerId,dataTimestamp:l.getTimestamp(),token:xf.gameInfo.token,gameId:xf.gameInfo.gameId,timestamp:l.getTimestamp(),random:l.getRandom(),platform:c.Platform[xf.gameInfo.platform]});n.data=t.data,a.webServer.post(r,n).then(function(t){if(t)e(n);else i("没有返回")}).catch(function(t){i(t)})});else return Promise.reject("存档太大了")},t.queryMail=function(){var t=u+"/v1/player/mail";return a.webServer.get(t,{params:l.getSignedData({playerId:xf.gameInfo.playerId,token:xf.gameInfo.token,gameId:xf.gameInfo.gameId,timestamp:l.getTimestamp(),random:l.getRandom(),gameVersion:xf.gameInfo.version,platform:c.Platform[xf.gameInfo.platform]})})},t.queryOrder=function(t){var e=u+"/v1/player/order/"+t;return a.webServer.get(e,{params:l.getSignedData({playerId:xf.gameInfo.playerId,token:xf.gameInfo.token,gameId:xf.gameInfo.gameId,timestamp:l.getTimestamp(),random:l.getRandom()})})},t.queryAccount=function(){var t=u+"/v1/player/account";return a.webServer.get(t,{params:l.getSignedData({playerId:xf.gameInfo.playerId,token:xf.gameInfo.token,gameId:xf.gameInfo.gameId,timestamp:l.getTimestamp(),random:l.getRandom(),gameVersion:xf.gameInfo.version,platform:c.Platform[xf.gameInfo.platform]})})},t.queryBulletinList=function(){var t=u+"/v1/player/game-notice";return a.webServer.get(t,{params:l.getSignedData({playerId:xf.gameInfo.playerId,token:xf.gameInfo.token,gameId:xf.gameInfo.gameId,platform:c.Platform[xf.gameInfo.platform],timestamp:l.getTimestamp(),random:l.getRandom(),gameVersion:xf.gameInfo.version})})},t.queryBulletin=function(t){var e=u+"/v1/player/game-notice/detail";return a.webServer.get(e,{params:l.getSignedData({playerId:xf.gameInfo.playerId,token:xf.gameInfo.token,gameId:xf.gameInfo.gameId,platform:c.Platform[xf.gameInfo.platform],timestamp:l.getTimestamp(),random:l.getRandom(),gameVersion:xf.gameInfo.version,id:t})})},t.queryActivity=function(){var t=u+"/v1/player/game-activity";return a.webServer.get(t,{params:l.getSignedData({playerId:xf.gameInfo.playerId,token:xf.gameInfo.token,gameId:xf.gameInfo.gameId,platform:c.Platform[xf.gameInfo.platform],timestamp:l.getTimestamp(),random:l.getRandom()})})},t.getShareInfo=function(t){return new Promise(function(e,i){a.webServer.get(u+"/v1/player/game-share/info",{params:l.getSignedData({gameId:xf.gameInfo.gameId,id:t,random:l.getRandom(),timestamp:l.getTimestamp()})}).then(function(t){e(t)}).catch(function(t){i(t)})})},t.getAllShareInfo=function(t,n){return new Promise(function(e,i){a.webServer.get(u+"/v1/player/game-share/list",{params:l.getSignedDataByXfConfig({gameId:!t?xfConfig.appId:t,random:l.getRandom(),timestamp:l.getTimestamp()},n)}).then(function(t){e(t)}).catch(function(t){i(t)})})},t.getPcWhiteConfig=function(t){return new Promise(function(e,i){a.webServer.get(u+"/v1/player/h5-config",{params:l.getSignedData({gameId:!t?xfConfig.appId:t,configKey:"background",random:l.getRandom(),timestamp:l.getTimestamp()})}).then(function(t){e(t)}).catch(function(t){i(t)})})},t.getGameUrl=function(t){return a.webServer.get(u+"/v1/app/game-info/get-game-url",{params:{gameId:t,type:1}})},t.getPlayerPurchasedResources=function(t){var e=u+"/v1/player/purchased-resources/info",i=l.getSignedData(n({playerId:xf.gameInfo.playerId,token:xf.gameInfo.token,gameId:xf.gameInfo.gameId,timestamp:l.getTimestamp(),random:l.getRandom()},t));return a.webServer.get(e,{params:i})},t.createOrder=function(t){var e=u+"/v1/player/order",i=l.getSignedData(n({playerId:xf.gameInfo.playerId,token:xf.gameInfo.token,gameId:xf.gameInfo.gameId,platform:c.Platform[xf.gameInfo.platform],timestamp:l.getTimestamp(),random:l.getRandom(),did:xf.gameInfo.deviceId,roleId:xf.gameInfo.characterId,gameVersion:xf.gameInfo.version},t));return a.webServer.post(e,i)},t.getServerTime=function(){return a.webServer.get(u+"/v1/common/currentTime")},t}();e.webApi=r,e.default=r},"8463ce3906bbfa07":function(t,e,i){var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__awaiter||function(o,s,a,l){return new(a||(a=Promise))(function(t,e){function i(t){try{r(l.next(t))}catch(t){e(t)}}function n(t){try{r(l.throw(t))}catch(t){e(t)}}function r(e){e.done?t(e.value):new a(function(t){t(e.value)}).then(i,n)}r((l=l.apply(o,s||[])).next())})},v=this&&this.__generator||function(i,n){var r,o,s,t,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;if(o=0,s)e=[2&e[0],s.value];switch(e[0]){case 0:case 1:s=e;break;case 4:return a.label++,{value:e[1],done:!1};case 5:a.label++,o=e[1],e=[0];continue;case 7:e=a.ops.pop(),a.trys.pop();continue;default:if(!(s=0<(s=a.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){a=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){a.label=e[1];break}if(6===e[0]&&a.label<s[1]){a.label=s[1],s=e;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(e);break}if(s[2])a.ops.pop();a.trys.pop();continue}e=n.call(i,a)}catch(t){e=[6,t],o=0}finally{r=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}};Object.defineProperty(e,"__esModule",{value:!0});var s=i("e681aed280414b09"),f=i("04f59f2d8d55de90"),b=i("db60b47823f837ac"),m=i("32e7c8b6a69ee838"),a=i("c4df9453c68f5085"),l=!1,c=0,u=!0,h=!1;b.defineDriver(a.default);var d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.currentKey="",t.lastValue="",t.keyNamesList=[],t.errorMessage="",t.pendingSets=0,t.pendingGets=0,t.clear=!1,t.localForageInitFailed=!0,t.debugDataChanged=!0,t.storageCache={},t.synchronizing=!1,t.writeQueue={},t.writing=!1,t.wattingSync={},t}return r(t,e),t}(s.SDKInstanceBase),p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.onCreate=function(){var t=this;if(b.ready(function(){t.localForageInitFailed=!1,t.curType=b.driver(),console.log("使用的存档方式 -----\x3e",t.curType)}),this.runtime.tickMe(this),this.curType==b.INDEXEDDB)this.specialSyncCache();else this.syncCache()},e.prototype.tick=function(){if(!this.modal)this.modal=new xf.xfModal,this.modal.width=.6*this.runtime.original_width,this.modal.height=.6*this.runtime.original_height,this.modalInit();if(this.curType==b.INDEXEDDB)this.specialStorage();else this.storage()},e.prototype.onDestroy=function(){this.modal.destory(),this.modal=null,this.localBtn=null,this.cloudBtn=null},e.prototype.syncCache=function(){return o(this,void 0,void 0,function(){var e,i,n,r,o,s,a,l;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,8,,9]),[4,b.keys()];case 1:return e=t.sent(),[4,b.ready()];case 2:return t.sent(),i=this,[4,b.getItem(f.Identifier.WAITINGSYNC)];case 3:i.wattingSync=t.sent()||{},n=0,r=e,t.label=4;case 4:if(!(n<r.length))return[3,7];else return o=r[n],s=this.storageCache,a=o,[4,b.getItem(o)];case 5:s[a]=t.sent(),t.label=6;case 6:return n++,[3,4];case 7:return[3,9];case 8:return l=t.sent(),console.error(l),[3,9];case 9:return[2]}})})},e.prototype.specialSyncCache=function(){return o(this,void 0,void 0,function(){var u,e,i=this;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),[4,b.keys()];case 1:return u=t.sent(),[4,b.ready()];case 2:return t.sent(),b.createTransaction(b._dbInfo,"readonly",function(l,c){return o(i,void 0,void 0,function(){var e,i,n,r,o,s,a;return v(this,function(t){switch(t.label){case 0:if(l)throw console.error(l),l;return e=c.objectStore(b._dbInfo.storeName),[4,(i=this).storeGet(e,f.Identifier.WAITINGSYNC)];case 1:i.wattingSync=t.sent()||{},n=0,r=u,t.label=2;case 2:if(!(n<r.length))return[3,5];else return o=r[n],s=this.storageCache,a=o,[4,this.storeGet(e,o)];case 3:s[a]=t.sent(),t.label=4;case 4:return n++,[3,2];case 5:return[2]}})})}),[3,4];case 3:return e=t.sent(),console.error(e),[3,4];case 4:return[2]}})})},e.prototype.storePut=function(n,r,o){return new Promise(function(e,i){var t=n.put(o,r);t.onsuccess=function(t){e(t)},t.onerror=function(t){console.error(t),i(t.error)}})},e.prototype.storeGet=function(t,r){return new Promise(function(i,e){var n=t.get(r);n.onsuccess=function(t){var e=n.result;if(void 0===e)e=null;i(e)},n.onerror=function(t){e(t.error)}})},e.prototype.storage=function(){return o(this,void 0,void 0,function(){var e,i,n,r,o,s,a,l,c,u;return v(this,function(t){switch(t.label){case 0:if(this.writing||0===Object.keys(this.writeQueue).length||this.localForageInitFailed)return[2];t.label=1;case 1:return t.trys.push([1,11,,12]),this.writing=!0,[4,b.ready()];case 2:t.sent(),t.label=3;case 3:for(n in t.trys.push([3,9,,10]),e={},i=[],this.writeQueue)i.push(n);r=0,t.label=4;case 4:if(!(r<i.length))return[3,7];if(o=i[r],s=m.prefix+o,a=this.storageCache[o],!new RegExp(f.Identifier.UTIME+"|"+f.Identifier.WAITINGSYNC).test(s))this.wattingSync[s]=f.Operator.SET;return[4,b.setItem(s,a)];case 5:t.sent(),this.debugDataChanged=!0,this.pendingSets--,this.currentKey=o,this.lastValue=a,this.runtime.trigger(drama.plugins_.LocalStorage.prototype.cnds.OnAnyItemSet,this),this.runtime.trigger(drama.plugins_.LocalStorage.prototype.cnds.OnItemSet,this),this.currentKey="",this.lastValue="",e[o]=!0,t.label=6;case 6:return r++,[3,4];case 7:return[4,b.setItem(f.Identifier.WAITINGSYNC,this.wattingSync)];case 8:if(t.sent(),0===this.pendingSets)this.runtime.trigger(drama.plugins_.LocalStorage.prototype.cnds.OnAllSetsComplete,this);for(l in e)delete this.writeQueue[l];return this.writing=!1,[3,10];case 9:return c=t.sent(),console.error(c),this.errorMessage=m.getErrorString(c),this.runtime.trigger(drama.plugins_.LocalStorage.prototype.cnds.OnError,this),this.writing=!1,[3,10];case 10:return[3,12];case 11:return u=t.sent(),console.error(u),this.errorMessage=m.getErrorString(u),this.runtime.trigger(drama.plugins_.LocalStorage.prototype.cnds.OnError,this),this.writing=!1,[3,12];case 12:return[2]}})})},e.prototype.specialStorage=function(){return o(this,void 0,void 0,function(){var e,i=this;return v(this,function(t){switch(t.label){case 0:if(this.writing||0===Object.keys(this.writeQueue).length||this.localForageInitFailed)return[2];t.label=1;case 1:return t.trys.push([1,3,,4]),this.writing=!0,[4,b.ready()];case 2:return t.sent(),b.createTransaction(b._dbInfo,"readwrite",function(d,p){return o(i,void 0,void 0,function(){var e,i,n,r,o,s,a,l,c,u,h=this;return v(this,function(t){switch(t.label){case 0:if(d)throw console.error(d),this.writing=!1,d;e=p.objectStore(b._dbInfo.storeName),p.oncomplete=function(t){},p.onabort=p.onerror=function(){var t=p.error;h.errorMessage=m.getErrorString(t),h.runtime.trigger(drama.plugins_.LocalStorage.prototype.cnds.OnError,h),h.writing=!1},t.label=1;case 1:for(r in t.trys.push([1,7,,8]),i={},n=[],this.writeQueue)n.push(r);o=0,t.label=2;case 2:if(!(o<n.length))return[3,5];if(s=n[o],a=m.prefix+s,l=this.storageCache[s],!new RegExp(f.Identifier.UTIME+"|"+f.Identifier.WAITINGSYNC).test(a))this.wattingSync[a]=f.Operator.SET;return[4,this.storePut(e,a,l)];case 3:t.sent(),this.debugDataChanged=!0,this.pendingSets--,this.currentKey=s,this.lastValue=l,this.runtime.trigger(drama.plugins_.LocalStorage.prototype.cnds.OnAnyItemSet,this),this.runtime.trigger(drama.plugins_.LocalStorage.prototype.cnds.OnItemSet,this),this.currentKey="",this.lastValue="",i[s]=!0,t.label=4;case 4:return o++,[3,2];case 5:return[4,this.storePut(e,f.Identifier.WAITINGSYNC,this.wattingSync)];case 6:if(t.sent(),0===this.pendingSets)this.runtime.trigger(drama.plugins_.LocalStorage.prototype.cnds.OnAllSetsComplete,this);for(c in i)delete this.writeQueue[c];return this.writing=!1,[3,8];case 7:return u=t.sent(),console.error(u),this.errorMessage=m.getErrorString(u),this.runtime.trigger(drama.plugins_.LocalStorage.prototype.cnds.OnError,this),[3,8];case 8:return[2]}})})}),[3,4];case 3:return e=t.sent(),console.error(e),this.errorMessage=m.getErrorString(e),this.runtime.trigger(drama.plugins_.LocalStorage.prototype.cnds.OnError,this),this.writing=!1,[3,4];case 4:return[2]}})})},e.prototype.modalInit=function(){var t=this.modal,e=this.runtime.original_width/852,i=new xf.xfContainer;this.modal.setContentView(i);var n=new xf.xfText;n.defaultStyle=xf.TextStyle.create(),n.defaultStyle.vAlign=xf.VerticalAlign.TOP,n.alpha=1,n.defaultStyle.hAlign=xf.HorizontalAlign.CENTER,n.defaultStyle.size=16*e,n.defaultStyle.color="#161830",n.richText="检测到您当前的游戏数据不是最新的\n请选择需要同步的游戏版本。",n.x=.2*t.width,n.y=.15*t.height,n.width=.6*t.width,n.height=.2*t.height,i.addChild(n);var r=.6*t.width,o=.15*t.height,s=xf.createCanvas(r,o),a=s.getContext("2d");a.lineWidth=1,a.strokeRect(0,0,r-1,o-1);var l=new xf.xfUIButton(s);(this.cloudBtn=l).x=.2*t.width,l.y=.4*t.height,l.width=r,l.height=o,i.addChild(l);var c=new xf.xfUIButton(s);(this.localBtn=c).x=.2*t.width,c.y=.65*t.height,c.width=r,c.height=o,i.addChild(c)},e.prototype.updateModalTime=function(n,r){return o(this,void 0,void 0,function(){var e,i;return v(this,function(t){if(e="yyyy-MM-dd hh:mm:ss",i=this.runtime.original_width/852,this.cloudBtn.setText("使用云端游戏数据\n"+xf.formatDate(new Date(n.utime),e)+" [版本："+n.game_version+"]",16*i,"#161830"),r)this.localBtn.setText("使用本地游戏数据\n"+xf.formatDate(new Date(r),e)+" [版本："+xf.gameInfo.version+"]",16*i,"#161830");else this.localBtn.setText("使用本地游戏数据\n [版本："+xf.gameInfo.version+"]",16*i,"#161830");return[2]})})},e.prototype.showModal=function(){var i=this;return new Promise(function(t,e){i.cloudBtn.setCallback(function(){if(i.cloudBtn.state==xf.ButtonState.PRESSED)t("cloud"),i.modal.close()},i),i.localBtn.setCallback(function(){if(i.localBtn.state==xf.ButtonState.PRESSED)t("local"),i.modal.close()},i),i.modal.show()})},e.prototype.getDebuggerValues=function(t){if(!this.localForageInitFailed){var e,i;if(u)u=!1,t.push({title:"Local storage data",properties:[{name:"(loading...)",value:"(loading...)"}]}),this.cacheAllStorage();else if(h){var n=[];for(e in this.storageCache)if(this.storageCache.hasOwnProperty(e))i=this.storageCache[e],n.push({name:e,value:null===i?"(loading...)":i.toString()});if(n.length)n.sort(m.sortPropertiesAZ),t.push({title:"Local storage data",properties:n});if(!l&&this.debugDataChanged)this.cacheAllStorage()}else t.push({title:"Local storage data",properties:[{name:"(loading...)",value:"(loading...)"}]})}},e.prototype.onDebugValueEdited=function(t,n,r){var o=this;if(!this.localForageInitFailed)b.getItem(n,function(t,e){if(!t){var i=r;if("number"==typeof e)i=parseFloat(r);b.setItem(n,i,function(t,e){o.debugDataChanged=!0})}})},e.prototype.saveToJSON=function(){return{}},e.prototype.loadFromJSON=function(t){},e.prototype.triggerStorageError=function(t){this.errorMessage=t,this.trigger(drama.plugins_.LocalStorage.prototype.cnds.OnError)},e.prototype.cacheAllStorage=function(){return o(this,void 0,void 0,function(){var e,i,n,r,o,s,a;return v(this,function(t){switch(t.label){case 0:if(this.localForageInitFailed)return[2];this.debugDataChanged=!1,l=!0,t.label=1;case 1:return t.trys.push([1,9,,10]),[4,b.keys()];case 2:if(e=t.sent(),o={},0===(c=e.length))l=!1;m.removeItem(e,[f.Identifier.UTIME,f.Identifier.WAITINGSYNC]),i=0,n=e.length,t.label=3;case 3:if(!(i<n))return[3,8];if(r=e[i],o[r]=!0,!this.storageCache.hasOwnProperty(r))this.storageCache[r]=null;t.label=4;case 4:return t.trys.push([4,6,,7]),[4,b.getItem(r)];case 5:if(s=t.sent(),0===--c)l=!1;return this.storageCache[r]=s,[3,7];case 6:return t.sent(),[3,7];case 7:return++i,[3,3];case 8:for(r in this.storageCache)if(this.storageCache.hasOwnProperty(r)&&!o.hasOwnProperty(r))delete this.storageCache[r];return h=!0,[3,10];case 9:return a=t.sent(),console.log(a),l=!1,[3,10];case 10:return[2]}})})},e.prototype.formatOperations=function(g,y){return o(this,void 0,void 0,function(){var e,i,n,r,o,s,a,l,c,u,h,d,p,f,m;return v(this,function(t){switch(t.label){case 0:e=[],i=[],t.label=1;case 1:for(r in t.trys.push([1,8,,9]),n=[],g)n.push(r);o=0,t.label=2;case 2:if(!(o<n.length))return[3,7];if(s=n[o],!g[s])return[3,4];else return l=(a=e).push,c={operation:"set"},u={key:s},[4,b.getItem(s)];case 3:return l.apply(a,[(c.document=(u.val=t.sent(),u),c)]),[3,6];case 4:return d=(h=i).push,p={operation:"unset"},f={key:s},[4,b.getItem(s)];case 5:d.apply(h,[(p.document=(f.val=t.sent(),f),p)]),t.label=6;case 6:return o++,[3,2];case 7:return[2,[{operation:y?"clear":""}].concat(e,i)];case 8:return m=t.sent(),console.log(m),[2,[]];case 9:return[2]}})})},e.prototype.getLocalforageSize=function(){var t=0;for(var e in this.storageCache){var i=this.storageCache[e];if(null===i&&void 0===i)return;if("string"==typeof i)t+=i.length;else if("number"==typeof i)t+=4}return t},e.prototype.uploadData=function(c,u){if(void 0===u)u=!1;return o(this,void 0,void 0,function(){var e,i,n,r,o,s,a,l;return v(this,function(t){switch(t.label){case 0:if(!u)return[3,2];else return[4,b.keys()];case 1:for(e=t.sent(),m.removeItem(e,[f.Identifier.UTIME,f.Identifier.WAITINGSYNC]),i=0,n=e.length;i<n;++i)r=e[i],this.wattingSync[r]=f.Operator.SET;t.label=2;case 2:if(0===Object.keys(this.wattingSync).length&&!u)return[2];else return[4,this.getLocalforageSize()];case 3:if(5242880<(o=t.sent()))throw new Error("本地储存数据超出设定容量限制（5M）.");return a={cid:xf.gameInfo.characterId,game_id:xf.gameInfo.gameId,game_version:xf.gameInfo.version,utime:c.utime||0,storage_size:o||1},[4,this.formatOperations(this.wattingSync,u)];case 4:return a.operations=t.sent(),s=a,[4,xf.serverApi.syncCloudSaveData(s)];case 5:return l=t.sent(),[4,b.setItem(f.Identifier.WAITINGSYNC,{})];case 6:return t.sent(),this.wattingSync={},[2,l]}})})},e.prototype.downloadData=function(t){return o(this,void 0,void 0,function(){var e,i,n;return v(this,function(t){switch(t.label){case 0:return[4,xf.serverApi.getCloudSaveData()];case 1:return e=t.sent(),[4,b.clear()];case 2:for(n in t.sent(),this.debugDataChanged=!0,this.currentKey="",this.lastValue="",drama.clearArray(this.keyNamesList),i=[],e.storage)i.push(b.setItem(n,e.storage[n]));return[4,Promise.all(i)];case 3:return t.sent(),[4,b.setItem(f.Identifier.WAITINGSYNC,{})];case 4:return t.sent(),this.wattingSync={},[2,e]}})})},e}(e.Property=d);e.default=p},"97b40a908b612952":function(t,e,i){(function(t){if("function"!=typeof t.Promise)t.Promise=i("03ce133e39706a78")}).call(this,i("0ee4763173a9a955"))},c480acbf11a0e009:function(t,e,i){function n(){if(arguments.length&&"function"==typeof arguments[arguments.length-1])return arguments[arguments.length-1]}i.r(e),i.d(e,"default",function(){return n})},c4df9453c68f5085:function(t,e,i){Object.defineProperty(e,"__esModule",{value:!0});var r,n=i("d295decbe3e1509c"),o=i("d1c614535d8d726e"),a=i("1799653e8ebaa01e"),u=i("3f35f1f171b3ae13"),c=i("4a7767f772d695fe"),s=i("5609bc4b47cca1b4"),h=i("1f9dc66ac05d14e4"),l=i("c480acbf11a0e009"),d="local-forage-detect-blob-support",p={},f=Object.prototype.toString,m="readonly",g="readwrite";function y(t){if("boolean"==typeof r)return u.default.resolve(r);else return(n=t,new u.default(function(i){var t=n.transaction(d,g),e=o.default([""]);t.objectStore(d).put(e,"key"),t.onabort=function(t){t.preventDefault(),t.stopPropagation(),i(!1)},t.oncomplete=function(){var t=navigator.userAgent.match(/Chrome\/(\d+)/),e=navigator.userAgent.match(/Edge\//);i(e||!t||43<=parseInt(t[1],10))}}).catch(function(){return!1})).then(function(t){return r=t});var n}function v(t){var e=p[t.name],i={promise:null,resolve:null,reject:null};if(i.promise=new u.default(function(t,e){i.resolve=t,i.reject=e}),e.deferredOperations.push(i),!e.dbReady)e.dbReady=i.promise;else e.dbReady=e.dbReady.then(function(){return i.promise})}function b(t){var e=p[t.name].deferredOperations.pop();if(e)return e.resolve(),e.promise}function _(t,e){var i=p[t.name].deferredOperations.pop();if(i)return i.reject(e),i.promise}function w(r,o){return new u.default(function(t,e){if(p[r.name]=p[r.name]||{forages:[],db:null,dbReady:null,deferredOperations:[]},r.db)if(o)v(r),r.db.close();else return t(r.db);var i=[r.name];if(o)i.push(r.version);var n=a.default.open.apply(a.default,i);if(o)n.onupgradeneeded=function(e){var t=n.result;try{if(t.createObjectStore(r.storeName),e.oldVersion<=1)t.createObjectStore(d)}catch(t){if("ConstraintError"===t.name)console.warn('The database "'+r.name+'" has been upgraded from version '+e.oldVersion+" to version "+e.newVersion+', but the storage "'+r.storeName+'" already exists.');else throw t}};n.onerror=function(t){t.preventDefault(),e(n.error)},n.onsuccess=function(){t(n.result),b(r)}})}function x(t){return w(t,!1)}function S(t){return w(t,!0)}function I(t,e){if(!t.db)return!0;var i=!t.db.objectStoreNames.contains(t.storeName),n=t.version<t.db.version,r=t.version>t.db.version;if(n){if(t.version!==e)console.warn('The database "'+t.name+"\" can't be downgraded from version "+t.db.version+" to version "+t.version+".");t.version=t.db.version}if(r||i){if(i){var o=t.db.version+1;if(o>t.version)t.version=o}return!0}return!1}function T(n){return new u.default(function(i,t){var e=new FileReader;e.onerror=t,e.onloadend=function(t){var e=btoa(t.target.result||"");i({__local_forage_encoded_blob:!0,data:e,type:n.type})},e.readAsBinaryString(n)})}function C(t){var e=function(t){for(var e=t.length,i=new ArrayBuffer(e),n=new Uint8Array(i),r=0;r<e;r++)n[r]=t.charCodeAt(r);return i}(atob(t.data));return o.default([e],{type:t.type})}function O(t){return t&&t.__local_forage_encoded_blob}function P(t){var e=this,i=e._initReady().then(function(){var t=p[e._dbInfo.name];if(t&&t.dbReady)return t.dbReady});return s.default(i,t,t),i}function E(e,i,n,r){if(void 0===r)r=1;try{var t=e.db.transaction(e.storeName,i);n(null,t)}catch(t){if(0<r&&(!e.db||"InvalidStateError"===t.name||"NotFoundError"===t.name))return u.default.resolve().then(function(){if(!e.db||"NotFoundError"===t.name&&!e.db.objectStoreNames.contains(e.storeName)&&e.version<=e.db.version){if(e.db)e.version=e.db.version+1;return S(e)}}).then(function(){return function(i){v(i);for(var n=p[i.name],r=n.forages,t=0;t<r.length;t++){var e=r[t];if(e._dbInfo.db)e._dbInfo.db.close(),e._dbInfo.db=null}return i.db=null,x(i).then(function(t){if(i.db=t,I(i))return S(i);else return t}).then(function(t){i.db=n.db=t;for(var e=0;e<r.length;e++)r[e]._dbInfo.db=t}).catch(function(t){throw _(i,t),t})}(e).then(function(){E(e,i,n,r-1)})}).catch(n);n(t)}}var A={_driver:"asyncStorage",_initStorage:function(t){var n=this,r={db:null,name:"",version:0};if(t)for(var e in t)r[e]=t[e];var o=p[r.name];if(!o)o={forages:[],db:null,dbReady:null,deferredOperations:[]},p[r.name]=o;if(o.forages.push(n),!n._initReady)n._initReady=n.ready,n.ready=P;var i=[];function s(){return u.default.resolve()}for(var a=0;a<o.forages.length;a++){var l=o.forages[a];if(l!==n)i.push(l._initReady().catch(s))}var c=o.forages.slice(0);return u.default.all(i).then(function(){return r.db=o.db,x(r)}).then(function(t){if(r.db=t,I(r,n._defaultConfig.version))return S(r);else return t}).then(function(t){r.db=o.db=t,n._dbInfo=r;for(var e=0;e<c.length;e++){var i=c[e];if(i!==n)i._dbInfo.db=r.db,i._dbInfo.version=r.version}})},_support:n.default(),iterate:function(s,t){var a=this,e=new u.default(function(o,i){a.ready().then(function(){E(a._dbInfo,m,function(t,e){if(t)return i(t);try{var n=e.objectStore(a._dbInfo.storeName).openCursor(),r=1;n.onsuccess=function(){var t=n.result;if(t){var e=t.value;if(O(e))e=C(e);var i=s(e,t.key,r++);if(void 0!==i)o(i);else t.continue()}else o()},n.onerror=function(){i(n.error)}}catch(t){i(t)}})}).catch(i)});return c.default(e,t),e},getItem:function(o,t){var s=this;o=h.default(o);var e=new u.default(function(n,r){s.ready().then(function(){E(s._dbInfo,m,function(t,e){if(t)return r(t);try{var i=e.objectStore(s._dbInfo.storeName).get(o);i.onsuccess=function(){var t=i.result;if(void 0===t)t=null;if(O(t))t=C(t);n(t)},i.onerror=function(){r(i.error)}}catch(t){r(t)}})}).catch(r)});return c.default(e,t),e},setItem:function(a,e,t){var l=this;a=h.default(a);var i=new u.default(function(o,s){var t;l.ready().then(function(){if(t=l._dbInfo,"[object Blob]"===f.call(e))return y(t.db).then(function(t){if(t)return e;else return T(e)});else return e}).then(function(r){E(l._dbInfo,g,function(t,e){if(t)return s(t);try{var i=e.objectStore(l._dbInfo.storeName);if(null===r)r=void 0;var n=i.put(r,a);e.oncomplete=function(){if(void 0===r)r=null;o(r)},e.onabort=e.onerror=function(){var t=n.error?n.error:n.transaction.error;s(t)}}catch(t){s(t)}})}).catch(s)});return c.default(i,t),i},removeItem:function(o,t){var s=this;o=h.default(o);var e=new u.default(function(n,r){s.ready().then(function(){E(s._dbInfo,g,function(t,e){if(t)return r(t);try{var i=e.objectStore(s._dbInfo.storeName).delete(o);e.oncomplete=function(){n()},e.onerror=function(){r(i.error)},e.onabort=function(){var t=i.error?i.error:i.transaction.error;r(t)}}catch(t){r(t)}})}).catch(r)});return c.default(e,t),e},clear:function(t){var o=this,e=new u.default(function(n,r){o.ready().then(function(){E(o._dbInfo,g,function(t,e){if(t)return r(t);try{var i=e.objectStore(o._dbInfo.storeName).clear();e.oncomplete=function(){n()},e.onabort=e.onerror=function(){var t=i.error?i.error:i.transaction.error;r(t)}}catch(t){r(t)}})}).catch(r)});return c.default(e,t),e},length:function(t){var o=this,e=new u.default(function(n,r){o.ready().then(function(){E(o._dbInfo,m,function(t,e){if(t)return r(t);try{var i=e.objectStore(o._dbInfo.storeName).count();i.onsuccess=function(){n(i.result)},i.onerror=function(){r(i.error)}}catch(t){r(t)}})}).catch(r)});return c.default(e,t),e},key:function(a,t){var l=this,e=new u.default(function(o,s){if(!(a<0))l.ready().then(function(){E(l._dbInfo,m,function(t,e){if(t)return s(t);try{var i=e.objectStore(l._dbInfo.storeName),n=!1,r=i.openCursor();r.onsuccess=function(){var t=r.result;if(t)if(0===a)o(t.key);else if(!n)n=!0,t.advance(a);else o(t.key);else o(null)},r.onerror=function(){s(r.error)}}catch(t){s(t)}})}).catch(s);else o(null)});return c.default(e,t),e},keys:function(t){var s=this,e=new u.default(function(r,o){s.ready().then(function(){E(s._dbInfo,m,function(t,e){if(t)return o(t);try{var i=e.objectStore(s._dbInfo.storeName).openCursor(),n=[];i.onsuccess=function(){var t=i.result;if(t)n.push(t.key),t.continue();else r(n)},i.onerror=function(){o(i.error)}}catch(t){o(t)}})}).catch(o)});return c.default(e,t),e},dropInstance:function(s,t){t=l.default.apply(this,arguments);var e,i=this.config();if(!(s="function"!=typeof s&&s||{}).name)s.name=s.name||i.name,s.storeName=s.storeName||i.storeName;if(!s.name)e=u.default.reject("Invalid arguments");else{var n=s.name===i.name&&this._dbInfo.db?u.default.resolve(this._dbInfo.db):x(s).then(function(t){var e=p[s.name],i=e.forages;e.db=t;for(var n=0;n<i.length;n++)i[n]._dbInfo.db=t;return t});if(!s.storeName)e=n.then(function(t){v(s);var i=p[s.name],n=i.forages;t.close();for(var e=0;e<n.length;e++)n[e]._dbInfo.db=null;return new u.default(function(e,i){var n=a.default.deleteDatabase(s.name);n.onerror=n.onblocked=function(t){var e=n.result;if(e)e.close();i(t)},n.onsuccess=function(){var t=n.result;if(t)t.close();e(t)}}).then(function(t){i.db=t;for(var e=0;e<n.length;e++)b(n[e]._dbInfo)}).catch(function(t){throw(_(s,t)||u.default.resolve()).catch(function(){}),t})});else e=n.then(function(t){if(t.objectStoreNames.contains(s.storeName)){var r=t.version+1;v(s);var n=p[s.name],o=n.forages;t.close();for(var e=0;e<o.length;e++){var i=o[e];i._dbInfo.db=null,i._dbInfo.version=r}return new u.default(function(e,i){var n=a.default.open(s.name,r);n.onerror=function(t){n.result.close(),i(t)},n.onupgradeneeded=function(){n.result.deleteObjectStore(s.storeName)},n.onsuccess=function(){var t=n.result;t.close(),e(t)}}).then(function(t){n.db=t;for(var e=0;e<o.length;e++){var i=o[e];i._dbInfo.db=t,b(i._dbInfo)}}).catch(function(t){throw(_(s,t)||u.default.resolve()).catch(function(){}),t})}})}return c.default(e,t),e},createTransaction:E,_checkBlobSupport:y,_encodeBlob:T,normalizeKey:h.default};e.default=A},d1c614535d8d726e:function(t,e,i){i.r(e),e.default=function(e,i){e=e||[],i=i||{};try{return new Blob(e,i)}catch(t){if("TypeError"!==t.name)throw t;for(var n=new("undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),r=0;r<e.length;r+=1)n.append(e[r]);return n.getBlob(i.type)}}},d27c30dad6345543:function(t,e,i){Object.defineProperty(e,"__esModule",{value:!0});var n=function(){};e.DefendedBase=n},d295decbe3e1509c:function(t,e,i){i.r(e);var n=i("1799653e8ebaa01e");e.default=function(){try{if(!n.default)return!1;var t="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),e="function"==typeof fetch&&-1!==fetch.toString().indexOf("[native code");return(!t||e)&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange}catch(t){return!1}}},db60b47823f837ac:function(e,t,i){(function(n){var u;!function(t){if(1)e.exports=function r(o,s,a){function l(i,t){if(!s[i]){if(!o[i]){if(0)return u(i,!0);if(c)return c(i,!0);var e=new Error("Cannot find module '"+i+"'");throw e.code="MODULE_NOT_FOUND",e}var n=s[i]={exports:{}};o[i][0].call(n.exports,function(t){var e=o[i][1][t];return l(e?e:t)},n,n.exports,r,o,s,a)}return s[i].exports}for(var c=!1,t=0;t<a.length;t++)l(a[t]);return l}({1:[function(t,u,e){(function(e){var i,n,t=e.MutationObserver||e.WebKitMutationObserver;if(t){var r=0,o=new t(c),s=e.document.createTextNode("");o.observe(s,{characterData:!0}),i=function(){s.data=r=++r%2}}else if(!e.setImmediate&&void 0!==e.MessageChannel){var a=new e.MessageChannel;a.port1.onmessage=c,i=function(){a.port2.postMessage(0)}}else if("document"in e&&"onreadystatechange"in e.document.createElement("script"))i=function(){var t=e.document.createElement("script");t.onreadystatechange=function(){c(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},e.document.documentElement.appendChild(t)};else i=function(){setTimeout(c,0)};var l=[];function c(){var t,e;n=!0;for(var i=l.length;i;){for(e=l,l=[],t=-1;++t<i;)e[t]();i=l.length}n=!1}u.exports=function(t){if(1===l.push(t)&&!n)i()}}).call(this,void 0!==n?n:"undefined"!=typeof self?self:void 0!==window?window:{})},{}],2:[function(t,e,i){var r=t(1);function c(){}var u={},o=["REJECTED"],s=["FULFILLED"],a=["PENDING"];function n(t){if("function"!=typeof t)throw new TypeError("resolver must be a function");if(this.state=a,this.queue=[],this.outcome=void 0,t!==c)p(this,t)}function l(t,e,i){if(this.promise=t,"function"==typeof e)this.onFulfilled=e,this.callFulfilled=this.otherCallFulfilled;if("function"==typeof i)this.onRejected=i,this.callRejected=this.otherCallRejected}function h(e,i,n){r(function(){var t;try{t=i(n)}catch(t){return u.reject(e,t)}if(t===e)u.reject(e,new TypeError("Cannot resolve promise with itself"));else u.resolve(e,t)})}function d(t){var e=t&&t.then;if(t&&("object"===_typeof2(t)||"function"==typeof t)&&"function"==typeof e)return function(){e.apply(t,arguments)}}function p(e,t){var i=!1;function n(t){if(!i)i=!0,u.reject(e,t)}function r(t){if(!i)i=!0,u.resolve(e,t)}var o=f(function(){t(r,n)});if("error"===o.status)n(o.value)}function f(t,e){var i={};try{i.value=t(e),i.status="success"}catch(t){i.status="error",i.value=t}return i}(e.exports=n).prototype.catch=function(t){return this.then(null,t)},n.prototype.then=function(t,e){if("function"!=typeof t&&this.state===s||"function"!=typeof e&&this.state===o)return this;var i=new this.constructor(c);if(this.state!==a){var n=this.state===s?t:e;h(i,n,this.outcome)}else this.queue.push(new l(i,t,e));return i},l.prototype.callFulfilled=function(t){u.resolve(this.promise,t)},l.prototype.otherCallFulfilled=function(t){h(this.promise,this.onFulfilled,t)},l.prototype.callRejected=function(t){u.reject(this.promise,t)},l.prototype.otherCallRejected=function(t){h(this.promise,this.onRejected,t)},u.resolve=function(t,e){var i=f(d,e);if("error"===i.status)return u.reject(t,i.value);var n=i.value;if(n)p(t,n);else{t.state=s,t.outcome=e;for(var r=-1,o=t.queue.length;++r<o;)t.queue[r].callFulfilled(e)}return t},u.reject=function(t,e){t.state=o,t.outcome=e;for(var i=-1,n=t.queue.length;++i<n;)t.queue[i].callRejected(e);return t},n.resolve=function(t){if(t instanceof this)return t;else return u.resolve(new this(c),t)},n.reject=function(t){var e=new this(c);return u.reject(e,t)},n.all=function(t){var i=this;if("[object Array]"!==Object.prototype.toString.call(t))return this.reject(new TypeError("must be an array"));var n=t.length,r=!1;if(!n)return this.resolve([]);for(var o=new Array(n),s=0,e=-1,a=new this(c);++e<n;)l(t[e],e);return a;function l(t,e){i.resolve(t).then(function(t){if(o[e]=t,++s===n&&!r)r=!0,u.resolve(a,o)},function(t){if(!r)r=!0,u.reject(a,t)})}},n.race=function(t){var e=this;if("[object Array]"!==Object.prototype.toString.call(t))return this.reject(new TypeError("must be an array"));var i=t.length,n=!1;if(!i)return this.resolve([]);for(var r,o=-1,s=new this(c);++o<i;)r=t[o],e.resolve(r).then(function(t){if(!n)n=!0,u.resolve(s,t)},function(t){if(!n)n=!0,u.reject(s,t)});return s}},{1:1}],3:[function(e,t,i){(function(t){if("function"!=typeof t.Promise)t.Promise=e(2)}).call(this,void 0!==n?n:"undefined"!=typeof self?self:void 0!==window?window:{})},{2:2}],4:[function(t,e,i){var n="function"==typeof Symbol&&"symbol"===_typeof2(Symbol.iterator)?function(t){return _typeof2(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":_typeof2(t)},l=function(){try{if("undefined"!=typeof indexedDB)return indexedDB;if("undefined"!=typeof webkitIndexedDB)return webkitIndexedDB;if("undefined"!=typeof mozIndexedDB)return mozIndexedDB;if("undefined"!=typeof OIndexedDB)return OIndexedDB;if("undefined"!=typeof msIndexedDB)return msIndexedDB}catch(t){return}}();function s(e,i){e=e||[],i=i||{};try{return new Blob(e,i)}catch(t){if("TypeError"!==t.name)throw t;for(var n="undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder,r=new n,o=0;o<e.length;o+=1)r.append(e[o]);return r.getBlob(i.type)}}if("undefined"==typeof Promise)t(3);var h=Promise;function d(t,e){if(e)t.then(function(t){e(null,t)},function(t){e(t)})}function c(t,e,i){if("function"==typeof e)t.then(e);if("function"==typeof i)t.catch(i)}function u(t){if("string"!=typeof t)console.warn(t+" used as a key, but it is not a string."),t=String(t);return t}function o(){if(arguments.length&&"function"==typeof arguments[arguments.length-1])return arguments[arguments.length-1]}var a="local-forage-detect-blob-support",r=void 0,p={},f=Object.prototype.toString,m="readonly",g="readwrite";function y(t){if("boolean"==typeof r)return h.resolve(r);else return(n=t,new h(function(i){var t=n.transaction(a,g),e=s([""]);t.objectStore(a).put(e,"key"),t.onabort=function(t){t.preventDefault(),t.stopPropagation(),i(!1)},t.oncomplete=function(){var t=navigator.userAgent.match(/Chrome\/(\d+)/),e=navigator.userAgent.match(/Edge\//);i(e||!t||43<=parseInt(t[1],10))}}).catch(function(){return!1})).then(function(t){return r=t});var n}function v(t){var e=p[t.name],i={};if(i.promise=new h(function(t,e){i.resolve=t,i.reject=e}),e.deferredOperations.push(i),!e.dbReady)e.dbReady=i.promise;else e.dbReady=e.dbReady.then(function(){return i.promise})}function b(t){var e=p[t.name],i=e.deferredOperations.pop();if(i)return i.resolve(),i.promise}function _(t,e){var i=p[t.name],n=i.deferredOperations.pop();if(n)return n.reject(e),n.promise}function w(r,o){return new h(function(t,e){if(p[r.name]=p[r.name]||{forages:[],db:null,dbReady:null,deferredOperations:[]},r.db)if(o)v(r),r.db.close();else return t(r.db);var i=[r.name];if(o)i.push(r.version);var n=l.open.apply(l,i);if(o)n.onupgradeneeded=function(e){var t=n.result;try{if(t.createObjectStore(r.storeName),e.oldVersion<=1)t.createObjectStore(a)}catch(t){if("ConstraintError"===t.name)console.warn('The database "'+r.name+'" has been upgraded from version '+e.oldVersion+" to version "+e.newVersion+', but the storage "'+r.storeName+'" already exists.');else throw t}};n.onerror=function(t){t.preventDefault(),e(n.error)},n.onsuccess=function(){t(n.result),b(r)}})}function x(t){return w(t,!1)}function S(t){return w(t,!0)}function I(t,e){if(!t.db)return!0;var i=!t.db.objectStoreNames.contains(t.storeName),n=t.version<t.db.version,r=t.version>t.db.version;if(n){if(t.version!==e)console.warn('The database "'+t.name+"\" can't be downgraded from version "+t.db.version+" to version "+t.version+".");t.version=t.db.version}if(r||i){if(i){var o=t.db.version+1;if(o>t.version)t.version=o}return!0}return!1}function T(t){var e=function(t){for(var e=t.length,i=new ArrayBuffer(e),n=new Uint8Array(i),r=0;r<e;r++)n[r]=t.charCodeAt(r);return i}(atob(t.data));return s([e],{type:t.type})}function C(t){return t&&t.__local_forage_encoded_blob}function O(t){var e=this,i=e._initReady().then(function(){var t=p[e._dbInfo.name];if(t&&t.dbReady)return t.dbReady});return c(i,t,t),i}function P(e,i,n,r){if(void 0===r)r=1;try{var t=e.db.transaction(e.storeName,i);n(null,t)}catch(t){if(0<r&&(!e.db||"InvalidStateError"===t.name||"NotFoundError"===t.name))return h.resolve().then(function(){if(!e.db||"NotFoundError"===t.name&&!e.db.objectStoreNames.contains(e.storeName)&&e.version<=e.db.version){if(e.db)e.version=e.db.version+1;return S(e)}}).then(function(){return function(i){v(i);for(var n=p[i.name],r=n.forages,t=0;t<r.length;t++){var e=r[t];if(e._dbInfo.db)e._dbInfo.db.close(),e._dbInfo.db=null}return i.db=null,x(i).then(function(t){if(i.db=t,I(i))return S(i);else return t}).then(function(t){i.db=n.db=t;for(var e=0;e<r.length;e++)r[e]._dbInfo.db=t}).catch(function(t){throw _(i,t),t})}(e).then(function(){P(e,i,n,r-1)})}).catch(n);n(t)}}var E={_driver:"asyncStorage",_initStorage:function(t){var n=this,r={db:null};if(t)for(var e in t)r[e]=t[e];var o=p[r.name];if(!o)o={forages:[],db:null,dbReady:null,deferredOperations:[]},p[r.name]=o;if(o.forages.push(n),!n._initReady)n._initReady=n.ready,n.ready=O;var i=[];function s(){return h.resolve()}for(var a=0;a<o.forages.length;a++){var l=o.forages[a];if(l!==n)i.push(l._initReady().catch(s))}var c=o.forages.slice(0);return h.all(i).then(function(){return r.db=o.db,x(r)}).then(function(t){if(r.db=t,I(r,n._defaultConfig.version))return S(r);else return t}).then(function(t){r.db=o.db=t,n._dbInfo=r;for(var e=0;e<c.length;e++){var i=c[e];if(i!==n)i._dbInfo.db=r.db,i._dbInfo.version=r.version}})},_support:function(){try{if(!l)return!1;var t="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),e="function"==typeof fetch&&-1!==fetch.toString().indexOf("[native code");return(!t||e)&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange}catch(t){return!1}}(),iterate:function(a,t){var l=this,e=new h(function(o,s){l.ready().then(function(){P(l._dbInfo,m,function(t,e){if(t)return s(t);try{var i=e.objectStore(l._dbInfo.storeName),n=i.openCursor(),r=1;n.onsuccess=function(){var t=n.result;if(t){var e=t.value;if(C(e))e=T(e);var i=a(e,t.key,r++);if(void 0!==i)o(i);else t.continue()}else o()},n.onerror=function(){s(n.error)}}catch(t){s(t)}})}).catch(s)});return d(e,t),e},getItem:function(s,t){var a=this;s=u(s);var e=new h(function(r,o){a.ready().then(function(){P(a._dbInfo,m,function(t,e){if(t)return o(t);try{var i=e.objectStore(a._dbInfo.storeName),n=i.get(s);n.onsuccess=function(){var t=n.result;if(void 0===t)t=null;if(C(t))t=T(t);r(t)},n.onerror=function(){o(n.error)}}catch(t){o(t)}})}).catch(o)});return d(e,t),e},setItem:function(a,e,t){var l=this;a=u(a);var i=new h(function(o,s){var t;l.ready().then(function(){if(t=l._dbInfo,"[object Blob]"===f.call(e))return y(t.db).then(function(t){if(t)return e;else return n=e,new h(function(i,t){var e=new FileReader;e.onerror=t,e.onloadend=function(t){var e=btoa(t.target.result||"");i({__local_forage_encoded_blob:!0,data:e,type:n.type})},e.readAsBinaryString(n)});var n});else return e}).then(function(r){P(l._dbInfo,g,function(t,e){if(t)return s(t);try{var i=e.objectStore(l._dbInfo.storeName);if(null===r)r=void 0;var n=i.put(r,a);e.oncomplete=function(){if(void 0===r)r=null;o(r)},e.onabort=e.onerror=function(){var t=n.error?n.error:n.transaction.error;s(t)}}catch(t){s(t)}})}).catch(s)});return d(i,t),i},removeItem:function(s,t){var a=this;s=u(s);var e=new h(function(r,o){a.ready().then(function(){P(a._dbInfo,g,function(t,e){if(t)return o(t);try{var i=e.objectStore(a._dbInfo.storeName),n=i.delete(s);e.oncomplete=function(){r()},e.onerror=function(){o(n.error)},e.onabort=function(){var t=n.error?n.error:n.transaction.error;o(t)}}catch(t){o(t)}})}).catch(o)});return d(e,t),e},clear:function(t){var s=this,e=new h(function(r,o){s.ready().then(function(){P(s._dbInfo,g,function(t,e){if(t)return o(t);try{var i=e.objectStore(s._dbInfo.storeName),n=i.clear();e.oncomplete=function(){r()},e.onabort=e.onerror=function(){var t=n.error?n.error:n.transaction.error;o(t)}}catch(t){o(t)}})}).catch(o)});return d(e,t),e},length:function(t){var s=this,e=new h(function(r,o){s.ready().then(function(){P(s._dbInfo,m,function(t,e){if(t)return o(t);try{var i=e.objectStore(s._dbInfo.storeName),n=i.count();n.onsuccess=function(){r(n.result)},n.onerror=function(){o(n.error)}}catch(t){o(t)}})}).catch(o)});return d(e,t),e},key:function(a,t){var l=this,e=new h(function(o,s){if(!(a<0))l.ready().then(function(){P(l._dbInfo,m,function(t,e){if(t)return s(t);try{var i=e.objectStore(l._dbInfo.storeName),n=!1,r=i.openCursor();r.onsuccess=function(){var t=r.result;if(t)if(0===a)o(t.key);else if(!n)n=!0,t.advance(a);else o(t.key);else o(null)},r.onerror=function(){s(r.error)}}catch(t){s(t)}})}).catch(s);else o(null)});return d(e,t),e},keys:function(t){var a=this,e=new h(function(o,s){a.ready().then(function(){P(a._dbInfo,m,function(t,e){if(t)return s(t);try{var i=e.objectStore(a._dbInfo.storeName),n=i.openCursor(),r=[];n.onsuccess=function(){var t=n.result;if(t)r.push(t.key),t.continue();else o(r)},n.onerror=function(){s(n.error)}}catch(t){s(t)}})}).catch(s)});return d(e,t),e},dropInstance:function(a,t){t=o.apply(this,arguments);var e,i=this.config();if(!(a="function"!=typeof a&&a||{}).name)a.name=a.name||i.name,a.storeName=a.storeName||i.storeName;if(!a.name)e=h.reject("Invalid arguments");else{var n=a.name===i.name&&this._dbInfo.db,r=n?h.resolve(this._dbInfo.db):x(a).then(function(t){var e=p[a.name],i=e.forages;e.db=t;for(var n=0;n<i.length;n++)i[n]._dbInfo.db=t;return t});if(!a.storeName)e=r.then(function(t){v(a);var n=p[a.name],r=n.forages;t.close();for(var e=0;e<r.length;e++){var i=r[e];i._dbInfo.db=null}var o=new h(function(e,i){var n=l.deleteDatabase(a.name);n.onerror=n.onblocked=function(t){var e=n.result;if(e)e.close();i(t)},n.onsuccess=function(){var t=n.result;if(t)t.close();e(t)}});return o.then(function(t){n.db=t;for(var e=0;e<r.length;e++){var i=r[e];b(i._dbInfo)}}).catch(function(t){throw(_(a,t)||h.resolve()).catch(function(){}),t})});else e=r.then(function(t){if(t.objectStoreNames.contains(a.storeName)){var r=t.version+1;v(a);var n=p[a.name],o=n.forages;t.close();for(var e=0;e<o.length;e++){var i=o[e];i._dbInfo.db=null,i._dbInfo.version=r}var s=new h(function(e,i){var n=l.open(a.name,r);n.onerror=function(t){var e=n.result;e.close(),i(t)},n.onupgradeneeded=function(){var t=n.result;t.deleteObjectStore(a.storeName)},n.onsuccess=function(){var t=n.result;t.close(),e(t)}});return s.then(function(t){n.db=t;for(var e=0;e<o.length;e++){var i=o[e];i._dbInfo.db=t,b(i._dbInfo)}}).catch(function(t){throw(_(a,t)||h.resolve()).catch(function(){}),t})}})}return d(e,t),e}},A="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",k=/^~~local_forage_type~([^~]+)~/,M="__lfsc__:",R=M.length,L=R+"arbf".length,D=Object.prototype.toString;function N(t){var e,i,n,r,o,s=.75*t.length,a=t.length,l=0;if("="===t[t.length-1])if(s--,"="===t[t.length-2])s--;var c=new ArrayBuffer(s),u=new Uint8Array(c);for(e=0;e<a;e+=4)i=A.indexOf(t[e]),n=A.indexOf(t[e+1]),r=A.indexOf(t[e+2]),o=A.indexOf(t[e+3]),u[l++]=i<<2|n>>4,u[l++]=(15&n)<<4|r>>2,u[l++]=(3&r)<<6|63&o;return c}function B(t){var e,i=new Uint8Array(t),n="";for(e=0;e<i.length;e+=3)n+=A[i[e]>>2],n+=A[(3&i[e])<<4|i[e+1]>>4],n+=A[(15&i[e+1])<<2|i[e+2]>>6],n+=A[63&i[e+2]];if(i.length%3==2)n=n.substring(0,n.length-1)+"=";else if(i.length%3==1)n=n.substring(0,n.length-2)+"==";return n}var F={serialize:function(e,i){var t="";if(e)t=D.call(e);if(e&&("[object ArrayBuffer]"===t||e.buffer&&"[object ArrayBuffer]"===D.call(e.buffer))){var n,r=M;if(e instanceof ArrayBuffer)n=e,r+="arbf";else if(n=e.buffer,"[object Int8Array]"===t)r+="si08";else if("[object Uint8Array]"===t)r+="ui08";else if("[object Uint8ClampedArray]"===t)r+="uic8";else if("[object Int16Array]"===t)r+="si16";else if("[object Uint16Array]"===t)r+="ur16";else if("[object Int32Array]"===t)r+="si32";else if("[object Uint32Array]"===t)r+="ui32";else if("[object Float32Array]"===t)r+="fl32";else if("[object Float64Array]"===t)r+="fl64";else i(new Error("Failed to get type for BinaryArray"));i(r+B(n))}else if("[object Blob]"===t){var o=new FileReader;o.onload=function(){var t="~~local_forage_type~"+e.type+"~"+B(this.result);i(M+"blob"+t)},o.readAsArrayBuffer(e)}else try{i(JSON.stringify(e))}catch(t){console.error("Couldn't convert value into a JSON string: ",e),i(null,t)}},deserialize:function(t){if(t.substring(0,R)!==M)return JSON.parse(t);var e,i=t.substring(L),n=t.substring(R,L);if("blob"===n&&k.test(i)){var r=i.match(k);e=r[1],i=i.substring(r[0].length)}var o=N(i);switch(n){case"arbf":return o;case"blob":return s([o],{type:e});case"si08":return new Int8Array(o);case"ui08":return new Uint8Array(o);case"uic8":return new Uint8ClampedArray(o);case"si16":return new Int16Array(o);case"ur16":return new Uint16Array(o);case"si32":return new Int32Array(o);case"ui32":return new Uint32Array(o);case"fl32":return new Float32Array(o);case"fl64":return new Float64Array(o);default:throw new Error("Unkown type: "+n)}},stringToBuffer:N,bufferToString:B};function j(t,e,i,n){t.executeSql("CREATE TABLE IF NOT EXISTS "+e.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],i,n)}function G(t,n,r,o,s,a){t.executeSql(r,o,s,function(t,i){if(i.code===i.SYNTAX_ERR)t.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[n.storeName],function(t,e){if(!e.rows.length)j(t,n,function(){t.executeSql(r,o,s,a)},a);else a(t,i)},a);else a(t,i)},a)}function V(s,t,a,l){var c=this;s=u(s);var e=new h(function(r,o){c.ready().then(function(){if(void 0===t)t=null;var i=t,n=c._dbInfo;n.serializer.serialize(t,function(e,t){if(t)o(t);else n.db.transaction(function(t){G(t,n,"INSERT OR REPLACE INTO "+n.storeName+" (key, value) VALUES (?, ?)",[s,e],function(){r(i)},function(t,e){o(e)})},function(t){if(t.code===t.QUOTA_ERR){if(0<l)return void r(V.apply(c,[s,i,a,l-1]));o(t)}})})}).catch(o)});return d(e,a),e}var U={_driver:"webSQLStorage",_initStorage:function(t){var n=this,r={db:null};if(t)for(var e in t)r[e]="string"!=typeof t[e]?t[e].toString():t[e];var i=new h(function(e,i){try{r.db=openDatabase(r.name,String(r.version),r.description,r.size)}catch(t){return i(t)}r.db.transaction(function(t){j(t,r,function(){n._dbInfo=r,e()},function(t,e){i(e)})},i)});return r.serializer=F,i},_support:"function"==typeof openDatabase,iterate:function(c,t){var e=this,i=new h(function(l,i){e.ready().then(function(){var a=e._dbInfo;a.db.transaction(function(t){G(t,a,"SELECT * FROM "+a.storeName,[],function(t,e){for(var i=e.rows,n=i.length,r=0;r<n;r++){var o=i.item(r),s=o.value;if(s)s=a.serializer.deserialize(s);if(void 0!==(s=c(s,o.key,r+1)))return void l(s)}l()},function(t,e){i(e)})})}).catch(i)});return d(i,t),i},getItem:function(e,t){var o=this;e=u(e);var i=new h(function(r,i){o.ready().then(function(){var n=o._dbInfo;n.db.transaction(function(t){G(t,n,"SELECT * FROM "+n.storeName+" WHERE key = ? LIMIT 1",[e],function(t,e){var i=e.rows.length?e.rows.item(0).value:null;if(i)i=n.serializer.deserialize(i);r(i)},function(t,e){i(e)})})}).catch(i)});return d(i,t),i},setItem:function(t,e,i){return V.apply(this,[t,e,i,1])},removeItem:function(r,t){var o=this;r=u(r);var e=new h(function(i,n){o.ready().then(function(){var e=o._dbInfo;e.db.transaction(function(t){G(t,e,"DELETE FROM "+e.storeName+" WHERE key = ?",[r],function(){i()},function(t,e){n(e)})})}).catch(n)});return d(e,t),e},clear:function(t){var r=this,e=new h(function(i,n){r.ready().then(function(){var e=r._dbInfo;e.db.transaction(function(t){G(t,e,"DELETE FROM "+e.storeName,[],function(){i()},function(t,e){n(e)})})}).catch(n)});return d(e,t),e},length:function(t){var r=this,e=new h(function(n,i){r.ready().then(function(){var e=r._dbInfo;e.db.transaction(function(t){G(t,e,"SELECT COUNT(key) as c FROM "+e.storeName,[],function(t,e){var i=e.rows.item(0).c;n(i)},function(t,e){i(e)})})}).catch(i)});return d(e,t),e},key:function(r,t){var o=this,e=new h(function(n,i){o.ready().then(function(){var e=o._dbInfo;e.db.transaction(function(t){G(t,e,"SELECT key FROM "+e.storeName+" WHERE id = ? LIMIT 1",[r+1],function(t,e){var i=e.rows.length?e.rows.item(0).key:null;n(i)},function(t,e){i(e)})})}).catch(i)});return d(e,t),e},keys:function(t){var n=this,e=new h(function(r,i){n.ready().then(function(){var e=n._dbInfo;e.db.transaction(function(t){G(t,e,"SELECT key FROM "+e.storeName,[],function(t,e){for(var i=[],n=0;n<e.rows.length;n++)i.push(e.rows.item(n).key);r(i)},function(t,e){i(e)})})}).catch(i)});return d(e,t),e},dropInstance:function(i,t){t=o.apply(this,arguments);var n=this.config();if(!(i="function"!=typeof i&&i||{}).name)i.name=i.name||n.name,i.storeName=i.storeName||n.storeName;var e,r=this;if(!i.name)e=h.reject("Invalid arguments");else e=new h(function(t){var e,o;if(i.name===n.name)e=r._dbInfo.db;else e=openDatabase(i.name,"","",0);if(!i.storeName)t((o=e,new h(function(r,i){o.transaction(function(t){t.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(t,e){for(var i=[],n=0;n<e.rows.length;n++)i.push(e.rows.item(n).name);r({db:o,storeNames:i})},function(t,e){i(e)})},function(t){i(t)})})));else t({db:e,storeNames:[i.storeName]})}).then(function(a){return new h(function(o,s){a.db.transaction(function(n){function t(e){return new h(function(t,i){n.executeSql("DROP TABLE IF EXISTS "+e,[],function(){t()},function(t,e){i(e)})})}for(var e=[],i=0,r=a.storeNames.length;i<r;i++)e.push(t(a.storeNames[i]));h.all(e).then(function(){o()}).catch(function(t){s(t)})},function(t){s(t)})})});return d(e,t),e}};function W(t,e){var i=t.name+"/";if(t.storeName!==e.storeName)i+=t.storeName+"/";return i}function $(){return!function(){var t="_localforage_support_test";try{return localStorage.setItem(t,!0),localStorage.removeItem(t),!1}catch(t){return!0}}()||0<localStorage.length}var H={_driver:"localStorageWrapper",_initStorage:function(t){var e={};if(t)for(var i in t)e[i]=t[i];if(e.keyPrefix=W(t,this._defaultConfig),$())return(this._dbInfo=e).serializer=F,h.resolve();else return h.reject()},_support:function(){try{return"undefined"!=typeof localStorage&&"setItem"in localStorage&&!!localStorage.setItem}catch(t){return!1}}(),iterate:function(l,t){var c=this,e=c.ready().then(function(){for(var t=c._dbInfo,e=t.keyPrefix,i=e.length,n=localStorage.length,r=1,o=0;o<n;o++){var s=localStorage.key(o);if(0===s.indexOf(e)){var a=localStorage.getItem(s);if(a)a=t.serializer.deserialize(a);if(void 0!==(a=l(a,s.substring(i),r++)))return a}}});return d(e,t),e},getItem:function(i,t){var n=this;i=u(i);var e=n.ready().then(function(){var t=n._dbInfo,e=localStorage.getItem(t.keyPrefix+i);if(e)e=t.serializer.deserialize(e);return e});return d(e,t),e},setItem:function(s,t,e){var a=this;s=u(s);var i=a.ready().then(function(){if(void 0===t)t=null;var o=t;return new h(function(i,n){var r=a._dbInfo;r.serializer.serialize(t,function(t,e){if(e)n(e);else try{localStorage.setItem(r.keyPrefix+s,t),i(o)}catch(t){if("QuotaExceededError"===t.name||"NS_ERROR_DOM_QUOTA_REACHED"===t.name)n(t);n(t)}})})});return d(i,e),i},removeItem:function(e,t){var i=this;e=u(e);var n=i.ready().then(function(){var t=i._dbInfo;localStorage.removeItem(t.keyPrefix+e)});return d(n,t),n},clear:function(t){var n=this,e=n.ready().then(function(){for(var t=n._dbInfo.keyPrefix,e=localStorage.length-1;0<=e;e--){var i=localStorage.key(e);if(0===i.indexOf(t))localStorage.removeItem(i)}});return d(e,t),e},length:function(t){var e=this.keys().then(function(t){return t.length});return d(e,t),e},key:function(i,t){var n=this,e=n.ready().then(function(){var e,t=n._dbInfo;try{e=localStorage.key(i)}catch(t){e=null}if(e)e=e.substring(t.keyPrefix.length);return e});return d(e,t),e},keys:function(t){var o=this,e=o.ready().then(function(){for(var t=o._dbInfo,e=localStorage.length,i=[],n=0;n<e;n++){var r=localStorage.key(n);if(0===r.indexOf(t.keyPrefix))i.push(r.substring(t.keyPrefix.length))}return i});return d(e,t),e},dropInstance:function(e,t){if(t=o.apply(this,arguments),!(e="function"!=typeof e&&e||{}).name){var i=this.config();e.name=e.name||i.name,e.storeName=e.storeName||i.storeName}var n,r=this;if(!e.name)n=h.reject("Invalid arguments");else n=new h(function(t){if(!e.storeName)t(e.name+"/");else t(W(e,r._defaultConfig))}).then(function(t){for(var e=localStorage.length-1;0<=e;e--){var i=localStorage.key(e);if(0===i.indexOf(t))localStorage.removeItem(i)}});return d(n,t),n}},J=function(t,e){return t===e||"number"==typeof t&&"number"==typeof e&&isNaN(t)&&isNaN(e)},K=function(t,e){for(var i=t.length,n=0;n<i;){if(J(t[n],e))return!0;n++}return!1},q=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},z={},X={},Y={INDEXEDDB:E,WEBSQL:U,LOCALSTORAGE:H},Q=[Y.INDEXEDDB._driver,Y.WEBSQL._driver,Y.LOCALSTORAGE._driver],Z=["dropInstance"],tt=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(Z),et={description:"",driver:Q.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function it(e,i){e[i]=function(){var t=arguments;return e.ready().then(function(){return e[i].apply(e,t)})}}function nt(){for(var t=1;t<arguments.length;t++){var e=arguments[t];if(e)for(var i in e)if(e.hasOwnProperty(i))if(q(e[i]))arguments[0][i]=e[i].slice();else arguments[0][i]=e[i]}return arguments[0]}var rt=function(){function r(t){for(var e in function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r),Y)if(Y.hasOwnProperty(e)){var i=Y[e],n=i._driver;if(this[e]=n,!z[n])this.defineDriver(i)}this._defaultConfig=nt({},et),this._config=nt({},this._defaultConfig,t),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return r.prototype.config=function(t){if("object"===(void 0===t?"undefined":n(t))){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var e in t){if("storeName"===e)t[e]=t[e].replace(/\W/g,"_");if("version"===e&&"number"!=typeof t[e])return new Error("Database version must be a number.");this._config[e]=t[e]}if("driver"in t&&t.driver)return this.setDriver(this._config.driver);else return!0}else if("string"==typeof t)return this._config[t];else return this._config},r.prototype.defineDriver=function(u,t,e){var i=new h(function(e,i){try{var n=u._driver,t=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!u._driver)return void i(t);for(var r=tt.concat("_initStorage"),o=0,s=r.length;o<s;o++){var a=r[o],l=!K(Z,a);if((l||u[a])&&"function"!=typeof u[a])return void i(t)}!function(){for(var t=function(i){return function(){var t=new Error("Method "+i+" is not implemented by the current driver"),e=h.reject(t);return d(e,arguments[arguments.length-1]),e}},e=0,i=Z.length;e<i;e++){var n=Z[e];if(!u[n])u[n]=t(n)}}();var c=function(t){if(z[n])console.info("Redefining LocalForage driver: "+n);z[n]=u,X[n]=t,e()};if("_support"in u)if(u._support&&"function"==typeof u._support)u._support().then(c,i);else c(!!u._support);else c(!0)}catch(t){i(t)}});return c(i,t,e),i},r.prototype.driver=function(){return this._driver||null},r.prototype.getDriver=function(t,e,i){var n=z[t]?h.resolve(z[t]):h.reject(new Error("Driver not found."));return c(n,e,i),n},r.prototype.getSerializer=function(t){var e=h.resolve(F);return c(e,t),e},r.prototype.ready=function(t){var e=this,i=e._driverSet.then(function(){if(null===e._ready)e._ready=e._initDriver();return e._ready});return c(i,t,t),i},r.prototype.setDriver=function(t,e,i){var o=this;if(!q(t))t=[t];var n=this._getSupportedDrivers(t);function s(){o._config.driver=o.driver()}function a(t){return o._extend(t),s(),o._ready=o._initStorage(o._config),o._ready}var r=null!==this._driverSet?this._driverSet.catch(function(){return h.resolve()}):h.resolve();return this._driverSet=r.then(function(){var t=n[0];return o._dbInfo=null,o._ready=null,o.getDriver(t).then(function(t){var r;o._driver=t._driver,s(),o._wrapLibraryMethodsWithReady(),o._initDriver=(r=n,function(){var i=0;function n(){for(;i<r.length;){var t=r[i];return i++,o._dbInfo=null,o._ready=null,o.getDriver(t).then(a).catch(n)}s();var e=new Error("No available storage method found.");return o._driverSet=h.reject(e),o._driverSet}return n()})})}).catch(function(){s();var t=new Error("No available storage method found.");return o._driverSet=h.reject(t),o._driverSet}),c(this._driverSet,e,i),this._driverSet},r.prototype.supports=function(t){return!!X[t]},r.prototype._extend=function(t){nt(this,t)},r.prototype._getSupportedDrivers=function(t){for(var e=[],i=0,n=t.length;i<n;i++){var r=t[i];if(this.supports(r))e.push(r)}return e},r.prototype._wrapLibraryMethodsWithReady=function(){for(var t=0,e=tt.length;t<e;t++)it(this,tt[t])},r.prototype.createInstance=function(t){return new r(t)},r}(),ot=new rt;e.exports=ot},{3:3}]},{},[4])(4);else;}()}).call(this,i("0ee4763173a9a955"))},e681aed280414b09:function(t,e,i){var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=function(i){function t(t){var e=i.call(this)||this;return e.type=t,e.runtime=t.runtime,e}return r(t,i),t.prototype.onCreate=function(){},t.prototype.draw=function(t,e){},t.prototype.drawGL=function(t){},t.prototype.onDestroy=function(){},t.prototype.trigger=function(t){return this.runtime.trigger(t,this)},t.prototype.tick=function(){},t.prototype.GetDebuggerProperties=function(){return[]},t.prototype.SaveToJson=function(){return null},t.prototype.LoadFromJson=function(){},t.prototype.LoadTilemapData=function(){},t.prototype.TestPointOverlapTile=function(){},t.prototype.GetPropertyValueByIndex=function(){},t.prototype.SetPropertyValueByIndex=function(){},t.prototype.SetPropertyOffsetValueByIndex=function(){},t.prototype.SetPropertyColorOffsetValueByIndex=function(){},t.prototype.CallAction=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];t.call.apply(t,[this].concat(e))},t.prototype.CallExpression=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];return t.call.apply(t,[this].concat(e))},t.formatProp=function(t,e,i){var n=e,r=Object.keys(n);return t.properties.forEach(function(t,e){if(e<r.length)if(!i(t,e,r[e]))n[r[e]]=t}),n},t.compareText=function(t,e,i){if("string"!=typeof t||"string"!=typeof i)return!1;switch(e){case 0:return t==i;case 1:return t!=i;case 2:return-1<t.indexOf(i);case 3:return-1==t.indexOf(i);default:return window.assert2(!1,"Invalid comparison value: "+e),!1}},t.prototype.listenMessage=function(t,e,i,n){if(void 0===i)i=null;if(void 0===n)n=0;xf.EventCenter.instance.addEventListener(t,e,i||this,n),this.listenBins=this.listenBins?this.listenBins:[],this.listenBins.push({messageID:t,method:e})},t.prototype.removeAllListen=function(){if(this.listenBins&&this.listenBins.length){for(var t=0,e=this.listenBins;t<e.length;t++){var i=e[t];xf.EventCenter.instance.removeEventListener(i.messageID,i.method,this)}this.listenBins.length=0}},t}(i("d27c30dad6345543").DefendedBase);e.SDKInstanceBase=o},e7b602c229ac5b71:function(t,e,i){var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=function(i){function t(t){var e=i.call(this)||this;return e.runtime=t,e._isSingleGlobal=!!t.isSingleGlobal,e._isWorldType=!!t.isWorld,e._isRotatable=!!t.isRotatable,e._mustPredraw=!!t.mustPredraw,e._hasEffects=!!t.hasEffects,e._singleGlobalObjectClass=null,e}return r(t,i),t.prototype.onCreate=function(){},t.prototype.IsSingleGlobal=function(){return this._isSingleGlobal},t.prototype.IsWorldType=function(){return this._isWorldType},t.prototype.IsRotatable=function(){return this._isRotatable},t.prototype.MustPreDraw=function(){return this._mustPredraw},t.prototype.HasEffects=function(){return this._hasEffects},t.prototype._SetSingleGlobalObjectClass=function(t){if(!this.IsSingleGlobal())throw new Error("must be single-global plugin");this._singleGlobalObjectClass=t},t.prototype.GetSingleGlobalObjectClass=function(){if(!this.IsSingleGlobal())throw new Error("must be single-global plugin");return this._singleGlobalObjectClass},t.prototype.GetSingleGlobalInstance=function(){if(!this.IsSingleGlobal())throw new Error("must be single-global plugin");return this._singleGlobalObjectClass.GetSingleGlobalInstance()},t}(i("d27c30dad6345543").DefendedBase);e.SDKPluginBase=o},f4d1d714ef51ea26:function(t,e,i){var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.OnItemSet=function(t){return this.currentKey===t},e.prototype.OnAnyItemSet=function(){return!0},e.prototype.OnItemGet=function(t){return this.currentKey===t},e.prototype.OnAnyItemGet=function(){return!0},e.prototype.OnItemRemoved=function(t){return this.currentKey===t},e.prototype.OnAnyItemRemoved=function(){return!0},e.prototype.OnCleared=function(){return!0},e.prototype.OnAllKeyNamesLoaded=function(){return!0},e.prototype.OnError=function(){return!0},e.prototype.OnItemExists=function(t){return this.currentKey===t},e.prototype.OnItemMissing=function(t){return this.currentKey===t},e.prototype.CompareKey=function(t,e){return drama.do_cmp(this.currentKey,t,e)},e.prototype.CompareValue=function(t,e){return drama.do_cmp(this.lastValue,t,e)},e.prototype.IsProcessingSets=function(){return 0<this.pendingSets},e.prototype.IsProcessingGets=function(){return 0<this.pendingGets},e.prototype.OnAllSetsComplete=function(){return!0},e.prototype.OnAllGetsComplete=function(){return!0},e.prototype.OnRemoteStorageExists=function(){return!0},e.prototype.OnRemoteStorageNotExists=function(){return!0},e.prototype.isUploading=function(){return!1},e.prototype.isDownloading=function(){return!1},e.prototype.isUploadSucces=function(){return!0},e.prototype.isUploadError=function(){return!0},e.prototype.isDownloadSucces=function(){return!0},e.prototype.isDownloadError=function(){return!0},e.prototype.isSynchronizing=function(){return this.synchronizing},e.prototype.onSynchronizeSuccess=function(){return!0},e.prototype.onSynchronizeError=function(){return!0},e}(i("8463ce3906bbfa07").Property);e.default=o}}),assert2(drama,"drama namespace not created"),assert2(drama.plugins_,"drama.plugins_ not created"),drama.plugins_.Mouse=function(t){this.runtime=t},function(){var t=drama.plugins_.Mouse.prototype;t.Type=function(t){this.plugin=t,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t){this.type=t,this.runtime=t.runtime,this.buttonMap=new Array(4),this.mouseXcanvas=0,this.mouseYcanvas=0,this.triggerButton=-1,this.triggerType=0,this.triggerDir=0,this.handled=!1,this.isLeftButtonDown=!1,this.isCenterButtonDown=!1,this.isRightButtonDown=!1};var e=t.Instance.prototype;function i(){}function n(){}e.onCreate=function(){var e=this;if(this.audio=this.properties[0],this.isEnableTouch=this.properties[1],this.isInitAudio=!1,!this.runtime.isMobile){document.addEventListener("mousemove",function(t){e.onMouseMove(t)}),document.addEventListener("mousedown",function(t){e.audioInst&&e.audioInst.Play([e.audio,!0],0,1,"xfMouseAndTouchDefaultAudio"),e.onMouseDown(t)}),document.addEventListener("mouseup",function(t){e.onMouseUp(t)}),document.addEventListener("dblclick",function(t){e.onDoubleClick(t)});var t=function(t){e.onWheel(t)};document.addEventListener("mousewheel",t,!1),document.addEventListener("DOMMouseScroll",t,!1)}else if(this.isEnableTouch&&this.runtime.isMobile)document.addEventListener("touchmove",function(t){e.onTouchMove(t)}),document.addEventListener("touchstart",function(t){e.audioInst&&e.audioInst.Play([e.audio,!0],0,1,"xfMouseAndTouchDefaultAudio"),e.onTouchStart(t)}),document.addEventListener("touchend",function(t){e.onTouchEnd(t)});this.runtime.tick2Me(this)},e.onMouseMove=function(t){var e=drama.convertPageXY(t.pageX,t.pageY);this.mouseXcanvas=e.pageX-this.runtime.canvas.offsetLeft,this.mouseYcanvas=e.pageY-this.runtime.canvas.offsetTop},e.onTouchMove=function(t){this.touchHandler(t)},e.touchHandler=function(t){var e,i,n,r,o;for(e=0,i=t.changedTouches.length;e<i;e++){n=t.changedTouches[e];var s=drama.convertPageXY(n.pageX,n.pageY);r=s.pageX,o=s.pageY}this.mouseXcanvas=r-this.runtime.canvas.offsetLeft,this.mouseYcanvas=o-this.runtime.canvas.offsetTop},e.mouseInGame=function(){if(0<this.runtime.fullscreen_mode)return!0;else return 0<=this.mouseXcanvas&&0<=this.mouseYcanvas&&this.mouseXcanvas<this.runtime.width&&this.mouseYcanvas<this.runtime.height},e.onMouseDown=function(t){if(this.mouseInGame()){if(this.buttonMap[t.which]=!0,this.runtime.isInUserInputEvent=!0,this.runtime.trigger(drama.plugins_.Mouse.prototype.cnds.OnAnyClick,this),this.triggerButton=t.which-1,this.triggerType=0,this.runtime.trigger(drama.plugins_.Mouse.prototype.cnds.OnClick,this),this.runtime.trigger(drama.plugins_.Mouse.prototype.cnds.OnObjectClicked,this),0==this.triggerButton)this.runtime.trigger(drama.plugins_.Mouse.prototype.cnds.OnLeftClick,this),this.isLeftButtonDown=!0;else if(1==this.triggerButton)this.runtime.trigger(drama.plugins_.Mouse.prototype.cnds.OnCenterClick,this),this.isCenterButtonDown=!0;else if(2==this.triggerButton)this.runtime.trigger(drama.plugins_.Mouse.prototype.cnds.OnRightClick,this),this.isRightButtonDown=!0;this.runtime.isInUserInputEvent=!1}},e.onTouchStart=function(t){if(this.mouseInGame())this.touchHandler(t),this.runtime.isInUserInputEvent=!0,this.triggerButton=0,this.triggerType=0,this.runtime.trigger(drama.plugins_.Mouse.prototype.cnds.OnAnyClick,this),this.triggerType=0,this.runtime.trigger(drama.plugins_.Mouse.prototype.cnds.OnClick,this),this.runtime.trigger(drama.plugins_.Mouse.prototype.cnds.OnObjectClicked,this),this.runtime.trigger(drama.plugins_.Mouse.prototype.cnds.OnLeftClick,this),this.isLeftButtonDown=!0,this.runtime.isInUserInputEvent=!1},e.onMouseUp=function(t){if(this.buttonMap[t.which]){if(this.runtime.had_a_click&&!this.runtime.isMobile)t.preventDefault();if(this.runtime.had_a_click=!0,this.buttonMap[t.which]=!1,this.runtime.isInUserInputEvent=!0,this.triggerButton=t.which-1,this.runtime.trigger(drama.plugins_.Mouse.prototype.cnds.OnRelease,this),0==this.triggerButton)this.runtime.trigger(drama.plugins_.Mouse.prototype.cnds.OnLeftButtonRelease,this),this.isLeftButtonDown=!1;else if(1==this.triggerButton)this.runtime.trigger(drama.plugins_.Mouse.prototype.cnds.OnCenterButtonRelease,this),this.isCenterButtonDown=!1;else if(2==this.triggerButton)this.runtime.trigger(drama.plugins_.Mouse.prototype.cnds.OnRightButtonRelease,this),this.isRightButtonDown=!1;this.runtime.isInUserInputEvent=!1,this.triggerButton=-1}},e.onTouchEnd=function(t){this.runtime.isInUserInputEvent=!0,this.runtime.trigger(drama.plugins_.Mouse.prototype.cnds.OnRelease,this),this.runtime.trigger(drama.plugins_.Mouse.prototype.cnds.OnLeftButtonRelease,this),this.isLeftButtonDown=!1,this.runtime.isInUserInputEvent=!1,this.triggerButton=-1},e.onDoubleClick=function(t){if(this.mouseInGame()){if(t.preventDefault(),this.runtime.isInUserInputEvent=!0,this.triggerButton=t.which-1,this.triggerType=1,this.runtime.trigger(drama.plugins_.Mouse.prototype.cnds.OnClick,this),this.runtime.trigger(drama.plugins_.Mouse.prototype.cnds.OnObjectClicked,this),0==this.triggerButton)this.runtime.trigger(drama.plugins_.Mouse.prototype.cnds.OnLeftDbClick,this);this.runtime.isInUserInputEvent=!1}},e.onWheel=function(t){var e=t.wheelDelta?t.wheelDelta:t.detail?-t.detail:0;if(this.triggerDir=e<0?0:1,this.handled=!1,this.runtime.isInUserInputEvent=!0,this.runtime.trigger(drama.plugins_.Mouse.prototype.cnds.OnWheel,this),this.triggerDir)this.runtime.trigger(drama.plugins_.Mouse.prototype.cnds.OnWheelUp,this);else this.runtime.trigger(drama.plugins_.Mouse.prototype.cnds.OnWheelDown,this);if(this.runtime.isInUserInputEvent=!1,this.handled&&drama.isCanvasInputEvent(t))t.preventDefault()},e.onWindowBlur=function(){var t,e;for(t=0,e=this.buttonMap.length;t<e;++t)if(this.buttonMap[t])if(this.buttonMap[t]=!1,this.triggerButton=t-1,this.runtime.trigger(drama.plugins_.Mouse.prototype.cnds.OnRelease,this),0==this.triggerButton)this.runtime.trigger(drama.plugins_.Mouse.prototype.cnds.OnLeftButtonRelease,this);else if(1==this.triggerButton)this.runtime.trigger(drama.plugins_.Mouse.prototype.cnds.OnCenterButtonRelease,this);else if(2==this.triggerButton)this.runtime.trigger(drama.plugins_.Mouse.prototype.cnds.OnRightButtonRelease,this)},e.tick2=function(){if(!this.isInitAudio&&this.audio)this.audioInst=xf.audioInstance(this.runtime),this.isInitAudio=!0},e.getDebuggerValues=function(t){t.push({title:"Mouse",properties:[{name:"Absolute position",value:"("+this.mouseXcanvas+", "+this.mouseYcanvas+")",readonly:!0},{name:"Left button down",value:!!this.buttonMap[1],readonly:!0},{name:"Middle button down",value:!!this.buttonMap[2],readonly:!0},{name:"Right button down",value:!!this.buttonMap[3],readonly:!0}]});var e,i,n,r=[];for(e=0,i=this.runtime.running_layout.layers.length;e<i;++e)n=this.runtime.running_layout.layers[e],r.unshift({name:n.name,value:"("+n.canvasToLayer(this.mouseXcanvas,this.mouseYcanvas,!0)+", "+n.canvasToLayer(this.mouseXcanvas,this.mouseYcanvas,!1)+")",readonly:!0});t.push({title:"Mouse position on each layer",properties:r})},i.prototype.OnClick=function(t,e){return t===this.triggerButton&&e===this.triggerType},i.prototype.OnAnyClick=function(){return!0},i.prototype.IsButtonDown=function(t){return this.buttonMap[t+1]},i.prototype.OnRelease=function(t){return t===this.triggerButton},i.prototype.IsOverObject=function(t){var e=this.runtime.getCurrentCondition(),i=this.mouseXcanvas,n=this.mouseYcanvas;return drama.xor(this.runtime.testAndSelectCanvasPointOverlap(t,i,n,e.inverted),e.inverted)},i.prototype.OnObjectClicked=function(t,e,i){if(t!==this.triggerButton||e!==this.triggerType)return!1;else return this.runtime.testAndSelectCanvasPointOverlap(i,this.mouseXcanvas,this.mouseYcanvas,!1)},i.prototype.OnWheel=function(t){return this.handled=!0,t===this.triggerDir},i.prototype.OnLeftClick=function(){return!0},i.prototype.OnLeftDbClick=function(){return!0},i.prototype.OnRightClick=function(){return!0},i.prototype.OnCenterClick=function(){return!0},i.prototype.IsLeftButtonDown=function(){return this.isLeftButtonDown},i.prototype.IsCenterButtonDown=function(){return this.isCenterButtonDown},i.prototype.IsRightButtonDown=function(){return this.isRightButtonDown},i.prototype.OnLeftButtonRelease=function(){return!0},i.prototype.OnCenterButtonRelease=function(){return!0},i.prototype.OnRightButtonRelease=function(){return!0},i.prototype.OnWheelUp=function(){return!0},i.prototype.OnWheelDown=function(){return!0},t.cnds=new i;var r=null;function o(){}n.prototype.SetCursor=function(t){var e=["auto","pointer","text","crosshair","move","help","wait","none"][t];if(r!==e)r=e,document.body.style.cursor=e},n.prototype.SetCursorSprite=function(t){if(!this.runtime.isMobile&&t){var e=t.getFirstPicked();if(e&&e.curFrame){var i=e.curFrame;if(r!==i){var n="url("+(r=i).getDataUri()+") "+Math.round(i.hotspotX*i.width)+" "+Math.round(i.hotspotY*i.height)+", auto";document.body.style.cursor="",document.body.style.cursor=n}}}},t.acts=new n,o.prototype.X=function(t,e){var i,n,r,o,s;if(drama.is_undefined(e))n=(i=this.runtime.getLayerByNumber(0)).scale,r=i.zoomRate,o=i.parallaxX,s=i.angle,i.scale=1,i.zoomRate=1,i.parallaxX=1,i.angle=0,t.set_float(i.canvasToLayer(this.mouseXcanvas,this.mouseYcanvas,!0)),i.scale=n,i.zoomRate=r,i.parallaxX=o,i.angle=s;else{if(drama.is_number(e))i=this.runtime.getLayerByNumber(e);else i=this.runtime.getLayerByName(e);if(i)t.set_float(i.canvasToLayer(this.mouseXcanvas,this.mouseYcanvas,!0));else t.set_float(0)}},o.prototype.Y=function(t,e){var i,n,r,o,s;if(drama.is_undefined(e))n=(i=this.runtime.getLayerByNumber(0)).scale,r=i.zoomRate,o=i.parallaxY,s=i.angle,i.scale=1,i.zoomRate=1,i.parallaxY=1,i.angle=0,t.set_float(i.canvasToLayer(this.mouseXcanvas,this.mouseYcanvas,!1)),i.scale=n,i.zoomRate=r,i.parallaxY=o,i.angle=s;else{if(drama.is_number(e))i=this.runtime.getLayerByNumber(e);else i=this.runtime.getLayerByName(e);if(i)t.set_float(i.canvasToLayer(this.mouseXcanvas,this.mouseYcanvas,!1));else t.set_float(0)}},o.prototype.AbsoluteX=function(t){t.set_float(this.mouseXcanvas)},o.prototype.AbsoluteY=function(t){t.set_float(this.mouseYcanvas)},t.exps=new o}(),assert2(drama,"drama namespace not created"),assert2(drama.plugins_,"drama.plugins_ not created"),drama.plugins_.Multiplayer=function(t){this.runtime=t},function(){var t=drama.plugins_.Multiplayer.prototype;t.Type=function(t){this.plugin=t,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t){this.type=t,this.runtime=t.runtime};var e=t.Instance.prototype,u=!1,i=[];e.onCreate=function(){if(this.mp=null,(u=window.C2Multiplayer_IsSupported())&&void 0!==window.C2Multiplayer)this.mp=new window.C2Multiplayer;this.signallingUrl="",this.errorMsg="",this.peerID="",this.peerAlias="",this.leaveReason="",this.msgContent="",this.msgTag="",this.msgFromId="",this.msgFromAlias="",this.typeToRo={},this.instToPeer={},this.peerToInst={},this.gameInstanceList=null,this.roomList=null,this.wakerWorker=null,this.inputPredictObjects=[],this.trackObjects=[],this.objectHistories={};var a=this;if(u)this.mp.onserverlist=function(t){i=t,a.runtime.trigger(drama.plugins_.Multiplayer.prototype.cnds.OnServerList,a)},this.mp.onsignallingerror=function(t){a.setError(t),a.runtime.trigger(drama.plugins_.Multiplayer.prototype.cnds.OnSignallingError,a)},this.mp.onsignallingclose=function(){a.runtime.trigger(drama.plugins_.Multiplayer.prototype.cnds.OnSignallingDisconnected,a),a.signallingUrl=""},this.mp.onsignallingwelcome=function(){a.runtime.trigger(drama.plugins_.Multiplayer.prototype.cnds.OnSignallingConnected,a)},this.mp.onsignallinglogin=function(){a.runtime.trigger(drama.plugins_.Multiplayer.prototype.cnds.OnSignallingLoggedIn,a)},this.mp.onsignallingjoin=function(t){if(a.instToPeer={},a.peerToInst={},a.trackObjects.length=0,a.inputPredictObjects.length=0,a.objectHistories={},a.runtime.trigger(drama.plugins_.Multiplayer.prototype.cnds.OnSignallingJoinedRoom,a),a.runtime.isSuspended&&t)a.wakerWorker.postMessage("start")},this.mp.onsignallingleave=function(){a.runtime.trigger(drama.plugins_.Multiplayer.prototype.cnds.OnSignallingLeftRoom,a)},this.mp.onsignallingkicked=function(){a.runtime.trigger(drama.plugins_.Multiplayer.prototype.cnds.OnSignallingKicked,a)},this.mp.onbeforeclientupdate=function(){a.runtime.trigger(drama.plugins_.Multiplayer.prototype.cnds.OnClientUpdate,a)},this.mp.onpeeropen=function(t){a.peerID=t.id,a.peerAlias=t.alias,a.runtime.trigger(drama.plugins_.Multiplayer.prototype.cnds.OnPeerConnected,a)},this.mp.onpeerclose=function(t,e){a.peerID=t.id,a.peerAlias=t.alias,a.leaveReason=e||"unknown";var i=a.getAssociatedInstanceForPeer(t);if(i){var n=a.typeToRo[i.type];if(n)n.removeObjectNid(t.nid);a.runtime.DestroyInstance(i)}if(a.peerToInst.hasOwnProperty(t.id))delete a.peerToInst[t.id];a.runtime.trigger(drama.plugins_.Multiplayer.prototype.cnds.OnPeerDisconnected,a)},this.mp.onpeermessage=function(t,e){if(a.msgTag=e.t,e.f)a.msgFromId=e.f;else a.msgFromId=t.id;a.msgFromAlias=a.mp.getAliasFromId(a.msgFromId),a.msgContent=e.m,a.runtime.trigger(drama.plugins_.Multiplayer.prototype.cnds.OnAnyPeerMessage,a),a.runtime.trigger(drama.plugins_.Multiplayer.prototype.cnds.OnPeerMessage,a)},this.mp.onsignallinginstancelist=function(t){a.gameInstanceList=t,a.runtime.trigger(drama.plugins_.Multiplayer.prototype.cnds.OnGameInstanceList,a)},this.mp.onsignallingroomlist=function(t){a.roomList=t,a.runtime.trigger(drama.plugins_.Multiplayer.prototype.cnds.OnRoomList,a)},this.mp.ongetobjectcount=function(t){return t.instances.length},this.mp.ongetobjectvalue=function(t,e,i){if(!i)return t.instances[e].uid;var n,r,o=i.tag,s=t.instances[e];switch(o){case"x":return s.x;case"y":return s.y;case"a":return s.angle;case"iv":if(i.clientvaluetag)if((r=a.instToPeer[s.uid])&&a.mp.me!==r&&!r.wasRemoved&&r.hasClientState(i.clientvaluetag))return r.getInterpClientState(i.clientvaluetag);if("number"==typeof(n=s.instance_vars[i.userdata]))return n;else return 0;default:return 0}},this.mp.oninstancedestroyed=function(t,e,i){var n=t.userdata,r=n.instmap;if(!n.deadmap)n.deadmap={};if(n.deadmap[e]=i,r)if(r.hasOwnProperty(e)){var o=r[e];if(o)a.runtime.DestroyInstance(o);delete r[e]}},this.runtime.addDestroyCallback(function(t){var e,i=t.uid;if(a.instToPeer.hasOwnProperty(i))delete a.instToPeer[i];for(e in a.peerToInst)if(a.peerToInst.hasOwnProperty(e))if(a.peerToInst[e]===t){delete a.peerToInst[e];break}if(a.objectHistories.hasOwnProperty(i))delete a.objectHistories[i];var n=a.inputPredictObjects.indexOf(t);if(-1<n)a.inputPredictObjects.splice(n,1);if(-1<(n=a.trackObjects.indexOf(t)))a.trackObjects.splice(n,1);a.mp.removeObjectId(i)}),this.wakerWorker=new Worker(this.runtime.getLocalFileUrl("waker.js")),this.wakerWorker.addEventListener("message",function(t){if("tick"===t.data&&a.runtime.isSuspended)a.runtime.tick(!0)},!1),this.wakerWorker.postMessage("");this.runtime.addSuspendCallback(function(t){if(u&&a.mp.isHost())if(t)a.wakerWorker.postMessage("start");else a.wakerWorker.postMessage("stop")}),this.runtime.pretickMe(this)},e.getAssociatedInstanceForPeer=function(t){var e=t.id;if(this.peerToInst.hasOwnProperty(e))return this.peerToInst[e];else return null},e.isInputPredicting=function(t){return 0<=this.inputPredictObjects.indexOf(t)},e.pretick=function(){if(u){var t,e,i;if(this.mp.tick(this.runtime.dt1),this.trackObjectHistories(),this.mp.isInRoom()&&!this.mp.isHost())for(t=0,e=this.mp.registeredObjects.length;t<e;++t)i=this.mp.registeredObjects[t],this.updateRegisteredObject(i)}};var _=[];function r(t){this.inst=t,this.history=[]}function o(t){this.oh=t,this.timestamp=0,this.x=0,this.y=0,this.angle=0,this.ivs=[]}e.updateRegisteredObject=function(t){t.tick();var e=t.obj,i=t.getCount(),n=t.netvalues,r=t.userdata;if(!r.instmap)r.instmap={};var o,s,a,l,c,u,h,d,p,f,m,g=r.instmap,y=r.deadmap,v=t.simTime,b=n.length;for(m in g)if(g.hasOwnProperty(m))if(l=g[m],!this.runtime.getObjectByUID(l.uid))delete g[m];if(y)for(m in y)if(y.hasOwnProperty(m))if(y[m]<v-3e3)delete y[m];for(o=0;o<i;++o)if(a=(s=t.getNetInstAt(o)).nid,!(y&&y[a]>=v-3e3)){if(g.hasOwnProperty(a))l=g[a],f=!1;else{if(c=this.mp.getPeerByNid(a))this.peerID=c.id,this.peerAlias=c.alias;else{if(t.hasOverriddenNids)continue;this.peerID="",this.peerAlias=""}l=this.runtime.createInstance(e,this.runtime.running_layout.layers[e.default_layerindex],-1e3,-1e3),g[a]=l,f=!0}if(!s.isTimedOut(v)){if(this.isInputPredicting(l))this.correctInputPrediction(l,s,n,v);else for(p=0;p<b;++p)switch(d=s.getInterp(v,p),(u=n[p]).tag){case"x":l.x=d,l.set_bbox_changed();break;case"y":l.y=d,l.set_bbox_changed();break;case"a":l.angle=d,l.set_bbox_changed();break;case"iv":if((h=u.userdata)>l.instance_vars.length||"number"!=typeof l.instance_vars[h])break;l.instance_vars[h]=d}if(f)this.runtime.trigger(Object.getPrototypeOf(e.plugin).cnds.OnCreated,l)}else{if(_.push(s),g.hasOwnProperty(a))delete g[a];this.runtime.DestroyInstance(l)}}else if(_.push(s),g.hasOwnProperty(a))this.runtime.DestroyInstance(g[a]),delete g[a];for(o=0,i=_.length;o<i;++o)t.removeNetInstance(_[o]);_.length=0},e.trackObjectHistories=function(){var t,e,i=this.mp.getHostInputArrivalTime();for(t=0,e=this.trackObjects.length;t<e;++t)this.trackObjectHistory(this.trackObjects[t],i)},r.prototype.getLastDelta=function(t,e){if(this.history.length<2)return 0;var i=this.history[this.history.length-2],n=this.history[this.history.length-1];switch(t){case"x":return n.x-i.x;case"y":return n.y-i.y;case"a":return n.angle-i.angle;case"iv":return n.ivs[e]-i.ivs[e]}return 0},r.prototype.getInterp=function(t,e,i,n){var r,o,s,a=null,l=null;for(r=0,o=this.history.length;r<o;++r)if((s=this.history[r]).timestamp<i)a=s;else{if(r+1<this.history.length)l=this.history[r+1];break}if(a){var c=0;switch(t){case"x":c=a.x;break;case"y":c=a.y;break;case"a":c=a.angle;break;case"iv":c=a.ivs[e]}if(!l)return c;var u=c;switch(t){case"x":u=l.x;break;case"y":u=l.y;break;case"a":u=l.angle;break;case"iv":u=l.ivs[e]}var h=drama.unlerp(a.timestamp,l.timestamp,i);return window.interpNetValue(n,c,u,h,!1)}},r.prototype.applyCorrection=function(t,e,i){var n,r,o;for(n=0,r=this.history.length;n<r;++n)switch(o=this.history[n],t){case"x":o.x+=i;break;case"y":o.y+=i;break;case"a":o.angle+=i;break;case"iv":o.ivs[e]+=i}};var s=[];function a(t){if(t.ivs.length=0,s.length<1e3)s.push(t)}e.trackObjectHistory=function(t,e){if(!this.objectHistories.hasOwnProperty(t.uid))this.objectHistories[t.uid]=new r(t);var i=this.objectHistories[t.uid],n=function(t){var e;if(s.length)return(e=s.pop()).oh=t,e;else return new o(t)}(i);for(n.timestamp=e,n.x=t.x,n.y=t.y,n.angle=t.angle,drama.shallowAssignArray(n.ivs,t.instance_vars),i.history.push(n);0<i.history.length&&i.history[0].timestamp<=e-2e3;)a(i.history.shift())};var v=0,b=0,w=0,x=0;function S(t,e,i,n,r){var o=e-t;if(0===o)return 0;var s=drama.abs(o);if(s<=drama.abs(i/10)||n&&(s<1||1e3<=s))return o;var a=s/50;if(r)a=drama.max(a,1);var l=drama.abs(i/5);if(n&&10<=s)a=s/10,l=drama.abs(i/2);var c=drama.max(a,l);if(s<c)c=s;if(0<o)return c;else return-c}function n(){}function l(){}function c(t){switch(t){case 0:return"o";case 1:return"r";case 2:return"u";default:return"o"}}e.correctInputPrediction=function(t,e,i,n){if(this.objectHistories.hasOwnProperty(t.uid)){var r,o,s,a,l,c,u,h,d,p,f=this.objectHistories[t.uid],m=i.length,g=drama.distanceTo(0,0,f.getLastDelta("x"),f.getLastDelta("y")),y=!!t.extra.isPlatformBehavior;for(r=0;r<m;++r)if(u=(l=i[r]).tag,d=l.userdata,h=l.interp,o=e.getLatestUpdate())if(s=o.data[r],void 0!==(a=f.getInterp(u,d,o.timestamp,h))){switch(p=0,u){case"x":if(0!==(p=S(a,s,g,!0,y)))t.x+=p,t.set_bbox_changed();v=s-a+p,w=s;break;case"y":if(0!==(p=S(a,s,g,!0,y)))t.y+=p,t.set_bbox_changed();b=s-a+p,x=s;break;case"a":if(0!==(p=drama.anglelerp(a,s,.5)-a))t.angle+=p,t.set_bbox_changed();break;case"iv":if((c=d)>t.instance_vars.length||"number"!=typeof t.instance_vars[c])break;if(!l.clientvaluetag)t.instance_vars[c]=e.getInterp(n,r)}if(0!==p)f.applyCorrection(u,d,p)}}},e.setError=function(t){if(!t)this.errorMsg="unknown error";else if("string"==typeof t)this.errorMsg=t;else if("string"==typeof t.message)this.errorMsg=t.message;else if("string"==typeof t.details)this.errorMsg=t.details;else if("string"==typeof t.data)this.errorMsg=t.data;else if("string"==typeof t.type)this.errorMsg=t.type;else this.errorMsg="error"},e.onDestroy=function(){},e.saveToJSON=function(){return{}},e.loadFromJSON=function(t){},e.getDebuggerValues=function(t){},e.onDebugValueEdited=function(t,e,i){},n.prototype.OnServerList=function(){return!0},n.prototype.OnSignallingError=function(){return!0},n.prototype.OnSignallingConnected=function(){return!0},n.prototype.OnSignallingDisconnected=function(){return!0},n.prototype.OnSignallingLoggedIn=function(){return!0},n.prototype.OnSignallingJoinedRoom=function(){return!0},n.prototype.OnSignallingLeftRoom=function(){return!0},n.prototype.OnSignallingKicked=function(){return!0},n.prototype.OnPeerConnected=function(){return!0},n.prototype.OnPeerDisconnected=function(){return!0},n.prototype.SignallingIsConnected=function(){return u&&this.mp.isConnected()},n.prototype.SignallingIsLoggedIn=function(){return u&&this.mp.isLoggedIn()},n.prototype.SignallingIsInRoom=function(){return u&&this.mp.isInRoom()},n.prototype.IsHost=function(){return u&&this.mp.isHost()},n.prototype.IsSupported=function(){return u},n.prototype.OnPeerMessage=function(t){return this.msgTag===t},n.prototype.OnAnyPeerMessage=function(){return!0},n.prototype.OnClientUpdate=function(){return!0},n.prototype.OnGameInstanceList=function(){return!0},n.prototype.OnRoomList=function(){return!0},n.prototype.IsReadyForInput=function(){if(!u)return!1;else return this.mp.isReadyForInput()},n.prototype.ComparePeerCount=function(t,e){var i=0;if(u)i=this.mp.getPeerCount();return drama.do_cmp(i,t,e)},t.cnds=new n,l.prototype.RequestServerList=function(t){if(u)this.mp.requestServerList(t)},l.prototype.SignallingConnect=function(t){if(u&&!this.mp.isConnected())this.signallingUrl=t,this.mp.signallingConnect(t)},l.prototype.SignallingDisconnect=function(){if(u&&this.mp.isConnected())this.mp.signallingDisconnect()},l.prototype.AddICEServer=function(t,e,i){if(u){var n={urls:t};if(e)n.username=e;if(i)n.credential=i;this.mp.mergeIceServerList([n])}},l.prototype.SignallingLogin=function(t){if(u&&this.mp.isConnected&&!this.mp.isLoggedIn())this.mp.signallingLogin(t)},l.prototype.SignallingJoinRoom=function(t,e,i,n){if(u&&this.mp.isLoggedIn()&&!this.mp.isInRoom())this.mp.signallingJoinGameRoom(t,e,i,n)},l.prototype.SignallingAutoJoinRoom=function(t,e,i,n,r){if(u&&this.mp.isLoggedIn()&&!this.mp.isInRoom())this.mp.signallingAutoJoinGameRoom(t,e,i,n,0===r)},l.prototype.SignallingLeaveRoom=function(){if(u&&this.mp.isInRoom())this.mp.signallingLeaveRoom()},l.prototype.DisconnectRoom=function(){if(u)this.mp.disconnectRoom(!0)},l.prototype.SendPeerMessage=function(t,e,i,n){if(u){if(!t)t=this.mp.getHostID();var r=this.mp.getPeerById(t);if(r)r.send(c(n),JSON.stringify({c:"m",t:e,m:i}))}},l.prototype.HostBroadcastMessage=function(t,e,i,n){if(u){var r=this.mp.getPeerById(t),o={c:"m",t:e,f:t||this.mp.getHostID(),m:i};this.mp.hostBroadcast(c(n),JSON.stringify(o),r)}},l.prototype.SimulateLatency=function(t,e,i){if(u)this.mp.setLatencySimulation(1e3*t,1e3*e,i)},e.doSyncObject=function(t,e,i,n){if(u){var r=this.mp.registerObject(t,t.sid,n);if(1===e)r.addValue(this.mp.INTERP_LINEAR,i,"x"),r.addValue(this.mp.INTERP_LINEAR,i,"y");else if(2===e)r.addValue(this.mp.INTERP_ANGULAR,i,"a");else if(3===e)r.addValue(this.mp.INTERP_LINEAR,i,"x"),r.addValue(this.mp.INTERP_LINEAR,i,"y"),r.addValue(this.mp.INTERP_ANGULAR,i,"a");this.typeToRo[t]=r}};var h=!(l.prototype.SyncObject=function(t,e,i,n){if(u){var r,o;if(t.is_family)for(r=0,o=t.members.length;r<o;++r)this.doSyncObject(t.members[r],e,i,n);else this.doSyncObject(t,e,i,n)}});function d(){}function p(t,e){if(!t)return null;if((e=Math.floor(e))<0||e>=t.length)return null;else return t[e]}e.doSyncObjectInstanceVar=function(t,e,i,n,r){if(u){var o=this.typeToRo[t];if(o){var s=this.mp.INTERP_NONE;if(1===n)s=this.mp.INTERP_LINEAR;else if(2===n)s=this.mp.INTERP_ANGULAR;o.addValue(s,i,"iv",e,r)}else if(!h)h=!0,alert("Multiplayer object: incorrect use of 'Sync instance variable' for object type '"+t.name+"'. You must use 'Sync object' before you can use 'Sync instance variable'. Please refer to the documentation for more information.")}},l.prototype.SyncObjectInstanceVar=function(t,e,i,n,r){if(u){var o,s,a;if(t.is_family)for(o=0,s=t.members.length;o<s;++o)a=t.members[o],this.doSyncObjectInstanceVar(a,e+a.family_var_map[t.family_index],i,n,r);else this.doSyncObjectInstanceVar(t,e,i,n,r)}},l.prototype.AssociateObjectWithPeer=function(t,e){if(u){var i=t.getFirstPicked();if(i){var n=this.typeToRo[t];if(n){var r=this.mp.getPeerById(e);if(r){if(this.mp.isHost())if(n.overrideNid(i.uid,r.nid),-1===this.trackObjects.indexOf(i))this.trackObjects.push(i);this.instToPeer[i.uid]=r,this.peerToInst[r.id]=i}}}}},l.prototype.SetClientState=function(t,e){if(u)this.mp.setClientState(t,e)},l.prototype.AddClientInputValue=function(t,e,i){if(u)this.mp.addClientInputValue(t,e,i)},l.prototype.InputPredictObject=function(t){if(u&&t)if(!this.mp.isHost()){var e=t.getFirstPicked();if(e)if(!(0<=this.inputPredictObjects.indexOf(e)))e.extra.inputPredicted=!0,this.trackObjects.push(e),this.inputPredictObjects.push(e)}},l.prototype.SignallingRequestGameInstanceList=function(t){if(u)this.mp.signallingRequestGameInstanceList(t)},l.prototype.SignallingRequestRoomList=function(t,e,i){if(u){var n="all";if(1===i)n="unlocked";else if(2===i)n="available";this.mp.signallingRequestRoomList(t,e,n)}},l.prototype.SetBandwidthProfile=function(t){if(u){var e,i;if(0===t)e=30,i=80;else e=60,i=40;this.mp.setBandwidthSettings(e,i)}},l.prototype.KickPeer=function(t,e){if(u)if(this.mp.isHost())if(t!==this.mp.getMyID()){var i=this.mp.getPeerById(t);if(i)i.remove(e)}},t.acts=new l,d.prototype.ServerListCount=function(t){t.set_int(i.length)},d.prototype.ServerListURLAt=function(t,e){if((e=Math.floor(e))<0||e>=i.length)t.set_string("");else t.set_string(i[e].url)},d.prototype.ServerListNameAt=function(t,e){if((e=Math.floor(e))<0||e>=i.length)t.set_string("");else t.set_string(i[e].name)},d.prototype.ServerListOperatorAt=function(t,e){if((e=Math.floor(e))<0||e>=i.length)t.set_string("");else t.set_string(i[e].operator)},d.prototype.ServerListWebsiteAt=function(t,e){if((e=Math.floor(e))<0||e>=i.length)t.set_string("");else t.set_string(i[e].operator_website)},d.prototype.SignallingURL=function(t){t.set_string(this.signallingUrl)},d.prototype.SignallingVersion=function(t){t.set_string(u?this.mp.sigserv_version:"")},d.prototype.SignallingName=function(t){t.set_string(u?this.mp.sigserv_name:"")},d.prototype.SignallingOperator=function(t){t.set_string(u?this.mp.sigserv_operator:"")},d.prototype.SignallingMOTD=function(t){t.set_string(u?this.mp.sigserv_motd:"")},d.prototype.MyAlias=function(t){t.set_string(u?this.mp.getMyAlias():"")},d.prototype.CurrentGame=function(t){t.set_string(u?this.mp.getCurrentGame():"")},d.prototype.CurrentInstance=function(t){t.set_string(u?this.mp.getCurrentGameInstance():"")},d.prototype.CurrentRoom=function(t){t.set_string(u?this.mp.getCurrentRoom():"")},d.prototype.ErrorMessage=function(t){t.set_string(this.errorMsg)},d.prototype.MyID=function(t){t.set_string(u?this.mp.getMyID():"")},d.prototype.PeerID=function(t){t.set_string(this.peerID)},d.prototype.PeerAlias=function(t){t.set_string(this.peerAlias)},d.prototype.HostID=function(t){t.set_string(u?this.mp.getHostID():"")},d.prototype.HostAlias=function(t){t.set_string(u?this.mp.getHostAlias():"")},d.prototype.Message=function(t){t.set_string(this.msgContent)},d.prototype.Tag=function(t){t.set_string(this.msgTag)},d.prototype.FromID=function(t){t.set_string(this.msgFromId)},d.prototype.FromAlias=function(t){t.set_string(this.msgFromAlias)},d.prototype.PeerAliasFromID=function(t,e){t.set_string(u?this.mp.getAliasFromId(e):"")},d.prototype.PeerLatency=function(t,e){if(u){var i=this.mp.getPeerById(e);t.set_float(i?i.latency:0)}else t.set_float(0)},d.prototype.PeerPDV=function(t,e){if(u){var i=this.mp.getPeerById(e);t.set_float(i?i.pdv:0)}else t.set_float(0)},d.prototype.StatOutboundCount=function(t){t.set_int(u?this.mp.stats.outboundPerSec:0)},d.prototype.StatOutboundBandwidth=function(t){t.set_int(u?this.mp.stats.outboundBandwidthPerSec:0)},d.prototype.StatInboundCount=function(t){t.set_int(u?this.mp.stats.inboundPerSec:0)},d.prototype.StatInboundBandwidth=function(t){t.set_int(u?this.mp.stats.inboundBandwidthPerSec:0)},d.prototype.PeerState=function(t,e,i){if(u){var n=this.mp.getPeerById(e);t.set_float(n?n.getInterpClientState(i):0)}else t.set_float(0)},d.prototype.ClientXError=function(t){t.set_float(v)},d.prototype.ClientYError=function(t){t.set_float(b)},d.prototype.HostX=function(t){t.set_float(w)},d.prototype.HostY=function(t){t.set_float(x)},d.prototype.PeerCount=function(t){t.set_int(u?this.mp.getPeerCount():0)},d.prototype.ListInstanceCount=function(t){if(this.gameInstanceList)t.set_int(this.gameInstanceList.length);else t.set_int(0)},d.prototype.ListInstanceName=function(t,e){if(e=Math.floor(e),this.gameInstanceList)if(e<0||e>=this.gameInstanceList.length)t.set_string("");else t.set_string(this.gameInstanceList[e].name||"");else t.set_string("")},d.prototype.ListInstancePeerCount=function(t,e){if(e=Math.floor(e),this.gameInstanceList)if(e<0||e>=this.gameInstanceList.length)t.set_int(0);else t.set_int(this.gameInstanceList[e].peercount||0);else t.set_int(0)},d.prototype.ListRoomCount=function(t){t.set_int(this.roomList?this.roomList.length:0)},d.prototype.ListRoomName=function(t,e){var i=p(this.roomList,e);t.set_string(i?i.name:"")},d.prototype.ListRoomPeerCount=function(t,e){var i=p(this.roomList,e);t.set_int(i?i.peercount:0)},d.prototype.ListRoomMaxPeerCount=function(t,e){var i=p(this.roomList,e);t.set_int(i?i.maxpeercount:0)},d.prototype.ListRoomState=function(t,e){var i=p(this.roomList,e);t.set_string(i?i.state:"")},d.prototype.LeaveReason=function(t){t.set_string(this.leaveReason)},e.lagCompensate=function(t,e,i,n){if(!u)return 0;if(!this.mp.isHost())return 0;var r=this.mp.getPeerById(t);if(!r)return 0;var o=this.getAssociatedInstanceForPeer(r);if(!o)return 0;var s=0;switch(i){case"x":s=o.x;break;case"y":s=o.y;break;case"a":s=o.angle}var a=this.mp.getPeerById(e);if(!a||a===r)return s;if(this.mp.me===a)return s;var l=2*(a.latency+this.mp.clientDelay),c=o.uid;if(!this.objectHistories.hasOwnProperty(c))return s;if(void 0===(n=this.objectHistories[c].getInterp(i,0,drama.performance_now()-l,n)))return s;else return n},d.prototype.LagCompensateX=function(t,e,i){t.set_float(this.lagCompensate(e,i,"x",this.mp.INTERP_LINEAR))},d.prototype.LagCompensateY=function(t,e,i){t.set_float(this.lagCompensate(e,i,"y",this.mp.INTERP_LINEAR))},d.prototype.LagCompensateAngle=function(t,e,i){t.set_float(drama.to_degrees(this.lagCompensate(e,i,"a",this.mp.INTERP_ANGULAR)))},d.prototype.PeerIDAt=function(t,e){if(u){e=Math.floor(e);var i=this.mp.getPeerAt(e);t.set_string(i?i.id:"")}else t.set_string("")},d.prototype.PeerAliasAt=function(t,e){if(u){e=Math.floor(e);var i=this.mp.getPeerAt(e);t.set_string(i?i.alias:"")}else t.set_string("")},t.exps=new d}(),assert2(drama,"drama namespace not created"),assert2(drama.plugins_,"drama.plugins_ not created"),drama.plugins_.NodeWebkit=function(t){this.runtime=t},function(){var o=!1,s=null,a=null,l=null,c=null,u=null,h="",d="",p="",f="\\",i=[],m="",g="";function y(t,e){var i=document.createElement("input");if(i.type="file",i.style.display="none",i.id=t,e)i.setAttribute(e,"");return document.body.appendChild(i),i}var t=drama.plugins_.NodeWebkit.prototype;t.Type=function(t){this.plugin=t,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t){this.type=t,this.runtime=t.runtime};var e=t.Instance.prototype;function n(){}function r(){}function v(){}e.onCreate=function(){o=this.runtime.isNWjs;var i=this;if(o){if(s=require("path"),a=require("fs"),c=require("child_process"),"win32"!==(u=window.process||nw.process).platform)f="/";h=s.dirname(u.execPath)+f,d=(u.env.HOME||u.env.HOMEPATH||u.env.USERPROFILE)+f,l=window.nwgui,p=u.mainModule.filename;var t=Math.max(p.lastIndexOf("/"),p.lastIndexOf("\\"));if(-1!==t)p=p.substr(0,t+1);window.ondrop=function(t){t.preventDefault();for(var e=0;e<t.dataTransfer.files.length;++e)m=t.dataTransfer.files[e].path,i.runtime.trigger(drama.plugins_.NodeWebkit.prototype.cnds.OnFileDrop,i);return!1};var e=y("c2nwOpenFileDialog");e.onchange=function(t){g=e.value,i.runtime.trigger(drama.plugins_.NodeWebkit.prototype.cnds.OnOpenDlg,i);try{e.value=null}catch(t){}},e.oncancel=function(){i.runtime.trigger(drama.plugins_.NodeWebkit.prototype.cnds.OnOpenDlgCancel,i)};var n=y("c2nwChooseFolderDialog","nwdirectory");n.onchange=function(t){g=n.value,i.runtime.trigger(drama.plugins_.NodeWebkit.prototype.cnds.OnFolderDlg,i);try{n.value=null}catch(t){}},n.oncancel=function(){i.runtime.trigger(drama.plugins_.NodeWebkit.prototype.cnds.OnFolderDlgCancel,i)};var r=y("c2nwSaveDialog","nwsaveas");r.onchange=function(t){g=r.value,i.runtime.trigger(drama.plugins_.NodeWebkit.prototype.cnds.OnSaveDlg,i);try{r.value=null}catch(t){}},r.oncancel=function(){i.runtime.trigger(drama.plugins_.NodeWebkit.prototype.cnds.OnSaveDlgCancel,i)}}},e.onDestroy=function(){},e.saveToJSON=function(){return{}},e.loadFromJSON=function(t){},e.getDebuggerValues=function(t){t.push({title:"NW.js",properties:[{name:"App folder",value:h,readonly:!0},{name:"User folder",value:d,readonly:!0}]})},n.prototype.PathExists=function(t){if(o)return a.existsSync(t);else return!1},n.prototype.OnFileDrop=function(){return!0},n.prototype.OnOpenDlg=function(){return!0},n.prototype.OnFolderDlg=function(){return!0},n.prototype.OnSaveDlg=function(){return!0},n.prototype.OnOpenDlgCancel=function(){return!0},n.prototype.OnFolderDlgCancel=function(){return!0},n.prototype.OnSaveDlgCancel=function(){return!0},t.cnds=new n,r.prototype.WriteFile=function(t,e){if(o)try{a.writeFileSync(t,e,{encoding:"utf8"})}catch(t){}},r.prototype.RenameFile=function(t,e){if(o)try{a.renameSync(t,e)}catch(t){}},r.prototype.DeleteFile=function(t){if(o)try{a.unlinkSync(t)}catch(t){}},r.prototype.CopyFile=function(t,e){if(o&&t!==e)try{var i=a.readFileSync(t,{flags:"rb"});a.writeFileSync(e,i,{flags:"wb"})}catch(t){}},r.prototype.MoveFile=function(t,e){if(o&&t!==e)try{var i=a.readFileSync(t,{flags:"rb"});if(a.writeFileSync(e,i,{flags:"wb"}),a.existsSync(e))a.unlinkSync(t)}catch(t){}},r.prototype.RunFile=function(t){if(o)c.exec(t,function(){})},r.prototype.ShellOpen=function(t){if(o)nw.Shell.openItem(t)},r.prototype.OpenBrowser=function(t){if(o)nw.Shell.openExternal(t)},r.prototype.CreateFolder=function(t){if(o)try{a.mkdirSync(t)}catch(t){}},r.prototype.AppendFile=function(t,e){if(o)try{a.appendFileSync(t,e,{encoding:"utf8"})}catch(t){}},r.prototype.ListFiles=function(t){if(o){try{i=a.readdirSync(t)}catch(t){}if(!i)i=[]}},r.prototype.ShowOpenDlg=function(t){if(o){var e=document.getElementById("c2nwOpenFileDialog");e.setAttribute("accept",t),e.click()}},r.prototype.ShowFolderDlg=function(t){if(o)document.getElementById("c2nwChooseFolderDialog").click()},r.prototype.ShowSaveDlg=function(t){if(o){var e=document.getElementById("c2nwSaveDialog");e.setAttribute("accept",t),e.click()}},r.prototype.SetWindowX=function(t){if(o&&l)l.Window.get().x=t},r.prototype.SetWindowY=function(t){if(o&&l)l.Window.get().y=t},r.prototype.SetWindowWidth=function(t){if(o&&l)l.Window.get().width=t},r.prototype.SetWindowHeight=function(t){if(o&&l)l.Window.get().height=t},r.prototype.SetWindowTitle=function(t){if(o&&l)l.Window.get().title=t,document.title=t},r.prototype.WindowMinimize=function(){if(o&&l){var t=l.Window.get();setTimeout(function(){t.minimize()},100)}},r.prototype.WindowMaximize=function(){if(o&&l){var t=l.Window.get();setTimeout(function(){t.maximize()},100)}},r.prototype.WindowUnmaximize=function(){if(o&&l){var t=l.Window.get();setTimeout(function(){t.unmaximize()},100)}},r.prototype.WindowRestore=function(){if(o&&l){var t=l.Window.get();setTimeout(function(){t.restore()},100)}},r.prototype.WindowRequestAttention=function(t){if(o&&l)l.Window.get().requestAttention(t?3:0)},r.prototype.WindowSetMaxSize=function(t,e){if(o&&l)l.Window.get().setMaximumSize(t,e)},r.prototype.WindowSetMinSize=function(t,e){if(o&&l)l.Window.get().setMinimumSize(t,e)},r.prototype.WindowSetResizable=function(t){if(o&&l)l.Window.get().setResizable(0!==t)},r.prototype.WindowSetAlwaysOnTop=function(t){if(o&&l)l.Window.get().setAlwaysOnTop(0!==t)},r.prototype.ShowDevTools=function(){if(o&&l)l.Window.get().showDevTools()},r.prototype.SetClipboardText=function(t){if(o&&l)l.Clipboard.get().set(t)},r.prototype.ClearClipboard=function(){if(o&&l)l.Clipboard.get().clear()},t.acts=new r,v.prototype.AppFolder=function(t){t.set_string(h)},v.prototype.AppFolderURL=function(t){t.set_string("file://"+h)},v.prototype.ProjectFilesFolder=function(t){t.set_string(p)},v.prototype.ProjectFilesFolderURL=function(t){t.set_string("file://"+p)},v.prototype.UserFolder=function(t){t.set_string(d)},v.prototype.ReadFile=function(t,e){if(o){var i="";try{i=a.readFileSync(e,{encoding:"utf8"})}catch(t){}t.set_string(i)}else t.set_string("")},v.prototype.FileSize=function(t,e){if(o){var i=0;try{var n=a.statSync(e);if(n)i=n.size||0}catch(t){}t.set_int(i)}else t.set_int(0)},v.prototype.ListCount=function(t){t.set_int(i.length)},v.prototype.ListAt=function(t,e){if((e=Math.floor(e))<0||e>=i.length)t.set_string("");else t.set_string(i[e])},v.prototype.DroppedFile=function(t){t.set_string(m)},v.prototype.ChosenPath=function(t){t.set_string(g)},v.prototype.WindowX=function(t){t.set_int(o&&l?l.Window.get().x:0)},v.prototype.WindowY=function(t){t.set_int(o&&l?l.Window.get().y:0)},v.prototype.WindowWidth=function(t){t.set_int(o&&l?l.Window.get().width:0)},v.prototype.WindowHeight=function(t){t.set_int(o&&l?l.Window.get().height:0)},v.prototype.WindowTitle=function(t){t.set_string(o&&l?l.Window.get().title||"":0)},v.prototype.ClipboardText=function(t){t.set_string(o&&l?l.Clipboard.get().get()||"":0)},t.exps=new v}(),assert2(drama,"drama namespace not created"),assert2(drama.plugins_,"drama.plugins_ not created"),drama.plugins_.Particles=function(t){this.runtime=t},function(){var t=drama.plugins_.Particles.prototype;t.Type=function(t){this.plugin=t,this.runtime=t.runtime};var e=t.Type.prototype;function i(t){this.owner=t,this.active=!1,this.x=0,this.y=0,this.speed=0,this.angle=0,this.opacity=1,this.grow=0,this.size=0,this.gs=0,this.age=0,drama.seal(this)}e.onCreate=function(){if(!this.is_family)this.runtime.xfLoadC2Image(this,this.texture_file,this.texture_filesize),this.spriteX=this.texture_data[3],this.spriteY=this.texture_data[4],this.spriteWidth=this.texture_data[5],this.spriteHeight=this.texture_data[6]},e.onLostWebGLContext=function(){if(!this.is_family)this.webGL_texture=null},e.createParticleTexture=function(){var t=document.createElement("canvas"),e=this.spriteWidth,i=this.spriteHeight;if(t.width=e,t.height=i,!this.texture_img)this.runtime.sectionAlert(this.name);else{t.getContext("2d").drawImage(this.texture_img,this.spriteX,this.spriteY,e,i,0,0,e,i),this.webGL_texture=this.runtime.glwrap.loadTexture(t,!0,this.runtime.linearSampling,this.texture_pixelformat)}},e.onRestoreWebGLContext=function(){if(!this.is_family&&this.instances.length)if(!this.webGL_texture)this.createParticleTexture()},e.loadTextures=function(){if(!this.is_family&&!this.webGL_texture&&this.runtime.glwrap)this.createParticleTexture()},e.unloadTextures=function(){if(!this.is_family&&!this.instances.length&&this.webGL_texture)this.runtime.glwrap.deleteTexture(this.webGL_texture),this.webGL_texture=null},e.preloadCanvas2D=function(t){t.drawImage(this.texture_img,0,0)},i.prototype.init=function(){var t=this.owner,e=Math.random()*t.xrandom-t.xrandom/2,i=Math.random()*t.yrandom-t.yrandom/2;this.x=t.x+(e*Math.cos(t.angle)-i*Math.sin(t.angle)),this.y=t.y+(e*Math.sin(t.angle)+i*Math.cos(t.angle)),this.speed=t.initspeed-t.speedrandom/2+Math.random()*t.speedrandom,this.angle=t.angle-t.spraycone/2+Math.random()*t.spraycone,this.opacity=t.initopacity,this.size=t.initsize-t.sizerandom/2+Math.random()*t.sizerandom,this.grow=t.growrate-t.growrandom/2+Math.random()*t.growrandom,this.gs=0,this.age=0},i.prototype.tick=function(t){var e=this.owner;if(this.x+=Math.cos(this.angle)*this.speed*t,this.y+=Math.sin(this.angle)*this.speed*t,this.y+=this.gs*t,this.speed+=e.acc*t,this.size+=this.grow*t,this.gs+=e.g*t,this.age+=t,!(this.size<1)){if(0!==e.lifeanglerandom)this.angle+=Math.random()*e.lifeanglerandom*t-e.lifeanglerandom*t/2;if(0!==e.lifespeedrandom)this.speed+=Math.random()*e.lifespeedrandom*t-e.lifespeedrandom*t/2;if(0!==e.lifeopacityrandom)if(this.opacity+=Math.random()*e.lifeopacityrandom*t-e.lifeopacityrandom*t/2,this.opacity<0)this.opacity=0;else if(1<this.opacity)this.opacity=1;if(e.destroymode<=1&&this.age>=e.timeout)this.active=!1;if(2===e.destroymode&&this.speed<=0)this.active=!1}else this.active=!1},i.prototype.draw=function(t){var e=this.owner.opacity*this.opacity;if(0!==e){if(0===this.owner.destroymode)e*=1-this.age/this.owner.timeout;t.globalAlpha=e;var i=this.x-this.size/2,n=this.y-this.size/2;if(this.owner.runtime.pixel_rounding)i=i+.5|0,n=n+.5|0;var r=this.owner.type;t.drawImage(r.texture_img,r.spriteX,r.spriteY,r.spriteWidth,r.spriteHeight,i,n,this.size,this.size)}},i.prototype.drawGL=function(t){var e=this.owner.opacity*this.opacity;if(0===this.owner.destroymode)e*=1-this.age/this.owner.timeout;var i=this.size,n=i*this.owner.particlescale,r=this.x-i/2,o=this.y-i/2;if(this.owner.runtime.pixel_rounding)r=r+.5|0,o=o+.5|0;if(!(n<1||0===e))if(n<t.minPointSize||n>t.maxPointSize)t.setOpacity(e),t.quad(r,o,r+i,o,r+i,o+i,r,o+i);else t.point(this.x,this.y,n,e)},i.prototype.left=function(){return this.x-this.size/2},i.prototype.right=function(){return this.x+this.size/2},i.prototype.top=function(){return this.y-this.size/2},i.prototype.bottom=function(){return this.y+this.size/2},t.Instance=function(t){this.type=t,this.runtime=t.runtime};var n=t.Instance.prototype,s=[];function r(){}function o(){}function a(){}n.onCreate=function(){var t=this.properties;if(this.spraying=t[0],this.rate=t[1],this.spraycone=drama.to_radians(t[2]),this.spraytype=t[3],this.initspeed=t[4],this.initsize=t[5],this.initopacity=t[6]/100,this.growrate=t[7],this.xrandom=t[8],this.yrandom=t[9],this.speedrandom=t[10],this.sizerandom=t[11],this.growrandom=t[12],this.acc=t[13],this.g=t[14],this.lifeanglerandom=t[15],this.lifespeedrandom=t[16],this.lifeopacityrandom=t[17],this.destroymode=t[18],this.timeout=t[19],this.particleCreateCounter=0,this.particlescale=1,this.particleBoxLeft=this.x,this.particleBoxTop=this.y,this.particleBoxRight=this.x,this.particleBoxBottom=this.y,this.add_bbox_changed_callback(function(t){t.bbox.set(t.particleBoxLeft,t.particleBoxTop,t.particleBoxRight,t.particleBoxBottom),t.bquad.set_from_rect(t.bbox),t.bbox_changed=!1,t.update_collision_cell(),t.update_render_cell()}),!this.recycled)this.particles=[];this.runtime.tickMe(this),this.type.loadTextures(),this.first_shot=!1},n.saveToJSON=function(){var t,e,i,n={r:this.rate,sc:this.spraycone,st:this.spraytype,s:this.spraying,isp:this.initspeed,isz:this.initsize,io:this.initopacity,gr:this.growrate,xr:this.xrandom,yr:this.yrandom,spr:this.speedrandom,szr:this.sizerandom,grnd:this.growrandom,acc:this.acc,g:this.g,lar:this.lifeanglerandom,lsr:this.lifespeedrandom,lor:this.lifeopacityrandom,dm:this.destroymode,to:this.timeout,pcc:this.particleCreateCounter,fs:this.first_shot,p:[]},r=n.p;for(t=0,e=this.particles.length;t<e;t++)i=this.particles[t],r.push([i.x,i.y,i.speed,i.angle,i.opacity,i.grow,i.size,i.gs,i.age]);return n},n.loadFromJSON=function(t){var e,i,n,r;this.rate=t.r,this.spraycone=t.sc,this.spraytype=t.st,this.spraying=t.s,this.initspeed=t.isp,this.initsize=t.isz,this.initopacity=t.io,this.growrate=t.gr,this.xrandom=t.xr,this.yrandom=t.yr,this.speedrandom=t.spr,this.sizerandom=t.szr,this.growrandom=t.grnd,this.acc=t.acc,this.g=t.g,this.lifeanglerandom=t.lar,this.lifespeedrandom=t.lsr,this.lifeopacityrandom=t.lor,this.destroymode=t.dm,this.timeout=t.to,this.particleCreateCounter=t.pcc,this.first_shot=t.fs,s.push.apply(s,this.particles),drama.clearArray(this.particles);var o=t.p;for(e=0,i=o.length;e<i;e++)n=this.allocateParticle(),r=o[e],n.x=r[0],n.y=r[1],n.speed=r[2],n.angle=r[3],n.opacity=r[4],n.grow=r[5],n.size=r[6],n.gs=r[7],n.age=r[8]},n.onDestroy=function(){s.push.apply(s,this.particles),drama.clearArray(this.particles)},n.allocateParticle=function(){var t;if(s.length)(t=s.pop()).owner=this;else t=new i(this);return this.particles.push(t),t.active=!0,t},n.tick=function(){var t,e,i,n,r,o=this.runtime.getDt(this);if(this.spraying){if(0===this.spraytype)this.particleCreateCounter+=o*this.rate,n=drama.floor(this.particleCreateCounter),this.particleCreateCounter-=n;else n=this.rate;if(1===this.spraytype&&!this.first_shot||0===this.spraytype){for(t=0;t<n;t++)(i=this.allocateParticle()).init();this.first_shot=!0}}for(this.particleBoxLeft=this.x,this.particleBoxTop=this.y,this.particleBoxRight=this.x,this.particleBoxBottom=this.y,r=t=0,e=this.particles.length;t<e;t++)if(i=this.particles[t],this.particles[r]=i,this.runtime.redraw=!0,i.tick(o),i.active){if(i.left()<this.particleBoxLeft)this.particleBoxLeft=i.left();if(i.right()>this.particleBoxRight)this.particleBoxRight=i.right();if(i.top()<this.particleBoxTop)this.particleBoxTop=i.top();if(i.bottom()>this.particleBoxBottom)this.particleBoxBottom=i.bottom();r++}else s.push(i);if(drama.truncateArray(this.particles,r),this.set_bbox_changed(),1===this.spraytype&&0===this.particles.length&&this.first_shot)this.runtime.DestroyInstance(this)},n.draw=function(t){var e,i,n,r=this.layer;for(e=0,i=this.particles.length;e<i;e++)if((n=this.particles[e]).right()>=r.viewLeft&&n.bottom()>=r.viewTop&&n.left()<=r.viewRight&&n.top()<=r.viewBottom)n.draw(t)},n.drawGL=function(t){var e,i,n;this.particlescale=this.layer.getScale(),t.setTexture(this.type.webGL_texture);var r=this.layer;for(e=0,i=this.particles.length;e<i;e++)if((n=this.particles[e]).right()>=r.viewLeft&&n.bottom()>=r.viewTop&&n.left()<=r.viewRight&&n.top()<=r.viewBottom)n.drawGL(t)},n.getDebuggerValues=function(t){t.push({title:"Particles",properties:[{name:"Particle count",value:this.particles.length,readonly:!0},{name:"Type",value:0===this.spraytype?"Continuous":"One-shot",readonly:!0},{name:"Is spraying",value:this.spraying},{name:"Rate",value:this.rate},{name:"Spray cone",value:drama.to_degrees(this.spraycone)},{name:"Speed",value:this.initspeed},{name:"Size",value:this.initsize},{name:"Opacity",value:100*this.initopacity},{name:"Grow rate",value:this.growrate},{name:"X randomiser",value:this.xrandom},{name:"Y randomiser",value:this.yrandom},{name:"Speed randomiser",value:this.speedrandom},{name:"Size randomiser",value:this.sizerandom},{name:"Grow randomiser",value:this.growrandom},{name:"Acceleration",value:this.acc},{name:"Gravity",value:this.g},{name:"Lifetime angle randomiser",value:this.lifeanglerandom},{name:"Lifetime speed randomiser",value:this.lifespeedrandom},{name:"Lifetime opacity randomiser",value:this.lifeopacityrandom},{name:"Timeout",value:this.timeout}]})},n.onDebugValueEdited=function(t,e,i){switch(e){case"Is spraying":this.spraying=i;break;case"Rate":this.rate=i;break;case"Spray cone":this.spraycone=drama.to_radians(i);break;case"Speed":this.initspeed=i;break;case"Size":this.initsize=i;break;case"Opacity":this.initopacity=i/100;break;case"Grow rate":this.growrate=i;break;case"X randomiser":this.xrandom=i;break;case"Y randomiser":this.yrandom=i;break;case"Speed randomiser":this.speedrandom=i;break;case"Size randomiser":this.sizerandom=i;break;case"Grow randomiser":this.growrandom=i;break;case"Acceleration":this.acc=i;break;case"Gravity":this.g=i;break;case"Lifetime angle randomiser":this.lifeanglerandom=i;break;case"Lifetime speed randomiser":this.lifespeedrandom=i;break;case"Lifetime opacity randomiser":this.lifeopacityrandom=i;break;case"Timeout":this.timeout=i}},r.prototype.IsSpraying=function(){return this.spraying},t.cnds=new r,o.prototype.SetSpraying=function(t){this.spraying=0!==t},o.prototype.SetEffect=function(t){this.blend_mode=t,this.compositeOp=drama.effectToCompositeOp(t),drama.setGLBlend(this,t,this.runtime.gl),this.runtime.redraw=!0},o.prototype.SetRate=function(t){var e,i;if(this.rate=t,1===this.spraytype&&this.first_shot)if(t<this.particles.length)for(e=this.particles.length-t,i=0;i<e;i++)s.push(this.particles.pop());else if(t>this.particles.length)for(e=t-this.particles.length,i=0;i<e;i++)this.allocateParticle().opacity=0},o.prototype.SetSprayCone=function(t){this.spraycone=drama.to_radians(t)},o.prototype.SetInitSpeed=function(t){this.initspeed=t},o.prototype.SetInitSize=function(t){this.initsize=t},o.prototype.SetInitOpacity=function(t){this.initopacity=t/100},o.prototype.SetGrowRate=function(t){this.growrate=t},o.prototype.SetXRandomiser=function(t){this.xrandom=t},o.prototype.SetYRandomiser=function(t){this.yrandom=t},o.prototype.SetSpeedRandomiser=function(t){this.speedrandom=t},o.prototype.SetSizeRandomiser=function(t){this.sizerandom=t},o.prototype.SetGrowRateRandomiser=function(t){this.growrandom=t},o.prototype.SetParticleAcc=function(t){this.acc=t},o.prototype.SetGravity=function(t){this.g=t},o.prototype.SetAngleRandomiser=function(t){this.lifeanglerandom=t},o.prototype.SetLifeSpeedRandomiser=function(t){this.lifespeedrandom=t},o.prototype.SetOpacityRandomiser=function(t){this.lifeopacityrandom=t},o.prototype.SetTimeout=function(t){this.timeout=t},t.acts=new o,a.prototype.ParticleCount=function(t){t.set_int(this.particles.length)},a.prototype.Rate=function(t){t.set_float(this.rate)},a.prototype.SprayCone=function(t){t.set_float(drama.to_degrees(this.spraycone))},a.prototype.InitSpeed=function(t){t.set_float(this.initspeed)},a.prototype.InitSize=function(t){t.set_float(this.initsize)},a.prototype.InitOpacity=function(t){t.set_float(100*this.initopacity)},a.prototype.InitGrowRate=function(t){t.set_float(this.growrate)},a.prototype.XRandom=function(t){t.set_float(this.xrandom)},a.prototype.YRandom=function(t){t.set_float(this.yrandom)},a.prototype.InitSpeedRandom=function(t){t.set_float(this.speedrandom)},a.prototype.InitSizeRandom=function(t){t.set_float(this.sizerandom)},a.prototype.InitGrowRandom=function(t){t.set_float(this.growrandom)},a.prototype.ParticleAcceleration=function(t){t.set_float(this.acc)},a.prototype.Gravity=function(t){t.set_float(this.g)},a.prototype.ParticleAngleRandom=function(t){t.set_float(this.lifeanglerandom)},a.prototype.ParticleSpeedRandom=function(t){t.set_float(this.lifespeedrandom)},a.prototype.ParticleOpacityRandom=function(t){t.set_float(this.lifeopacityrandom)},a.prototype.Timeout=function(t){t.set_float(this.timeout)},t.exps=new a}(),assert2(drama,"drama namespace not created"),assert2(drama.plugins_,"drama.plugins_ not created"),drama.plugins_.progressbar=function(t){this.runtime=t},function(){var t=drama.plugins_.progressbar.prototype;t.Type=function(t){this.plugin=t,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t){this.type=t,this.runtime=t.runtime};var e=t.Instance.prototype;function i(){}function n(){}function r(){}e.onCreate=function(){if(this.elem=document.createElement("progress"),this.value=this.properties[0],this.max=this.properties[1],0<this.max&&0<=this.value)this.elem.max=this.max,this.elem.value=this.value;if(this.elem.id=this.properties[4],this.elem.title=this.properties[2],document.body.appendChild(this.elem),this.element_hidden=!1,!this.properties[3])this.elem.style.display="none",this.visible=!1,this.element_hidden=!0;var e;this.elem.onclick=(e=this,function(t){t.stopPropagation(),e.runtime.isInUserInputEvent=!0,e.runtime.trigger(drama.plugins_.progressbar.prototype.cnds.OnClicked,e),e.runtime.isInUserInputEvent=!1}),this.elem.addEventListener("touchstart",function(t){t.stopPropagation()},!1),this.elem.addEventListener("touchmove",function(t){t.stopPropagation()},!1),this.elem.addEventListener("touchend",function(t){t.stopPropagation()},!1),this.elem.addEventListener("mousedown",function(t){t.stopPropagation()}),this.elem.addEventListener("mouseup",function(t){t.stopPropagation()}),this.lastLeft=0,this.lastTop=0,this.lastRight=0,this.lastBottom=0,this.lastWinWidth=0,this.lastWinHeight=0,this.updatePosition(!0),this.runtime.tickMe(this)},e.saveToJSON=function(){return{v:this.elem.value,m:this.elem.max}},e.loadFromJSON=function(t){this.elem.value=t.v,this.elem.max=t.m},e.onDestroy=function(){this.elem.parentElement.removeChild(this.elem),this.elem=null},e.tick=function(){this.updatePosition()},e.updatePosition=function(t){var e=this.layer.layerToCanvas(this.x,this.y,!0),i=this.layer.layerToCanvas(this.x,this.y,!1),n=this.layer.layerToCanvas(this.x+this.width,this.y+this.height,!0),r=this.layer.layerToCanvas(this.x+this.width,this.y+this.height,!1),o=this.runtime.width/this.runtime.devicePixelRatio,s=this.runtime.height/this.runtime.devicePixelRatio;if(!(!this.visible||!this.layer.visible||n<=0||r<=0||o<=e||s<=i)){if(e<1)e=1;if(i<1)i=1;if(o<=n)n=o-1;if(s<=r)r=s-1;var a=window.innerWidth,l=window.innerHeight;if(t||this.lastLeft!==e||this.lastTop!==i||this.lastRight!==n||this.lastBottom!==r||this.lastWinWidth!==a||this.lastWinHeight!==l){if(this.lastLeft=e,this.lastTop=i,this.lastRight=n,this.lastBottom=r,this.lastWinWidth=a,this.lastWinHeight=l,this.element_hidden)this.elem.style.display="",this.element_hidden=!1;var c=Math.round(e)+this.runtime.canvas.offsetLeft,u=Math.round(i)+this.runtime.canvas.offsetTop;this.elem.style.position="absolute",this.elem.style.left=c+"px",this.elem.style.top=u+"px",this.elem.style.width=Math.round(n-e)+"px",this.elem.style.height=Math.round(r-i)+"px"}else if(this.element_hidden)this.elem.style.display="",this.element_hidden=!1}else{if(!this.element_hidden)this.elem.style.display="none";this.element_hidden=!0}},e.draw=function(t){},e.drawGL=function(t){},e.getDebuggerValues=function(t){t.push({title:"Progress bar",properties:[{name:"Value",value:this.elem.value},{name:"Maximum",value:this.elem.max}]})},e.onDebugValueEdited=function(t,e,i){if("Value"===e)this.elem.value=i;else if("Maximum"===e)this.elem.max=i},i.prototype.OnClicked=function(){return!0},i.prototype.CompareProgress=function(t,e){return drama.do_cmp(this.elem.value,t,e)},t.cnds=new i,n.prototype.SetTooltip=function(t){this.elem.title=t},n.prototype.SetVisible=function(t){this.visible=0!==t},n.prototype.SetCSSStyle=function(t,e){this.elem.style[drama.cssToCamelCase(t)]=e},n.prototype.SetProgress=function(t){this.value=t,this.elem.max=this.max,this.elem.value=this.value},n.prototype.SetMaximum=function(t){this.max=t,this.elem.max=this.max,this.elem.value=this.value},n.prototype.SetIndeterminate=function(){this.elem.removeAttribute("value"),this.elem.removeAttribute("max")},t.acts=new n,r.prototype.Progress=function(t){t.set_float(this.elem.value)},r.prototype.Maximum=function(t){t.set_float(this.elem.max)},t.exps=new r}(),assert2(drama,"drama namespace not created"),assert2(drama.plugins_,"drama.plugins_ not created"),drama.plugins_.pubcenter=function(t){this.runtime=t},function(){var t=drama.plugins_.pubcenter.prototype;t.Type=function(t){this.plugin=t,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t){this.type=t,this.runtime=t.runtime};var e=t.Instance.prototype;function i(){}function n(){}e.onCreate=function(){if(this.elem=document.getElementById("c2pubCenterAd"),this.elem)this.appId=this.properties[0],this.adUnitId=this.properties[1],this.element_hidden=!1,this.visible=!0,this.x=-1e3,this.y=-1e3,this.width=160,this.height=600,this.lastLeft=0,this.lastTop=0,this.lastRight=0,this.lastBottom=0,this.lastWinWidth=0,this.lastWinHeight=0,this.bannerShowing=!1,this.interstitialAd=null,this.updatePosition(!0),this.runtime.tickMe(this);else drama.logexport(" Microsoft pubCenter plugin not supported on this platform")},e.onDestroy=function(){if(this.elem)this.elem.parentElement.removeChild(this.elem),this.elem=null},e.tick=function(){this.updatePosition()},e.updatePosition=function(t){if(this.elem){var e=this.x,i=this.y,n=this.x+this.width,r=this.y+this.height,o=window.innerWidth,s=window.innerHeight;if(this.visible){if(t||this.lastLeft!==e||this.lastTop!==i||this.lastRight!==n||this.lastBottom!==r||this.lastWinWidth!==o||this.lastWinHeight!==s){if(this.lastLeft=e,this.lastTop=i,this.lastRight=n,this.lastBottom=r,this.lastWinWidth=o,this.lastWinHeight=s,this.element_hidden)this.elem.style.display="",this.element_hidden=!1;var a=Math.round(e),l=Math.round(i);this.elem.style.position="absolute",this.elem.style.left=a+"px",this.elem.style.top=l+"px",this.elem.style.width=Math.round(n-e)+"px",this.elem.style.height=Math.round(r-i)+"px"}else if(this.element_hidden)this.elem.style.display="",this.element_hidden=!1}else{if(!this.element_hidden)this.elem.style.display="none";this.element_hidden=!0}}},e.draw=function(t){},e.drawGL=function(t){},e.getDebuggerValues=function(t){},e.onDebugValueEdited=function(t,e,i){},i.prototype.IsBannerShowing=function(){return this.bannerShowing},i.prototype.OnInterstitialReady=function(){return!0},i.prototype.OnInterstitialError=function(){return!0},i.prototype.OnInterstitialCompleted=function(){return!0},i.prototype.OnInterstitialCancelled=function(){return!0},t.cnds=new i,n.prototype.ShowBanner=function(t,e){if(this.elem){switch(e){case 0:this.width=160,this.height=600;break;case 1:this.width=250,this.height=250;break;case 2:this.width=300,this.height=250;break;case 3:this.width=300,this.height=600;break;case 4:this.width=728,this.height=90}var i=window.innerWidth,n=window.innerHeight,r=0,o=0,s=this.width,a=this.height;switch(t){case 0:o=r=0;break;case 1:r=i/2-s/2,o=0;break;case 2:r=i-s,o=0;break;case 3:r=0,o=n/2-a/2;break;case 4:r=i/2-s/2,o=n/2-a/2;break;case 5:r=i-s,o=n/2-a/2;break;case 6:r=0,o=n-a;break;case 7:r=i/2-s/2,o=n-a;break;case 8:r=i-s,o=n-a}this.x=Math.round(r),this.y=Math.round(o),this.visible=!0,this.bannerShowing=!0}},n.prototype.HideBanner=function(){this.visible=!1,this.bannerShowing=!1},n.prototype.PrepareInterstitial=function(t,e){if("undefined"!=typeof MicrosoftNSJS){this.interstitialAd=new MicrosoftNSJS.Advertising.InterstitialAd;var i=this;this.interstitialAd.onAdReady=function(){i.runtime.trigger(drama.plugins_.pubcenter.prototype.cnds.OnInterstitialReady,i)},this.interstitialAd.onErrorOccurred=function(){i.runtime.trigger(drama.plugins_.pubcenter.prototype.cnds.OnInterstitialError,i)},this.interstitialAd.onCompleted=function(){i.runtime.trigger(drama.plugins_.pubcenter.prototype.cnds.OnInterstitialCompleted,i)},this.interstitialAd.onCancelled=function(){i.runtime.trigger(drama.plugins_.pubcenter.prototype.cnds.OnInterstitialCancelled,i)};var n=MicrosoftNSJS.Advertising.InterstitialAdType,r=0===e?n.video:n.display;this.interstitialAd.requestAd(r,this.appId,t||this.adUnitId)}},n.prototype.ShowInterstitial=function(){if(this.interstitialAd)if(MicrosoftNSJS.Advertising.InterstitialAdState.ready==this.interstitialAd.state)this.interstitialAd.show()},t.acts=new n,t.exps=new function(){}}(),assert2(drama,"drama namespace not dramaeated"),assert2(drama.plugins_,"drama.plugins_ not dramaeated"),drama.plugins_.Rex_FSM=function(t){this.runtime=t},function(){var t=drama.plugins_.Rex_FSM.prototype;t.Type=function(t){this.plugin=t,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t){this.type=t,this.runtime=t.runtime};var e=t.Instance.prototype;function i(){}function n(){}function r(){}e.onCreate=function(){this.activated=1==this.properties[0];var t=this.properties[1];if(t=""!=t?t:"Off",!this.recycled)this.fsm=new drama.plugins_.Rex_FSM.FSMKlass(this,"Off",t);else this.fsm.Reset(this,"Off",t);this.check_state=null,this.check_state2=null,this.is_echo=!1,this.next_state=null},e.run_trigger=function(t){return this.is_echo=!1,this.runtime.trigger(t,this),this.is_echo},e.get_next_state=function(){if(this.next_state=null,!this.run_trigger(drama.plugins_.Rex_FSM.prototype.cnds.OnLogic))this.run_trigger(drama.plugins_.Rex_FSM.prototype.cnds.OnDefaultLogic);return this.next_state},e.saveToJSON=function(){return{en:this.activated,fsm:this.fsm.saveToJSON()}},e.loadFromJSON=function(t){this.activated=t.en,this.fsm.loadFromJSON(t.fsm)},e.getDebuggerValues=function(t){t.push({title:this.type.name,properties:[{name:"Current",value:this.fsm.CurState},{name:"Previous",value:this.fsm.PreState}]})},t.cnds=new i,i.prototype.OnEnter=function(t){var e=this.check_state==t;return this.is_echo|=e,e},i.prototype.OnDefaultEnter=function(){return!0},i.prototype.OnExit=function(t){var e=this.check_state==t;return this.is_echo|=e,e},i.prototype.OnDefaultExit=function(){return!0},i.prototype.OnTransfer=function(t,e){var i=this.check_state==t&&this.check_state2==e;return this.is_echo|=i,i},i.prototype.OnStateChanged=function(){return!0},i.prototype.OnLogic=function(t){var e=this.fsm.CurState==t;return this.is_echo|=e,e},i.prototype.IsCurState=function(t){return this.fsm.CurState==t},i.prototype.IsPreState=function(t){return this.fsm.PreState==t},i.prototype.OnDefaultLogic=function(){return!0},t.acts=new n,n.prototype.SetActivated=function(t){this.activated=1==t},n.prototype.Request=function(){if(this.activated)this.fsm.Request()},n.prototype.GotoState=function(t){if(this.activated)this.fsm.Request(t)},n.prototype.NextStateSet=function(t){this.next_state=t},t.exps=new r,r.prototype.CurState=function(t){t.set_string(this.fsm.CurState)},r.prototype.PreState=function(t){t.set_string(this.fsm.PreState)}}(),function(){drama.plugins_.Rex_FSM.FSMKlass=function(t,e,i){this.Reset(t,e,i)};var t=drama.plugins_.Rex_FSM.FSMKlass.prototype;t.Reset=function(t,e,i){this.plugin=t,this.PreState=e,this.CurState=i},t.Request=function(t){if(null==t)if(null==(t=this.plugin.get_next_state()))return;this.PreState=this.CurState,this.CurState=t;var e=this.PreState,i=this.CurState;if(this.plugin.run_trigger(drama.plugins_.Rex_FSM.prototype.cnds.OnStateChanged),!this._run_transfer_action(e,i))this._run_exit_action(e),this._run_enter_action(i)},t._run_transfer_action=function(t,e){this.plugin.check_state=t,this.plugin.check_state2=e;var i=this.plugin.run_trigger(drama.plugins_.Rex_FSM.prototype.cnds.OnTransfer);return this.plugin.check_state=null,this.plugin.check_state2=null,i},t._run_exit_action=function(t){this.plugin.check_state=t;var e=this.plugin.run_trigger(drama.plugins_.Rex_FSM.prototype.cnds.OnExit);if(this.plugin.check_state=null,!e)this.plugin.run_trigger(drama.plugins_.Rex_FSM.prototype.cnds.OnDefaultExit)},t._run_enter_action=function(t){this.plugin.check_state=t;var e=this.plugin.run_trigger(drama.plugins_.Rex_FSM.prototype.cnds.OnEnter);if(this.plugin.check_state=null,!e)this.plugin.run_trigger(drama.plugins_.Rex_FSM.prototype.cnds.OnDefaultEnter)},t.saveToJSON=function(){return{ps:this.PreState,cs:this.CurState}},t.loadFromJSON=function(t){this.PreState=t.ps,this.CurState=t.cs}}(),assert2(drama,"drama namespace not created"),assert2(drama.plugins_,"drama.plugins_ not created"),drama.plugins_.shadowlight=function(t){this.runtime=t},function(){var t=drama.plugins_.shadowlight.prototype;t.Type=function(t){this.plugin=t,this.runtime=t.runtime};var e=t.Type.prototype,i=!1,d=null,p=null;e.onCreate=function(){if(!this.is_family)if(!i){i=!0;var e=this.runtime.getLocalFileUrl("penumbra.png");this.runtime.xfPreloadGroup.push(e,function(t){(d=t[e]).cr_filesize=15e3})}},e.onLostWebGLContext=function(){if(!this.is_family){var t,e,i;for(this.webGL_texture=null,this.penumbra_texture=null,t=0,e=this.instances.length;t<e;++t)(i=this.instances[t]).webGL_texture=null,i.penumbra_texture=null}},e.onRestoreWebGLContext=function(){if(!this.is_family){var t,e;for(t=0,e=this.instances.length;t<e;++t)this.instances[t].createTextures()}},t.Instance=function(t){this.type=t,this.runtime=t.runtime};var n=t.Instance.prototype;n.onCreate=function(){!function(){if(p)return;var t=d.width,e=d.height,i=document.createElement("canvas");i.width=t,i.height=e;var n=i.getContext("2d");n.clearRect(0,0,t,e),n.drawImage(d,0,0,t,e),p=n.getImageData(0,0,t,e).data}(),this.lightX=this.x,this.lightY=this.y,this.lightZ=this.properties[0],this.max_extrude=1e3,this.lightRadius=this.properties[1];var t=this.properties[2];if(this.lightR=Math.floor(255*t[0]),this.lightG=Math.floor(255*t[1]),this.lightB=Math.floor(255*t[2]),this.castFrom=this.properties[3],this.tag=this.properties[4],this.lastKnownX=this.x,this.lastKnownY=this.y,this.webGL_texture=null,this.penumbra_texture=null,this.runtime.glwrap)this.createTextures();else this.lightRadius=0;this.runtime.tick2Me(this)},n.castsFrom=function(t){if(1===this.castFrom)return drama.equals_nocase(this.tag,t);else if(2===this.castFrom)return!drama.equals_nocase(this.tag,t);else return!0},n.tick2=function(){if(this.lastKnownX!==this.x||this.lastKnownY!==this.y)this.lightX=this.x,this.lightY=this.y;var t=this.layer,e=(t.viewLeft+t.viewRight)/2,i=(t.viewTop+t.viewBottom)/2,n=t.viewRight-t.viewLeft+this.max_extrude,r=t.viewBottom-t.viewTop+this.max_extrude;if(e!==this.x||i!==this.y||n!==this.width||r!==this.height)this.x=e,this.y=i,this.width=n,this.height=r,this.set_bbox_changed();this.lastKnownX=this.x,this.lastKnownY=this.y,this.max_extrude=1.5*drama.distanceTo(t.viewLeft,t.viewTop,t.viewRight,t.viewBottom)},n.onDestroy=function(){if(this.runtime.glwrap){if(this.webGL_texture)this.runtime.glwrap.deleteTexture(this.webGL_texture),this.webGL_texture=null;if(this.penumbra_texture)this.runtime.glwrap.deleteTexture(this.penumbra_texture),this.penumbra_texture=null}},n.saveToJSON=function(){return{}},n.loadFromJSON=function(t){};var g=[],y=[];n.getShadowCasterCandidates=function(){if(this.runtime.shadowcasterBehavior)this.runtime.getTypesCollisionCandidates(this.layer,this.runtime.shadowcasterBehavior.myTypes,this.bbox,g),drama.removeArrayDuplicates(g)};var P=[],w=0,x=[],h=[],E=-1,A=-1,k=-1,M=-1,R=0,L=0,S=[],D=0,N=0,B=0,F=0,j=0,G=0,V=0,U=0,v=new drama.CollisionPoly([]);function m(t){if((t%=x.length)<0)t+=x.length;return t}function f(){var t,e,i,n;for(t=0,e=x.length;t<e;++t){if(i=x[t],(n=x[m(t-1)])&&!i)E=t;if(!n&&i)k=t}}n.draw=function(t){var e,i,n,r,o,s,a,l,c,u,h,d,p,f,m;for(this.getShadowCasterCandidates(),t.save(),t.fillStyle="rgba("+this.lightR+","+this.lightG+","+this.lightB+","+this.opacity+")",e=0,i=g.length;e<i;++e)if((n=g[e]).extra.shadowcasterEnabled&&this.castsFrom(n.extra.shadowcasterTag))if(n.update_bbox(),l=n.extra.shadowcasterHeight,n.tilemap_exists){for(n.getCollisionRectCandidates(this.bbox,y),u=n.x,h=n.y,r=0,o=y.length;r<o;++r){if(m=(f=y[r]).rc,c=null,f.poly)c=f.poly,d=m.left,p=m.top;else v.set_from_rect(m,0,0),c=v,p=d=0;for(this.calcShadow(c,u+d,h+p,l,!1),t.beginPath(),t.moveTo(S[0],S[1]),s=2,a=S.length;s<a;s+=2)t.lineTo(S[s],S[s+1]);t.closePath(),t.fill(),drama.clearArray(x),drama.clearArray(S)}drama.clearArray(y)}else{if(c=null,n.collision_poly&&!n.collision_poly.is_empty())n.collision_poly.cache_poly(n.width,n.height,n.angle),c=n.collision_poly;else v.set_from_quad(n.bquad,n.x,n.y,n.width,n.height),c=v;for(this.calcShadow(c,n.x,n.y,l,drama.xor(n.width<0,n.height<0)),t.beginPath(),t.moveTo(S[0],S[1]),r=2,o=S.length;r<o;r+=2)t.lineTo(S[r],S[r+1]);t.closePath(),t.fill(),drama.clearArray(x),drama.clearArray(S)}t.restore(),drama.clearArray(g)},n.getPolyPoints=function(t,e,i,n){var r,o;w=t.pts_count,drama.clearArray(P);var s,a,l=t.pts_cache;for(s=L=R=0;s<w;++s){if(r=l[a=2*s]+e,o=l[a+1]+i,n)P.unshift(o),P.unshift(r);else P.push(r),P.push(o);R+=r,L+=o}R/=w,L/=w},n.calcShadow=function(t,e,i,n,r){var o,s,a,l;this.getPolyPoints(t,e,i,r),drama.clearArray(x),drama.clearArray(h),drama.clearArray(S),M=A=k=E=-1;var c=this.lightX,u=this.lightY;if(0<this.lightRadius){if(this.calcBackFaces(-this.lightRadius),f(),drama.shallowAssignArray(h,x),A=E,M=k,drama.clearArray(x),k=E=-1,this.calcBackFaces(this.lightRadius),f(),-1===E||-1===k||-1===A||-1===M)return;this.calcUmbraWithRadius(n)}else for(this.calcBackFaces(0),f(),o=0;o<w;++o)a=P[s=2*o],l=P[s+1],this.calcShadowSegment(o,c,u,a,l,n)},n.calcShadowSegment=function(t,e,i,n,r,o){var s,a,l,c,u,h=x[t],d=x[m(t-1)],p=t===E,f=t===k;if(h||d)s=drama.angleTo(e,i,n,r),a=drama.distanceTo(e,i,n,r),l=this.calculateExtrusion(e,i,n,r,o),c=e+Math.cos(s)*(a+l),u=i+Math.sin(s)*(a+l);else c=n,u=r;if(f)S.push(n),S.push(r);if(S.push(c),S.push(u),p)S.push(n),S.push(r)},n.calcBackFaces=function(t){var e,i,n,r,o,s,a,l,c,u,h,d,p,f,m,g,y=this.lightX,v=this.lightY,b=y,_=v;for(e=0;e<w;++e){if(n=(n=e+1)===w?0:2*n,r=P[i=2*e],o=P[i+1],s=P[n],a=P[n+1],0!==t)l=drama.angleTo(y,v,R,L)-Math.PI/2,b=y+Math.cos(l)*t,_=v+Math.sin(l)*t;x.push((c=b,u=_,h=r,d=o,p=s,f=a,void 0,m=drama.angleTo(h,d,p,f)-Math.PI/2,g=drama.angleTo(h,d,c,u),drama.angleDiff(g,m)>=Math.PI/2))}};var I=0,T=0;function r(){}function o(){}n.calcUmbraWithRadius=function(t){for(var e,i,n,r=A;i=P[e=2*(r%=w)],n=P[e+1],S.push(i),S.push(n),r!==k;++r);var o=this.lightRadius,s=i,a=n,l=drama.angleTo(this.lightX,this.lightY,R,L),c=this.lightX+Math.cos(l-Math.PI/2)*o,u=this.lightY+Math.sin(l-Math.PI/2)*o,h=drama.angleTo(c,u,s,a),d=drama.distanceTo(c,u,s,a),p=c+Math.cos(h)*(d+this.max_extrude),f=u+Math.sin(h)*(d+this.max_extrude),m=P[e=2*A],g=P[e+1];l=drama.angleTo(this.lightX,this.lightY,R,L);var y=this.lightX+Math.cos(l+Math.PI/2)*o,v=this.lightY+Math.sin(l+Math.PI/2)*o;h=drama.angleTo(y,v,m,g),d=drama.distanceTo(y,v,m,g);var b=y+Math.cos(h)*(d+this.max_extrude),_=v+Math.sin(h)*(d+this.max_extrude);if(function(t,e,i,n,r,o,s,a){var l,c,u,h,d,p,f;if(0==(f=-(u=s-r)*(c=n-e)+(l=i-t)*(h=a-o)))return!1;if(d=(-c*(t-r)+l*(e-o))/f,0==(f=-u*c+l*h))return!1;if(p=(u*(e-o)-h*(t-r))/f,0<=d&&d<=1&&0<=p&&p<=1)return I=t+p*l,T=e+p*c,!0;else return!1}(j=s,G=a,p,f,D=m,N=g,b,_))S.push(I),S.push(T),B=V=I,F=U=T;else S.push(p),S.push(f),S.push(b),S.push(_),V=p,U=f,B=b,F=_},n.calculateExtrusion=function(t,e,i,n,r){if(r>=this.lightZ)return this.max_extrude;if(r<=0)return 0;var o=drama.distanceTo(t,e,i,n),s=Math.atan(o/(this.lightZ-r)),a=r*Math.tan(s);if(a>=this.max_extrude)a=this.max_extrude;if(a<0)a=0;return a},n.drawGL=function(t){var e,i,n,r,o,s,a,l,c,u,h,d,p;for(t.setOpacity(this.opacity),this.getShadowCasterCandidates(),e=0,i=g.length;e<i;++e)if((o=g[e]).extra.shadowcasterEnabled&&this.castsFrom(o.extra.shadowcasterTag))if(o.update_bbox(),s=o.extra.shadowcasterHeight,o.tilemap_exists){for(o.getCollisionRectCandidates(this.bbox,y),l=o.x,c=o.y,n=0,r=y.length;n<r;++n){if(h=(u=y[n]).rc,a=null,u.poly)a=u.poly,d=h.left,p=h.top;else v.set_from_rect(h,0,0),a=v,p=d=0;if(this.calcShadow(a,l+d,c+p,s,!1),!(S.length<6)){if(t.setTexture(this.webGL_texture),t.convexPoly(S),-1<E&&-1<A)t.setTexture(this.penumbra_texture),this.drawPenumbraGL(t,!0);if(-1<k&&-1<M)t.setTexture(this.penumbra_texture),this.drawPenumbraGL(t,!1);drama.clearArray(x),drama.clearArray(S)}}drama.clearArray(y)}else{if(a=null,o.collision_poly&&!o.collision_poly.is_empty())o.collision_poly.cache_poly(o.width,o.height,o.angle),a=o.collision_poly;else v.set_from_quad(o.bquad,o.x,o.y,o.width,o.height),a=v;if(this.calcShadow(a,o.x,o.y,s,drama.xor(o.width<0,o.height<0)),S.length<6)continue;if(t.setTexture(this.webGL_texture),t.convexPoly(S),-1<E&&-1<A)t.setTexture(this.penumbra_texture),this.drawPenumbraGL(t,!0);if(-1<k&&-1<M)t.setTexture(this.penumbra_texture),this.drawPenumbraGL(t,!1);drama.clearArray(x),drama.clearArray(S)}drama.clearArray(g)},n.drawPenumbraGL=function(t,e){var i,n,r,o,s,a,l=this.lightX,c=this.lightY;if(e)r=D,o=N,s=B,a=F;else r=j,o=G,s=V,a=U;var u=this.lightRadius,h=drama.angleTo(l,c,R,L),d=Math.PI/2;if(e)d=-d;l+=Math.cos(h+d)*u,c+=Math.sin(h+d)*u;var p=!1;if(e){if(p=E!==A)i=P[2*E],n=P[2*E+1]}else if(p=k!==M)i=P[2*M],n=P[2*M+1];if(p)h=drama.angleTo(i,n,r,o);else h=drama.angleTo(l,c,r,o);var f,m,g,y,v,b=r+Math.cos(h)*this.max_extrude,_=o+Math.sin(h)*this.max_extrude,w=0,x=0,S=1;if(p){g=drama.angleTo(l,c,i,n),f=i+Math.cos(g)*this.max_extrude,m=n+Math.sin(g)*this.max_extrude,y=h,v=drama.angleTo(r,o,s,a),w=drama.angleDiff(y,g)/drama.angleDiff(v,g);var I=drama.distanceTo(i,n,r,o),T=I/(I+this.max_extrude),C=drama.angleTo(0,1,w,0),O=drama.distanceTo(0,1,w,0);x+=Math.cos(C)*T*O,S+=Math.sin(C)*T*O}if(t.quadTexUV(r,o,s,a,b,_,b,_,x,S,1,0,w,0,w,0),p)t.quadTexUV(i,n,b,_,f,m,f,m,0,1,w,0,0,0,0,0)},n.createTextures=function(){if(this.runtime.glwrap){if(this.webGL_texture)this.runtime.glwrap.deleteTexture(this.webGL_texture),this.webGL_texture=null;if(this.penumbra_texture)this.runtime.glwrap.deleteTexture(this.penumbra_texture),this.penumbra_texture=null;this.createFillTexture(),this.createPenumbraTexture()}},n.createFillTexture=function(){var t=document.createElement("canvas");t.width=16,t.height=16;var e=t.getContext("2d");e.fillStyle="rgb("+this.lightR+","+this.lightG+","+this.lightB+")",e.fillRect(0,0,16,16),this.webGL_texture=this.runtime.glwrap.createEmptyTexture(16,16,!1,!1,!0),this.runtime.glwrap.videoToTexture(t,this.webGL_texture)},n.createPenumbraTexture=function(){var t=d.width,e=d.height,i=this.lightR,n=this.lightG,r=this.lightB,o=p,s=document.createElement("canvas");s.width=t,s.height=e;var a,l,c=s.getContext("2d"),u=c.createImageData(t,e),h=u.data;for(a=0,l=h.length;a<l;a+=4)h[a]=i,h[a+1]=n,h[a+2]=r,h[a+3]=o[a+3];c.putImageData(u,0,0),this.penumbra_texture=this.runtime.glwrap.createEmptyTexture(t,e,this.runtime.linearSampling,!1,!1),this.runtime.glwrap.videoToTexture(s,this.penumbra_texture)},n.getDebuggerValues=function(t){},n.onDebugValueEdited=function(t,e,i){},t.cnds=new function(){},r.prototype.SetLightHeight=function(t){if(this.lightZ!==t)this.lightZ=t,this.runtime.redraw=!0},r.prototype.SetLightColor=function(t){var e=drama.clamp(Math.floor(255*drama.GetRValue(t)),0,255),i=drama.clamp(Math.floor(255*drama.GetGValue(t)),0,255),n=drama.clamp(Math.floor(255*drama.GetBValue(t)),0,255);if(this.lightR!==e||this.lightG!==i||this.lightB!==n)this.lightR=e,this.lightG=i,this.lightB=n,this.createTextures(),this.runtime.redraw=!0},r.prototype.SetTag=function(t){if(this.tag!==t)this.tag=t,this.runtime.redraw=!0},t.acts=new r,o.prototype.LightX=function(t){t.set_float(this.lightX)},o.prototype.LightY=function(t){t.set_float(this.lightY)},o.prototype.Tag=function(t){t.set_string(this.tag)},t.exps=new o}(),drama.plugins_.Share=function(t){this.runtime=t},function(){var n=0,c=1,u=2,h=3,o=1,d=0,p=1;function s(e){console.log("onWeixin"),wx.onShow(function t(){e.success(),wx.offShow(t)})}var t=drama.plugins_.Share.prototype;t.Type=function(t){this.plugin=t,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t){this.type=t,this.runtime=t.runtime,this.shares=[],this.currentShare={},this.swicthes={}};var e=t.Instance.prototype;function f(){}function i(){}function r(){}e.onCreate=function(){var e=this,t=xf.gameInfo;this.swicthes=this.properties[0],xf.webApi.getAllShareInfo(t.gameId,t.secretKey).then(function(t){e.shares=(t||{}).list,console.log("share list",t),e.onAppShare()},function(t){console.error("获取分享信息失败"+JSON.stringify(t))})},e.onDestroy=function(){this.modal.destroy(),this.modal=null},e.onAppShare=function(){var t=this.runtime,e=this.swicthes;if(t.isWeixin&&e[c])this.onWX_ByteAppShare(c,wx);else if(t.isByte&&e[u])this.onWX_ByteAppShare(u,tt);else if(t.isByte&&!e[u])tt.hideShareMenu({success:function(){console.log("hide success")},fail:function(){console.log("hide fail")}})},e.onWX_ByteAppShare=function(e,t){var i=this,n=i.runtime,r=this.getShareParam(e,function(t){return t.shareType===e&&t.sceneType===o});if(r)t.showShareMenu({success:function(){t.onShareAppMessage(function(){var t=i.getShareParam(e,function(t){return t.shareType===e&&t.sceneType===o});if(n.isByte||n.isWeixin)t.success=function(){console.log("分享成功"),n.trigger(f.prototype.onProtoSuccess,i)},t.fail=function(){console.error("分享失败"),n.trigger(f.prototype.onProtoFailed,i)},n.isWeixin&&s(t);return t})},fail:function(){console.error("展示右上角分享按钮失败",r),t.showToast({title:"右上角分享无法打开",icon:"none"})}});else console.error("游戏的右上角分享参数不存在"),t.showToast({title:"分享内容获取失败",icon:"none"})},e.modalInit=function(){if(!this.modal){this.modal=new xf.xfModal,this.modal.width=.5*this.runtime.original_width,this.modal.height=this.modal.width*(358/612);var t=new xf.xfContainer;t.width=this.modal.width,t.height=this.modal.height;var e=new xf.xfImage;e.width=.5*this.runtime.original_width,e.height=this.modal.width*(358/612),xf.createImageLoader("assets/share/share-window.png").then(function(t){e.source=t}),t.addChild(e),this.modal.setContentView(t)}},e.doPreviewShare=function(e,i){if(!this.getShareParam(e,function(t){return t.shareType===e&&t.actionName===i}))return console.error("该场景分享参数不存在"),void alert("分享内容获取失败");this.modalInit(),this.modal.show(),this.runtime.is_catch_event=!1;var l=this,t=function t(){var e,i;if(l.runtime.isMobile)e=event.changedTouches[0].pageX,i=event.changedTouches[0].pageY;else e=event.pageX,i=event.pageY;var n=drama.convertPageXY(e,i);e=n.pageX-l.runtime.canvas.offsetLeft,i=n.pageY-l.runtime.canvas.offsetTop;var r=l.runtime.layouts,o=r[Object.keys(r)[0]].layers[0],s=o.canvasToLayer(e,i,!0),a=o.canvasToLayer(e,i,!1);if(xf.Rect.create(l.modal.x,l.modal.y,l.modal.width,l.modal.height).contains(s,a))if(l.runtime.is_catch_event=!0,l.runtime.trigger(f.prototype.onSuccess,l),l.modal.close(),l.runtime.isMobile)l.runtime.canvas.removeEventListener("touchend",t);else l.runtime.canvas.removeEventListener("click",t)};setTimeout(function(){if(l.runtime.isMobile)l.runtime.canvas.addEventListener("touchend",t);else l.runtime.canvas.addEventListener("click",t)},100)},e.doCordovaShare=function(e,i){if(cordova.plugins.sharesdk){var n=this.runtime,r=this,t=this.getShareParam(e,function(t){return t.shareType===e&&t.actionName===i});if(t){if(console.log("获取分享信息："+JSON.stringify(t)),t.actionType==p){var o=t.title,s=t.description,a=t.linkUrl,l=t.icon;cordova.plugins.sharesdk.showShareLink(o,s,l,a,function(t){console.log(t+"分享成功"),n.trigger(f.prototype.onSuccess,r)},function(t){console.error("分享失败 "+t),n.trigger(f.prototype.onFailed,r)})}else if(t.actionType==d){var c=t.imgUrl;cordova.plugins.sharesdk.showShareImage(c,function(t){console.log(t+"分享成功"),n.trigger(f.prototype.onSuccess,r)},function(t){console.error("分享失败 "+t),n.trigger(f.prototype.onFailed,r)})}}else console.error("游戏该场景下的分享参数不存在"),cordova.plugins.DramaApplication.showAlert("分享内容获取失败",!1),n.trigger(f.prototype.onFailed,r)}else console.log("分享组件未初始化")},e.doWX_ByteShare=function(e,i){var t=this.runtime,n=t.isWeixin?wx:tt,r=this.getShareParam(e,function(t){return t.shareType===e&&t.actionName===i});if(t.isWeixin&&s(r),r)n.shareAppMessage(r);else console.error("游戏该场景下的分享参数不存在"),n.showToast({title:"分享内容获取失败",icon:"none"})},e.doLimiShare=function(){},e.getShareParam=function(t,e){if("function"!=typeof e)throw Error("condiction need to be a function");for(var i=this.runtime,n=this,r=null,o=null,s=n.shares,a=0,l=s.length;a<l;a++)if(e(s[a])){r=JSON.parse(JSON.stringify(s[a]));break}if(r){switch(n.currentShare=r,t){case c:o={title:r.title,imageUrlId:r.imgId,imageUrl:r.imgUrl,success:function(){console.log("分享成功"),i.trigger(f.prototype.onSuccess,n)},fail:function(){console.error("分享失败"),i.trigger(f.prototype.onFailed,n)}};break;case u:o={title:r.title,imageUrl:r.imgUrl,success:function(){console.log("分享成功"),i.trigger(f.prototype.onSuccess,n)},fail:function(){console.error("分享失败"),i.trigger(f.prototype.onFailed,n)}};break;case h:break;default:o=r}return console.log("调用平台分享的参数信息",o),o}else return n.currentShare={},console.log("调用平台分享的参数信息",r),null},f.prototype.onSuccess=function(t,e){console.log("share success",arguments);var i=this.currentShare;return i.shareType===+t&&i.actionName===e},f.prototype.onFailed=function(t,e){console.log("share fail",arguments);var i=this.currentShare;return i.shareType===+t&&i.actionName===e},f.prototype.onProtoSuccess=function(t){console.log("share right success",arguments);var e=this.currentShare;return e.shareType===+t&&o===+e.sceneType},f.prototype.onProtoFailed=function(t){console.log("share right fail",arguments);var e=this.currentShare;return e.shareType===+t&&o===+e.sceneType},t.cnds=new f,i.prototype.onShareAction=function(t,e){var i=this.runtime;if("h5"!=xfConfig.exportType||!window.xsSdk){if(t=parseInt(t),i.isWeixin&&c===t)this.doWX_ByteShare(t,e);else if(i.isByte&&u===t)this.doWX_ByteShare(t,e);else if(i.isCordova&&n===t)this.doCordovaShare(t,e);else if(i.isPreview&&n===t)this.doPreviewShare(t,e)}else if(window.xsSdk&&window.xsSdk.share&&xfConfig.share)window.xsSdk.share(xfConfig.share,function(){console.log("h5分享初始化成功")})},t.acts=new i,r.prototype.actionName=function(){},t.exps=new r}(),assert2(drama,"drama namespace not created"),assert2(drama.plugins_,"drama.plugins_ not created"),drama.plugins_.sliderbar=function(t){this.runtime=t},function(){var t=drama.plugins_.sliderbar.prototype;t.Type=function(t){this.plugin=t,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t){this.type=t,this.runtime=t.runtime};var e=t.Instance.prototype;function i(){}function n(){}function r(){}e.onCreate=function(){if(this.elem=document.createElement("input"),this.elem.type="range",this.elem.max=this.properties[2],this.elem.min=this.properties[1],this.elem.step=this.properties[3],this.elem.value=this.properties[0],this.elem.disabled=!this.properties[6],this.elem.id=this.properties[7],this.elem.title=this.properties[4],document.body.appendChild(this.elem),this.element_hidden=!1,!this.properties[5])this.elem.style.display="none",this.visible=!1,this.element_hidden=!0;var e,i;this.elem.onclick=(e=this,function(t){t.stopPropagation(),e.runtime.isInUserInputEvent=!0,e.runtime.trigger(drama.plugins_.sliderbar.prototype.cnds.OnClicked,e),e.runtime.isInUserInputEvent=!1}),this.elem.onchange=(i=this,function(t){i.runtime.isInUserInputEvent=!0,i.runtime.trigger(drama.plugins_.sliderbar.prototype.cnds.OnChanged,i),i.runtime.isInUserInputEvent=!1}),this.elem.addEventListener("touchstart",function(t){t.stopPropagation()},!1),this.elem.addEventListener("touchmove",function(t){t.stopPropagation()},!1),this.elem.addEventListener("touchend",function(t){t.stopPropagation()},!1),this.elem.addEventListener("mousedown",function(t){t.stopPropagation()}),this.elem.addEventListener("mouseup",function(t){t.stopPropagation()}),this.elem.addEventListener("keydown",function(t){t.stopPropagation()}),this.elem.addEventListener("keyup",function(t){t.stopPropagation()}),this.lastLeft=0,this.lastTop=0,this.lastRight=0,this.lastBottom=0,this.lastWinWidth=0,this.lastWinHeight=0,this.updatePosition(!0),this.runtime.tickMe(this)},e.saveToJSON=function(){return{v:this.elem.value,mi:this.elem.min,ma:this.elem.max,s:this.elem.step}},e.loadFromJSON=function(t){this.elem.min=t.mi,this.elem.max=t.ma,this.elem.step=t.s,this.elem.value=t.v},e.onDestroy=function(){this.elem.parentElement.removeChild(this.elem),this.elem=null},e.tick=function(){this.updatePosition()},e.updatePosition=function(t){var e=this.layer.layerToCanvas(this.x,this.y,!0),i=this.layer.layerToCanvas(this.x,this.y,!1),n=this.layer.layerToCanvas(this.x+this.width,this.y+this.height,!0),r=this.layer.layerToCanvas(this.x+this.width,this.y+this.height,!1),o=this.runtime.width/this.runtime.devicePixelRatio,s=this.runtime.height/this.runtime.devicePixelRatio;if(!(!this.visible||!this.layer.visible||n<=0||r<=0||o<=e||s<=i)){if(e<1)e=1;if(i<1)i=1;if(o<=n)n=o-1;if(s<=r)r=s-1;var a=window.innerWidth,l=window.innerHeight;if(t||this.lastLeft!==e||this.lastTop!==i||this.lastRight!==n||this.lastBottom!==r||this.lastWinWidth!==a||this.lastWinHeight!==l){if(this.lastLeft=e,this.lastTop=i,this.lastRight=n,this.lastBottom=r,this.lastWinWidth=a,this.lastWinHeight=l,this.element_hidden)this.elem.style.display="",this.element_hidden=!1;var c=Math.round(e)+this.runtime.canvas.offsetLeft,u=Math.round(i)+this.runtime.canvas.offsetTop;this.elem.style.position="absolute",this.elem.style.left=c+"px",this.elem.style.top=u+"px",this.elem.style.width=Math.round(n-e)+"px",this.elem.style.height=Math.round(r-i)+"px"}else if(this.element_hidden)this.elem.style.display="",this.element_hidden=!1}else{if(!this.element_hidden)this.elem.style.display="none";this.element_hidden=!0}},e.draw=function(t){},e.drawGL=function(t){},e.getDebuggerValues=function(t){t.push({title:"Slider bar",properties:[{name:"Value",value:this.elem.value},{name:"Minimum",value:this.elem.min},{name:"Maximum",value:this.elem.max},{name:"Step",value:this.elem.step}]})},e.onDebugValueEdited=function(t,e,i){if("Value"===e)this.elem.value=i;else if("Minimum"===e)this.elem.min=i;else if("Maximum"===e)this.elem.max=i;else if("Step"===e)this.elem.step=i},i.prototype.OnClicked=function(){return!0},i.prototype.OnChanged=function(){return!0},i.prototype.CompareValue=function(t,e){return drama.do_cmp(parseFloat(this.elem.value),t,e)},t.cnds=new i,n.prototype.SetTooltip=function(t){this.elem.title=t},n.prototype.SetVisible=function(t){this.visible=0!==t},n.prototype.SetCSSStyle=function(t,e){this.elem.style[drama.cssToCamelCase(t)]=e},n.prototype.SetValue=function(t){this.elem.value=t},n.prototype.SetMaximum=function(t){this.elem.max=t},n.prototype.SetMinimum=function(t){this.elem.min=t},n.prototype.SetStep=function(t){this.elem.step=t},n.prototype.SetEnabled=function(t){this.elem.disabled=0===t},t.acts=new n,r.prototype.Value=function(t){t.set_float(parseFloat(this.elem.value)||0)},r.prototype.Maximum=function(t){t.set_float(parseFloat(this.elem.max)||0)},r.prototype.Minimum=function(t){t.set_float(parseFloat(this.elem.min)||0)},r.prototype.Step=function(t){t.set_float(parseFloat(this.elem.step)||0)},t.exps=new r}(),assert2(drama,"drama namespace not created"),assert2(drama.plugins_,"drama.plugins_ not created"),drama.plugins_.Sprite=function(t){this.runtime=t},function(){var t=drama.plugins_.Sprite.prototype;t.Type=function(t){this.plugin=t,this.runtime=t.runtime,this.isCreated=!1};var e=t.Type.prototype;function p(){if(0===this.datauri.length){var t=document.createElement("canvas");t.width=this.width,t.height=this.height;var e=t.getContext("2d");if(this.spritesheeted)e.drawImage(this.texture_img,this.offx,this.offy,this.width,this.height,0,0,this.width,this.height);else e.drawImage(this.texture_img,0,0,this.width,this.height);this.datauri=t.toDataURL("image/png")}return this.datauri}e.onCreate=function(){if(!this.is_family){var t,e,i,n,r,o,s,a,l;for(this.all_frames=[],this.has_loaded_textures=!1,t=0,e=this.animations.length;t<e;t++){for(r=this.animations[t],(s={}).name=r[0],s.speed=r[1],s.loop=r[2],s.repeatcount=r[3],s.repeatto=r[4],s.pingpong=r[5],s.sid=r[6],s.frames=[],i=0,n=r[7].length;i<n;i++){o=r[7][i],(a={}).texture_file=o[0],a.texture_filesize=o[1],a.offx=o[2],a.offy=o[3],a.width=o[4],a.height=o[5],a.duration=o[6],a.hotspotX=o[7],a.hotspotY=o[8],a.image_points=o[9],a.poly_pts=o[10],a.pixelformat=o[11],a.poly_type=o[12],a.circle_pts=o[13],a.spritesheeted=0!==a.width,a.datauri="",a.getDataUri=p,l={left:0,top:0,right:1,bottom:1},a.sheetTex=l,a.webGL_texture=null;var c=o[0],u=o[1];this.runtime.xfLoadC2Image(this,c,u,a),drama.seal(a),s.frames.push(a),this.all_frames.push(a)}drama.seal(s),this.animations[t]=s}this.isCreated=!0}},e.dynamicLoad=function(){if(!this.is_family){var t,e,i,n,r,o,s,a,l;this.has_loaded_textures=!1;var c=[],u=[];if(this.isCreated)for(t=0,e=this.all_frames.length;t<e;t++){var h=(a=this.all_frames[t]).texture_file,d=a.texture_filesize;l={left:0,top:0,right:1,bottom:1},a.sheetTex=l,a.webGL_texture=null,c.push(h),u.push(d)}else for(this.all_frames=[],t=0,e=this.animations.length;t<e;t++){for(r=this.animations[t],(s={}).name=r[0],s.speed=r[1],s.loop=r[2],s.repeatcount=r[3],s.repeatto=r[4],s.pingpong=r[5],s.sid=r[6],s.frames=[],i=0,n=r[7].length;i<n;i++)o=r[7][i],(a={}).texture_file=o[0],a.texture_filesize=o[1],a.offx=o[2],a.offy=o[3],a.width=o[4],a.height=o[5],a.duration=o[6],a.hotspotX=o[7],a.hotspotY=o[8],a.image_points=o[9],a.poly_pts=o[10],a.pixelformat=o[11],a.spritesheeted=0!==a.width,a.datauri="",a.getDataUri=p,l={left:0,top:0,right:1,bottom:1},a.sheetTex=l,a.webGL_texture=null,c.push(o[0]),u.push(o[1]),drama.seal(a),s.frames.push(a),this.all_frames.push(a);drama.seal(s),this.animations[t]=s}this.runtime.requestTypeAnimations(this,c,u),this.isCreated=!0}},e.updateAllCurrentTexture=function(){var t,e,i;for(t=0,e=this.instances.length;t<e;t++)(i=this.instances[t]).curWebGLTexture=i.curFrame.webGL_texture},e.onLostWebGLContext=function(){if(!this.is_family){var t,e,i;for(t=0,e=this.all_frames.length;t<e;++t)(i=this.all_frames[t]).texture_img.c2webGL_texture=null,i.webGL_texture=null;this.has_loaded_textures=!1,this.updateAllCurrentTexture()}},e.onRestoreWebGLContext=function(){if(!this.is_family&&this.instances.length){var t,e,i;for(t=0,e=this.all_frames.length;t<e;++t)(i=this.all_frames[t]).webGL_texture=this.runtime.glwrap.loadTexture(i.texture_img,!1,this.runtime.linearSampling,i.pixelformat);this.updateAllCurrentTexture()}},e.loadTextures=function(){if(!this.is_family&&!this.has_loaded_textures&&this.runtime.glwrap){var t,e,i;for(t=0,e=this.all_frames.length;t<e;++t)if((i=this.all_frames[t]).texture_img)i.webGL_texture=this.runtime.glwrap.loadTexture(i.texture_img,!1,this.runtime.linearSampling,i.pixelformat);else this.runtime.sectionAlert(this.name);this.has_loaded_textures=!0}},e.unloadTextures=function(){if(!this.is_family&&!this.instances.length&&this.has_loaded_textures){var t,e,i;for(t=0,e=this.all_frames.length;t<e;++t)i=this.all_frames[t],this.runtime.glwrap.deleteTexture(i.webGL_texture),i.webGL_texture=null;this.has_loaded_textures=!1}};var r=[];e.preloadCanvas2D=function(t){var e,i,n;for(drama.clearArray(r),e=0,i=this.all_frames.length;e<i;++e)if(n=this.all_frames[e].texture_img,-1===r.indexOf(n))t.drawImage(n,0,0),r.push(n)},t.Instance=function(t){if(this.type=t,this.runtime=t.runtime,this.type.animations&&0<this.type.animations.length&&!this.type.animations[0].frames)this.runtime.sectionAlert(this.type.name);var e=this.type.animations[0].frames[0].poly_pts,i=this.type.animations[0].frames[0].poly_type,n=this.type.animations[0].frames[0].circle_pts;this.setPts(i,e,n),this.show_collision_polys=!1};var i=t.Instance.prototype;function n(){}i.onCreate=function(){if(this.visible=this.properties[0],this.isTicking=!1,this.inAnimTrigger=!1,this.collisionsEnabled=this.properties[3],this.cur_animation=this.getAnimationByName(this.properties[1])||this.type.animations[0],this.cur_frame=this.properties[2],this.cur_frame<0)this.cur_frame=0;if(this.cur_frame>=this.cur_animation.frames.length)this.cur_frame=this.cur_animation.frames.length-1;var t,e,i,n,r,o,s,a,l=this.cur_animation.frames[this.cur_frame];if(this.setPts(l.poly_type,l.poly_pts,l.circle_pts),this.hotspotX=l.hotspotX,this.hotspotY=l.hotspotY,this.animForwards=0<=this.cur_animation.speed,this.cur_anim_speed=Math.abs(this.cur_animation.speed),this.cur_anim_repeatto=this.cur_animation.repeatto,(1!==this.type.animations.length||1!==this.type.animations[0].frames.length)&&0!==this.cur_anim_speed)this.runtime.tickMe(this),this.isTicking=!0;if(this.recycled)this.animTimer.reset();else this.animTimer=new drama.KahanAdder;for(this.frameStart=this.getNowTime(),this.animPlaying=!0,this.animRepeats=0,this.animTriggerName="",this.changeAnimName="",this.changeAnimFrom=0,this.changeAnimFrame=-1,this.type.loadTextures(),t=0,e=this.type.animations.length;t<e;t++)for(i=0,n=(r=this.type.animations[t]).frames.length;i<n;i++){if(0===(o=r.frames[i]).width)o.width=o.texture_img.width,o.height=o.texture_img.height;if(o.spritesheeted)if(a=o.texture_img,(s=o.sheetTex).left=o.offx/a.width,s.top=o.offy/a.height,s.right=(o.offx+o.width)/a.width,s.bottom=(o.offy+o.height)/a.height,0===o.offx&&0===o.offy&&o.width===a.width&&o.height===a.height)o.spritesheeted=!1}this.curFrame=this.cur_animation.frames[this.cur_frame],this.curWebGLTexture=this.curFrame.webGL_texture,this.circleBox=new drama.rect(0,0,1,1),this.circleQuad=new drama.quad},i.setCircleRectQuad=function(){var t=this.collision_circle.pts_array,e=t[3],i=t[4],n=Math.max(this.width/e,this.height/i),r=Math.ceil(t[2]*n),o=Math.abs(this.bbox.right-this.bbox.left),s=Math.abs(this.bbox.bottom-this.bbox.top);this.circleBox.set(this.bbox.left+o*(t[0]+this.hotspotX)-r,this.bbox.top+s*(t[1]+this.hotspotY)-r,this.bbox.left+o*(t[0]+this.hotspotX)+r,this.bbox.top+s*(t[1]+this.hotspotY)+r),this.circleQuad.set_from_rect(this.circleBox)},i.setPts=function(t,e,i){if(1==t){if(this.collision_circle)this.collision_circle.set_pts(i);else this.collision_circle=new drama.CollisionCircle(i);this.collision_poly=null}else if(0==t){if(this.collision_poly)this.collision_poly.set_pts(e);else this.collision_poly=new drama.CollisionPoly(e);this.collision_circle=null}},i.saveToJSON=function(){var t={a:this.cur_animation.sid,f:this.cur_frame,cas:this.cur_anim_speed,fs:this.frameStart,ar:this.animRepeats,at:this.animTimer.sum,rt:this.cur_anim_repeatto};if(!this.animPlaying)t.ap=this.animPlaying;if(!this.animForwards)t.af=this.animForwards;return t},i.loadFromJSON=function(t){var e=this.getAnimationBySid(t.a);if(e)this.cur_animation=e;if(this.cur_frame=t.f,this.cur_frame<0)this.cur_frame=0;if(this.cur_frame>=this.cur_animation.frames.length)this.cur_frame=this.cur_animation.frames.length-1;if(this.cur_anim_speed=t.cas,this.frameStart=t.fs,this.animRepeats=t.ar,this.animTimer.reset(),this.animTimer.sum=t.at,this.animPlaying=t.hasOwnProperty("ap")?t.ap:!0,this.animForwards=t.hasOwnProperty("af")?t.af:!0,t.hasOwnProperty("rt"))this.cur_anim_repeatto=t.rt;else this.cur_anim_repeatto=this.cur_animation.repeatto;this.curFrame=this.cur_animation.frames[this.cur_frame],this.curWebGLTexture=this.curFrame.webGL_texture,this.setPts(this.curFrame.poly_type,this.curFrame.poly_pts,this.curFrame.circle_pts),this.hotspotX=this.curFrame.hotspotX,this.hotspotY=this.curFrame.hotspotY},i.animationFinish=function(t){this.cur_frame=t?0:this.cur_animation.frames.length-1,this.animPlaying=!1,this.animTriggerName=this.cur_animation.name,this.inAnimTrigger=!0,this.runtime.trigger(drama.plugins_.Sprite.prototype.cnds.OnAnyAnimFinished,this),this.runtime.trigger(drama.plugins_.Sprite.prototype.cnds.OnAnimFinished,this),this.inAnimTrigger=!1,this.animRepeats=0},i.getNowTime=function(){return this.animTimer.sum},i.tick=function(){if(this.visible){if(this.animTimer.add(this.runtime.getDt(this)),this.changeAnimName.length)this.doChangeAnim();if(0<=this.changeAnimFrame)this.doChangeAnimFrame();var t,e=this.getNowTime(),i=this.cur_animation,n=i.frames[this.cur_frame],r=n.duration/this.cur_anim_speed;if(this.animPlaying&&e>=this.frameStart+r){if(this.animForwards)this.cur_frame++;else this.cur_frame--;if(this.frameStart+=r,this.cur_frame>=i.frames.length)if(i.pingpong)this.animForwards=!1,this.cur_frame=i.frames.length-2;else if(i.loop)this.cur_frame=this.cur_anim_repeatto;else if(this.animRepeats++,this.animRepeats>=i.repeatcount)this.animationFinish(!1);else this.cur_frame=this.cur_anim_repeatto;if(this.cur_frame<0)if(i.pingpong){if(this.cur_frame=1,this.animForwards=!0,!i.loop)if(this.animRepeats++,this.animRepeats>=i.repeatcount)this.animationFinish(!0)}else if(i.loop)this.cur_frame=this.cur_anim_repeatto;else if(this.animRepeats++,this.animRepeats>=i.repeatcount)this.animationFinish(!0);else this.cur_frame=this.cur_anim_repeatto;if(this.cur_frame<0)this.cur_frame=0;else if(this.cur_frame>=i.frames.length)this.cur_frame=i.frames.length-1;if(e>this.frameStart+i.frames[this.cur_frame].duration/this.cur_anim_speed)this.frameStart=e;t=i.frames[this.cur_frame],this.OnFrameChanged(n,t),this.runtime.redraw=!0}}},i.getAnimationByName=function(t){var e,i,n;for(e=0,i=this.type.animations.length;e<i;e++)if(n=this.type.animations[e],drama.equals_nocase(n.name,t))return n;return null},i.getAnimationBySid=function(t){var e,i,n;for(e=0,i=this.type.animations.length;e<i;e++)if((n=this.type.animations[e]).sid===t)return n;return null},i.doChangeAnim=function(){var t=this.cur_animation.frames[this.cur_frame],e=this.getAnimationByName(this.changeAnimName);if(this.changeAnimName="",e)if(!drama.equals_nocase(e.name,this.cur_animation.name)||!this.animPlaying){if(this.cur_animation=e,this.animForwards=0<=e.speed,this.cur_anim_speed=Math.abs(e.speed),this.cur_anim_repeatto=e.repeatto,this.cur_frame<0)this.cur_frame=0;if(this.cur_frame>=this.cur_animation.frames.length)this.cur_frame=this.cur_animation.frames.length-1;if(1===this.changeAnimFrom)this.cur_frame=0;this.animPlaying=!0,this.frameStart=this.getNowTime(),this.OnFrameChanged(t,this.cur_animation.frames[this.cur_frame]),this.runtime.redraw=!0}},i.doChangeAnimFrame=function(){var t=this.cur_animation.frames[this.cur_frame],e=this.cur_frame;if(this.cur_frame=drama.floor(this.changeAnimFrame),this.cur_frame<0)this.cur_frame=0;if(this.cur_frame>=this.cur_animation.frames.length)this.cur_frame=this.cur_animation.frames.length-1;if(e!==this.cur_frame)this.OnFrameChanged(t,this.cur_animation.frames[this.cur_frame]),this.frameStart=this.getNowTime(),this.runtime.redraw=!0;this.changeAnimFrame=-1},i.OnFrameChanged=function(t,e){var i,n,r,o=t.width,s=t.height,a=e.width,l=e.height;if(o!=a)this.width*=a/o;if(s!=l)this.height*=l/s;for(this.hotspotX=e.hotspotX,this.hotspotY=e.hotspotY,this.setPts(e.poly_type,e.poly_pts,e.circle_pts),this.set_bbox_changed(),this.curFrame=e,this.curWebGLTexture=e.webGL_texture,i=0,n=this.behavior_insts.length;i<n;i++)if((r=this.behavior_insts[i]).onSpriteFrameChanged)r.onSpriteFrameChanged(t,e);this.runtime.trigger(drama.plugins_.Sprite.prototype.cnds.OnFrameChanged,this)},i.draw=function(t){t.globalAlpha=this.opacity;var e=this.curFrame,i=e.spritesheeted,n=e.texture_img,r=this.x,o=this.y,s=this.width,a=this.height;if(0===this.angle&&0<=s&&0<=a){if(r-=this.hotspotX*s,o-=this.hotspotY*a,this.runtime.pixel_rounding)r=Math.round(r),o=Math.round(o);if(i)t.drawImage(n,e.offx,e.offy,e.width,e.height,r,o,s,a);else t.drawImage(n,r,o,s,a)}else{if(this.runtime.pixel_rounding)r=Math.round(r),o=Math.round(o);t.save();var l=0<s?1:-1,c=0<a?1:-1;if(t.translate(r,o),1!==l||1!==c)t.scale(l,c);t.rotate(this.angle*l*c);var u=0-this.hotspotX*drama.abs(s),h=0-this.hotspotY*drama.abs(a);if(i)t.drawImage(n,e.offx,e.offy,e.width,e.height,u,h,drama.abs(s),drama.abs(a));else t.drawImage(n,u,h,drama.abs(s),drama.abs(a));t.restore()}},i.drawGL_earlyZPass=function(t){this.drawGL(t)},i.drawCollision=function(t){var e,i,n,r,o,s=this.layer.getScale(),a=s*this.width,l=s*this.height,c=Math.ceil(a),u=Math.ceil(l),h=this.curFrame.circle_pts,d=0,p=0,f=new drama.quad;if(!this.myctx)this.mycanvas=xf.createCanvas(),this.myctx=this.mycanvas.getContext("2d");if(t.deleteTexture(this.mytex),this.mytex=null,1==this.curFrame.poly_type){p=Math.ceil(h[2]*this.width/h[3]);var m=new drama.rect(this.bbox.left+this.width*(h[0]+this.hotspotX)-p,this.bbox.top+this.height*(h[1]+this.hotspotY)-p,this.bbox.left+this.width*(h[0]+this.hotspotX)+p,this.bbox.top+this.height*(h[1]+this.hotspotY)+p);f.set_from_rect(m),d=2*s*p,this.mycanvas.width=d,this.mycanvas.height=d,this.myctx.clearRect(0,0,d,d),this.mytex=t.createEmptyTexture(d,d,this.runtime.linearSampling,this.runtime.isMobile)}else if(0==this.curFrame.poly_type)this.collision_poly.cache_poly(this.width,this.height,this.angle),o=this.collision_poly.pts_cache,this.mycanvas.width=c,this.mycanvas.height=u,this.myctx.clearRect(0,0,c,u),this.mytex=t.createEmptyTexture(c,u,this.runtime.linearSampling,this.runtime.isMobile);if(this.myctx.save(),this.myctx.fillStyle="#ff0000",this.myctx.globalAlpha=.5,1==this.curFrame.poly_type)this.myctx.beginPath(),this.myctx.arc(d/2,d/2,d/2,0,2*Math.PI,!0),this.myctx.fill();else if(0==this.curFrame.poly_type){for(e=0,i=o.length;e<i;e+=2)if(n=o[e]*s+c*this.hotspotX,r=o[e+1]*s+u*this.hotspotY,0===e)this.myctx.moveTo(n,r);else this.myctx.lineTo(n,r);this.myctx.fill()}this.myctx.restore();var g=this.bquad;if(t.videoToTexture(this.mycanvas,this.mytex,this.runtime.isMobile),t.setTexture(this.mytex),t.setOpacity(this.opacity),1==this.curFrame.poly_type)t.quad(f.tlx,f.tly,f.trx,f.try_,f.brx,f.bry,f.blx,f.bly);else t.quad(g.tlx,g.tly,g.trx,g.try_,g.brx,g.bry,g.blx,g.bly)},i.drawGL=function(t){t.setTexture(this.curWebGLTexture),t.setOpacity(this.opacity);var e=this.curFrame,i=this.bquad;if(this.runtime.pixel_rounding){var n=Math.round(this.x)-this.x,r=Math.round(this.y)-this.y;if(e.spritesheeted)t.quadTex(i.tlx+n,i.tly+r,i.trx+n,i.try_+r,i.brx+n,i.bry+r,i.blx+n,i.bly+r,e.sheetTex);else t.quad(i.tlx+n,i.tly+r,i.trx+n,i.try_+r,i.brx+n,i.bry+r,i.blx+n,i.bly+r)}else if(e.spritesheeted)t.quadTex(i.tlx,i.tly,i.trx,i.try_,i.brx,i.bry,i.blx,i.bly,e.sheetTex);else t.quad(i.tlx,i.tly,i.trx,i.try_,i.brx,i.bry,i.blx,i.bly);if(this.show_collision_polys)this.drawCollision(t)},i.getImagePointIndexByName=function(t){var e,i,n=this.curFrame;for(e=0,i=n.image_points.length;e<i;e++)if(drama.equals_nocase(t,n.image_points[e][0]))return e;return-1},i.getImagePoint=function(t,e){var i,n=this.curFrame,r=n.image_points;if(drama.is_string(t))i=this.getImagePointIndexByName(t);else i=t-1;if((i=drama.floor(i))<0||i>=r.length)return e?this.x:this.y;var o=(r[i][1]-n.hotspotX)*this.width,s=r[i][2];s=(s-n.hotspotY)*this.height;var a=Math.cos(this.angle),l=Math.sin(this.angle),c=o*a-s*l;return s=s*a+o*l,o=c,o+=this.x,s+=this.y,e?o:s},i.getDebuggerValues=function(t){t.push({title:"Sprite animation",properties:[{name:"Current animation",value:this.cur_animation.name},{name:"Current frame",value:this.cur_frame},{name:"Playing",value:this.animPlaying},{name:"Speed",value:this.cur_anim_speed},{name:"Repeats",value:this.animRepeats},{name:"Show Collision rects",value:this.show_collision_polys}]})},i.onDebugValueEdited=function(t,e,i){if("Sprite animation"===t)if("Current animation"===e){if(this.changeAnimName=i,this.changeAnimFrom=0,!this.isTicking)this.runtime.tickMe(this),this.isTicking=!0;if(!this.inAnimTrigger)this.doChangeAnim()}else if("Current frame"===e){if(this.changeAnimFrame=i,!this.isTicking)this.runtime.tickMe(this),this.isTicking=!0;if(!this.inAnimTrigger)this.doChangeAnimFrame()}else if("Playing"===e){if(this.animPlaying=i,this.animPlaying)if(this.frameStart=this.getNowTime(),!this.isTicking)this.runtime.tickMe(this),this.isTicking=!0}else if("Speed"===e){if(this.cur_anim_speed=drama.abs(i),this.animForwards=0<=i,!this.isTicking)this.runtime.tickMe(this),this.isTicking=!0}else if("Repeats"===e)this.animRepeats=i;else if("Show Collision rects"===e)this.show_collision_polys=i};var l=[];function b(t){t[0]=0,t[1]=0,t[2]=0,l.push(t)}function c(t,e){if(t<e)return t+","+e;else return e+","+t}function _(t,e,i,n){var r=e.uid,o=i.uid,s=c(r,o);if(!t.hasOwnProperty(s)){var a=function(){if(l.length)return l.pop();else return[0,0,0]}();a[0]=r,a[1]=o,a[2]=n,t[s]=a}else t[s][2]=n}function w(t,e,i){var n=c(e.uid,i.uid);if(t.hasOwnProperty(n))b(t[n]),delete t[n]}var x=-2;function S(t,e,i){var n=c(e.uid,i.uid);if(t.hasOwnProperty(n))return x=t[n][2],!0;else return!(x=-2)}var I=[];n.prototype.OnCollision=function(t){if(!t)return!1;var e=this.runtime,i=e.getCurrentCondition(),n=i.type,r=null;if(i.extra.collmemory)r=i.extra.collmemory;else r={},i.extra.collmemory=r;if(!i.extra.spriteCreatedDestroyCallback)i.extra.spriteCreatedDestroyCallback=!0,e.addDestroyCallback(function(t){!function(t,e){var i,n,r=e.uid;for(i in t)if(t.hasOwnProperty(i))if((n=t[i])[0]===r||n[1]===r)b(t[i]),delete t[i]}(i.extra.collmemory,t)});var o,s,a,l,c,u,h,d,p=n.getCurrentSol(),f=t.getCurrentSol(),m=p.getObjects(),g=this.runtime.tickcount,y=g-1,v=e.getCurrentEventStack().current_event;for(s=0;s<m.length;s++){if(a=m[s],f.select_all)a.update_bbox(),this.runtime.getCollisionCandidates(a.layer,t,a.bbox,I),o=I,this.runtime.addRegisteredCollisionCandidates(a,t,o);else o=f.getObjects();for(l=0;l<o.length;l++)if(c=o[l],e.testOverlap(a,c)||e.checkRegisteredCollision(a,c)){if(d=!S(r,a,c)||x<y,_(r,a,c,g),d){if(e.pushCopySol(v.solModifiers),u=n.getCurrentSol(),h=t.getCurrentSol(),u.select_all=!1,h.select_all=!1,n===t)u.instances.length=2,u.instances[0]=a,u.instances[1]=c,n.applySolToContainer();else u.instances.length=1,h.instances.length=1,u.instances[0]=a,h.instances[0]=c,n.applySolToContainer(),t.applySolToContainer();v.retrigger(),e.popSol(v.solModifiers)}}else w(r,a,c);drama.clearArray(I)}return!1};var g=null,y=new drama.ObjectSet,v=!1,T=[],C=new drama.rect(0,0,0,0);function o(t,e,i){if(!t)return!1;var n,r,o,s,a,l,c=0!==e||0!==i,u=!1,h=this.runtime.getCurrentCondition(),d=h.type,p=h.inverted,f=t.getCurrentSol(),m=this.runtime.getCurrentEventStack().current_event.orblock;if(f.select_all)this.update_bbox(),C.copy(this.bbox),C.offset(e,i),this.runtime.getCollisionCandidates(this.layer,t,C,T),l=T;else if(m)if(this.runtime.isCurrentConditionFirst()&&!f.else_instances.length&&f.instances.length)l=f.instances;else l=f.else_instances;else l=f.instances;if(v=d!==(g=t)&&!p,c)n=this.x,r=this.y,this.x+=e,this.y+=i,this.set_bbox_changed();for(o=0,s=l.length;o<s;o++)if(a=l[o],this.runtime.testOverlap(this,a)){if(u=!0,p)break;if(d!==t)y.add(a)}if(c)this.x=n,this.y=r,this.set_bbox_changed();return drama.clearArray(T),u}function s(){}function a(){}e.finish=function(t){if(v){if(t){var e,i,n,r=this.runtime.getCurrentEventStack().current_event.orblock,o=g.getCurrentSol(),s=y.valuesRef();if(o.select_all){for(o.select_all=!1,drama.clearArray(o.instances),e=0,i=s.length;e<i;++e)o.instances[e]=s[e];if(r)for(drama.clearArray(o.else_instances),e=0,i=g.instances.length;e<i;++e)if(n=g.instances[e],!y.contains(n))o.else_instances.push(n)}else if(r){var a=o.instances.length;for(e=0,i=s.length;e<i;++e)o.instances[a+e]=s[e],drama.arrayFindRemove(o.else_instances,s[e])}else drama.shallowAssignArray(o.instances,s);g.applySolToContainer()}y.clear(),v=!1}},n.prototype.IsOverlapping=function(t){return o.call(this,t,0,0)},n.prototype.IsOverlappingOffset=function(t,e,i){return o.call(this,t,e,i)},n.prototype.IsAnimPlaying=function(t){if(this.changeAnimName.length)return drama.equals_nocase(this.changeAnimName,t);else return drama.equals_nocase(this.cur_animation.name,t)},n.prototype.CompareFrame=function(t,e){return drama.do_cmp(this.cur_frame,t,e)},n.prototype.CompareAnimSpeed=function(t,e){var i=this.animForwards?this.cur_anim_speed:-this.cur_anim_speed;return drama.do_cmp(i,t,e)},n.prototype.OnAnimFinished=function(t){return drama.equals_nocase(this.animTriggerName,t)},n.prototype.OnAnyAnimFinished=function(){return!0},n.prototype.OnFrameChanged=function(){return!0},n.prototype.IsFlipType=function(t,e){if(0==t)if(this.width<0)return 0==e;else return 1==e;else if(1==t)if(this.height<0)return 0==e;else return 1==e},n.prototype.IsMirrored=function(){return this.width<0},n.prototype.IsFlipped=function(){return this.height<0},n.prototype.OnURLLoaded=function(){return!0},n.prototype.IsCollisionEnabled=function(){return this.collisionsEnabled},t.cnds=new n,s.prototype.Spawn=function(t,e,i){if(t&&e){var n=this.runtime.createInstance(t,e,this.getImagePoint(i,!0),this.getImagePoint(i,!1));if(n){if(void 0!==n.angle)n.angle=this.angle,n.set_bbox_changed();var r,o,s;if(this.runtime.isInOnDestroy++,this.runtime.trigger(Object.getPrototypeOf(t.plugin).cnds.OnCreated,n),n.is_contained)for(r=0,o=n.siblings.length;r<o;r++)s=n.siblings[r],this.runtime.trigger(Object.getPrototypeOf(s.type.plugin).cnds.OnCreated,s);this.runtime.isInOnDestroy--;var a,l=this.runtime.getCurrentAction(),c=!1;if(drama.is_undefined(l.extra.Spawn_LastExec)||l.extra.Spawn_LastExec<this.runtime.execcount)c=!0,l.extra.Spawn_LastExec=this.runtime.execcount;if(t!=this.type){if((a=t.getCurrentSol()).select_all=!1,c)drama.clearArray(a.instances),a.instances[0]=n;else a.instances.push(n);if(n.is_contained)for(r=0,o=n.siblings.length;r<o;r++)if((a=(s=n.siblings[r]).type.getCurrentSol()).select_all=!1,c)drama.clearArray(a.instances),a.instances[0]=s;else a.instances.push(s)}}}},s.prototype.SetEffect=function(t){this.blend_mode=t,this.compositeOp=drama.effectToCompositeOp(t),drama.setGLBlend(this,t,this.runtime.gl),this.runtime.redraw=!0},s.prototype.StopAnim=function(){this.animPlaying=!1},s.prototype.PauseAnim=function(t){this.animPlaying=!!t},s.prototype.StartAnim=function(t){if(this.animPlaying=!0,this.frameStart=this.getNowTime(),1===t&&0!==this.cur_frame)if(this.changeAnimFrame=0,!this.inAnimTrigger)this.doChangeAnimFrame();if(!this.isTicking)this.runtime.tickMe(this),this.isTicking=!0},s.prototype.SetAnim=function(t,e){if(this.changeAnimName=t,this.changeAnimFrom=e,!this.isTicking)this.runtime.tickMe(this),this.isTicking=!0;if(!this.inAnimTrigger)this.doChangeAnim()},s.prototype.SetAnimFrame=function(t){if(this.changeAnimFrame=t,!this.isTicking)this.runtime.tickMe(this),this.isTicking=!0;if(!this.inAnimTrigger)this.doChangeAnimFrame()},s.prototype.SetAnimSpeed=function(t){if(this.cur_anim_speed=drama.abs(t),this.animForwards=0<=t,!this.isTicking)this.runtime.tickMe(this),this.isTicking=!0},s.prototype.SetAnimRepeatToFrame=function(t){if((t=Math.floor(t))<0)t=0;if(t>=this.cur_animation.frames.length)t=this.cur_animation.frames.length-1;this.cur_anim_repeatto=t},s.prototype.SetFlippedType=function(t){if(1!==t){var e=drama.abs(this.width)*(0===t?-1:1);if(this.width===e)return;this.width=e}if(0!==t){var i=drama.abs(this.height)*(1===t?-1:1);if(this.height===i)return;this.height=i}this.set_bbox_changed()},s.prototype.ResetFlipped=function(t){if(0===t)this.width=drama.abs(this.width);else if(1===t)this.height=drama.abs(this.height);this.set_bbox_changed()},s.prototype.SetMirrored=function(t){var e=drama.abs(this.width)*(0===t?-1:1);if(this.width!==e)this.width=e,this.set_bbox_changed()},s.prototype.SetFlipped=function(t){var e=drama.abs(this.height)*(0===t?-1:1);if(this.height!==e)this.height=e,this.set_bbox_changed()},s.prototype.SetScale=function(t){var e=this.width<0?-1:1,i=this.height<0?-1:1,n=this.width*t*e,r=this.height*t*i;if(this.width!==n||this.height!==r)this.width=n,this.height=r,this.set_bbox_changed()},s.prototype.LoadURL=function(t,e,i){var n=new Image,r=this,o=this.curFrame;if(n.onload=function(){if(o.texture_img.src===n.src){if(r.runtime.glwrap&&r.curFrame===o)r.curWebGLTexture=o.webGL_texture;if(0===e)r.width=n.width,r.height=n.height,r.set_bbox_changed();return r.runtime.redraw=!0,void r.runtime.trigger(drama.plugins_.Sprite.prototype.cnds.OnURLLoaded,r)}if(o.texture_img=n,o.offx=0,o.offy=0,o.width=n.width,o.height=n.height,o.spritesheeted=!1,o.datauri="",o.pixelformat=0,r.runtime.glwrap){if(o.webGL_texture)r.runtime.glwrap.deleteTexture(o.webGL_texture);if(o.webGL_texture=r.runtime.glwrap.loadTexture(n,!1,r.runtime.linearSampling),r.curFrame===o)r.curWebGLTexture=o.webGL_texture;r.type.updateAllCurrentTexture()}if(0===e)r.width=n.width,r.height=n.height,r.set_bbox_changed();r.runtime.redraw=!0,r.runtime.trigger(drama.plugins_.Sprite.prototype.cnds.OnURLLoaded,r)},"data:"!==t.substr(0,5)&&0===i)n.crossOrigin="anonymous";this.runtime.setImageSrc(n,t)},s.prototype.SetCollisions=function(t){if(this.collisionsEnabled!==(0!==t))if(this.collisionsEnabled=0!==t,this.collisionsEnabled)this.set_bbox_changed();else{if(this.collcells.right>=this.collcells.left)this.type.collision_grid.update(this,this.collcells,null);this.collcells.set(0,0,-1,-1)}},t.acts=new s,a.prototype.AnimationFrame=function(t){t.set_int(this.cur_frame)},a.prototype.AnimationFrameCount=function(t){t.set_int(this.cur_animation.frames.length)},a.prototype.AnimationName=function(t){t.set_string(this.cur_animation.name)},a.prototype.AnimationSpeed=function(t){t.set_float(this.animForwards?this.cur_anim_speed:-this.cur_anim_speed)},a.prototype.ImagePointX=function(t,e){t.set_float(this.getImagePoint(e,!0))},a.prototype.ImagePointY=function(t,e){t.set_float(this.getImagePoint(e,!1))},a.prototype.ImagePointCount=function(t){t.set_int(this.curFrame.image_points.length)},a.prototype.ImageWidth=function(t){t.set_float(this.curFrame.width)},a.prototype.ImageHeight=function(t){t.set_float(this.curFrame.height)},t.exps=new a}(),assert2(drama,"drama namespace not created"),assert2(drama.plugins_,"drama.plugins_ not created"),drama.plugins_.Spritefont2=function(t){this.runtime=t},function(){var t=drama.plugins_.Spritefont2.prototype;t.onCreate=function(){},t.Type=function(t){this.plugin=t,this.runtime=t.runtime};var e=t.Type.prototype;e.onCreate=function(){if(!this.is_family)this.runtime.xfLoadC2Image(this,this.texture_file,this.texture_filesize),this.spriteX=this.texture_data[3],this.spriteY=this.texture_data[4],this.spriteWidth=this.texture_data[5],this.spriteHeight=this.texture_data[6],this.webGL_texture=null},e.onLostWebGLContext=function(){if(!this.is_family)this.webGL_texture=null},e.onRestoreWebGLContext=function(){if(!this.is_family&&this.instances.length){if(!this.webGL_texture)this.webGL_texture=this.runtime.glwrap.loadTexture(this.texture_img,!1,this.runtime.linearSampling,this.texture_pixelformat);var t,e;for(t=0,e=this.instances.length;t<e;t++)this.instances[t].webGL_texture=this.webGL_texture}},e.unloadTextures=function(){if(!this.is_family&&!this.instances.length&&this.webGL_texture)this.runtime.glwrap.deleteTexture(this.webGL_texture),this.webGL_texture=null},e.preloadCanvas2D=function(t){t.drawImage(this.texture_img,0,0)},t.Instance=function(t){this.type=t,this.runtime=t.runtime};var i=t.Instance.prototype;function d(t){return t.replace(/\s\s*$/,"")}i.onDestroy=function(){var t,e;c(this.lines),t=this.clipList,r(a,t,!1),e=this.clipUV,r(u,e,!1),drama.wipe(this.characterWidthList)},i.onCreate=function(){this.texture_img=this.type.texture_img,this.text=this.properties[0],this.characterWidth=this.properties[2],this.characterHeight=this.properties[3],this.characterSet=this.properties[4];var t=this.properties[5];if(this.characterScale=this.properties[6],this.characterSpacing=this.properties[7],this.lineHeight=this.properties[8],this.halign=this.properties[9]/2,this.valign=this.properties[10]/2,this.wrapbyword=0===this.properties[11],this.visible=this.properties[12],this.textWidth=0,this.textHeight=0,this.recycled)drama.clearArray(this.lines),drama.wipe(this.clipList),drama.wipe(this.clipUV),drama.wipe(this.characterWidthList);else this.lines=[],this.clipList={},this.clipUV={},this.characterWidthList={};if(this.text_changed=!0,this.lastwrapwidth=this.width,this.runtime.glwrap){if(!this.type.webGL_texture)if(!this.type.texture_img)this.runtime.sectionAlert(this.type.name);else this.type.webGL_texture=this.runtime.glwrap.loadTexture(this.type.texture_img,!1,this.runtime.linearSampling,this.type.texture_pixelformat);this.webGL_texture=this.type.webGL_texture}this.LoadCharacterSpacingData(t),this.SplitSheet()},i.saveToJSON=function(){var t={t:this.text,csc:this.characterScale,csp:this.characterSpacing,lh:this.lineHeight,tw:this.textWidth,th:this.textHeight,lrt:this.last_render_tick,ha:this.halign,va:this.valign,cw:{}};for(var e in this.characterWidthList)t.cw[e]=this.characterWidthList[e];return t},i.loadFromJSON=function(t){if(this.text=t.t,this.characterScale=t.csc,this.characterSpacing=t.csp,this.lineHeight=t.lh,this.textWidth=t.tw,this.textHeight=t.th,this.last_render_tick=t.lrt,t.hasOwnProperty("ha"))this.halign=t.ha;if(t.hasOwnProperty("va"))this.valign=t.va;for(var e in t.cw)this.characterWidthList[e]=t.cw[e];this.text_changed=!0,this.lastwrapwidth=this.width};var n=1e3;function s(t,e){if(t.length)return t.pop();else return new e}function p(t,e){if(t.length<n)t.push(e)}function r(t,e,i){if(i){var n,r;for(n=0,r=e.length;n<r;n++)p(t,e[n]);drama.clearArray(e)}else{var o;for(o in e)if(Object.prototype.hasOwnProperty.call(e,o))p(t,e[o]),delete e[o]}}function f(t,e,i){var n,r=t.lines;if(i=d(i),e>=r.length)r.push(l());(n=r[e]).text=i,n.width=t.measureWidth(i),t.textWidth=drama.max(t.textWidth,n.width)}var m=[];function l(){return s(m,Object)}function c(t){r(m,t,!0)}function b(t,e,i,n,r,o){if(void 0===t[e])t[e]=s(a,Object);t[e].x=i,t[e].y=n,t[e].w=r,t[e].h=o}var a=[];function _(t,e,i,n,r,o){if(void 0===t[e])t[e]=s(u,drama.rect);t[e].left=i,t[e].top=n,t[e].right=r,t[e].bottom=o}var u=[];i.SplitSheet=function(){var t=this.texture_img.width,e=this.texture_img.height,i=this.type.spriteWidth,n=this.type.spriteHeight,r=this.type.spriteX,o=this.type.spriteY,s=this.characterWidth,a=this.characterHeight,l=r/t,c=o/e,u=s/t,h=a/e,d=this.characterSet,p=Math.floor(i/s),f=Math.floor(n/a);p=p<=0?1:p,f=f<=0?1:f;for(var m=0;m<d.length&&!(p*f<=m);m++){var g=m%p,y=Math.floor(m/p),v=d.charAt(m);if(this.runtime.glwrap)_(this.clipUV,v,g*u+l,y*h+c,(g+1)*u+l,(y+1)*h+c);else b(this.clipList,v,g*s+r,y*a+o,s,a)}};var g=[];t.TokeniseWords=function(t){drama.clearArray(g);for(var e,i="",n=0;n<t.length;)if("\n"===(e=t.charAt(n))){if(i.length)g.push(i),i="";g.push("\n"),++n}else if(" "===e||"\t"===e||"-"===e){for(;i+=t.charAt(n),++n<t.length&&(" "===t.charAt(n)||"\t"===t.charAt(n)););g.push(i),i=""}else if(n<t.length)i+=e,n++;if(i.length)g.push(i)},t.WordWrap=function(t){var e=t.text,i=t.lines;if(e&&e.length){var n=t.width;if(!(n<=2)){var r=t.characterWidth,o=t.characterScale,s=t.characterSpacing;if(e.length*(r*o+s)-s<=n&&-1===e.indexOf("\n")){var a=t.measureWidth(e);if(a<=n)return c(i),i.push(l()),i[0].text=e,i[0].width=a,t.textWidth=a,void(t.textHeight=t.characterHeight*o+t.lineHeight)}this.WrapText(t),t.textHeight=i.length*(t.characterHeight*o+t.lineHeight)}else c(i)}else c(i)},t.WrapText=function(t){var e,i=t.wrapbyword,n=t.text,r=t.lines,o=t.width;if(i)this.TokeniseWords(n),e=g;else e=n;var s,a,l,c="",u=0,h=!1;for(a=0;a<e.length;a++)if("\n"!==e[a]){if(h=!1,s=c,c+=e[a],o<t.measureWidth(d(c))){if(""===s)f(t,u,c),h=!(c="");else f(t,u,s),c=e[a];if(u++,!i&&" "===c)c=""}}else{if(!0===h)h=!1;else f(t,u,c),u++;c=""}if(d(c).length)f(t,u,c),u++;for(a=u;a<r.length;a++)l=r[a],p(m,l);r.length=u},i.measureWidth=function(t){for(var e=this.characterSpacing,i=t.length,n=0,r=0;r<i;r++)n+=this.getCharacterWidth(t.charAt(r))*this.characterScale+e;return n-=0<n?e:0},i.getCharacterWidth=function(t){var e=this.characterWidthList;if(void 0!==e[t])return e[t];else return this.characterWidth},i.rebuildText=function(){if(this.text_changed||this.width!==this.lastwrapwidth)this.textWidth=0,this.textHeight=0,this.type.plugin.WordWrap(this),this.text_changed=!1,this.lastwrapwidth=this.width};i.draw=function(t,e){var i=this.texture_img;if(""!==this.text&&null!=i){if(this.rebuildText(),this.height<this.characterHeight*this.characterScale+this.lineHeight)return;t.globalAlpha=this.opacity;var n=this.x,r=this.y;if(this.runtime.pixel_rounding)n=Math.round(n),r=Math.round(r);var o=this.layer.viewLeft,s=this.layer.viewTop,a=this.layer.viewRight,l=this.layer.viewBottom;t.save(),t.translate(n,r),t.rotate(this.angle);for(var c,u,h,d,p=this.angle,f=this.halign,m=this.valign,g=this.characterScale,y=this.characterHeight*g,v=this.lineHeight,b=this.characterSpacing,_=this.lines,w=this.textHeight,x=m*drama.max(0,this.height-w),S=-this.hotspotX*this.width,I=-this.hotspotY*this.height,T=I+=x,C=0;C<_.length;C++){var O=_[C].text,P=_[C].width;if(u=S+f*drama.max(0,this.width-P),T+=v,!(0===p&&r+T+y<s)){for(var E=0;E<O.length;E++){var A=O.charAt(E);c=this.getCharacterWidth(A);var k=this.clipList[A];if(!(0===p&&n+u+c*g+b<o)){if(u+c*g>this.width+1e-5)break;if(void 0!==k){if(h=u,d=T,0===p&&1===g)h=Math.round(h),d=Math.round(d);t.drawImage(this.texture_img,k.x,k.y,k.w,k.h,h,d,k.w*g,k.h*g)}if(u+=c*g+b,0===p&&a<n+u)break}else u+=c*g+b}if(T+=y,0===p&&(T+y+v>this.height||l<r+T))break}else T+=y}t.restore()}};var j=new drama.quad;function o(){}function h(){}function y(){}i.drawGL=function(t){if(t.setTexture(this.webGL_texture),t.setOpacity(this.opacity),this.text)if(this.rebuildText(),!(this.height<this.characterHeight*this.characterScale+this.lineHeight)){this.update_bbox();var e=this.bquad,i=0,n=0;if(this.runtime.pixel_rounding)i=Math.round(this.x)-this.x,n=Math.round(this.y)-this.y;var r,o,s,a=this.layer.viewLeft,l=this.layer.viewTop,c=this.layer.viewRight,u=this.layer.viewBottom,h=this.angle,d=this.halign,p=this.valign,f=this.characterScale,m=this.characterHeight*f,g=this.lineHeight,y=this.characterSpacing,v=this.lines,b=this.textHeight;if(0!==h)o=Math.cos(h),s=Math.sin(h);for(var _,w,x,S,I,T,C,O=p*drama.max(0,this.height-b),P=e.tlx+i,E=e.tly+n,A=O,k=0;k<v.length;k++){var M=v[k].text,R=v[k].width;if(_=d*drama.max(0,this.width-R),A+=g,!(0===h&&E+A+m<l)){for(var L=0;L<M.length;L++){var D=M.charAt(L);r=this.getCharacterWidth(D);var N=this.clipUV[D];if(!(0===h&&P+_+r*f+y<a)){if(_+r*f>this.width+1e-5)break;if(void 0!==N){var B=this.characterWidth*f,F=this.characterHeight*f;if(w=_,x=A,0===h&&1===f)w=Math.round(w),x=Math.round(x);if(j.tlx=w,j.tly=x,j.trx=w+B,j.try_=x,j.blx=w,j.bly=x+F,j.brx=w+B,j.bry=x+F,0!==h)I=o,T=s,C=void 0,C=(S=j).tlx*I-S.tly*T,S.tly=S.tly*I+S.tlx*T,S.tlx=C,C=S.trx*I-S.try_*T,S.try_=S.try_*I+S.trx*T,S.trx=C,C=S.blx*I-S.bly*T,S.bly=S.bly*I+S.blx*T,S.blx=C,C=S.brx*I-S.bry*T,S.bry=S.bry*I+S.brx*T,S.brx=C;if(Math.max(j.bly,j.bry)>this.height)return;j.offset(P,E),t.quadTex(j.tlx,j.tly,j.trx,j.try_,j.brx,j.bry,j.blx,j.bly,N)}if(_+=r*f+y,0===h&&c<P+_)break}else _+=r*f+y}if(A+=m,0===h&&(A+m+g>this.height||u<E+A))break}else A+=m}}},i.getDebuggerValues=function(t){t.push({title:"Sprite font",properties:[{name:"Text",value:this.text},{name:"Character width",value:this.characterWidth},{name:"Character height",value:this.characterHeight},{name:"Character scale",value:this.characterScale},{name:"Character spacing",value:this.characterSpacing},{name:"Line height",value:this.lineHeight}]})},i.onDebugValueEdited=function(t,e,i){switch(e){case"Text":this.text=i;break;case"Character width":this.characterWidth=i;break;case"Character height":this.characterHeight=i;break;case"Character scale":this.characterScale=i;break;case"Character spacing":this.characterSpacing=i;break;case"Line height":this.lineHeight=i}this.text_changed=!0},o.prototype.CompareText=function(t,e){if(e)return this.text==t;else return drama.equals_nocase(this.text,t)},o.prototype.ContainText=function(t){if(t=t||"",-1<this.text.indexOf(t)&&""!=t)return!0;else return!1},t.cnds=new o,h.prototype.SetFontStyle=function(t,e,i,n,r,o){if(this.halign=r/2,this.valign=o/2,1===t&&e!==this.lineHeight)this.lineHeight=e;if(1===i&&n!==this.characterScale)this.characterScale=n;this.text_changed=!0,this.runtime.redraw=!0},h.prototype.SetText=function(t){if(drama.is_number(t)&&t<1e9)t=Math.round(1e10*t)/1e10;var e=t.toString();if(this.text!==e)this.text=e,this.text_changed=!0,this.runtime.redraw=!0},h.prototype.AppendText=function(t){if(drama.is_number(t))t=Math.round(1e10*t)/1e10;var e=t.toString();if(e)this.text+=e,this.text_changed=!0,this.runtime.redraw=!0},h.prototype.SetScale=function(t){if(t!==this.characterScale)this.characterScale=t,this.text_changed=!0,this.runtime.redraw=!0},h.prototype.SetCharacterSpacing=function(t){if(t!==this.CharacterSpacing)this.characterSpacing=t,this.text_changed=!0,this.runtime.redraw=!0},h.prototype.SetLineHeight=function(t){if(t!==this.lineHeight)this.lineHeight=t,this.text_changed=!0,this.runtime.redraw=!0},i.SetCharWidth=function(t,e){var i=parseInt(e,10);if(this.characterWidthList[t]!==i)this.characterWidthList[t]=i,this.text_changed=!0,this.runtime.redraw=!0},i.LoadCharacterSpacingData=function(t){var e,i,n,r,o,s,a,l;if(t){try{e=JSON.parse(t)}catch(t){return}if(Array.isArray(e))for(i=0,n=e.length;i<n;++i)if(r=e[i],Array.isArray(r)&&2===r.length&&"number"==typeof r[0]&&"string"==typeof r[1])for(o=r[0],a=0,l=(s=r[1]).length;a<l;++a)this.SetCharWidth(s.charAt(a),o)}},h.prototype.SetCharacterWidth=function(t,e){if(""!==t)for(var i=0;i<t.length;i++)this.SetCharWidth(t.charAt(i),e)},h.prototype.SetEffect=function(t){this.blend_mode=t,this.compositeOp=drama.effectToCompositeOp(t),drama.setGLBlend(this,t,this.runtime.gl),this.runtime.redraw=!0},h.prototype.SetHAlign=function(t){this.halign=t/2,this.text_changed=!0,this.runtime.redraw=!0},h.prototype.SetVAlign=function(t){this.valign=t/2,this.text_changed=!0,this.runtime.redraw=!0},t.acts=new h,y.prototype.CharacterWidth=function(t,e){t.set_int(this.getCharacterWidth(e))},y.prototype.CharacterHeight=function(t){t.set_int(this.characterHeight)},y.prototype.CharacterScale=function(t){t.set_float(this.characterScale)},y.prototype.CharacterSpacing=function(t){t.set_int(this.characterSpacing)},y.prototype.LineHeight=function(t){t.set_int(this.lineHeight)},y.prototype.Text=function(t){t.set_string(this.text)},y.prototype.TextWidth=function(t){this.rebuildText(),t.set_float(this.textWidth)},y.prototype.TextHeight=function(t){this.rebuildText(),t.set_float(this.textHeight)},t.exps=new y}(),assert2(drama,"drama namespace not created"),assert2(drama.plugins_,"drama.plugins_ not created"),drama.plugins_.Stride=function(t){this.runtime=t},function(){var t=drama.plugins_.Stride.prototype;t.Type=function(t){this.plugin=t,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){};var i=null,n=null,r=null,e="",o="",s="",a=60,l=0,c=1,u="",h="",d=0,p="",f=function(t){if(null==(e=t))e="";i.trigger(drama.plugins_.Stride.prototype.cnds.strOnGetGameData,n)},m=function(){i.trigger(drama.plugins_.Stride.prototype.cnds.strOnTimerDone,n)};t.Instance=function(t){this.type=t,this.runtime=t.runtime};var g=t.Instance.prototype;function y(){}function v(){}function b(){}g.onCreate=function(){i=this.runtime,n=this;var t=(r={parentFunc:function(t){return window.parent&&window.parent!=window?window.parent.stridegame[t]:function(){}}}).parentFunc("start")();if(t){if(null==(o=t.playerData))o="";if(a=t.sessionTime,l=t.highScore,t.enableSound)c=1;else c=0;if(u=t.playerName,h=t.gender,d=t.gradeLevel,p=t.ethnicity,null!=t.badges){for(var e=0;e<t.badges.length;e++)s=s+t.badges[e].name+",";s=s.substr(0,s.length-1)}}},g.draw=function(t){},g.drawGL=function(t){},y.prototype.strOnGetGameData=function(){return!0},y.prototype.strOnTimerDone=function(){return!0},y.prototype.strIsSoundEnabled=function(){if(c)return!0;else return!1},t.cnds=new y,v.prototype.strExit=function(){r.parentFunc("exit")()},v.prototype.strSubmitGameScore=function(t,e){r.parentFunc("submitGameScore")(t,e)},v.prototype.strSetGameData=function(t,e){r.parentFunc("setGameData")(t,e)},v.prototype.strGetGameData=function(t){r.parentFunc("getGameData")(t,f)},v.prototype.strStartTimer=function(t){if(t)r.parentFunc("startTimer")(m,!0);else r.parentFunc("startTimer")(m,!1)},v.prototype.strStopTimer=function(){r.parentFunc("stopTimer")()},v.prototype.strAwardBadge=function(t){r.parentFunc("awardBadge")(t)},t.acts=new v,b.prototype.sessionSeconds=function(t){t.set_int(a)},b.prototype.highScore=function(t){t.set_int(l)},b.prototype.defaultGameData=function(t){t.set_string(o)},b.prototype.gameData=function(t){t.set_string(e)},b.prototype.badgeList=function(t){t.set_string(s)},b.prototype.enableSound=function(t){t.set_int(c)},b.prototype.playerName=function(t){t.set_string(u)},b.prototype.gender=function(t){t.set_string(h)},b.prototype.gradeLevel=function(t){t.set_int(d)},b.prototype.ethnicity=function(t){t.set_string(p)},t.exps=new b}(),assert2(drama,"drama namespace not created"),assert2(drama.plugins_,"drama.plugins_ not created"),drama.plugins_.wastrel_switchcase=function(t){this.runtime=t},function(){var t=drama.plugins_.wastrel_switchcase.prototype;t.Type=function(t){this.plugin=t,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t){this.type=t,this.runtime=t.runtime};var e=t.Instance.prototype;e.onCreate=function(){this.switchVariable=null,this.caseBreak=!1},e.draw=function(t){},t.cnds={};var i=t.cnds;i.Switch=function(t){return this.switchVariable=t,!(this.caseBreak=!1)},i.Case=function(t){if(!this.caseBreak)if(this.switchVariable==t)return!0;else return!1;else return!1},i.CaseRange=function(t,e){if(!this.caseBreak)if(this.switchVariable>=t&&this.switchVariable<=e)return!0;else return!1;else return!1},i.CaseContains=function(t){if(!this.caseBreak)if(-1!=this.switchVariable.toString().indexOf(t))return!0;else return!1;else return!1},i.CaseList=function(t){if(!this.caseBreak){var e,i=0;for(i in e=t.split(","))if(this.switchVariable==e[i])return!0;return!1}else return!1},i.CaseCompare=function(t,e){if(!this.caseBreak)switch(t){case 0:if(this.switchVariable==e)return!0;else return!1;case 1:if(this.switchVariable!=e)return!0;else return!1;case 2:if(this.switchVariable<e)return!0;else return!1;case 3:if(this.switchVariable<=e)return!0;else return!1;case 4:if(this.switchVariable>e)return!0;else return!1;case 5:if(this.switchVariable>=e)return!0;else return!1}else return!1},i.Default=function(){if(!this.caseBreak)return!0;else return!1},t.acts={},t.acts.CaseBreak=function(t){this.caseBreak=!0}}(),assert2(drama,"drama namespace not created"),drama.system_object=function(t){this.runtime=t,this.waits=[]},drama.system_object.prototype.saveToJSON=function(){var t,e,i,n,r,o,s,a,l={};l.waits=[];var c,u=l.waits;for(t=0,e=this.waits.length;t<e;t++){if(c={t:(o=this.waits[t]).time,st:o.signaltag,s:o.signalled,ev:o.ev.sid,sm:[],sols:{}},o.ev.actions[o.actindex])c.act=o.ev.actions[o.actindex].sid;for(i=0,n=o.solModifiers.length;i<n;i++)c.sm.push(o.solModifiers[i].sid);for(r in o.sols)if(o.sols.hasOwnProperty(r)){for(assert2(s=this.runtime.types_by_index[parseInt(r,10)],"Missing type by index saving wait records"),a={sa:o.sols[r].sa,insts:[]},i=0,n=o.sols[r].insts.length;i<n;i++)a.insts.push(o.sols[r].insts[i].uid);c.sols[s.sid.toString()]=a}u.push(c)}return l},drama.system_object.prototype.loadFromJSON=function(t){var e,i,n,r,o,s,a,l,c,u,h,d,p,f=t.waits;for(drama.clearArray(this.waits),e=0,i=f.length;e<i;e++)if(s=f[e],l=this.runtime.blocksBySid[s.ev.toString()]){for(c=-1,n=0,r=l.actions.length;n<r;n++)if(l.actions[n].sid===s.act){c=n;break}if(-1!==c){for((a={sols:{},solModifiers:[],deleteme:!1}).time=s.t,a.signaltag=s.st||"",a.signalled=!!s.s,a.ev=l,a.actindex=c,n=0,r=s.sm.length;n<r;n++)if(u=this.runtime.getObjectTypeBySid(s.sm[n]))a.solModifiers.push(u);for(o in s.sols)if(s.sols.hasOwnProperty(o)){if(!(u=this.runtime.getObjectTypeBySid(parseInt(o,10))))continue;for(d={sa:(h=s.sols[o]).sa,insts:[]},n=0,r=h.insts.length;n<r;n++)if(p=this.runtime.getObjectByUID(h.insts[n]))d.insts.push(p);a.sols[u.index.toString()]=d}this.waits.push(a)}}},drama.system_object.prototype.getDebuggerValues=function(t){var e,i,n=this.runtime,r=n.running_layout;t.push({title:["system.performance.title"],properties:[{name:["system.performance.fps"],value:["system.performance.fps-value",n.fps,Math.round(1e4/n.fps)/10],readonly:!0},{name:["system.performance.cpu"],value:Math.round(n.cpuutilisation)/10+"%",readonly:!0},{name:["system.performance.image-mem"],value:n.glwrap?["system.performance.image-mem-value",Math.round(10*n.glwrap.estimateVRAM()/1048576)/10]:["system.performance.image-mem-unavailable"],readonly:!0},{name:["system.performance.renderer"],value:n.glwrap?"webgl":"canvas2d",readonly:!0},{name:["system.performance.object-count"],value:n.objectcount,readonly:!0},{name:["system.performance.collision-checks"],value:["system.performance.value-per-tick",n.collisioncheck_sec,Math.round(n.collisioncheck_sec/n.fps)],readonly:!0},{name:["system.performance.poly-checks"],value:["system.performance.value-per-tick",n.polycheck_sec,Math.round(n.polycheck_sec/n.fps)],readonly:!0},{name:["system.performance.moved-cell"],value:["system.performance.value-per-tick",n.movedcell_sec,Math.round(n.movedcell_sec/n.fps)],readonly:!0},{name:["system.performance.cell-count"],value:""+drama.SparseGrid.prototype.totalCellCount,readonly:!0},{name:["system.performance.moved-render-cell"],value:["system.performance.value-per-tick",n.movedrendercell_sec,Math.round(n.movedrendercell_sec/n.fps)],readonly:!0},{name:["system.performance.render-cell-count"],value:""+drama.RenderGrid.prototype.totalCellCount,readonly:!0}]}),t.push({title:["system.system.title"],properties:[{name:["system.system.canvas-size"],value:"("+n.width+","+n.height+")",readonly:!0},{name:["system.system.time-scale"],value:n.timescale},{name:["system.system.time"],value:n.kahanTime.sum,readonly:!0},{name:["system.system.wallclock-time"],value:(Date.now()-this.runtime.start_time)/1e3,readonly:!0},{name:["system.system.tick-count"],value:n.tickcount,readonly:!0}]});var o,s,a=[],l=[];for(drama.shallowAssignArray(l,n.all_global_vars),e=0,i=l.length;e<i;++e)s=l[e],a.push({name:s.name,value:s.data});if(a.length)t.push({title:["system.global-variables"],properties:a});a=[];var c=[];for(drama.shallowAssignArray(c,n.all_local_vars),e=0,i=c.length;e<i;++e)if((s=c[e]).is_static)a.push({name:s.name,value:s.data});if(a.length)t.push({title:["system.static-local-variables"],properties:a});for(t.push({title:["system.layout.title"],properties:[{name:["system.layout.name"],value:r.name,readonly:!0},{name:["system.layout.width"],value:r.width},{name:["system.layout.height"],value:r.height},{name:["system.layout.event-sheet"],value:r.event_sheet?r.event_sheet.name:"(none)",readonly:!0},{name:["system.layout.scroll-x"],value:r.scrollX},{name:["system.layout.scroll-y"],value:r.scrollY},{name:["system.layout.scale"],value:r.scale},{name:["system.layout.angle"],value:drama.to_degrees(r.angle)}]}),e=0,i=r.layers.length;e<i;++e)o=r.layers[e],(a=[]).push({name:["system.layer.index"],value:o.index,readonly:!0}),a.push({name:["system.layer.scale"],value:o.scale}),a.push({name:["system.layer.angle"],value:drama.to_degrees(o.angle)}),a.push({name:["system.layer.viewport-left"],value:o.viewLeft,readonly:!0}),a.push({name:["system.layer.viewport-top"],value:o.viewTop,readonly:!0}),a.push({name:["system.layer.viewport-right"],value:o.viewRight,readonly:!0}),a.push({name:["system.layer.viewport-bottom"],value:o.viewBottom,readonly:!0}),a.push({name:["system.layer.visible"],value:o.visible}),a.push({name:["system.layer.transparent"],value:o.transparent}),a.push({name:["system.layer.parallax-x"],value:100*o.parallaxX}),a.push({name:["system.layer.parallax-y"],value:100*o.parallaxY}),a.push({name:["system.layer.opacity"],value:100*o.opacity}),a.push({name:["system.layer.force-own-texture"],value:o.forceOwnTexture}),a.push({name:["system.layer.zoom-rate"],value:o.zoomRate}),t.push({title:["system.layer.title",o.name],properties:a})},drama.system_object.prototype.onDebugValueEdited=function(t,e,i){var n,r,o,s=this.runtime,a=s.running_layout;if("system.system.title"===t){if("system.system.time-scale"===e)s.timescale=i}else if("system.global-variables"===t){for(n=0,r=s.all_global_vars.length;n<r;++n)if((o=s.all_global_vars[n]).name===e)return void(o.data=i)}else if("system.static-local-variables"===t){for(n=0,r=s.all_local_vars.length;n<r;++n)if((o=s.all_local_vars[n]).name===e)return void(o.data=i)}else if("system.layout.title"===t)switch(e){case"system.layout.width":a.width=i;break;case"system.layout.height":a.height=i;break;case"system.layout.scroll-x":a.scrollToX(i);break;case"system.layout.scroll-y":a.scrollToY(i);break;case"system.layout.scale":a.scale=i;break;case"system.layout.angle":a.angle=drama.to_radians(i)}else{var l=t.split(",")[1],c=null;for(n=0,r=a.layers.length;n<r;++n)if(a.layers[n].name===l){c=a.layers[n];break}if(c)switch(e){case"system.layer.scale":c.scale=i;break;case"system.layer.angle":c.angle=drama.to_radians(i);break;case"system.layer.visible":c.visible=i;break;case"system.layer.transparent":c.transparent=i;break;case"system.layer.parallax-x":c.parallaxX=i/100;break;case"system.layer.parallax-y":c.parallaxY=i/100;break;case"system.layer.opacity":c.opacity=i/100;break;case"system.layer.force-own-texture":c.forceOwnTexture=i;break;case"system.layer.zoom-rate":c.zoomRate=i}}},drama.system_object.prototype.loadingLayOut=function(t){this.runtime.createLoadingCanvas(),this.runtime.overlay_canvas.style.marginTop=this.runtime.canvas.style.marginTop,this.runtime.overlay_canvas.style.marginLeft=this.runtime.canvas.style.marginLeft,this.runtime.canvas.style.display="none",this.runtime.useloaderLayoutGo(t)},function(){var t=drama.system_object.prototype;function e(){}e.prototype.EveryTick=function(){return!0},e.prototype.OnLayoutChange=function(t){if(0==t&&this.runtime.isOnLayoutStart)return!0;else if(1==t&&this.runtime.isOnLayoutEnd)return!0;return!1},e.prototype.OnLayoutStart=function(){return!0},e.prototype.OnLayoutEnd=function(){return!0},e.prototype.Compare=function(t,e,i){return drama.do_cmp(t,e,i)},e.prototype.CompareTime=function(t,e){var i=this.runtime.kahanTime.sum;if(0!==t)return drama.do_cmp(i,t,e);var n=this.runtime.getCurrentCondition();if(!n.extra.CompareTime_executed)if(e<=i)return n.extra.CompareTime_executed=!0;return!1},e.prototype.LayerVisible=function(t){if(!t)return!1;else return t.visible},e.prototype.LayerEmpty=function(t){if(!t)return!1;else return!t.instances.length},e.prototype.LayerCmpOpacity=function(t,e,i){if(!t)return!1;else return drama.do_cmp(100*t.opacity,e,i)},e.prototype.Repeat=function(t){var e,i=this.runtime.getCurrentEventStack(),n=i.current_event,r=i.isModifierAfterCnds(),o=this.runtime.pushLoopStack();if(r)for(e=0;e<t&&!o.stopped;e++){if(this.runtime.pushCopySol(n.solModifiers),o.index=e,n.retrigger(),this.runtime.hit_breakpoint)return;this.runtime.popSol(n.solModifiers)}else for(e=0;e<t&&!o.stopped;e++)if(o.index=e,n.retrigger(),this.runtime.hit_breakpoint)return;return this.runtime.popLoopStack(),!1},e.prototype.While=function(t){var e,i=this.runtime.getCurrentEventStack(),n=i.current_event,r=i.isModifierAfterCnds(),o=this.runtime.pushLoopStack();if(r)for(e=0;!o.stopped;e++){if(this.runtime.pushCopySol(n.solModifiers),o.index=e,!n.retrigger())o.stopped=!0;this.runtime.popSol(n.solModifiers)}else for(e=0;!o.stopped;e++)if(o.index=e,!n.retrigger())o.stopped=!0;return this.runtime.popLoopStack(),!1},e.prototype.For=function(t,e,i){var n,r=this.runtime.getCurrentEventStack(),o=r.current_event,s=r.isModifierAfterCnds(),a=this.runtime.pushLoopStack(t);if(i<e)if(s)for(n=e;i<=n&&!a.stopped;--n)this.runtime.pushCopySol(o.solModifiers),a.index=n,o.retrigger(),this.runtime.popSol(o.solModifiers);else for(n=e;i<=n&&!a.stopped;--n)a.index=n,o.retrigger();else if(s)for(n=e;n<=i&&!a.stopped;++n)this.runtime.pushCopySol(o.solModifiers),a.index=n,o.retrigger(),this.runtime.popSol(o.solModifiers);else for(n=e;n<=i&&!a.stopped;++n)a.index=n,o.retrigger();return this.runtime.popLoopStack(),!1};var v=[],b=-1;function _(t,e){var i=t.extra.c2_feo_val,n=e.extra.c2_feo_val;if(drama.is_number(i)&&drama.is_number(n))return i-n;else if((i=""+i)<(n=""+n))return-1;else if(n<i)return 1;else return 0}e.prototype.ForEach=function(t){var e=t.getCurrentSol();if(b++,v.length===b)v.push([]);var i=v[b];drama.shallowAssignArray(i,e.getObjects());var n,r,o,s,a,l,c,u=this.runtime.getCurrentEventStack(),h=u.current_event,d=u.isModifierAfterCnds(),p=this.runtime.pushLoopStack(),f=t.is_contained;if(d)for(n=0,r=i.length;n<r&&!p.stopped;n++){if(this.runtime.pushCopySol(h.solModifiers),a=i[n],(e=t.getCurrentSol()).select_all=!1,drama.clearArray(e.instances),e.instances[0]=a,f)for(o=0,s=a.siblings.length;o<s;o++)(c=(l=a.siblings[o]).type.getCurrentSol()).select_all=!1,drama.clearArray(c.instances),c.instances[0]=l;p.index=n,h.retrigger(),this.runtime.popSol(h.solModifiers)}else for(e.select_all=!1,drama.clearArray(e.instances),n=0,r=i.length;n<r&&!p.stopped;n++){if(a=i[n],e.instances[0]=a,f)for(o=0,s=a.siblings.length;o<s;o++)(c=(l=a.siblings[o]).type.getCurrentSol()).select_all=!1,drama.clearArray(c.instances),c.instances[0]=l;p.index=n,h.retrigger()}return drama.clearArray(i),this.runtime.popLoopStack(),b--,!1},e.prototype.ForEachOrdered=function(t,e,i){var n=t.getCurrentSol();if(b++,v.length===b)v.push([]);var r=v[b];drama.shallowAssignArray(r,n.getObjects());var o,s,a,l,c,u,h,d=this.runtime.getCurrentEventStack(),p=d.current_event,f=this.runtime.getCurrentCondition(),m=d.isModifierAfterCnds(),g=this.runtime.pushLoopStack();for(o=0,s=r.length;o<s;o++)r[o].extra.c2_feo_val=f.parameters[1].get(o);if(r.sort(_),1===i)r.reverse();var y=t.is_contained;if(m)for(o=0,s=r.length;o<s&&!g.stopped;o++){if(this.runtime.pushCopySol(p.solModifiers),c=r[o],(n=t.getCurrentSol()).select_all=!1,drama.clearArray(n.instances),n.instances[0]=c,y)for(a=0,l=c.siblings.length;a<l;a++)(h=(u=c.siblings[a]).type.getCurrentSol()).select_all=!1,drama.clearArray(h.instances),h.instances[0]=u;g.index=o,p.retrigger(),this.runtime.popSol(p.solModifiers)}else for(n.select_all=!1,drama.clearArray(n.instances),o=0,s=r.length;o<s&&!g.stopped;o++){if(c=r[o],n.instances[0]=c,y)for(a=0,l=c.siblings.length;a<l;a++)(h=(u=c.siblings[a]).type.getCurrentSol()).select_all=!1,drama.clearArray(h.instances),h.instances[0]=u;g.index=o,p.retrigger()}return drama.clearArray(r),this.runtime.popLoopStack(),b--,!1},e.prototype.PickByComparison=function(t,e,i,n){var r,o,s,a;if(t){if(b++,v.length===b)v.push([]);var l=v[b],c=t.getCurrentSol();if(drama.shallowAssignArray(l,c.getObjects()),c.select_all)drama.clearArray(c.else_instances);var u=this.runtime.getCurrentCondition();for(s=r=0,o=l.length;r<o;r++)if(a=l[r],l[s]=a,e=u.parameters[1].get(r),n=u.parameters[3].get(r),drama.do_cmp(e,i,n))s++;else c.else_instances.push(a);return drama.truncateArray(l,s),c.select_all=!1,drama.shallowAssignArray(c.instances,l),drama.clearArray(l),b--,t.applySolToContainer(),!!c.instances.length}},e.prototype.PickByEvaluate=function(t,e){var i,n,r,o;if(t){if(b++,v.length===b)v.push([]);var s=v[b],a=t.getCurrentSol();if(drama.shallowAssignArray(s,a.getObjects()),a.select_all)drama.clearArray(a.else_instances);var l=this.runtime.getCurrentCondition();for(r=i=0,n=s.length;i<n;i++)if(o=s[i],s[r]=o,l.parameters[1].get(i))r++;else a.else_instances.push(o);return drama.truncateArray(s,r),a.select_all=!1,drama.shallowAssignArray(a.instances,s),drama.clearArray(s),b--,t.applySolToContainer(),!!a.instances.length}},e.prototype.TriggerOnce=function(){var t=this.runtime.getCurrentCondition().extra;if(void 0===t.TriggerOnce_lastTick)t.TriggerOnce_lastTick=-1;var e=t.TriggerOnce_lastTick,i=this.runtime.tickcount;return t.TriggerOnce_lastTick=i,this.runtime.layout_first_tick||e!==i-1},e.prototype.Every=function(t){var e=this.runtime.getCurrentCondition(),i=e.extra.Every_lastTime||0,n=this.runtime.kahanTime.sum;if(void 0===e.extra.Every_seconds)e.extra.Every_seconds=t;var r=e.extra.Every_seconds;if(i+r<=n){if(e.extra.Every_lastTime=i+r,n>=e.extra.Every_lastTime+.04)e.extra.Every_lastTime=n;return e.extra.Every_seconds=t,!0}else if(n<i-.1)e.extra.Every_lastTime=n;return!1},e.prototype.PickNth=function(t,e){if(!t)return!1;var i=t.getCurrentSol(),n=i.getObjects();if((e=drama.floor(e))<0||e>=n.length)return!1;var r=n[e];return i.pick_one(r),t.applySolToContainer(),!0},e.prototype.PickRandom=function(t){if(!t)return!1;var e=t.getCurrentSol(),i=e.getObjects(),n=drama.floor(Math.random()*i.length);if(n>=i.length)return!1;var r=i[n];return e.pick_one(r),t.applySolToContainer(),!0},e.prototype.CustomInstanceVarChange=function(t,e){if(void 0===e)return!1;else return this.varSid===e.sid},e.prototype.CompareCustomInstanceVar=function(t,e,i,n,r,o){if(2==t)return e.getValue()===(1===o?!0:!1);else if(1==t)return drama.do_cmp(e.getValue(),i,r);else return drama.do_cmp(e.getValue(),i,n)},e.prototype.CompareVar=function(t,e,i){return drama.do_cmp(t.getValue(),e,i)},e.prototype.CompareBoolVar=function(t){return t.getValue()},e.prototype.IsGroupActive=function(t){var e=this.runtime.groups_by_name[t.toLowerCase()];return e&&e.group_active},e.prototype.IsPreview=function(){return this.runtime.isPreview},e.prototype.PickAll=function(t){if(!t)return!1;if(!t.instances.length)return!1;else return t.getCurrentSol().select_all=!0,t.applySolToContainer(),!0},e.prototype.IsMobile=function(){return this.runtime.isMobile},e.prototype.CompareBetween=function(t,e,i){return e<=t&&t<=i},e.prototype.Else=function(){var t=this.runtime.getCurrentEventStack();if(t.else_branch_ran)return!1;else return!t.last_event_true},e.prototype.OnLoadFinished=function(){return!0},e.prototype.OnCanvasSnapshot=function(){return!0},e.prototype.EffectsSupported=function(){return!!this.runtime.glwrap},e.prototype.OnSystemSaveComplete=function(t,e){if(0==t&&this.runtime.isSaveSuccess)return!0;else if(1==t&&this.runtime.isSaveFail)return!1;return!1},e.prototype.OnSaveComplete=function(){return!0},e.prototype.OnSaveFailed=function(){return!0},e.prototype.OnMultiplePlatform=function(t,e,i){var n={0:this.runtime.isAndroid&&this.runtime.isCordova,1:this.runtime.isiOS&&this.runtime.isCordova,2:this.runtime.isWeixin,3:this.runtime.isByte,4:this.runtime.isBrowser&&this.runtime.isMobile},r={0:this.runtime.isWindows&&!1===this.runtime.isBrowser&&!1===this.runtime.isMobile,1:this.runtime.isOSX&&!1===this.runtime.isMobile,2:this.runtime.isBrowser&&!1===this.runtime.isMobile&&this.runtime.isWindows};switch(t){case 0:return n[e];case 1:return r[i]}return!1},e.prototype.OnSystemLoadComplete=function(t,e){if(0==t&&this.runtime.isLoadSuccess)return!0;else if(1==t&&this.runtime.isLoadFail)return!0;return!1},e.prototype.OnLoadComplete=function(){return!0},e.prototype.OnLoadFailed=function(){return!0},e.prototype.OnChangeSuspend=function(t){if(0==t&&this.runtime.isOnSuspend)return!0;else if(1==t&&this.runtime.isOnResume)return!0;return!1},e.prototype.OnSuspend=function(){return!0},e.prototype.OnResume=function(){return!0},e.prototype.ObjectUIDExists=function(t){return!!this.runtime.getObjectByUID(t)},e.prototype.IsOnPlatform=function(t){var e=this.runtime;switch(t){case 0:return!(e.isNodeWebkit||e.isCordova||e.isWinJS||e.isWindowsPhone8||e.isBlackberry10||e.isAmazonWebApp);case 1:return e.isiOS;case 2:return e.isAndroid;case 3:return e.isWindows8App;case 4:return e.isWindowsPhone8;case 5:return e.isBlackberry10;case 6:return e.isTizen;case 7:return!1;case 8:return e.isCordova;case 9:return e.isArcade;case 10:return e.isNodeWebkit;case 11:return e.isCrosswalk;case 12:return e.isAmazonWebApp;case 13:return e.isWindows10;default:return!1}},e.prototype.IsFullscreen=function(){if(this.runtime.isElectron)return require("electron").remote.getGlobal("isFullScreen");else return!1};var i=null,n="",r="";function s(t,e){if(!i||t!==n||e!==r)i=new RegExp(t,e),n=t,r=e;return i.lastIndex=0,i}e.prototype.RegexTest=function(t,e,i){return s(e,i).test(t)};var u=[];function o(){}e.prototype.PickOverlappingPoint=function(t,e,i){if(!t)return!1;var n,r,o,s=t.getCurrentSol(),a=s.getObjects(),l=this.runtime.getCurrentEventStack().current_event.orblock,c=this.runtime.getCurrentCondition();if(s.select_all)drama.shallowAssignArray(u,a),drama.clearArray(s.else_instances),s.select_all=!1,drama.clearArray(s.instances);else if(l)drama.shallowAssignArray(u,s.else_instances),drama.clearArray(s.else_instances);else drama.shallowAssignArray(u,a),drama.clearArray(s.instances);for(n=0,r=u.length;n<r;++n)if((o=u[n]).update_bbox(),drama.xor(o.contains_pt(e,i),c.inverted))s.instances.push(o);else s.else_instances.push(o);return t.applySolToContainer(),drama.xor(!!s.instances.length,c.inverted)},e.prototype.PickLastCreated=function(t){if(!t)return!1;var e,i,n=this.runtime.createRow,r=null,o=t.is_family;for(e=n.length-1;0<=e;--e)if(i=n[e],o){if(0<=i.type.families.indexOf(t)){r=i;break}}else if(i.type===t){r=i;break}if(!r&&t.instances.length)r=t.instances[t.instances.length-1];if(!r)return!1;else return t.getCurrentSol().pick_one(r),t.applySolToContainer(),!0},e.prototype.IsNaN=function(t){return!!isNaN(t)},e.prototype.AngleWithin=function(t,e,i){return drama.angleDiff(drama.to_radians(t),drama.to_radians(i))<=drama.to_radians(e)},e.prototype.IsClockwiseFrom=function(t,e){return drama.angleClockwise(drama.to_radians(t),drama.to_radians(e))},e.prototype.IsBetweenAngles=function(t,e,i){var n=drama.to_clamped_radians(t),r=drama.to_clamped_radians(e),o=drama.to_clamped_radians(i);if(!drama.angleClockwise(o,r))return!(!drama.angleClockwise(n,r)&&drama.angleClockwise(n,o));else return drama.angleClockwise(n,r)&&!drama.angleClockwise(n,o)},e.prototype.IsValueType=function(t,e){if("number"==typeof t)return 0===e;else return 1===e},e.prototype.IsResourceLoadComplete=function(t){if(!t)return!1;if(this.runtime.dynamicType&&t.name==this.runtime.dynamicType.name)return!0;else return},e.prototype.IsResourceLoadFail=function(t){if(!t)return!1;if(this.runtime.dynamicType&&t.name==this.runtime.dynamicType.name)return!0;else return},e.prototype.IsResourceLoading=function(t){if(!t)return!1;else return!!t.isDynamicLoading},e.prototype.IsFacebookShareSuccess=function(t){return!0},e.prototype.IsFacebookShareFail=function(t){return!0},e.prototype.checkLanguage=function(t){var e=navigator.language,i=e.substring(0,2),n=e.substring(3);switch(t){case 0:return"en"===i;case 1:return"zh"===i&&(!n||"CN"===n);case 2:return"zh"===i&&(!n||"CN"!==n)}},t.cnds=new e,o.prototype.GoToLayout=function(t){if(this.runtime.running_layout.name!=t.name&&this.runtime.isLoadBySection)t.name,this.runtime.loadingSection(t);if(!this.runtime.isloading){if(!this.runtime.changelayout)log("Go to layout: "+t.name),this.runtime.changelayout=t}else if(this.runtime.isLoadBySection)this.runtime.loadingLayOut(t)},o.prototype.NextPrevLayout=function(t){var e=this.runtime.layouts_by_index.indexOf(this.runtime.running_layout),i=this.runtime.layouts_by_index[e+(t?-1:1)];if(this.runtime.running_layout.name!=i.name&&this.runtime.isLoadBySection)i.name,this.runtime.loadingSection(i);if(!this.runtime.isloading){if(!this.runtime.changelayout)if(!t||0!==e)if(t||e!==this.runtime.layouts_by_index.length-1)log("Go to layout: "+i.name),this.runtime.changelayout=i}else if(this.runtime.isLoadBySection)this.runtime.loadingLayOut(i)},o.prototype.CreateObject=function(t,e,i,n){if(e&&t){var r=this.runtime.createInstance(t,e,i,n,!1,!0);if(r){var o,s,a;if(this.runtime.isInOnDestroy++,this.runtime.trigger(Object.getPrototypeOf(t.plugin).cnds.OnCreated,r),r.is_contained)for(o=0,s=r.siblings.length;o<s;o++)a=r.siblings[o],this.runtime.trigger(Object.getPrototypeOf(a.type.plugin).cnds.OnCreated,a);this.runtime.isInOnDestroy--;var l=t.getCurrentSol();if(l.select_all=!1,drama.clearArray(l.instances),(l.instances[0]=r).is_contained)for(o=0,s=r.siblings.length;o<s;o++)(l=(a=r.siblings[o]).type.getCurrentSol()).select_all=!1,drama.clearArray(l.instances),l.instances[0]=a}}},o.prototype.CreateObjectByName=function(t,e,i,n){if(e&&t){var r=this.runtime.types_lowercase[t.toLowerCase()];if(r)o.prototype.CreateObject.call(this,r,e,i,n)}},o.prototype.DestroyObjectByName=function(t){var e=this;if(t){var i=this.runtime.types_lowercase[t.toLowerCase()];if(i){i.getCurrentSol().getObjects().forEach(function(t){e.runtime.DestroyInstance(t)})}}},o.prototype.SetLayerVisible=function(t,e){if(t)if(t.visible!==e)t.visible=e,this.runtime.redraw=!0},o.prototype.SetLayerOpacity=function(t,e){if(t)if(e=drama.clamp(e/100,0,1),t.opacity!==e)t.opacity=e,this.runtime.redraw=!0},o.prototype.SetLayerScaleRate=function(t,e){if(t)if(t.zoomRate!==e)t.zoomRate=e,this.runtime.redraw=!0},o.prototype.SetLayerForceOwnTexture=function(t,e){if(t)if(e=!!e,t.forceOwnTexture!==e)t.forceOwnTexture=e,this.runtime.redraw=!0},o.prototype.SetLayoutScale=function(t){if(this.runtime.running_layout)if(this.runtime.running_layout.scale!==t)this.runtime.running_layout.scale=t,this.runtime.running_layout.boundScrolling(),this.runtime.redraw=!0},o.prototype.ScrollX=function(t){this.runtime.running_layout.scrollToX(t)},o.prototype.ScrollY=function(t){this.runtime.running_layout.scrollToY(t)},o.prototype.Scroll=function(t,e,i){this.runtime.running_layout.scrollToX(t,i),this.runtime.running_layout.scrollToY(e,i)},o.prototype.ScrollToObject=function(t,e){var i=t.getFirstPicked();if(i)this.runtime.running_layout.scrollToX(i.x,e),this.runtime.running_layout.scrollToY(i.y,e)},o.prototype.SetVar=function(t,e,i){assert2(!e.is_constant,"Setting a constant event variable");var n=e.data;if(0===e.vartype)if(drama.is_number(i))e.setValue(i);else e.setValue(parseFloat(i));else if(1===e.vartype)e.setValue(i.toString());else if(2===e.vartype)e.setValue(!!i);if(n!==i)if(e.is_static&&e.parent||!e.parent){var r=this.varSid;this.varSid=e.sid,this.runtime.trigger(drama.system_object.prototype.cnds.CustomInstanceVarChange,null),this.varSid=r}},o.prototype.AddVar=function(t,e){assert2(!t.is_constant,"Setting a constant event variable");var i=t.data;if(0===t.vartype)if(drama.is_number(e))t.setValue(t.getValue()+e);else t.setValue(t.getValue()+parseFloat(e));else if(1===t.vartype)t.setValue(t.getValue()+e.toString());if(t.data!==i&&(t.is_static&&t.parent||!t.parent)){var n=this.varSid;this.varSid=t.sid,this.runtime.trigger(drama.system_object.prototype.cnds.CustomInstanceVarChange,null),this.varSid=n}},o.prototype.SubVar=function(t,e){assert2(!t.is_constant,"Setting a constant event variable");var i=t.data;if(0===t.vartype)if(drama.is_number(e))t.setValue(t.getValue()-e);else t.setValue(t.getValue()-parseFloat(e));if(t.data!==i&&(t.is_static&&t.parent||!t.parent)){var n=this.varSid;this.varSid=t.sid,this.runtime.trigger(drama.system_object.prototype.cnds.CustomInstanceVarChange,null),this.varSid=n}},o.prototype.SetBoolVar=function(t,e){assert2(!t.is_constant,"Setting a constant event variable"),assert2(2===t.vartype,"expected boolean type");var i=t.data,n=0!==e;if(t.setValue(n),i!==n)if(t.is_static&&t.parent||!t.parent){var r=this.varSid;this.varSid=t.sid,this.runtime.trigger(drama.system_object.prototype.cnds.CustomInstanceVarChange,null),this.varSid=r}},o.prototype.ToggleBoolVar=function(t){if(assert2(!t.is_constant,"Setting a constant event variable"),assert2(2===t.vartype,"expected boolean type"),t.setValue(!t.getValue()),t.is_static&&t.parent||!t.parent){var e=this.varSid;this.varSid=t.sid,this.runtime.trigger(drama.system_object.prototype.cnds.CustomInstanceVarChange,null),this.varSid=e}},o.prototype.SetGroupActive=function(t,e){var i=this.runtime.groups_by_name[t.toLowerCase()];if(i)switch(e){case 0:i.setGroupActive(!1);break;case 1:i.setGroupActive(!0);break;case 2:i.setGroupActive(!i.group_active)}},o.prototype.SetTimescale=function(t){var e=t;if(e<0)e=0;this.runtime.timescale=e},o.prototype.SetObjectTimescale=function(t,e){var i=e;if(i<0)i=0;if(t){var n,r,o=t.getCurrentSol().getObjects();for(n=0,r=o.length;n<r;n++)o[n].my_timescale=i}},o.prototype.RestoreObjectTimescale=function(t){if(!t)return!1;var e,i,n=t.getCurrentSol().getObjects();for(e=0,i=n.length;e<i;e++)n[e].my_timescale=-1};var h=[];function l(){var t;if(h.length)t=h.pop();else t={sols:{},solModifiers:[]};return t.deleteme=!1,t}var d=[];function c(){var t;if(d.length)t=d.pop();else t={insts:[]};return t.sa=!1,t}function f(t,e){var i=t[0]-e[0];if(0!==i)return i;else return t[1]-e[1]}function m(t,e){return t[1]-e[1]}o.prototype.Wait=function(t){if(!(t<0)){var e,i,n,r,o,s=this.runtime.getCurrentEventStack(),a=l();for(a.time=this.runtime.kahanTime.sum+t,a.signaltag="",a.signalled=!1,a.ev=s.current_event,a.actindex=s.actindex+1,e=0,i=this.runtime.types_by_index.length;e<i;e++)if(!(n=(r=this.runtime.types_by_index[e]).getCurrentSol()).select_all||-1!==s.current_event.solModifiers.indexOf(r))a.solModifiers.push(r),(o=c()).sa=n.select_all,drama.shallowAssignArray(o.insts,n.instances),a.sols[e.toString()]=o;return this.waits.push(a),!0}},o.prototype.WaitForSignal=function(t){var e,i,n,r,o,s=this.runtime.getCurrentEventStack(),a=l();for(a.time=-1,a.signaltag=t.toLowerCase(),a.signalled=!1,a.ev=s.current_event,a.actindex=s.actindex+1,e=0,i=this.runtime.types_by_index.length;e<i;e++)if(!(n=(r=this.runtime.types_by_index[e]).getCurrentSol()).select_all||-1!==s.current_event.solModifiers.indexOf(r))a.solModifiers.push(r),(o=c()).sa=n.select_all,drama.shallowAssignArray(o.insts,n.instances),a.sols[e.toString()]=o;return this.waits.push(a),!0},o.prototype.Signal=function(t){var e,i,n,r=t.toLowerCase();for(e=0,i=this.waits.length;e<i;++e)if(-1===(n=this.waits[e]).time)if(n.signaltag===r)n.signalled=!0},o.prototype.SetLayerScale=function(t,e){if(t)if(t.scale!==e)t.scale=e,this.runtime.redraw=!0},o.prototype.ResetGlobals=function(t){var e,i,n,r=t.split("|");if(""==t)for(e=0,i=this.runtime.all_global_vars.length;e<i;e++){var o=(n=this.runtime.all_global_vars[e]).data;if(n.setValue(n.initial),o!==n.data){var s=this.varSid;this.varSid=n.sid,this.runtime.trigger(drama.system_object.prototype.cnds.CustomInstanceVarChange,null),this.varSid=s}}else for(e=0,i=r.length;e<i;e++){var a=(n=this.runtime.all_global_varsMap[r[e]]).data;if(n.setValue(n.initial),a!==n.data){var l=this.varSid;this.varSid=n.sid,this.runtime.trigger(drama.system_object.prototype.cnds.CustomInstanceVarChange,null),this.varSid=l}}},o.prototype.SetLayoutAngle=function(t){if(t=drama.to_radians(t),t=drama.clamp_angle(t),this.runtime.running_layout)if(this.runtime.running_layout.angle!==t)this.runtime.running_layout.angle=t,this.runtime.redraw=!0},o.prototype.SetLayerAngle=function(t,e){if(t)if(e=drama.to_radians(e),e=drama.clamp_angle(e),t.angle!==e)t.angle=e,this.runtime.redraw=!0},o.prototype.SetLayerParallax=function(t,e,i){if(t)if(t.parallaxX!==e/100||t.parallaxY!==i/100){if(t.parallaxX=e/100,t.parallaxY=i/100,1!==t.parallaxX||1!==t.parallaxY){var n,r,o=t.instances;for(n=0,r=o.length;n<r;++n)o[n].type.any_instance_parallaxed=!0}this.runtime.redraw=!0}},o.prototype.SetLayerBackground=function(t,e){if(t){var i=drama.clamp(Math.floor(255*drama.GetRValue(e)),0,255),n=drama.clamp(Math.floor(255*drama.GetGValue(e)),0,255),r=drama.clamp(Math.floor(255*drama.GetBValue(e)),0,255);if(t.background_color[0]!==i||t.background_color[1]!==n||t.background_color[2]!==r)t.background_color[0]=i,t.background_color[1]=n,t.background_color[2]=r,this.runtime.redraw=!0}},o.prototype.SetLayerTransparent=function(t,e){if(t)if(!!e!=!!t.transparent)t.transparent=!!e,this.runtime.redraw=!0},o.prototype.SetLayerBlendMode=function(t,e){if(t)if(t.blend_mode!==e){if(t.blend_mode=e,t.compositeOp=drama.effectToCompositeOp(t.blend_mode),this.runtime.gl)drama.setGLBlend(t,t.blend_mode,this.runtime.gl);this.runtime.redraw=!0}},o.prototype.StopLoop=function(){if(!(this.runtime.loop_stack_index<0))this.runtime.getCurrentLoop().stopped=!0},o.prototype.GoToLayoutByName=function(t){var e,i;for(e in this.runtime.layouts)if(this.runtime.layouts.hasOwnProperty(e)&&drama.equals_nocase(e,t))i=this.runtime.layouts[e];if(this.runtime.running_layout.name!=i.name&&this.runtime.isLoadBySection)i.name,this.runtime.loadingSection(i);if(!this.runtime.isloading){if(!this.runtime.changelayout)log("Go to layout: "+t),this.runtime.changelayout=i}else if(this.runtime.isLoadBySection)this.runtime.loadingLayOut(i)},o.prototype.RestartLayout=function(t){if(!this.runtime.isloading){if(!this.runtime.changelayout)if(log("Restarting layout"),this.runtime.running_layout){var e,i,n;for(this.runtime.changelayout=this.runtime.running_layout,e=0,i=this.runtime.allGroups.length;e<i;e++)(n=this.runtime.allGroups[e]).setGroupActive(n.initially_activated)}}else if(this.runtime.isLoadBySection)this.runtime.loadingLayOut(this.runtime.running_layout)},o.prototype.SnapshotCanvas=function(t,e){this.runtime.doCanvasSnapshot(0===t?"image/png":"image/jpeg",e/100)},o.prototype.SetCanvasSize=function(t,e){if(!(t<=0||e<=0)){var i=this.runtime.fullscreen_mode;if((document.mozFullScreen||document.webkitIsFullScreen||!!document.msFullscreenElement||document.fullScreen||this.runtime.isNodeFullscreen)&&0<this.runtime.fullscreen_scaling)i=this.runtime.fullscreen_scaling;if(0===i)this.runtime.setSize(t,e,!0);else this.runtime.original_width=t,this.runtime.original_height=e,this.runtime.setSize(this.runtime.lastWindowWidth,this.runtime.lastWindowHeight,!0)}},o.prototype.SetLayoutEffectEnabled=function(t,e){if(this.runtime.running_layout&&this.runtime.glwrap){var i=this.runtime.running_layout.getEffectByName(e);if(i){var n=1===t;if(i.active!=n)i.active=n,this.runtime.running_layout.updateActiveEffects(),this.runtime.redraw=!0}}},o.prototype.SetLayerEffectEnabled=function(t,e,i){if(t&&this.runtime.glwrap){var n=t.getEffectByName(i);if(n){var r=1===e;if(n.active!=r)n.active=r,t.updateActiveEffects(),this.runtime.redraw=!0}}},o.prototype.SetLayoutEffectParam=function(t,e,i){if(this.runtime.running_layout&&this.runtime.glwrap){var n=this.runtime.running_layout.getEffectByName(t);if(n){var r=this.runtime.running_layout.effect_params[n.index];if(!((e=Math.floor(e))<0||e>=r.length)){var o=this.runtime.glwrap.getProgramParameterType(n.shaderindex,e);if(1===o)i/=100;else if(2===o)i=[drama.GetRValue(i),drama.GetGValue(i),drama.GetBValue(i)];if(r[e]!==i)if(r[e]=i,n.active)this.runtime.redraw=!0}}}},o.prototype.SetLayerEffectParam=function(t,e,i,n){if(t&&this.runtime.glwrap){var r=t.getEffectByName(e);if(r){var o=t.effect_params[r.index];if(!((i=Math.floor(i))<0||i>=o.length)){var s=this.runtime.glwrap.getProgramParameterType(r.shaderindex,i);if(1===s)n/=100;else if(2===s)n=[drama.GetRValue(n),drama.GetGValue(n),drama.GetBValue(n)];if(o[i]!==n)if(o[i]=n,r.active)this.runtime.redraw=!0}}}},o.prototype.SaveState=function(t){this.runtime.saveToSlot=t},o.prototype.LoadState=function(t){this.runtime.loadFromSlot=t},o.prototype.LoadStateJSON=function(t){this.runtime.loadFromJson=t},o.prototype.SetHalfFramerateMode=function(t){this.runtime.halfFramerateMode=0!==t},o.prototype.SetFullscreenQuality=function(t){if(document.mozFullScreen||document.webkitIsFullScreen||!!document.msFullscreenElement||document.fullScreen||this.isNodeFullscreen||0!==this.runtime.fullscreen_mode)this.runtime.wantFullscreenScalingQuality=0!==t,this.runtime.setSize(this.runtime.lastWindowWidth,this.runtime.lastWindowHeight,!0)},o.prototype.ResetPersisted=function(){var t,e;for(t=0,e=this.runtime.layouts_by_index.length;t<e;++t)this.runtime.layouts_by_index[t].persist_data={},this.runtime.layouts_by_index[t].first_visit=!0},o.prototype.RecreateInitialObjects=function(t,e,i,n,r){if(t)this.runtime.running_layout.recreateInitialObjects(t,e,i,n,r)},o.prototype.SetPixelRounding=function(t){this.runtime.pixel_rounding=0!==t,this.runtime.redraw=!0},o.prototype.SetMinimumFramerate=function(t){if(t<1)t=1;if(120<t)t=120;this.runtime.minimumFramerate=t},o.prototype.MoveLayoutTarget=function(t,i){var e=this.runtime.getLayer(t);if(e){var n=this.runtime.running_layout;if(n.layers&&0!=n.layers.length){var r=e.index;if(n.layers.map(function(t,e){if(0===i){if(r<e)t.index=e-1}else if(1===i)if(e<r)t.index=e+1}),0===i){if(r!==n.layers.length)n.layers.splice(r,1),n.layers.push(e),e.index=n.layers.length-1}else if(1===i)if(0!==r)n.layers.splice(r,1),n.layers.unshift(e),e.index=0;this.runtime.redraw=!0}}},o.prototype.MoveLayerTarget=function(t,e,i){var n=this.runtime.getLayer(t),r=this.runtime.getLayer(e),o=[];if(n&&r){var s=this.runtime.running_layout,a=s.layers;if(a&&0!=a.length){var l=n.index,c=r.index;if(l!=c){if(l<c)s.layers.map(function(t,e){if(0===i)if(e<=c&&l<e)(o[e-1]=t).index=e-1;else if(e==l)(o[c]=n).index=c;else o[e]=t;else if(1===i)if(e<c&&l<e)(o[e-1]=t).index=e-1;else if(e==l)(o[c-1]=n).index=c-1;else o[e]=t});else if(c<l)s.layers.map(function(t,e){if(0===i)if(e<l&&c<e)(o[e+1]=t).index=e+1;else if(e==l)(o[c+1]=n).index=c+1;else o[e]=t;else if(1===i)if(e<l&&c<=e)(o[e+1]=t).index=e+1;else if(e==l)(o[c]=n).index=c;else o[e]=t});s.layers=o,this.runtime.redraw=!0}}}},o.prototype.ResetLayersOrder=function(){var t=this.runtime.running_layout;if(t.layers&&0!=t.layers.length){var i=[];t.layers.map(function(t,e){(i[t.initial_index]=t).index=t.initial_index}),t.layers=i,this.runtime.redraw=!0}},o.prototype.SortZOrderByInstVar=function(t,e){if(t){var i,n,r,o,s,a,l=t.getCurrentSol().getObjects(),c=[],u=[],h=this.runtime.running_layout,d=t.is_family,p=t.family_index;for(i=0,n=l.length;i<n;++i)if((r=l[i]).layer){if(d)o=r.instance_vars[e+r.type.family_var_map[p]];else o=r.instance_vars[e];c.push([r.layer.index,r.get_zindex()]),u.push([r,o])}if(c.length)for(c.sort(f),u.sort(m),i=0,n=c.length;i<n;++i)if(r=u[i][0],s=h.layers[c[i][0]],a=c[i][1],s.instances[a]!==r&&!s.isAutoSortZIndex)s.instances[a]=r,s.setZIndicesStaleFrom(a)}},o.prototype.LoadResource=function(t){if(t)if(drama.plugins_.Sprite&&t.plugin instanceof drama.plugins_.Sprite||drama.plugins_.xfSpine&&t.plugin instanceof drama.plugins_.xfSpine)t.dynamicLoad&&t.dynamicLoad()},o.prototype.ReleaseResource=function(t){if(t)if(t.plugin instanceof drama.plugins_.Sprite||t.plugin instanceof drama.plugins_.xfSpine)t.dynamicRelease&&t.dynamicRelease()};var a=!(o.prototype.exitGame=function(){if(this.runtime.isElectron)require("electron").remote.app.quit()});function p(){}o.prototype.facebookShare=function(){if(this.runtime.isCordova){var e=this;!function(){if(!a)a=!0,document.addEventListener("onFacebookShareSuccess",function(t){e.runtime.trigger(drama.system_object.prototype.cnds.IsFacebookShareSuccess,null)}),document.addEventListener("onFacebookShareFail",function(t){e.runtime.trigger(drama.system_object.prototype.cnds.IsFacebookShareFail,null)})}(),cordova.plugins.SeiyaSdk.facebookShare()}},o.prototype.openGooglePlayMarketing=function(){if(this.runtime.isCordova)cordova.plugins.SeiyaSdk.openMarketing()},o.prototype.SetFullscreen=function(t){if(this.runtime.isElectron){var e=require("electron").remote.getGlobal("isFullScreen"),i=require("electron").ipcRenderer;if(!!t!==e)i.send("changeFullScreen",!!t)}},t.acts=new o,p.prototype.int=function(t,e){if(drama.is_string(e)){if(t.set_int(parseInt(e,10)),isNaN(t.data))t.data=0}else t.set_int(e)},p.prototype.float=function(t,e){if(drama.is_string(e)){if(t.set_float(parseFloat(e)),isNaN(t.data))t.data=0}else t.set_float(e)},p.prototype.str=function(t,e){if(drama.is_string(e))t.set_string(e);else t.set_string(e.toString())},p.prototype.len=function(t,e){t.set_int(e.length||0)},p.prototype.random=function(t,e,i){if(void 0===i)t.set_float(Math.random()*e);else t.set_float(Math.random()*(i-e)+e)},p.prototype.sqrt=function(t,e){t.set_float(Math.sqrt(e))},p.prototype.abs=function(t,e){t.set_float(Math.abs(e))},p.prototype.round=function(t,e){t.set_int(Math.round(e))},p.prototype.roundto=function(t,e,i){i=Math.max(0,i),t.set_float(parseFloat(e.toFixed(i)))},p.prototype.floor=function(t,e){t.set_int(Math.floor(e))},p.prototype.ceil=function(t,e){t.set_int(Math.ceil(e))},p.prototype.sign=function(t,e){t.set_float(Math.sign(e))},p.prototype.sin=function(t,e){t.set_float(Math.sin(drama.to_radians(e)))},p.prototype.cos=function(t,e){t.set_float(Math.cos(drama.to_radians(e)))},p.prototype.tan=function(t,e){t.set_float(Math.tan(drama.to_radians(e)))},p.prototype.asin=function(t,e){t.set_float(drama.to_degrees(Math.asin(e)))},p.prototype.acos=function(t,e){t.set_float(drama.to_degrees(Math.acos(e)))},p.prototype.atan=function(t,e){t.set_float(drama.to_degrees(Math.atan(e)))},p.prototype.exp=function(t,e){t.set_float(Math.exp(e))},p.prototype.ln=function(t,e){t.set_float(Math.log(e))},p.prototype.log10=function(t,e){t.set_float(Math.log(e)/Math.LN10)},p.prototype.max=function(t){var e,i,n,r=arguments[1];if("number"!=typeof r)r=0;for(e=2,i=arguments.length;e<i;e++)if("number"==typeof(n=arguments[e]))if(r<n)r=n;t.set_float(r)},p.prototype.min=function(t){var e,i,n,r=arguments[1];if("number"!=typeof r)r=0;for(e=2,i=arguments.length;e<i;e++)if("number"==typeof(n=arguments[e]))if(n<r)r=n;t.set_float(r)},p.prototype.dt=function(t){t.set_float(this.runtime.dt)},p.prototype.timescale=function(t){t.set_float(this.runtime.timescale)},p.prototype.wallclocktime=function(t){t.set_float((Date.now()-this.runtime.start_time)/1e3)},p.prototype.unixtime=function(t){t.set_float(Date.now())},p.prototype.time=function(t){t.set_float(this.runtime.kahanTime.sum)},p.prototype.tickcount=function(t){t.set_int(this.runtime.tickcount)},p.prototype.objectcount=function(t){t.set_int(this.runtime.objectcount)},p.prototype.fps=function(t){t.set_int(this.runtime.fps)},p.prototype.loopindex=function(t,e){var i,n;if(this.runtime.loop_stack.length)if(e){for(n=this.runtime.loop_stack_index;0<=n;--n)if((i=this.runtime.loop_stack[n]).name===e)return void t.set_int(i.index);t.set_int(0)}else i=this.runtime.getCurrentLoop(),t.set_int(i?i.index:-1);else t.set_int(0)},p.prototype.distance=function(t,e,i,n,r){t.set_float(drama.distanceTo(e,i,n,r))},p.prototype.angle=function(t,e,i,n,r){t.set_float(drama.to_degrees(drama.angleTo(e,i,n,r)))},p.prototype.scrollx=function(t){t.set_float(this.runtime.running_layout.scrollX)},p.prototype.scrolly=function(t){t.set_float(this.runtime.running_layout.scrollY)},p.prototype.newline=function(t){t.set_string("\n")},p.prototype.lerp=function(t,e,i,n){t.set_float(drama.lerp(e,i,n))},p.prototype.qarp=function(t,e,i,n,r){t.set_float(drama.qarp(e,i,n,r))},p.prototype.cubic=function(t,e,i,n,r,o){t.set_float(drama.cubic(e,i,n,r,o))},p.prototype.cosp=function(t,e,i,n){t.set_float(drama.cosp(e,i,n))},p.prototype.windowwidth=function(t){t.set_int(this.runtime.width)},p.prototype.windowheight=function(t){t.set_int(this.runtime.height)},p.prototype.uppercase=function(t,e){t.set_string(drama.is_string(e)?e.toUpperCase():"")},p.prototype.lowercase=function(t,e){t.set_string(drama.is_string(e)?e.toLowerCase():"")},p.prototype.clamp=function(t,e,i,n){if(e<i)t.set_float(i);else if(n<e)t.set_float(n);else t.set_float(e)},p.prototype.layerscale=function(t,e){var i=this.runtime.getLayer(e);if(!i)t.set_float(0);else t.set_float(i.scale)},p.prototype.layeropacity=function(t,e){var i=this.runtime.getLayer(e);if(!i)t.set_float(0);else t.set_float(100*i.opacity)},p.prototype.layerscalerate=function(t,e){var i=this.runtime.getLayer(e);if(!i)t.set_float(0);else t.set_float(i.zoomRate)},p.prototype.layerparallaxx=function(t,e){var i=this.runtime.getLayer(e);if(!i)t.set_float(0);else t.set_float(100*i.parallaxX)},p.prototype.layerparallaxy=function(t,e){var i=this.runtime.getLayer(e);if(!i)t.set_float(0);else t.set_float(100*i.parallaxY)},p.prototype.layerindex=function(t,e){var i=this.runtime.getLayer(e);if(!i)t.set_int(-1);else t.set_int(i.index)},p.prototype.layoutscale=function(t){if(this.runtime.running_layout)t.set_float(this.runtime.running_layout.scale);else t.set_float(0)},p.prototype.layoutangle=function(t){t.set_float(drama.to_degrees(this.runtime.running_layout.angle))},p.prototype.layerangle=function(t,e){var i=this.runtime.getLayer(e);if(!i)t.set_float(0);else t.set_float(drama.to_degrees(i.angle))},p.prototype.layoutwidth=function(t){t.set_int(this.runtime.running_layout.width)},p.prototype.layoutheight=function(t){t.set_int(this.runtime.running_layout.height)},p.prototype.find=function(t,e,i){if(drama.is_string(e)&&drama.is_string(i))t.set_int(e.search(new RegExp(drama.regexp_escape(i),"i")));else t.set_int(-1)},p.prototype.findcase=function(t,e,i){if(drama.is_string(e)&&drama.is_string(i))t.set_int(e.search(new RegExp(drama.regexp_escape(i),"")));else t.set_int(-1)},p.prototype.left=function(t,e,i){t.set_string(drama.is_string(e)?e.substr(0,i):"")},p.prototype.right=function(t,e,i){t.set_string(drama.is_string(e)?e.substr(e.length-i):"")},p.prototype.mid=function(t,e,i,n){t.set_string(drama.is_string(e)?e.substr(i,n):"")},p.prototype.tokenat=function(t,e,i,n){if(drama.is_string(e)&&drama.is_string(n)){var r=e.split(n),o=drama.floor(i);if(o<0||o>=r.length)t.set_string("");else t.set_string(r[o])}else t.set_string("")},p.prototype.tokencount=function(t,e,i){if(drama.is_string(e)&&e.length)t.set_int(e.split(i).length);else t.set_int(0)},p.prototype.replace=function(t,e,i,n){if(drama.is_string(e)&&drama.is_string(i)&&drama.is_string(n))t.set_string(e.replace(new RegExp(drama.regexp_escape(i),"gi"),n));else t.set_string(drama.is_string(e)?e:"")},p.prototype.trim=function(t,e){t.set_string(drama.is_string(e)?e.trim():"")},p.prototype.pi=function(t){t.set_float(drama.PI)},p.prototype.layoutname=function(t){if(this.runtime.running_layout)t.set_string(this.runtime.running_layout.name);else t.set_string("")},p.prototype.renderer=function(t){t.set_string(this.runtime.gl?"webgl":"canvas2d")},p.prototype.rendererdetail=function(t){t.set_string(this.runtime.glUnmaskedRenderer)},p.prototype.anglediff=function(t,e,i){t.set_float(drama.to_degrees(drama.angleDiff(drama.to_radians(e),drama.to_radians(i))))},p.prototype.choose=function(t){var e=drama.floor(Math.random()*(arguments.length-1));t.set_any(arguments[e+1])},p.prototype.rgb=function(t,e,i,n){t.set_int(drama.RGB(e,i,n))},p.prototype.rgbex=function(t,e,i,n){t.set_float(drama.RGBEx(e/100,i/100,n/100))},p.prototype.projectversion=function(t){t.set_string(this.runtime.versionstr)},p.prototype.projectname=function(t){t.set_string(this.runtime.name)},p.prototype.anglelerp=function(t,e,i,n){e=drama.to_radians(e),i=drama.to_radians(i);var r=drama.angleDiff(e,i);if(drama.angleClockwise(i,e))t.set_float(drama.to_clamped_degrees(e+r*n));else t.set_float(drama.to_clamped_degrees(e-r*n))},p.prototype.anglerotate=function(t,e,i,n){e=drama.to_radians(e),i=drama.to_radians(i),n=drama.to_radians(n),t.set_float(drama.to_clamped_degrees(drama.angleRotate(e,i,n)))},p.prototype.zeropad=function(t,e,i){var n=e<0?"-":"";if(e<0)e=-e;for(var r=i-e.toString().length,o=0;o<r;o++)n+="0";t.set_string(n+e.toString())},p.prototype.cpuutilisation=function(t){t.set_float(this.runtime.cpuutilisation/1e3)},p.prototype.gpuutilisation=function(t){t.set_float(this.runtime.gpuLastUtilisation)},p.prototype.viewportleft=function(t,e){var i=this.runtime.getLayer(e);t.set_float(i?i.viewLeft:0)},p.prototype.viewporttop=function(t,e){var i=this.runtime.getLayer(e);t.set_float(i?i.viewTop:0)},p.prototype.viewportright=function(t,e){var i=this.runtime.getLayer(e);t.set_float(i?i.viewRight:0)},p.prototype.viewportbottom=function(t,e){var i=this.runtime.getLayer(e);t.set_float(i?i.viewBottom:0)},p.prototype.loadingprogress=function(t){t.set_float(this.runtime.loadingprogress)},p.prototype.unlerp=function(t,e,i,n){t.set_float(drama.unlerp(e,i,n))},p.prototype.canvassnapshot=function(t){t.set_string(this.runtime.snapshotData)},p.prototype.urlencode=function(t,e){t.set_string(encodeURIComponent(e))},p.prototype.urldecode=function(t,e){t.set_string(decodeURIComponent(e))},p.prototype.canvastolayerx=function(t,e,i,n){var r=this.runtime.getLayer(e);t.set_float(r?r.canvasToLayer(i,n,!0):0)},p.prototype.canvastolayery=function(t,e,i,n){var r=this.runtime.getLayer(e);t.set_float(r?r.canvasToLayer(i,n,!1):0)},p.prototype.layertocanvasx=function(t,e,i,n){var r=this.runtime.getLayer(e);t.set_float(r?r.layerToCanvas(i,n,!0):0)},p.prototype.layertocanvasy=function(t,e,i,n){var r=this.runtime.getLayer(e);t.set_float(r?r.layerToCanvas(i,n,!1):0)},p.prototype.savestatejson=function(t){t.set_string(this.runtime.lastSaveJson)},p.prototype.imagememoryusage=function(t){if(this.runtime.glwrap)t.set_float(Math.round(100*this.runtime.glwrap.estimateVRAM()/1048576)/100);else t.set_float(0)},p.prototype.regexsearch=function(t,e,i,n){var r=s(i,n);t.set_int(e?e.search(r):-1)},p.prototype.regexreplace=function(t,e,i,n,r){var o=s(i,n);t.set_string(e?e.replace(o,r):"")};var g=[],y="",w="",x="";function S(t,e,i){if(t!==y||e!==w||i!==x){var n=s(e,i);g=t.match(n),y=t,w=e,x=i}}p.prototype.regexmatchcount=function(t,e,i,n){S(e.toString(),i,n),t.set_int(g?g.length:0)},p.prototype.regexmatchat=function(t,e,i,n,r){if(r=Math.floor(r),S(e.toString(),i,n),!g||r<0||r>=g.length)t.set_string("");else t.set_string(g[r])},p.prototype.infinity=function(t){t.set_float(1/0)},p.prototype.setbit=function(t,e,i,n){e|=0,i|=0,n=0!==n?1:0,t.set_int(e&~(1<<i)|n<<i)},p.prototype.togglebit=function(t,e,i){e|=0,i|=0,t.set_int(e^1<<i)},p.prototype.getbit=function(t,e,i){e|=0,i|=0,t.set_int(e&1<<i?1:0)},p.prototype.originalwindowwidth=function(t){t.set_int(this.runtime.original_width)},p.prototype.originalwindowheight=function(t){t.set_int(this.runtime.original_height)},p.prototype.originalviewportwidth=function(t){t.set_int(this.runtime.original_width)},p.prototype.originalviewportheight=function(t){t.set_int(this.runtime.original_height)},p.prototype.TypeLoadingProgress=function(t,e){var i=this.runtime.types_lowercase[e.toLowerCase()];t.set_float(~~i.loadingprogress)},t.exps=new p,t.runWaits=function(){var t,e,i,n,r,o,s,a,l,c=this.runtime.getCurrentEventStack();for(t=0,i=this.waits.length;t<i;t++){if(-1===(n=this.waits[t]).time){if(!n.signalled)continue}else if(n.time>this.runtime.kahanTime.sum)continue;for(r in c.current_event=n.ev,c.actindex=n.actindex,c.cndindex=0,n.sols)if(n.sols.hasOwnProperty(r))o=this.runtime.types_by_index[parseInt(r,10)].getCurrentSol(),s=n.sols[r],o.select_all=s.sa,drama.shallowAssignArray(o.instances,s.insts),a=s,drama.clearArray(a.insts),d.push(a);n.ev.resume_actions_and_subevents(),this.runtime.clearSol(n.solModifiers),n.deleteme=!0}for(e=t=0,i=this.waits.length;t<i;t++)if(n=this.waits[t],(this.waits[e]=n).deleteme)l=n,drama.wipe(l.sols),drama.clearArray(l.solModifiers),h.push(l);else e++;drama.truncateArray(this.waits,e)}}(),assert2(drama,"drama namespace not created"),assert2(drama.plugins_,"drama.plugins_ not created"),drama.plugins_.Text=function(t){this.runtime=t},function(){var t=drama.plugins_.Text.prototype;t.onCreate=function(){t.acts.SetWidth=function(t){if(this.width!==t)this.width=t,this.text_changed=!0,this.set_bbox_changed()}},t.Type=function(t){this.plugin=t,this.runtime=t.runtime};var e=t.Type.prototype;e.onCreate=function(){},e.onLostWebGLContext=function(){if(!this.is_family){var t,e,i;for(t=0,e=this.instances.length;t<e;t++)(i=this.instances[t]).mycanvas=null,i.myctx=null,i.mytex=null}},t.Instance=function(t){this.type=t,this.runtime=t.runtime,this.text_changed=!0};var i=t.Instance.prototype,l={};function n(){}function r(){}function o(){}i.onCreate=function(){var t=new xf.xfTextLayout;(this.layout=t).width=this.width,t.height=this.height,t.text=this.properties[0];var e=t.defaultStyle;if((this.style=e).fontFamily=this.properties[2],e.size=Math.ceil(this.properties[3]),t.lineSpace=this.properties[4],e.isBold=this.properties[5],e.isItalic=this.properties[6],e.underline=this.properties[7],e.deleteline=this.properties[8],e.color=xf.hexaDecimal(this.properties[9]),this.opacity*=this.properties[9][3]||1,this.properties[10])e.strokeColor=xf.hexaDecimal(this.properties[11]),e.strokeSize=this.properties[12],e.strokeAlpha=this.properties[11][3];else e.strokeSize=0;if(this.properties[13])e.shadowAngle=this.properties[14],e.shadowColor=xf.hexaDecimal(this.properties[15]),e.shadowAlpha=this.properties[15][3],e.shadowDistance=this.properties[16],e.shadowSize=this.properties[17],e.shadowOffsetX=e.shadowDistance*Math.cos(e.shadowAngle).toFixed(6)<<0,e.shadowOffsetY=e.shadowDistance*Math.sin(e.shadowAngle).toFixed(6)<<0;else e.shadowSize=0,e.shadowOffsetX=0,e.shadowOffsetY=0;if(e.hAlign=[xf.HorizontalAlign.LEFT,xf.HorizontalAlign.CENTER,xf.HorizontalAlign.RIGHT][this.properties[18]],e.vAlign=[xf.VerticalAlign.TOP,xf.VerticalAlign.MIDDLE,xf.VerticalAlign.BOTTOM][this.properties[19]],this.wrapbyword=0===this.properties[20],this.visible=this.properties[21],t.multiline=this.properties[22],t.isRichText=this.properties[23],this.cutMode=this.properties[24],this.lastwidth=this.width,this.lastwrapwidth=this.width,this.lastheight=this.height,this.updateFont(),this.mycanvas=null,this.myctx=null,this.mytex=null,this.need_text_redraw=!1,this.last_render_tick=this.runtime.tickcount,this.recycled)this.rcTex.set(0,0,1,1);else this.rcTex=new drama.rect(0,0,1,1);if(this.runtime.glwrap)this.runtime.tickMe(this);var i=this;if(this.wheelevent=function(t){i.onWheel(t)},this.moveY=0,this.downStageY=0,this.moveStageY=0,this.isTouchBegin=!1,this.maxScrollHeight=0,this.moveDistance=0,2==this.cutMode)if(this.event=xf.XfEvent.create(this.runtime),this.event.addEventListener("touchstart",function(t){this.onTouchStart(t)},this),this.event.addEventListener("touchmove",function(t){this.onTouchMove(t)},this),this.event.addEventListener("touchend",function(t){this.onTouchEnd(t)},this),this.event.addEventListener("touchcancel",function(t){this.onTouchCancel(t)},this),this.event.addEventListener("mousedown",function(t){this.onMouseDown(t)},this),this.event.addEventListener("mousemove",function(t){this.onMouseMove(t)},this),this.event.addEventListener("mouseup",function(t){this.onMouseUp(t)},this),!this.runtime.isMobile)document.addEventListener("mousewheel",this.wheelevent,!1),document.addEventListener("DOMMouseScroll",this.wheelevent,!1);this.isLayout=!0,this.updateTextLayout()},i.onMouseDown=function(t){var e=this.runtime;this.isTouchBegin=!0,this.downStageY=Math.round((t.pageY-e.canvas.offsetTop)/e.aspect_scale*e.draw_height/e.cssHeight)},i.onMouseUp=function(t){this.isTouchBegin=!1},i.onMouseMove=function(t){var e=this.runtime;if(this.isTouchBegin){var i=this.maxScrollHeight-Math.floor(this.height);if(i<0)return;if(this.moveStageY=Math.round((t.pageY-e.canvas.offsetTop)/e.aspect_scale*e.draw_height/e.cssHeight),this.moveY=-(this.moveStageY-this.downStageY),this.moveDistance+=this.moveY,this.moveDistance>i)this.moveDistance=i;if(this.moveDistance<0)this.moveDistance=0;e.redraw=!0,this.need_text_redraw=!0}this.downStageY=this.moveStageY},i.handTouches=function(t){var e,i,n,r,o;for(e=0,i=t.changedTouches.length;e<i;e++){n=t.changedTouches[e];var s=drama.convertPageXY(n.pageX,n.pageY);r=s.pageX,o=s.pageY}return{pageX:r,pageY:o}},i.onTouchStart=function(t){var e=this.handTouches(t),i=this.runtime;this.isTouchBegin=!0,this.downStageY=Math.round((e.pageY-i.canvas.offsetTop)/i.aspect_scale*i.draw_height/i.cssHeight)},i.onTouchMove=function(t){var e=this.handTouches(t),i=this.runtime;if(this.isTouchBegin){var n=this.maxScrollHeight-Math.floor(this.height);if(n<0)return;if(this.moveStageY=Math.round((e.pageY-i.canvas.offsetTop)/i.aspect_scale*i.draw_height/i.cssHeight),this.moveY=-(this.moveStageY-this.downStageY),this.moveDistance+=this.moveY,this.moveDistance>n)this.moveDistance=n;if(this.moveDistance<0)this.moveDistance=0;i.redraw=!0,this.need_text_redraw=!0,this.downStageY=this.moveStageY}},i.onTouchEnd=function(t){this.isTouchBegin=!1},i.onTouchCancel=function(t){this.isTouchBegin=!1},i.contains=function(t,e){var i,n,r=e.x-this.runtime.canvas.offsetLeft,o=e.y-this.runtime.canvas.offsetTop;t.update_bbox(),i=t.layer.canvasToLayer(r,o,!0),n=t.layer.canvasToLayer(r,o,!1);var s=t.contains_pt(i,n);if(s)return xf.checkTouchable(t,r,o);else return s},i.onWheel=function(t){if(this.contains(this,t)){var e=this.maxScrollHeight-Math.floor(this.height);if(!(e<0)){if((t.wheelDelta?t.wheelDelta:t.detail?-t.detail:0)<0)this.moveDistance+=120;else this.moveDistance-=120;if(this.moveDistance>e)this.moveDistance=e;if(this.moveDistance<0)this.moveDistance=0;this.need_text_redraw=!0,this.runtime.redraw=!0}}},i.saveToJSON=function(){return{text:this.layout.text}},i.loadFromJSON=function(t){this.layout.text=t.text,this.text_changed=!0,this.isLayout=!0,this.runtime.redraw=!0},i.tick=function(){if(this.runtime.glwrap&&this.mytex&&300<=this.runtime.tickcount-this.last_render_tick){var t=this.layer;this.update_bbox();var e=this.bbox;if(e.right<t.viewLeft||e.bottom<t.viewTop||e.left>t.viewRight||e.top>t.viewBottom)this.runtime.glwrap.deleteTexture(this.mytex),this.mytex=null,this.myctx=null,this.mycanvas=null}},i.onDestroy=function(){if(!this.runtime.isMobile)document.removeEventListener("mousewheel",this.wheelevent,!1),document.removeEventListener("DOMMouseScroll",this.wheelevent,!1);if(this.event&&this.event.removeEventListeners(["mousedown","mouseup","mousemove","touchstart","touchmove","touchend","touchcancel"],this),this.myctx=null,this.mycanvas=null,this.runtime.glwrap&&this.mytex)this.runtime.glwrap.deleteTexture(this.mytex);this.mytex=null},i.updateFont=function(){this.text_changed=!0,this.runtime.redraw=!0},i.updateTextLayout=function(){this.layout.width=this.width,this.layout.height=this.height,this.layout.doLayout(),this.maxScrollHeight=this.layout.textHeight},i.draw=function(t,e){var i=this.style;t.font=i.font,t.textBaseline="top",t.fillStyle=i.color,t.globalAlpha=e?1:this.opacity;var n=1;if(e)n=this.layer.getScale(),t.save(),t.scale(n,n);if(this.text_changed||this.width!==this.lastwrapwidth)if(this.updateTextLayout(),this.text_changed=!1,this.lastwrapwidth=this.width,this.isLayout){switch(i.vAlign){case xf.VerticalAlign.BOTTOM:this.moveDistance=this.maxScrollHeight-this.height;break;case xf.VerticalAlign.MIDDLE:this.moveDistance=.5*(this.maxScrollHeight-this.height);break;case xf.VerticalAlign.TOP:this.moveDistance=0}this.isLayout=!1}this.update_bbox();var r=e?0:this.bquad.tlx,o=e?"arial"===this.style.fontFamily&&!this.runtime.isMobile?2:0:this.bquad.tly;if(this.runtime.pixel_rounding)r=r+.5|0,o=o+.5|0;if(0!==this.angle&&!e)t.save(),t.translate(r,o),t.rotate(this.angle),o=r=0;for(var s=this.layout.lines,a=0,l=s.length;a<l;a++)for(var c=s[a].blocks,u=0,h=c.length;u<h;u++){var d=c[u];if(d){var p=d.style;if(0<i.strokeSize)t.font=p.getFont(),t.globalAlpha=i.strokeAlpha,t.strokeStyle=i.strokeColor,t.lineWidth=2*i.strokeSize,t.strokeText(d.text,r+d.rect.x,o+d.rect.y-this.moveDistance);if(t.font=p.getFont(),t.fillStyle=p.color,t.globalAlpha=e?1:this.opacity,0<i.shadowSize)t.globalAlpha=i.shadowAlpha,t.shadowBlur=i.shadowSize,t.shadowColor=i.shadowColor,t.shadowOffsetX=i.shadowOffsetX,t.shadowOffsetY=i.shadowOffsetY,t.fillText(d.text,r+d.rect.x,o+d.rect.y-this.moveDistance),t.shadowBlur=0,t.shadowOffsetX=0,t.shadowOffsetY=0;if(t.globalAlpha=e?1:this.opacity,t.fillText(d.text,r+d.rect.x,o+d.rect.y-this.moveDistance),p.underline){t.strokeStyle=p.color;var f=d.rect.x,m=o+d.rect.y+d.rect.height-this.moveDistance;t.beginPath(),t.moveTo(f,m),t.lineTo(f+d.rect.width,m),t.stroke()}if(p.deleteline){t.strokeStyle=p.color;var g=d.rect.x,y=o+d.rect.y+.5*d.rect.height-this.moveDistance;t.beginPath(),t.moveTo(g,y),t.lineTo(g+d.rect.width,y),t.stroke()}}}if(0!==this.angle||e)t.restore();this.last_render_tick=this.runtime.tickcount},i.drawGL=function(t){if(!(this.width<1||this.height<1)){var e=this.text_changed||this.need_text_redraw;this.need_text_redraw=!1;var i=this.layer.getScale(),n=this.layer.getAngle(),r=this.rcTex,o=i*this.width,s=i*this.height;if(1===this.cutMode)s=Math.min(this.runtime.height,t.maxTextureSize);var a=Math.ceil(o),l=Math.ceil(s),c=this.runtime.draw_width/2,u=this.runtime.draw_height/2;if(!this.myctx)this.mycanvas=document.createElement("canvas"),this.mycanvas.width=a,this.mycanvas.height=l,this.lastwidth=a,this.lastheight=l,e=!0,this.myctx=this.mycanvas.getContext("2d");if(a!==this.lastwidth||l!==this.lastheight){if(this.mycanvas.width=a,this.mycanvas.height=l,this.mytex)t.deleteTexture(this.mytex),this.mytex=null;e=!0}this.style;if(e){if(this.myctx.clearRect(0,0,a,l),this.draw(this.myctx,!0),!this.mytex)this.mytex=t.createEmptyTexture(a,l,this.runtime.linearSampling,this.runtime.isMobile);t.videoToTexture(this.mycanvas,this.mytex,this.runtime.isMobile)}this.lastwidth=a,this.lastheight=l,t.setTexture(this.mytex),t.setOpacity(this.opacity),t.resetModelView(),t.translate(-c,-u),t.updateModelView();var h=this.bquad,d=this.layer.layerToCanvas(h.tlx,h.tly,!0,!0),p=this.layer.layerToCanvas(h.tlx,h.tly,!1,!0),f=this.layer.layerToCanvas(h.trx,h.try_,!0,!0),m=this.layer.layerToCanvas(h.trx,h.try_,!1,!0),g=this.layer.layerToCanvas(h.brx,h.bry,!0,!0),y=this.layer.layerToCanvas(h.brx,h.bry,!1,!0),v=this.layer.layerToCanvas(h.blx,h.bly,!0,!0),b=this.layer.layerToCanvas(h.blx,h.bly,!1,!0);if(this.runtime.pixel_rounding||0===this.angle&&0===n){var _=(d+.5|0)-d,w=(p+.5|0)-p;d+=_,p+=w,f+=_,m+=w,g+=_,y+=w,v+=_,b+=w}if(0===this.angle&&0===n)g=f=d+a,v=d,b=y=(m=p)+l,r.right=1,r.bottom=1;else r.right=o/a,r.bottom=s/l;t.quadTex(d,p,f,m,g,y,v,b,r),t.resetModelView(),t.scale(i,i),t.rotateZ(-this.layer.getAngle()),t.translate((this.layer.viewLeft+this.layer.viewRight)/-2,(this.layer.viewTop+this.layer.viewBottom)/-2),t.updateModelView(),this.last_render_tick=this.runtime.tickcount}},i.getDebuggerValues=function(t){t.push({title:"Text",properties:[{name:"Text",value:this.layout.text},{name:"Font",value:this.style.getFont()},{name:"Line height",value:this.layout.lineSpace}]})},i.onDebugValueEdited=function(t,e,i){if("Text"===e)this.layout.text=i;else if("Font"===e)this.style.fontFamily=e,this.updateFont();else if("Line height"===e)this.layout.lineSpace=i;this.text_changed=!0},n.prototype.CompareText=function(t,e){if(e)return this.layout.text==t;else return drama.equals_nocase(this.layout.text,t)},t.cnds=new n,r.prototype.SetFontStyle=function(t,e,i,n,r){var o=drama.GetRValue(r),s=drama.GetGValue(r),a=drama.GetBValue(r),l=drama.GetAValue(r),c=xf.hexaDecimal([o,s,a,l]);if(c!==this.style.color)this.style.color=c,this.updateFont();if(1===i&&this.style.size!==n)this.style.size=n,this.updateFont();var u=!1,h=!1;switch(e){case 1:u=!0;break;case 2:h=!0;break;case 3:h=u=!0}if(t!==this.style.fontFamily||this.style.isBold!==u||this.style.isItalic!==h)this.style.fontFamily=t,this.style.isBold=u,this.style.isItalic=h,this.opacity=l,this.updateFont()},r.prototype.SetText=function(t){if(drama.is_number(t)&&t<1e9)t=Math.round(1e10*t)/1e10;var e=t.toString();if(this.layout.text!==e)this.layout.text=e,this.text_changed=!0,this.isLayout=!0,this.runtime.redraw=!0},r.prototype.AppendText=function(t){if(drama.is_number(t))t=Math.round(1e10*t)/1e10;var e=t.toString();if(e)this.layout.text+=e,this.text_changed=!0,this.runtime.redraw=!0},r.prototype.SetFontFace=function(t,e){var i=!1,n=!1;switch(e){case 1:i=!0;break;case 2:n=!0;break;case 3:n=i=!0}if(t!==this.style.fontFamily||this.style.isBold!==i||this.style.isItalic!==n)this.style.fontFamily=t,this.style.isBold=i,this.style.isItalic=n,this.updateFont()},r.prototype.SetFontSize=function(t){if(this.style.size!==t)this.style.size=t,this.updateFont()},r.prototype.SetFontColor=function(t){var e=drama.GetRValue(t),i=drama.GetGValue(t),n=drama.GetBValue(t),r=drama.GetAValue(t),o=xf.hexaDecimal([e,i,n,r]);if(o!==this.style.color)this.style.color=o,this.text_changed=!0,this.need_text_redraw=!0,this.runtime.redraw=!0},r.prototype.SetWebFont=function(t,e){var i=this,n=function(){i.runtime.redraw=!0,i.text_changed=!0};if(!l.hasOwnProperty(e)){var r=document.createElement("link");r.href=e,r.rel="stylesheet",r.type="text/css",r.onload=n,document.getElementsByTagName("head")[0].appendChild(r),l[e]=!0,this.style.fontFamily="'"+t+"'",this.updateFont();for(var o=1;o<10;o++)setTimeout(n,100*o),setTimeout(n,1e3*o);log("Requesting web font '"+e+"'... (tick "+this.runtime.tickcount.toString()+")")}else{var s="'"+t+"'";if(this.style.fontFamily===s)return;this.style.fontFamily=s,this.updateFont();for(var a=1;a<10;a++)setTimeout(n,100*a),setTimeout(n,1e3*a)}},r.prototype.SetEffect=function(t){this.blend_mode=t,this.compositeOp=drama.effectToCompositeOp(t),drama.setGLBlend(this,t,this.runtime.gl),this.runtime.redraw=!0},t.acts=new r,o.prototype.Text=function(t){t.set_string(this.layout.text)},o.prototype.FaceName=function(t){t.set_string(this.style.fontFamily)},o.prototype.FaceSize=function(t){t.set_int(this.style.size)},o.prototype.TextWidth=function(t){t.set_int(this.layout.textWidth)},o.prototype.TextHeight=function(t){t.set_int(this.layout.textHeight)},t.exps=new o}(),assert2(drama,"drama namespace not created"),assert2(drama.plugins_,"drama.plugins_ not created"),drama.plugins_.TextBox=function(t){this.runtime=t},function(){var t=drama.plugins_.TextBox.prototype;t.Type=function(t){this.plugin=t,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t){this.type=t,this.runtime=t.runtime};var e=t.Instance.prototype,r=["text","password","email","number","tel","url"];if(-1<navigator.userAgent.indexOf("MSIE 9"))r[2]="text",r[3]="text",r[4]="text",r[5]="text";function i(){}function n(){}function o(){}e.onCreate=function(){if(6===this.properties[7])this.elem=document.createElement("textarea"),this.elem.style.resize="none";else this.elem=document.createElement("input"),this.elem.type=r[this.properties[7]];if(this.elem.id=this.properties[9],document.body.appendChild(this.elem),this.elem.autocomplete="off",this.elem.value=this.properties[0],this.elem.placeholder=this.properties[1],this.elem.title=this.properties[2],this.elem.disabled=!this.properties[4],this.elem.readOnly=this.properties[5],this.elem.spellcheck=this.properties[6],this.autoFontSize=this.properties[8],this.element_hidden=!1,!this.properties[3])this.elem.style.display="none",this.visible=!1,this.element_hidden=!0;var t,e,i,n=(t=this,function(){t.runtime.trigger(drama.plugins_.TextBox.prototype.cnds.OnTextChanged,t)});if(this.elem.oninput=n,-1!==navigator.userAgent.indexOf("MSIE"))this.elem.oncut=n;this.elem.onclick=(e=this,function(t){t.stopPropagation(),e.runtime.isInUserInputEvent=!0,e.runtime.trigger(drama.plugins_.TextBox.prototype.cnds.OnClicked,e),e.runtime.isInUserInputEvent=!1}),this.elem.ondblclick=(i=this,function(t){t.stopPropagation(),i.runtime.isInUserInputEvent=!0,i.runtime.trigger(drama.plugins_.TextBox.prototype.cnds.OnDoubleClicked,i),i.runtime.isInUserInputEvent=!1}),this.elem.addEventListener("touchstart",function(t){t.stopPropagation()},!1),this.elem.addEventListener("touchmove",function(t){t.stopPropagation()},!1),this.elem.addEventListener("touchend",function(t){t.stopPropagation()},!1),this.elem.addEventListener("mousedown",function(t){t.stopPropagation()}),this.elem.addEventListener("mouseup",function(t){t.stopPropagation()}),this.elem.addEventListener("keydown",function(t){if(13!==t.which&&27!=t.which)t.stopPropagation()}),this.elem.addEventListener("keyup",function(t){if(13!==t.which&&27!=t.which)t.stopPropagation()}),this.lastLeft=0,this.lastTop=0,this.lastRight=0,this.lastBottom=0,this.lastWinWidth=0,this.lastWinHeight=0,this.updatePosition(!0),this.runtime.tickMe(this)},e.saveToJSON=function(){return{text:this.elem.value,placeholder:this.elem.placeholder,tooltip:this.elem.title,disabled:!!this.elem.disabled,readonly:!!this.elem.readOnly,spellcheck:!!this.elem.spellcheck}},e.loadFromJSON=function(t){this.elem.value=t.text,this.elem.placeholder=t.placeholder,this.elem.title=t.tooltip,this.elem.disabled=t.disabled,this.elem.readOnly=t.readonly,this.elem.spellcheck=t.spellcheck},e.onDestroy=function(){this.elem.parentElement.removeChild(this.elem),this.elem=null},e.tick=function(){this.updatePosition()},e.updatePosition=function(t){var e=this.layer.layerToCanvas(this.x,this.y,!0),i=this.layer.layerToCanvas(this.x,this.y,!1),n=this.layer.layerToCanvas(this.x+this.width,this.y+this.height,!0),r=this.layer.layerToCanvas(this.x+this.width,this.y+this.height,!1),o=this.runtime.width/this.runtime.devicePixelRatio,s=this.runtime.height/this.runtime.devicePixelRatio;if(!(!this.visible||!this.layer.visible||n<=0||r<=0||o<=e||s<=i)){if(e<1)e=1;if(i<1)i=1;if(o<=n)n=o-1;if(s<=r)r=s-1;var a=window.innerWidth,l=window.innerHeight;if(t||this.lastLeft!==e||this.lastTop!==i||this.lastRight!==n||this.lastBottom!==r||this.lastWinWidth!==a||this.lastWinHeight!==l){if(this.lastLeft=e,this.lastTop=i,this.lastRight=n,this.lastBottom=r,this.lastWinWidth=a,this.lastWinHeight=l,this.element_hidden)this.elem.style.display="",this.element_hidden=!1;var c=Math.round(e)+this.runtime.canvas.offsetLeft,u=Math.round(i)+this.runtime.canvas.offsetTop;if(this.elem.style.position="absolute",this.elem.style.left=c+"px",this.elem.style.top=u+"px",this.elem.style.width=Math.round(n-e)+"px",this.elem.style.height=Math.round(r-i)+"px",this.autoFontSize)this.elem.style.fontSize=this.layer.getScale(!0)/this.runtime.devicePixelRatio-.2+"em"}else if(this.element_hidden)this.elem.style.display="",this.element_hidden=!1}else{if(!this.element_hidden)this.elem.style.display="none";this.element_hidden=!0}},e.draw=function(t){},e.drawGL=function(t){},e.getDebuggerValues=function(t){t.push({title:"Textbox",properties:[{name:"Text",value:this.elem.value},{name:"Placeholder",value:this.elem.placeholder},{name:"Tooltip",value:this.elem.title},{name:"Enabled",value:!this.elem.disabled},{name:"Read-only",value:!!this.elem.readOnly},{name:"Spellcheck",value:!!this.elem.spellcheck}]})},e.onDebugValueEdited=function(t,e,i){switch(e){case"Text":this.elem.value=i;break;case"Placeholder":this.elem.placeholder=i;break;case"Tooltip":this.elem.title=i;break;case"Enabled":this.elem.disabled=!i;break;case"Read-only":this.elem.readOnly=i;break;case"Spellcheck":this.elem.spellcheck=i}},i.prototype.CompareText=function(t,e){if(0===e)return drama.equals_nocase(this.elem.value,t);else return this.elem.value===t},i.prototype.OnTextChanged=function(){return!0},i.prototype.OnClicked=function(){return!0},i.prototype.OnDoubleClicked=function(){return!0},t.cnds=new i,n.prototype.SetText=function(t){this.elem.value=t},n.prototype.SetPlaceholder=function(t){this.elem.placeholder=t},n.prototype.SetTooltip=function(t){this.elem.title=t},n.prototype.SetVisible=function(t){this.visible=0!==t},n.prototype.SetEnabled=function(t){this.elem.disabled=0===t},n.prototype.SetReadOnly=function(t){this.elem.readOnly=0===t},n.prototype.SetFocus=function(){this.elem.focus()},n.prototype.SetBlur=function(){this.elem.blur()},n.prototype.SetCSSStyle=function(t,e){this.elem.style[drama.cssToCamelCase(t)]=e},n.prototype.ScrollToBottom=function(){this.elem.scrollTop=this.elem.scrollHeight},t.acts=new n,o.prototype.Text=function(t){t.set_string(this.elem.value)},t.exps=new o}(),assert2(drama,"drama namespace not created"),assert2(drama.plugins_,"drama.plugins_ not created"),drama.plugins_.TiledBg=function(t){this.runtime=t},function(){var t=drama.plugins_.TiledBg.prototype;t.Type=function(t){this.plugin=t,this.runtime=t.runtime};var e=t.Type.prototype;e.onCreate=function(){if(!this.is_family)this.runtime.xfLoadC2Image(this,this.texture_file,this.texture_filesize),this.pattern=null,this.webGL_texture=null},e.onLostWebGLContext=function(){if(!this.is_family)this.webGL_texture=null},e.onRestoreWebGLContext=function(){if(!this.is_family&&this.instances.length){if(!this.webGL_texture)this.webGL_texture=this.runtime.glwrap.loadTexture(this.texture_img,!0,this.runtime.linearSampling,this.texture_pixelformat);var t,e;for(t=0,e=this.instances.length;t<e;t++)this.instances[t].webGL_texture=this.webGL_texture}},e.loadTextures=function(){if(!this.is_family&&!this.webGL_texture&&this.runtime.glwrap){if(!this.texture_img)this.runtime.sectionAlert(this.name);this.webGL_texture=this.runtime.glwrap.loadTexture(this.texture_img,!0,this.runtime.linearSampling,this.texture_pixelformat)}},e.unloadTextures=function(){if(!this.is_family&&!this.instances.length&&this.webGL_texture)this.runtime.glwrap.deleteTexture(this.webGL_texture),this.webGL_texture=null},e.preloadCanvas2D=function(t){t.drawImage(this.texture_img,0,0)},t.Instance=function(t){this.type=t,this.runtime=t.runtime};var i=t.Instance.prototype;function n(){}function r(){}function o(){}i.onCreate=function(){if(this.visible=this.properties[0],this.rcTex=new drama.rect(0,0,0,0),this.has_own_texture=!1,this.texture_img=this.type.texture_img,this.runtime.glwrap)this.type.loadTextures(),this.webGL_texture=this.type.webGL_texture;else{if(!this.type.texture_img)this.runtime.sectionAlert(this.type.name);if(!this.type.pattern)this.type.pattern=this.runtime.ctx.createPattern(this.type.texture_img,"repeat");this.pattern=this.type.pattern}},i.afterLoad=function(){this.has_own_texture=!1,this.texture_img=this.type.texture_img},i.onDestroy=function(){if(this.runtime.glwrap&&this.has_own_texture&&this.webGL_texture)this.runtime.glwrap.deleteTexture(this.webGL_texture),this.webGL_texture=null},i.draw=function(t){t.globalAlpha=this.opacity,t.save(),t.fillStyle=this.pattern;var e=this.x,i=this.y;if(this.runtime.pixel_rounding)e=Math.round(e),i=Math.round(i);var n=-this.hotspotX*this.width,r=-this.hotspotY*this.height,o=n%this.texture_img.width,s=r%this.texture_img.height;if(o<0)o+=this.texture_img.width;if(s<0)s+=this.texture_img.height;t.translate(e,i),t.rotate(this.angle),t.translate(o,s),t.fillRect(n-o,r-s,this.width,this.height),t.restore()},i.drawGL_earlyZPass=function(t){this.drawGL(t)},i.drawGL=function(t){t.setTexture(this.webGL_texture),t.setOpacity(this.opacity);var e=this.rcTex;e.right=this.width/this.texture_img.width,e.bottom=this.height/this.texture_img.height;var i=this.bquad;if(this.runtime.pixel_rounding){var n=Math.round(this.x)-this.x,r=Math.round(this.y)-this.y;t.quadTex(i.tlx+n,i.tly+r,i.trx+n,i.try_+r,i.brx+n,i.bry+r,i.blx+n,i.bly+r,e)}else t.quadTex(i.tlx,i.tly,i.trx,i.try_,i.brx,i.bry,i.blx,i.bly,e)},n.prototype.OnURLLoaded=function(){return!0},t.cnds=new n,r.prototype.SetEffect=function(t){this.blend_mode=t,this.compositeOp=drama.effectToCompositeOp(t),drama.setGLBlend(this,t,this.runtime.gl),this.runtime.redraw=!0},r.prototype.LoadURL=function(t,e){var i=new Image,n=this;if(i.onload=function(){if(n.texture_img=i,n.runtime.glwrap){if(n.has_own_texture&&n.webGL_texture)n.runtime.glwrap.deleteTexture(n.webGL_texture);n.webGL_texture=n.runtime.glwrap.loadTexture(i,!0,n.runtime.linearSampling)}else n.pattern=n.runtime.ctx.createPattern(i,"repeat");n.has_own_texture=!0,n.runtime.redraw=!0,n.runtime.trigger(drama.plugins_.TiledBg.prototype.cnds.OnURLLoaded,n)},"data:"!==t.substr(0,5)&&0===e)i.crossOrigin="anonymous";this.runtime.setImageSrc(i,t)},t.acts=new r,o.prototype.ImageWidth=function(t){t.set_float(this.texture_img.width)},o.prototype.ImageHeight=function(t){t.set_float(this.texture_img.height)},t.exps=new o}(),assert2(drama,"drama namespace not created"),assert2(drama.plugins_,"drama.plugins_ not created"),drama.plugins_.Touch=function(t){this.runtime=t},function(){var t=drama.plugins_.Touch.prototype;t.Type=function(t){this.plugin=t,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t){this.type=t,this.runtime=t.runtime,this.touches=[],this.mouseDown=!1};var c=0,e=t.Instance.prototype;e.findTouch=function(t){var e,i;for(e=0,i=this.touches.length;e<i;e++)if(this.touches[e].id===t)return e;return-1};var i=0,n=0,r=0;function a(t){i=t.x,n=t.y,r=t.z}var o=[];function u(t,e,i,n){var r;if(o.length)r=o.pop();else r=new l;return r.init(t,e,i,n),r}function s(t){if(o.length<100)o.push(t)}function l(){this.starttime=0,this.time=0,this.lasttime=0,this.startx=0,this.starty=0,this.x=0,this.y=0,this.lastx=0,this.lasty=0,this.id=0,this.startindex=0,this.triggeredHold=!1,this.tooFarForHold=!1}l.prototype.init=function(t,e,i,n){var r=drama.performance_now();this.time=r,this.lasttime=r,this.starttime=r,this.startx=t,this.starty=e,this.x=t,this.y=e,this.lastx=t,this.lasty=e,this.width=0,this.height=0,this.pressure=0,this.id=i,this.startindex=n,this.triggeredHold=!1,this.tooFarForHold=!1},l.prototype.update=function(t,e,i,n,r,o){if(this.lasttime=this.time,this.time=t,this.lastx=this.x,this.lasty=this.y,this.x=e,this.y=i,this.width=n,this.height=r,this.pressure=o,!this.tooFarForHold&&15<=drama.distanceTo(this.startx,this.starty,this.x,this.y))this.tooFarForHold=!0},l.prototype.maybeTriggerHold=function(t,e){if(!this.triggeredHold){if(500<=drama.performance_now()-this.starttime&&!this.tooFarForHold&&drama.distanceTo(this.startx,this.starty,this.x,this.y)<15)this.triggeredHold=!0,c|=8,t.trigger_index=this.startindex,t.trigger_id=this.id,t.getTouchIndex=e,t.runtime.trigger(drama.plugins_.Touch.prototype.cnds.OnHoldGesture,t),t.curTouchX=this.x,t.curTouchY=this.y,t.runtime.trigger(drama.plugins_.Touch.prototype.cnds.OnHoldGestureObject,t),t.runtime.trigger(drama.plugins_.Touch.prototype.cnds.OnKindsTapObject,t),t.getTouchIndex=0,c&=-9}};var h=-1e3,d=-1e3,p=-1e4;function f(t){return t.sourceCapabilities&&t.sourceCapabilities.firesTouchEvents||t.originalEvent&&t.originalEvent.sourceCapabilities&&t.originalEvent.sourceCapabilities.firesTouchEvents}function m(){}l.prototype.maybeTriggerTap=function(t,e){if(!this.triggeredHold){var i=drama.performance_now();if(i-this.starttime<=333&&!this.tooFarForHold&&drama.distanceTo(this.startx,this.starty,this.x,this.y)<15){if(t.trigger_index=this.startindex,t.trigger_id=this.id,t.getTouchIndex=e,i-p<=666&&drama.distanceTo(h,d,this.x,this.y)<25)c|=2,t.runtime.trigger(drama.plugins_.Touch.prototype.cnds.OnDoubleTapGesture,t),t.curTouchX=this.x,t.curTouchY=this.y,t.runtime.trigger(drama.plugins_.Touch.prototype.cnds.OnDoubleTapGestureObject,t),t.runtime.trigger(drama.plugins_.Touch.prototype.cnds.OnKindsTapObject,t),d=h=-1e3,p=-1e4,c&=-3;else c|=1,t.runtime.trigger(drama.plugins_.Touch.prototype.cnds.OnTapGesture,t),t.curTouchX=this.x,t.curTouchY=this.y,t.runtime.trigger(drama.plugins_.Touch.prototype.cnds.OnTapGestureObject,t),t.runtime.trigger(drama.plugins_.Touch.prototype.cnds.OnKindsTapObject,t),h=this.x,d=this.y,p=i,c&=-2;t.getTouchIndex=0}}},e.onCreate=function(){this.isWindows8=!(void 0===window.c2isWindows8||!window.c2isWindows8),this.orient_alpha=0,this.orient_beta=0,this.orient_gamma=0,this.acc_g_x=0,this.acc_g_y=0,this.acc_g_z=0,this.acc_x=0,this.acc_y=0,this.acc_z=0,this.curTouchX=0,this.curTouchY=0,this.trigger_index=0,this.trigger_id=0,this.getTouchIndex=0,this.useMouseInput=this.properties[0],this.audio=this.properties[1],this.isInitAudio=!1;var t=0<this.runtime.fullscreen_mode?document:this.runtime.canvas,e=document;if(this.runtime.isMinigame)t=this.runtime.canvas;var i=this;if("undefined"!=typeof PointerEvent){if(t.addEventListener("pointerdown",function(t){i.playAudio(),i.onPointerStart(t)},!1),t.addEventListener("pointermove",function(t){i.onPointerMove(t)},!1),e.addEventListener("pointerup",function(t){i.onPointerEnd(t,!1)},!1),e.addEventListener("pointercancel",function(t){i.onPointerEnd(t,!0)},!1),this.runtime.canvas)this.runtime.canvas.addEventListener("MSGestureHold",function(t){t.preventDefault()},!1),document.addEventListener("MSGestureHold",function(t){t.preventDefault()},!1),this.runtime.canvas.addEventListener("gesturehold",function(t){t.preventDefault()},!1),document.addEventListener("gesturehold",function(t){t.preventDefault()},!1)}else if(window.navigator.msPointerEnabled){if(t.addEventListener("MSPointerDown",function(t){i.playAudio(),i.onPointerStart(t)},!1),t.addEventListener("MSPointerMove",function(t){i.onPointerMove(t)},!1),e.addEventListener("MSPointerUp",function(t){i.onPointerEnd(t,!1)},!1),e.addEventListener("MSPointerCancel",function(t){i.onPointerEnd(t,!0)},!1),this.runtime.canvas)this.runtime.canvas.addEventListener("MSGestureHold",function(t){t.preventDefault()},!1),document.addEventListener("MSGestureHold",function(t){t.preventDefault()},!1)}else{if(xf.getSupportsPassive())t.addEventListener("touchstart",function(t){i.playAudio(),i.onTouchStart(t)},{passive:!0}),t.addEventListener("touchmove",function(t){i.onTouchMove(t)},{passive:!0});else t.addEventListener("touchstart",function(t){i.playAudio(),i.onTouchStart(t)},!1),t.addEventListener("touchmove",function(t){i.onTouchMove(t)},!1);if(this.runtime.isMinigame)t.addEventListener("touchend",function(t){i.onTouchEnd(t,!1)},!1),t.addEventListener("touchcancel",function(t){i.onTouchEnd(t,!0)},!1);else e.addEventListener("touchend",function(t){i.onTouchEnd(t,!1)},!1),e.addEventListener("touchcancel",function(t){i.onTouchEnd(t,!0)},!1)}if(this.isWindows8){var n=function(t){var e=t.reading;i.acc_x=e.accelerationX,i.acc_y=e.accelerationY,i.acc_z=e.accelerationZ},r=function(t){var e=t.reading;i.orient_alpha=e.yawDegrees,i.orient_beta=e.pitchDegrees,i.orient_gamma=e.rollDegrees},o=Windows.Devices.Sensors.Accelerometer.getDefault();if(o)o.reportInterval=Math.max(o.minimumReportInterval,16),o.addEventListener("readingchanged",n);var s=Windows.Devices.Sensors.Inclinometer.getDefault();if(s)s.reportInterval=Math.max(s.minimumReportInterval,16),s.addEventListener("readingchanged",r);document.addEventListener("visibilitychange",function(t){if(document.hidden||document.msHidden){if(o)o.removeEventListener("readingchanged",n);if(s)s.removeEventListener("readingchanged",r)}else{if(o)o.addEventListener("readingchanged",n);if(s)s.addEventListener("readingchanged",r)}},!1)}else window.addEventListener("deviceorientation",function(t){i.orient_alpha=t.alpha||0,i.orient_beta=t.beta||0,i.orient_gamma=t.gamma||0},!1),window.addEventListener("devicemotion",function(t){if(t.accelerationIncludingGravity)i.acc_g_x=t.accelerationIncludingGravity.x||0,i.acc_g_y=t.accelerationIncludingGravity.y||0,i.acc_g_z=t.accelerationIncludingGravity.z||0;if(t.acceleration)i.acc_x=t.acceleration.x||0,i.acc_y=t.acceleration.y||0,i.acc_z=t.acceleration.z||0},!1);if(this.useMouseInput)document.addEventListener("mousemove",function(t){i.onMouseMove(t)}),document.addEventListener("mousedown",function(t){i.onMouseDown(t)}),document.addEventListener("mouseup",function(t){i.onMouseUp(t)});if(!this.runtime.isiOS&&this.runtime.isCordova&&navigator.accelerometer&&navigator.accelerometer.watchAcceleration)navigator.accelerometer.watchAcceleration(a,null,{frequency:40});this.runtime.tick2Me(this)},e.playAudio=function(){this.audioInst&&this.audioInst.Play([this.audio,!0],0,1,"xfMouseAndTouchDefaultAudio")},e.onPointerMove=function(t){if(t.pointerType!==t.MSPOINTER_TYPE_MOUSE&&"mouse"!==t.pointerType){if(t.preventDefault)t.preventDefault();var e=this.findTouch(t.pointerId),i=drama.performance_now();if(0<=e){var n=this.runtime.canvas.offsetLeft,r=this.runtime.canvas.offsetTop,o=this.touches[e],s=drama.convertPageXY(t.pageX,t.pageY);if(i-o.time<2)return;o.update(i,s.pageX-n,s.pageY-r,t.width||0,t.height||0,t.pressure||0)}}},e.onPointerStart=function(t){if(t.pointerType!==t.MSPOINTER_TYPE_MOUSE&&"mouse"!==t.pointerType){if(t.preventDefault&&drama.isCanvasInputEvent(t))t.preventDefault();var e=this.runtime.canvas.offsetLeft,i=this.runtime.canvas.offsetTop,n=drama.convertPageXY(t.pageX,t.pageY),r=n.pageX-e,o=n.pageY-i;this.trigger_index=this.touches.length,this.trigger_id=t.pointerId,this.touches.push(u(r,o,t.pointerId,this.trigger_index)),this.runtime.isInUserInputEvent=!0,this.runtime.trigger(drama.plugins_.Touch.prototype.cnds.OnNthTouchStart,this),this.runtime.trigger(drama.plugins_.Touch.prototype.cnds.OnTouchStart,this),this.curTouchX=r,this.curTouchY=o,c|=4,this.runtime.trigger(drama.plugins_.Touch.prototype.cnds.OnTouchObject,this),this.runtime.trigger(drama.plugins_.Touch.prototype.cnds.OnKindsTapObject,this),c&=-5,this.runtime.isInUserInputEvent=!1}},e.onPointerEnd=function(t,e){if(t.pointerType!==t.MSPOINTER_TYPE_MOUSE&&"mouse"!==t.pointerType){if(t.preventDefault&&drama.isCanvasInputEvent(t))t.preventDefault();var i=this.findTouch(t.pointerId);if(this.trigger_index=0<=i?this.touches[i].startindex:-1,this.trigger_id=0<=i?this.touches[i].id:-1,this.runtime.isInUserInputEvent=!0,this.runtime.trigger(drama.plugins_.Touch.prototype.cnds.OnNthTouchEnd,this),this.runtime.trigger(drama.plugins_.Touch.prototype.cnds.OnTouchEnd,this),0<=i){if(!e)this.touches[i].maybeTriggerTap(this,i);s(this.touches[i]),this.touches.splice(i,1)}this.runtime.isInUserInputEvent=!1}},e.onTouchMove=function(t){if(t.preventDefault)t.preventDefault();var e,i,n,r,o=drama.performance_now();for(e=0,i=t.changedTouches.length;e<i;e++){n=t.changedTouches[e];var s=this.findTouch(n.identifier);if(0<=s){var a=this.runtime.canvas.offsetLeft,l=this.runtime.canvas.offsetTop;if(o-(r=this.touches[s]).time<2)continue;var c=2*(n.radiusX||n.webkitRadiusX||n.mozRadiusX||n.msRadiusX||0),u=2*(n.radiusY||n.webkitRadiusY||n.mozRadiusY||n.msRadiusY||0),h=n.force||n.webkitForce||n.mozForce||n.msForce||0,d=drama.convertPageXY(n.pageX,n.pageY);r.update(o,d.pageX-a,d.pageY-l,c,u,h)}}},e.onTouchStart=function(t){if(t.preventDefault&&drama.isCanvasInputEvent(t))t.preventDefault();var e,i,n,r=this.runtime.canvas.offsetLeft,o=this.runtime.canvas.offsetTop;for(this.runtime.isInUserInputEvent=!0,e=0,i=t.changedTouches.length;e<i;e++)if(n=t.changedTouches[e],-1===this.findTouch(n.identifier)){var s=drama.convertPageXY(n.pageX,n.pageY),a=s.pageX-r,l=s.pageY-o;this.trigger_index=this.touches.length,this.trigger_id=n.identifier,this.touches.push(u(a,l,n.identifier,this.trigger_index)),this.runtime.trigger(drama.plugins_.Touch.prototype.cnds.OnNthTouchStart,this),this.runtime.trigger(drama.plugins_.Touch.prototype.cnds.OnTouchStart,this),this.curTouchX=a,this.curTouchY=l,c|=4,this.runtime.trigger(drama.plugins_.Touch.prototype.cnds.OnTouchObject,this),this.runtime.trigger(drama.plugins_.Touch.prototype.cnds.OnKindsTapObject,this),c&=-5}this.runtime.isInUserInputEvent=!1},e.onTouchEnd=function(t,e){if(t.preventDefault&&drama.isCanvasInputEvent(t))t.preventDefault();var i,n,r,o;for(this.runtime.isInUserInputEvent=!0,i=0,n=t.changedTouches.length;i<n;i++)if(r=t.changedTouches[i],0<=(o=this.findTouch(r.identifier))){if(this.trigger_index=this.touches[o].startindex,this.trigger_id=this.touches[o].id,this.runtime.trigger(drama.plugins_.Touch.prototype.cnds.OnNthTouchEnd,this),this.runtime.trigger(drama.plugins_.Touch.prototype.cnds.OnTouchEnd,this),!e)this.touches[o].maybeTriggerTap(this,o);s(this.touches[o]),this.touches.splice(o,1)}this.runtime.isInUserInputEvent=!1},e.getAlpha=function(){if(this.runtime.isCordova&&0===this.orient_alpha&&0!==r)return 90*r;else return this.orient_alpha},e.getBeta=function(){if(this.runtime.isCordova&&0===this.orient_beta&&0!==n)return 90*n;else return this.orient_beta},e.getGamma=function(){if(this.runtime.isCordova&&0===this.orient_gamma&&0!==i)return 90*i;else return this.orient_gamma},e.onMouseDown=function(t){if(!f(t)){var e={changedTouches:[{pageX:t.pageX,pageY:t.pageY,identifier:0}]};this.onTouchStart(e),this.mouseDown=!0}},e.onMouseMove=function(t){if(this.mouseDown)if(!f(t)){var e={changedTouches:[{pageX:t.pageX,pageY:t.pageY,identifier:0}]};this.onTouchMove(e)}},e.onMouseUp=function(t){if(t.preventDefault&&this.runtime.had_a_click&&!this.runtime.isMobile)t.preventDefault();if(this.runtime.had_a_click=!0,!f(t)){var e={changedTouches:[{pageX:t.pageX,pageY:t.pageY,identifier:0}]};this.onTouchEnd(e),this.mouseDown=!1}},e.tick2=function(){if(this.audio&&!this.isInitAudio)this.audioInst=xf.audioInstance(this.runtime),this.isInitAudio=!0;var t,e,i,n=drama.performance_now();for(t=0,e=this.touches.length;t<e;++t){if((i=this.touches[t]).time<=n-50)i.lasttime=n;i.maybeTriggerHold(this,t)}},e.getDebuggerValues=function(t){var e,i,n,r=[];for(e=0,i=this.touches.length;e<i;++e)n=this.touches[e],r.push({name:e.toString(),value:"("+n.x+", "+n.y+"), ID: "+n.id,readonly:!0});t.push({title:"Touches",properties:r}),t.push({title:"Orientation & motion",properties:[{name:"Alpha",value:this.getAlpha(),readonly:!0},{name:"Beta",value:this.getBeta(),readonly:!0},{name:"Gamma",value:this.getGamma(),readonly:!0},{name:"X acceleration",value:this.acc_x,readonly:!0},{name:"Y acceleration",value:this.acc_y,readonly:!0},{name:"Z acceleration",value:this.acc_z,readonly:!0},{name:"X acceleration with gravity",value:this.acc_g_x,readonly:!0},{name:"Y acceleration with gravity",value:this.acc_g_y,readonly:!0},{name:"Z acceleration with gravity",value:this.acc_g_z,readonly:!0}]})},m.prototype.OnTouchStart=function(){return!0},m.prototype.OnTouchEnd=function(){return!0},m.prototype.IsInTouch=function(){return this.touches.length},m.prototype.OnTouchObject=function(t){if(!t)return!1;else return this.runtime.testAndSelectCanvasPointOverlap(t,this.curTouchX,this.curTouchY,!1)};var g=[];function y(){}m.prototype.IsTouchingObject=function(t){if(!t)return!1;var e,i,n,r,o=t.getCurrentSol(),s=o.getObjects();for(e=0,i=s.length;e<i;e++){var a=s[e];for(a.update_bbox(),n=0,r=this.touches.length;n<r;n++){var l=this.touches[n];if(xf.checkTouchable(a,l.x,l.y)){g.push(a);break}}}if(g.length)return o.select_all=!1,drama.shallowAssignArray(o.instances,g),t.applySolToContainer(),drama.clearArray(g),!0;else return!1},m.prototype.CompareTouchSpeed=function(t,e,i){if((t=Math.floor(t))<0||t>=this.touches.length)return!1;var n=this.touches[t],r=drama.distanceTo(n.x,n.y,n.lastx,n.lasty),o=(n.time-n.lasttime)/1e3,s=0;if(0<o)s=r/o;return drama.do_cmp(s,e,i)},m.prototype.OrientationSupported=function(){return void 0!==window.DeviceOrientationEvent},m.prototype.MotionSupported=function(){return void 0!==window.DeviceMotionEvent},m.prototype.CompareOrientation=function(t,e,i){var n=0;if(0===t)n=this.getAlpha();else if(1===t)n=this.getBeta();else n=this.getGamma();return drama.do_cmp(n,e,i)},m.prototype.CompareAcceleration=function(t,e,i){var n=0;if(0===t)n=this.acc_g_x;else if(1===t)n=this.acc_g_y;else if(2===t)n=this.acc_g_z;else if(3===t)n=this.acc_x;else if(4===t)n=this.acc_y;else if(5===t)n=this.acc_z;return drama.do_cmp(n,e,i)},m.prototype.OnNthTouchStart=function(t){return(t=Math.floor(t))===this.trigger_index},m.prototype.OnNthTouchEnd=function(t){return(t=Math.floor(t))===this.trigger_index},m.prototype.HasNthTouch=function(t){return t=Math.floor(t),this.touches.length>=t+1},m.prototype.OnHoldGesture=function(){return!0},m.prototype.OnTapGesture=function(){return!0},m.prototype.OnDoubleTapGesture=function(){return!0},m.prototype.OnHoldGestureObject=function(t){if(!t)return!1;else return this.runtime.testAndSelectCanvasPointOverlap(t,this.curTouchX,this.curTouchY,!1)},m.prototype.OnTapGestureObject=function(t){if(!t)return!1;else return this.runtime.testAndSelectCanvasPointOverlap(t,this.curTouchX,this.curTouchY,!1)},m.prototype.OnDoubleTapGestureObject=function(t){return this.runtime.testAndSelectCanvasPointOverlap(t,this.curTouchX,this.curTouchY,!1)},m.prototype.OnKindsTapObject=function(t,e){if(!e)return!1;if(c&1<<t)return this.runtime.testAndSelectCanvasPointOverlap(e,this.curTouchX,this.curTouchY,!1);else return},t.cnds=new m,y.prototype.TouchCount=function(t){t.set_int(this.touches.length)},y.prototype.X=function(t,e){var i=this.getTouchIndex;if(!(i<0||i>=this.touches.length)){var n,r,o,s,a;if(drama.is_undefined(e))r=(n=this.runtime.getLayerByNumber(0)).scale,o=n.zoomRate,s=n.parallaxX,a=n.angle,n.scale=1,n.zoomRate=1,n.parallaxX=1,n.angle=0,t.set_float(n.canvasToLayer(this.touches[i].x,this.touches[i].y,!0)),n.scale=r,n.zoomRate=o,n.parallaxX=s,n.angle=a;else{if(drama.is_number(e))n=this.runtime.getLayerByNumber(e);else n=this.runtime.getLayerByName(e);if(n)t.set_float(n.canvasToLayer(this.touches[i].x,this.touches[i].y,!0));else t.set_float(0)}}else t.set_float(0)},y.prototype.XAt=function(t,e,i){if(!((e=Math.floor(e))<0||e>=this.touches.length)){var n,r,o,s,a;if(drama.is_undefined(i))r=(n=this.runtime.getLayerByNumber(0)).scale,o=n.zoomRate,s=n.parallaxX,a=n.angle,n.scale=1,n.zoomRate=1,n.parallaxX=1,n.angle=0,t.set_float(n.canvasToLayer(this.touches[e].x,this.touches[e].y,!0)),n.scale=r,n.zoomRate=o,n.parallaxX=s,n.angle=a;else{if(drama.is_number(i))n=this.runtime.getLayerByNumber(i);else n=this.runtime.getLayerByName(i);if(n)t.set_float(n.canvasToLayer(this.touches[e].x,this.touches[e].y,!0));else t.set_float(0)}}else t.set_float(0)},y.prototype.XForID=function(t,e,i){var n=this.findTouch(e);if(!(n<0)){var r,o,s,a,l,c=this.touches[n];if(drama.is_undefined(i))o=(r=this.runtime.getLayerByNumber(0)).scale,s=r.zoomRate,a=r.parallaxX,l=r.angle,r.scale=1,r.zoomRate=1,r.parallaxX=1,r.angle=0,t.set_float(r.canvasToLayer(c.x,c.y,!0)),r.scale=o,r.zoomRate=s,r.parallaxX=a,r.angle=l;else{if(drama.is_number(i))r=this.runtime.getLayerByNumber(i);else r=this.runtime.getLayerByName(i);if(r)t.set_float(r.canvasToLayer(c.x,c.y,!0));else t.set_float(0)}}else t.set_float(0)},y.prototype.Y=function(t,e){var i=this.getTouchIndex;if(!(i<0||i>=this.touches.length)){var n,r,o,s,a;if(drama.is_undefined(e))r=(n=this.runtime.getLayerByNumber(0)).scale,o=n.zoomRate,s=n.parallaxY,a=n.angle,n.scale=1,n.zoomRate=1,n.parallaxY=1,n.angle=0,t.set_float(n.canvasToLayer(this.touches[i].x,this.touches[i].y,!1)),n.scale=r,n.zoomRate=o,n.parallaxY=s,n.angle=a;else{if(drama.is_number(e))n=this.runtime.getLayerByNumber(e);else n=this.runtime.getLayerByName(e);if(n)t.set_float(n.canvasToLayer(this.touches[i].x,this.touches[i].y,!1));else t.set_float(0)}}else t.set_float(0)},y.prototype.YAt=function(t,e,i){if(!((e=Math.floor(e))<0||e>=this.touches.length)){var n,r,o,s,a;if(drama.is_undefined(i))r=(n=this.runtime.getLayerByNumber(0)).scale,o=n.zoomRate,s=n.parallaxY,a=n.angle,n.scale=1,n.zoomRate=1,n.parallaxY=1,n.angle=0,t.set_float(n.canvasToLayer(this.touches[e].x,this.touches[e].y,!1)),n.scale=r,n.zoomRate=o,n.parallaxY=s,n.angle=a;else{if(drama.is_number(i))n=this.runtime.getLayerByNumber(i);else n=this.runtime.getLayerByName(i);if(n)t.set_float(n.canvasToLayer(this.touches[e].x,this.touches[e].y,!1));else t.set_float(0)}}else t.set_float(0)},y.prototype.YForID=function(t,e,i){var n=this.findTouch(e);if(!(n<0)){var r,o,s,a,l,c=this.touches[n];if(drama.is_undefined(i))o=(r=this.runtime.getLayerByNumber(0)).scale,s=r.zoomRate,a=r.parallaxY,l=r.angle,r.scale=1,r.zoomRate=1,r.parallaxY=1,r.angle=0,t.set_float(r.canvasToLayer(c.x,c.y,!1)),r.scale=o,r.zoomRate=s,r.parallaxY=a,r.angle=l;else{if(drama.is_number(i))r=this.runtime.getLayerByNumber(i);else r=this.runtime.getLayerByName(i);if(r)t.set_float(r.canvasToLayer(c.x,c.y,!1));else t.set_float(0)}}else t.set_float(0)},y.prototype.AbsoluteX=function(t){if(this.touches.length)t.set_float(this.touches[0].x);else t.set_float(0)},y.prototype.AbsoluteXAt=function(t,e){if(!((e=Math.floor(e))<0||e>=this.touches.length))t.set_float(this.touches[e].x);else t.set_float(0)},y.prototype.AbsoluteXForID=function(t,e){var i=this.findTouch(e);if(!(i<0)){var n=this.touches[i];t.set_float(n.x)}else t.set_float(0)},y.prototype.AbsoluteY=function(t){if(this.touches.length)t.set_float(this.touches[0].y);else t.set_float(0)},y.prototype.AbsoluteYAt=function(t,e){if(!((e=Math.floor(e))<0||e>=this.touches.length))t.set_float(this.touches[e].y);else t.set_float(0)},y.prototype.AbsoluteYForID=function(t,e){var i=this.findTouch(e);if(!(i<0)){var n=this.touches[i];t.set_float(n.y)}else t.set_float(0)},y.prototype.SpeedAt=function(t,e){if(!((e=Math.floor(e))<0||e>=this.touches.length)){var i=this.touches[e],n=drama.distanceTo(i.x,i.y,i.lastx,i.lasty),r=(i.time-i.lasttime)/1e3;if(r<=0)t.set_float(0);else t.set_float(n/r)}else t.set_float(0)},y.prototype.SpeedForID=function(t,e){var i=this.findTouch(e);if(!(i<0)){var n=this.touches[i],r=drama.distanceTo(n.x,n.y,n.lastx,n.lasty),o=(n.time-n.lasttime)/1e3;if(o<=0)t.set_float(0);else t.set_float(r/o)}else t.set_float(0)},y.prototype.AngleAt=function(t,e){if(!((e=Math.floor(e))<0||e>=this.touches.length)){var i=this.touches[e];t.set_float(drama.to_degrees(drama.angleTo(i.lastx,i.lasty,i.x,i.y)))}else t.set_float(0)},y.prototype.AngleForID=function(t,e){var i=this.findTouch(e);if(!(i<0)){var n=this.touches[i];t.set_float(drama.to_degrees(drama.angleTo(n.lastx,n.lasty,n.x,n.y)))}else t.set_float(0)},y.prototype.Alpha=function(t){t.set_float(this.getAlpha())},y.prototype.Beta=function(t){t.set_float(this.getBeta())},y.prototype.Gamma=function(t){t.set_float(this.getGamma())},y.prototype.AccelerationXWithG=function(t){t.set_float(this.acc_g_x)},y.prototype.AccelerationYWithG=function(t){t.set_float(this.acc_g_y)},y.prototype.AccelerationZWithG=function(t){t.set_float(this.acc_g_z)},y.prototype.AccelerationX=function(t){t.set_float(this.acc_x)},y.prototype.AccelerationY=function(t){t.set_float(this.acc_y)},y.prototype.AccelerationZ=function(t){t.set_float(this.acc_z)},y.prototype.TouchIndex=function(t){t.set_int(this.trigger_index)},y.prototype.TouchID=function(t){t.set_float(this.trigger_id)},y.prototype.WidthForID=function(t,e){var i=this.findTouch(e);if(!(i<0)){var n=this.touches[i];t.set_float(n.width)}else t.set_float(0)},y.prototype.HeightForID=function(t,e){var i=this.findTouch(e);if(!(i<0)){var n=this.touches[i];t.set_float(n.height)}else t.set_float(0)},y.prototype.PressureForID=function(t,e){var i=this.findTouch(e);if(!(i<0)){var n=this.touches[i];t.set_float(n.pressure)}else t.set_float(0)},t.exps=new y}(),assert2(drama,"drama namespace not created"),assert2(drama.plugins_,"drama.plugins_ not created"),drama.plugins_.Twitter=function(t){this.runtime=t},function(){var t=drama.plugins_.Twitter.prototype;t.Type=function(t){this.plugin=t,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t){this.type=t,this.runtime=t.runtime};var e=t.Instance.prototype,o=!0;function i(t,e){var i;o=!1;var n="none";if(1===e.buttonCount)n="horizontal";else if(2===e.buttonCount)n="vertical";var r=0===e.buttonSize?"medium":"large";if(0===e.buttonType)t.widgets.createFollowButton(e.buttonShare,e.elem,function(){s(e)},{count:n,size:r,lang:e.buttonLang});else if(1===e.buttonType){if(i={count:n,size:r,lang:e.buttonLang,text:e.buttonText},e.buttonVia)i.via=e.buttonVia;if(e.buttonHashtags)i.hashtags=e.buttonHashtags;t.widgets.createShareButton(e.buttonShare,e.elem,function(){s(e)},i)}else if(2===e.buttonType){if(i={count:n,size:r,lang:e.buttonLang,text:e.buttonText},e.buttonVia)i.via=e.buttonVia;if(e.buttonHashtags)i.hashtags=e.buttonHashtags;t.widgets.createMentionButton(e.buttonShare,e.elem,function(){s(e)},i)}else if(3===e.buttonType){if(i={count:n,size:r,lang:e.buttonLang,text:e.buttonText},e.buttonVia)i.via=e.buttonVia;if(e.buttonHashtags)i.hashtags=e.buttonHashtags;t.widgets.createHashtagButton(e.buttonShare,e.elem,function(){s(e)},i)}}function s(t){t.runtime.trigger(drama.plugins_.Twitter.prototype.cnds.OnLoaded,t)}function n(){}function r(){}e.onCreate=function(){if(this.elem=document.createElement("div"),document.body.appendChild(this.elem),this.element_hidden=!1,this.buttonType=this.properties[0],this.buttonShare=this.properties[1],this.buttonText=this.properties[2],this.buttonVia=this.properties[3],this.buttonHashtags=this.properties[4],!this.properties[5])this.elem.style.display="none",this.visible=!1,this.element_hidden=!0;this.buttonCount=this.properties[6],this.buttonSize=this.properties[7],this.buttonLang=this.properties[8]||"en",this.lastLeft=0,this.lastTop=0,this.lastRight=0,this.lastBottom=0,this.lastWinWidth=0,this.lastWinHeight=0,this.updatePosition(!0),this.runtime.tickMe(this);var e=this;if(!window.twttr)window.twttr=function(t,e,i){var n,r,o=t.getElementsByTagName("script")[0];if(!t.getElementById(i))return(r=t.createElement("script")).id=i,r.src="https://platform.twitter.com/widgets.js",o.parentNode.insertBefore(r,o),window.twttr||(n={_e:[],ready:function(t){n._e.push(t)}})}(document,0,"twitter-wjs"),window.twttr.ready(function(t){i(t,e)});else if(o)window.twttr.ready(function(t){i(t,e)});else i(window.twttr,e)},e.saveToJSON=function(){return{}},e.loadFromJSON=function(t){},e.onDestroy=function(){this.elem.parentElement.removeChild(this.elem),this.elem=null},e.tick=function(){this.updatePosition()},e.updatePosition=function(t){var e=this.layer.layerToCanvas(this.x,this.y,!0),i=this.layer.layerToCanvas(this.x,this.y,!1),n=this.layer.layerToCanvas(this.x+this.width,this.y+this.height,!0),r=this.layer.layerToCanvas(this.x+this.width,this.y+this.height,!1);if(!(!this.visible||!this.layer.visible||n<=0||r<=0||e>=this.runtime.width||i>=this.runtime.height)){if(e<1)e=1;if(i<1)i=1;if(n>=this.runtime.width)n=this.runtime.width-1;if(r>=this.runtime.height)r=this.runtime.height-1;var o=window.innerWidth,s=window.innerHeight;if(t||this.lastLeft!==e||this.lastTop!==i||this.lastRight!==n||this.lastBottom!==r||this.lastWinWidth!==o||this.lastWinHeight!==s){if(this.lastLeft=e,this.lastTop=i,this.lastRight=n,this.lastBottom=r,this.lastWinWidth=o,this.lastWinHeight=s,this.element_hidden)this.elem.style.display="",this.element_hidden=!1;var a=Math.round(e)+this.runtime.canvas.offsetLeft,l=Math.round(i)+this.runtime.canvas.offsetTop;this.elem.style.position="absolute",this.elem.style.left=a+"px",this.elem.style.top=l+"px",this.elem.style.width=Math.round(n-e)+"px",this.elem.style.height=Math.round(r-i)+"px"}else if(this.element_hidden)this.elem.style.display="",this.element_hidden=!1}else{if(!this.element_hidden)this.elem.style.display="none";this.element_hidden=!0}},e.draw=function(t){},e.drawGL=function(t){},e.getDebuggerValues=function(t){},e.onDebugValueEdited=function(t,e,i){},n.prototype.OnLoaded=function(){return!0},t.cnds=new n,r.prototype.SetVisible=function(t){this.visible=0!==t},r.prototype.SetShare=function(t){this.buttonShare=t},r.prototype.SetText=function(t){this.buttonText=t},r.prototype.SetVia=function(t){this.buttonVia=t},r.prototype.SetHashtags=function(t){this.buttonHashtags=t},r.prototype.Reload=function(){if(!o){if(this.elem.parentElement.removeChild(this.elem),this.elem=document.createElement("div"),document.body.appendChild(this.elem),this.element_hidden)this.elem.style.display="none";i(window.twttr,this),this.updatePosition(!0)}},t.acts=new r,t.exps=new function(){}}(),assert2(drama,"drama namespace not created"),assert2(drama.plugins_,"drama.plugins_ not created"),drama.plugins_.UserMedia=function(t){this.runtime=t},function(){var t=drama.plugins_.UserMedia.prototype;t.Type=function(t){this.plugin=t,this.runtime=t.runtime};var e=t.Type.prototype;e.onCreate=function(){},e.onRestoreWebGLContext=function(){if(!this.is_family&&this.instances.length){var t,e,i;for(t=0,e=this.instances.length;t<e;t++)if((i=this.instances[t]).video_active&&0<=i.v.videoWidth&&0<=i.v.videoHeight)i.webGL_texture=this.runtime.glwrap.createEmptyTexture(i.v.videoWidth,i.v.videoHeight,this.runtime.linearSampling)}},t.Instance=function(t){this.type=t,this.runtime=t.runtime};var i=t.Instance.prototype,o=!!navigator.mediaDevices&&!!navigator.mediaDevices.getUserMedia;if(!window.URL)window.URL=window.webkitURL||window.mozURL||window.msURL;var s=[],a=[],l=!1,r=!(!window.webkitSpeechRecognition&&!window.speechRecognition),n=-1,c=null,u=null,h="",d=[],p="";function f(t){if(t)if(t.stop)t.stop();else for(var e=t.getTracks(),i=0,n=e.length;i<n;++i){var r=e[i];if(r.stop)r.stop()}}var m=window.speechSynthesis||window.webkitSpeechSynthesis||window.mozSpeechSynthesis||window.msSpeechSynthesis,g=window.SpeechSynthesisUtterance||window.webkitSpeechSynthesisUtterance||window.mozSpeechSynthesisUtterance||window.msSpeechSynthesisUtterance,y=null,v=!1;function b(){if(!v&&m)y=m.getVoices(),v=!0}function _(t){if(b(),!y)return null;if(t<0||t>=y.length)return null;else return y[t]}function w(){}function x(){}function S(){}i.onCreate=function(){var e=this;if(this.v=document.createElement("video"),this.v.crossOrigin="anonymous",this.v.autoplay=!0,this.v.addEventListener("canplaythrough",function(){if(e.video_active)e.video_ready=!0}),drama.setGLBlend(this,0,this.runtime.gl),this.video_active=!1,this.audio_active=!1,this.media_stream=null,this.runtime.tickMe(this),this.snapshot_data="",this.webGL_texture=null,this.lastDecodedFrame=-1,this.video_ready=!1,this.viaCanvas=null,this.viaCtx=null,this.useViaCanvasWorkaround=this.runtime.isIE||this.runtime.isMicrosoftEdge,this.speechRecognition=null,this.finalTranscript="",this.interimTranscript="",this.isRecognisingSpeech=!1,this.lastSpeechError="",this.runtime.isWinJS){var t=Windows.Devices.Sensors.LightSensor.getDefault();if(t){var i=t.minimumReportInterval;t.reportInterval=16<i?i:16,t.addEventListener("readingchanged",function(t){n=t.reading.illuminanceInLux,e.runtime.trigger(drama.plugins_.UserMedia.prototype.cnds.OnDeviceLight,e)})}}else window.addEventListener("devicelight",function(t){n=t.value,e.runtime.trigger(drama.plugins_.UserMedia.prototype.cnds.OnDeviceLight,e)})},i.onDestroy=function(){if(this.media_stream)f(this.media_stream),this.media_stream=null,this.video_active=!1,this.video_ready=!1,this.audio_active=!1;if(this.runtime.glwrap&&this.webGL_texture)this.runtime.glwrap.deleteTexture(this.webGL_texture),this.webGL_texture=null;this.viaCanvas=null,this.viaCtx=null},i.tick=function(){if(this.video_active&&this.video_ready)this.runtime.redraw=!0},i.draw=function(t){if(t.globalAlpha=this.opacity,t.save(),t.fillStyle="#000",t.fillRect(this.x,this.y,this.width,this.height),this.video_active&&this.video_ready){var e=this.v.videoWidth/this.v.videoHeight,i=this.width,n=this.height,r=0,o=0,s=0,a=0;if(e<i/n){if(s=n*e,a=n,(r=Math.floor((i-s)/2))<0)r=0}else if(a=(s=i)/e,(o=Math.floor((n-a)/2))<0)o=0;try{t.drawImage(this.v,this.x+r,this.y+o,s,a)}catch(t){}}t.restore()},i.drawGL=function(t){t.setBlend(this.srcBlend,this.destBlend),t.setOpacity(this.opacity);var e=this.bquad;if(t.setTexture(null),t.quad(e.tlx,e.tly,e.trx,e.try_,e.brx,e.bry,e.blx,e.bly),!(!this.video_active||!this.video_ready||this.v.videoWidth<=0||this.v.videoHeight<=0)){if(!this.webGL_texture)this.webGL_texture=t.createEmptyTexture(this.v.videoWidth,this.v.videoHeight,this.runtime.linearSampling);var i=this.v.webkitDecodedFrameCount||this.v.mozParsedFrames,n=!1;if(!i)n=!0;else if(i>this.lastDecodedFrame)n=!0,this.lastDecodedFrame=i;if(n)if(this.useViaCanvasWorkaround){if(!this.viaCtx)this.viaCanvas=document.createElement("canvas"),this.viaCanvas.width=this.v.videoWidth,this.viaCanvas.height=this.v.videoHeight,this.viaCtx=this.viaCanvas.getContext("2d");this.viaCtx.drawImage(this.v,0,0),t.videoToTexture(this.viaCanvas,this.webGL_texture)}else t.videoToTexture(this.v,this.webGL_texture);var r=this.v.videoWidth/this.v.videoHeight,o=this.width,s=this.height,a=0,l=0,c=0,u=0;if(r<o/s){if(c=s*r,u=s,(a=Math.floor((o-c)/2))<0)a=0}else if(u=(c=o)/r,(l=Math.floor((s-u)/2))<0)l=0;var h=this.x+a,d=this.y+l,p=h+c,f=d+u;t.setTexture(this.webGL_texture),t.quad(h,d,p,d,p,f,h,f)}},i.getDebuggerValues=function(t){t.push({title:"User media",properties:[{name:"Video active",value:this.video_active,readonly:!0},{name:"Audio active",value:this.audio_active,readonly:!0},{name:"Ambient light",value:n.toString()+" lux",readonly:!0}]}),t.push({title:"Speech recognition",properties:[{name:"Recongising speech",value:this.isRecognisingSpeech,readonly:!0},{name:"Interim transcript",value:this.interimTranscript,readonly:!0},{name:"Final transcript",value:this.finalTranscript,readonly:!0},{name:"Last speech error",value:this.lastSpeechError,readonly:!0}]})},w.prototype.OnApproved=function(){return!0},w.prototype.OnDeclined=function(){return!0},w.prototype.SupportsUserMedia=function(){return o},w.prototype.SupportsSpeechRecognition=function(){return r},w.prototype.OnSpeechRecognitionStart=function(){return!0},w.prototype.OnSpeechRecognitionEnd=function(){return!0},w.prototype.OnSpeechRecognitionError=function(){return!0},w.prototype.OnSpeechRecognitionResult=function(){return!0},w.prototype.IsRecognisingSpeech=function(){return this.isRecognisingSpeech},w.prototype.OnDeviceLight=function(){return!0},w.prototype.SupportsSpeechSynthesis=function(){return!!m&&!!g},w.prototype.IsSpeaking=function(){return m&&m.speaking},w.prototype.OnMediaSources=function(){return!0},w.prototype.OnCanvasRecordingReady=function(){return!0},w.prototype.SupportsCanvasRecording=function(){return this.runtime.canvas&&this.runtime.canvas.captureStream&&"undefined"!=typeof MediaRecorder},w.prototype.IsCanvasRecordFormatSupported=function(t){var e;if(0===t)e="video/webm;codecs=vp8";else e="video/webm;codecs=vp9";if("undefined"==typeof MediaRecorder)return!1;else if(MediaRecorder.isTypeSupported)return!!MediaRecorder.isTypeSupported(e);else if(MediaRecorder.canRecordMimeType)return!!MediaRecorder.canRecordMimeType(e);else return!1},t.cnds=new w,x.prototype.RequestCamera=function(t,e,i){if(!l&&o){l=!0;var n=this,r={};if((t=Math.floor(t))<0||t>=a.length)r.video={};else r.video={deviceId:{exact:a[t].deviceId}};if(0<e&&0<i)r.video.width=Math.floor(e),r.video.height=Math.floor(i);navigator.mediaDevices.getUserMedia(r).then(function(t){if(n.media_stream=t,n.video_ready=!1,n.v.srcObject)n.v.srcObject=t;else n.v.src=window.URL.createObjectURL(t);if(n.video_active=!0,l=!1,n.lastDecodedFrame=-1,n.runtime.glwrap&&n.webGL_texture)n.runtime.glwrap.deleteTexture(n.webGL_texture),n.webGL_texture=null;n.runtime.trigger(drama.plugins_.UserMedia.prototype.cnds.OnApproved,n)}).catch(function(t){l=!1,n.runtime.trigger(drama.plugins_.UserMedia.prototype.cnds.OnDeclined,n)})}},x.prototype.RequestMic=function(e,t){if(!l&&o){l=!0;var i=this,n={};if((t=Math.floor(t))<0||t>=s.length)n.audio=!0;else n.audio={optional:[{deviceId:s[t].deviceId}]};navigator.mediaDevices.getUserMedia(n).then(function(t){if(i.media_stream=t,window.c2OnAudioMicStream)window.c2OnAudioMicStream(t,e);i.audio_active=!0,l=!1,i.runtime.trigger(drama.plugins_.UserMedia.prototype.cnds.OnApproved,i)}).catch(function(){l=!1,i.runtime.trigger(drama.plugins_.UserMedia.prototype.cnds.OnDeclined,i)})}},x.prototype.Stop=function(){if(this.media_stream)f(this.media_stream),this.media_stream=null,this.video_active=!1,this.video_ready=!1,this.audio_active=!1},x.prototype.Snapshot=function(t,e){if(this.video_active&&this.video_ready){var i=document.createElement("canvas");i.width=this.v.videoWidth,i.height=this.v.videoHeight,i.getContext("2d").drawImage(this.v,0,0,this.v.videoWidth,this.v.videoHeight),this.snapshot_data=i.toDataURL(0===t?"image/png":"image/jpeg",e/100)}},x.prototype.RequestSpeechRecognition=function(t,e,i){if(r){if(window.webkitSpeechRecognition)this.speechRecognition=new window.webkitSpeechRecognition;else if(window.speechRecognition)this.speechRecognition=new window.speechRecognition;this.speechRecognition.lang=t,this.speechRecognition.continuous=0===e,this.speechRecognition.interimResults=0===i,this.isRecognisingSpeech=!1,this.interimTranscript="",this.finalTranscript="";var n=this;this.speechRecognition.onstart=function(){n.isRecognisingSpeech=!0,n.runtime.trigger(drama.plugins_.UserMedia.prototype.cnds.OnSpeechRecognitionStart,n)},this.speechRecognition.onend=function(){n.isRecognisingSpeech=!1,n.runtime.trigger(drama.plugins_.UserMedia.prototype.cnds.OnSpeechRecognitionEnd,n)},this.speechRecognition.onerror=function(t){n.isRecognisingSpeech=!1,n.lastSpeechError=t.error||"unknown",n.runtime.trigger(drama.plugins_.UserMedia.prototype.cnds.OnSpeechRecognitionError,n)},this.speechRecognition.onresult=function(t){var e;for(n.interimTranscript="",e=t.resultIndex;e<t.results.length;++e)if(t.results[e].isFinal)n.finalTranscript+=t.results[e][0].transcript;else n.interimTranscript+=t.results[e][0].transcript;n.runtime.trigger(drama.plugins_.UserMedia.prototype.cnds.OnSpeechRecognitionResult,n)},this.speechRecognition.start()}},x.prototype.StepSpeechRecognition=function(){if(this.speechRecognition)this.speechRecognition.stop(),this.speechRecognition=null},x.prototype.SpeakText=function(t,e,i,n,r,o){if(m&&g){var s=new g(t);if(e)s.lang=e;if(i)s.voice=function(t){if(b(),!y)return null;var e,i,n;for(e=0,i=y.length;e<i;++e)if((n=y[e]).voiceURI===t)return n;return null}(i),s.voiceURI=i;s.volume=function(t){var e=Math.pow(10,t/20);if(e<0)e=0;if(1<e)e=1;return e}(n),s.rate=r,s.pitch=o,m.speak(s)}},x.prototype.StopSpeaking=function(){if(m)m.cancel()},x.prototype.PauseSpeaking=function(){if(m)m.pause()},x.prototype.ResumeSpeaking=function(){if(m)m.resume()},x.prototype.GetMediaSources=function(){var o=this;drama.clearArray(s),drama.clearArray(a);var t=function(t){var e,i,n,r;for(e=0,i=t.length;e<i;++e){if("audio"===(r=(n=t[e]).kind)||"audioinput"===r)s.push(n);else if("video"===r||"videoinput"===r)a.push(n);o.runtime.trigger(drama.plugins_.UserMedia.prototype.cnds.OnMediaSources,o)}};if(navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices)navigator.mediaDevices.enumerateDevices().then(t);else if(window.MediaStreamTrack&&window.MediaStreamTrack.getSources)window.MediaStreamTrack.getSources(t)},x.prototype.StartRecordingCanvas=function(t,e,i){if(!c&&!u)if(this.runtime.canvas&&this.runtime.canvas.captureStream&&void 0!==window.MediaRecorder){if(0<i)u=this.runtime.canvas.captureStream(i);else u=this.runtime.canvas.captureStream();if(drama.clearArray(d),0===t)h="video/webm;codecs=vp8";else h="video/webm;codecs=vp9";var n=this;try{c=new window.MediaRecorder(u,{bitsPerSecond:1e3*e,mimeType:h})}catch(t){return f(u),void(u=null)}c.ondataavailable=function(t){d.push(t.data)},c.onerror=function(t){console.error("Recording error: ",t)},c.onwarning=function(t){console.warn("Recording warning: ",t)},c.onstop=function(t){var e=new Blob(d,{type:h});if(p)URL.revokeObjectURL(p);p=URL.createObjectURL(e),n.runtime.trigger(drama.plugins_.UserMedia.prototype.cnds.OnCanvasRecordingReady,n)},window.setTimeout(function(){c.start()},100)}},x.prototype.StopRecordingCanvas=function(){if(c)c.stop(),c=null,f(u),u=null},t.acts=new x,S.prototype.VideoWidth=function(t){t.set_int(this.v?this.v.videoWidth:0)},S.prototype.VideoHeight=function(t){t.set_int(this.v?this.v.videoHeight:0)},S.prototype.SnapshotURL=function(t){t.set_string(this.snapshot_data)},S.prototype.FinalTranscript=function(t){t.set_string(this.finalTranscript)},S.prototype.InterimTranscript=function(t){t.set_string(this.interimTranscript)},S.prototype.SpeechError=function(t){t.set_string(this.lastSpeechError)},S.prototype.AmbientLux=function(t){t.set_float(n)},S.prototype.VoiceCount=function(t){t.set_int((b(),y?y.length:0))},S.prototype.VoiceNameAt=function(t,e){var i=_(e=Math.floor(e));t.set_string(i?i.name:"")},S.prototype.VoiceLangAt=function(t,e){var i=_(e=Math.floor(e));t.set_string(i?i.lang:"")},S.prototype.VoiceURIAt=function(t,e){var i=_(e=Math.floor(e));t.set_string(i?i.voiceURI:"")},S.prototype.AudioSourceCount=function(t){t.set_int(s.length)},S.prototype.AudioSourceLabelAt=function(t,e){if(!((e=Math.floor(e))<0||e>=s.length))t.set_string(s[e].label||"");else t.set_string("")},S.prototype.CameraSourceCount=function(t){t.set_int(a.length)},S.prototype.CameraSourceLabelAt=function(t,e){if(!((e=Math.floor(e))<0||e>=a.length))t.set_string(a[e].label||"");else t.set_string("")},S.prototype.CameraSourceFacingAt=function(t,e){if(!((e=Math.floor(e))<0||e>=a.length))t.set_string(a[e].facing||a[e].facingMode||"");else t.set_string("")},S.prototype.CanvasRecordingURL=function(t){t.set_string(p)},t.exps=new S}(),assert2(drama,"drama namespace not created"),assert2(drama.plugins_,"drama.plugins_ not created"),drama.plugins_.wtUtc=function(t){this.runtime=t},function(){var t=drama.plugins_.wtUtc.prototype;t.Type=function(t){this.plugin=t,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t){this.type=t,this.runtime=t.runtime,this.timeZone=0,this.dateSpacer=".",this.endian="littleEndian",this.useLocal="0",this.weekday=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]};var e=t.Instance.prototype;function i(){}function n(){}e.onCreate=function(){this.timeZone=this.properties[0],this.dateSpacer=this.properties[1],this.endian=this.properties[2],this.useLocal=this.properties[3]},e.saveToJSON=function(){return{}},e.loadFromJSON=function(t){},e.getDebuggerValues=function(t){},t.cnds=new function(){},i.prototype.setTimezone=function(t){this.timeZone=t},i.prototype.setSpacer=function(t){this.dateSpacer=t},i.prototype.setDateFormat=function(t){this.endian=t},i.prototype.setUseLocal=function(t){if(0===t)this.useLocal=!0;else this.useLocal=!1},t.acts=new i,n.prototype.currTimestamp=function(t){var e=new Date;if(!0===this.useLocal){var i=-1*e.getTimezoneOffset();e=e.getTime()+6e4*i,t.set_int(e)}else t.set_int(e.getTime()+36e5*this.timeZone)},n.prototype.currDate=function(t){var e,i=new Date;if(!0===this.useLocal){var n=-1*i.getTimezoneOffset();e=new Date(i.getTime()+6e4*n)}else e=new Date(i.getTime()+36e5*this.timeZone);switch(this.endian){case 0:i=String(e.getUTCDate()).padStart(2,"0")+this.dateSpacer+String(e.getUTCMonth()+1).padStart(2,"0")+this.dateSpacer+e.getUTCFullYear();break;case 1:i=String(e.getUTCMonth()+1).padStart(2,"0")+this.dateSpacer+String(e.getUTCDate()).padStart(2,"0")+this.dateSpacer+e.getUTCFullYear();break;case 2:i=String(e.getUTCFullYear())+this.dateSpacer+String(e.getUTCMonth()+1).padStart(2,"0")+this.dateSpacer+String(e.getUTCDate()).padStart(2,"0");break;default:i=String(e.getUTCDate()).padStart(2,"0")+this.dateSpacer+String(e.getUTCMonth()+1).padStart(2,"0")+this.dateSpacer+e.getUTCFullYear()}t.set_string(i)},n.prototype.currTime=function(t,e){var i,n,r=new Date;if(!0===this.useLocal){var o=-1*r.getTimezoneOffset();i=new Date(r.getTime()+6e4*o)}else i=new Date(r.getTime()+36e5*this.timeZone);switch(e){case"millisecond":n=String(i.getUTCHours()).padStart(2,"0")+":"+String(i.getUTCMinutes()).padStart(2,"0")+":"+String(i.getUTCSeconds()).padStart(2,"0")+":"+String(i.getUTCMilliseconds()).padStart(3,"0");break;case"second":n=String(i.getUTCHours()).padStart(2,"0")+":"+String(i.getUTCMinutes()).padStart(2,"0")+":"+String(i.getUTCSeconds()).padStart(2,"0");break;case"minute":default:n=String(i.getUTCHours()).padStart(2,"0")+":"+String(i.getUTCMinutes()).padStart(2,"0")}t.set_string(n)},n.prototype.milliseconds=function(t){var e=new Date;t.set_int(e.getUTCMilliseconds())},n.prototype.seconds=function(t){var e=new Date;t.set_int(e.getUTCSeconds())},n.prototype.minutes=function(t){var e=new Date;t.set_int(e.getUTCMinutes())},n.prototype.hours=function(t){var e=new Date,i=-1*e.getTimezoneOffset(),n=new Date(e.getTime()+36e5*this.timeZone);if(!0===this.useLocal)n=new Date(e.getTime()+6e4*i);t.set_int(n.getUTCHours())},n.prototype.day=function(t){var e=new Date,i=-1*e.getTimezoneOffset(),n=new Date(e.getTime()+36e5*this.timeZone);if(!0===this.useLocal)n=new Date(e.getTime()+6e4*i);t.set_int(n.getUTCDate())},n.prototype.weekday=function(t){var e=new Date,i=-1*e.getTimezoneOffset(),n=new Date(e.getTime()+36e5*this.timeZone);if(!0===this.useLocal)n=new Date(e.getTime()+6e4*i);n=n.getUTCDay(),t.set_string(this.weekday[n])},n.prototype.month=function(t){var e=new Date,i=-1*e.getTimezoneOffset(),n=new Date(e.getTime()+36e5*this.timeZone);if(!0===this.useLocal)n=new Date(e.getTime()+6e4*i);t.set_int(n.getUTCMonth()+1)},n.prototype.year=function(t){var e=new Date,i=-1*e.getTimezoneOffset(),n=new Date(e.getTime()+36e5*this.timeZone);if(!0===this.useLocal)n=new Date(e.getTime()+6e4*i);t.set_int(n.getUTCFullYear())},n.prototype.durationStamp=function(t,e,i,n,r,o,s,a){var l=a,c=1e3*s,u=6e4*o,h=36e5*r,d=864e5*e,p=2628e6*i,f=31536e6*n,m=new Date,g=-1*m.getTimezoneOffset(),y=m.getTime()+36e5*this.timeZone;if(!0===this.useLocal)y=m.getTime()+6e4*g;y=y+l+c+u+h+d+p+f,t.set_int(y)},n.prototype.dateStamp=function(t,e,i,n,r,o,s,a){var l=String(i+" "+e+" "+n+" "+r+":"+o+":"+s+":"+a);l=new Date(l);var c=-1*(new Date).getTimezoneOffset(),u=l.getTime()+36e5*this.timeZone;if(!0===this.useLocal)u=l.getTime()+6e4*c;t.set_int(u)},t.exps=new n}(),assert2(drama,"drama namespace not created"),assert2(drama.plugins_,"drama.plugins_ not created"),drama.plugins_.video=function(t){this.runtime=t},function(){var t=drama.plugins_.video.prototype;t.Type=function(t){this.plugin=t,this.runtime=t.runtime};var e=t.Type.prototype;e.onCreate=function(){},e.onLostWebGLContext=function(){if(!this.is_family){var t,e;for(t=0,e=this.instances.length;t<e;++t)this.instances[t].webGL_texture=null}};var i=document.createElement("video"),s=!!i.canPlayType("video/webm"),a=!!i.canPlayType("video/ogg"),l=!!i.canPlayType("video/mp4");function n(t){return t&&!t.paused&&!t.ended&&0<t.currentTime}i=null,t.Instance=function(t){this.type=t,this.runtime=t.runtime};var r=t.Instance.prototype,o=[];function c(){var t,e,i,n,r=o.slice(0);for(drama.clearArray(o),t=0,e=r.length;t<e;++t)if(i=(n=r[t]).play())i.catch(function(){u(n)})}function u(t){if(-1===o.indexOf(t))o.push(t)}function h(t){var e,i=(e=t,Math.pow(10,e/20));if(i<0)i=0;if(1<i)i=1;return i}function d(t){if(t<0)t=0;if(1<t)t=1;return e=t,Math.log(e)/Math.log(10)*20;var e}function p(){}function f(){}function m(){}document.addEventListener("touchend",c,!0),document.addEventListener("click",c,!0),document.addEventListener("keydown",c,!0),r.queueVideoPlay=function(t){if(this.video){var e,i=this;if(t)if(!(0<this.isSettingSource)){var n;try{n=this.video.play()}catch(t){return void u(this.video)}if(n)n.catch(function(){if(i.video)u(i.video)});else if(this.useNextTouchWorkaround&&!this.runtime.isInUserInputEvent)u(this.video)}else u(this.video);else if(0<=(e=o.indexOf(this.video)))o.splice(e,1)}},r.onCreate=function(){this.webm_src=this.properties[0],this.ogv_src=this.properties[1],this.mp4_src=this.properties[2],this.autoplay=this.properties[3],this.playInBackground=this.properties[4],this.videoWasPlayingOnSuspend=!1,this.video=document.createElement("video"),this.video.crossOrigin="anonymous",this.video.playsInline=!0,this.webGL_texture=null,this.currentTrigger=-1,this.viaCanvas=null,this.viaCtx=null,this.useViaCanvasWorkaround=this.runtime.isIE||this.runtime.isMicrosoftEdge,this.isSettingSource=0;var t=new xf.xfContainer;t.owner=this,t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t.alpha=this.opacity,t.rotation=this.angle,t.alpha=this.opacity,t.anchorOffsetX=t.width*this.hotspotX,t.anchorOffsetY=t.height*this.hotspotY,this.container=t;var e=new xf.xfImage;e.source=this.video,t.addChild(e),this.image=e;var i=this;if(this.video.addEventListener("canplay",function(){i.currentTrigger=0,i.runtime.trigger(drama.plugins_.video.prototype.cnds.OnPlaybackEvent,i)}),this.video.addEventListener("canplaythrough",function(){i.currentTrigger=1,i.runtime.trigger(drama.plugins_.video.prototype.cnds.OnPlaybackEvent,i)}),this.video.addEventListener("ended",function(){i.currentTrigger=2,i.runtime.trigger(drama.plugins_.video.prototype.cnds.OnPlaybackEvent,i)}),this.video.addEventListener("error",function(){i.currentTrigger=3,i.runtime.trigger(drama.plugins_.video.prototype.cnds.OnPlaybackEvent,i)}),this.video.addEventListener("loadstart",function(){i.currentTrigger=4,i.runtime.trigger(drama.plugins_.video.prototype.cnds.OnPlaybackEvent,i)}),this.video.addEventListener("playing",function(){i.currentTrigger=5,i.runtime.trigger(drama.plugins_.video.prototype.cnds.OnPlaybackEvent,i)}),this.video.addEventListener("pause",function(){i.currentTrigger=6,i.runtime.trigger(drama.plugins_.video.prototype.cnds.OnPlaybackEvent,i)}),this.video.addEventListener("stalled",function(){i.currentTrigger=7,i.runtime.trigger(drama.plugins_.video.prototype.cnds.OnPlaybackEvent,i)}),this.useNextTouchWorkaround=(this.runtime.isiOS||this.runtime.isAndroid&&(this.runtime.isChrome||this.runtime.isAndroidStockBrowser))&&!this.runtime.isCrosswalk,0===this.autoplay)this.video.autoplay=!1,this.video.preload="none";else if(1===this.autoplay)this.video.autoplay=!1,this.video.preload="auto";else if(2===this.autoplay)this.video.autoplay=!0;if(this.setSource(this.webm_src,this.ogv_src,this.mp4_src),2===this.autoplay)this.queueVideoPlay(!0);if(this.visible=this.properties[5],this.runtime.tickMe(this),!this.recycled)(i=this).runtime.addSuspendCallback(function(t){i.onSuspend(t)})},r.onSuspend=function(t){if(!this.playInBackground&&this.video)if(t){if(n(this.video))this.queueVideoPlay(!1),this.video.pause(),this.videoWasPlayingOnSuspend=!0}else if(this.videoWasPlayingOnSuspend)this.queueVideoPlay(!0),this.videoWasPlayingOnSuspend=!1},r.setSource=function(t,e,i){var n=this,r="";if(s&&t)r=t.toLowerCase();else if(a&&e)r=e.toLowerCase();else if(l&&i)r=i.toLowerCase();if(r){var o="assets/files/".concat(r);if(r=this.runtime.manifest[o]?this.runtime.manifest[o]:o,this.runtime.isWKWebView&&!this.runtime.isAbsoluteUrl(r))this.isSettingSource++,this.runtime.fetchLocalFileViaCordovaAsURL(this.runtime.files_subfolder+r,function(t){n.isSettingSource--,n.video.src=t,c()},function(t){console.error("[Video] Failed to load video '"+r+"': ",t),n.isSettingSource--,n.video.src=r});else this.video.src=this.runtime.getLocalFileUrl(r)}if(this.runtime.glwrap&&this.webGL_texture)this.runtime.glwrap.deleteTexture(this.webGL_texture),this.webGL_texture=null;this.viaCanvas=null,this.viaCtx=null},r.onDestroy=function(){if(this.queueVideoPlay(!1),n(this.video))this.video.pause();if(this.runtime.glwrap&&this.webGL_texture)this.runtime.glwrap.deleteTexture(this.webGL_texture),this.webGL_texture=null;this.viaCanvas=null,this.viaCtx=null,this.video.src="",this.video=null},r.tick=function(){if(n(this.video))this.runtime.redraw=!0},r.saveToJSON=function(){return{s:this.video.src||"",p:!!n(this.video),t:this.video.currentTime||0}},r.loadFromJSON=function(t){if(t&&void 0!==t.s){var e=t.s;this.setSource(e,e,e);try{this.video.currentTime=t.t}catch(t){}if(t.p)this.queueVideoPlay(!0);else this.queueVideoPlay(!1),this.video.pause()}},r.draw=function(t){if(this.video){var e=this.video.videoWidth,i=this.video.videoHeight;if(!(e<=0||i<=0||0===this.video.currentTime)){var n=e/i,r=this.width,o=this.height,s=0,a=0,l=0,c=0;if(n<r/o){if(l=o*n,c=o,(s=Math.floor((r-l)/2))<0)s=0}else if(c=(l=r)/n,(a=Math.floor((o-c)/2))<0)a=0;this.image.x=s,this.image.y=a,this.image.width=l,this.image.height=c,this.image.redraw(),this.container.draw(t,this.runtime)}}},r.drawGL=function(t){if(this.video){var e=this.video.videoWidth,i=this.video.videoHeight;if(!(e<=0||i<=0||0===this.video.currentTime)){var n=e/i,r=this.width,o=this.height,s=0,a=0,l=0,c=0;if(n<r/o){if(l=o*n,c=o,(s=Math.floor((r-l)/2))<0)s=0}else if(c=(l=r)/n,(a=Math.floor((o-c)/2))<0)a=0;if(this.useViaCanvasWorkaround){if(!this.viaCtx)this.viaCanvas=document.createElement("canvas"),this.viaCanvas.width=e,this.viaCanvas.height=i,this.viaCtx=this.viaCanvas.getContext("2d");this.viaCtx.drawImage(this.video,0,0),this.image.source=this.viaCanvas}this.image.redraw(),this.image.x=s,this.image.y=a,this.image.width=l,this.image.height=c,this.container.drawGL(t,this.runtime)}}},r.getDebuggerValues=function(t){t.push({title:"My debugger section",properties:[]})},r.onDebugValueEdited=function(t,e,i){if("My property"===e)this.myProperty=i},p.prototype.IsPlaying=function(){return n(this.video)},p.prototype.IsPaused=function(){return this.video.paused},p.prototype.HasEnded=function(){return this.video.ended},p.prototype.IsMuted=function(){return this.video.muted},p.prototype.OnPlaybackEvent=function(t){return this.currentTrigger===t},t.cnds=new p,f.prototype.SetSource=function(t,e,i){this.setSource(t,e,i),this.video.load()},f.prototype.SetPlaybackTime=function(t){try{this.video.currentTime=t}catch(t){if(console&&console.error)console.error("Exception setting video playback time: ",t)}},f.prototype.SetLooping=function(t){this.video.loop=0!==t},f.prototype.SetMuted=function(t){this.video.muted=0!==t},f.prototype.SetVolume=function(t){this.video.volume=h(t)},f.prototype.Pause=function(){this.queueVideoPlay(!1),this.video.pause()},f.prototype.Play=function(){this.queueVideoPlay(!0)},t.acts=new f,m.prototype.PlaybackTime=function(t){t.set_float(this.video.currentTime||0)},m.prototype.Duration=function(t){t.set_float(this.video.duration||0)},m.prototype.Volume=function(t){t.set_float(d(this.video.volume||0))},m.prototype.VideoWidth=function(t){t.set_float(this.video.videoWidth||0)},m.prototype.VideoHeight=function(t){t.set_float(this.video.videoHeight||0)},t.exps=new m}(),assert2(drama,"drama namespace not created"),assert2(drama.plugins_,"drama.plugins_ not created"),drama.plugins_.xfWebSocket=function(t){this.runtime=t},function(){var t=drama.plugins_.xfWebSocket.prototype;t.Type=function(t){this.plugin=t,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t){this.type=t,this.runtime=t.runtime};var e=t.Instance.prototype,n="undefined"!=typeof WebSocket,r="";function i(){}function o(){}function s(){}e.onCreate=function(){this.ws=null,this.messageText="",this.errorMsg="",this.closeCode=0,this.closeReason=""},e.saveToJSON=function(){return{messageText:this.messageText,errorMsg:this.errorMsg}},e.loadFromJSON=function(t){this.messageText=t.messageText,this.errorMsg=t.errorMsg},e.getDebuggerValues=function(t){t.push({title:"WebSocket",properties:[{name:"Server URL",value:r,readonly:!0},{name:"Is open",value:!(!this.ws||1!==this.ws.readyState),readonly:!0},{name:"Last error",value:this.errorMsg,readonly:!0},{name:"Last message",value:this.messageText,readonly:!0}]})},i.prototype.OnOpened=function(){return!0},i.prototype.OnClosed=function(){return!0},i.prototype.OnError=function(){return!0},i.prototype.OnMessage=function(){return!0},i.prototype.IsOpen=function(){return this.ws&&1===this.ws.readyState},i.prototype.IsConnecting=function(){return this.ws&&0===this.ws.readyState},i.prototype.IsSupported=function(){return n},t.cnds=new i,o.prototype.Connect=function(t,e){if(n){if(this.ws)this.ws.close();var i=this;r=t;try{if(""===e)this.ws=new WebSocket(t);else this.ws=new WebSocket(t,e)}catch(t){return this.ws=null,i.errorMsg="Unable to create a WebSocket with the given address and protocol.",void i.runtime.trigger(drama.plugins_.xfWebSocket.prototype.cnds.OnError,i)}this.ws.binaryType="arraybuffer",this.ws.onopen=function(){if(e.length&&-1===i.ws.protocol.indexOf(e))i.errorMsg="WebSocket required protocol '"+e+"' not supported by server",i.runtime.trigger(drama.plugins_.xfWebSocket.prototype.cnds.OnError,i);else i.runtime.trigger(drama.plugins_.xfWebSocket.prototype.cnds.OnOpened,i)},this.ws.onerror=function(t){if(drama.is_string(t))i.errorMsg=t;else i.errorMsg=t&&drama.is_string(t.data)?t.data:"";i.runtime.trigger(drama.plugins_.xfWebSocket.prototype.cnds.OnError,i)},this.ws.onclose=function(t){i.closeCode=t.code||0,i.closeReason=t.reason||"",i.runtime.trigger(drama.plugins_.xfWebSocket.prototype.cnds.OnClosed,i)},this.ws.onmessage=function(t){i.messageText=t.data||"",i.runtime.trigger(drama.plugins_.xfWebSocket.prototype.cnds.OnMessage,i)}}},o.prototype.Close=function(){if(this.ws)this.ws.close()},o.prototype.Send=function(t){if(this.ws&&1===this.ws.readyState)this.ws.send(t)},t.acts=new o,s.prototype.MessageText=function(t){t.set_string(this.messageText)},s.prototype.ErrorMsg=function(t){t.set_string(drama.is_string(this.errorMsg)?this.errorMsg:"")},s.prototype.CloseCode=function(t){t.set_int(this.closeCode)},s.prototype.CloseReason=function(t){t.set_string(this.closeReason)},t.exps=new s}(),assert2(drama,"drama namespace not created"),assert2(drama.plugins_,"drama.plugins_ not created"),drama.plugins_.WebStorage=function(t){this.runtime=t},function(){var t=drama.plugins_.WebStorage.prototype;t.Type=function(t){this.plugin=t,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t){this.type=t,this.runtime=t.runtime};var e=t.Instance.prototype,o="",s=void 0!==window.is_scirra_arcade;if(s)o="arcade"+window.scirra_arcade_id;var a=!1;try{localStorage.getItem("test"),a=!0}catch(t){a=!1}function i(){}function n(){}function r(){}e.onCreate=function(){if(!a)drama.logexport(" Webstorage plugin: local storage is not supported on this platform.")},e.getDebuggerValues=function(t){if(a){var e,i,n,r=[];for(e=0,i=localStorage.length;e<i;++e)if("__sidesize"!==(n=localStorage.key(e))&&"__watch"!==n)r.push({name:n,value:localStorage.getItem(n)});if(r.length)t.push({title:"Local storage data",properties:r})}},e.onDebugValueEdited=function(t,e,i){try{localStorage.setItem(o+e,i)}catch(t){alert("Error setting WebStorage data. The storage quota may have been exceeded.")}},i.prototype.LocalStorageEnabled=function(){return a},i.prototype.SessionStorageEnabled=function(){return a},i.prototype.LocalStorageExists=function(t){if(!a)return!1;else return null!=localStorage.getItem(o+t)},i.prototype.SessionStorageExists=function(t){if(!a)return!1;else return null!=sessionStorage.getItem(o+t)},i.prototype.OnQuotaExceeded=function(){return!0},i.prototype.CompareKeyText=function(t,e,i){if(!a)return!1;var n=localStorage.getItem(o+t)||"";if(i)return n==e;else return drama.equals_nocase(n,e)},i.prototype.CompareKeyNumber=function(t,e,i){if(!a)return!1;var n=localStorage.getItem(o+t)||"";return drama.do_cmp(parseFloat(n),e,i)},t.cnds=new i,n.prototype.StoreLocal=function(t,e){if(a)try{localStorage.setItem(o+t,e)}catch(t){this.runtime.trigger(drama.plugins_.WebStorage.prototype.cnds.OnQuotaExceeded,this)}},n.prototype.StoreSession=function(t,e){if(a)try{sessionStorage.setItem(o+t,e)}catch(t){this.runtime.trigger(drama.plugins_.WebStorage.prototype.cnds.OnQuotaExceeded,this)}},n.prototype.RemoveLocal=function(t){if(a)localStorage.removeItem(o+t)},n.prototype.RemoveSession=function(t){if(a)sessionStorage.removeItem(o+t)},n.prototype.ClearLocal=function(){if(a)if(!s)localStorage.clear()},n.prototype.ClearSession=function(){if(a)if(!s)sessionStorage.clear()},n.prototype.JSONLoad=function(t,e){if(a){var i;try{i=JSON.parse(t)}catch(t){return}if(i.xfdictionary){var n,r=i.data;if(0===e&&!s)localStorage.clear();for(n in r)if(r.hasOwnProperty(n))try{localStorage.setItem(o+n,r[n])}catch(t){return void this.runtime.trigger(drama.plugins_.WebStorage.prototype.cnds.OnQuotaExceeded,this)}}}},t.acts=new n,r.prototype.LocalValue=function(t,e){if(a)t.set_string(localStorage.getItem(o+e)||"");else t.set_string("")},r.prototype.SessionValue=function(t,e){if(a)t.set_string(sessionStorage.getItem(o+e)||"");else t.set_string("")},r.prototype.LocalCount=function(t){if(a)t.set_int(s?0:localStorage.length);else t.set_int(0)},r.prototype.SessionCount=function(t){if(a)t.set_int(s?0:sessionStorage.length);else t.set_int(0)},r.prototype.LocalAt=function(t,e){if(s||!a)t.set_string("");else t.set_string(localStorage.getItem(localStorage.key(e))||"")},r.prototype.SessionAt=function(t,e){if(s||!a)t.set_string("");else t.set_string(sessionStorage.getItem(sessionStorage.key(e))||"")},r.prototype.LocalKeyAt=function(t,e){if(s||!a)t.set_string("");else t.set_string(localStorage.key(e)||"")},r.prototype.SessionKeyAt=function(t,e){if(s||!a)t.set_string("");else t.set_string(sessionStorage.key(e)||"")},r.prototype.AsJSON=function(t){if(a){var e,i,n,r={};for(e=0,i=localStorage.length;e<i;e++)if(n=localStorage.key(e),s){if(n.substr(0,o.length)===o)r[n.substr(o.length)]=localStorage.getItem(n)}else r[n]=localStorage.getItem(n);t.set_string(JSON.stringify({xfdictionary:!0,data:r}))}else t.set_string("")},t.exps=new r}(),assert2(drama,"drama namespace not created"),assert2(drama.plugins_,"drama.plugins_ not created"),drama.plugins_.win8=function(t){this.runtime=t},function(){var t=drama.plugins_.win8.prototype;t.Type=function(t){this.plugin=t,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t){this.type=t,this.runtime=t.runtime};var e=t.Instance.prototype,a=null,l=!1;function i(){}function n(){}function c(t,e){if("data:"!==t.substr(0,5))return!1;var i,n=t.substring(5).split(",");if(2!==n.length)return!1;if(-1<n[0].indexOf("image/png"))i="png";else if(-1<n[0].indexOf("image/jpeg"))i="jpg";else return!1;var r="shareimage."+i;if(-1===n[0].indexOf(";base64"))return!1;var o=function(t){for(var e,i,n,r,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",s=0,a=[];e=(r=o.indexOf(t.charAt(s++))<<18|o.indexOf(t.charAt(s++))<<12|o.indexOf(t.charAt(s++))<<6|o.indexOf(t.charAt(s++)))>>16&255,i=r>>8&255,n=255&r,a.push(e),a.push(i),a.push(n),s<t.length;);return a}(n[1]);Windows.Storage.ApplicationData.current.localFolder.createFileAsync(r,Windows.Storage.CreationCollisionOption.replaceExisting).then(function(t){Windows.Storage.FileIO.writeBytesAsync(t,o).then(function(){if(e)e(t)})})}e.onCreate=function(){this.isWindows8=this.runtime.isWindows8App,this.isWinJS=this.runtime.isWinJS,this.triggerViewState=0,this.isTestMode=this.properties[0],this.showAbout=this.properties[1],this.showSupport=this.properties[2],this.showPrivacy=this.properties[3],this.appFormattedPrice="",this.lastProductListings=null,this.currentApp=null,this.licenseInfo=null;var i=this;if(this.isWinJS){var t=Windows.ApplicationModel.Store;this.currentApp=this.isTestMode?t.CurrentAppSimulator:t.CurrentApp;try{this.licenseInfo=this.currentApp.licenseInformation}catch(t){console.log("Failed to load license information: ",t),this.licenseInfo=null}if(this.isTestMode)new Windows.UI.Popups.MessageDialog("Note: this Windows Store app is in Test Mode, designed for testing purchases. Before publishing, be sure to set Test Mode to 'No' in the Windows Store object's properties.").showAsync();if(Windows.Storage.ApplicationData.current.addEventListener("datachanged",function(){i.runtime.trigger(drama.plugins_.win8.prototype.cnds.OnDataChanged,i)}),this.licenseInfo)this.licenseInfo.addEventListener("licensechanged",function(){i.runtime.trigger(drama.plugins_.win8.prototype.cnds.OnLicenseChanged,i)});if(this.isTestMode)Windows.ApplicationModel.Package.current.installedLocation.getFileAsync("WindowsStoreProxy.xml").done(function(t){Windows.ApplicationModel.Store.CurrentAppSimulator.reloadSimulatorAsync(t).done(function(){console.log(" Test mode; loaded WindowsStoreProxy.xml")},function(t){console.log(" Error loading WindowsStoreProxy.xml: "+t)})},function(t){console.log(" Error loading WindowsStoreProxy.xml: "+t)})}if(this.isWindows8)if(window.addEventListener("resize",function(){i.triggerViewState=Windows.UI.ViewManagement.ApplicationView.value,i.runtime.trigger(drama.plugins_.win8.prototype.cnds.OnViewStateChange,i)}),Windows.ApplicationModel.DataTransfer.DataTransferManager.getForCurrentView().addEventListener("datarequested",function(t){if(a=t,l=!1,i.runtime.trigger(drama.plugins_.win8.prototype.cnds.OnShare,i),a=null,!l)t.request.failWithDisplayText("Try selecting a different option before sharing.")}),this.showAbout||this.showSupport||this.showPrivacy)WinJS.Application.addEventListener("settings",function(t){var e={};if(i.showAbout)e.about={title:"About",href:"/about.html"};if(i.showSupport)e.support={title:"Support",href:"/support.html"};if(i.showPrivacy)e.privacy={title:"Privacy Policy",href:"/privacy.html"};t.detail.applicationcommands=e,WinJS.UI.SettingsFlyout.populateSettings(t)})},e.roamingValues=function(){if(this.isWinJS)return Windows.Storage.ApplicationData.current.roamingSettings.values;else return null},i.prototype.IsWindows8=function(){return this.isWindows8},i.prototype.IsWindowsStoreApp=function(){return this.isWinJS},i.prototype.OnViewStateChange=function(t){if(this.isWindows8)return t===this.triggerViewState;else return!1},i.prototype.CompareViewState=function(t){if(this.isWindows8)return Windows.UI.ViewManagement.ApplicationView.value===t;else return!1},i.prototype.OnDataChanged=function(){return!0},i.prototype.RoamingKeyExists=function(t){if(this.isWinJS)return this.roamingValues().hasKey(t);else return!1},i.prototype.OnShare=function(){return!0},i.prototype.OnLicenseChanged=function(){return!0},i.prototype.OnPurchaseSuccess=function(){return!0},i.prototype.OnPurchaseFail=function(){return!0},i.prototype.OnStoreListing=function(){return!0},i.prototype.IsTrial=function(){return this.isWinJS&&this.licenseInfo&&this.licenseInfo.isTrial&&this.licenseInfo.isActive},i.prototype.IsLicensed=function(){return this.isWinJS&&this.licenseInfo&&!this.licenseInfo.isTrial&&this.licenseInfo.isActive},i.prototype.IsExpiredTrial=function(){return this.isWinJS&&this.licenseInfo&&this.licenseInfo.isTrial&&!this.licenseInfo.isActive},i.prototype.HasProduct=function(t){if(!this.isWinJS||!this.licenseInfo)return!1;var e=this.licenseInfo.productLicenses;if(!e.hasKey(t))return!1;else return e.lookup(t).isActive},t.cnds=new i,n.prototype.TryUnsnap=function(){if(this.isWindows8)Windows.UI.ViewManagement.ApplicationView.tryUnsnap()},n.prototype.SetRoamingValue=function(t,e){if(this.isWinJS)this.roamingValues()[t]=e.toString()},n.prototype.RemoveRoamingValue=function(t){if(this.isWinJS)this.roamingValues().remove(t)},n.prototype.ClearRoamingData=function(){if(this.isWinJS)this.roamingValues().clear()},n.prototype.ShowShareUI=function(){if(this.isWindows8)Windows.ApplicationModel.DataTransfer.DataTransferManager.showShareUI()},n.prototype.ShareText=function(t,e,i){if(this.isWindows8&&a){var n=a.request;n.data.properties.title=t,n.data.properties.description=e,n.data.setText(i),l=!0}},n.prototype.ShareLink=function(t,e,i){if(this.isWindows8&&a){var n=a.request;n.data.properties.title=t,n.data.properties.description=e,n.data.setUri(new Windows.Foundation.Uri(i)),l=!0}},n.prototype.ShareHTML=function(t,e,i){if(this.isWindows8&&a){var n=a.request;n.data.properties.title=t,n.data.properties.description=e;var r=Windows.ApplicationModel.DataTransfer.HtmlFormatHelper.createHtmlFormat(i);n.data.setHtmlFormat(r),l=!0}},n.prototype.ShareSpriteImage=function(t,e,i){if(this.isWindows8&&a&&i){var n=i.getFirstPicked();if(!n||!n.curFrame)return;var r=n.curFrame.getDataUri(),o=a.request;o.data.properties.title=t,o.data.properties.description=e;var s=o.getDeferral();c(r,function(t){o.data.setBitmap(Windows.Storage.Streams.RandomAccessStreamReference.createFromFile(t)),s.complete()}),l=!0}},n.prototype.ShareDataUri=function(t,e,i){if(this.isWindows8&&a){var n=a.request;n.data.properties.title=t,n.data.properties.description=e;var r=n.getDeferral();c(i,function(t){n.data.setBitmap(Windows.Storage.Streams.RandomAccessStreamReference.createFromFile(t)),r.complete()}),l=!0}},n.prototype.FailShare=function(t){if(this.isWindows8&&a){a.request.failWithDisplayText(t),l=!0}};var u=["tileSquareBlock","tileSquareText02","tileSquareText04","tileWideText03","tileWideText04","tileWideText09"];function r(){}n.prototype.SetLiveTileText=function(t,e,i){if(t=Math.floor(t),this.isWinJS&&0<=t&&t<u.length){var n=Windows.UI.Notifications,r=n.TileTemplateType[u[t]],o=n.TileUpdateManager.getTemplateContent(r),s=o.getElementsByTagName("text");if(s[0].appendChild(o.createTextNode(e)),2<=s.length)s[1].appendChild(o.createTextNode(i));var a=new n.TileNotification(o);n.TileUpdateManager.createTileUpdaterForApplication().update(a)}},n.prototype.PurchaseApp=function(){if(this.isWinJS){var e=this;this.currentApp.requestAppPurchaseAsync(!1).then(function(){console.log(" App purchased OK"),e.runtime.trigger(drama.plugins_.win8.prototype.cnds.OnPurchaseSuccess,e)},function(t){console.log(" App purchase failed: "+t),e.runtime.trigger(drama.plugins_.win8.prototype.cnds.OnPurchaseFail,e)})}},n.prototype.PurchaseProduct=function(e){if(this.isWinJS&&this.licenseInfo){var i=this,t=this.licenseInfo.productLicenses;this.currentApp.requestProductPurchaseAsync(e,!1).then(function(){if(t.hasKey(e)&&t.lookup(e).isActive)console.log(" Product '"+e+"' purchased OK"),i.runtime.trigger(drama.plugins_.win8.prototype.cnds.OnPurchaseSuccess,i);else console.log(" Product '"+e+"' purchase finished but product not active (cancelled?)"),i.runtime.trigger(drama.plugins_.win8.prototype.cnds.OnPurchaseFail,i)},function(t){console.log(" Product '"+e+"' purchase failed: "+t),i.runtime.trigger(drama.plugins_.win8.prototype.cnds.OnPurchaseFail,i)})}},n.prototype.RequestStoreListing=function(){if(this.isWinJS){var e=this;this.currentApp.loadListingInformationAsync().then(function(t){console.log(" Listing information loaded"),e.appFormattedPrice=t.formattedPrice,e.lastProductListings=t.productListings,e.runtime.trigger(drama.plugins_.win8.prototype.cnds.OnStoreListing,e)})}},n.prototype.OpenWindowsStore=function(t){if(this.isWinJS){var e="ms-windows-store:",i=Windows.ApplicationModel.Package.current,n=i.id;switch(t){case 0:e+="PDP?PFN="+n.familyName;break;case 1:e+="Publisher?name="+encodeURIComponent(i.publisherDisplayName);break;case 2:e+="REVIEW?PFN="+n.familyName}console.log("Opening Windows Store: "+e),Windows.System.Launcher.launchUriAsync(new Windows.Foundation.Uri(e))}},n.prototype.SetBackButtonVisible=function(t){if(this.runtime.isWindows10&&"undefined"!=typeof Windows){var e=Windows.UI.Core.AppViewBackButtonVisibility;Windows.UI.Core.SystemNavigationManager.getForCurrentView().appViewBackButtonVisibility=0===t?e.collapsed:e.visible}},t.acts=new n,r.prototype.RoamingValue=function(t,e){if(this.isWinJS){var i=this.roamingValues()[e];t.set_string(i?i.toString():"")}else t.set_string("")},r.prototype.TrialTimeLeft=function(t){if(this.isWinJS&&this.licenseInfo)t.set_float((this.licenseInfo.expirationDate.getTime()-Date.now())/1e3);else t.set_float(0)},r.prototype.AppFormattedPrice=function(t){t.set_string(this.appFormattedPrice)},r.prototype.ProductName=function(t,e){var i="";if(this.isWinJS&&this.lastProductListings&&this.lastProductListings.hasKey(e))i=this.lastProductListings.lookup(e).name;t.set_string(i)},r.prototype.ProductFormattedPrice=function(t,e){var i="";if(this.isWinJS&&this.lastProductListings&&this.lastProductListings.hasKey(e))i=this.lastProductListings.lookup(e).formattedPrice;t.set_string(i)},t.exps=new r}(),drama.plugins_.XboxLive=function(t){this.runtime=t},function(){var t=!!window.Windows,e=window.Microsoft,i=null,o=null,s=null,a=null,n=!1,r="",l="",c="",u="",h="",d=t&&e&&e.Xbox&&e.Xbox.Services;if(d)i=e.Xbox,o=i.Services;function p(){return o.Statistics.Manager.StatisticManager.singletonInstance}var f=drama.plugins_.XboxLive.prototype;f.Type=function(t){this.plugin=t,this.runtime=t.runtime},f.Type.prototype.onCreate=function(){},f.Instance=function(t){this.type=t,this.runtime=t.runtime,this.errorMessage=""};var m=f.Instance.prototype;function g(){}function y(){}function v(){}m.onCreate=function(){if(t)if(d)console.info("[Xbox Live] Xbox Live Services appear to be available."),this.runtime.tickMe(this);else console.warn("[Xbox Live] WinRT is available, but Xbox Live is not available. Check the SDK dependencies are configured.");else console.warn("[Xbox Live] WinRT is not available. Export as UWP app to use Xbox Live features.")},m.tick=function(){if(a&&s)for(var t=p().doWork(),e=0,i=t.length;e<i;++e){var n=t[e],r="unknown";switch(n.eventType){case 0:r="Local user added",this.runtime.trigger(drama.plugins_.XboxLive.prototype.cnds.OnLocalUserAdded,this);break;case 1:r="Local user removed";break;case 2:r="Stat update complete";break;case 3:r="Get leaderboard complete",this.lastLeaderboard=n.eventArgs.result,this.runtime.trigger(drama.plugins_.XboxLive.prototype.cnds.OnLeaderboardSuccess,this)}var o="success";if(0!==n.errorCode)o="Error "+n.errorCode+": "+n.errorMessage;console.log("[Xbox Statistics] Event: "+r+" ("+o+")")}},m.getLeaderboardRowAt=function(t){if(!this.lastLeaderboard)return null;var e=this.lastLeaderboard.rows;if((t=Math.floor(t))<0||t>=e.length)return null;else return e[t]},m.onDestroy=function(){},m.saveToJSON=function(){return{}},m.loadFromJSON=function(t){},m.getDebuggerValues=function(t){},m.onDebugValueEdited=function(t,e,i){},g.prototype.IsXboxLiveAvailable=function(){return d},g.prototype.OnSignInSuccess=function(){return!0},g.prototype.OnSignInError=function(){return!0},g.prototype.OnSilentSignInSuccess=function(){return!0},g.prototype.OnSilentSignInError=function(){return!0},g.prototype.IsSignedIn=function(){return s&&s.isSignedIn},g.prototype.OnPresenceUpdateSuccess=function(){return!0},g.prototype.OnPresenceUpdateError=function(){return!0},g.prototype.OnProfileInfoSuccess=function(){return!0},g.prototype.OnProfileInfoError=function(){return!0},g.prototype.OnLeaderboardSuccess=function(){return!0},g.prototype.OnLocalUserAdded=function(){return!0},f.cnds=new g,y.prototype.SignIn=function(){if(d&&!a){var e=this;if(!s)s=new o.System.XboxLiveUser;s.signInAsync(null).then(function(t){if(t.status==o.System.SignInStatus.success){if(a=new o.XboxLiveContext(s),!n)p().addLocalUser(s),n=!0;e.runtime.trigger(drama.plugins_.XboxLive.prototype.cnds.OnSignInSuccess,e)}else e.errorMessage=""+t.status,e.runtime.trigger(drama.plugins_.XboxLive.prototype.cnds.OnSignInError,e)},function(t){e.errorMessage=t.message,e.runtime.trigger(drama.plugins_.XboxLive.prototype.cnds.OnSignInError,e)})}},y.prototype.SignInSilently=function(){if(d&&!a){var e=this;if(!s)s=new o.System.XboxLiveUser;s.signInSilentlyAsync(null).then(function(t){if(t.status==o.System.SignInStatus.success){if(a=new o.XboxLiveContext(s),!n)p().addLocalUser(s),n=!0;e.runtime.trigger(drama.plugins_.XboxLive.prototype.cnds.OnSilentSignInSuccess,e)}else e.errorMessage=""+t.status,e.runtime.trigger(drama.plugins_.XboxLive.prototype.cnds.OnSilentSignInError,e)},function(t){e.errorMessage=t.message,e.runtime.trigger(drama.plugins_.XboxLive.prototype.cnds.OnSilentSignInError,e)})}},y.prototype.SetPresence=function(t){if(d&&a){var e=this;a.presenceService.setPresenceAsync(!!t).then(function(){e.runtime.trigger(drama.plugins_.XboxLive.prototype.cnds.OnPresenceUpdateSuccess,e)},function(t){e.errorMessage=t.message,e.runtime.trigger(drama.plugins_.XboxLive.prototype.cnds.OnPresenceUpdateError,e)})}},y.prototype.RequestProfileInfo=function(){if(d&&a&&s){var e=this;a.profileService.getUserProfileAsync(s.xboxUserId).then(function(t){r=t.applicationDisplayName,l=t.gameDisplayName,c=t.applicationDisplayPictureResizeUri.toString(),u=t.gameDisplayPictureResizeUri.toString(),h=t.gamerscore,e.runtime.trigger(drama.plugins_.XboxLive.prototype.cnds.OnProfileInfoSuccess,e)},function(t){e.errorMessage=t.message,e.runtime.trigger(drama.plugins_.XboxLive.prototype.cnds.OnProfileInfoError,e)})}},y.prototype.SetStatistic=function(t,e,i){if(d&&a&&s)try{if(0===e){if("string"==typeof i)i=parseInt(i,10);p().setStatisticIntegerData(s,t,Math.floor(i))}else if(1===e){if("string"==typeof i)i=parseFloat(i);p().setStatisticNumberData(s,t,i)}else if(2===e)p().setStatisticStringData(s,t,i.toString())}catch(t){console.error("[Xbox Live] Error setting statistic: ",t)}},y.prototype.RequestFlushStatsToService=function(){if(d&&a&&s)p().requestFlushToService(s)},y.prototype.GetLeaderboard=function(t,e,i,n){if(d&&a&&s)try{var r=new o.Leaderboard.LeaderboardQuery;if(-1===e)r.skipResultToMe=!0;else r.skipResultToRank=e;if(r.maxItems=i,r.order=1,0===n)p().getLeaderboard(s,t,r);else if(1===n)p().getSocialLeaderboard(s,t,o.Social.SocialGroupConstants.favorite,r);else if(2===n)p().getSocialLeaderboard(s,t,o.Social.SocialGroupConstants.people,r)}catch(t){console.error("[Xbox Live] Error getting leaderboard: ",t)}},f.acts=new y,v.prototype.ErrorMessage=function(t){t.set_string(this.errorMessage)},v.prototype.AgeGroup=function(t){t.set_string(s?s.ageGroup:"")},v.prototype.GamerTag=function(t){t.set_string(s?s.gamertag:"")},v.prototype.WebAccountId=function(t){t.set_string(s?s.webAccountId:"")},v.prototype.XboxUserId=function(t){t.set_string(s?s.xboxUserId:"")},v.prototype.UserAppDisplayName=function(t){t.set_string(r)},v.prototype.UserGameDisplayName=function(t){t.set_string(l)},v.prototype.UserAppDisplayPictureUri=function(t){t.set_string(c)},v.prototype.UserGameDisplayPictureUri=function(t){t.set_string(u)},v.prototype.GamerScore=function(t){t.set_string(h)},v.prototype.GetStatistic=function(e,t){if(d&&a&&s)try{var i=p().getStatistic(s,t);if(1===i.dataType)e.set_any(i.asNumber);else e.set_any(i.asString)}catch(t){e.set_int(0)}else e.set_int(0)},v.prototype.LeaderboardDisplayName=function(t){t.set_string(this.lastLeaderboard?this.lastLeaderboard.displayName:"")},v.prototype.LeaderboardTotalRows=function(t){t.set_int(this.lastLeaderboard?this.lastLeaderboard.totalRowCount:0)},v.prototype.LeaderboardResultCount=function(t){t.set_int(this.lastLeaderboard?this.lastLeaderboard.rows.length:0)},v.prototype.LeaderboardResultGamerTagAt=function(t,e){var i=this.getLeaderboardRowAt(e);t.set_string(i?i.gamertag:"")},v.prototype.LeaderboardResultXboxUserIdAt=function(t,e){var i=this.getLeaderboardRowAt(e);t.set_string(i?i.xboxUserId:"")},v.prototype.LeaderboardResultRankAt=function(t,e){var i=this.getLeaderboardRowAt(e);t.set_int(i?i.rank:0)},v.prototype.LeaderboardResultValueAt=function(t,e){var i=this.getLeaderboardRowAt(e);t.set_string(i?i.values[0]:"")},f.exps=new v}(),drama.plugins_.xfAd=function(t){this.runtime=t},function(){var t=drama.plugins_.xfAd.prototype;t.Type=function(t){this.plugin=t,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t){this.type=t,this.runtime=t.runtime};var e=t.Instance.prototype;e.onCreate=function(){this.isH5Ad="h5"==xfConfig.exportType||"minigame"==xfConfig.exportType,this.isCordovaAd="cordova"==xfConfig.exportType,this.channel="",this.h5AdTypes=[],this.cordovaTypes=null,this._isAdInit=!1,this.mixappid="",this.pid="",this.space="",this.h5AdConfig={},this.interstitialShowtimes=0,this.videoShowtimes=0,this.isFirst=!0,this.hasLoadedVideoAD=!1,this.loadingVideoAD=!1,this.runtime.tickMe(this)},e.tick=function(){if(this.isFirst){this.isFirst=!1;if(xf.gameInfo.adTag)console.log("----广告开关打开----开始初始化广告----"),this.initAdvert();else this.runtime.trigger(s.prototype.onAdInitFailed,this)}},e.initAdvert=function(){if("preview"==xfConfig.exportType)console.log("preview 不需要广告"),this.runtime.trigger(s.prototype.onAdInitFailed,this);else if(this.isH5Ad)this.initH5Advert();else if(this.isCordovaAd)this.initCordovaAdvert()},e.initH5Advert=function(){var e=this,i=this.runtime;if(this.channel=window.xsSdk.getChannelCode(),e.ad=window.xsSdk.getAd(),!e.ad)return console.log("获取不到广告实例"),void i.trigger(s.prototype.onAdInitFailed,e);console.log("开始初始化h5广告---channel:"+this.channel),e.ad.init(function(t){if(t&&1==t.state)console.log("初始化h5广告成功"),e.pid=t.pid,e.h5AdTypes=e.ad.types(),console.log("支持调用的广告类型",e.h5AdTypes),e.initH5AdConfig(),e._isAdInit=!0,i.trigger(s.prototype.onAdInitSuccess,e);else i.trigger(s.prototype.onAdInitFailed,e)})},e.initCordovaAdvert=function(){var e=this,i=this.runtime;console.log("开始初始化corodva广告"),cordova.plugins.SeiyaSdk.initAd(function(t){console.log("初始化cordova广告成功".concat(t)),e._isAdInit=!0,e.cordovaTypes=JSON.parse(t),e.addCordovaAdEventListener(),i.trigger(s.prototype.onAdInitSuccess,e)},function(t){console.log("初始化cordova广告失败".concat(t)),i.trigger(s.prototype.onAdInitFailed,e)})},e.initH5AdConfig=function(){var i=this,n=this.channel;if("minigame"==xfConfig.exportType)n=xfConfig.channel;this.h5AdTypes.map(function(t){var e={};if(n&&xfConfig.ad[n]&&xfConfig.ad[n][t])e.mixappid=xfConfig.ad[n][t].appId,e.space=xfConfig.ad[n][t].spaceId;i.h5AdConfig[t]=e})},e.addCordovaAdEventListener=function(){var e=this;document.addEventListener("onADShowd",function(t){e.handleCordovaEventListener("onADShowd",t)}),document.addEventListener("onADFailed",function(t){e.handleCordovaEventListener("onADFailed",t)}),document.addEventListener("onADClosed",function(t){e.handleCordovaEventListener("onADClosed",t)}),document.addEventListener("onAdClick",function(t){e.handleCordovaEventListener("onAdClick",t)}),document.addEventListener("onVideoADComoleted",function(t){e.handleCordovaEventListener("onVideoADComoleted",t)}),document.addEventListener("onAdTrackResult",function(t){e.handleCordovaEventListener("onAdTrackResult",t)}),document.addEventListener("onVideoLoaded",function(t){e.handleCordovaEventListener("onVideoLoaded",t)}),document.addEventListener("onVideoLoadFaild",function(t){e.handleCordovaEventListener("onVideoLoadFaild",t)})},e.handleCordovaEventListener=function(t,e){var i=this,n=this.runtime;if(void 0!==e.originalEvent)e=e.originalEvent;var r=e.detail||e.data||e,o=e.adtype;switch(t){case"onADShowd":if("banner"===r.adtype)console.log("banner 广告播放成功"),n.trigger(s.prototype.onBannerShow,i);else if("interstitial"===r.adtype)console.log("插页 广告播放成功"),n.trigger(s.prototype.onInterstitialShow,i);else if("video"===r.adtype)console.log("视频 广告播放成功"),n.trigger(s.prototype.onVideoShow,i);break;case"onADFailed":if("banner"===r.adtype)console.log("banner 广告播放失败"+r.reason),n.trigger(s.prototype.onBannerFailToLoad,i),n.trigger(s.prototype.onBannerPlayFailed,i);else if("interstitial"===r.adtype)console.log("插页 广告播放失败"+r.reason),n.trigger(s.prototype.onInterstitialFailToLoad,i),n.trigger(s.prototype.onInterstitialPlayFailed,i);else if("video"===r.adtype)console.log("视频 广告播放失败"+r.reason),n.trigger(s.prototype.onVideoPlayFailed,i);break;case"onADClosed":if("interstitial"===r.adtype)console.log("关闭插页广告"),n.trigger(s.prototype.onInterstitialDismiss,i);else if("video"===r.adtype)setTimeout(function(){if(console.log("关闭视频广告"),n.trigger(s.prototype.onVideoDismiss,i),i.videoCompleted)n.trigger(s.prototype.onVideoCompletedDismiss,i)},500);else if("banner"==r.adtype)console.log("关闭banner广告");break;case"onAdClick":if("interstitial"===r.adtype)console.log("点击了插页广告");else if("video"===r.adtype)console.log("点击了视频广告");else if("banner"==r.adtype)console.log("点击了banner广告");break;case"onVideoADComoleted":i.videoCompleted=!0,console.log("视频广告播放完成"),setTimeout(function(){n.trigger(s.prototype.onVideoCompleted,i)},500);break;case"onAdTrackResult":i.reportCordovaAdPoint(o,r);break;case"onVideoLoaded":if(!i.hasLoadedVideoAD)i.hasLoadedVideoAD=!0,i.loadingVideoAD=!1,n.trigger(s.prototype.onVideoLoaded,i);break;case"onVideoLoadFaild":i.loadingVideoAD=!1,n.trigger(s.prototype.onVideoFailToLoad,i)}},e.playH5Ad=function(e){var i=this,n=this.runtime;this.updateH5ReportId(e);var r=i.ad[e]({appId:this.mixappid,spaceId:this.space});if(!r.hasOwnProperty("canPlay"))return console.log("广告实例没有canPlay方法"),!1;r.canPlay(function(t){if(t&&1==t.state)r.play({onStart:function(t){if(console.log("广告开始播放"),"rewardVideo"===e)i.reportAdPoint("video","show"),i.reportAdPoint("video","videoPlay"),n.trigger(s.prototype.onVideoShow,i);if("banner"===e)i.reportAdPoint("banner","show"),n.trigger(s.prototype.onBannerShow,i);if("interstitial"===e)i.reportAdPoint("interstitial","show"),n.trigger(s.prototype.onInterstitialShow,i)},onError:function(t){console.log("广告播放出错",t),i.failToShowAdvert(e)},onFinish:function(t){if(console.log("广告播放结束",t),"rewardVideo"===e)i.videoCompleted=!0,i.reportAdPoint("video","videoDone"),setTimeout(function(){n.trigger(s.prototype.onVideoCompleted,i)},500);if("banner"===e)n.trigger(s.prototype.onBannerCompleted,i);if("interstitial"===e)n.trigger(s.prototype.onInterstitialCompleted,i)},onClose:function(t){if(console.log("广告被关闭",t),"rewardVideo"===e)if(i.reportAdPoint("video","close"),i.videoCompleted)setTimeout(function(){n.trigger(s.prototype.onVideoDismiss,i),n.trigger(s.prototype.onVideoCompletedDismiss,i)},500);else n.trigger(s.prototype.onVideoDismiss,i);if("banner"===e)i.reportAdPoint("banner","close"),n.trigger(s.prototype.onBannerDismiss,i);if("interstitial"===e)i.reportAdPoint("interstitial","close"),n.trigger(s.prototype.onInterstitialDismiss,i)},onClick:function(t){if(console.log("广告被点击",t),"rewardVideo"===e)i.reportAdPoint("video","click");if("banner"===e)i.reportAdPoint("banner","click");if("interstitial"===e)i.reportAdPoint("interstitial","click")}});else console.log("播放"+e+"广告失败"+JSON.stringify(t)),i.failToShowAdvert(e)})};var n={unknow:0,request:10,show:20,click:30,videoPlay:80,videoDone:85,close:90,0:"unknow",10:"request",20:"show",30:"click",80:"videoPlay",85:"videoDone",90:"close",adLoad:"request",adShow:"show",adClicked:"click",adClosed:"close",playStarted:"videoPlay",playCompleted:"videoDone"};function s(){}function i(){}e.reportCordovaAdPoint=function(t,e){var i=e.type;if(console.log("广告回调类型"+t),n[t])this.pid=e.pid,this.mixappid=e.appid,this.space=e.spaceid,this.reportAdPoint(i,n[t]);else console.log(t+" 不用上报")},e.updateH5ReportId=function(t){var e="video"==t?"rewardVideo":t,i=this.channel;if("minigame"==xfConfig.exportType)i=xfConfig.channel;if(i&&xfConfig.ad[i]&&xfConfig.ad[i][e])return this.mixappid=xfConfig.ad[i][e].appId,this.space=xfConfig.ad[i][e].spaceId,!0;else return!1},e.reportAdPoint=function(t,e){if(this.isH5Ad)this.updateH5ReportId(t);if(console.log("上报广告打点: adtype: "+t+"; step:"+n[e]+e+"; pid:"+this.pid+"; spaceid:"+this.space+"; appid:"+this.mixappid),t&&this.pid&&this.space&&this.mixappid&&(0==n[e]||n[e]))xf.cloudLadderSDK.doReportEvent("mix_ad",{mixappid:this.mixappid.toString(),pid:this.pid.toString(),space:this.space.toString(),type:t,step:n[e]});else console.log("上报参数不齐: failed")},e.failToShowAdvert=function(t){switch(t="rewardVideo"==t?"video":t){case"banner":this.runtime.trigger(s.prototype.onBannerPlayFailed,this);break;case"interstitial":this.runtime.trigger(s.prototype.onInterstitialPlayFailed,this);break;case"video":this.runtime.trigger(s.prototype.onVideoPlayFailed,this)}},e.requestShowAd=function(t){var e="video"==t?"rewardVideo":t;if(!this._isAdInit||"preview"==xfConfig.exportType)return console.log("preview 环境或广告未初始化成功不播放广告----"+t),void this.failToShowAdvert(t);if(console.log("request-playAd-"+t),this.isH5Ad)this.reportAdPoint(t,"request"),this.playH5Ad(e);else if(this.isCordovaAd)switch(t){case"banner":cordova.plugins.SeiyaSdk.showBannerAd();break;case"interstitial":cordova.plugins.SeiyaSdk.showInterstitialAd();break;case"video":cordova.plugins.SeiyaSdk.showVideoAd()}},e.isSupportVideo=function(){if(this.isH5Ad)return-1!==this.h5AdTypes.indexOf("rewardVideo");if(this.isCordovaAd)return this.cordovaTypes.video;else return},s.prototype.onAdInitSuccess=function(){return!0},s.prototype.onAdInitFailed=function(){return!0},s.prototype.isSupportInterstitial=function(){if(this.isH5Ad)return-1!==this.h5AdTypes.indexOf("intertistial");if(this.isCordovaAd)return this.cordovaTypes.intertistial;else return},s.prototype.isSupportVideo=function(){return this.isSupportVideo()},s.prototype.onBannerFailToLoad=function(){return!0},s.prototype.onVideoFailToLoad=function(){return!0},s.prototype.onInterstitialFailToLoad=function(){return!0},s.prototype.onVideoLoaded=function(){return!0},s.prototype.hasLoadedVideoAD=function(){return this.hasLoadedVideoAD},s.prototype.onBannerShow=function(){return!0},s.prototype.onInterstitialShow=function(){return this.interstitialShowtimes++,!0},s.prototype.onVideoShow=function(){return this.videoShowtimes++,!0},s.prototype.onBannerPlayFailed=function(){return!0},s.prototype.onInterstitialPlayFailed=function(){return!0},s.prototype.onVideoPlayFailed=function(){return!0},s.prototype.onInterstitialDismiss=function(){return!0},s.prototype.onVideoDismiss=function(){return!0},s.prototype.onVideoCompleted=function(){return!0},s.prototype.onVideoCompletedDismiss=function(){return!0},t.cnds=new s,i.prototype.showBannerAd=function(){},i.prototype.removeBannerAd=function(){if(this.isH5Ad)this.ad.banner&&this.ad.banner().destroy();else if("cordova"==this.runtime.exportType)cordova.plugins.SeiyaSdk.hideBannerAd()};var r=null;function o(){}i.prototype.preloadVideo=function(){var e=this;if(!this.hasLoadedVideoAD)if(!this.loadingVideoAD)if(this.isSupportVideo())if(this.loadingVideoAD=!0,this.reportAdPoint("video","request"),this.isH5Ad){var t=this.h5AdConfig.rewardVideo;(r=this.ad.rewardVideo({appId:t.mixappid||"",spaceId:t.space||""})).canPlay(function(t){if(t&&1===t.state)e.hasLoadedVideoAD=!0,e.loadingVideoAD=!1,e.runtime.trigger(s.prototype.onVideoLoaded,e)})}else if(this.isCordovaAd)cordova.plugins.SeiyaSdk.loadVideoAD()},i.prototype.showLoadedVideoAD=function(){var e=this;if(e.hasLoadedVideoAD)if(e.hasLoadedVideoAD=!1,e.videoCompleted=!1,e.isH5Ad){var t={onStart:function(t){console.log("广告开始播放"),e.reportAdPoint("video","show"),e.reportAdPoint("video","videoPlay"),e.runtime.trigger(s.prototype.onVideoShow,e)},onError:function(t){console.log("广告播放出错",t),e.failToShowAdvert("rewardVideo")},onFinish:function(t){console.log("广告播放结束",t),e.videoCompleted=!0,e.reportAdPoint("video","videoDone"),setTimeout(function(){e.runtime.trigger(s.prototype.onVideoCompleted,e)},500)},onClose:function(t){if(console.log("广告被关闭",t),e.reportAdPoint("video","close"),e.videoCompleted)setTimeout(function(){e.runtime.trigger(s.prototype.onVideoDismiss,e),e.runtime.trigger(s.prototype.onVideoCompletedDismiss,e)},500);else e.runtime.trigger(s.prototype.onVideoDismiss,e)},onClick:function(t){console.log("广告被点击",t),e.reportAdPoint("video","click")}};r.play(t)}else if(this.isCordovaAd)cordova.plugins.SeiyaSdk.playVideoAD()},i.prototype.showInterstitialAd=function(){this.requestShowAd("interstitial")},i.prototype.showVideoAd=function(){this.videoCompleted=!1,this.requestShowAd("video")},t.acts=new i,o.prototype.RewardValue=function(t){t.set_float(0)},o.prototype.VideoAdShowTimes=function(t){t.set_float(this.videoShowtimes||0)},o.prototype.InterstitialShowTimes=function(t){t.set_float(this.interstitialShowtimes||0)},t.exps=new o}(),drama.plugins_.xfAvgDialogue=function(t){this.runtime=t},function(){var s=0,t=1,e=drama.plugins_.xfAvgDialogue.prototype;e.Type=function(t){this.plugin=t,this.runtime=t.runtime},e.Type.prototype.onCreate=function(){if(!this.is_family)xf.formatAnimation(this)},e.Instance=function(t){this.type=t,this.runtime=t.runtime};var i=e.Instance.prototype;function n(){}function r(){}function o(){}i.onCreate=function(){xf.testTypeImage(this.type),this.dialogues=this.properties[0],this.styles=this.properties[1],this.visible=this.properties[2],this.volume=this.properties[3],this.clickZone=this.properties[4],this.currentAnimations=[],this.skip=0,this.currentText=null,this.currentIndex=0,this.totalDialogues=this.dialogues.length,this.currentIndex=0,this.speed=this.properties[5]||10,this.autoplay=!1,this.pause=!1,this.isEnd=!1,this.isFirstReady=!1,this.audioInst=xf.audioInstance(this.runtime),this.runtime.tickMe(this),xf.loadTextures(this.type),this.nameText=this.initText(),this.contentText=this.initText(),this.contentText.defaultStyle.vAlign="top",this.contentText.setTypeComplete(this.textCompleteHand,this),this.backGroundImg=new xf.xfImage,this.avatarImg=new xf.xfImage,this.container=new xf.xfContainer,(this.container.owner=this).container.addChild(this.backGroundImg),this.container.addChild(this.avatarImg),this.container.addChild(this.nameText),this.container.addChild(this.contentText),this.container.x=~~this.x,this.container.y=~~this.y,this.container.width=this.width,this.container.height=this.height,this.originOpacity=this.opacity,this.container.alpha=this.opacity,this.contentIndexTextCount={},this.regGlobal=/\@\s*↵*\s*\[\s*↵*\s*[\u4E00-\u9FA5|\w]+\s*↵*\s*\]/gm},i.initText=function(){var t=new xf.xfText;return t.defaultStyle=new xf.TextStyle,t.defaultStyle.vAlign="top",t.defaultStyle.line_vAlign="top",t.defaultStyle.hAlign="left",t},i.clickHand=function(){if(this.contentText.isTypeState)this.contentText.setTypewriterEnable(!1),this.textCompleteHand();else if(!this.isEnd&&!this.pause)this.currentIndex++,this.getFrameReady()},i.autoPlayFunc=function(){this.handTick()},i.textCompleteHand=function(){this.isIndexEnd=!0,this.runtime.trigger(drama.plugins_.xfAvgDialogue.prototype.cnds.OnDialogueIndex,this),this.runtime.trigger(drama.plugins_.xfAvgDialogue.prototype.cnds.OnDialogueCount,this),this.isIndexEnd=!1,this.handTick()},i.handTick=function(){if(this.isJump=!1,!this.isEnd)if(this.contentText.isTypeComplete||!this.contentText.isTypeState){if(this.labelStatus=t,this.runtime.trigger(drama.plugins_.xfAvgDialogue.prototype.cnds.OnLabelActive,this),this.currentIndex>=this.totalDialogues-1)return this.isEnd=!0,void this.runtime.trigger(drama.plugins_.xfAvgDialogue.prototype.cnds.OnDialogueEnd,this);if(this.autoplay&&!this.pause)this.currentIndex++,this.getFrameReady()}},i.goSepIndex=function(t){this.currentIndex=t,this.getFrameReady()},i.getFrameReady=function(){var i=this;if(!Array.isArray(this.dialogues)||0==this.dialogues.length)this.dialogues=[{styleIndex:1}];if(Array.isArray(this.styles)&&0!=this.styles.length){if(!this.dialogues[this.currentIndex].styleIndex||0==this.dialogues[this.currentIndex].styleIndex)this.dialogues[this.currentIndex].styleIndex=1;if(0==this.currentIndex)i.runtime.trigger(drama.plugins_.xfAvgDialogue.prototype.cnds.OnDialogueStart,i);var t=this.dialogues[this.currentIndex].styleIndex-1,e=this.styles[t],n=this.type.animations[2*t+1];n.styles=e;var r=this.type.animations[2*t];r.styles=e,this.width=e.w,this.height=e.h,this.set_bbox_changed(),this.currentAnimations=[r,n],this.currentText=this.dialogues[this.currentIndex],this.isIndexStart=!0,this.runtime.trigger(drama.plugins_.xfAvgDialogue.prototype.cnds.OnDialogueIndex,this),this.isIndexStart=!1;try{this.audioInst.Stop("xfAvgDialogue"+this.uid),this.audioInst.Play([this.currentText.audio.split(".")[0],!0],0,this.volume/100,"xfAvgDialogue"+this.uid)}catch(t){}this.currentAnimations.map(function(t,e){i.drawFrame(t,e)}),e.speed=~~e.speed,this.contentText.typeInterval=Math.floor(1e3/(~~this.speed+~~e.speed)),this.contentText.setTypewriterEnable(!0),this.contentIndexTextCount[this.currentIndex]=[];var o=this.currentText;this.drawText(o.nickname||e.roleName,e.nameProp,this.nameText,e,"avatar"),this.drawText(o.content||"",e.contentProp,this.contentText,e,"content"),this.labelStatus=s,this.runtime.trigger(drama.plugins_.xfAvgDialogue.prototype.cnds.OnLabelActive,this)}},i.tick=function(){if(this.originOpacity!=this.opacity)this.container.alpha=this.opacity,this.originOpacity=this.opacity;this.container.x=this.x,this.container.y=this.y,this.container.rotation=this.angle,this.container.anchorOffsetX=this.container.width*this.hotspotX,this.container.anchorOffsetY=this.container.height*this.hotspotY;var t={};if(!this.isFirstReady){if(this.getFrameReady(),this.isFirstReady=!0,this.event=xf.XfEvent.create(this.runtime),1==this.clickZone)t.isClickCanvas=!0,t.isTouchStartCanvas=!0;this.event.addEventListener("touchstart",function(t){this.clickHand(t)},this,t),this.event.addEventListener("click",function(t){this.clickHand(t)},this,t)}if(this.autoplay)this.autoPlayFunc();this.runtime.trigger(drama.plugins_.xfAvgDialogue.prototype.cnds.OnDialogueCount,this),this.runtime.redraw=!0},i.drawFrame=function(t,e){var i,n,r,o,s=this.backGroundImg,a=t.frames[0];if(1==e)i=t.styles.w,n=t.styles.h,o=r=0,s=this.backGroundImg;else{if(!t.styles.avatarProp||t.styles.hideHead)return void(this.avatarImg.visible=!1);else this.avatarImg.visible=!0;r=t.styles.avatarProp.x-t.styles.x,o=t.styles.avatarProp.y-t.styles.y,i=t.styles.avatarProp.w,n=t.styles.avatarProp.h,s=this.avatarImg}s.source=a.texture_img,s.x=r,s.y=o,s.width=i,s.height=n},i.drawText=function(t,e,i,n){if(t=t||"",t=this.regVariable(t),i.defaultStyle.hAlign=e.align||"left",i.defaultStyle.color=xf.hexaDecimal(e.color),i.defaultStyle.fontFamily=e.font.split(".")[0],i.defaultStyle.size=e.fontSize,i.lineSpace=e.lineSpace,i.alpha=e.color[3],e.isRichLabel)i.richText=t;else i.text=t;i.x=e.x-n.x,i.y=e.y-n.y,i.width=e.w,i.height=e.h},i.regVariable=function(t){var e=t.match(this.regGlobal);if(e&&0<e.length)for(var i=0,n=e.length;i<n;i++){var r=e[i].replace(/\@\s*↵*\s*\[\s*↵*\s*/g,"").replace(/\s*↵*\s*]/g,"");if(r){var o=this.runtime.varsByName[r];if(!o)o=this.runtime.varsByLowerName[r.toLowerCase()];if(!o)continue;var s=o.data;if(2==o.vartype)s=o.data?"真":"假";t=t.replace(e[i],s)}}return t},i.draw=function(t){this.container.draw(t,this.runtime)},i.drawGL=function(t){this.container.drawGL(t,this.runtime)},i.saveToJSON=function(){return{currentIndex:this.currentIndex}},i.loadFromJSON=function(t){this.currentIndex=t.currentIndex,this.autoplay=!1,this.skip=0,this.isEnd=!1,this.getFrameReady()},i.onDestroy=function(){if(this.skip=0,this.autoplay=!1,this.contentText.setTypewriterEnable(!1),this.audioInst&&this.audioInst.Stop("xfAvgDialogue"+this.uid),this.isEnd=!1,this.event)this.event.removeEventListeners(["click","touchstart"],this);if(this.container)this.container.destory(),this.container=null;this.avatarImg=null,this.nameText=null,this.contentText=null,this.backGroundImg=null,this.contentIndexTextCount=null},n.prototype.OnClicked=function(){return!0},n.prototype.OnDialogueStart=function(){return!0},n.prototype.OnLabelActive=function(e,t){if((t=null==t?1:t)!=this.labelStatus)return!1;if("string"==typeof e&&this.currentText&&this.currentText.label){var i=this.currentText.label.split(","),n=!1;return i.forEach(function(t){if(t==e)n=!0}),n}return!1},n.prototype.OnDialogueEnd=function(){return!0},n.prototype.OnDialogueIndex=function(t,e){if(assert2(null!=t,"缺少索引参数"),assert2(null!=e,"缺少状态参数"),t==this.currentIndex&&0==e&&this.isIndexStart)return!0;else if(t==this.currentIndex&&1==e&&this.isIndexEnd)return!0;else return!1},n.prototype.OnDialoguePlaying=function(t,e){if(assert2(null!=t,"缺少选择对话参数"),assert2(null!=e,"缺少索引或标签参数"),0==t){if(e=Number(e),Number(e)==this.currentIndex&&!this.contentText.isTypeComplete)return!0}else if(1==t){if("string"==typeof e&&this.currentText&&this.currentText.label&&!this.contentText.isTypeComplete){var i=this.currentText.label.split(","),n=!1;return i.forEach(function(t){if(t==e)n=!0}),n}}else return!1},n.prototype.OnDialogueCount=function(t){assert2(void 0!==t,"缺少字数参数");var e=this.contentText.typeIndex;if(0==e)return!1;if(!this.contentText.isTypeComplete){if(t-1==(e=0!=e?e-1:0)&&!this.contentIndexTextCount[this.currentIndex][e])return this.contentIndexTextCount[this.currentIndex][e]=!0}else if(e<t&&!this.contentIndexTextCount[this.currentIndex][e])return this.contentIndexTextCount[this.currentIndex][e]=!0;else return!1},e.cnds=new n,r.prototype.StartDialogue=function(){if(this.currentIndex!=this.totalDialogues-1)this.currentIndex++,this.getFrameReady()},r.prototype.AutoPlay=function(){this.autoplay=!0},r.prototype.StopAutoPlay=function(){this.autoplay=!1},r.prototype.Skip=function(){this.skip=1,this.currentIndex=this.totalDialogues-1,this.goSepIndex(this.currentIndex)},r.prototype.SetSpeed=function(t){if(!this.dialogues[this.currentIndex].styleIndex||0==this.dialogues[this.currentIndex].styleIndex)this.dialogues[this.currentIndex].styleIndex=1;var e=this.dialogues[this.currentIndex].styleIndex-1,i=this.styles[e];if(this.speed=~~t,100<=this.speed)this.speed=100;i.speed=~~i.speed,this.contentText.typeInterval=Math.floor(1e3/(this.speed+i.speed))},r.prototype.ResetDialogue=function(){this.currentIndex=0,this.isEnd=!1,this.getFrameReady()},r.prototype.SetVolume=function(t){if(this.volume=t,this.audioInst)this.audioInst.SetVolume(t/100)},r.prototype.JumpDialogue=function(t){if(t<=this.totalDialogues-1)this.isJump=!0,this.isEnd=!1,this.currentIndex=t,this.getFrameReady()},r.prototype.EndDialogue=function(){if(this.currentIndex!=this.totalDialogues-1)this.skip=1,this.currentIndex=this.totalDialogues-1,this.getFrameReady()},r.prototype.PauseDialogue=function(){this.pause=!0},r.prototype.ResumeDialogue=function(){this.pause=!1},r.prototype.JumpToLabel=function(n,i){if(assert2(n,"跳转到标签动作缺少第一个参数：标签"),0!=i){i-=1;var r=[],o=this;if(this.dialogues||0!=this.dialogues.length)this.dialogues.map(function(t,e){var i=t.label.split(",");if(t.label==n)r.push(e);else if(-1<i.indexOf(String(n)))r.push(e)}),r.map(function(t,e){if(i===e)o.isJump=!0,o.isEnd=!1,o.currentIndex=t,o.getFrameReady()})}},e.acts=new r,o.prototype.expSkip=function(t){t.set_int(this.skip)},o.prototype.expAutoPlay=function(t){t.set_int(~~this.autoplay)},o.prototype.expSpeed=function(t){t.set_float(this.speed)},o.prototype.playback=function(t){var e=this.currentIndex,i=this.dialogues.slice(0,e+1),r=[],o=this;i.map(function(t){if(!t.styleIndex||0==t.styleIndex)t.styleIndex=1;var e=t.styleIndex-1,i=o.styles[e].roleName,n=t.content||"";r.push(i+"\n"+n)}),t.set_string(r.join("\n"))},o.prototype.expVolume=function(t){t.set_int(this.volume)},o.prototype.expCurrent=function(t){t.set_int(this.currentIndex)},o.prototype.expPause=function(t){t.set_int(~~this.pause)},o.prototype.expCurrentText=function(t){var e="";if(this.currentText&&this.currentText.content)e=this.currentText.content;t.set_string(e)},o.prototype.expCurrentTag=function(t){var e=this.currentIndex,i=this.dialogues[e];t.set_string(i.label)},o.prototype.expCurrentChar=function(t){var e=this.contentText.typeIndex||0;if(this.contentText&&!this.contentText.isTypeComplete)t.set_int(e);else t.set_int(0<e?e-1:0)},o.prototype.expCurrentName=function(t){t.set_string(this.nameText.text?this.nameText.text:"")},e.exps=new o}(),function(i){var n={};function r(t){if(n[t])return n[t].exports;var e=n[t]={i:t,l:!1,exports:{}};return i[t].call(e.exports,e,e.exports,r),e.l=!0,e.exports}r.m=i,r.c=n,r.d=function(t,e,i){if(!r.o(t,e))Object.defineProperty(t,e,{enumerable:!0,get:i})},r.r=function(t){if("undefined"!=typeof Symbol&&Symbol.toStringTag)Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(e,t){if(1&t)e=r(e);if(8&t)return e;if(4&t&&"object"===_typeof(e)&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(i,n,function(t){return e[t]}.bind(null,n));return i},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s="90353b8998219770")}({"0330f9384c2c8825":function(t,e,i){var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=function(i){function t(t){var e=i.call(this)||this;return e._runtime=t.runtime,e._plugin=t,e}return r(t,i),Object.defineProperty(t.prototype,"runtime",{get:function(){return this._runtime},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"plugin",{get:function(){return this._plugin},enumerable:!0,configurable:!0}),t.prototype.onCreate=function(){},t.prototype.Release=function(){this._runtime=null,this._plugin=null},t.prototype.FinishCondition=function(){},t.prototype.LoadTextures=function(){},t.prototype.ReleaseTextures=function(){},t.prototype.OnDynamicTextureLoadComplete=function(){},t.prototype.LoadTilePolyData=function(){},t}(i("d27c30dad6345543").DefendedBase);e.SDKTypeBase=o},"28efaa094fbb6631":function(t,e,i){var n,r,o,s,a,l,c,u,h,d;Object.defineProperty(e,"__esModule",{value:!0}),(n=e.State||(e.State={}))[n.STANDBY=0]="STANDBY",n[n.MATCHING=1]="MATCHING",n[n.MATCHSUCCESS=2]="MATCHSUCCESS",n[n.READY=3]="READY",n[n.FIGHTING=4]="FIGHTING",(r=e.Compare||(e.Compare={}))[r.EQUAL_TO=0]="EQUAL_TO",r[r.NOT_EQUAL_TO=1]="NOT_EQUAL_TO",r[r.LESS_THAN=2]="LESS_THAN",r[r.LESS_OR_EQUAL=3]="LESS_OR_EQUAL",r[r.GREATEROR_THAN=4]="GREATEROR_THAN",r[r.GREATEROR_EQUAL=5]="GREATEROR_EQUAL",(o=e.ConnectedState||(e.ConnectedState={})).CONNECTED="connected",o.INTERNET_WAS_DICONNECTED="disconnection",o.FORCED_OFFLINE="replacement",(s=e.AttackerOrder||(e.AttackerOrder={}))[s.MYSELF=0]="MYSELF",s[s.ENEMY=1]="ENEMY",(a=e.PlayerType||(e.PlayerType={}))[a.REAL=0]="REAL",a[a.AI=1]="AI",(l=e.MatchType||(e.MatchType={})).ALL="ALL",l.ONLINE="ONLINE",l.OFFLINE="OFFLINE",(c=e.Order||(e.Order={})).DESC="desc",c.ASC="asc",(u=e.SocketState||(e.SocketState={}))[u.ENABLE=0]="ENABLE",u[u.DISABLE=1]="DISABLE",(h=e.HostActionType||(e.HostActionType={}))[h.JOIN=0]="JOIN",h[h.EXIT=1]="EXIT",(d=e.CancelReady||(e.CancelReady={}))[d.MYSELF=0]="MYSELF",d[d.ENEMY=1]="ENEMY"},"35253ef732481ee8":function(t,e,i){var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i("f70bd163b03dc1f8"),s=i("28efaa094fbb6631"),a=i("8e6337f78bfb827e"),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.getParamCount=function(t,e){if(this.state===s.State.FIGHTING&&this.message){if(e&&e===this.message.pkAction)t.set_int(this.params.length)}else t.set_any("")},e.prototype.getParam=function(t,e,i,n){if(this.state===s.State.FIGHTING&&this.message&&this.myNumber!==e-1)if(!(e>this.players.length||e<0||this.noMap[this.message.senderId]+1!==e)){if(n<0||n>this.params.length-1)return a.Logger.error("对战数据序号边界异常，数据长度：",this.params.length),void t.set_any("");if(i&&i===this.message.pkAction)t.set_any(this.params[n])}else t.set_any("");else t.set_any("")},e.prototype.getEnemyGlobalVar=function(t,e,i){if(this.state===s.State.FIGHTING||this.state===s.State.MATCHSUCCESS){if(e>this.players.length||e<1)return a.Logger.error("玩家编号边界异常，玩家人数：",this.players.length),void t.set_any("");if(this.myNumber!==e-1){var n=this.globalVarSidMap[i],r=this.players[e-1].globalVariable;t.set_any(r[n]||"")}else t.set_any("")}else t.set_any("")},e.prototype.getRoundLastTime=function(t){if(this.state===s.State.FIGHTING)t.set_int(this.lastTime/1e3);else t.set_any("")},e.prototype.getSenderID=function(t){if(this.state===s.State.FIGHTING&&this.message)t.set_int(this.noMap[this.message.senderId]+1);else t.set_any("")},e.prototype.getCurPlayer=function(t){if(this.state===s.State.MATCHSUCCESS||this.state===s.State.FIGHTING)t.set_int(this.myNumber+1);else t.set_any("")},e.prototype.getInviteCode=function(t){t.set_string(this.inviteCode)},e.prototype.getEnterErrorCode=function(t){t.set_string(this.enterErrorCode)},e.prototype.getUserCountInRoom=function(t){t.set_int(this.userCount)},e}(o.default);e.default=l},"390396105bc13f81":function(t,e,i){var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.onCreate=function(){},e}(i("0330f9384c2c8825").SDKTypeBase);e.default=o},"3f98e0ac43cc66a2":function(t,e,i){Object.defineProperty(e,"__esModule",{value:!0});var n=function(){this.playerTotal=null,this.matchType=null,this.matchTimeout=null,this.matchRule=null,this.orderRule=null,this.order=null,this.roundTimeout=null};e.default=n},"8e6337f78bfb827e":function(t,e,i){Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(){}return t.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(window.xfConfig.enableLogger)console.log.apply(console,t)},t.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(window.xfConfig.enableLogger)console.warn.apply(console,t)},t.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(window.xfConfig.enableLogger)console.error.apply(console,t)},t.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(window.xfConfig.enableLogger)console.debug.apply(console,t)},t.trace=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(window.xfConfig.enableLogger)console.trace.apply(console,t)},t}();e.Logger=n},"90353b8998219770":function(t,e,i){var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i("e7b602c229ac5b71"),s=i("390396105bc13f81"),a=i("f70bd163b03dc1f8"),l=i("f8bf1888467a27ff"),c=i("da18b2e2ab864db8"),u=i("35253ef732481ee8");window.assert2(drama,"drama namespace not created"),window.assert2(drama.plugins_,"drama.plugins_ not created");var h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e}(o.SDKPluginBase);h.prototype.Instance=a.default,h.prototype.Type=s.default,h.prototype.cnds=new l.default({}),h.prototype.exps=new u.default({}),h.prototype.acts=new c.default({}),window.drama.plugins_.battle=h},c5cd1ff76221c1b3:function(t,e,i){Object.defineProperty(e,"__esModule",{value:!0}),e.values=function(t){var e=[];for(var i in t)if(t.hasOwnProperty(i))e.push(t[i]);return e},e.random=function(t,e){},e.randomArr=function(t){if(0===t.length)return null;else return t[Math.round(Math.random()*(t.length-1))]}},d27c30dad6345543:function(t,e,i){Object.defineProperty(e,"__esModule",{value:!0});var n=function(){};e.DefendedBase=n},da18b2e2ab864db8:function(t,e,i){var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i("f70bd163b03dc1f8"),s=i("28efaa094fbb6631"),a=i("8e6337f78bfb827e"),l=i("c5cd1ff76221c1b3"),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.startMatch=function(){if(this.state===s.State.STANDBY&&!o.default.Instance){var t=new game.BattleStartMatchReq;t.instanceId=String(this.uid),t.pluginId=String(this.puid),xf.PacketUtils.sendPacket(game.MsgType.BATTLE_START_MATCH_REQ,game.BattleStartMatchReq.encode(t).finish()),o.default.Instance=this,a.Logger.info("动作：开始匹配")}},e.prototype.stopMatch=function(){if(!this.inviteCode)if(this.state===s.State.MATCHING){(t=new game.BattleStopMatchReq).instanceId=String(this.uid),t.pluginId=String(this.puid),xf.PacketUtils.sendPacket(game.MsgType.BATTLE_STOP_MATCH_REQ,game.BattleStopMatchReq.encode(t).finish()),a.Logger.info("动作：停止匹配")}else if(this.state===s.State.MATCHSUCCESS){var t;(t=new game.BattleCancelMatchReq).instanceId=String(this.uid),t.pluginId=String(this.puid),t.roomId=this.roomId,xf.PacketUtils.sendPacket(game.MsgType.BATTLE_CANCEL_MATCH_REQ,game.BattleCancelMatchReq.encode(t).finish()),a.Logger.info("动作：取消匹配")}},e.prototype.ready=function(){if(this.state===s.State.MATCHSUCCESS){var t=new game.BattleReadyPKReq;t.instanceId=String(this.uid),t.pluginId=String(this.puid),t.roomId=this.roomId,t.round=1,t.attackerId=this.attacker.cid,xf.PacketUtils.sendPacket(game.MsgType.BATTLE_READY_PK_REQ,game.BattleReadyPKReq.encode(t).finish()),a.Logger.info("动作：准备对战")}},e.prototype.cancelReady=function(){if(this.state===s.State.READY){var t=new game.BattleCancelReadyPKReq;t.instanceId=String(this.uid),t.pluginId=String(this.puid),t.roomId=this.roomId,xf.PacketUtils.sendPacket(game.MsgType.BATTLE_CANCEL_READY_PK_REQ,game.BattleCancelReadyPKReq.encode(t).finish()),a.Logger.info("动作：取消准备")}},e.prototype.quitBattle=function(t,e){if(this.state===s.State.FIGHTING){if(t===s.AttackerOrder.MYSELF)e=this.myNumber+1;else{if(e===this.myNumber+1)return;if(0===e){for(var i=[],n=0;n<this.players.length;n++)if(!this.players[n].isQuitBattle&&this.players[n].cid!==xf.gameInfo.characterId)i.push(n);if(null!==(e=l.randomArr(i)))e+=1;else return}}this.stopPK(this.players[e-1].cid)}},e.prototype.finishRound=function(t,e){if(this.state===s.State.FIGHTING)if(!(e>this.players.length||e<0)){if(t===s.AttackerOrder.MYSELF)e=this.myNumber+1;else{if(e===this.myNumber+1)return;if(0===e){for(var i=[],n=0;n<this.players.length;n++)if(this.players[n].cid!==xf.gameInfo.characterId)i.push(n);e=l.randomArr(i)+1}}a.Logger.info("动作：结束回合"),this.sendFinishRound(this.players[e-1].cid)}else a.Logger.error("玩家编号边界异常，玩家人数：",this.players.length)},e.prototype.postAction=function(t,e){if(this.state===s.State.FIGHTING){a.Logger.info("动作：广播对战数据",t,e);var i=new game.BattlePostActionReq;i.instanceId=String(this.uid),i.pluginId=String(this.puid),i.roomId=this.roomId,i.pkAction=t,i.pkParams=JSON.stringify(e),xf.PacketUtils.sendPacket(game.MsgType.BATTLE_POST_ACTION_REQ,game.BattlePostActionReq.encode(i).finish())}},e.prototype.finishBattle=function(){if(this.state===s.State.FIGHTING){a.Logger.info("动作：结束对战");var t=new game.BattleFinishPKReq;t.instanceId=String(this.uid),t.pluginId=String(this.puid),t.roomId=this.roomId,xf.PacketUtils.sendPacket(game.MsgType.BATTLE_FINISH_PK_REQ,game.BattleFinishPKReq.encode(t).finish())}},e.prototype.createHost=function(){if(this.isCanJoinHost()){this.creating=!0;var t=new game.BattleCreateRoomReq;t.instanceId=String(this.uid),t.pluginId=String(this.puid),xf.PacketUtils.sendPacket(game.MsgType.BATTLE_CREATE_ROOM_REQ,game.BattleCreateRoomReq.encode(t).finish()),a.Logger.info("动作：创建房间")}},e.prototype.changeHost=function(t,e){if(e)if(t==s.HostActionType.JOIN)this.joinHost(e);else if(t==s.HostActionType.EXIT)this.exitHost(e)},e}(o.default);e.default=c},e681aed280414b09:function(t,e,i){var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=function(i){function t(t){var e=i.call(this)||this;return e.type=t,e.runtime=t.runtime,e}return r(t,i),t.prototype.onCreate=function(){},t.prototype.draw=function(t,e){},t.prototype.drawGL=function(t){},t.prototype.onDestroy=function(){},t.prototype.trigger=function(t){return this.runtime.trigger(t,this)},t.prototype.tick=function(){},t.prototype.GetDebuggerProperties=function(){return[]},t.prototype.SaveToJson=function(){return null},t.prototype.LoadFromJson=function(){},t.prototype.LoadTilemapData=function(){},t.prototype.TestPointOverlapTile=function(){},t.prototype.GetPropertyValueByIndex=function(){},t.prototype.SetPropertyValueByIndex=function(){},t.prototype.SetPropertyOffsetValueByIndex=function(){},t.prototype.SetPropertyColorOffsetValueByIndex=function(){},t.prototype.CallAction=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];t.call.apply(t,[this].concat(e))},t.prototype.CallExpression=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];return t.call.apply(t,[this].concat(e))},t.formatProp=function(t,e,i){var n=e,r=Object.keys(n);return t.properties.forEach(function(t,e){if(e<r.length)if(!i(t,e,r[e]))n[r[e]]=t}),n},t.compareText=function(t,e,i){if("string"!=typeof t||"string"!=typeof i)return!1;switch(e){case 0:return t==i;case 1:return t!=i;case 2:return-1<t.indexOf(i);case 3:return-1==t.indexOf(i);default:return window.assert2(!1,"Invalid comparison value: "+e),!1}},t.prototype.listenMessage=function(t,e,i,n){if(void 0===i)i=null;if(void 0===n)n=0;xf.EventCenter.instance.addEventListener(t,e,i||this,n),this.listenBins=this.listenBins?this.listenBins:[],this.listenBins.push({messageID:t,method:e})},t.prototype.removeAllListen=function(){if(this.listenBins&&this.listenBins.length){for(var t=0,e=this.listenBins;t<e.length;t++){var i=e[t];xf.EventCenter.instance.removeEventListener(i.messageID,i.method,this)}this.listenBins.length=0}},t}(i("d27c30dad6345543").DefendedBase);e.SDKInstanceBase=o},e7b602c229ac5b71:function(t,e,i){var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=function(i){function t(t){var e=i.call(this)||this;return e.runtime=t,e._isSingleGlobal=!!t.isSingleGlobal,e._isWorldType=!!t.isWorld,e._isRotatable=!!t.isRotatable,e._mustPredraw=!!t.mustPredraw,e._hasEffects=!!t.hasEffects,e._singleGlobalObjectClass=null,e}return r(t,i),t.prototype.onCreate=function(){},t.prototype.IsSingleGlobal=function(){return this._isSingleGlobal},t.prototype.IsWorldType=function(){return this._isWorldType},t.prototype.IsRotatable=function(){return this._isRotatable},t.prototype.MustPreDraw=function(){return this._mustPredraw},t.prototype.HasEffects=function(){return this._hasEffects},t.prototype._SetSingleGlobalObjectClass=function(t){if(!this.IsSingleGlobal())throw new Error("must be single-global plugin");this._singleGlobalObjectClass=t},t.prototype.GetSingleGlobalObjectClass=function(){if(!this.IsSingleGlobal())throw new Error("must be single-global plugin");return this._singleGlobalObjectClass},t.prototype.GetSingleGlobalInstance=function(){if(!this.IsSingleGlobal())throw new Error("must be single-global plugin");return this._singleGlobalObjectClass.GetSingleGlobalInstance()},t}(i("d27c30dad6345543").DefendedBase);e.SDKPluginBase=o},f70bd163b03dc1f8:function(t,e,i){var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__assign||function(){return(o=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var r in e=arguments[i])if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r];return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0});var s=i("e681aed280414b09"),a=i("28efaa094fbb6631"),l=i("8e6337f78bfb827e"),c=i("3f98e0ac43cc66a2"),u=i("c5cd1ff76221c1b3"),h=function(){this.cid="",this.glov="",this.robotic=!1,this.attackable=!1,this.globalVariable={},this.connectedState=a.ConnectedState.CONNECTED,this.isReady=!1,this.isQuitBattle=!1,this.cancelMatch=!1},d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.prop=new c.default,t.state=a.State.STANDBY,t.roomId="",t.round=0,t.readyWaitingTime=0,t.waitingTimer=null,t.lastTime=0,t.timer=null,t.players=[],t.attacker=null,t.params=[],t.noMap={},t.creating=!1,t.joining=!1,t.inviteCode="",t.enterErrorCode="",t.userCount=0,t.initServer=!1,t}return r(t,e),t.prototype.onCreate=function(){var n=this;this.prop=s.SDKInstanceBase.formatProp(this,this.prop,function(t,e,i){switch(e){case 2:n.prop.matchTimeout=1e3*t;break;case 6:n.prop.roundTimeout=1e3*t;break;default:return!1}return!0}),this.listenMessage(xf.xfWebSocket.CONNECT,this.onSocketConnect),this.listenMessage(xf.xfWebSocket.CLOSE,this.onSocketClose),this.listenMessage(game.MsgType.BATTLE_START_MATCH_RESP,this.onStartMatchResp),this.listenMessage(game.MsgType.BATTLE_FINISH_MATCH_NOTI,this.onFinishMatchNoti),this.listenMessage(game.MsgType.BATTLE_READY_PK_RESP,this.onReadyPkResp),this.listenMessage(game.MsgType.BATTLE_READY_PK_NOTI,this.onBattleReadyPKNoti),this.listenMessage(game.MsgType.BATTLE_CANCEL_READY_PK_RESP,this.onCancelReadyResp),this.listenMessage(game.MsgType.BATTLE_CANCEL_READY_PK_NOTI,this.onCancelReadyNoti),this.listenMessage(game.MsgType.BATTLE_START_PK_NOTI,this.onStartPkNoti),this.listenMessage(game.MsgType.BATTLE_START_ROUND_NOTI,this.onStartRoundNoti),this.listenMessage(game.MsgType.BATTLE_STOP_ROUND_RESP,this.onStopRoundResp),this.listenMessage(game.MsgType.BATTLE_STOP_PK_RESP,this.onStopPkResp),this.listenMessage(game.MsgType.BATTLE_STOP_PK_NOTI,this.onStopPkNoti),this.listenMessage(game.MsgType.BATTLE_FINISH_PK_RESP,this.onFinishPkResp),this.listenMessage(game.MsgType.BATTLE_FINISH_PK_NOTI,this.onFinishPkNoti),this.listenMessage(game.MsgType.BATTLE_STOP_MATCH_RESP,this.onStopMatchResp),this.listenMessage(game.MsgType.BATTLE_OFFLINE_NOTI,this.onOfflineNoti),this.listenMessage(game.MsgType.BATTLE_POST_ACTION_RESP,this.onPostActionResp),this.listenMessage(game.MsgType.BATTLE_POST_ACTION_NOTI,this.onPostActionNoti),this.listenMessage(game.MsgType.BATTLE_READY_TIMEOUT_RESP,this.onReadyTimeoutResp),this.listenMessage(game.MsgType.BATTLE_READY_TIMEOUT_NOTI,this.onReadyTimeoutNoti),this.listenMessage(game.MsgType.BATTLE_CANCEL_MATCH_RESP,this.onCancelMatchResp),this.listenMessage(game.MsgType.BATTLE_CANCEL_MATCH_NOTI,this.onCancelMatchNoti),this.listenMessage(game.MsgType.BATTLE_CREATE_ROOM_RESP,this.onCreateHost),this.listenMessage(game.MsgType.BATTLE_JOIN_ROOM_RESP,this.onJoinHost),this.listenMessage(game.MsgType.BATTLE_QUIT_ROOM_RESP,this.onExitHost),this.listenMessage(game.MsgType.BATTLE_ROOM_NUMBER_NOTI,this.onUserCountNoti),this.runtime.tickMe(this)},t.prototype.onDestroy=function(){this.removeAllListen()},t.prototype.tick=function(){var e=this;if(0<this.runtime.all_global_vars.length&&!this.globalVarSidMap)this.globalVarSidMap={},this.runtime.all_global_vars.forEach(function(t){e.globalVarSidMap[t.name]=t.sid});if(!this.initServer)if(xf.xfWebSocket.instance.status===xf.WebSocketStateEnum.CONNECTED)this.onSocketConnect(),this.initServer=!0},t.prototype.getDebuggerValues=function(t){t.push({title:"属性",properties:[{name:"对战状态",value:["待机","匹配中","匹配成功","已准备","对战中"][this.state],readonly:!0},{name:"当前回合剩余时间(秒)",value:this.lastTime/1e3,readonly:!0},{name:"当前玩家回合",value:"未开始战斗",readonly:!0},{name:"匹配准备时间(秒)",value:this.readyWaitingTime/1e3,readonly:!0},{name:"回合数",value:this.round,readonly:!0}]})},t.prototype.onDebugValueEdited=function(t,e,i){e},t.prototype.onSocketConnect=function(){this.myConnectedState=a.ConnectedState.CONNECTED},t.prototype.onSocketClose=function(t){l.Logger.info("websocket 断开连接！！！"),this.connectedChangeNo=this.myNumber,this.myConnectedState=a.ConnectedState.INTERNET_WAS_DICONNECTED,this.trigger(drama.plugins_.battle.prototype.cnds.compareOffline),this.resetBattle()},t.prototype.onStartMatchResp=function(t){var e=game.BattleStartMatchResp.decode(t.messageData);if(e.instanceId===String(this.uid)){if(1!==e.code)return void l.Logger.error("开始匹配异常：",e);this.state=a.State.MATCHING,this.trigger(drama.plugins_.battle.prototype.cnds.startMatch),l.Logger.info("返回：开始匹配")}},t.prototype.onFinishMatchNoti=function(t){var i=this,e=game.BattleFinishMatchNoti.decode(t.messageData);if(e.instanceId===String(this.uid)){if(this.state!==a.State.READY)this.state=a.State.MATCHSUCCESS;this.roomId=e.roomId,this.players=this.sortPlayer(e.players),this.attacker=this.players[0],this.players.forEach(function(t,e){if(i.noMap[t.cid]=e,t.cid===xf.gameInfo.characterId)i.myNumber=e}),this.syncEnemyGlobalVar(e.players);for(var n=0;n<this.players.length;n++)if(this.players[n].robotic)this.players[n].isReady=!0,this.readyPlayerNo=n,this.trigger(drama.plugins_.battle.prototype.cnds.onReady);this.readyCountdown(),this.trigger(drama.plugins_.battle.prototype.cnds.matchSuccess),l.Logger.info("通知：匹配成功",this.players,this.noMap)}},t.prototype.onReadyPkResp=function(t){var e=game.BattleReadyPKResp.decode(t.messageData);if(e.instanceId===String(this.uid)){if(1!==e.code)return void l.Logger.error("准备对战异常：",e);this.state=a.State.READY,l.Logger.info("返回：准备对战")}},t.prototype.onBattleReadyPKNoti=function(t){var e=game.BattleReadyPKNoti.decode(t.messageData);if(e.instanceId===String(this.uid))if(l.Logger.info("通知：准备对战"),this.readyPlayerNo=this.noMap[e.senderId],this.players[this.readyPlayerNo].isReady=!0,this.trigger(drama.plugins_.battle.prototype.cnds.onReady),this.prop.matchType===a.MatchType.OFFLINE)this.trigger(drama.plugins_.battle.prototype.cnds.onAllReady);else if(this.players.filter(function(t){return t.isReady}).length===this.prop.playerTotal)this.trigger(drama.plugins_.battle.prototype.cnds.onAllReady)},t.prototype.onCancelReadyResp=function(t){var e=game.BattleCancelReadyPKResp.decode(t.messageData);if(e.instanceId===String(this.uid)){if(1!==e.code)return void l.Logger.error("取消准备异常：",e);if(0<this.userCount&&this.userCount<this.prop.playerTotal)this.state=a.State.MATCHING;else this.state=a.State.MATCHSUCCESS;l.Logger.info("返回：取消准备")}},t.prototype.onCancelReadyNoti=function(t){var e=game.BattleCancelReadyPKNoti.decode(t.messageData);if(e.instanceId===String(this.uid))l.Logger.info("通知：取消准备"),this.cancelReadyPlayerNo=this.noMap[e.senderId],this.players[this.cancelReadyPlayerNo].isReady=!1,this.trigger(drama.plugins_.battle.prototype.cnds.onCancelReady)},t.prototype.onStartPkNoti=function(t){var e=game.BattleStartPKNoti.decode(t.messageData);if(e.instanceId===String(this.uid))l.Logger.info("开始对战：",e),this.state=a.State.FIGHTING,this.readyWaitingTime=0,window.clearInterval(this.waitingTimer),this.waitingTimer=null,this.round=e.round,this.syncEnemyGlobalVar(e.players),this.startRound(xf.xfWebSocketUtils.now()-Number(e.roundStartTime)),this.trigger(drama.plugins_.battle.prototype.cnds.allReady)},t.prototype.onStartRoundNoti=function(t){var e=game.BattleStartRoundNoti.decode(t.messageData);if(e.instanceId===String(this.uid)){if(this.checkPKState())return;this.roomId=e.roomId,this.round=e.round,this.trigger(drama.plugins_.battle.prototype.cnds.roundEnd),this.syncEnemyGlobalVar(e.players),l.Logger.info("通知：回合开始; 当前回合进攻方编号(1开始)："+(this.noMap[this.attacker.cid]+1)),this.startRound(xf.xfWebSocketUtils.now()-Number(e.roundStartTime))}},t.prototype.onStopRoundResp=function(t){var e=game.BattleStopRoundResp.decode(t.messageData);if(e.instanceId===String(this.uid)){if(1!==e.code)return void l.Logger.error("回合结束异常：",e);l.Logger.info("返回：回合结束")}},t.prototype.onStopPkResp=function(t){var e=game.BattleStopPKResp.decode(t.messageData);if(e.instanceId===String(this.uid)){if(1!==e.code)return void l.Logger.error("退出对战异常：",e);l.Logger.info("返回：退出对战",e)}},t.prototype.onStopPkNoti=function(t){var e=game.BattleStopPKNoti.decode(t.messageData);if(e.instanceId===String(this.uid))if(l.Logger.info("通知：退出对战",e),this.quitBattleNo=this.noMap[e.deporteeId],this.players[this.quitBattleNo].isQuitBattle=!0,this.trigger(drama.plugins_.battle.prototype.cnds.onQuitBattle),e.deporteeId===xf.gameInfo.characterId)this.resetBattle()},t.prototype.onFinishPkResp=function(t){if(game.BattleFinishPKResp.decode(t.messageData).instanceId===String(this.uid))l.Logger.info("返回：结束对战")},t.prototype.onFinishPkNoti=function(t){if(game.BattleFinishPKNoti.decode(t.messageData).instanceId===String(this.uid))l.Logger.info("通知：结束对战"),this.trigger(drama.plugins_.battle.prototype.cnds.onBattleDone),this.resetBattle()},t.prototype.onStopMatchResp=function(t){var e=game.BattleStopMatchResp.decode(t.messageData);if(e.instanceId===String(this.uid)){if(1!==e.code)return void l.Logger.error("BattleStopMatchResp error：",e);l.Logger.info("返回：停止匹配"),this.cancelMatchChangeNo=this.myNumber,this.trigger(drama.plugins_.battle.prototype.cnds.onCancelMatch),this.resetBattle()}},t.prototype.onOfflineNoti=function(t){var e=game.BattleOfflineNoti.decode(t.messageData);if(e.instanceId===String(this.uid)){l.Logger.info("通知：掉线、顶号",e.factor,e.offlineId,xf.gameInfo.characterId);var i=this.noMap[e.offlineId];if(this.connectedChangeNo=i,e.offlineId===xf.gameInfo.characterId)xf.xfWebSocketUtils.isNeedReconnect=!1,this.myConnectedState=a.ConnectedState.FORCED_OFFLINE,this.trigger(drama.plugins_.battle.prototype.cnds.compareOffline),this.resetBattle();else this.players[i].connectedState=e.factor,this.trigger(drama.plugins_.battle.prototype.cnds.compareOffline)}},t.prototype.onPostActionResp=function(t){var e=game.BattlePostActionResp.decode(t.messageData);if(e.instanceId===String(this.uid)){if(1!==e.code)return void l.Logger.error("对战数据返回异常：",e);l.Logger.info("返回：广播对战数据")}},t.prototype.onPostActionNoti=function(t){var e=game.BattlePostActionNoti.decode(t.messageData);if(e.instanceId===String(this.uid)){if(e.senderId===xf.gameInfo.characterId)return;this.message=e;try{var i=JSON.parse(e.pkParams);if("[object Array]"===Object.prototype.toString.call(i))this.params=i;else throw new Error("params type is："+Object.prototype.toString.call(i))}catch(t){throw new Error("对战数据异常"+t.message)}this.trigger(drama.plugins_.battle.prototype.cnds.onMessage),this.message=null,this.params=[],l.Logger.info("通知：广播对战数据",e)}},t.prototype.onReadyTimeoutResp=function(t){var e=game.BattleReadyTimeoutResp.decode(t.messageData);if(e.instanceId===String(this.uid)){if(1!==e.code)return void l.Logger.error("BattleReadyTimeoutResp error：",e);l.Logger.info("返回：超时未进入对战")}},t.prototype.onReadyTimeoutNoti=function(t){if(game.BattleReadyTimeoutNoti.decode(t.messageData).instanceId===String(this.uid))l.Logger.info("通知：超时未进入对战")},t.prototype.onCancelMatchResp=function(t){var e=game.BattleCancelMatchResp.decode(t.messageData);if(e.instanceId===String(this.uid)){if(1!==e.code)return void l.Logger.error("BattleCancelMatchResp error：",e);l.Logger.info("返回：取消进入对战")}},t.prototype.onCancelMatchNoti=function(t){var e=game.BattleCancelMatchNoti.decode(t.messageData);if(e.instanceId===String(this.uid))l.Logger.info("通知：取消进入对战"),this.cancelMatchChangeNo=this.noMap[e.senderId],this.players[this.noMap[e.senderId]].cancelMatch=!0,this.trigger(drama.plugins_.battle.prototype.cnds.onCancelMatch),this.resetBattle()},t.prototype.onCreateHost=function(t){var e=game.BattleCreateRoomResp.decode(t.messageData);if(e.instanceId===String(this.uid)){if(this.creating=!1,1!==e.code)return l.Logger.error("BattleCreateRoomResp error：",e),this.enterErrorCode=e.info,void this.trigger(drama.plugins_.battle.prototype.cnds.createHostFailed);l.Logger.info("通知：创建房间"),this.userCount=1,this.inviteCode=e.inviteCode,this.roomId=e.roomId,this.state=a.State.MATCHING,this.trigger(drama.plugins_.battle.prototype.cnds.createHostSuccess)}},t.prototype.onJoinHost=function(t){var e=game.BattleJoinRoomResp.decode(t.messageData);if(e.instanceId===String(this.uid)){if(this.joining=!1,1!==e.code)return l.Logger.error("BattleJoinRoomResp error：",e),this.enterErrorCode=e.info,void this.trigger(drama.plugins_.battle.prototype.cnds.joinHostFailed);l.Logger.info("通知：加入房间"),this.inviteCode=e.inviteCode,this.roomId=e.roomId,this.state=a.State.MATCHING,this.trigger(drama.plugins_.battle.prototype.cnds.joinHostSuccess)}},t.prototype.onExitHost=function(t){var e=game.BattleQuitRoomResp.decode(t.messageData);if(e.instanceId===String(this.uid)){if(1!==e.code)return void l.Logger.error("BattleQuitRoomResp error：",e);l.Logger.info("通知：退出房间"),this.resetBattle()}},t.prototype.onUserCountNoti=function(t){var e=game.BattleRoomNumberNoti.decode(t.messageData);if(e.instanceId===String(this.uid)){if(1!==e.code)return void l.Logger.error("BattleRoomNumberNoti error：",e);if(l.Logger.info("通知：人数改变"),this.userCount=e.roomNumber,this.userCount<this.prop.playerTotal)if(window.clearInterval(this.waitingTimer),this.state==a.State.MATCHSUCCESS)this.state=a.State.MATCHING,l.Logger.info("通知：人数不足，变为匹配中状态")}},t.prototype.sortPlayer=function(t){var r=this;return t.sort(function(t,e){var i=JSON.parse(t.glov),n=JSON.parse(e.glov);if("random"===r.prop.orderRule)if(r.prop.order===a.Order.DESC)return Number(e.cid)-Number(t.cid);else return Number(t.cid)-Number(e.cid);else if("number"==typeof i[r.prop.orderRule])if(r.prop.order===a.Order.DESC)if(n[r.prop.orderRule]==i[r.prop.orderRule])return Number(e.cid)-Number(t.cid);else return n[r.prop.orderRule]-i[r.prop.orderRule];else if(n[r.prop.orderRule]==i[r.prop.orderRule])return Number(t.cid)-Number(e.cid);else return i[r.prop.orderRule]-n[r.prop.orderRule];return 0}).map(function(t){return o({},new h,t)})},t.prototype.readyCountdown=function(){var t=this;this.waitingTimer=window.setInterval(function(){if(t.readyWaitingTime+=1e3,t.trigger(drama.plugins_.battle.prototype.cnds.readyTimeout))window.clearInterval(t.waitingTimer)},1e3)},t.prototype.roundCountdown=function(){var t=this;if(!(this.lastTime<=0)){var e=1e3;if(0<this.lastTime%1e3&&this.lastTime<1e3)e=this.lastTime%1e3;this.timer=window.setTimeout(function(){if(0<t.lastTime)t.lastTime-=1e3,t.lastTime=t.lastTime<0?0:t.lastTime,t.roundCountdown()},e)}else this.trigger(drama.plugins_.battle.prototype.cnds.roundTimeout)},t.prototype.sendFinishRound=function(t){this.lastTime=0,window.clearTimeout(this.timer);var e=new game.BattleStopRoundReq;e.instanceId=String(this.uid),e.pluginId=String(this.puid),e.roomId=this.roomId,e.round=this.round,e.attackerId=t,xf.PacketUtils.sendPacket(game.MsgType.BATTLE_STOP_ROUND_REQ,game.BattleStopRoundReq.encode(e).finish())},t.prototype.checkPKState=function(){if(this.state===a.State.STANDBY)return this.stopPK(xf.gameInfo.characterId),!0;else return!1},t.prototype.stopPK=function(t){if(this.state===a.State.FIGHTING){var e=new game.BattleStopPKReq;e.instanceId=String(this.uid),e.pluginId=String(this.puid),e.roomId=this.roomId,e.deporteeId=t,xf.PacketUtils.sendPacket(game.MsgType.BATTLE_STOP_PK_REQ,game.BattleStopPKReq.encode(e).finish()),l.Logger.info("动作：退出对战")}},t.prototype.startRound=function(t){window.clearTimeout(this.timer),this.lastTime=this.prop.roundTimeout-t,l.Logger.info("回合结束倒计时："+this.lastTime+"ms, 延时："+t+"ms"),this.roundCountdown(),this.trigger(drama.plugins_.battle.prototype.cnds.roundStart)},t.prototype.syncEnemyGlobalVar=function(t){var e=this;t.forEach(function(t){if(t.attackable)e.attacker=t;e.players[e.noMap[t.cid]].globalVariable=JSON.parse(t.glov)})},t.prototype.resetBattle=function(){if(this.timer)window.clearTimeout(this.timer);if(this.waitingTimer)window.clearInterval(this.waitingTimer);this.state=a.State.STANDBY,this.readyWaitingTime=0,this.timer=null,this.waitingTimer=null,this.roomId="",this.round=0,this.userCount=0,this.inviteCode="",this.players=[],this.attacker=null,this.lastTime=0,this.params=[],this.noMap={},this.connectedChangeNo=null,t.Instance=null},t.prototype.getSid=function(t){return Object.keys(this.noMap)[t-1]},t.prototype.getRandomPlayerNo=function(){var t=o({},this.noMap);return delete t[xf.gameInfo.characterId],u.randomArr(u.values(t))},t.prototype.joinHost=function(t){if(this.isCanJoinHost()){this.joining=!0;var e=new game.BattleJoinRoomReq;e.instanceId=String(this.uid),e.pluginId=String(this.puid),e.inviteCode=String(t),xf.PacketUtils.sendPacket(game.MsgType.BATTLE_JOIN_ROOM_REQ,game.BattleJoinRoomReq.encode(e).finish())}},t.prototype.exitHost=function(t){if((this.state===a.State.MATCHING||this.state===a.State.MATCHSUCCESS)&&this.isConnected()){var e=new game.BattleQuitRoomReq;e.instanceId=String(this.uid),e.pluginId=String(this.puid),e.inviteCode=String(t),xf.PacketUtils.sendPacket(game.MsgType.BATTLE_QUIT_ROOM_REQ,game.BattleQuitRoomReq.encode(e).finish()),l.Logger.info("动作：退出房间")}},t.prototype.isCanJoinHost=function(){return this.state==a.State.STANDBY&&!this.creating&&!this.joining&&this.isConnected()},t.prototype.isConnected=function(){return!this.myConnectedState||this.myConnectedState===a.ConnectedState.CONNECTED},t}(s.SDKInstanceBase);e.default=d},f8bf1888467a27ff:function(t,e,i){var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i("f70bd163b03dc1f8"),l=i("28efaa094fbb6631"),s=i("c5cd1ff76221c1b3"),c=i("8e6337f78bfb827e"),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.compareParams=function(t,e,i,n,r,o,s,a){if(this.state===l.State.STANDBY||this.state===l.State.MATCHING)return!1;if(t>this.players.length||t<0)return!1;if(0!==t&&this.noMap[this.message.senderId]+1!==t)return!1;if(i<0||i>this.params.length-1)return c.Logger.error("对战数据序号边界异常，数据长度：",this.params.length),!1;if(this.message.pkAction===e)if(1==n)return drama.do_cmp(this.params[i],r,a);else return drama.do_cmp(this.params[i],o,s);return!1},e.prototype.compareState=function(t){return this.state===t},e.prototype.compareRound=function(t,e){if(this.state!==l.State.FIGHTING)return!1;if(e>this.players.length||e<0)return!1;if(t===l.AttackerOrder.MYSELF)return this.attacker.cid===xf.gameInfo.characterId;else if(t===l.AttackerOrder.ENEMY){if(this.attacker.cid===xf.gameInfo.characterId)return!1;if(0===e)return null!==this.attacker;else return this.noMap[this.attacker.cid]+1===e}return!1},e.prototype.readyTimeout=function(t){if(this.state!==l.State.MATCHSUCCESS)return!1;if(this.readyWaitingTime/1e3>=t)return!0;else return!1},e.prototype.compareOffline=function(t,e,i){var n=s.values(l.ConnectedState)[i+1];if(t===l.AttackerOrder.MYSELF)return this.myConnectedState===n;else if(t===l.AttackerOrder.ENEMY){if(this.state===l.State.STANDBY||this.state===l.State.MATCHING)return!1;if(e>this.players.length||e<0)return!1;if(this.connectedChangeNo==this.myNumber)return!1;if(0===e)return this.players[this.connectedChangeNo].connectedState===n;else return e-1===this.connectedChangeNo&&this.players[e-1].connectedState===n}return!1},e.prototype.startMatch=function(){return!0},e.prototype.onCancelMatch=function(t,e){if(this.state!==l.State.MATCHING&&this.state!==l.State.MATCHSUCCESS)return!1;if(e>this.players.length||e<0)return!1;if(t===l.AttackerOrder.MYSELF)return this.myNumber===this.cancelMatchChangeNo;else{if(this.myNumber===this.cancelMatchChangeNo)return!1;if(0===e)return!0;else return e-1===this.cancelMatchChangeNo}},e.prototype.matchSuccess=function(){return!0},e.prototype.compareMatchType=function(t,e){if(this.state===l.State.STANDBY||this.state===l.State.MATCHING)return!1;if(t>this.players.length||t<0)return!1;if(this.myNumber===t-1)return!1;if(0===t){for(var i=0;i<this.players.length;i++)if(!!e===this.players[i].robotic&&this.players[i].cid!==xf.gameInfo.characterId)return!0;return!1}else if(!!e===this.players[t-1].robotic)return!0;return!1},e.prototype.onAllReady=function(){return!0},e.prototype.onReady=function(t,e){if(this.state===l.State.STANDBY||this.state===l.State.MATCHING)return!1;if(e>this.players.length||e<0)return!1;if(t===l.AttackerOrder.MYSELF)return this.myNumber===this.readyPlayerNo;else{if(this.myNumber===this.readyPlayerNo)return!1;if(0===e)return!0;else return e-1===this.readyPlayerNo}},e.prototype.onCancelReady=function(t,e){if(this.state===l.State.STANDBY)return!1;if(e>this.players.length||e<0)return!1;if(t===l.AttackerOrder.MYSELF)return this.myNumber===this.cancelReadyPlayerNo;else{if(this.myNumber===this.cancelReadyPlayerNo)return!1;if(0===e)return!0;else return e-1===this.cancelReadyPlayerNo}},e.prototype.onQuitBattle=function(t,e){if(this.state===l.State.STANDBY||this.state===l.State.MATCHING)return!1;if(e>this.players.length||e<0)return!1;if(t===l.AttackerOrder.MYSELF)return this.myNumber===this.quitBattleNo;else{if(this.myNumber===this.quitBattleNo)return!1;if(0===e)return!0;else return e-1===this.quitBattleNo}},e.prototype.onBattleDone=function(){return!0},e.prototype.roundStart=function(){return!0},e.prototype.roundEnd=function(){return!0},e.prototype.onMessage=function(t,e){if(this.state===l.State.STANDBY||this.state===l.State.MATCHING)return!1;if(t>this.players.length||t<0)return!1;if(0===t||this.message.senderId===this.getSid(t))return""===e||e===this.message.pkAction;else return!1},e.prototype.roundTimeout=function(){return!0},e.prototype.onSocketStatusChange=function(t){if(t==l.SocketState.ENABLE)return xf.xfWebSocket.instance.status==xf.WebSocketStateEnum.CONNECTED;else return xf.xfWebSocket.instance.status==xf.WebSocketStateEnum.CLOSED},e.prototype.createHostSuccess=function(){return!0},e.prototype.createHostFailed=function(){return!0},e.prototype.isCreating=function(){return this.creating},e.prototype.joinHostSuccess=function(){return!0},e.prototype.joinHostFailed=function(){return!0},e.prototype.isJoining=function(){return this.joining},e}(o.default);e.default=a}}),function(i){var n={};function r(t){if(n[t])return n[t].exports;var e=n[t]={i:t,l:!1,exports:{}};return i[t].call(e.exports,e,e.exports,r),e.l=!0,e.exports}r.m=i,r.c=n,r.d=function(t,e,i){if(!r.o(t,e))Object.defineProperty(t,e,{enumerable:!0,get:i})},r.r=function(t){if("undefined"!=typeof Symbol&&Symbol.toStringTag)Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(e,t){if(1&t)e=r(e);if(8&t)return e;if(4&t&&"object"===_typeof(e)&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(i,n,function(t){return e[t]}.bind(null,n));return i},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s="010cf2e8b0d3dffe")}({"010cf2e8b0d3dffe":function(t,e,i){var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i("e7b602c229ac5b71"),s=i("2b11da31a37159ce"),a=i("9998d8dbcd94d410"),l=i("79def955f8c205a2"),c=i("46a8aa9586418c2c"),u=i("db60446d20396a6c");window.assert2(drama,"drama namespace not created"),window.assert2(drama.plugins_,"drama.plugins_ not created");var h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e}(o.SDKPluginBase);h.prototype.Instance=a.default,h.prototype.Type=s.default,h.prototype.cnds=new l.default({}),h.prototype.exps=new u.default({}),h.prototype.acts=new c.default({}),window.drama.plugins_.pk1v1=h},"0330f9384c2c8825":function(t,e,i){var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=function(i){function t(t){var e=i.call(this)||this;return e._runtime=t.runtime,e._plugin=t,e}return r(t,i),Object.defineProperty(t.prototype,"runtime",{get:function(){return this._runtime},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"plugin",{get:function(){return this._plugin},enumerable:!0,configurable:!0}),t.prototype.onCreate=function(){},t.prototype.Release=function(){this._runtime=null,this._plugin=null},t.prototype.FinishCondition=function(){},t.prototype.LoadTextures=function(){},t.prototype.ReleaseTextures=function(){},t.prototype.OnDynamicTextureLoadComplete=function(){},t.prototype.LoadTilePolyData=function(){},t}(i("d27c30dad6345543").DefendedBase);e.SDKTypeBase=o},"08bfdbf0c7f47563":function(t,e,i){Object.defineProperty(e,"__esModule",{value:!0});var n=function(){this.matchType=null,this.matchTimeout=null,this.matchRule=null,this.orderRule=null,this.order=null,this.roundTimeout=null};e.default=n},"2b11da31a37159ce":function(t,e,i){var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.onCreate=function(){},e}(i("0330f9384c2c8825").SDKTypeBase);e.default=o},"46a8aa9586418c2c":function(t,e,i){var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i("9998d8dbcd94d410"),s=i("da506072e2374da8"),a=i("8e6337f78bfb827e"),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.startMatch=function(){if(this.state===s.State.STANDBY){var t=new game.PK1v1StartMatchReq;t.instanceId=String(this.instanceId),t.pluginId=String(this.puid),xf.PacketUtils.sendPacket(game.MsgType.PK1V1_START_MATCH_REQ,game.PK1v1StartMatchReq.encode(t).finish()),a.Logger.info("动作：1v1开始匹配")}},e.prototype.stopMatch=function(){if(!this.inviteCode)if(this.state===s.State.MATCHING){(t=new game.PK1v1StopMatchReq).instanceId=String(this.instanceId),t.pluginId=String(this.puid),xf.PacketUtils.sendPacket(game.MsgType.PK1V1_STOP_MATCH_REQ,game.PK1v1StopMatchReq.encode(t).finish()),a.Logger.info("动作：1v1停止匹配")}else if(this.state===s.State.MATCHSUCCESS){var t;(t=new game.PK1v1CancelMatchReq).instanceId=String(this.instanceId),t.pluginId=String(this.puid),t.roomId=this.roomId,xf.PacketUtils.sendPacket(game.MsgType.PK1V1_CANCEL_MATCH_REQ,game.PK1v1CancelMatchReq.encode(t).finish()),a.Logger.info("动作：1v1取消匹配")}},e.prototype.ready=function(){if(this.state===s.State.MATCHSUCCESS){var t=new game.PK1v1ReadyPKReq;t.instanceId=String(this.instanceId),t.pluginId=String(this.puid),t.roomId=this.roomId,xf.PacketUtils.sendPacket(game.MsgType.PK1V1_READY_PK_REQ,game.PK1v1ReadyPKReq.encode(t).finish()),a.Logger.info("动作：1v1准备对战")}},e.prototype.cancelReady=function(){if(this.state===s.State.READY){var t=new game.PK1v1CancelReadyPKReq;t.instanceId=String(this.instanceId),t.pluginId=String(this.puid),t.roomId=this.roomId,xf.PacketUtils.sendPacket(game.MsgType.PK1V1_CANCEL_READY_PK_REQ,game.PK1v1CancelReadyPKReq.encode(t).finish()),a.Logger.info("动作：1v1取消准备")}},e.prototype.quitBattle=function(){if(this.state===s.State.FIGHTING)this.stopPK()},e.prototype.finishRound=function(t){if(this.state===s.State.FIGHTING){var e=this.enemy.cid;if(t===s.AttackerOrder.MYSELF)e=xf.gameInfo.characterId;a.Logger.info("动作：1v1结束回合"),this.sendFinishRound(e)}},e.prototype.postAction=function(t,e){if(this.state===s.State.FIGHTING&&!this.enemy.robotic){a.Logger.info("动作：1v1广播对战数据",t,e);var i=new game.PK1v1PostActionReq;i.instanceId=String(this.instanceId),i.pluginId=String(this.puid),i.roomId=this.roomId,i.pkAction=t,i.pkParams=JSON.stringify(e),xf.PacketUtils.sendPacket(game.MsgType.PK1V1_POST_ACTION_REQ,game.PK1v1PostActionReq.encode(i).finish())}},e.prototype.createHost=function(){if(this.isCanJoinHost()){this.creating=!0;var t=new game.PK1v1CreateRoomReq;t.instanceId=String(this.instanceId),t.pluginId=String(this.puid),xf.PacketUtils.sendPacket(game.MsgType.PK1V1_CREATE_ROOM_REQ,game.PK1v1CreateRoomReq.encode(t).finish()),a.Logger.info("动作：1v1创建房间")}},e.prototype.changeHost=function(t,e){if(e)if(t==s.HostActionType.JOIN)this.joinHost(e);else if(t==s.HostActionType.EXIT)this.exitHost(e)},e}(o.default);e.default=l},"79def955f8c205a2":function(t,e,i){var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i("9998d8dbcd94d410"),a=i("da506072e2374da8"),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.compareParams=function(t,e,i,n,r,o,s){if(this.state===a.State.STANDBY||this.state===a.State.MATCHING)return!1;if(e<0||e>this.params.length-1)return!1;if(this.action.pkAction===t)if(1==i)return drama.do_cmp(this.params[e],n,s);else return drama.do_cmp(this.params[e],r,o);return!1},e.prototype.compareState=function(t){return this.state===t},e.prototype.compareRound=function(t){if(this.state!==a.State.FIGHTING)return!1;if(t===a.AttackerOrder.MYSELF)return this.attacker.cid===xf.gameInfo.characterId;else if(t===a.AttackerOrder.ENEMY)return this.attacker.cid!==xf.gameInfo.characterId;return!1},e.prototype.readyTimeout=function(t){if(this.state!==a.State.MATCHSUCCESS)return!1;if(this.readyWaitingTime/1e3>=t)return!0;else return!1},e.prototype.compareOffline=function(t,e){if(t===a.AttackerOrder.MYSELF){if(0===e)return this.myConnectedState===a.ConnectedState.INTERNET_WAS_DICONNECTED;else if(1===e)return this.myConnectedState===a.ConnectedState.FORCED_OFFLINE}else if(t===a.AttackerOrder.ENEMY)if(0===e)return this.enemyConnectedState===a.ConnectedState.INTERNET_WAS_DICONNECTED;else if(1===e)return this.enemyConnectedState===a.ConnectedState.FORCED_OFFLINE},e.prototype.startMatch=function(){return!0},e.prototype.stopMatch=function(){return!0},e.prototype.matchSuccess=function(){return!0},e.prototype.compareMatchType=function(t){if(this.state===a.State.STANDBY||this.state===a.State.MATCHING)return!1;if(t===a.PlayerType.REAL&&!this.enemy.robotic)return!0;else if(t===a.PlayerType.AI&&this.enemy.robotic)return!0;return!1},e.prototype.onCancelReady=function(t){if(this.cancelReadyPlayerId)return t===a.CancelReady.MYSELF?xf.gameInfo.characterId===this.cancelReadyPlayerId:xf.gameInfo.characterId!==this.cancelReadyPlayerId},e.prototype.allReady=function(){return!0},e.prototype.quitBattle=function(){return!0},e.prototype.roundStart=function(){return!0},e.prototype.roundEnd=function(){return!0},e.prototype.onMessage=function(){return!0},e.prototype.roundTimeout=function(){return!0},e.prototype.onSocketStatusChange=function(t){if(t==a.SocketState.ENABLE)return xf.xfWebSocket.instance.status==xf.WebSocketStateEnum.CONNECTED;else return xf.xfWebSocket.instance.status==xf.WebSocketStateEnum.CLOSED},e.prototype.createHostSuccess=function(){return!0},e.prototype.createHostFailed=function(){return!0},e.prototype.isCreating=function(){return this.creating},e.prototype.joinHostSuccess=function(){return!0},e.prototype.joinHostFailed=function(){return!0},e.prototype.isJoining=function(){return this.joining},e}(o.Property);e.default=s},"8e6337f78bfb827e":function(t,e,i){Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(){}return t.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(window.xfConfig.enableLogger)console.log.apply(console,t)},t.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(window.xfConfig.enableLogger)console.warn.apply(console,t)},t.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(window.xfConfig.enableLogger)console.error.apply(console,t)},t.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(window.xfConfig.enableLogger)console.debug.apply(console,t)},t.trace=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(window.xfConfig.enableLogger)console.trace.apply(console,t)},t}();e.Logger=n},"9998d8dbcd94d410":function(t,e,i){var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i("e681aed280414b09"),s=i("da506072e2374da8"),a=i("8e6337f78bfb827e"),l=i("08bfdbf0c7f47563"),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e}(o.SDKInstanceBase),u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state=s.State.STANDBY,t.roomId="",t.round=0,t.myself=new game.PK1v1Player,t.enemy=new game.PK1v1Player,t.connectedState=null,t.attacker=new game.PK1v1Player,t.creating=!1,t.joining=!1,t.inviteCode="",t.enterErrorCode="",t.userCount=0,t.cancelReadyPlayerId="",t.readyWaitingTime=0,t.lastTime=0,t.timer=null,t.waitingTimer=null,t.params=[],t.action=new game.PK1v1PostActionNoti,t.globalVariable=[],t.prop=new l.default,t.initServer=!1,t}return r(t,e),t.prototype.onCreate=function(){var n=this;this.prop=o.SDKInstanceBase.formatProp(this,this.prop,function(t,e,i){switch(e){case 1:n.prop.matchTimeout=1e3*t;break;case 5:n.prop.roundTimeout=1e3*t;break;default:return!1}return!0}),this.listenMessage(xf.xfWebSocket.CONNECT,this.onSocketConnect),this.listenMessage(xf.xfWebSocket.CLOSE,this.onSocketClose),this.listenMessage(game.MsgType.PK1V1_START_MATCH_RESP,this.onStartMatchResp),this.listenMessage(game.MsgType.PK1V1_FINISH_MATCH_NOTI,this.onFinishMatchNoti),this.listenMessage(game.MsgType.PK1V1_READY_PK_RESP,this.onReadyPkResp),this.listenMessage(game.MsgType.PK1V1_CANCEL_READY_PK_RESP,this.onCancelReadyResp),this.listenMessage(game.MsgType.PK1V1_CANCEL_READY_PK_NOTI,this.onCancelReadyNoti),this.listenMessage(game.MsgType.PK1V1_START_PK_NOTI,this.onStartPkNoti),this.listenMessage(game.MsgType.PK1V1_START_ROUND_NOTI,this.onStartRoundNoti),this.listenMessage(game.MsgType.PK1V1_STOP_ROUND_RESP,this.onStopRoundResp),this.listenMessage(game.MsgType.PK1V1_STOP_PK_RESP,this.onStopPkResp),this.listenMessage(game.MsgType.PK1V1_STOP_PK_NOTI,this.onStopPkNoti),this.listenMessage(game.MsgType.PK1V1_STOP_MATCH_RESP,this.onStopMatchResp),this.listenMessage(game.MsgType.PK1V1_OFFLINE_NOTI,this.onOfflineNoti),this.listenMessage(game.MsgType.PK1V1_POST_ACTION_RESP,this.onPostActionResp),this.listenMessage(game.MsgType.PK1V1_POST_ACTION_NOTI,this.onPostActionNoti),this.listenMessage(game.MsgType.PK1V1_READY_TIMEOUT_RESP,this.onReadyTimeoutResp),this.listenMessage(game.MsgType.PK1V1_READY_TIMEOUT_NOTI,this.onReadyTimeoutNoti),this.listenMessage(game.MsgType.PK1V1_CANCEL_MATCH_RESP,this.onCancelMatchResp),this.listenMessage(game.MsgType.PK1V1_CANCEL_MATCH_NOTI,this.onCancelMatchNoti),this.listenMessage(game.MsgType.PK1V1_CREATE_ROOM_RESP,this.onCreateHost),this.listenMessage(game.MsgType.PK1V1_JOIN_ROOM_RESP,this.onJoinHost),this.listenMessage(game.MsgType.PK1V1_QUIT_ROOM_RESP,this.onExitHost),this.listenMessage(game.MsgType.PK1V1_ROOM_NUMBER_NOTI,this.onUserCountNoti),this.runtime.tickMe(this)},t.prototype.onDestroy=function(){this.removeAllListen()},t.prototype.tick=function(){var e=this;if(0<this.runtime.all_global_vars.length&&!this.globalVarSidMap)this.globalVarSidMap={},this.runtime.all_global_vars.forEach(function(t){e.globalVarSidMap[t.name]=t.sid});if(!this.initServer)if(xf.xfWebSocket.instance.status===xf.WebSocketStateEnum.CONNECTED)this.onSocketConnect(),this.initServer=!0},t.prototype.getDebuggerValues=function(t){var e="未开始战斗";if(this.attacker.cid)e=this.attacker.cid===xf.gameInfo.characterId?"自己":"敌方";var i="未开始战斗";if(this.enemy.cid)i=["在线玩家","AI"][Number(this.enemy.robotic)];t.push({title:"属性",properties:[{name:"对战状态",value:["待机","匹配中","匹配成功","已准备","对战中"][this.state],readonly:!0},{name:"匹配对象类型",value:i,readonly:!0},{name:"当前回合剩余时间(秒)",value:this.lastTime/1e3,readonly:!0},{name:"当前玩家回合",value:e,readonly:!0},{name:"匹配准备时间(秒)",value:this.readyWaitingTime/1e3,readonly:!0},{name:"回合数",value:this.round,readonly:!0}]})},t.prototype.onDebugValueEdited=function(t,e,i){e},t.prototype.onSocketConnect=function(){this.myConnectedState=s.ConnectedState.CONNECTED,this.trigger(drama.plugins_.pk1v1.prototype.cnds.onSocketStatusChange)},t.prototype.onSocketClose=function(t){a.Logger.info("websocket 断开连接！！！"),this.myConnectedState=s.ConnectedState.INTERNET_WAS_DICONNECTED,this.clean(),this.trigger(drama.plugins_.pk1v1.prototype.cnds.onSocketStatusChange),this.trigger(drama.plugins_.pk1v1.prototype.cnds.compareOffline)},t.prototype.onStartMatchResp=function(t){var e=game.PK1v1StartMatchResp.decode(t.messageData);if(e.instanceId===String(this.instanceId)){if(1!==e.code)return void a.Logger.error("1v1开始匹配异常：",e);this.state=s.State.MATCHING,this.round=0,this.trigger(drama.plugins_.pk1v1.prototype.cnds.startMatch),a.Logger.info("返回：1v1开始匹配")}},t.prototype.onFinishMatchNoti=function(t){var e=this,i=game.PK1v1FinishMatchNoti.decode(t.messageData);if(i.instanceId===String(this.instanceId)){if(this.state!==s.State.READY)this.state=s.State.MATCHSUCCESS;this.roomId=i.roomId,i.players.forEach(function(t){if(t.cid!==xf.gameInfo.characterId)e.enemy=t;else e.myself=t}),window.clearInterval(this.waitingTimer),this.readyWaitingTime=0,this.readyCountdown(),this.trigger(drama.plugins_.pk1v1.prototype.cnds.matchSuccess),a.Logger.info("通知：1v1匹配成功")}},t.prototype.onReadyPkResp=function(t){var e=game.PK1v1ReadyPKResp.decode(t.messageData);if(e.instanceId===String(this.instanceId)){if(1!==e.code)return void a.Logger.error("准备对战异常：",e);this.state=s.State.READY,a.Logger.info("返回：1v1准备对战")}},t.prototype.onCancelReadyResp=function(t){var e=game.PK1v1CancelReadyPKResp.decode(t.messageData);if(e.instanceId===String(this.instanceId)){if(1!==e.code)return void a.Logger.error("取消准备异常：",e);if(0<this.userCount&&this.userCount<2)this.state=s.State.MATCHING;else this.state=s.State.MATCHSUCCESS;a.Logger.info("返回：1v1取消准备")}},t.prototype.onCancelReadyNoti=function(t){var e=game.PK1v1CancelReadyPKNoti.decode(t.messageData);if(e.instanceId===String(this.instanceId))this.cancelReadyPlayerId=e.senderId,this.trigger(drama.plugins_.pk1v1.prototype.cnds.onCancelReady),this.cancelReadyPlayerId="",a.Logger.info("通知：1v1取消准备")},t.prototype.onStartPkNoti=function(t){var e=this,i=game.PK1v1StartPKNoti.decode(t.messageData);if(i.instanceId===String(this.instanceId))a.Logger.info("开始对战：",i),this.state=s.State.FIGHTING,this.readyWaitingTime=0,this.round=i.round,i.players.forEach(function(t){if(t.attackable)e.attacker=t;if(t.cid!==xf.gameInfo.characterId)e.enemy=t;else e.myself=t}),this.syncEnemyGlobalVar(i),this.roundStart(xf.xfWebSocketUtils.now()-Number(i.roundStartTime)),this.trigger(drama.plugins_.pk1v1.prototype.cnds.allReady)},t.prototype.onStartRoundNoti=function(t){var e=game.PK1v1StartRoundNoti.decode(t.messageData);if(e.instanceId===String(this.instanceId)){if(this.checkPKState())return;this.roomId=e.roomId,this.round=e.round,this.syncEnemyGlobalVar(e),this.roundStart(xf.xfWebSocketUtils.now()-Number(e.roundStartTime)),a.Logger.info("通知：1v1回合开始\n当前回合："+(this.attacker.cid===xf.gameInfo.characterId?"我方回合":"敌方回合"))}},t.prototype.onStopRoundResp=function(t){var e=game.PK1v1StopRoundResp.decode(t.messageData);if(e.instanceId===String(this.instanceId))if(1!==e.code)return void a.Logger.error("1v1回合结束异常：",e)},t.prototype.onStopPkResp=function(t){var e=game.PK1v1StopPKResp.decode(t.messageData);if(e.instanceId===String(this.instanceId)){if(1!==e.code)return void a.Logger.error("1v1退出对战异常：",e);this.clean(),this.trigger(drama.plugins_.pk1v1.prototype.cnds.quitBattle),a.Logger.info("退出对战：",e)}},t.prototype.onStopPkNoti=function(t){var e=game.PK1v1StopPKNoti.decode(t.messageData);if(e.instanceId===String(this.instanceId)){if(1!==e.code)return void a.Logger.error("1v1退出对战通知异常：",e);this.clean(),this.trigger(drama.plugins_.pk1v1.prototype.cnds.quitBattle),a.Logger.info("1v1退出对战：",e)}},t.prototype.onStopMatchResp=function(t){var e=game.PK1v1StopMatchResp.decode(t.messageData);if(e.instanceId===String(this.instanceId)){if(1!==e.code)return void a.Logger.error("1v1取消匹配返回异常：",e);this.clean(),this.trigger(drama.plugins_.pk1v1.prototype.cnds.stopMatch),a.Logger.info("返回：1v1取消匹配")}},t.prototype.onOfflineNoti=function(t){var e=game.PK1v1OfflineNoti.decode(t.messageData);if(e.instanceId===String(this.instanceId)){if(1!==e.code)return void a.Logger.error("1v1掉线通知异常：",e);if(e.offlineId===xf.gameInfo.characterId)this.myConnectedState=s.ConnectedState.FORCED_OFFLINE,this.state=s.State.STANDBY,window.clearTimeout(this.timer),xf.xfWebSocketUtils.isNeedReconnect=!1;else if(e.factor===s.ConnectedState.INTERNET_WAS_DICONNECTED)this.enemyConnectedState=s.ConnectedState.INTERNET_WAS_DICONNECTED;else if(e.factor===s.ConnectedState.FORCED_OFFLINE)this.enemyConnectedState=s.ConnectedState.FORCED_OFFLINE;this.trigger(drama.plugins_.pk1v1.prototype.cnds.compareOffline),a.Logger.info("通知：1v1掉线、顶号",e.factor,e.offlineId,xf.gameInfo.characterId)}},t.prototype.onPostActionResp=function(t){var e=game.PK1v1PostActionResp.decode(t.messageData);if(e.instanceId===String(this.instanceId)){if(1!==e.code)return void a.Logger.error("1v1对战数据返回异常：",e);a.Logger.info("返回：1v1广播对战数据")}},t.prototype.onPostActionNoti=function(t){var e=game.PK1v1PostActionNoti.decode(t.messageData);if(e.instanceId===String(this.instanceId)){if(1!==e.code)return void a.Logger.error("1v1接收对战数据异常：",e);this.action=e;try{this.params=JSON.parse(e.pkParams)}catch(t){throw new Error("1v1对战数据异常"+t.message)}this.trigger(drama.plugins_.pk1v1.prototype.cnds.onMessage),this.action=new game.PK1v1PostActionNoti,this.params=[],a.Logger.info("通知：1v1广播对战数据",e)}},t.prototype.onReadyTimeoutResp=function(t){var e=game.PK1v1ReadyTimeoutResp.decode(t.messageData);if(e.instanceId===String(this.instanceId)){if(1!==e.code)return void a.Logger.error("PK1v1ReadyTimeoutResp error：",e);a.Logger.info("返回：1v1超时未进入对战")}},t.prototype.onReadyTimeoutNoti=function(t){var e=game.PK1v1ReadyTimeoutNoti.decode(t.messageData);if(e.instanceId===String(this.instanceId)){if(1!==e.code)return void a.Logger.error("PK1v1ReadyTimeoutNoti error：",e);a.Logger.info("通知：1v1超时未进入对战")}},t.prototype.onCancelMatchResp=function(t){var e=game.PK1v1CancelMatchResp.decode(t.messageData);if(e.instanceId===String(this.instanceId)){if(1!==e.code)return void a.Logger.error("PK1v1CancelMatchResp error：",e);a.Logger.info("返回：1v1取消进入对战"),this.clean(),this.trigger(drama.plugins_.pk1v1.prototype.cnds.stopMatch)}},t.prototype.onCancelMatchNoti=function(t){var e=game.PK1v1CancelMatchNoti.decode(t.messageData);if(e.instanceId===String(this.instanceId)){if(1!==e.code)return void a.Logger.error("PK1v1CancelMatchNoti error：",e);a.Logger.info("通知：1v1取消进入对战"),this.clean(),this.trigger(drama.plugins_.pk1v1.prototype.cnds.stopMatch)}},t.prototype.onCreateHost=function(t){var e=game.PK1v1CreateRoomResp.decode(t.messageData);if(e.instanceId===String(this.instanceId)){if(this.creating=!1,1!==e.code)return a.Logger.error("PK1v1CreateRoomResp error：",e),this.enterErrorCode=e.info,void this.trigger(drama.plugins_.pk1v1.prototype.cnds.createHostFailed);a.Logger.info("通知：1v1创建房间"),this.userCount=1,this.inviteCode=e.inviteCode,this.roomId=e.roomId,this.state=s.State.MATCHING,this.trigger(drama.plugins_.pk1v1.prototype.cnds.createHostSuccess)}},t.prototype.onJoinHost=function(t){var e=game.PK1v1JoinRoomResp.decode(t.messageData);if(e.instanceId===String(this.instanceId)){if(this.joining=!1,1!==e.code)return a.Logger.error("PK1v1JoinRoomResp error：",e),this.enterErrorCode=e.info,void this.trigger(drama.plugins_.pk1v1.prototype.cnds.joinHostFailed);a.Logger.info("通知：1v1加入房间"),this.inviteCode=e.inviteCode,this.roomId=e.roomId,this.state=s.State.MATCHING,this.trigger(drama.plugins_.pk1v1.prototype.cnds.joinHostSuccess)}},t.prototype.onExitHost=function(t){var e=game.PK1v1QuitRoomResp.decode(t.messageData);if(e.instanceId===String(this.instanceId)){if(1!==e.code)return void a.Logger.error("PK1v1QuitRoomResp error：",e);a.Logger.info("通知：1v1退出房间"),this.clean()}},t.prototype.onUserCountNoti=function(t){var e=game.PK1v1RoomNumberNoti.decode(t.messageData);if(e.instanceId===String(this.instanceId)){if(1!==e.code)return void a.Logger.error("PK1v1RoomNumberNoti error：",e);if(a.Logger.info("通知：1v1人数改变"),this.userCount=e.roomNumber,this.userCount<2)if(window.clearInterval(this.waitingTimer),this.state==s.State.MATCHSUCCESS)this.state=s.State.MATCHING,a.Logger.info("通知：人数不足，变为匹配中状态")}},t.prototype.readyCountdown=function(){var t=this;this.waitingTimer=window.setInterval(function(){if(t.readyWaitingTime+=1e3,t.trigger(drama.plugins_.pk1v1.prototype.cnds.readyTimeout))window.clearInterval(t.waitingTimer)},1e3)},t.prototype.roundCountdown=function(){var t=this;if(!(this.lastTime<=0)){var e=1e3;if(0<this.lastTime%1e3&&this.lastTime<1e3)e=this.lastTime%1e3;this.timer=window.setTimeout(function(){if(0<t.lastTime)t.lastTime-=1e3,t.lastTime=t.lastTime<0?0:t.lastTime,t.roundCountdown()},e)}else this.trigger(drama.plugins_.pk1v1.prototype.cnds.roundTimeout)},t.prototype.sendFinishRound=function(t){window.clearTimeout(this.timer);var e=new game.PK1v1StopRoundReq;e.instanceId=String(this.instanceId),e.pluginId=String(this.puid),e.roomId=this.roomId,e.round=this.round,e.attackerId=t,xf.PacketUtils.sendPacket(game.MsgType.PK1V1_STOP_ROUND_REQ,game.PK1v1StopRoundReq.encode(e).finish()),this.trigger(drama.plugins_.pk1v1.prototype.cnds.roundEnd)},t.prototype.checkPKState=function(){if(this.state===s.State.STANDBY)return this.stopPK(),!0;else return!1},t.prototype.stopPK=function(){if(this.state!==s.State.STANDBY&&this.state!==s.State.MATCHING){var t=new game.PK1v1StopPKReq;t.instanceId=String(this.instanceId),t.pluginId=String(this.puid),t.roomId=this.roomId,xf.PacketUtils.sendPacket(game.MsgType.PK1V1_STOP_PK_REQ,game.PK1v1StopPKReq.encode(t).finish()),a.Logger.info("动作：1v1退出对战")}},t.prototype.roundStart=function(t){window.clearTimeout(this.timer),this.lastTime=this.prop.roundTimeout-t,a.Logger.info("1v1回合结束倒计时："+this.lastTime+"ms, 延时："+t+"ms"),this.roundCountdown(),this.trigger(drama.plugins_.pk1v1.prototype.cnds.roundStart)},t.prototype.syncEnemyGlobalVar=function(t){var e=this;t.players.forEach(function(t){if(t.attackable)e.attacker=t;if(t.cid!==xf.gameInfo.characterId)e.globalVariable=JSON.parse(t.glov)})},t.prototype.clean=function(){this.timer&&window.clearTimeout(this.timer),this.waitingTimer&&window.clearInterval(this.waitingTimer),this.timer=null,this.waitingTimer=null,this.readyWaitingTime=0,this.userCount=0,this.inviteCode="",this.roomId="",this.enemy=new game.PK1v1Player,this.myself=new game.PK1v1Player,this.state=s.State.STANDBY},t.prototype.joinHost=function(t){if(this.isCanJoinHost()){this.joining=!0;var e=new game.PK1v1JoinRoomReq;e.instanceId=String(this.instanceId),e.pluginId=String(this.puid),e.inviteCode=String(t),xf.PacketUtils.sendPacket(game.MsgType.PK1V1_JOIN_ROOM_REQ,game.PK1v1JoinRoomReq.encode(e).finish())}},t.prototype.exitHost=function(t){if((this.state===s.State.MATCHING||this.state===s.State.MATCHSUCCESS)&&this.isConnected()){var e=new game.PK1v1QuitRoomReq;e.instanceId=String(this.instanceId),e.pluginId=String(this.puid),e.inviteCode=String(t),xf.PacketUtils.sendPacket(game.MsgType.PK1V1_QUIT_ROOM_REQ,game.PK1v1QuitRoomReq.encode(e).finish()),a.Logger.info("动作：1v1退出房间")}},t.prototype.isCanJoinHost=function(){return this.state==s.State.STANDBY&&!this.creating&&!this.joining&&this.isConnected()},t.prototype.isConnected=function(){return!this.myConnectedState||this.myConnectedState===s.ConnectedState.CONNECTED},t}(e.Property=c);e.default=u},d27c30dad6345543:function(t,e,i){Object.defineProperty(e,"__esModule",{value:!0});var n=function(){};e.DefendedBase=n},da506072e2374da8:function(t,e,i){var n,r,o,s,a,l,c,u,h,d;Object.defineProperty(e,"__esModule",{value:!0}),(n=e.State||(e.State={}))[n.STANDBY=0]="STANDBY",n[n.MATCHING=1]="MATCHING",n[n.MATCHSUCCESS=2]="MATCHSUCCESS",n[n.READY=3]="READY",n[n.FIGHTING=4]="FIGHTING",(r=e.Compare||(e.Compare={}))[r.EQUAL_TO=0]="EQUAL_TO",r[r.NOT_EQUAL_TO=1]="NOT_EQUAL_TO",r[r.LESS_THAN=2]="LESS_THAN",r[r.LESS_OR_EQUAL=3]="LESS_OR_EQUAL",r[r.GREATEROR_THAN=4]="GREATEROR_THAN",r[r.GREATEROR_EQUAL=5]="GREATEROR_EQUAL",(o=e.ConnectedState||(e.ConnectedState={})).CONNECTED="connected",o.INTERNET_WAS_DICONNECTED="disconnection",o.FORCED_OFFLINE="replacement",(s=e.AttackerOrder||(e.AttackerOrder={}))[s.MYSELF=0]="MYSELF",s[s.ENEMY=1]="ENEMY",(a=e.PlayerType||(e.PlayerType={}))[a.REAL=0]="REAL",a[a.AI=1]="AI",(l=e.MatchType||(e.MatchType={})).ALL="ALL",l.ONLINE="ONLINE",l.OFFLINE="OFFLINE",(c=e.Order||(e.Order={}))[c.DESC=0]="DESC",c[c.ASC=1]="ASC",(u=e.SocketState||(e.SocketState={}))[u.ENABLE=0]="ENABLE",u[u.DISABLE=1]="DISABLE",(h=e.HostActionType||(e.HostActionType={}))[h.JOIN=0]="JOIN",h[h.EXIT=1]="EXIT",(d=e.CancelReady||(e.CancelReady={}))[d.MYSELF=0]="MYSELF",d[d.ENEMY=1]="ENEMY"},db60446d20396a6c:function(t,e,i){var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.getParamCount=function(t,e){if(this.action.pkAction===e)t.set_int(this.params.length)},e.prototype.getParam=function(t,e,i){if(this.action.pkAction===e&&i<this.params.length)t.set_any(this.params[i]);else t.set_any(null)},e.prototype.getEnemyGlobalVar=function(t,e){if(this.globalVarSidMap&&this.globalVariable){var i=this.globalVarSidMap[e];t.set_any(this.globalVariable[i])}else t.set_any("")},e.prototype.getRoundLastTime=function(t){t.set_int(this.lastTime/1e3)},e.prototype.getInviteCode=function(t){t.set_string(this.inviteCode)},e.prototype.getEnterErrorCode=function(t){t.set_string(this.enterErrorCode)},e.prototype.getUserCountInRoom=function(t){t.set_int(this.userCount)},e}(i("9998d8dbcd94d410").Property);e.default=o},e681aed280414b09:function(t,e,i){var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=function(i){function t(t){var e=i.call(this)||this;return e.type=t,e.runtime=t.runtime,e}return r(t,i),t.prototype.onCreate=function(){},t.prototype.draw=function(t,e){},t.prototype.drawGL=function(t){},t.prototype.onDestroy=function(){},t.prototype.trigger=function(t){return this.runtime.trigger(t,this)},t.prototype.tick=function(){},t.prototype.GetDebuggerProperties=function(){return[]},t.prototype.SaveToJson=function(){return null},t.prototype.LoadFromJson=function(){},t.prototype.LoadTilemapData=function(){},t.prototype.TestPointOverlapTile=function(){},t.prototype.GetPropertyValueByIndex=function(){},t.prototype.SetPropertyValueByIndex=function(){},t.prototype.SetPropertyOffsetValueByIndex=function(){},t.prototype.SetPropertyColorOffsetValueByIndex=function(){},t.prototype.CallAction=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];t.call.apply(t,[this].concat(e))},t.prototype.CallExpression=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];return t.call.apply(t,[this].concat(e))},t.formatProp=function(t,e,i){var n=e,r=Object.keys(n);return t.properties.forEach(function(t,e){if(e<r.length)if(!i(t,e,r[e]))n[r[e]]=t}),n},t.compareText=function(t,e,i){if("string"!=typeof t||"string"!=typeof i)return!1;switch(e){case 0:return t==i;case 1:return t!=i;case 2:return-1<t.indexOf(i);case 3:return-1==t.indexOf(i);default:return window.assert2(!1,"Invalid comparison value: "+e),!1}},t.prototype.listenMessage=function(t,e,i,n){if(void 0===i)i=null;if(void 0===n)n=0;xf.EventCenter.instance.addEventListener(t,e,i||this,n),this.listenBins=this.listenBins?this.listenBins:[],this.listenBins.push({messageID:t,method:e})},t.prototype.removeAllListen=function(){if(this.listenBins&&this.listenBins.length){for(var t=0,e=this.listenBins;t<e.length;t++){var i=e[t];xf.EventCenter.instance.removeEventListener(i.messageID,i.method,this)}this.listenBins.length=0}},t}(i("d27c30dad6345543").DefendedBase);e.SDKInstanceBase=o},e7b602c229ac5b71:function(t,e,i){var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=function(i){function t(t){var e=i.call(this)||this;return e.runtime=t,e._isSingleGlobal=!!t.isSingleGlobal,e._isWorldType=!!t.isWorld,e._isRotatable=!!t.isRotatable,e._mustPredraw=!!t.mustPredraw,e._hasEffects=!!t.hasEffects,e._singleGlobalObjectClass=null,e}return r(t,i),t.prototype.onCreate=function(){},t.prototype.IsSingleGlobal=function(){return this._isSingleGlobal},t.prototype.IsWorldType=function(){return this._isWorldType},t.prototype.IsRotatable=function(){return this._isRotatable},t.prototype.MustPreDraw=function(){return this._mustPredraw},t.prototype.HasEffects=function(){return this._hasEffects},t.prototype._SetSingleGlobalObjectClass=function(t){if(!this.IsSingleGlobal())throw new Error("must be single-global plugin");this._singleGlobalObjectClass=t},t.prototype.GetSingleGlobalObjectClass=function(){if(!this.IsSingleGlobal())throw new Error("must be single-global plugin");return this._singleGlobalObjectClass},t.prototype.GetSingleGlobalInstance=function(){if(!this.IsSingleGlobal())throw new Error("must be single-global plugin");return this._singleGlobalObjectClass.GetSingleGlobalInstance()},t}(i("d27c30dad6345543").DefendedBase);e.SDKPluginBase=o}}),assert2(drama,"drama namespace not created"),assert2(drama.plugins_,"drama.plugins_ not created"),drama.plugins_.xfButton=function(t){this.runtime=t},function(){var t=drama.plugins_.xfButton.prototype;t.Type=function(t){this.plugin=t,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){if(!this.is_family)this.all_frames=[],this.has_loaded_textures=!1,this.animationsByName={},xf.formatAnimation(this)},t.Instance=function(t){this.type=t,this.runtime=t.runtime};var e=t.Instance.prototype;function i(){}function n(){}function r(){}e.onCreate=function(){var i=this;xf.testTypeImage(this.type);var e=this;if(this.mouseXcanvas=0,this.mouseYcanvas=0,this.visible=this.properties[0],this.text=this.properties[1],this.disabled=!this.properties[2],this.color=this.properties[3],this.textAlpha=this.properties[3][3]||1,this.fontSize=this.properties[4],this.fontFamily=this.properties[5],this.textAlign=this.properties[6],this.clickEffect=this.properties[7],this.audio=this.properties[8],this.disAudio=this.properties[9],this.audio||this.disAudio)this.audioInst=xf.audioInstance(this.runtime);this.hoverFlag=!1,this.pressedFlag=!1,this.event=xf.XfEvent.create(this.runtime),this.event.addEventListener("mousedown",function(t){if(e.handlePlayAudio(),!e.disabled)e.pressedFlag=!0,e.updateFrame("pressed"),e.initScale()},this),this.event.addEventListener("mouseup",function(t){if(!e.disabled)e.pressedFlag=!1,e.updateFrame("normal"),e.restoreScale(),e.runtime.trigger(drama.plugins_.xfButton.prototype.cnds.OnClicked,e),xf.EventCenter.instance.sendEvent(new xf.EventData(xf.EventType.BUTTON_CLICKED,{name:this.type.name}))},this),this.event.addEventListener("touchstart",function(t){if(e.handlePlayAudio(),!e.disabled)e.pressedFlag=!0,e.updateFrame("pressed"),e.initScale()},this),this.event.addEventListener("touchend",function(t){if(!e.disabled)e.pressedFlag=!1,e.updateFrame("normal"),e.restoreScale(),e.runtime.trigger(drama.plugins_.xfButton.prototype.cnds.OnClicked,e),xf.EventCenter.instance.sendEvent(new xf.EventData(xf.EventType.BUTTON_CLICKED,{name:this.type.name}))},this),this.event.addEventListener("mouseover",function(t){if(!e.disabled)e.hoverFlag=!0,e.updateFrame("hover"),e.runtime.trigger(drama.plugins_.xfButton.prototype.cnds.OnHover,e)},this),this.event.addEventListener("mouseout",function(t){if(!e.disabled)e.hoverFlag=!1,e.pressedFlag=!1,e.updateFrame("normal"),e.restoreScale(),e.runtime.trigger(drama.plugins_.xfButton.prototype.cnds.OnMouseOut,e)},this),xf.loadTextures(this.type),this.buttonImgMap={};["disabled","hover","pressed","normal"].map(function(t){var e=xf.getAnimationByName(i.type,t).frames[0];i.buttonImgMap[t]=e.texture_img}),this.runtime.tick2Me(this),this.tweenData={scale:1},this.drawInit()},e.drawInit=function(){var t=new xf.xfContainer;this.container=t,(this.container.owner=this).container.width=this.width,this.container.height=this.height,this.container.x=this.x,this.container.y=this.y,t.alpha=this.opacity;var e=new xf.xfImage;(this.btnImg=e).width=this.width,e.height=this.height,this.updateFrame("normal");var i=xf.TextStyle.create();i.vAlign="middle",i.hAlign=this.textAlign,i.line_vAlign="middle",i.size=this.fontSize,i.fontFamily=this.fontFamily,i.color=xf.hexaDecimal(this.color);var n=new xf.xfText(i);(this.textGl=n).width=this.width,n.height=this.height,n.alpha=this.textAlpha,n.text=this.text,t.addChild(e),t.addChild(n)},e.initScale=function(){if("scale"==this.clickEffect)this.tween=new TWEEN.Tween(this.tweenData).to({scale:.8},200).easing(TWEEN.Easing.Linear.None),this.tween.start()},e.restoreScale=function(){if("scale"==this.clickEffect)this.tween=new TWEEN.Tween(this.tweenData).to({scale:1},200).easing(TWEEN.Easing.Linear.None),this.tween.start()},e.handlePlayAudio=function(){setTimeout(function(){if(this.audioInst){this.audioInst.Stop("xfMouseAndTouchDefaultAudio");var t=this.disabled?this.disAudio:this.audio;this.audioInst.Stop(t+this.uid),this.audioInst.Play([t,!0],0,1,t+this.uid)}}.bind(this),0)},e.updateFrame=function(t){t=this.disabled?"disabled":t;var e=this.buttonImgMap[t];if(e)this.btnImg.source=e;this.runtime.redraw=!0},e.saveToJSON=function(){return{text:this.text,visible:this.visible,disabled:this.disabled}},e.loadFromJSON=function(t){this.text=t.text,this.textGl.text=t.text,this.disabled=t.disabled,this.visible=t.visible},e.onDestroy=function(){if(this.event.removeEventListeners(["mousedown","mouseup","mouseover","mouseout","touchstart","touchend"],this),this.container)this.container.destory(),this.container=null;this.textGl=null,this.image=null},e.changeSizeOrPos=function(){this.container.x=this.x,this.container.y=this.y,this.container.rotation=this.angle,this.container.alpha=this.opacity;var t=this.width/this.container.width,e=this.height/this.container.height;if(this.container.anchorOffsetX=this.container.width*this.hotspotX,this.container.anchorOffsetY=this.container.height*this.hotspotY,1!=t||1!=e)this.container.scaleX=t,this.container.scaleY=e;else this.container.scaleX=this.tweenData.scale,this.container.scaleY=this.tweenData.scale},e.tick2=function(){this.changeSizeOrPos()},e.draw=function(t){if(!this.visible)return!1;this.container.draw(t,this.runtime)},e.drawGL=function(t){if(!this.visible)return!1;this.container.drawGL(t,this.runtime)},i.prototype.OnClicked=function(){return!0},i.prototype.OnHover=function(){return!0},i.prototype.OnMouseOut=function(){return!0},t.cnds=new i,n.prototype.SetText=function(t){this.textGl.text=t,this.text=t},n.prototype.SetVisible=function(t){this.visible=0!==t},n.prototype.SetEnabled=function(t){this.disabled=1!==t,this.updateFrame("normal")},t.acts=new n,r.prototype.Text=function(t){t.set_string(this.text)},r.prototype.State=function(t){var e=0;if(this.disabled)e=3;else if(this.pressedFlag)e=2;else if(this.hoverFlag)e=1;t.set_int(e)},t.exps=new r}(),assert2(drama,"drama namespace not created"),assert2(drama.plugins_,"drama.plugins_ not created"),drama.plugins_.xfCheckBox=function(t){this.runtime=t},function(){var t=drama.plugins_.xfCheckBox.prototype;t.Type=function(t){this.plugin=t,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){if(!this.is_family)this.all_frames=[],this.has_loaded_textures=!1,this.animationsByName={},xf.formatAnimation(this)},t.Instance=function(t){this.type=t,this.runtime=t.runtime};var e=t.Instance.prototype;function i(){}function n(){}function r(){}e.onCreate=function(){var i=this;xf.testTypeImage(this.type);var e=this;if(this.visible=this.properties[0],this.text=this.properties[1],this.disabled=!this.properties[2],this.color=this.properties[3],this.textAlpha=this.properties[3][3]||1,this.fontSize=this.properties[4],this.fontFamily=this.properties[5],this.isChecked=this.properties[6],this.audio=this.properties[7],this.disAudio=this.properties[8],this.audio||this.disAudio)this.audioInst=xf.audioInstance(this.runtime);this.event=xf.XfEvent.create(this.runtime),this.event.addEventListener("mousedown",function(t){e.handlePlayAudio()},this),this.event.addEventListener("mouseup",function(t){if(!e.disabled)e.isChecked=!e.isChecked,e.updateFrame()},this),this.event.addEventListener("touchstart",function(t){e.handlePlayAudio()},this),this.event.addEventListener("touchend",function(t){if(!e.disabled)e.isChecked=!e.isChecked,e.updateFrame()},this),this.runtime.tickMe(this),xf.loadTextures(this.type),this.checkboxMap={};["disabled","checked","normal"].map(function(t){var e=xf.getAnimationByName(i.type,t).frames[0];i.checkboxMap[t]=e.texture_img}),this.drawInit()},e.drawInit=function(){var t=new xf.xfContainer;this.container=t,this.container.owner=this,t.anchorOffsetX=this.width*this.hotspotX,t.anchorOffsetY=this.height*this.hotspotY,t.width=this.width,t.height=this.height,t.x=this.x,t.y=this.y,t.alpha=this.opacity;var e=new xf.xfImage;(this.image=e).width=this.height,e.height=this.height,this.updateFrame();var i=xf.TextStyle.create();i.vAlign="middle",i.hAlign="right",i.size=this.fontSize,i.fontFamily=this.fontFamily,i.color=xf.hexaDecimal(this.color);var n=new xf.xfText(i);(this.textGl=n).width=this.width,n.height=this.height,n.text=this.text,n.alpha=this.textAlpha,t.addChild(e),t.addChild(n)},e.handlePlayAudio=function(){setTimeout(function(){if(this.audioInst){this.audioInst.Stop("xfMouseAndTouchDefaultAudio");var t=this.disabled?this.disAudio:this.audio;this.audioInst.Stop(t+this.uid),this.audioInst.Play([t,!0],0,1,t+this.uid)}}.bind(this),0)},e.updateFrame=function(){var t=this.disabled?"disabled":this.isChecked?"checked":"normal",e=this.checkboxMap[t];if(e)this.image.source=e},e.saveToJSON=function(){return{text:this.text,visible:this.visible,disabled:this.disabled,checked:this.isChecked}},e.loadFromJSON=function(t){this.text=t.text,this.disabled=t.disabled,this.visible=t.visible,this.isChecked=t.checked},e.onDestroy=function(){if(this.event.removeEventListeners(["mousedown","mouseup","touchend","touchstart"],this),this.container)this.container.destory(),this.container=null;this.textGl=null,this.image=null},e.changeSizeOrPos=function(){this.container.x=this.x,this.container.y=this.y,this.container.alpha=this.opacity,this.container.rotation=this.angle,this.container.scale.x=this.width/this.container.width,this.container.scale.y=this.height/this.container.height},e.tick=function(){this.changeSizeOrPos(),this.runtime.redraw=!0},e.draw=function(t){if(!this.visible)return!1;this.container.draw(t,this.runtime)},e.drawGL=function(t){if(!this.visible)return!1;this.container.drawGL(t,this.runtime)},i.prototype.OnChecked=function(){return this.isChecked},i.prototype.OnUnchecked=function(){return!this.isChecked},t.cnds=new i,n.prototype.SetText=function(t){this.textGl.text=t},n.prototype.SetVisible=function(t){this.visible=0!==t},n.prototype.SetEnabled=function(t){this.disabled=1!==t,this.updateFrame()},n.prototype.SetChecked=function(t){if(!this.disabled)this.isChecked=1===t,this.updateFrame()},n.prototype.ToggleChecked=function(){if(!this.disabled)this.isChecked=!this.isChecked,this.updateFrame()},t.acts=new n,r.prototype.Text=function(t){t.set_string(this.text)},r.prototype.isChecked=function(t){var e=0;if(this.isChecked)e=1;t.set_int(e)},t.exps=new r}(),assert2(drama,"drama namespace not created"),assert2(drama.plugins_,"drama.plugins_ not created"),drama.plugins_.xfCouldSave=function(t){this.runtime=t},function(){var t=drama.plugins_.xfCouldSave.prototype;t.Type=function(t){this.plugin=t,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t){this.type=t,this.runtime=t.runtime};var e=t.Instance.prototype;function i(){}function n(){}e.xfInstance=null,e.oldInstance=null,e.onCreate=function(){this.getFromOldSave=!1,this.isSync=!1,this.isCount=!1,this.interval=2e3},e.saveToJSON=function(){return{}},e.loadFromJSON=function(t){},e.onDestroy=function(){localforage.dropInstance()},e.draw=function(t){},e.drawGL=function(t){},e.handleSyncToCloud=function(){var n=this;this.runtime.trigger(drama.plugins_.xfCouldSave.prototype.cnds.OnCloudSyncStart,n),xf.webApi.queryArchive().then(function(i){xf.archiveSDK.getSaveSlots().then(function(t){if(!i.length&&t.length)return console.log("云端没有存档且本地有存档，直接上传本地存档"),xf.archiveSDK.saveSlotToCloud(t).then(function(t){n.runtime.trigger(drama.plugins_.xfCouldSave.prototype.cnds.OnCloudSyncSuccess,n)}).catch(function(t){n.runtime.trigger(drama.plugins_.xfCouldSave.prototype.cnds.OnCloudSyncFailed,n)}),n.isSync=!1;if(!t.length)return console.log("本地没有存档"),n.isSync=!1,n.runtime.trigger(drama.plugins_.xfCouldSave.prototype.cnds.OnCloudSyncSuccess,n),!1;var e=xf.archiveSDK.getSaveSlotsNameLocal(i,t);if(e.length)xf.archiveSDK.saveSlotToCloud(e).then(function(t){n.runtime.trigger(drama.plugins_.xfCouldSave.prototype.cnds.OnCloudSyncSuccess,n)}).catch(function(t){n.runtime.trigger(drama.plugins_.xfCouldSave.prototype.cnds.OnCloudSyncFailed,n)});else n.runtime.trigger(drama.plugins_.xfCouldSave.prototype.cnds.OnCloudSyncSuccess,n),console.log("不需要上传");n.isSync=!1})}).catch(function(t){console.log(t),n.isSync=!1,n.runtime.trigger(drama.plugins_.xfCouldSave.prototype.cnds.OnCloudSyncFailed,n)})},e.handleSyncToLocal=function(){var n=this;this.runtime.trigger(drama.plugins_.xfCouldSave.prototype.cnds.OnLocalSyncStart,n),xf.webApi.queryArchive().then(function(i){xf.archiveSDK.getSaveSlots().then(function(t){var e=xf.archiveSDK.getSaveSlotsNameCloud(i,t);if(e.length)xf.archiveSDK.getSlotFromCloud(e).then(function(t){if(0==t.error)n.runtime.trigger(drama.plugins_.xfCouldSave.prototype.cnds.OnLocalSyncSuccess,n);else n.runtime.trigger(drama.plugins_.xfCouldSave.prototype.cnds.OnLocalSyncFailed,n)}).catch(function(t){n.runtime.trigger(drama.plugins_.xfCouldSave.prototype.cnds.OnLocalSyncFailed,n)});else n.runtime.trigger(drama.plugins_.xfCouldSave.prototype.cnds.OnLocalSyncSuccess,n),console.log("不需要云端存档同步到本地");n.isSync=!1})}).catch(function(t){console.log(t),n.isSync=!1,n.runtime.trigger(drama.plugins_.xfCouldSave.prototype.cnds.OnLocalSyncFailed,n)})},i.prototype.OnCloudSyncStart=function(){return!0},i.prototype.OnCloudSyncSuccess=function(){return!0},i.prototype.OnCloudSyncFailed=function(){return!0},i.prototype.OnLocalSyncStart=function(){return!0},i.prototype.OnLocalSyncSuccess=function(){return!0},i.prototype.OnLocalSyncFailed=function(){return!0},i.prototype.OnSyncTooFast=function(){return!0},i.prototype.IsSyncing=function(){return this.isSync},t.cnds=new i,n.prototype.SyncToLocal=function(){if(!xf.gameInfo.playerId||!xfConfig.isLogin)return this.runtime.trigger(drama.plugins_.xfCouldSave.prototype.cnds.OnLocalSyncFailed,this),!1;if(!navigator.onLine)return this.runtime.trigger(drama.plugins_.xfCouldSave.prototype.cnds.OnLocalSyncFailed,this),!1;if(this.isSync)return console.log("同步中"),this.runtime.trigger(drama.plugins_.xfCouldSave.prototype.cnds.IsSyncing,this),!1;if(this.isCount)return console.log("频率过快"),this.runtime.trigger(drama.plugins_.xfCouldSave.prototype.cnds.OnSyncTooFast,this),!1;this.isSync=!0,this.isCount=!0;var t=this;setTimeout(function(){t.isCount=!1},this.interval),this.handleSyncToLocal()},n.prototype.SyncToCloud=function(){if(!xf.gameInfo.playerId||!xfConfig.isLogin)return this.runtime.trigger(drama.plugins_.xfCouldSave.prototype.cnds.OnCloudSyncFailed,this),!1;if(!navigator.onLine)return this.runtime.trigger(drama.plugins_.xfCouldSave.prototype.cnds.OnCloudSyncFailed,this),!1;if(this.isSync)return console.log("同步中哦"),this.runtime.trigger(drama.plugins_.xfCouldSave.prototype.cnds.IsSyncing,this),!1;if(this.isCount)return console.log("频率过快"),this.runtime.trigger(drama.plugins_.xfCouldSave.prototype.cnds.OnSyncTooFast,this),!1;this.isSync=!0,this.isCount=!0;var t=this;setTimeout(function(){t.isCount=!1},this.interval),this.handleSyncToCloud()},t.acts=new n,t.exps=new function(){}}(),function(i){var n={};function r(t){if(n[t])return n[t].exports;var e=n[t]={i:t,l:!1,exports:{}};return i[t].call(e.exports,e,e.exports,r),e.l=!0,e.exports}r.m=i,r.c=n,r.d=function(t,e,i){if(!r.o(t,e))Object.defineProperty(t,e,{enumerable:!0,get:i})},r.r=function(t){if("undefined"!=typeof Symbol&&Symbol.toStringTag)Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(e,t){if(1&t)e=r(e);if(8&t)return e;if(4&t&&"object"===_typeof(e)&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(i,n,function(t){return e[t]}.bind(null,n));return i},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s="5e0ec976d1838ef1")}({"0330f9384c2c8825":function(t,e,i){var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=function(i){function t(t){var e=i.call(this)||this;return e._runtime=t.runtime,e._plugin=t,e}return r(t,i),Object.defineProperty(t.prototype,"runtime",{get:function(){return this._runtime},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"plugin",{get:function(){return this._plugin},enumerable:!0,configurable:!0}),t.prototype.onCreate=function(){},t.prototype.Release=function(){this._runtime=null,this._plugin=null},t.prototype.FinishCondition=function(){},t.prototype.LoadTextures=function(){},t.prototype.ReleaseTextures=function(){},t.prototype.OnDynamicTextureLoadComplete=function(){},t.prototype.LoadTilePolyData=function(){},t}(i("d27c30dad6345543").DefendedBase);e.SDKTypeBase=o},"5af91fa7fde766be":function(t,e,i){var n,r,o,s,a,l;Object.defineProperty(e,"__esModule",{value:!0}),(n=e.FocusState||(e.FocusState={}))[n.FOCUS=0]="FOCUS",n[n.BLUR=1]="BLUR",n[n.SWITCH=2]="SWITCH",(r=e.InputType||(e.InputType={}))[r.TEXT=0]="TEXT",r[r.TEXTAREA=1]="TEXTAREA",r[r.PASSWORD=2]="PASSWORD",(o=e.HorizontalAlign||(e.HorizontalAlign={})).LEFT="left",o.CENTER="center",o.RIGHT="right",(s=e.VerticalAlign||(e.VerticalAlign={})).TOP="top",s.MIDDLE="middle",s.BOTTOM="bottom",(a=e.KeyboardType||(e.KeyboardType={}))[a.NORMAL=0]="NORMAL",a[a.NUMBER=1]="NUMBER",(l=e.KeyboardState||(e.KeyboardState={}))[l.CLOSE=0]="CLOSE",l[l.OPEN=1]="OPEN"},"5e0ec976d1838ef1":function(t,e,i){var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i("e7b602c229ac5b71"),s=i("e14b41e30cdc6afd"),a=i("9e7dde3aad14dec6"),l=i("fa8217e587b89620"),c=i("9920cfd3edc062c9"),u=i("fb24c564ca0a59f6");window.assert2(window.drama,"drama namespace not created"),window.assert2(window.drama.plugins_,"drama.plugins_ not created");var h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e}(o.SDKPluginBase);h.prototype.Instance=a.default,h.prototype.Type=s.default,h.prototype.cnds=new l.default({}),h.prototype.exps=new u.default({}),h.prototype.acts=new c.default({}),window.drama.plugins_.xfInput=h},"8a2277f490c7663c":function(t,e,i){Object.defineProperty(e,"__esModule",{value:!0});var r=i("5af91fa7fde766be"),n=function(){var n=this;this.contentColor=[0,0,0,0],this.contentFontSize=0,this.contentFontFamily="",this.placeholderColor=[0,0,0,0],this.placeholderFontSize=12,this.placeholderFontFamily="",this.horizontalAlign=r.HorizontalAlign.LEFT,this.inputType=r.InputType.TEXT,this.defaultValue="",this.placeholder="",this.valueLimit=0,this.keyboardType=r.KeyboardType.NORMAL,this.showBackground=!0,this.format=function(t,e,i){switch(e){case 6:n.horizontalAlign=Object.values(r.HorizontalAlign)[t];break;case 12:n.showBackground=!t[0].hideBg,n.borderColor=t[1].rectColor,n.lineWidth=t[1].lineWidth,n.showBorder=t[1].showRect,n.marginLeft=Math.floor(t[1].world.x-t[0].world.x+t[1].lineWidth/2),n.marginTop=Math.floor(t[1].world.y-t[0].world.y+t[1].lineWidth/2),n.marginRight=Math.floor(t[0].world.width-(t[1].world.x-t[0].world.x+t[1].world.width)+t[1].lineWidth/2),n.marginBottom=Math.floor(t[0].world.height-(t[1].world.y-t[0].world.y+t[1].world.height)+t[1].lineWidth/2),n.border={width:t[1].world.width,height:t[1].world.height};break;default:return!1}return!0}};e.default=n},"9920cfd3edc062c9":function(t,e,i){var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i("9e7dde3aad14dec6"),s=i("5af91fa7fde766be"),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.setFocus=function(t){var e=s.FocusState.BLUR;if(t===s.FocusState.SWITCH)e=this.state===s.FocusState.FOCUS?s.FocusState.BLUR:s.FocusState.FOCUS;else e=t;if(e===s.FocusState.FOCUS)this.focus();else this.inputProxy.blur()},e.prototype.setPlaceholder=function(t){this.prop.placeholder=String(t),this.setText()},e.prototype.cleanInput=function(){if(this.value="",this.inputProxy.focusInst&&this.inputProxy.focusInst.uid===this.uid)this.inputProxy.clean();this.setText(),this.text.text=this.prop.placeholder},e}(o.default);e.default=a},"99e8fa22055aabce":function(t,e,i){var r=this&&this.__awaiter||function(o,s,a,l){return new(a||(a=Promise))(function(t,e){function i(t){try{r(l.next(t))}catch(t){e(t)}}function n(t){try{r(l.throw(t))}catch(t){e(t)}}function r(e){e.done?t(e.value):new a(function(t){t(e.value)}).then(i,n)}r((l=l.apply(o,s||[])).next())})},o=this&&this.__generator||function(i,n){var r,o,s,t,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;if(o=0,s)e=[2&e[0],s.value];switch(e[0]){case 0:case 1:s=e;break;case 4:return a.label++,{value:e[1],done:!1};case 5:a.label++,o=e[1],e=[0];continue;case 7:e=a.ops.pop(),a.trys.pop();continue;default:if(!(s=0<(s=a.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){a=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){a.label=e[1];break}if(6===e[0]&&a.label<s[1]){a.label=s[1],s=e;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(e);break}if(s[2])a.ops.pop();a.trys.pop();continue}e=n.call(i,a)}catch(t){e=[6,t],o=0}finally{r=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}};Object.defineProperty(e,"__esModule",{value:!0});var s=i("5af91fa7fde766be"),n=function(){function t(){var e=this;this.keyboardState=s.KeyboardState.CLOSE,this.onKeyboardInput=function(t){if(e.focusInst)e.focusInst.onChange(t.value)},this.onKeyboardComplete=function(t){if(e.focusInst)e.focusInst.onBlur()}}return t.prototype.init=function(){if(!this.sdk){if(window.xfruntime.isWeixin)this.sdk=wx;else if(window.xfruntime.isByte)this.sdk=tt;else if(window.xfruntime.isBilibili)this.sdk=bl;this.sdk.onKeyboardInput(this.onKeyboardInput),this.sdk.onKeyboardComplete(this.onKeyboardComplete)}},t.prototype.focus=function(n){return r(this,void 0,void 0,function(){var e,i=this;return o(this,function(t){switch(t.label){case 0:if(this.keyboardState!==s.KeyboardState.OPEN||!this.focusInst||n.prop.inputType!==this.focusInst.prop.inputType)return[3,1];else return this.focusInst=n,this.sdk.updateKeyboard({value:n.value}),[3,3];case 1:return this.focusInst=n,e=this.keyboardState===s.KeyboardState.OPEN?500:0,[4,this.blur()];case 2:t.sent(),setTimeout(function(){i.sdk.showKeyboard({defaultValue:i.focusInst.value,maxLength:i.focusInst.prop.valueLimit,multiple:Boolean(i.focusInst.prop.inputType),confirmType:"done",success:function(){i.keyboardState=s.KeyboardState.OPEN},fail:function(){i.focusInst=null}})},e),t.label=3;case 3:return[2]}})})},t.prototype.blur=function(){var i=this;return new Promise(function(t,e){if(i.keyboardState===s.KeyboardState.OPEN)i.sdk.hideKeyboard({success:function(){i.keyboardState=s.KeyboardState.CLOSE,t()},fail:function(){e()}});else t()})},t.prototype.clean=function(){if(this.focusInst.state===s.FocusState.FOCUS&&this.sdk.updateKeyboard)this.sdk.updateKeyboard({value:this.focusInst.value})},t.prototype.resize=function(t){},t}();e.default=new n},"9e7dde3aad14dec6":function(t,e,i){var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i("e681aed280414b09"),s=i("5af91fa7fde766be"),a=i("baf054261a26ef5d"),l=i("99e8fa22055aabce"),c=i("8a2277f490c7663c"),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e}(o.SDKInstanceBase),h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.state=s.FocusState.BLUR,e.placeholder="",e.value="",e.inputType=s.InputType.TEXT,e.prop=new c.default,e.onClick=function(t){e.focus()},e.onChange=function(t){e.changeText(t)},e.changeText=function(t){e.value=t,e.setText()},e.onBlur=function(){e.state=s.FocusState.BLUR,e.setText(),e.trigger(drama.plugins_.xfInput.prototype.cnds.compareFocus)},e.checkForbiddon=function(t){if(0<window.checkForbiddon(t).length)return xf.MessageBox.alert("您输入的内容包含敏感信息,请修改后重试",{title:"检测到敏感信息"}),!0;else return!1},e}return r(e,t),e.prototype.onCreate=function(){if(xf.testTypeImage(this.type),this.prop=o.SDKInstanceBase.formatProp(this,this.prop,this.prop.format),this.runtime.isMinigame)this.inputProxy=l.default;else this.inputProxy=a.default;if(this.event=xf.XfEvent.create(this.runtime),this.runtime.isMobile)this.event.addEventListener("touchstart",function(){},this),this.event.addEventListener("touchend",this.onClick,this);else this.event.addEventListener("click",this.onClick,this);this.inputProxy.init(),xf.loadTextures(this.type),this.drawInit(),this.runtime.tickMe(this)},e.prototype.onDestroy=function(){this.event.removeEventListeners(["touchstart","touchend","click"],this),this.event=null,this.container=null,this.bgImg=null,this.text=null,this.border=null,this.borderContext=null,this.borderImg=null,this.inputProxy=null},e.prototype.draw=function(t,e){if(!this.visible)return!1;if(this.container)this.container.draw(t,this.runtime)},e.prototype.drawGL=function(t){if(!this.visible)return!1;if(this.container)this.container.drawGL(t,this.runtime)},e.prototype.tick=function(){this.container.alpha=this.opacity,this.container.x=this.x,this.container.y=this.y,this.container.rotation=this.angle,this.container.scale.x=this.width/this.container.width,this.container.scale.y=this.height/this.container.height,this.inputProxy.resize(!1),this.runtime.redraw=!0},e.prototype.getDebuggerValues=function(t){t.push({title:"属性",properties:[{name:"内容",value:this.value,readonly:!0},{name:"焦点状态",value:["获取焦点","失去焦点"][this.state],readonly:!0}]})},e.prototype.onDebugValueEdited=function(t,e,i){console.log(t,e,i)},e.prototype.drawInit=function(){var t=xf.getAnimationByName(this.type,"bg").frames[0];if(this.container=new xf.xfContainer,this.container.alpha=this.opacity,this.container.x=this.x,this.container.y=Math.floor(this.y),this.container.width=this.width,this.container.height=this.height,(this.container.owner=this).prop.showBackground)this.bgImg=new xf.xfImage,this.container.addChild(this.bgImg),this.bgImg.width=this.width,this.bgImg.height=this.height,this.bgImg.x=0,this.bgImg.y=0,this.bgImg.alpha=this.opacity,this.bgImg.source=t.texture_img;if(this.text=new xf.xfText,this.container.addChild(this.text),this.text.defaultStyle=new xf.TextStyle,this.text.x=this.prop.marginLeft,this.text.y=this.prop.marginTop,this.text.width=this.width-(this.prop.marginLeft+this.prop.marginRight),this.text.height=this.height-(this.prop.marginTop+this.prop.marginBottom),this.text.defaultStyle.hAlign=this.prop.horizontalAlign,this.text.defaultStyle.line_vAlign=s.VerticalAlign.TOP,this.prop.inputType===s.InputType.TEXTAREA)this.text.multiline=!0,this.text.defaultStyle.vAlign=s.VerticalAlign.TOP,this.text.y=this.text.y+1,this.text.height=this.text.height-1;else if(this.text.multiline=!1,this.text.defaultStyle.vAlign=s.VerticalAlign.MIDDLE,this.prop.inputType===s.InputType.PASSWORD)this.text.width=this.text.width-1;else this.text.y=this.text.y+1;if(this.prop.showBorder){var e=2*this.prop.lineWidth,i=this.prop.border.width+e/2,n=this.prop.border.height+e/2;this.border=document.createElement("canvas"),this.border.width=i,this.border.height=n,this.borderContext=this.border.getContext("2d"),this.borderContext.strokeStyle=xf.hexaDecimal(this.prop.borderColor),this.borderContext.lineWidth=e,this.borderContext.globalAlpha=this.prop.borderColor[3],this.borderContext.strokeRect(0,0,i,n),this.borderImg=new xf.xfImage,this.container.addChild(this.borderImg),this.borderImg.width=i,this.borderImg.height=n,this.borderImg.x=Math.floor(this.prop.marginLeft-e/2),this.borderImg.y=Math.floor(this.prop.marginTop-e/2),this.borderImg.source=this.border}this.value=this.prop.defaultValue,this.setText()},e.prototype.setText=function(){if(this.setTextStyle(),this.value&&this.runtime.isMinigame||this.value&&!this.runtime.isMinigame&&this.state!==s.FocusState.FOCUS){if(this.prop.inputType===s.InputType.PASSWORD)this.text.text=new Array(this.value.length+1).join("●");else this.text.text=this.value;this.textHeight=this.text.textHeight}else if(!this.value&&this.state!==s.FocusState.FOCUS)this.text.text=this.prop.placeholder;else this.text.text="";this.runtime.redraw=!0},e.prototype.setTextStyle=function(){if(this.value)this.text.alpha=this.prop.contentColor[3]||1,this.text.defaultStyle.size=this.prop.contentFontSize,this.text.defaultStyle.fontFamily=this.prop.contentFontFamily.replace(/.ttf$/,""),this.text.defaultStyle.color=xf.hexaDecimal(this.prop.contentColor);else this.text.alpha=this.prop.placeholderColor[3]||1,this.text.defaultStyle.size=this.prop.placeholderFontSize,this.text.defaultStyle.fontFamily=this.prop.placeholderFontFamily.replace(/.ttf$/,""),this.text.defaultStyle.color=xf.hexaDecimal(this.prop.placeholderColor)},e.prototype.focus=function(){this.state=s.FocusState.FOCUS,this.setText(),this.inputProxy.focus(this),this.trigger(drama.plugins_.xfInput.prototype.cnds.compareFocus)},e}(e.Property=u);e.default=h},baf054261a26ef5d:function(t,e,i){Object.defineProperty(e,"__esModule",{value:!0});var h=i("5af91fa7fde766be"),n=function(){function t(){var r=this;this.softKeyboardHeight=0,this.unfocusFormControlFunc=function(t){if(drama.isCanvasInputEvent(t)&&document.activeElement&&document.activeElement!==document.getElementsByTagName("body")[0]&&document.activeElement.blur){var e=r.getPosition(t),i=r.lastFocusInst.layer.canvasToLayer(e.x,e.y,!0),n=r.lastFocusInst.layer.canvasToLayer(e.x,e.y,!1);if(!xf.Rect.create(r.lastFocusInst.x,r.lastFocusInst.y,r.lastFocusInst.width,r.lastFocusInst.height).contains(i,n))try{document.activeElement.blur()}catch(t){}}},this.onInput=function(t){if(r.focusInst)if(r.focusInst.prop.inputType===h.InputType.TEXTAREA)r.focusInst.onChange(r.textarea.value);else r.focusInst.onChange(r.text.value)},this.onBlur=function(t){if(r.hideDom(t.target),window.xfruntime.isiOS&&/MicroMessenger/i.test(navigator.userAgent))setTimeout(function(){if(!r.focusInst)if(window.xsSdk&&window.xsSdk.scrollToTop)window.xsSdk.scrollToTop();else window.scrollTo(0,0)},100);if(r.focusInst)r.focusInst.onBlur(),r.focusInst=null},this.onScroll=function(){if(0<(document.documentElement.scrollTop||window.pageYOffset||document.body.scrollTop)&&r.focusInst){var t=void 0;if(r.focusInst.prop.inputType===h.InputType.TEXTAREA)t=r.textarea;else t=r.text;t.scrollIntoViewIfNeeded(!0)}},this.onResize=function(){var t=document.documentElement.clientHeight||document.body.clientHeight,e=Math.abs(r.originHeight-t);if(r.originHeight=t,e==r.softKeyboardHeight)r.softKeyboardHeight=0,r.blur();else{if(r.softKeyboardHeight=e,!r.focusInst)return;var i=void 0;if(r.focusInst.prop.inputType===h.InputType.TEXTAREA)i=r.textarea;else i=r.text;i.scrollIntoViewIfNeeded(!0)}},this.onKeyDown=function(t){t.stopPropagation()},this.onMouseUp=function(t){t.stopPropagation()}}return t.prototype.init=function(){if(!this.text){this.textarea=document.createElement("textarea"),this.textarea.style.resize="none",this.textarea.style.overflowY="auto",this.textarea.classList.add("xfplugin"),this.textarea.style.position="absolute",this.textarea.style.backgroundColor="transparent",this.textarea.style.border="none",this.textarea.style.padding="0",this.textarea.style.borderRadius="0",this.hideDom(this.textarea),this.text=document.createElement("input"),this.text.classList.add("xfplugin"),this.text.style.position="absolute",this.text.style.backgroundColor="transparent",this.text.style.border="none",this.text.style.padding="0",this.text.style.borderRadius="0",this.hideDom(this.text);var t=document.getElementById("domContainer");if(t.appendChild(this.textarea),t.appendChild(this.text),this.text.addEventListener("input",this.onInput),this.text.addEventListener("blur",this.onBlur),this.textarea.addEventListener("input",this.onInput),this.textarea.addEventListener("blur",this.onBlur),!window.xfruntime.isMobile)this.text.addEventListener("keydown",this.onKeyDown),this.text.addEventListener("mouseup",this.onMouseUp),this.textarea.addEventListener("keydown",this.onKeyDown),this.textarea.addEventListener("mouseup",this.onMouseUp);else this.addFocusControl();if(window.xfruntime.isAndroid)this.originHeight=document.documentElement.clientHeight||document.body.clientHeight,window.addEventListener("resize",this.onResize,!1);if(window.xfruntime.isiOS)window.addEventListener("scroll",this.onScroll,!1)}},t.prototype.addFocusControl=function(){if("undefined"!=typeof PointerEvent)document.addEventListener("pointerdown",this.unfocusFormControlFunc);else if(window.navigator.msPointerEnabled)document.addEventListener("MSPointerDown",this.unfocusFormControlFunc);else if(window.xfruntime.isMobile){if(xf.getSupportsPassive())document.addEventListener("touchstart",this.unfocusFormControlFunc,{passive:!0});else document.addEventListener("touchstart",this.unfocusFormControlFunc)}},t.prototype.removeFocusControl=function(){if("undefined"!=typeof PointerEvent)document.removeEventListener("pointerdown",this.unfocusFormControlFunc);else if(window.navigator.msPointerEnabled)document.removeEventListener("MSPointerDown",this.unfocusFormControlFunc);else if(window.xfruntime.isMobile)document.removeEventListener("touchstart",this.unfocusFormControlFunc)},t.prototype.focus=function(t){if(this.focusInst!==t){if(this.focusInst)this.focusInst.onBlur();var e;if(this.focusInst=t,this.lastFocusInst=this.focusInst,this.focusInst.prop.inputType===h.InputType.TEXTAREA)e=this.textarea;else e=this.text;this.setStyle(e),this.resize(!0),e.value=t.value,e.focus(),e.setSelectionRange(this.focusInst.value.length,this.focusInst.value.length)}},t.prototype.blur=function(){if(this.focusInst)if(this.focusInst.prop.inputType===h.InputType.TEXTAREA)this.textarea.blur();else this.text.blur()},t.prototype.clean=function(){this.text.value="",this.textarea.value=""},t.prototype.setStyle=function(t){if(window.xfruntime.isAndroid)t.style.color=xf.hexaDecimal(this.focusInst.prop.contentColor);else t.style.color=xf.hexaDecimal(this.focusInst.prop.contentColor,!0);if(t.style.textAlign=this.focusInst.prop.horizontalAlign,t.setAttribute("autocomplete","off"),0<this.focusInst.prop.valueLimit)t.setAttribute("maxlength",String(this.focusInst.prop.valueLimit));if(this.focusInst.prop.inputType===h.InputType.PASSWORD)t.setAttribute("type","password");else if(this.focusInst.prop.inputType===h.InputType.TEXT)if(this.focusInst.prop.keyboardType===h.KeyboardType.NORMAL)t.setAttribute("type","text");else t.setAttribute("type","tel");t.style.fontFamily=this.focusInst.prop.contentFontFamily.replace(/.ttf$/,"")},t.prototype.resize=function(t){if(this.focusInst){var e;if(this.focusInst.prop.inputType===h.InputType.TEXTAREA)e=this.textarea;else e=this.text;var i=this.focusInst.layer.layerToCanvas(this.focusInst.x+this.focusInst.prop.marginLeft,this.focusInst.y,!0),n=this.focusInst.layer.layerToCanvas(this.focusInst.x,this.focusInst.y+this.focusInst.prop.marginTop,!1),r=this.focusInst.layer.layerToCanvas(this.focusInst.x+this.focusInst.width-this.focusInst.prop.marginRight,this.focusInst.y+this.focusInst.height,!0),o=this.focusInst.layer.layerToCanvas(this.focusInst.x+this.focusInst.width,this.focusInst.y+this.focusInst.height-this.focusInst.prop.marginBottom,!1);if(!(isNaN(i)||isNaN(n)||isNaN(r)||isNaN(o)))if(this.focusInst.visible&&this.focusInst.layer.visible){var s=window.innerWidth,a=window.innerHeight;if(t||this.lastLeft!==i||this.lastTop!==n||this.lastRight!==r||this.lastBottom!==o||this.lastWinWidth!==s||this.lastWinHeight!==a){e.style.display="",this.lastLeft=i,this.lastTop=n,this.lastRight=r,this.lastBottom=o,this.lastWinWidth=s,this.lastWinHeight=a;var l=i,c=n;e.style.left=l+"px",e.style.top=c+"px",e.style.width=r-i+"px",e.style.height=o-n+"px";var u=this.focusInst.layer.getScale(!0)/this.focusInst.runtime.devicePixelRatio;if("password"==e.type&&!this.focusInst.runtime.isMobile&&!this.focusInst.runtime.isSafari)u*=1.73;e.style.fontSize=this.focusInst.prop.contentFontSize*u+"px",e.style.lineHeight="1"}}else this.hideDom(e);else this.hideDom(e)}},t.prototype.hideDom=function(t){t.style.display="none"},t.prototype.getPosition=function(t){var e=xf.Point.create();if(t.changedTouches){var i=drama.convertPageXY(t.changedTouches[0].pageX,t.changedTouches[0].pageY);e.x=i.pageX-window.xfruntime.canvas.offsetLeft,e.y=i.pageY-window.xfruntime.canvas.offsetTop}else e.x=t.clientX-window.xfruntime.canvas.offsetLeft,e.y=t.clientY-window.xfruntime.canvas.offsetTop;return e},t}();e.default=new n},d27c30dad6345543:function(t,e,i){Object.defineProperty(e,"__esModule",{value:!0});var n=function(){};e.DefendedBase=n},e14b41e30cdc6afd:function(t,e,i){var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.onCreate=function(){if(!this.is_family)this.all_frames=[],xf.formatAnimation(this)},e}(i("0330f9384c2c8825").SDKTypeBase);e.default=o},e681aed280414b09:function(t,e,i){var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=function(i){function t(t){var e=i.call(this)||this;return e.type=t,e.runtime=t.runtime,e}return r(t,i),t.prototype.onCreate=function(){},t.prototype.draw=function(t,e){},t.prototype.drawGL=function(t){},t.prototype.onDestroy=function(){},t.prototype.trigger=function(t){return this.runtime.trigger(t,this)},t.prototype.tick=function(){},t.prototype.GetDebuggerProperties=function(){return[]},t.prototype.SaveToJson=function(){return null},t.prototype.LoadFromJson=function(){},t.prototype.LoadTilemapData=function(){},t.prototype.TestPointOverlapTile=function(){},t.prototype.GetPropertyValueByIndex=function(){},t.prototype.SetPropertyValueByIndex=function(){},t.prototype.SetPropertyOffsetValueByIndex=function(){},t.prototype.SetPropertyColorOffsetValueByIndex=function(){},t.prototype.CallAction=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];t.call.apply(t,[this].concat(e))},t.prototype.CallExpression=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];return t.call.apply(t,[this].concat(e))},t.formatProp=function(t,e,i){var n=e,r=Object.keys(n);return t.properties.forEach(function(t,e){if(e<r.length)if(!i(t,e,r[e]))n[r[e]]=t}),n},t.compareText=function(t,e,i){if("string"!=typeof t||"string"!=typeof i)return!1;switch(e){case 0:return t==i;case 1:return t!=i;case 2:return-1<t.indexOf(i);case 3:return-1==t.indexOf(i);default:return window.assert2(!1,"Invalid comparison value: "+e),!1}},t.prototype.listenMessage=function(t,e,i,n){if(void 0===i)i=null;if(void 0===n)n=0;xf.EventCenter.instance.addEventListener(t,e,i||this,n),this.listenBins=this.listenBins?this.listenBins:[],this.listenBins.push({messageID:t,method:e})},t.prototype.removeAllListen=function(){if(this.listenBins&&this.listenBins.length){for(var t=0,e=this.listenBins;t<e.length;t++){var i=e[t];xf.EventCenter.instance.removeEventListener(i.messageID,i.method,this)}this.listenBins.length=0}},t}(i("d27c30dad6345543").DefendedBase);e.SDKInstanceBase=o},e7b602c229ac5b71:function(t,e,i){var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=function(i){function t(t){var e=i.call(this)||this;return e.runtime=t,e._isSingleGlobal=!!t.isSingleGlobal,e._isWorldType=!!t.isWorld,e._isRotatable=!!t.isRotatable,e._mustPredraw=!!t.mustPredraw,e._hasEffects=!!t.hasEffects,e._singleGlobalObjectClass=null,e}return r(t,i),t.prototype.onCreate=function(){},t.prototype.IsSingleGlobal=function(){return this._isSingleGlobal},t.prototype.IsWorldType=function(){return this._isWorldType},t.prototype.IsRotatable=function(){return this._isRotatable},t.prototype.MustPreDraw=function(){return this._mustPredraw},t.prototype.HasEffects=function(){return this._hasEffects},t.prototype._SetSingleGlobalObjectClass=function(t){if(!this.IsSingleGlobal())throw new Error("must be single-global plugin");this._singleGlobalObjectClass=t},t.prototype.GetSingleGlobalObjectClass=function(){if(!this.IsSingleGlobal())throw new Error("must be single-global plugin");return this._singleGlobalObjectClass},t.prototype.GetSingleGlobalInstance=function(){if(!this.IsSingleGlobal())throw new Error("must be single-global plugin");return this._singleGlobalObjectClass.GetSingleGlobalInstance()},t}(i("d27c30dad6345543").DefendedBase);e.SDKPluginBase=o},fa8217e587b89620:function(t,e,i){var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i("9e7dde3aad14dec6"),s=i("e681aed280414b09"),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.compareFocus=function(t){return this.state===t},e.prototype.compareText=function(t,e){return s.SDKInstanceBase.compareText(this.value,t,String(e))},e}(o.Property);e.default=a},fb24c564ca0a59f6:function(t,e,i){var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.getText=function(t){if(this.checkForbiddon(this.value))this.changeText("");t.set_string(this.value)},e.prototype.getPlaceholder=function(t){t.set_string(this.prop.placeholder)},e.prototype.getState=function(t){t.set_int(Number(!this.state))},e}(i("9e7dde3aad14dec6").default);e.default=o}}),drama.plugins_.xfinternal=function(t){this.runtime=t},function(){var t=drama.plugins_.xfinternal.prototype;t.Type=function(t){this.plugin=t,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t){this.type=t,this.runtime=t.runtime};var e=t.Instance.prototype;function i(){}e.onCreate=function(){},e.stopRunning=function(){this.runtime.running_layout.stopRunning()},t.cnds=new function(){},i.prototype.openHykb=function(){console.log("openHykb"),window.hykb&&window.hykb.startApp()},t.acts=new i,t.exps=new function(){}}(),assert2(drama,"drama namespace not created"),assert2(drama.plugins_,"drama.plugins_ not created"),drama.plugins_.xfjoystick=function(t){this.runtime=t},function(){var c=xf.GameConst.DirectionEnum,u={FOUR:0,EIGHT:1,ROUND:2},h={NO:0,FOUR:1,EIGHT:2,SMOOTH:3},t={};t[c.UP]=1,t[c.DOWN]=2,t[c.LEFT]=3,t[c.RIGHT]=4,t[c.RIGHTUP]=5,t[c.LEFTUP]=6,t[c.RIGHTDOWN]=7,t[c.LEFTDOWN]=8;var e=drama.plugins_.xfjoystick.prototype;e.Type=function(t){this.plugin=t,this.runtime=t.runtime},e.Type.prototype.onCreate=function(){if(!this.is_family)this.all_frames=[],this.has_loaded_textures=!1,this.animationsByName={},xf.formatAnimation(this)},e.Instance=function(t){this.type=t,this.runtime=t.runtime,this.dx=0,this.dy=0,this.xacc=0,this.yacc=0,this.radian=null,this.types=[],this.touchEventId=null,this.moving=!1};var i=e.Instance.prototype;function n(){}function r(){}function o(){}i.onCreate=function(){if(xf.testTypeImage(this.type),this.isVisible=!0,this.isEnabled=this.properties[0],this.controlMode=this.properties[1],this.maxSpeed=this.properties[2],this.acceleration=this.properties[3],this.deceleration=this.properties[4],this.rotateMode=this.properties[5],this.mode=this.properties[6]||0,this.selectArea=this.properties[7],this.onDragStartEvent=this.onDragStart.bind(this),this.onDragMoveEvent=this.onDragMove.bind(this),this.onDragEndEvent=this.onDragEnd.bind(this),this.onDragCancelEvent=this.onDragCancel.bind(this),this.elem=this.runtime.canvas,this.runtime.isMobile){if(xf.getSupportsPassive())this.elem.addEventListener("touchstart",this.onDragStartEvent,{passive:!0}),this.elem.addEventListener("touchmove",this.onDragMoveEvent,{passive:!0});else this.elem.addEventListener("touchstart",this.onDragStartEvent),this.elem.addEventListener("touchmove",this.onDragMoveEvent);this.elem.addEventListener("touchend",this.onDragEndEvent),this.elem.addEventListener("touchcancel",this.onDragCancelEvent)}else this.elem.addEventListener("mousedown",this.onDragStartEvent,!1),this.elem.addEventListener("mousemove",this.onDragMoveEvent,!1),this.elem.addEventListener("mouseup",this.onDragEndEvent,!1),this.elem.addEventListener("mouseleave",this.onDragCancelEvent,!1);this.event=xf.XfEvent.create(this.runtime),this.container=null,this.bgImg=null,this.stickImg=null,this.direction=c.NONE,this.lastDirection=c.NONE,this.runtime.tickMe(this),xf.loadTextures(this.type),this.drawInit(),this.initX=this.x,this.initY=this.y},i.drawInit=function(){var t=xf.getAnimationByName(this.type,"backGround").frames[0],e=xf.getAnimationByName(this.type,"center").frames[0];this.container=new xf.xfContainer,this.bgImg=new xf.xfImage,this.stickImg=new xf.xfImage,this.container.addChild(this.bgImg),this.container.addChild(this.stickImg),this.bgImg.width=this.width,this.bgImg.height=this.height,this.bgImg.alpha=this.opacity,this.bgImg.source=t.texture_img,this.bgImg.x=0,this.bgImg.y=0,this.stickScale=1/3,this.stickImg.x=this.width*this.stickScale,this.stickImg.y=this.height*this.stickScale,this.stickImg.width=this.width*this.stickScale,this.stickImg.height=this.height*this.stickScale,this.stickImg.alpha=this.opacity,this.stickImg.source=e.texture_img,this.container.x=this.x,this.container.y=this.y,this.container.owner=this},i.onDestroy=function(){if(this.runtime.isMobile)this.elem.removeEventListener("touchstart",this.onDragStartEvent),this.elem.removeEventListener("touchmove",this.onDragMoveEvent),this.elem.removeEventListener("touchend",this.onDragEndEvent),this.elem.removeEventListener("touchcancel",this.onDragCancelEvent);else this.elem.removeEventListener("mousedown",this.onDragStartEvent,!1),this.elem.removeEventListener("mousemove",this.onDragMoveEvent,!1),this.elem.removeEventListener("mouseup",this.onDragEndEvent,!1),this.elem.removeEventListener("mouseleave",this.onDragCancelEvent,!1);this.container.destory(),this.container=null,this.bgImg=null,this.stickImg=null},i.tick=function(){var e=this;if(this.visible){if(this.container.x=this.x,this.container.y=this.y,this.container.width=this.width,this.container.height=this.height,this.bgImg.width=this.width,this.bgImg.height=this.height,this.stickScale=1/3,this.stickImg.width=this.width*this.stickScale,this.stickImg.height=this.height*this.stickScale,this.stickImg.alpha=this.opacity,this.container.rotation=this.angle,this.container.alpha=this.opacity,this.container.anchorOffsetX=this.container.width*this.hotspotX,this.container.anchorOffsetY=this.container.height*this.hotspotY,this.isEnabled){this.calcMotionVector();for(var t=[],i=0,n=this.types.length;i<n;i++){var r=this.types[i];if(r){for(var o=!1,s=r.behaviors,a=0,l=s.length;a<l;a++){var c=s[a].behavior;if(drama.behaviors.Platform&&c instanceof drama.behaviors.Platform||drama.behaviors.EightDir&&c instanceof drama.behaviors.EightDir)if(t.indexOf(r.sid)<0)t.push(r.sid),o=!0}if(!o&&this.moving){r.instances.map(function(t){e.moveInst(t)})}}}if(this.lastDirection!==this.direction)xf.EventCenter.instance.sendEvent(new xf.EventData(xf.EventType.JOYSTICK_MOVE,{name:this.type.name,direction:this.direction,types:t})),this.lastDirection=this.direction}}else if(this.draging)this.resetStick(),this.calcMotionVector()},i.draw=function(t){if(!this.isVisible)return!1;this.container.draw(t,this.runtime)},i.drawGL=function(t){if(!this.isVisible)return!1;this.container.drawGL(t,this.runtime)},i.onWindowBlur=function(){this.resetStick()},i.onDragStart=function(t){if(this.visible)if(this.isEnabled){if(t.targetTouches){this.touchEventId=null;for(var e=0;e<t.targetTouches.length;e++){var i=drama.convertPageXY(t.targetTouches[e].pageX,t.targetTouches[e].pageY),n=i.pageX-this.runtime.canvas.offsetLeft,r=i.pageY-this.runtime.canvas.offsetTop;if(this.isInContents(n,r))this.touchEventId=t.targetTouches[e].identifier}if(null===this.touchEventId)return}var o=this.getPosition(t);if(this.isInContents(o.x,o.y))this.draging=!0,this.x=this.layer.canvasToLayer(o.x,o.y,!0),this.y=this.layer.canvasToLayer(o.x,o.y,!1),this.set_bbox_changed()}},i.onDragMove=function(t){if(this.visible)if(this.isEnabled){if(t.changedTouches){for(var e=!1,i=0;i<t.changedTouches.length;i++)if(this.touchEventId==t.changedTouches[i].identifier)e=!0;if(!e)return!1}if(this.draging){var n=this.getPosition(t),r={x:this.layer.canvasToLayer(n.x,n.y,!0)-this.x-this.width/2+this.container.anchorOffsetX,y:this.layer.canvasToLayer(n.x,n.y,!1)-this.y-this.height/2+this.container.anchorOffsetY};this.direction=this.getDirection(r.x,r.y),this.radian=Math.atan2(r.y,r.x);var o=this.bgImg.width/2*Math.cos(this.radian),s=this.bgImg.height/2*Math.sin(this.radian);if(Math.abs(r.x)>Math.abs(o))this.x=this.x+r.x-o,this.set_bbox_changed();if(Math.abs(r.y)>Math.abs(s))this.y=this.y+r.y-s,this.set_bbox_changed();var a=this.limitJoystickPosition(r.x,r.y,this.radian);this.stickImg.x=a.x+this.container.anchorOffsetX-this.stickImg.width/2,this.stickImg.y=a.y+this.container.anchorOffsetY-this.stickImg.height/2,this.runtime.redraw=!0}}},i.onDragEnd=function(t){if(this.visible)if(0!=this.draging){if(t.changedTouches){for(var e=0;e<t.changedTouches.length;e++)if(this.touchEventId==t.changedTouches[e].identifier)this.resetStick()}else this.resetStick();this.runtime.redraw=!0}},i.onDragCancel=function(t){if(this.visible)if(0!=this.draging)this.resetStick()},i.limitJoystickPosition=function(t,e,i){var n=this.bgImg.width/2*Math.sign(t);t=Math.abs(t)>Math.abs(n)?n:t,n=this.bgImg.width/2*Math.sign(e),e=Math.abs(e)>Math.abs(n)?n:e;var r=Math.PI/8;if(this.controlMode==u.FOUR){if(-2*r<=i&&i<2*r)e=0;else if(-6*r<=i&&i<-2*r)t=0;else if(6*r<=i||i<-6*r)e=0;else if(2*r<=i&&i<6*r)t=0}else if(this.controlMode==u.EIGHT){var o=this.bgImg.width/2*Math.cos(Math.PI/4);if(-1*r<=i&&i<1*r)e=0;else if(-3*r<=i&&i<-1*r)e=-(t=o<t?o:t);else if(-5*r<=i&&i<-3*r)t=0;else if(-7*r<=i&&i<-5*r)e=t=Math.abs(t)>o?-o:t;else if(7*r<=i||i<-7*r)e=0;else if(5*r<=i&&i<7*r)e=-(t=Math.abs(t)>o?-o:t);else if(3*r<=i&&i<5*r)t=0;else if(1*r<=i&&i<3*r)e=t=o<t?o:t}else if(this.controlMode==u.ROUND){var s=this.bgImg.width/2*Math.cos(this.radian),a=this.bgImg.height/2*Math.sin(this.radian);t=Math.abs(t)>Math.abs(s)?s:t,e=Math.abs(e)>Math.abs(a)?a:e}return{x:t+this.width/2-this.container.anchorOffsetX,y:e+this.height/2-this.container.anchorOffsetY}},i.resetStick=function(){this.direction=c.NONE,this.draging=!1,this.radian=null,this.stickImg.x=this.bgImg.width*this.stickScale,this.stickImg.y=this.bgImg.height*this.stickScale,this.x=this.initX,this.y=this.initY,this.set_bbox_changed(),xf.EventCenter.instance.sendEvent(new xf.EventData(xf.EventType.JOYSTICK_RESET,{name:this.type.name}))},i.getPosition=function(t){var e={};if(t.changedTouches){for(var i=0;i<t.changedTouches.length;i++)if(this.touchEventId==t.changedTouches[i].identifier){var n=drama.convertPageXY(t.changedTouches[i].pageX,t.changedTouches[i].pageY);e.x=n.pageX-this.runtime.canvas.offsetLeft,e.y=n.pageY-this.runtime.canvas.offsetTop}}else e.x=t.clientX-this.runtime.canvas.offsetLeft,e.y=t.clientY-this.runtime.canvas.offsetTop;return e},i.calcMotionVector=function(){var t=this.runtime.getDt(this),e=this.direction;if(e===c.NONE){var i=Math.atan2(this.dy,this.dx),n=this.deceleration*t*Math.abs(Math.cos(i)),r=this.deceleration*t*Math.abs(Math.sin(i));if(this.dx<0){if(this.dx+=n,0<this.dx)this.dx=0}else if(0<this.dx)if(this.dx-=n,this.dx<0)this.dx=0;if(this.dy<0){if(this.dy+=r,0<this.dy)this.dy=0}else if(0<this.dy)if(this.dy-=r,this.dy<0)this.dy=0}if(this.xacc=0,this.yacc=0,this.controlMode==u.ROUND&&this.radian)this.xacc=this.acceleration*Math.cos(this.radian),this.yacc=this.acceleration*Math.sin(this.radian);else{if(e==c.LEFT||e==c.LEFTUP||e==c.LEFTDOWN)this.xacc=-(0<this.dx?this.acceleration+this.deceleration:this.acceleration);else if(e==c.RIGHT||e==c.RIGHTUP||e==c.RIGHTDOWN)this.xacc=this.dx<0?this.acceleration+this.deceleration:this.acceleration;if(e==c.UP||e==c.LEFTUP||e==c.RIGHTUP)this.yacc=-(0<this.dy?this.acceleration+this.deceleration:this.acceleration);else if(e==c.DOWN||e==c.LEFTDOWN||e==c.RIGHTDOWN)this.yacc=this.dy<0?this.acceleration+this.deceleration:this.acceleration}if(this.dx+=this.xacc*t,this.dy+=this.yacc*t,0==this.dx&&0==this.dy)this.moving=!1;else this.moving=!0;var o=Math.sqrt(this.dx*this.dx+this.dy*this.dy),s=Math.atan2(this.dy,this.dx),a=this.maxSpeed*Math.cos(s),l=this.maxSpeed*Math.sin(s);if(o>this.maxSpeed)this.dx=a,this.dy=l},i.moveInst=function(t){var e=this.runtime.getDt(this),i=Math.abs(this.dx),n=Math.abs(this.dy),r=t.x,o=t.y;t.x+=this.runtime.accelerate(this.dx,-i,i,this.xacc,e),t.set_bbox_changed();var s=this.runtime.testOverlapSolid(t);if(s){if(!this.runtime.pushOutSolid(t,this.dx<0?1:-1,0,Math.abs(Math.floor(this.dx*e))))t.x=r,t.set_bbox_changed();this.dx=0,this.runtime.registerCollision(t,s)}if(t.y+=this.runtime.accelerate(this.dy,-n,n,this.yacc,e),t.set_bbox_changed(),s=this.runtime.testOverlapSolid(t)){if(!this.runtime.pushOutSolid(t,0,this.dy<0?1:-1,Math.abs(Math.floor(this.dy*e))))t.y=o,t.set_bbox_changed();this.dy=0,this.runtime.registerCollision(t,s)}var a=t.angle,l=drama.round6dp(this.dx),c=drama.round6dp(this.dy);if((0!==l||0!==c)&&t.type.plugin.is_rotatable)if(this.rotateMode===h.FOUR)t.angle=drama.to_clamped_radians(90*Math.round(drama.to_degrees(Math.atan2(c,l))/90));else if(this.rotateMode===h.EIGHT)t.angle=drama.to_clamped_radians(45*Math.round(drama.to_degrees(Math.atan2(c,l))/45));else if(this.rotateMode===h.SMOOTH)t.angle=Math.atan2(c,l);if(t.set_bbox_changed(),t.angle!=a)if((s=this.runtime.testOverlapSolid(t))&&0!=t.angle)t.angle=a,t.set_bbox_changed(),this.runtime.registerCollision(t,s)},i.isInContents=function(t,e){this.update_bbox();var i=this.layer.canvasToLayer(t,e,!0),n=this.layer.canvasToLayer(t,e,!1);if(0===this.mode)return this.contains_pt(i,n);else{var r=this.bbox,o=xf.Rect.create(r.left,r.top,r.right-r.left,r.bottom-r.top);o.inflate(this.selectArea,this.selectArea);var s=o.contains(i,n);return o.destory(),s}},i.getFormatDirection=function(){return t[this.direction]},i.getDirection=function(t,e){if(this.controlMode==u.FOUR){var i=Math.atan2(e,t)*xf.RAD_TO_DEG;if(-45<i&&i<45)return c.RIGHT;else if(45<i&&i<135)return c.DOWN;else if(135<i||i<-135)return c.LEFT;else if(-135<i&&i<-45)return c.UP}else if(this.controlMode==u.EIGHT||this.controlMode==u.ROUND){var n=Math.atan2(e,t),r=Math.PI/8;if(-1*r<=n&&n<1*r)return c.RIGHT;else if(-3*r<=n&&n<-1*r)return c.RIGHTUP;else if(-5*r<=n&&n<-3*r)return c.UP;else if(-7*r<=n&&n<-5*r)return c.LEFTUP;else if(7*r<=n||n<-7*r)return c.LEFT;else if(5*r<=n&&n<7*r)return c.LEFTDOWN;else if(3*r<=n&&n<5*r)return c.DOWN;else if(1*r<=n&&n<3*r)return c.RIGHTDOWN}return c.NONE},i.getDebuggerValues=function(t){t.push({title:"属性",properties:[{name:"X轴速度",value:this.dx},{name:"Y轴速度",value:this.dy},{name:"速度",value:Math.sqrt(this.dx*this.dx+this.dy*this.dy)},{name:"运动角度",value:drama.to_degrees(Math.atan2(this.dy,this.dx)),readonly:!0},{name:"最大速度",value:this.maxSpeed},{name:"加速度",value:this.acceleration},{name:"减速度",value:this.deceleration},{name:"摇杆弧度",value:this.radian,readonly:!0},{name:"控制模式",value:this.controlMode},{name:"是否启用",value:this.isEnabled}]})},i.onDebugValueEdited=function(t,e,i){switch(e){case"X轴速度":this.dx=i;break;case"Y轴速度":this.dy=i;break;case"速度":if(i<0)i=0;if(i>this.maxSpeed)i=this.maxSpeed;var n=Math.atan2(this.dy,this.dx);this.dx=i*Math.cos(n),this.dy=i*Math.sin(n);break;case"最大速度":this.maxSpeed=i;break;case"加速度":this.acceleration=i;break;case"减速度":this.deceleration=i;break;case"摇杆弧度":this.radian=i;break;case"控制模式":this.controlMode=i;break;case"是否启用":this.isEnabled=i}},n.prototype.compareDirection=function(t){return this.getFormatDirection()==t+1},n.prototype.compareStatus=function(t){if(this.draging&&0==t)return!0;else if(!this.draging&&1==t)return!0;return!1},n.prototype.compareEnable=function(t){if(this.isEnabled&&0==t)return!0;else if(!this.isEnabled&&1==t)return!0;return!1},n.prototype.compareAngle=function(t,e){return drama.do_cmp(this.radian*(180/Math.PI),t,e)},e.cnds=new n,r.prototype.setVisible=function(t){this.isVisible=0===t},r.prototype.setEnabled=function(t){this.isEnabled=1===t},r.prototype.toggleMode=function(t){for(var e in u)if(u[e]==t)this.controlMode=t},r.prototype.bindObj=function(t){for(var e=this.types,i=0,n=e.length;i<n;i++)if(e[i].sid===t.sid)return;e.push(t)},r.prototype.unBindObj=function(e){this.types=this.types.filter(function(t){if(t.sid==e.sid)return!1;else return!0})},e.acts=new r,o.prototype.isEnabled=function(t){t.set_int(this.isEnabled?1:0)},o.prototype.mode=function(t){t.set_int(this.controlMode)},o.prototype.direction=function(t){t.set_int(this.getFormatDirection())},o.prototype.radian=function(t){if(this.radian)t.set_float(this.radian);else t.set_float(999)},o.prototype.angle=function(t){if(this.radian)t.set_float(this.radian*(180/Math.PI));else t.set_float(999)},e.exps=new o}(),assert2(drama,"drama namespace not created"),assert2(drama.plugins_,"drama.plugins_ not created"),drama.plugins_.xfNES=function(t){this.runtime=t},function(){var t=drama.plugins_.xfNES.prototype;t.Type=function(t){this.plugin=t,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t){this.type=t,this.runtime=t.runtime};var e=t.Instance.prototype,l=new Float32Array(4096),c=new Float32Array(4096),u=0,h=0,o=!1;function i(){}function n(){}e.onCreate=function(){var a=this,t=new xf.xfImage;t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t.alpha=this.opacity,this.image=t;var e=new ImageData(256,240);this.imageData=e;var i=new ArrayBuffer(e.data.length);this.framebuffer_u8=new Uint8ClampedArray(i),this.framebuffer_u32=new Uint32Array(i);var n=new(window.AudioContext||window.webkitAudioContext),r=n.createScriptProcessor(512,0,2);r.onaudioprocess=function(t){var e=t.outputBuffer,i=e.length;if((u-h&4095)<512)a.nes.frame();for(var n=e.getChannelData(0),r=e.getChannelData(1),o=0;o<i;o++){var s=h+o&4095;n[o]=l[s],r[o]=c[s]}h=h+i&4095},r.connect(n.destination);document.addEventListener("touchstart",function t(){if(document.removeEventListener("touchstart",t),"suspended"===n.state)n.resume()}),this.nes=new window.jsnes.NES({onFrame:function(t){for(var e=0;e<61440;e++)a.framebuffer_u32[e]=4278190080|t[e];a.runtime.redraw=!0},onAudioSample:function(t,e){l[u]=t,c[u]=e,u=u+1&4095}}),this.runtime.redraw=!1,o=!1,setInterval(function(){a.tick()},16)},e.saveToJSON=function(){return{}},e.loadFromJSON=function(t){},e.tick=function(){this.imageData.data.set(this.framebuffer_u8);var t=xf.createCanvas(256,240);t.getContext("2d").putImageData(this.imageData,0,0),this.image.updateSource(t),xf.recoverCanvas(t),this.nes.frame()},e.draw=function(t){if(!this.visible)return!1;if(o)this.image.draw(t,this.runtime)},e.drawGL=function(t){if(!this.visible)return!1;if(o)this.image.drawGL(t,this.runtime)},e.getDebuggerValues=function(t){},i.prototype.OnComplete=function(t){return!0},i.prototype.OnError=function(t){return!0},t.cnds=new i,n.prototype.Load=function(t){var e=this;t=this.runtime.manifest[t]?this.runtime.manifest[t]:t;var i=new XMLHttpRequest;i.open("GET",t),i.overrideMimeType("text/plain; charset=x-user-defined"),i.onerror=function(){console.log("Error loading ".concat(t,": ").concat(i.statusText)),e.runtime.trigger(drama.plugins_.xfNES.prototype.cnds.OnError,e)},i.onload=function(){if(200===i.status)e.nes.loadROM(i.responseText),e.runtime.trigger(drama.plugins_.xfNES.prototype.cnds.OnComplete,e),e.runtime.redraw=!0,o=!0;else if(0===i.status);else i.onerror()},i.send()},n.prototype.setControllerState=function(t,e,i){if(0===t)this.nes.buttonUp(e+1,i);else this.nes.buttonDown(e+1,i)},t.acts=new n,t.exps=new function(){}}(),assert2(drama,"drama namespace not created"),assert2(drama.plugins_,"drama.plugins_ not created"),drama.plugins_.xfProgress=function(t){this.runtime=t},function(){var t=drama.plugins_.xfProgress.prototype;t.Type=function(t){this.plugin=t,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){if(!this.is_family)this.all_frames=[],this.has_loaded_textures=!1,this.animationsByName={},xf.formatAnimation(this)},t.Instance=function(t){this.type=t,this.runtime=t.runtime};var e=t.Instance.prototype;function i(){}function n(){}function r(){}e.onCreate=function(){var i=this;xf.testTypeImage(this.type),this.visible=this.properties[0],this.value=this.properties[1],this.min=this.properties[2],this.max=this.properties[3],this.hide_bg=this.properties[4],this.hide_circle=this.properties[5],this.mode=this.properties[6],this.progressBeforeHeight=!isNaN(this.properties[7])?this.properties[7]:1,this.oldOpacity=this.opacity,this.value=this.value<this.min?this.min:this.value,this.oldValue=this.value,this.old_width=this.width,this.old_height=this.height,this.runtime.tickMe(this),xf.loadTextures(this.type),this.progressMap={};["background","progress","circle"].map(function(t){var e=xf.getAnimationByName(i.type,t).frames[0];i.progressMap[t]=e}),this.m_width_offset=0,this.drawInit()},e.drawInit=function(){var t=new xf.xfContainer;this.container=t,(this.container.owner=this).container.alpha=this.opacity,this.container.x=this.x,this.container.y=this.y;var e=new xf.xfImage;(this.backgroundImage=e).fillMode=xf.FillMode.SCALE,this.backgroundFrame=this.progressMap.background,e.height=this.height,e.width=this.hide_bg?0:this.width,e.source=this.backgroundFrame.texture_img;var i=new xf.xfImage;(this.progressImage=i).fillMode=this.mode?xf.FillMode.SCALE:xf.FillMode.CLIP,this.progressFrame=this.progressMap.progress,i.anchorOffsetY=this.height/2,i.y=this.height/2,i.height=this.height,i.width=this.width,i.scaleY=this.progressBeforeHeight,this.progressWidth=this.width,i.source=this.progressFrame.texture_img;var n=new xf.xfImage;this.circleImage=n,this.circleImage.fillMode=xf.FillMode.SCALE,this.circleFrame=this.progressMap.circle,this.circleWidth=this.circleFrame.width,this.circleImage.source=this.circleFrame.texture_img,this.widthScaleRatio=this.width/this.backgroundFrame.width,this.heightScaleRatio=this.height/this.backgroundFrame.height,this.progressScaleRatio=this.progressFrame.width>this.width?this.width/this.progressFrame.width:1;var r=(this.circleFrame.height-this.backgroundFrame.height+this.height)/this.circleFrame.height,o=this.circleFrame.width*r;this.circleWidth=o;var s=this.circleFrame.height*r;this.circleImage.width=this.circleWidth,this.circleImage.height=s,this.circleImage.y=.5*(this.backgroundImage.height-this.circleImage.height),t.addChild(e),t.addChild(i),t.addChild(n),this.changeProgress()},e.saveToJSON=function(){return{value:this.value,max:this.max,min:this.min}},e.loadFromJSON=function(t){this.value=t.value,this.max=t.max,this.min=t.min},e.onDestroy=function(){if(this.container)this.container.destory(),this.container=null;this.backgroundImage=null,this.progressImage=null,this.circleImage=null},e.changeSizeOrPos=function(){var t=this.width/this.old_width,e=this.height/this.old_height;this.container.x=this.x,this.container.y=this.y,this.container.width=this.width,this.container.height=this.height,this.container.anchorOffsetX=this.container.width*this.hotspotX,this.container.anchorOffsetY=this.container.height*this.hotspotY,this.container.scale.x=t,this.container.scale.y=e,this.container.alpha=this.opacity,this.container.rotation=this.angle},e.tick=function(){this.changeSizeOrPos(),this.runtime.redraw=!0},e.getCurrentValue=function(){var t=this.value>this.min?this.value:this.min;return t=t>this.max?this.max:t},e.changeProgress=function(){var t=this.getCurrentValue()/this.max;if(this.progressFrame)if(this.progressImage.width=this.progressWidth*t,0==this.mode){var e=t*this.progressFrame.width;this.progressImage.setClip(this.progressFrame.offx,this.progressFrame.offy,e,this.progressFrame.height,this.progressFrame.pixelformat)}if(this.circleFrame)if(this.circleImage.x=this.progressWidth*t-this.circleWidth/2+this.progressImage.x,this.hide_circle)this.circleImage.width=0},e.draw=function(t){if(!this.visible)return!1;this.container.draw(t,this.runtime)},e.drawGL=function(t){if(!this.visible)return!1;this.container.drawGL(t,this.runtime)},i.prototype.CompareProgress=function(t,e){return drama.do_cmp(this.value,t,e)},i.prototype.OnChange=function(){return!0},t.cnds=new i,n.prototype.SetVisible=function(t){this.visible=0!==t},n.prototype.SetProgress=function(t){t=(t=t<this.min?this.min:t)>this.max?this.max:t,this.value=t,this.runtime.trigger(drama.plugins_.xfProgress.prototype.cnds.OnChange,this),this.changeProgress()},n.prototype.SetMaximum=function(t){this.max=t,this.value=t>this.value?this.value:t,this.changeProgress()},n.prototype.SetMinimal=function(t){this.min=t,this.value=t<this.value?this.value:t,this.changeProgress()},n.prototype.SetParam=function(t,e,i,n){if(1===t)this.max=e;if(1===i)this.min=n;this.changeProgress()},t.acts=new n,r.prototype.Progress=function(t){t.set_float(this.value)},r.prototype.Maximum=function(t){t.set_float(this.max)},r.prototype.Minimal=function(t){t.set_float(this.min)},t.exps=new r}(),assert2(drama,"drama namespace not created"),assert2(drama.plugins_,"drama.plugins_ not created"),drama.plugins_.xfrank=function(t){this.runtime=t},function(){var s={HALIGN:{left:"left",center:"center",right:"right"},VALIGN:{top:"top",center:"middle",bottom:"bottom"}};function w(t,e){var i=t.world,n=t.info,r=new xf.TextStyle;r.size=n.fontSize||0,r.fontFamily=n.font.replace(/.ttf$/,""),r.isBold=n.bold,r.isItalic=n.italic,r.hAlign=s.HALIGN[n.halign],r.vAlign=s.VALIGN[n.valign],r.color=xf.hexaDecimal(n.fontColor);var o=new xf.xfText(r);return o.text=n.text,o.alpha=n.fontColor[3]||0,o.x=i.x-e.x||0,o.y=i.y-e.y||0,o.width=i.width||0,o.height=i.height||0,o}var t=drama.plugins_.xfrank.prototype;t.Type=function(t){this.plugin=t,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){xf.formatAnimation(this)},t.Instance=function(t){this.type=t,this.runtime=t.runtime};var e=t.Instance.prototype;function i(){}function n(){}e.onCreate=function(){xf.testTypeImage(this.type),this.columns=this.properties[0],this.sortField=this.properties[1],this.orderby=this.properties[2],this.offset=this.properties[3][0],this.limit=this.properties[3][1]-this.properties[3][0]+1,this.range=this.properties[4],this.visible=this.properties[5],this.rankType=this.properties[7],this.ninePathFill={tile:0,stretch:1,transparent:2},this.maxLineSpace=0;var e=this;this.maxHeight=0;for(var t=5;t<this.columns.length;t++)this.maxHeight=Math.max(this.maxHeight,this.columns[t].world.height),this.maxLineSpace=Math.max(this.maxLineSpace,this.columns[t].info.lineSpace);for(this.initScore="",t=0;t<xfruntime.all_global_vars.length;t++){var i=xfruntime.all_global_vars[t];if(i.name===this.sortField.substr(1)){this.initScore=i.data+"";break}}if(this.rankList=[],this.tableList=[],this.myRank=[],xf.loadTextures(this.type),this.runtime.tickMe(this),this.drawInit(),"None"!==this.sortField)if(this.runtime.isWeixin)wx.getUserInfo({success:function(t){e.userInfo=t.userInfo,e.refresh()}}),xf.EventCenter.instance.addEventListener(xf.EventType.REPORT_GLOBAL_VARS,function(t){if("@"+t.messageData.name===e.sortField)e.wxPostMessage(e,{text:"updateScore",score:t.messageData.data})},e);else this.refresh();else this.renderNone()},e.drawInit=function(){var t=this;this.initalWidth=this.width,this.initalHeight=this.height;var e=new xf.xfContainer;(e.owner=this).container=e,this.changeSizeOrPos();var i=(e.owner=this).type.animations[0].frames[0],n=this.columns[0].info,r=this.columns[0].world,o=new xf.xfImage;if(o.angle=r.angle,o.x=0,o.y=0,o.width=r.width,o.height=r.height,0==n.fill)o.centerFillMode=xf.FillMode.REPEAT;else if(1==n.fill)o.centerFillMode=xf.FillMode.SCALE;else if(2==n.fill)o.centerFillMode=xf.FillMode.NONE;if(0==n.edges)o.fillMode=xf.FillMode.REPEAT;else if(1==n.edges)o.fillMode=xf.FillMode.SCALE;o.source=i.texture_img,o.scale9Grid=xf.Rect.create(n.left,n.top,i.width-n.right-n.left,i.height-n.bottom-n.top),e.addChild(o);var s=w(this.columns[2],r);e.addChild(s);var a=this.columns[3].world,l=this.type.animations[1].frames[0],c=new xf.xfUIButton(l.texture_img);if(c.x=a.x-r.x,c.y=a.y-r.y,c.width=a.width,c.height=a.height,c.setCallback(function(){if(c.state===xf.ButtonState.PRESSED)t.visible=!1,t.runtime.redraw=!0},this),e.addChild(c),this.runtime.isWeixin&&1===this.rankType)this.weixinInit();else{a=this.columns[1].world;var u=new xf.xfScroller;this.container.addChild(u),(this.xfScroller=u).width=a.width,u.height=a.height,u.x=a.x-r.x,u.y=a.y-r.y,u.direction=xf.ScrollDirection.VERTICAL,u.setVisibleRect(xf.Rect.create(0,0,a.width,a.height)),u.touchedOuter=!0;var h=new xf.xfContainer;u.setContentView(h),this.content=h;for(var d=0,p=0;p<this.limit;p++){var f=this.tableList[p];if(!f)f=[],this.tableList.push(f);for(var m=new xf.xfContainer,g=5;g<this.columns.length;g++){var y=w(this.columns[g],r);y.x-=u.x,y.y-=u.y,m.addChild(y),f.push(y)}m.x=0,m.y=d,d+=this.maxHeight,h.addChild(m),this.tableList[p]=f}a=this.columns[4].world;var v=new xf.xfContainer;v.x=a.x-r.x,v.y=a.y-r.y,v.width=a.width,v.height=a.height;var b=[];for(g=5;g<this.columns.length;g++){var _=w(this.columns[g],r);_.x-=u.x,_.y-=u.y,v.addChild(_),b.push(_)}this.container.addChild(v),this.myRank=b}this.runtime.redraw=!0},e.render=function(){var i=this,o=this;if(!this.runtime.isWeixin){o.content.height=(o.rankList.length>o.limit?o.limit:o.rankList.length)*this.maxHeight;for(var s=xf.gameInfo.characterId,t=0,e=o.tableList.length;t<e;t++)for(var n=o.tableList[t],r=0;r<n.length;r++)n[r].text="";for(var a=function(t,e){var n=o.rankList[t];if(n){var r=t+1;if(r>=i.offset&&r-i.offset<i.limit){i.tableList[r-i.offset].forEach(function(t,e){var i=o.columns[5+e].info.bindVar;if("{rank}"===i)t.text=r+"";else if(null!=n[i])t.text=n[i]+"";else t.text=""})}if(n.$cid===s)i.selfRank=r}},l=0,c=o.rankList.length;l<c;l++)a(l);for(var u=0;u<o.myRank.length;u++){var h=o.myRank[u],d=o.columns[5+u].info;if("{rank}"===d.bindVar)h.text=this.selfRank?this.selfRank+"":"未上榜";else if("$cname"===d.bindVar)h.text=xf.gameInfo.characterName;else if("$cid"===d.bindVar)h.text=xf.gameInfo.characterId;else{var p=d.bindVarName.substr(1);if(xfruntime.varsByName[p])h.text=xfruntime.varsByName[p].data+"";else h.text=""}}o.runtime.redraw=!0}},e.changeSizeOrPos=function(){this.container.x=this.x,this.container.y=this.y,this.container.width=this.width,this.container.height=this.height,this.container.alpha=this.opacity,this.container.rotation=this.angle,this.container.anchorOffsetX=this.container.width*this.hotspotX,this.container.anchorOffsetY=this.container.height*this.hotspotY,this.container.scale.x=this.width/this.initalWidth,this.container.scale.y=this.height/this.initalHeight},e.tick=function(){if(this.changeSizeOrPos(),this.runtime.isWeixin)this.runtime.redraw=!0},e.onDestroy=function(){if(this.container)this.container.destory(),this.container=null},e.draw=function(t,e){if(!this.visible||!this.container)return!1;this.wxDrawRank&&this.wxDrawRank(),this.container.draw(t,this.runtime)},e.drawGL=function(t){if(!this.visible||!this.container)return!1;this.wxDrawRank&&this.wxDrawRank(),this.container.drawGL(t,this.runtime)},e.refresh=function(){var e=this;if(this.runtime.isWeixin&&1===this.rankType)this.wxPostMessage(this,{text:"getRank",userInfo:this.userInfo,maxHeight:this.maxHeight,listHeight:this.columns[1].world.height,listWidth:this.columns[1].world.width,initScore:this.initScore,devicePixelRatio:this.runtime.devicePixelRatio,aspectScale:this.runtime.aspect_scale,x:this.x-this.width/2+this.columns[1].world.x,y:this.y-this.height/2+this.columns[1].world.y});else xf.serverApi.getRankInfo({instanceId:e.uid,gameId:xf.gameInfo.gameId,gameVersion:xf.gameInfo.version}).then(function(t){if(t.result.list)e.rankList=t.result.list,e.render();else if((e.refreshAgain||0)<5&&e.range.scope.start<=1){if(void 0===e.refreshAgain)e.refreshAgain=0;else e.refreshAgain++;setTimeout(function(){console.log("-- refresh again --"),e.refresh()},500)}else e.rankList=[],e.render()}).catch(function(t){console.error(t.message),e.rankList=[],e.render()})},e.weixinInit=function(){var t=this,i=wx.getOpenDataContext(),e=i.canvas;e.width=this.width,e.height=this.height;var n=new xf.xfImage;n.width=this.columns[1].world.width,n.height=this.columns[1].world.height,n.setClip(0,0,n.width,n.height),n.contentSize={width:n.width,height:n.height},n.x=this.columns[1].world.x-this.columns[0].world.x,n.y=this.columns[1].world.y-this.columns[0].world.y,this.container.addChild(n);var r=new xf.xfImage;r.width=n.width,r.height=this.maxHeight,r.setClip(0,this.height-this.maxHeight,n.width,this.maxHeight),r.contentSize={width:n.width,height:this.maxHeight},r.x=this.columns[1].world.x-this.columns[0].world.x,r.y=this.columns[4].world.y-this.columns[0].world.y,this.container.addChild(r),this.wxDrawRank=function(){n.loadWxCanvas(t.runtime,e),r.loadWxCanvas(t.runtime,e)},this.wxPostMessage=function(t,e){i.postMessage({param:e,properties:t.properties})}},e.renderNone=function(){var t=w({info:{text:"排序依据未设置，无法预览榜单效果",fontColor:[1,1,1,1],fontSize:15,font:"Arial",bold:!1,italic:!1,halign:"center",valign:"center"},world:{width:this.width,height:28}},this.columns[0].world);t.x=0,t.y=(this.height-t.height)/2,this.container.addChild(t)},e.getDebuggerValues=function(t){t.push({title:"属性",properties:[{name:"是否启用",value:this.isEnabled}]})},e.onDebugValueEdited=function(t,e,i){switch(e){case"是否启用":this.isEnabled=i}},t.cnds=new function(){},i.prototype.refresh=function(){this.refresh()},t.acts=new i,t.exps=new n,n.prototype.Myrank=function(t){if(!this.selfRank)t.set_string("");else t.set_string(this.selfRank+"")}}(),drama.plugins_.xfSDK=function(t){this.runtime=t},function(){var t=drama.plugins_.xfSDK.prototype;t.Type=function(t){this.plugin=t,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t){this.type=t,this.runtime=t.runtime};var r=0,e=t.Instance.prototype;function i(t,e,i){var n=t.findIndex(function(t){return t==e});if(-1<n){if(!i)t.splice(n,1);return!0}else return!1}function n(){}function o(){}e.onCreate=function(){if(this.characterType=this.properties[0],console.log(this.characterType),this.bulletins=[],this.isGettingCharacterList=!1,this.characterList=[],this.charactersMap={},this.currentCharacter={},xf.bulletinManager.init(),xf.archiveSDK.init(),"single"==this.characterType&&"2"==xf.gameInfo.gameType&&xf.gameInfo.playerId)this.initCharacter()},e.initCharacter=function(){var n=this;xf.serverApi.getCharacterList({uid:xf.gameInfo.playerId,gid:xf.gameInfo.gameId}).then(function(t){if(t.length)n.characterList=t,n.characterList.map(function(t){n.charactersMap[t.cid]=t}),xf.gameInfo.setCharacterInfo(t[0]),n.connectServer(),n.syncLocalAndCloudGlobalVal(t[0]);else{var e=xf.parseQuery(),i=null;if(e.nickName)if(0<r)i=e.nickName+md5(xf.gameInfo.playerId+Date.now()).substr(8,6);else i=e.nickName;else i="玩家"+md5(xf.gameInfo.playerId+Date.now()).substr(8,6);n.createCharacter(i).then(function(t){xf.gameInfo.setCharacterInfo(t),n.connectServer()}),r=0}}).catch(function(t){if(r<1)return r++,void n.initCharacter();console.error("单角色联机游戏初始化角色失败:".concat(t))})},e.connectServer=function(){xf.xfWebSocketUtils.instance.connect(xf.gameInfo.gameId,xf.gameInfo.version,xf.gameInfo.playerId,xf.gameInfo.characterId,encodeURIComponent(xf.gameInfo.token),xf.gameInfo.deviceId,xf.Platform[xf.gameInfo.platform])},e.createCharacter=function(n){var r=this;return new Promise(function(i,e){xf.serverApi.createCharacter({uid:xf.gameInfo.playerId,gid:xf.gameInfo.gameId,cname:n}).then(function(t){console.log("----- 创建角色成功 -----");var e={cid:t.cid,cname:n,ctime:t.ctime,gid:xf.gameInfo.gameId,glov:null,goods:null,gver:null,uid:xf.gameInfo.playerId,utime:t.utime,wallet:0};r.characterList.push(e),r.charactersMap[e.cid]=e,i(e)}).catch(function(t){e(t)})})},e.stopRunning=function(){this.runtime.running_layout.stopRunning()},e.syncLocalAndCloudGlobalVal=function(t){var e=t.glov;for(var i in e)window.xfruntime.all_global_vars.forEach(function(t){if(t.sid==i)t.setValue(e[i],!0)})},n.prototype.onLoginSuccess=function(){return!1},n.prototype.onLogout=function(){return!1},n.prototype.onSwitchAccount=function(){return!1},n.prototype.onPickerShowOrDimiss=function(t){return!1},n.prototype.onPickerSetResult=function(t){return!1},n.prototype.onShowBulletinSuccess=function(t){return i(this.bulletins,t,!0)},n.prototype.onShowBulletinFaild=function(t){return i(this.bulletins,t)},n.prototype.onHideBulletin=function(t){return i(this.bulletins,t)},n.prototype.hadCharacterName=function(t){var e=!0,i=!1,n=void 0;try{for(var r,o=this.characterList[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){if(r.value.cname===t)return!0}}catch(t){i=!0,n=t}finally{try{if(!e&&null!=o.return)o.return()}finally{if(i)throw n}}return!1},n.prototype.getCharacterList=function(){return this.isGettingCharacterList},n.prototype.getCharacterListSuccess=function(){return!0},n.prototype.getCharacterListFaild=function(){return!0},n.prototype.createCharacterSuccess=function(){return!0},n.prototype.createCharacterFaild=function(){return!0},n.prototype.switchCharacterSuccess=function(){return!0},n.prototype.switchCharacterFaild=function(){return!0},n.prototype.changeCharacterNameSuccess=function(){return!0},n.prototype.changeCharacterNameFaild=function(){return!0},n.prototype.isNetwork=function(t){if(0===t)return 1===xf.xfWebSocket.instance.status;else return/2|3/.test(xf.xfWebSocket.instance.status)},t.cnds=new n,o.prototype.ShowRolePicker=function(){},o.prototype.showBulletin=function(t){var e=this;this.bulletins.push(t),xf.bulletinManager.getBulletin(t,function(t){if(1==t)e.runtime.trigger(drama.plugins_.xfSDK.prototype.cnds.onShowBulletinSuccess,e);else if(2==t)e.runtime.trigger(drama.plugins_.xfSDK.prototype.cnds.onShowBulletinFaild,e);else if(3==t)e.runtime.trigger(drama.plugins_.xfSDK.prototype.cnds.onHideBulletin,e)})},o.prototype.getCharacterList=function(){var e=this;this.isGettingCharacterList=!0,xf.serverApi.getCharacterList({uid:xf.gameInfo.playerId,gid:xf.gameInfo.gameId}).then(function(t){if(e.isGettingCharacterList=!1,t.length)e.characterList=t,e.characterList.map(function(t){e.charactersMap[t.cid]=t});e.runtime.trigger(drama.plugins_.xfSDK.prototype.cnds.getCharacterListSuccess,e)}).catch(function(t){e.isGettingCharacterList=!1,e.runtime.trigger(drama.plugins_.xfSDK.prototype.cnds.getCharacterListFaild,e)})},o.prototype.updateCharacter=function(i,n){var r=this;if(this.charactersMap[i]&&n)xf.serverApi.updateCharacter({cid:i,gid:xf.gameInfo.gameId,gver:xf.gameInfo.version,cname:n}).then(function(t){console.log("----- 更新角色成功 -----");var e={};if(xf.gameInfo.characterId==i)e.cname=n;else e={ctime:r.charactersMap[i].ctime,cid:i,cname:n};xf.gameInfo.setCharacterInfo(e),r.charactersMap[i].cname=n,r.characterList.map(function(t){if(t.cid==i)t.cname}),r.runtime.trigger(drama.plugins_.xfSDK.prototype.cnds.changeCharacterNameSuccess,r)}).catch(function(t){r.runtime.trigger(drama.plugins_.xfSDK.prototype.cnds.changeCharacterNameFaild,r)});else this.runtime.trigger(drama.plugins_.xfSDK.prototype.cnds.changeCharacterNameFaild,this)},o.prototype.createCharacter=function(t){var e=this;if(t)this.createCharacter(t).then(function(t){e.runtime.trigger(drama.plugins_.xfSDK.prototype.cnds.createCharacterSuccess,e)}).catch(function(t){e.runtime.trigger(drama.plugins_.xfSDK.prototype.cnds.createCharacterFaild,e)});else this.runtime.trigger(drama.plugins_.xfSDK.prototype.cnds.createCharacterFaild,this)},o.prototype.selectCharacter=function(t){var e=this.charactersMap[t+""];if(e)xf.gameInfo.setCharacterInfo(e),this.syncLocalAndCloudGlobalVal(e),this.runtime.trigger(drama.plugins_.xfSDK.prototype.cnds.switchCharacterSuccess,this);else this.runtime.trigger(drama.plugins_.xfSDK.prototype.cnds.switchCharacterFaild,this)};var s={0:1,1:10},a={1:"开始打开",10:"加载完成"};o.prototype.reportPageView=function(t,e,i,n){console.log(t,s[e],a[s[e]]),xf.cloudLadderSDK.doReportEvent("page_view",{page:t,loading:s[e],operation:Number(i),operation_name:n})},o.prototype.reportButtonClick=function(t,e,i,n){console.log(t,e),xf.cloudLadderSDK.doReportEvent("button_click",{page:t,button_name:e,operation:Number(i),operation_name:n})};var l={0:"copy"};function c(){}o.prototype.reportPageInteractior=function(t,e,i){console.log(l[t]),xf.cloudLadderSDK.doReportEvent("page_interactior",{action_name:l[t],operation:Number(e),operation_name:i})},t.acts=new o,c.prototype.cid=function(t){if(xf.gameInfo.characterId)t.set_string(xf.gameInfo.characterId);else t.set_string("")},c.prototype.cname=function(t,e){var i=this.charactersMap[e+""];if(i&&i.cname)t.set_string(i.cname);else t.set_string("")},c.prototype.characterCount=function(t){t.set_float(this.characterList.length)},c.prototype.characterList=function(t){var e="";this.characterList.map(function(t){e+=",".concat(t.cid)}),e=e.slice(1),t.set_string(e)},t.exps=new c}(),assert2(drama,"drama namespace not created"),assert2(drama.plugins_,"drama.plugins_ not created"),drama.plugins_.xfSlider=function(t){this.runtime=t},function(){var t=drama.plugins_.xfSlider.prototype;t.Type=function(t){this.plugin=t,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){if(!this.is_family)this.all_frames=[],this.has_loaded_textures=!1,this.animationsByName={},xf.formatAnimation(this)},t.Instance=function(t){this.type=t,this.runtime=t.runtime};var e=t.Instance.prototype;function i(){}function n(){}function r(){}e.onCreate=function(){var i=this;xf.testTypeImage(this.type);var o=this;if(this.visible=this.properties[0],this.value=this.properties[1],this.min=this.properties[2],this.max=this.properties[3],this.step=this.properties[4],this.hide_bg=this.properties[5],this.hide_circle=this.properties[6],this.mode=this.properties[7],this.audio=this.properties[8],this.progressBeforeHeight=!isNaN(this.properties[9])?this.properties[9]:1,this.old_width=this.width,this.old_height=this.height,this.oldOpacity=this.opacity,this.audio)this.audioInst=xf.audioInstance(this.runtime);this.value=this.value<this.min?this.min:this.value,this.oldValue=this.value,this.event=xf.XfEvent.create(this.runtime),this.dragging=!1,this.isClick=!1,this.startX=0,this.startY=0,this.startPosition=0,this.newPosition=null,this.oldValue=this.value,this.circleWidth=0,this.currentPosition=function(){return"".concat((o.value-o.min)/(o.max-o.min)*100,"%")},this.onButtonDown=function(t){if(!o.disabled)t.preventDefault(),o.changeProgress(),o.onDragStart(t),window.addEventListener("mousemove",o.onDragging),window.addEventListener("touchmove",o.onDragging),window.addEventListener("mouseup",o.onDragEnd),window.addEventListener("touchend",o.onDragEnd),window.addEventListener("contextmenu",o.onDragEnd)},this.onDragStart=function(t){if(o.changeProgress(),o.dragging=!0,o.isClick=!0,"touchstart"===t.type){var e=drama.convertPageXY(t.touches[0].clientX,t.touches[0].clientY);t.clientY=e.pageY,t.clientX=e.pageX}o.startX=t.clientX,o.startY=t.clientY,o.startPosition=parseFloat(o.currentPosition()),o.newPosition=o.startPosition},this.onDragging=function(t){if(o.dragging){o.changeProgress(),o.isClick=!1;var e;if("touchmove"===t.type){var i=drama.convertPageXY(t.touches[0].clientX,t.touches[0].clientY);t.clientY=i.pageY,t.clientX=i.pageX}var n=xf.Point.create(o.startX,o.startY),r=xf.Point.create(t.clientX,t.clientY);e=drama.getMoveDistance(n,r,drama.to_degrees(o.angle))/o.width*100*(o.runtime.original_width/o.runtime.cssWidth),o.newPosition=o.startPosition+e,o.setPosition(o.newPosition)}},this.onDragEnd=function(){if(o.changeProgress(),o.dragging)setTimeout(function(){if(o.dragging=!1,!o.isClick)o.setPosition(o.newPosition)},0),window.removeEventListener("mousemove",o.onDragging),window.removeEventListener("touchmove",o.onDragging),window.removeEventListener("mouseup",o.onDragEnd),window.removeEventListener("touchend",o.onDragEnd),window.removeEventListener("contextmenu",o.onDragEnd)},this.setPosition=function(t){if(null!==t){if(t<0)t=0;var e=100/((o.max-o.min)/o.step),i=Math.round(t/e),n=i*e*(o.max-o.min)*.01+o.min;if(o.step>o.min)n=i*e*(o.max-o.min)*.01;if(n=parseFloat(n.toFixed(2)),o.value=n>o.max?o.max:n,o.runtime.trigger(drama.plugins_.xfSlider.prototype.cnds.OnChange,o),!o.dragging&&o.value!==o.oldValue)o.oldValue=o.value}},this.runtime.tickMe(this),xf.loadTextures(this.type),this.sliderMap={};["background","progress","circle"].map(function(t){var e=xf.getAnimationByName(i.type,t).frames[0];i.sliderMap[t]=e}),this.drawInit(),this.event.addEventListener("mousedown",function(t){o.handlePlayAudio(),o.onButtonDown(t)},this,{displayObject:this.circleImage}),this.event.addEventListener("touchstart",function(t){o.handlePlayAudio(),o.onButtonDown(t)},this,{displayObject:this.circleImage})},e.drawInit=function(){var t=new xf.xfContainer;this.container=t,(this.container.owner=this).container.alpha=this.opacity,this.container.x=this.x,this.container.y=this.y;var e=new xf.xfImage;(this.backgroundImage=e).fillMode=xf.FillMode.SCALE,this.backgroundFrame=this.sliderMap.background,e.height=this.height,e.width=this.hide_bg?0:this.width,e.source=this.backgroundFrame.texture_img;var i=new xf.xfImage;(this.progressImage=i).fillMode=this.mode?xf.FillMode.SCALE:xf.FillMode.CLIP,this.progressFrame=this.sliderMap.progress,i.source=this.progressFrame.texture_img,i.anchorOffsetY=this.height/2,i.y=this.height/2,i.height=this.height,i.scaleY=this.progressBeforeHeight,i.width=this.width,this.progressWidth=this.width;var n=new xf.xfImage;this.circleImage=n,this.circleImage.fillMode=xf.FillMode.SCALE,this.circleFrame=this.sliderMap.circle,this.circleWidth=this.circleFrame.width,this.circleImage.source=this.circleFrame.texture_img,this.widthScaleRatio=this.width/this.backgroundFrame.width,this.heightScaleRatio=this.height/this.backgroundFrame.height,this.progressScaleRatio=this.progressFrame.width>this.width?this.width/this.progressFrame.width:1;var r=(this.circleFrame.height-this.backgroundFrame.height+this.height)/this.circleFrame.height,o=this.circleFrame.width*r;this.circleWidth=o;var s=this.circleFrame.height*r;this.circleImage.width=this.circleWidth,this.circleImage.height=s,this.circleImage.y=.5*(this.backgroundImage.height-this.circleImage.height),t.addChild(e),t.addChild(i),t.addChild(n),this.changeProgress()},e.handlePlayAudio=function(){setTimeout(function(){if(this.audioInst)this.audioInst.Stop("xfMouseAndTouchDefaultAudio"),this.audioInst.Stop(this.audio+this.uid),this.audioInst.Play([this.audio,!0],0,1,this.audio+this.uid)}.bind(this),0)},e.updateFrmae=function(t){var e=xf.getAnimationByName(this.type,t);if(e)this.curFrame=e.frames[0]},e.updatePosition=function(t){if(-1<t.type.indexOf("touch")){var e=drama.convertPageXY(t.touches[0].pageX,t.touches[0].pageY);this.mouseXcanvas=e.pageX-this.runtime.canvas.offsetLeft,this.mouseYcanvas=e.pageY-this.runtime.canvas.offsetTop}else this.mouseXcanvas=t.pageX-this.runtime.canvas.offsetLeft,this.mouseYcanvas=t.pageY-this.runtime.canvas.offsetTop},e.saveToJSON=function(){return{value:this.value,max:this.max,min:this.min,step:this.step}},e.loadFromJSON=function(t){this.value=t.value,this.max=t.max,this.min=t.min,this.step=t.step},e.onDestroy=function(){if(this.event.removeEventListeners(["mousedown","touchstart"],this),this.container)this.container.destory(),this.container=null;this.backgroundImage=null,this.progressImage=null,this.circleImage=null},e.getCurrentValue=function(){var t=this.value>this.min?this.value:this.min;return t=t>this.max?this.max:t},e.changeProgress=function(){var t=this.getCurrentValue()/this.max;if(this.progressFrame)if(this.progressImage.width=this.progressWidth*t,0==this.mode){var e=t*this.progressFrame.width;this.progressImage.setClip(this.progressFrame.offx,this.progressFrame.offy,e,this.progressFrame.height,this.progressFrame.pixelformat)}if(this.circleFrame)if(this.circleImage.x=this.progressWidth*t-this.circleWidth/2+this.progressImage.x,this.hide_circle)this.circleImage.width=0},e.changeSizeOrPos=function(){var t=this.width/this.old_width,e=this.height/this.old_height;this.container.x=this.x,this.container.y=this.y,this.container.width=this.width,this.container.height=this.height,this.container.anchorOffsetX=this.container.width*this.hotspotX,this.container.anchorOffsetY=this.container.height*this.hotspotY,this.container.scale.x=t,this.container.scale.y=e,this.container.alpha=this.opacity,this.container.rotation=this.angle},e.tick=function(){this.changeSizeOrPos(),this.runtime.redraw=!0},e.draw=function(t){if(!this.visible)return!1;this.container.draw(t,this.runtime)},e.drawGL=function(t){if(!this.visible)return!1;this.container.drawGL(t,this.runtime)},i.prototype.CompareProgress=function(t,e){return drama.do_cmp(this.value,t,e)},i.prototype.OnChange=function(){return!0},t.cnds=new i,n.prototype.SetVisible=function(t){this.visible=0!==t},n.prototype.SetProgress=function(t){t=(t=t<this.min?this.min:t)>this.max?this.max:t,this.value=t,this.runtime.trigger(drama.plugins_.xfSlider.prototype.cnds.OnChange,this),this.changeProgress()},n.prototype.SetMaximum=function(t){this.max=t,this.changeProgress()},n.prototype.SetMinimal=function(t){this.min=t,this.changeProgress()},n.prototype.SetStep=function(t){this.step=t,this.changeProgress()},n.prototype.SetParam=function(t,e,i,n,r,o){if(1==t)this.max=e;if(1==i)this.min=n;if(1==r)this.step=o;this.changeProgress()},t.acts=new n,r.prototype.Progress=function(t){t.set_float(this.value)},r.prototype.Maximum=function(t){t.set_float(this.max)},r.prototype.Minimal=function(t){t.set_float(this.min)},t.exps=new r}(),assert2(drama,"drama namespace not created"),assert2(drama.plugins_,"drama.plugins_ not created"),drama.plugins_.xfSpine=function(t){this.runtime=t},function(){var t=drama.plugins_.xfSpine.prototype;t.Type=function(t){this.plugin=t,this.runtime=t.runtime};var e=t.Type.prototype;e.onCreate=function(){var r=this;if(!this.is_family){this.all_frames=[];for(var t=function(e){var t=r.animations[e],i=t[7][0][0],n={};n.texture_file=i,n.texture_filesize=t[7][0][1],r.runtime.xfPreloadGroup.push(i,function(t){n.texture_img=t[i],r.loadingprogress=(e+1)/r.all_frames.length*100}),r.all_frames.push(n)},e=0;e<this.animations.length;e++)t(e)}},e.dynamicLoad=function(){if(!this.is_family){this.all_frames=[];for(var t=[],e=[],i=0;i<this.animations.length;i++){var n=this.animations[i],r=n[7][0][0],o=n[7][0][1],s={};s.texture_file=r,s.texture_filesize=n[7][0][1],t.push(r),e.push(o),this.all_frames.push(s)}this.runtime.requestTypeAnimations(this,t,e),this.isDynamicRelease=!1}},t.Instance=function(t){this.type=t,this.runtime=t.runtime,this.objId=t.sid};var i=t.Instance.prototype;function n(){}function r(){}function o(){}i.onCreate=function(){if(this.isCreated=!1,!this.type.isDynamicRelease){var t=this.runtime.spineDataMap[this.objId];if(t){var e=this,i=window.xfHost.get({url:t.json})||"",n=window.xfHost.get({url:t.atlas})||"";if(!(i instanceof Array||n instanceof Array))this.spine_data=i,this.atlas_data=n,this.skinName=e.properties[3][e.properties[0]||0],this.animationName=e.properties[4][e.properties[1]||0],this.skeletonName="",this.premultipliedAlpha=1,this.isPlaying=!0,e.anim_order=2===e.properties[2]?-1:1,e.skinArr=e.properties[3],e.animArr=e.properties[4],e.runtime.trigger(drama.plugins_.xfSpine.prototype.cnds.IsUseSkin,e),e.runtime.trigger(drama.plugins_.xfSpine.prototype.cnds.IsStartAnimation,e),e.isStopTriggerLoop=!1,e.isStopTriggerSingle=!1,this.isLoop=!1,this.isCreated=!0,this.canvas=this.runtime.canvas,this.initSpine(),this.loadSkeletons(),this.runtime.tickMe(this)}}},i.initSpine=function(){this.gl=this.runtime.gl;var t=this.gl;if(t)spine.webgl.GLTexture.DISABLE_UNPACK_PREMULTIPLIED_ALPHA_WEBGL=!0,this.mvp=new spine.webgl.Matrix4,this.shader=spine.webgl.Shader.newTwoColoredTextured(t),this.batcher=new spine.webgl.PolygonBatcher(t),this.mvp.ortho2d(0,0,this.runtime.glwrap.width,this.runtime.glwrap.height),this.skeletonRendere=new spine.webgl.SkeletonRenderer(t);else console.error("WebGL is unavailable.")},i.loadSkeletons=function(){this.skeletonInfo=this.loadSkeleton(this.skeletonName,this.animationName)},i.playAnimation=function(){this.isPlaying=!0},i.stopAnimation=function(){this.isPlaying=!1},i.loadSkeleton=function(t,e){var i=this;this.texture=new spine.webgl.GLTexture(this.gl,this.type.all_frames[0].texture_img);var n=new spine.TextureAtlas(this.atlas_data,function(t){return i.texture}),r=new spine.AtlasAttachmentLoader(n),o=new spine.SkeletonJson(r).readSkeletonData(this.spine_data),s=new spine.Skeleton(o);s.setSkinByName(this.skinName);var a=s.data.findSkin(this.skinName);if(void 0===a)a=s.data.skins[0];s.setSkin(a);var l=new spine.AnimationState(new spine.AnimationStateData(o));l.setAnimation(0,e,!0),l.apply(s),s.updateWorldTransform();var c=new spine.Vector2,u=new spine.Vector2;return s.getBounds(c,u,[]),{atlas:n,skeleton:s,state:l,playTime:0,bounds:{offset:c,size:u}}},i.resize=function(){var t=this.runtime.glwrap,e=this.x,i=this.y,n=this.width<0?-1:1,r=this.height<0?-1:1,o=this.angle*n*r,s=Math.round(this.skeletonInfo.skeleton.data.width),a=Math.round(this.skeletonInfo.skeleton.data.height);mat4.multiply(t.matP,t.matMV,this.mvp.values),this.mat4x4Translate(this.mvp.values,e,i,0),this.mat4x4RotateZ(this.mvp.values,o),this.mat4x4Scale(this.mvp.values,this.width/s,-this.height/a,1)},i.mat4x4RotateCosSinZ=function(t,e,i){var n=t[0],r=t[1],o=t[2],s=t[3],a=t[4],l=t[5],c=t[6],u=t[7];return t[0]=n*e+a*i,t[1]=r*e+l*i,t[2]=o*e+c*i,t[3]=s*e+u*i,t[4]=a*e-n*i,t[5]=l*e-r*i,t[6]=c*e-o*i,t[7]=u*e-s*i,t},i.mat4x4Translate=function(t,e,i,n){if(void 0===n)n=0;return t[12]+=t[0]*e+t[4]*i+t[8]*n,t[13]+=t[1]*e+t[5]*i+t[9]*n,t[14]+=t[2]*e+t[6]*i+t[10]*n,t[15]+=t[3]*e+t[7]*i+t[11]*n,t},i.mat4x4Scale=function(t,e,i,n){if(void 0===n)n=1;return t[0]*=e,t[1]*=e,t[2]*=e,t[3]*=e,t[4]*=i,t[5]*=i,t[6]*=i,t[7]*=i,t[8]*=n,t[9]*=n,t[10]*=n,t[11]*=n,t},i.mat4x4RotateZ=function(t,e){return this.mat4x4RotateCosSinZ(t,Math.cos(e),Math.sin(e))},i.onDestroy=function(){this.spine_data=null,this.atlas_data=null,this.texture=null,this.mvp=null,this.shader=null,this.batcher=null,this.skeletonRendere=null,this.skeletonInfo=null},i.saveToJSON=function(){return{}},i.loadFromJSON=function(t){},i.tick=function(){if(this.isCreated)if(!this.isPause)if(this.visible){var t=this.runtime.getDt(),e=this.skeletonInfo,i=this.skeletonInfo.state;if(this.isPlaying){var n=i.getCurrent(0).animation.duration;for(e.playTime+=t;e.playTime>=n&&0<n;)e.playTime-=n;if(i.getCurrent(0).isComplete())this.runtime.trigger(drama.plugins_.xfSpine.prototype.cnds.IsStopAnimation,this);i.update(t),i.apply(e.skeleton),e.skeleton.updateWorldTransform(),this.runtime.redraw=!0}}},i.draw=function(t){},i.render=function(t){if(this.isCreated)this.resize(t),this.shader.bind(),this.shader.setUniformi(spine.webgl.Shader.SAMPLER,0),this.shader.setUniform4x4f(spine.webgl.Shader.MVP_MATRIX,this.mvp.values),this.batcher.begin(this.shader),this.skeletonRendere.vertexEffect=null,this.skeletonInfo.skeleton.color.a=this.opacity,this.skeletonRendere.draw(this.batcher,this.skeletonInfo.skeleton),this.batcher.end(),this.shader.unbind()},i.drawGL=function(t){if(this.isCreated)if(this.visible){var e=this.runtime.gl;t.endBatch(),this.render(t),t.lastSrcBlend=e.ONE,t.lastDestBlend=e.ONE_MINUS_SRC_ALPHA,e.blendFunc(e.ONE,e.ONE_MINUS_SRC_ALPHA),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t.indexBuffer),t.lastTexture0=null,e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,null),t.lastProgram=-1,e.enable(e.BLEND),e.viewport(0,0,t.width,t.height),e.blendFunc(e.ONE,e.ONE_MINUS_SRC_ALPHA),t.switchProgram(0)}},n.prototype.IsFlipType=function(t,e){if(0==t)if(this.width<0)return 0==e;else return 1==e;else if(1==t)if(this.height<0)return 0==e;else return 1==e},n.prototype.IsChangeSkin=function(){return!0},n.prototype.IsChangeAnimation=function(){return!0},n.prototype.IsStartAnimation=function(t){return 0===t||this.animArr[t-1]===this.animationName},n.prototype.IsStopAnimation=function(t){return 0===t||this.animArr[t-1]===this.animationName},n.prototype.IsPlayingAnimation=function(t){return 0===t||this.animArr[t-1]===this.animationName},n.prototype.IsUseSkin=function(t){return this.skinName===this.skinArr[t]},t.cnds=new n,r.prototype.SetFlippedType=function(t){if(1!==t){var e=drama.abs(this.width)*(0===t?-1:1);if(this.width===e)return;this.width=e}if(0!==t){var i=drama.abs(this.height)*(1===t?-1:1);if(this.height===i)return;this.height=i}this.set_bbox_changed()},r.prototype.Spawn=function(t,e,i){if(t&&e){var n=this.runtime.createInstance(t,e,this.x,this.y);if(n){if(void 0!==n.angle)n.angle=this.angle,n.set_bbox_changed();var r,o,s;if(this.runtime.isInOnDestroy++,this.runtime.trigger(Object.getPrototypeOf(t.plugin).cnds.OnCreated,n),n.is_contained)for(r=0,o=n.siblings.length;r<o;r++)s=n.siblings[r],this.runtime.trigger(Object.getPrototypeOf(s.type.plugin).cnds.OnCreated,s);this.runtime.isInOnDestroy--;var a,l=this.runtime.getCurrentAction(),c=!1;if(drama.is_undefined(l.extra.Spawn_LastExec)||l.extra.Spawn_LastExec<this.runtime.execcount)c=!0,l.extra.Spawn_LastExec=this.runtime.execcount;if(t!=this.type){if((a=t.getCurrentSol()).select_all=!1,c)drama.clearArray(a.instances),a.instances[0]=n;else a.instances.push(n);if(n.is_contained)for(r=0,o=n.siblings.length;r<o;r++)if((a=(s=n.siblings[r]).type.getCurrentSol()).select_all=!1,c)drama.clearArray(a.instances),a.instances[0]=s;else a.instances.push(s)}}}},r.prototype.ResetFlipped=function(t){if(0===t)this.width=drama.abs(this.width);else if(1===t)this.height=drama.abs(this.height);this.set_bbox_changed()},r.prototype.SetSkin=function(t){if(t!=this.skinName){this.skinName=t;var e=this.skeletonInfo.skeleton;e.setSkinByName(this.skinName),this.runtime.trigger(drama.plugins_.xfSpine.prototype.cnds.IsChangeSkin,this),this.runtime.trigger(drama.plugins_.xfSpine.prototype.cnds.IsUseSkin,this),e.setSlotsToSetupPose()}},r.prototype.SetAnim=function(t){this.animationName=t;var e=this.skeletonInfo.skeleton,i=this.skeletonInfo.state;e.setToSetupPose(),i.setAnimation(0,t,this.isLoop),this.runtime.trigger(drama.plugins_.xfSpine.prototype.cnds.IsChangeAnimation,this),this.runtime.trigger(drama.plugins_.xfSpine.prototype.cnds.IsStartAnimation,this)},r.prototype.Pause=function(){this.isPause=!0},r.prototype.Restart=function(){this.isPause=!1},r.prototype.SetTime=function(t){},r.prototype.SetPlayOrder=function(t){this.anim_order=t?1:-1},r.prototype.SetLoop=function(t){if(0==t)this.isLoop=!0;else if(1==t)this.isLoop=!1},r.prototype.SetRate=function(t){},t.acts=new r,o.prototype.Skin=function(t){if("string"==typeof this.skinName)t.set_string(this.skinName||"")},o.prototype.Anim=function(t){if("string"==typeof this.animationName)t.set_string(this.animationName||"")},o.prototype.Time=function(t){t.set_float(this.extra.anim_time/1e3)},t.exps=new o}(),drama.plugins_.xfsteam=function(t){this.runtime=t},function(){var s={NAME:"name",DESC:"desc",HIDDEN:"hidden"},t=drama.plugins_.xfsteam.prototype;t.Type=function(t){this.plugin=t,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t){this.type=t,this.runtime=t.runtime};var e=t.Instance.prototype;function i(){}function n(){}function r(){}e.onCreate=function(){this.initState=!1,this.clientState=!1,this.statUploadState=!1,this.statMap={},this.achievements={},this.unLockCount=0,this.syncQuit=this.properties[0],this.avatar="",this.steamInit(),this.runtime.tickMe(this)},e.tick=function(){var e=this;this.runtime.all_global_vars.map(function(t){if(e.statMap[t.name]&&t.data!==e.statMap[t.name].preVal)window.steam.greenworks.setStat(e.statMap[t.name].apiName,t.data),e.statMap[t.name].preVal=t.data})},e.steamInit=function(){if(this.runtime.isElectron){if(window.steam)if(window.steam.greenworks.isSteamRunning())if(window.steam.greenworks.initAPI()){var e=this;window.steam.greenworks.on("steam-shutdown",function(){window.steam.greenworks.shutdown(),window.electron.app.quit()}),this.getAchievements();try{var t=window.steam.greenworks.getSteamId().getRawSteamID();window.steam.greenworks.requestUserInformation(t,!1);var i=window.steam.greenworks.getMediumFriendAvatar(t);window.steam.greenworks.Utils.getImageFromHandle(i).then(function(t){e.avatar=t})}catch(t){console.error(t.message)}}else console.log("Steam initialization failed");else console.log("Steam initialization failed. Steam is not running.")}else console.log("steam初始化失败：运行环境必须在electron下")},e.getAchievements=function(){var r=this,o=window.steam.greenworks.getAchievementNames();this.unLockCount=0,o.map(function(i,n){window.steam.greenworks.getAchievement(i,function(t){r.achievements[i]={name:window.steam.greenworks.getAchievementDisplayAttribute(i,s.NAME),desc:window.steam.greenworks.getAchievementDisplayAttribute(i,s.DESC),isHidden:"0"!==window.steam.greenworks.getAchievementDisplayAttribute(i,s.HIDDEN),isAchieved:t,icon:""};try{var e=window.steam.greenworks.getAchievementIcon(i);window.steam.greenworks.Utils.getImageFromHandle(e).then(function(t){r.achievements[i].icon=t})}catch(t){console.error(t.message)}if(t)r.unLockCount++;if(n==o.length-1)r.initState=!0},function(t){console.log("Failed to get achievement.",t)})})},i.prototype.achievementState=function(t,e){if(!this.achievements[t])return!1;else return this.achievements[t].isAchieved==!e},i.prototype.compareCompletedAchievement=function(t,e){return drama.do_cmp(this.unLockCount,t,e)},i.prototype.steamEnv=function(t){return this.runtime.isElectron==!t},i.prototype.steamInitState=function(t){return this.initState==!t},i.prototype.steamClientState=function(t){return this.clientState==!t},i.prototype.statUploadState=function(t){return this.statUploadState==!t},t.cnds=new i,n.prototype.activateAchievement=function(t){if(this.initState){var e=this;window.steam.greenworks.activateAchievement(t,function(){console.log("Activating achievement successfully"),e.getAchievements()},function(t){console.log("Failed on activating achievement.",t)})}},n.prototype.indicateAchievementProgress=function(t,e,i){if(this.initState)if(e!=i)window.steam.greenworks.indicateAchievementProgress(t,e,i);else console.log("成就进度当前值不能与目标值相同。")},n.prototype.resetAllStats=function(t){if(this.initState){window.steam.greenworks.resetAllStats(Boolean(t));var i=this;this.runtime.all_global_vars.map(function(t){if(i.statMap[t.name]){var e=window.steam.greenworks.getStatInt(i.statMap[t.name].apiName);if(null==e)e=window.steam.greenworks.getStatFloat(i.statMap[t.name].apiName);t.data=e}}),this.getAchievements()}},n.prototype.resetAllAchievement=function(){if(this.initState){var e=this;window.steam.greenworks.getAchievementNames().map(function(t){window.steam.greenworks.clearAchievement(t,function(){e.getAchievements()},function(t){console.log("Failed to get achievement.",t)})})}},n.prototype.resetAchievement=function(t){if(this.initState){var e=this;window.steam.greenworks.clearAchievement(t,function(){console.log("clear achievement successfully"),e.getAchievements()},function(t){console.log("Failed on clear achievement.",t)})}},n.prototype.bindVariable=function(e,i){if(this.initState){var n=this;this.runtime.all_global_vars.map(function(t){if(t.name==e&&0==t.vartype)n.statMap[e]={apiName:i,preVal:null}})}},n.prototype.unBindVariable=function(t,e){delete this.statMap[t]},n.prototype.storeStats=function(){if(this.initState){var e=this;window.steam.greenworks.storeStats(function(t){console.log("store stats successfully"),e.statUploadState=!0,e.runtime.trigger(drama.plugins_.xfsteam.prototype.cnds.statUploadState,e)},function(t){console.log("Failed on store stats.",t),e.statUploadState=!1,e.runtime.trigger(drama.plugins_.xfsteam.prototype.cnds.statUploadState,e)})}},n.prototype.quit=function(){if(this.runtime.isElectron)window.electron.app.quit()},t.acts=new n,r.prototype.getUnlockAchievementSize=function(t){t.set_float(this.unLockCount)},r.prototype.getAllVisibleAchievementSize=function(t){var e=0;for(var i in this.achievements)if(!this.achievements[i].isHidden)e++;t.set_float(e)},r.prototype.getAllAchievementSize=function(t){t.set_float(Object.keys(this.achievements).length)},r.prototype.getAchievementName=function(t,e){t.set_string(this.achievements[e].name)},r.prototype.getAchievementUrl=function(t,e){t.set_string(this.achievements[e].icon)},r.prototype.getAchievementDescribe=function(t,e){t.set_string(this.achievements[e].desc)},r.prototype.getStat=function(t,e){if(this.initState){var i=window.steam.greenworks.getStatInt(e);if(null==i)i=window.steam.greenworks.getStatFloat(e);t.set_float(i)}},r.prototype.getSteamUserNickName=function(t){if(this.initState){var e=window.steam.greenworks.getPersonaName();t.set_string(e)}},r.prototype.getSteamUserAvatar=function(t){t.set_string(this.avatar)},t.exps=new r}(),assert2(drama,"drama namespace not created"),assert2(drama.plugins_,"drama.plugins_ not created"),drama.plugins_.xfTilemap=function(t){this.runtime=t},function(){var t=drama.plugins_.xfTilemap.prototype;t.Type=function(t){this.plugin=t,this.runtime=t.runtime};var e=t.Type.prototype;e.onCreate=function(){if(!this.is_family)xf.formatAnimation(this),this.formatData(this.tilemap_data),this.cut_tiles=[],this.cut_tiles_valid=!1,this.tile_polys=[],this.tile_polys_cached=!1},e.formatData=function(t){if(this.tilemap_layers=[],this.tilemap_atlases=[],this.tilemap_objects=[],t){var e=t[0];if(e)for(var i=0,n=e.length;i<n;i++){var r=e[i];this.tilemap_layers.push({width:r[0],height:r[1],maskColor:r[2],atlasidx:r[3],data:r[4],objidx:r[5]})}var o=t[1];if(o)for(var s=0,a=o.length;s<a;s++){var l=o[s];this.tilemap_atlases.push({width:l[0],height:l[1],tileWidth:l[2],tileHeight:l[3],tileMarginX:l[4],tileMarginY:l[5],tileSpacingX:l[6],tileSpacingY:l[7],imageIndex:l[8],tileCount:l[9]})}this.tilemap_objects=t[2]}},e.cacheTilePoly=function(t,e,i,n,r,o){if(!(t<0||t>=this.tile_polys.length))if(this.tile_polys[t]){var s=this.tile_polys[t].poly,a=this.tile_polys[t].flipmap,l=new drama.CollisionPoly(s);if(l.cache_poly(e,i,0),o)l.diag();if(n)l.mirror(e/2);if(r)l.flip(i/2);a[n?1:0][r?1:0][o?1:0]=l}},e.getTilePoly=function(t){if(-1===t)return null;var e=t&m;if(e<0||e>=this.tile_polys.length)return null;if(!this.tile_polys[e])return null;var i=t&d?1:0,n=t&p?1:0,r=t&f?1:0;return this.tile_polys[e].flipmap[i][n][r]},e.freeCutTiles=function(){var t,e,i=this.runtime.glwrap;if(this.cut_tiles){if(i)for(t=0,e=this.cut_tiles.length;t<e;++t)i.deleteTexture(this.cut_tiles[t]);drama.clearArray(this.cut_tiles),this.cut_tiles_valid=!1}},e.maybeCutTiles=function(t,e,i,n,r,o,s,a){if(!this.cut_tiles_valid)if(!(e<=0||i<=0)){this.freeCutTiles();var l,c,u=0,h=0,d=this.all_frames[t];if(d)u=d.width,h=d.height,this.spriteX=d.offx,this.spriteY=d.offy,this.texture_img=d.texture_img;for(c=r;c+i<=h;c+=i+s)for(l=n;l+e<=u;l+=e+o)this.cut_tiles.push(this.CutTileImage(l,c,e,i,a));this.cut_tiles_valid=!0}},e.CutTileImage=function(t,e,i,n,r){if(this.runtime.glwrap)return this.DoCutTileImage(t,e,i,n,!1,!1,!1,r);else{var o=[[[null,null],[null,null]],[[null,null],[null,null]]];return o[0][0][0]=this.DoCutTileImage(t,e,i,n,!1,!1,!1,r),{flipmap:o,x:t,y:e,w:i,h:n}}},e.GetFlippedTileImage=function(t,e,i,n,r){if(t<0||t>=this.cut_tiles.length)return null;var o=this.cut_tiles[t],s=o.flipmap,a=e?1:0,l=i?1:0,c=n?1:0,u=s[a][l][c];if(u)return u;else return u=this.DoCutTileImage(o.x,o.y,o.w,o.h,0!==a,0!==l,0!==c,r),s[a][l][c]=u},e.DoCutTileImage=function(t,e,i,n,r,o,s,a){var l=i,c=n;if(this.runtime.glwrap&&!a){if(!drama.isPOT(l))l=drama.nextHighestPowerOfTwo(l);if(!drama.isPOT(c))c=drama.nextHighestPowerOfTwo(c)}var u=document.createElement("canvas");u.width=l,u.height=c;var h=u.getContext("2d");if(this.runtime.ctx){if(r)if(o)if(s)h.rotate(-Math.PI/2),h.scale(-1,1),h.translate(-l,-c);else h.scale(-1,-1),h.translate(-l,-c);else if(s)h.rotate(-Math.PI/2),h.translate(0,-c);else h.scale(-1,1),h.translate(-l,0);else if(o)if(s)h.rotate(-Math.PI/2),h.translate(-l,0);else h.scale(1,-1),h.translate(0,-c);else if(s)h.scale(-1,1),h.rotate(-Math.PI/2);if(h.drawImage(this.texture_img,this.spriteX+t,this.spriteY+e,i,n,0,0,l,c),a)return u;else return this.runtime.ctx.createPattern(u,"repeat")}else{assert2(this.runtime.glwrap,"If ctx not supplied, must supply glwrap"),h.drawImage(this.texture_img,this.spriteX+t,this.spriteY+e,i,n,0,0,l,c);var d=this.runtime.glwrap.createEmptyTexture(l,c,this.runtime.linearSampling,!1,!a);return this.runtime.glwrap.videoToTexture(u,d),d}},e.onLostWebGLContext=function(){if(!this.is_family)this.freeCutTiles()},e.onRestoreWebGLContext=function(){},e.loadTextures=function(){this.has_loaded_textures=!0},e.unloadTextures=function(){if(!this.is_family&&!this.instances.length&&this.has_loaded_textures)this.freeCutTiles(),this.has_loaded_textures=!1},e.preloadCanvas2D=function(t){},t.Instance=function(t){if(this.type=t,this.runtime=t.runtime,this.tilemap_exists=!0,this.recycled)this.collision_polys.length=0;else this.collision_polys=[]};var i=t.Instance.prototype,d=-2147483648,p=1073741824,f=536870912,m=536870911;function u(){this.id=-1,this.tileid=-1,this.horiz_flip=!1,this.vert_flip=!1,this.diag_flip=!1,this.any_flip=!1,this.rc=new drama.rect(0,0,0,0)}var h=[];function C(t){if(h.length<1e4)h.push(t)}function n(){this.id=-1,this.rc=new drama.rect(0,0,0,0),this.poly=null}var r=[];function O(){if(r.length)return r.pop();else return new n}function P(t){if(r.length<1e4)r.push(t)}var o=[];function l(t,e,i){var n;if(o.length)return(n=o.pop()).inst=t,n.x=e,n.y=i,n.left=n.x*n.inst.cell_cols*n.inst.cellwidth,n.top=n.y*n.inst.cell_rows*n.inst.cellheight,n.clear(),n.quadmap_valid=!1,n;else return new a(t,e,i)}function s(t){var e,i;for(e=0,i=t.quads.length;e<i;++e)C(t.quads[e]);for(drama.clearArray(t.quads),e=0,i=t.collision_rects.length;e<i;++e)P(t.collision_rects[e]);if(drama.clearArray(t.collision_rects),o.length<1e3)o.push(t)}function a(t,e,i){var n,r,o,s,a;for(this.inst=t,this.x=e,this.y=i,this.left=this.x*this.inst.cell_cols*this.inst.cellwidth,this.top=this.y*this.inst.cell_rows*this.inst.cellheight,this.tiles=[],this.quads=[],this.collision_rects=[],this.quadmap_valid=!1,n=0,r=this.inst.cell_rows;n<r;++n){for(a=[],o=0,s=this.inst.cell_cols;o<s;++o)a.push(-1);this.tiles.push(a)}}a.prototype.clear=function(){var t,e,i,n,r;for(this.tiles.length=this.inst.cell_rows,t=0,e=this.tiles.length;t<e;++t){if(!(r=this.tiles[t]))r=[],this.tiles[t]=r;for(r.length=this.inst.cell_cols,i=0,n=r.length;i<n;++i)r[i]=-1}},a.prototype.renderItem=function(t,e,i,n,r,o,s,a,l){var c=t[i];if(-1===c)if(r)this.quads.push(r),r=null;if(n||!r||c!==r.id||o!=a||s!=l){if(r)this.quads.push(r);if((r=function(){if(h.length)return h.pop();else return new u}()).id=c,r.tileid=c&m,r.horiz_flip=0!=(c&d),r.vert_flip=0!=(c&p),r.diag_flip=0!=(c&f),r.any_flip=r.horiz_flip||r.vert_flip||r.diag_flip,1==this.inst.orientation)r.rc.left=i*a+this.left+this.inst.imagesetDrawOffsetX,r.rc.top=e*l+this.top-(s-l)+this.inst.imagesetDrawOffsetY,r.rc.right=r.rc.left+o,r.rc.bottom=r.rc.top+s;else if(2==this.inst.orientation)r.rc.left=(i-e)*a/2+this.left+this.inst.mapXOrigin-this.inst.cellwidth/2+this.inst.imagesetDrawOffsetX,r.rc.top=(i+e)*l/2+this.top-(this.inst.tileheight-this.inst.cellheight)+this.inst.imagesetDrawOffsetY,r.rc.right=r.rc.left+o,r.rc.bottom=r.rc.top+s}else r.rc.right+=o;return r},a.prototype.maybeBuildQuadMap=function(){if(!this.quadmap_valid){var t=this.inst.tilewidth,e=this.inst.tileheight,i=this.inst.cellwidth,n=this.inst.cellheight;if(!(i<=0||n<=0)){var r,o,s,a,l,c,u,h,d,p,f;for(r=0,s=this.quads.length;r<s;++r)C(this.quads[r]);for(r=0,s=this.collision_rects.length;r<s;++r)P(this.collision_rects[r]);drama.clearArray(this.quads),drama.clearArray(this.collision_rects);var m=Math.min(this.inst.mapwidth,Math.floor(this.inst.width/i)),g=Math.min(this.inst.mapheight,Math.floor(this.inst.height/n));if(m-=this.left/i,g-=this.top/n,m>this.inst.cell_cols)m=this.inst.cell_cols;if(g>this.inst.cell_rows)g=this.inst.cell_rows;var y=this.inst.seamless,v=null;l=g,u=m;var b=this.inst.renderOrder;if(3==b)for(a=0;a<l;++a){for(h=this.tiles[a],c=0;c<u;++c)v=this.renderItem(h,a,c,y,v,t,e,i,n);if(v)this.quads.push(v),v=null}else if(2==b)for(a=0;a<l;++a){for(h=this.tiles[a],c=u-1;0<=c;c--)v=this.renderItem(h,a,c,y,v,t,e,i,n);if(v)this.quads.push(v),v=null}else if(1==b)for(a=l-1;0<=a;a--){for(h=this.tiles[a],c=0;c<u;++c)v=this.renderItem(h,a,c,y,v,t,e,i,n);if(v)this.quads.push(v),v=null}else if(0==b)for(a=l-1;0<=a;a--){for(h=this.tiles[a],c=u-1;0<=c;c--)v=this.renderItem(h,a,c,y,v,t,e,i,n);if(v)this.quads.push(v),v=null}var _,w,x,S,I=null,T=!1;for(a=0,l=g;a<l;++a){for(h=this.tiles[a],c=0,u=m;c<u;++c)if(-1!==(d=h[c]))if(_=this.inst.type.getTilePoly(d),!I||_||T||t!=i||e!=n){if(I)this.collision_rects.push(I),I=null;assert2(-1!==d,"Creating collision rect for empty tile"),(I=O()).id=d,I.poly=_||null,(w=I.rc).left=c*i+this.left,w.top=a*n+this.top,w.right=w.left+t,w.bottom=w.top+e,T=!!_}else I.rc.right+=t;else if(I)this.collision_rects.push(I),I=null,T=!1;if(I)this.collision_rects.push(I),I=null,T=!1}if(!y)for(s=this.quads.length,r=0;r<s;++r)for(f=this.quads[r],o=r+1;o<s;++o)if(!((p=this.quads[o]).rc.top<f.rc.bottom)){if(p.rc.top>f.rc.bottom)break;if(p.rc.right>f.rc.right||p.rc.left>f.rc.left)break;if(p.id===f.id&&p.rc.left===f.rc.left&&p.rc.right===f.rc.right)C(this.quads[o]),this.quads.splice(o,1),--s,f.rc.bottom+=e,--o}for(s=this.collision_rects.length,r=0;r<s;++r)if(!(f=this.collision_rects[r]).poly)for(S=f.rc,o=r+1;o<s;++o)if(!((x=(p=this.collision_rects[o]).rc).top<S.bottom)){if(x.top>S.bottom)break;if(x.right>S.right||x.left>S.left)break;if(!p.poly)if(x.left===S.left&&x.right===S.right)P(this.collision_rects[o]),this.collision_rects.splice(o,1),--s,S.bottom+=e,--o}this.quadmap_valid=!0}}},a.prototype.setTileAt=function(t,e,i){if(this.tiles[e][t]!==i)this.tiles[e][t]=i,this.quadmap_valid=!1,this.inst.any_quadmap_changed=!0,this.inst.physics_changed=!0,this.inst.runtime.redraw=!0},i.onCreate=function(){var t,e;assert2(this.tilemap_exists,"No tilemap exists for tilemap object"),this.layeridx=this.properties[0],this.objectidx=this.properties[1],this.renderOrder=this.properties[2],this.maskcolor=this.properties[3],this.visible=this.properties[4],this.collisionsEnabled=this.properties[5],this.cellwidth=this.properties[6],this.cellheight=this.properties[7],this.tilewidth=this.properties[8],this.tileheight=this.properties[9],this.tilexoffset=this.properties[10],this.tileyoffset=this.properties[11],this.tilexspacing=this.properties[12],this.tileyspacing=this.properties[13],this.mapXOrigin=this.properties[14],this.imagesetDrawOffsetX=this.properties[15],this.imagesetDrawOffsetY=this.properties[16],this.seamless=!0,this.lastwidth=this.width,this.lastheight=this.height,this.show_collision_polys=!1,this.orientation=this.properties[17];var i=this.cellwidth,n=this.cellheight;if(0===i)i=1;if(0===n)n=1;if(this.cell_cols=Math.ceil(this.runtime.original_width/i),this.cell_rows=Math.ceil(this.runtime.original_height/n),this.layer_data=this.type.tilemap_layers[this.layeridx],this.atlas_data=this.type.tilemap_atlases[this.layer_data.atlasidx],this.poly_datas=this.type.tilemap_objects[this.objectidx].objects,this.objectOffsetX=this.type.tilemap_objects[this.objectidx].offsetx,this.objectOffsetY=this.type.tilemap_objects[this.objectidx].offsety,this.object_layer_datas=[],this.type.tilemap_objects[this.objectidx].tiles)this.object_layer_datas=this.type.tilemap_objects[this.objectidx].tiles;if(!this.type.tile_polys_cached)for(this.type.tile_polys_cached=!0,t=0,e=this.type.tile_polys.length;t<e;++t)if(this.type.tile_polys[t])this.type.cacheTilePoly(t,i,n,!1,!1,!1),this.type.cacheTilePoly(t,i,n,!1,!1,!0),this.type.cacheTilePoly(t,i,n,!1,!0,!1),this.type.cacheTilePoly(t,i,n,!1,!0,!0),this.type.cacheTilePoly(t,i,n,!0,!1,!1),this.type.cacheTilePoly(t,i,n,!0,!1,!0),this.type.cacheTilePoly(t,i,n,!0,!0,!1),this.type.cacheTilePoly(t,i,n,!0,!0,!0);if(!this.recycled)this.tilecells=[];else this.isClipCollisionPoly=!1;if(this.mapwidth=this.layer_data.width,this.mapheight=this.layer_data.height,this.cell_cols<=this.mapwidth)this.cell_cols=this.mapwidth;if(this.cell_rows<=this.mapheight)this.cell_rows=this.mapheight;this.lastwidth=this.width,this.lastheight=this.height,this.maybeResizeTilemap(!0),this.setTilesFromRLECSV(this.layer_data.data),this.type.maybeCutTiles(this.atlas_data.imageIndex,this.tilewidth,this.tileheight,this.tilexoffset,this.tileyoffset,this.tilexspacing,this.tileyspacing,this.seamless),this.cutPoints=[],this.cutTilesPoint(this.atlas_data.imageIndex,this.tilewidth,this.tileheight,this.tilexoffset,this.tileyoffset,this.tilexspacing,this.tileyspacing,this.seamless),this.physics_changed=!1,this.any_quadmap_changed=!0,this.maybeBuildAllQuadMap(),this.runtime.tickMe(this),this.renderObjects(),this.runtime.tickMe(this)},i.cutTilesPoint=function(t,e,i,n,r,o,s,a){if(!(e<=0||i<=0)){var l,c,u=this.atlas_data.width,h=this.atlas_data.height;for(c=r;c+i<=h;c+=i+s)for(l=n;l+e<=u;l+=e+o){var d={};d.x=l,d.y=c,this.cutPoints.push(d)}}},i.renderObjects=function(){var e=this,t=this.object_layer_datas;this.container=new xf.xfContainer,this.container.x=this.x,this.container.y=this.y,t.map(function(t){e.renderObjectsItem(t)})},i.renderObjectsItem=function(t){var e=t.gid,i=!1,n=!1,r=new xf.xfContainer,o=new xf.xfImage,s=t.x,a=t.y,l=0,c=0,u=this.tilewidth,h=this.tileheight,d=t.width,p=t.height;if(0<e.indexOf("v"))n=!0,e=e.replace("v","");if(0<e.indexOf("h"))i=!0,e=e.replace("h","");if(r.addChild(o),r.width=u,r.height=h,o.source=this.type.texture_img,o.fillMode=xf.FillMode.CLIP,o.setClip(this.cutPoints[e-1].x,this.cutPoints[e-1].y,u,h,this.type.texture_pixelformat),1==this.orientation)l=this.imagesetDrawOffsetX,c=this.imagesetDrawOffsetY,r.anchorOffsetX=-l,r.anchorOffsetY=h-c;else if(2==this.orientation){var f=t.x/this.cellheight,m=t.y/this.cellheight;s=(f-m)*this.cellwidth/2+this.mapXOrigin+this.objectOffsetX,a=(f+m)*this.cellheight/2+this.objectOffsetY,l=this.imagesetDrawOffsetX,c=this.imagesetDrawOffsetY,r.anchorOffsetX=u/2-l,r.anchorOffsetY=h-c}if(r.scale.x=d/u,r.scale.y=p/h,r.x=s,r.y=a,o.width=u,o.height=h,o.anchorOffsetX=d/2,o.anchorOffsetY=p/2,o.x+=d/2,o.y+=p/2,i)o.scale.x=-1;if(n)o.scale.y=-1;r.visible=t.visible,r.angle=t.rotation,this.container.addChild(r)},i.maybeBuildAllQuadMap=function(){if(this.any_quadmap_changed){var t,e,i,n,r;for(t=0,e=this.tilecells.length;t<e;++t)for(i=0,n=(r=this.tilecells[t]).length;i<n;++i)r[i].maybeBuildQuadMap();this.any_quadmap_changed=!1}},i.setAllQuadMapChanged=function(){var t,e,i,n,r;for(t=0,e=this.tilecells.length;t<e;++t)for(i=0,n=(r=this.tilecells[t]).length;i<n;++i)r[i].quadmap_valid=!1;this.any_quadmap_changed=!0},i.maybeResizeTilemap=function(t){var e=drama.floor(this.width/this.cellwidth),i=drama.floor(this.height/this.cellheight);if(!(e<=this.mapwidth&&i<=this.mapheight)||t){var n,r,o,s,a;if(t)n=Math.ceil(this.mapheight/this.cell_rows),r=Math.ceil(this.mapwidth/this.cell_cols);else{if(n=this.tilecells.length,r=Math.ceil(this.mapwidth/this.cell_cols),i>this.mapheight)this.mapheight=i,n=Math.ceil(this.mapheight/this.cell_rows);if(e>this.mapwidth)this.mapwidth=e,r=Math.ceil(this.mapwidth/this.cell_cols);this.setAllQuadMapChanged(),this.physics_changed=!0,this.runtime.redraw=!0}for(o=0;o<n;++o)if(!(a=this.tilecells[o])){for(a=[],s=0;s<r;++s)a.push(l(this,s,o));this.tilecells[o]=a}else for(s=a.length;s<r;++s)a.push(l(this,s,o))}},i.cellAt=function(t,e){if(t<0||e<0)return null;var i=drama.floor(e/this.cell_rows);if(i>=this.tilecells.length)return null;var n=this.tilecells[i],r=drama.floor(t/this.cell_cols);if(r>=n.length)return null;else return n[r]},i.cellAtIndex=function(t,e){if(t<0||e<0||e>=this.tilecells.length)return null;var i=this.tilecells[e];if(t>=i.length)return null;else return i[t]},i.setTilesFromRLECSV=function(t){var e=function(t){var e=[];if(null==t)t="";var i,n,r,o,s,a,l,c=t.split(",");for(i=0,n=c.length;i<n;++i)if(-1<(o=(r=c[i]).indexOf("x"))){if(s=parseInt(r.substring(0,o),10),l=r.substring(o+1),a=parseInt(l,10),-1<l.indexOf("h"))a|=d;if(-1<l.indexOf("v"))a|=p;if(-1<l.indexOf("d"))a|=f;for(;0<s;--s)e.push(a)}else{if(a=parseInt(r,10),-1<r.indexOf("h"))a|=d;if(-1<r.indexOf("v"))a|=p;if(-1<r.indexOf("d"))a|=f;e.push(a)}return e}(t);this.tileStream=e;var i,n,r,o,s=0;for(i=0;i<this.mapheight;++i)for(n=0;n<this.mapwidth;++n)if(r=e[s++],o=this.cellAt(n,i))o.setTileAt(n%this.cell_cols,i%this.cell_rows,r)},i.getTilesAsRLECSV=function(){var t="";if(this.mapwidth<=0||this.mapheight<=0)return t;var e,i,n,r,o,s,a,l,c,u=1,h=this.getTileAt(0,0);for(r=drama.floor(this.width/this.cellwidth),i=drama.floor(this.height/this.cellheight),e=0;e<i;++e)for(n=0===e?1:0;n<r;++n)if((o=this.getTileAt(n,e))===h)++u;else{if(-1===h)c=l=a=!(s=-1);else s=h&m,a=0!=(h&d),l=0!=(h&p),c=0!=(h&f);if(1===u)t+=""+s;else t+=u+"x"+s;if(a)t+="h";if(l)t+="v";if(c)t+="d";t+=",",u=1,h=o}if(-1===h)c=l=a=!(s=-1);else s=h&m,a=0!=(h&d),l=0!=(h&p),c=0!=(h&f);if(1===u)t+=""+s;else t+=u+"x"+s;if(a)t+="h";if(l)t+="v";if(c)t+="d";return t},i.getTileAt=function(t,e){if(t=Math.floor(t),e=Math.floor(e),t<0||e<0||t>=this.mapwidth||e>=this.mapheight)return-1;var i=this.cellAt(t,e);if(!i)return-1;else return i.tiles[e%this.cell_rows][t%this.cell_cols]},i.setTileAt=function(t,e,i){if(t=Math.floor(t),e=Math.floor(e),t<0||e<0||t>=this.mapwidth||e>=this.mapheight)return-1;var n=this.cellAt(t,e);if(!n)return-1;n.setTileAt(t%this.cell_cols,e%this.cell_rows,i)},i.worldToCellX=function(t){return Math.floor((t-this.x)/(this.cell_cols*this.cellwidth))},i.worldToCellY=function(t){return Math.floor((t-this.y)/(this.cell_rows*this.cellheight))},i.worldToTileX=function(t){return Math.floor((t-this.x)/this.tilewidth)},i.worldToTileY=function(t){return Math.floor((t-this.y)/this.tileheight)},i.getCollisionRectCandidates=function(t,e){var i,n,r,o=this.worldToCellX(t.left),s=this.worldToCellY(t.top),a=this.worldToCellX(t.right),l=this.worldToCellY(t.bottom);for(i=o;i<=a;++i)for(n=s;n<=l;++n)if(r=this.cellAtIndex(i,n))r.maybeBuildQuadMap(),drama.appendArray(e,r.collision_rects)},i.testPointOverlapTile=function(t,e){var i=this.worldToTileX(t),n=this.worldToTileY(e),r=this.getTileAt(i,n);if(-1===r)return!1;var o=this.type.getTilePoly(r);if(!o)return!0;else return t-=Math.floor((t-this.x)/this.tilewidth)*this.tilewidth+this.x,e-=Math.floor((e-this.y)/this.tileheight)*this.tileheight+this.y,o.contains_pt(t,e)},i.addPolys=function(t){for(var e=0,i=t.length;e<i;e++){var n=t[e],r=xf.constructPoly(n,this.width,this.height,this.angle);this.collision_polys.push(r)}},i.clipCollisionPoly=function(){if(!this.isClipCollisionPoly){this.isClipCollisionPoly=!0;var t=this.poly_datas;this.collision_polys.length=0;var e=new xf.Rect.create;if(e.setTo(0,0,this.bbox.width()>>0,this.bbox.height()>>0),t&&t.length)for(var i=0,n=t.length;i<n;i++){var r=t[i],o=e.polygonClip(r);if(0===o.length)if(e.contains(r[0],r[1])){var s=xf.constructPoly(r,e.width,e.height,this.angle);this.collision_polys.push(s)}else{if(xf.constructPoly(r,e.width,e.height,this.angle).contains_pt(0,0)){var a=new drama.CollisionPoly([0,0,0,1,1,1,1,0]);a.cache_poly(e.width,e.height,this.angle),this.collision_polys.push(a)}}else this.addPolys(o)}e.destory()}},i.getAllCollisionRects=function(t){var e,i,n,r,o,s;for(e=0,i=this.tilecells.length;e<i;++e)for(n=0,r=(o=this.tilecells[e]).length;n<r;++n)(s=o[n]).maybeBuildQuadMap(),drama.appendArray(t,s.collision_rects)},i.onDestroy=function(){var t,e,i,n,r;for(t=0,e=this.tilecells.length;t<e;++t){for(i=0,n=(r=this.tilecells[t]).length;i<n;++i)s(r[i]);drama.clearArray(r)}drama.clearArray(this.tilecells)},i.saveToJSON=function(){return this.maybeResizeTilemap(),{w:drama.floor(this.width/this.cellwidth),h:drama.floor(this.height/this.cellheight),d:this.getTilesAsRLECSV()}},i.loadFromJSON=function(t){this.mapwidth=t.w,this.mapheight=t.h,this.maybeResizeTilemap(!0),this.setTilesFromRLECSV(t.d),this.physics_changed=!0,this.setAllQuadMapChanged()},i.draw=function(t){if(!(this.cellwidth<=0||this.cellheight<=0)){if(this.type.maybeCutTiles(this.atlas_data.imageIndex,this.tilewidth,this.tileheight,this.tilexoffset,this.tileyoffset,this.tilexspacing,this.tileyspacing,this.seamless),this.width!==this.lastwidth||this.height!==this.lastheight)this.physics_changed=!0,this.setAllQuadMapChanged(),this.maybeBuildAllQuadMap(),this.lastwidth=this.width,this.lastheight=this.height;t.globalAlpha=this.opacity;var e,i=this.layer,n=i.viewLeft,r=i.viewTop,o=i.viewRight,s=i.viewBottom,a=this.x,l=this.y,c=this.seamless;if(this.runtime.pixel_rounding)a=Math.round(a),l=Math.round(l);var u,h,d,p,f,m,g,y,v,b,_,w=this.cell_cols*this.cellwidth,x=this.cell_rows*this.cellheight,S=Math.floor((n-a)/w),I=Math.floor((o-a)/w),T=Math.floor((r-l)/x),C=Math.floor((s-l)/x),O=a%this.cellwidth,P=l%this.cellheight;if(this.seamless)P=O=0;if(0!==O||0!==P)t.save(),t.translate(O,P),a-=O,l-=P,n-=O,r-=P,o-=O,s-=P;for(u=S;u<=I;++u)for(h=T;h<=C;++h)if(d=this.cellAtIndex(u,h))for(d.maybeBuildQuadMap(),p=0,f=d.quads.length;p<f;++p)if(-1!==(m=d.quads[p]).id)if(g=(e=m.rc).left+a,y=e.top+l,v=e.right+a,b=e.bottom+l,!(o<g||v<n||s<y||b<r))if(_=this.type.GetFlippedTileImage(m.tileid,m.horiz_flip,m.vert_flip,m.diag_flip,this.seamless),c)t.drawImage(_,g,y);else t.fillStyle=this.type.GetFlippedTileImage(m.tileid,m.horiz_flip,m.vert_flip,m.diag_flip,this.seamless),t.fillRect(g,y,v-g,b-y);if(0!==O||0!==P)t.restore()}};var V=new drama.rect(0,0,1,1);function c(){}function g(t){switch(t){case 0:return 0;case 1:return d;case 2:return p;case 3:return d|f;case 4:return d|p;case 5:return p|f;case 6:return d|p|f;case 7:return f;default:return 0}}function y(){}function v(){}i.drawGL_earlyZPass=function(t){this.drawGL(t)},i.drawGL=function(t){if(!(this.cellwidth<=0||this.cellheight<=0)){if(this.type.maybeCutTiles(this.atlas_data.imageIndex,this.tilewidth,this.tileheight,this.tilexoffset,this.tileyoffset,this.tilexspacing,this.tileyspacing,this.seamless),this.width!==this.lastwidth||this.height!==this.lastheight)this.physics_changed=!0,this.setAllQuadMapChanged(),this.maybeBuildAllQuadMap(),this.lastwidth=this.width,this.lastheight=this.height;t.setOpacity(this.opacity);var e,i=this.type.cut_tiles,n=this.layer,r=n.viewLeft,o=n.viewTop,s=n.viewRight,a=n.viewBottom,l=this.x,c=this.y;if(this.runtime.pixel_rounding)l=Math.round(l),c=Math.round(c);var u,h,d,p,f,m,g,y,v,b,_,w,x,S,I,T,C,O,P,E=this.cell_cols*this.cellwidth,A=this.cell_rows*this.cellheight,k=Math.floor((r-l)/E),M=Math.floor((s-l)/E),R=Math.floor((o-c)/A),L=Math.floor((a-c)/A);for(C=k;C<=M;++C)for(O=R;O<=L;++O)if(P=this.cellAtIndex(C,O))for(P.maybeBuildQuadMap(),u=0,h=P.quads.length;u<h;++u)if(-1!==(d=P.quads[u]).id)if(p=(e=d.rc).left+l,f=e.top+c,m=e.right+l,g=e.bottom+c,!(s<p||m<r||a<f||g<o))if(t.setTexture(i[d.tileid]),V.right=(m-p)/this.tilewidth,V.bottom=(g-f)/this.tileheight,d.any_flip){if(v=y=0,b=V.right,_=0,w=V.right,x=V.bottom,S=0,I=V.bottom,d.diag_flip){T=y,y=b,b=w,w=S,S=T,T=v,v=_,_=x,x=I,I=T;var D=m-p,N=g-f,B=new drama.rect(p,f,m,g),F=new drama.quad,j=0,G=0;if(1==this.orientation)j=this.cellheight,G=this.cellheight;else if(2==this.orientation)G=j=N;F.set_from_rect(B),B.set(p+.5*j,f+.5*G,p+D+.5*j,f+N+.5*G),B.offset(-(p+.5*j),-(f+.5*G)),B.offset(-.5*j,-.5*G),F.set_from_rotated_rect(B,-.5*Math.PI),F.offset(p+.5*j,f+.5*G),F.bounding_box(B),B.normalize(),p=B.left,f=B.top,m=B.right,g=B.bottom}if(d.horiz_flip)T=y,y=b,b=T,T=v,v=_,_=T,T=S,S=w,w=T,T=I,I=x,x=T;if(d.vert_flip)T=y,y=S,S=T,T=v,v=I,I=T,T=b,b=w,w=T,T=_,_=x,x=T;t.quadTexUV(p,f,m,f,m,g,p,g,y,v,b,_,w,x,S,I)}else t.quadTex(p,f,m,f,m,g,p,g,V);this.container.drawGL(t,this.runtime)}},i.getDebuggerValues=function(t){var e,i,n,r,o,s,a=0,l=0;for(e=0,i=this.tilecells.length;e<i;++e)for(r=0,o=(n=this.tilecells[e]).length;r<o;++r)a+=(s=n[r]).quads.length,l+=s.collision_rects.length;t.push({title:"xfTilemap",properties:[{name:"Tile width",value:this.tilewidth,readonly:!0},{name:"Tile height",value:this.tileheight,readonly:!0},{name:"Draw rects",value:a,readonly:!0},{name:"Collision rects",value:l,readonly:!0},{name:"Show Collision rects",value:this.show_collision_polys}]})},i.onDebugValueEdited=function(t,e,i){if("Show Collision rects"===e)if(this.show_collision_polys=i){if(!this.polyImage){var n=new xf.xfImage;n.name="碰撞调试图片",n.width=this.width,n.height=this.height,n.updateTransform(),this.polyImage=n;var r=xf.createCanvas(this.width,this.height),o=r.getContext("2d");o.save(),o.globalAlpha=.5,o.fillStyle="red";for(var s=0,a=this.collision_polys.length;s<a;s++){for(var l=this.collision_polys[s].pts_cache,c=0,u=l.length;c<u;c+=2)if(0===c)o.moveTo(l[c],l[c+1]);else o.lineTo(l[c],l[c+1]);o.fill()}o.restore(),this.polyImage.source=r}this.polyImage.addRenderList()}else if(this.polyImage)this.polyImage.removeRenderList()},i.tick=function(){if(this.container.x!=this.x)this.container.x=this.x;if(this.container.y!=this.y)this.container.y=this.y;if(this.polyImage){var t=this.layer,e=t.viewLeft,i=t.viewTop;this.polyImage.x=-e+this.x,this.polyImage.y=-i+this.y,this.polyImage.updateTransform()}},c.prototype.CompareTileAt=function(t,e,i,n){var r=this.getTileAt(t,e);if(-1!==r)r&=m;return drama.do_cmp(r,i,n)},c.prototype.CompareTileStateAt=function(t,e,i){var n=this.getTileAt(t,e),r=0;if(-1!==n)r=3758096384&n;return r===g(i)},c.prototype.IsCollisionEnabled=function(){return this.collisionsEnabled},t.cnds=new c,y.prototype.EraseTile=function(t,e){this.maybeResizeTilemap(),this.setTileAt(t,e,-1)},y.prototype.SetTile=function(t,e,i,n){this.maybeResizeTilemap();var r=i&m|g(n),o=this.atlas_data.tileCount-1;if(o<0||o<i)r=-1;this.setTileAt(t,e,r)},y.prototype.SetTileState=function(t,e,i){var n=this.getTileAt(t,e);if(-1!==n)this.maybeResizeTilemap(),this.setTileAt(t,e,n&m|g(i))},y.prototype.EraseTileRange=function(t,e,i,n){var r,o,s=Math.floor(drama.max(t,0)),a=Math.floor(drama.max(e,0)),l=Math.floor(drama.min(t+i,this.mapwidth)),c=Math.floor(drama.min(e+n,this.mapheight));for(o=a;o<c;++o)for(r=s;r<l;++r)this.setTileAt(r,o,-1)},y.prototype.SetTileRange=function(t,e,i,n,r,o){this.maybeResizeTilemap();var s,a,l=Math.floor(drama.max(t,0)),c=Math.floor(drama.max(e,0)),u=Math.floor(drama.min(t+i,this.mapwidth)),h=Math.floor(drama.min(e+n,this.mapheight)),d=r&m|g(o),p=this.atlas_data.tileCount-1;if(p<0||p<r)d=-1;for(a=c;a<h;++a)for(s=l;s<u;++s)this.setTileAt(s,a,d)},y.prototype.SetTileStateRange=function(t,e,i,n,r){this.maybeResizeTilemap();var o,s,a,l=Math.floor(drama.max(t,0)),c=Math.floor(drama.max(e,0)),u=Math.floor(drama.min(t+i,this.mapwidth)),h=Math.floor(drama.min(e+n,this.mapheight)),d=g(r);for(s=c;s<h;++s)for(o=l;o<u;++o)if(-1!==(a=this.getTileAt(o,s)))this.setTileAt(o,s,a&m|d)},y.prototype.LoadFromJSON=function(t){var e;try{e=JSON.parse(t)}catch(t){return}if(e.xftilemap)this.mapwidth=e.width,this.mapheight=e.height,this.maybeResizeTilemap(!0),this.setTilesFromRLECSV(e.data),this.setAllQuadMapChanged(),this.physics_changed=!0},y.prototype.JSONDownload=function(t){var e=document.createElement("a"),i={xftilemap:!0,width:this.mapwidth,height:this.mapheight,data:this.getTilesAsRLECSV()};if(void 0===e.download){var n="data:text/html,"+encodeURIComponent("<p><a download='data.json' href=\"data:application/json,"+encodeURIComponent(JSON.stringify(i))+'">Download link</a></p>');window.open(n)}else{var r=document.getElementsByTagName("body")[0];e.textContent=t,e.href="data:application/json,"+encodeURIComponent(JSON.stringify(i)),e.download=t,r.appendChild(e);var o=document.createEvent("MouseEvent");o.initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),e.dispatchEvent(o),r.removeChild(e)}},t.acts=new y,v.prototype.TileAt=function(t,e,i){var n=this.getTileAt(e,i);t.set_int(-1===n?-1:n&m)},v.prototype.PositionToTileX=function(t,e){t.set_float(this.worldToTileX(e))},v.prototype.PositionToTileY=function(t,e){t.set_float(this.worldToTileY(e))},v.prototype.TileToPositionX=function(t,e){t.set_float(e*this.cellwidth+this.x+this.cellwidth/2)},v.prototype.TileToPositionY=function(t,e){t.set_float(e*this.cellheight+this.y+this.cellheight/2)},v.prototype.SnapX=function(t,e){t.set_float(Math.floor((e-this.x)/this.cellwidth)*this.cellwidth+this.x+this.cellwidth/2)},v.prototype.SnapY=function(t,e){t.set_float(Math.floor((e-this.y)/this.cellheight)*this.cellheight+this.y+this.cellheight/2)},v.prototype.TilesJSON=function(t){this.maybeResizeTilemap();var e=drama.floor(this.width/this.cellwidth),i=drama.floor(this.height/this.cellheight);t.set_string(JSON.stringify({xftilemap:!0,width:e,height:i,data:this.getTilesAsRLECSV()}))},t.exps=new v}(),assert2(drama,"drama namespace not created"),assert2(drama.plugins_,"drama.plugins_ not created"),drama.plugins_.xfAlreadyTrade=function(t){this.runtime=t},function(){var t=drama.plugins_.xfAlreadyTrade.prototype;t.Type=function(t){this.plugin=t,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t){this.type=t,this.runtime=t.runtime};var e=t.Instance.prototype;function i(){}function n(){}function r(){}e.onCreate=function(){var e=this;this.runtime.tickMe(this),xf.webApi.getPlayerPurchasedResources().then(function(t){xf.gameInfo.purchasedResources=t.list,console.log("getPlayerPurchasedResources: ",t),e.runtime.trigger(drama.plugins_.xfAlreadyTrade.prototype.cnds.getPurchasedResourceStatus,e)})},e.trigger=function(){this.runtime.trigger(drama.plugins_.xfAlreadyTrade.prototype.cnds.getPurchasedResourceStatus,this)},e.onDestroy=function(){},e.tick=function(){if(xf.gameInfo.recentlyUpdatedResource.isUpdated&&0<xf.gameInfo.purchasedResources.length)xf.gameInfo.recentlyUpdatedResource.isUpdated=!1,this.runtime.trigger(drama.plugins_.xfAlreadyTrade.prototype.cnds.getPurchasedResourceStatus,this)},e.draw=function(t){if(!this.visible)return!1},e.drawGL=function(t){if(!this.visible)return!1},i.prototype.OnItemCostSucceed=function(){return!0},i.prototype.OnItemCostFail=function(){return!0},i.prototype.OnItemUnsufficient=function(){return!0},i.prototype.getPurchasedResourceStatus=function(t){if(xf.gameInfo.purchasedResources)for(var e=0;e<xf.gameInfo.purchasedResources.length;e++){if(xf.gameInfo.purchasedResources[e].goodsId==t)return!0}if(xf.gameInfo.goodsList){var i=xf.gameInfo.goodsList.list;for(var n in i)if(i.hasOwnProperty(n)){if(i[n].goodsId==t)return!0}}return!1},t.cnds=new i,n.prototype.ConsumeItem=function(t,e){if(e<=0)this.runtime.trigger(drama.plugins_.xfAlreadyTrade.prototype.cnds.OnItemCostFail,this);else{var i=xf.gameInfo.goodsList.list;if(!i)return void this.runtime.trigger(drama.plugins_.xfAlreadyTrade.prototype.cnds.OnItemCostFail,this);for(var n in i)if(i.hasOwnProperty(n)){var r=i[n];if(r.goodsId==t){if(r.num<e)this.runtime.trigger(drama.plugins_.xfAlreadyTrade.prototype.cnds.OnItemUnsufficient,this);else r.num-=e,this.runtime.trigger(drama.plugins_.xfAlreadyTrade.prototype.cnds.OnItemCostSucceed,this),xf.serverApi.syncCharacterGoods(xf.gameInfo.goodsList);break}else this.runtime.trigger(drama.plugins_.xfAlreadyTrade.prototype.cnds.OnItemCostFail,this)}}},t.acts=new n,r.prototype.getPayitemName=function(t,e){var i=this.runtime.tradeInfo;if(i.list){var n=i.list.gameGoods;if(n)for(var r=0,o=n.length;r<o;r++)for(var s=n[r].list,a=0,l=s.length;a<l;a++){var c=s[a];if(c.goodsId===e)return void t.set_string(c.goodsName)}}t.set_string("")},r.prototype.getPayitemBalance=function(t,e){if(xf.gameInfo.goodsList){var i=xf.gameInfo.goodsList.list,n=!1;for(var r in i)if(i.hasOwnProperty(r)){var o=i[r];if(o.goodsId==e){n=!0,t.set_int(o.num);break}}}if(!n&&xf.gameInfo.purchasedResources)for(var s=0;s<xf.gameInfo.purchasedResources.length;s++){if(xf.gameInfo.purchasedResources[s].goodsId==e){n=!0,t.set_int(1);break}}if(!n)t.set_int(0)},r.prototype.getGamecoinBalance=function(t){t.set_string(xf.gameInfo.wallet.toString())},r.prototype.getGoodsStatus=function(t,e){if(xf.gameInfo.goodsList){var i=!1,n=xf.gameInfo.goodsList.list;for(var r in n)if(n.hasOwnProperty(r)){if(n[r].goodsId==e){i=!0;break}}}if(!i&&xf.gameInfo.purchasedResources)for(var o=0;o<xf.gameInfo.purchasedResources.length;o++){if(xf.gameInfo.purchasedResources[o].goodsId==e){i=!0;break}}if(i)t.set_int(1);else t.set_int(0)},t.exps=new r}(),drama.plugins_.xfDB=function(t){this.runtime=t},function(){var t=drama.plugins_.xfDB.prototype;t.Type=function(t){this.plugin=t,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t){this.type=t,this.runtime=t.runtime};var e=t.Instance.prototype;function i(){}function n(){}e.onCreate=function(){},e.stopRunning=function(){this.runtime.running_layout.stopRunning()},i.prototype.CompareCustomInstanceVar=function(t,e,i,n,r,o){if(2==t)return e.getValue()===(1===o?!0:!1);else if(1==t)return drama.do_cmp(e.getValue(),i,r);else return drama.do_cmp(e.getValue(),i,n)},t.cnds=new i,n.prototype.SetVar=function(t,e){if(assert2(!t.is_constant,"Setting a constant event variable"),0===t.vartype)if(drama.is_number(e))t.setValue(e);else t.setValue(parseFloat(e));else if(1===t.vartype)t.setValue(e.toString())},n.prototype.ResetGlobals=function(){var t,e,i;for(t=0,e=this.runtime.all_global_vars.length;t<e;t++)(i=this.runtime.all_global_vars[t]).data=i.initial},n.prototype.AddOrSubVar=function(t,e,i){if(0===e){if(0===t.vartype)if(drama.is_number(i))t.setValue(t.getValue()+i);else t.setValue(t.getValue()+parseFloat(i));else if(1===t.vartype)t.setValue(t.getValue()+i.toString())}else if(1===e)if(0===t.vartype)if(drama.is_number(i))t.setValue(t.getValue()-i);else t.setValue(t.getValue()-parseFloat(i))},n.prototype.SetOrToggleBoolVar=function(t,e){if(assert2(!t.is_constant,"设置常量事件变量"),assert2(2===t.vartype,"期望的是boolean类型"),2==e)t.setValue(!t.getValue());else t.setValue(0===e)},t.acts=new n,t.exps=new function(){}}(),assert2(drama,"drama namespace not created"),assert2(drama.plugins_,"drama.plugins_ not created"),drama.plugins_.XML=function(t){if(this.runtime=t,this.runtime.isIE){var e={};(window.XPathResult=e).NUMBER_TYPE=1,e.STRING_TYPE=2,e.UNORDERED_NODE_SNAPSHOT_TYPE=6,e.ORDERED_NODE_SNAPSHOT_TYPE=7}},function(){var t=drama.plugins_.XML.prototype;t.Type=function(t){this.plugin=t,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t){this.type=t,this.runtime=t.runtime};var e=t.Instance.prototype;function i(){}function n(){}function r(){}e.onCreate=function(){if(this.xmlDoc=null,this.nodeStack=[],this.useXfPath=!1,this.runtime.isMinigame)this.useXfPath=!0},e.xpath_eval=function(t,e,i){if(this.xmlDoc){var n=this.nodeStack.length?this.nodeStack[this.nodeStack.length-1]:this.xmlDoc.documentElement;try{if(this.runtime.isIE)if("one"==e)return n.selectSingleNode(t);else return n.selectNodes(t);else if(this.useXfPath)return window.xfSelectNodes(n,t);else return this.xmlDoc.evaluate(t,n,null,i,null)}catch(t){return null}}},e.doForEachIteration=function(t,e){this.nodeStack.push(e),this.runtime.pushCopySol(t.solModifiers),t.retrigger(),this.runtime.popSol(t.solModifiers),this.nodeStack.pop()},i.prototype.ForEach=function(t){var e,i,n=this.runtime.getCurrentEventStack().current_event,r=this.xpath_eval(t,"many",XPathResult.ORDERED_NODE_SNAPSHOT_TYPE);if(!r)return!1;else{var o=this.runtime.pushLoopStack();if(this.runtime.isIE)for(e=0,i=r.length;e<i;e++)o.index=e,this.doForEachIteration(n,r[e]);else for(i=r.snapshotLength?r.snapshotLength:r.length,e=0;e<i;e++)o.index=e,this.doForEachIteration(n,r.snapshotItem?r.snapshotItem(e):r[e]);this.runtime.popLoopStack()}return!1},t.cnds=new i,n.prototype.Load=function(t){var e,i,n=!(void 0===window.c2isWindows8||!window.c2isWindows8);try{if(n)(e=new Windows.Data.Xml.Dom.XmlDocument).loadXml(t);else if(this.runtime.isIE){for(var r=["MSXML2.DOMDocument.6.0","MSXML2.DOMDocument.3.0","MSXML2.DOMDocument"],o=0;o<3;o++)try{if(e=new window.ActiveXObject(r[o]))break}catch(t){e=null}if(e)e.async="false",e.loadXML(t)}else if(this.useXfPath)i=new DOMParser,t=t.replace(/>\s+</g,"><"),e=i.parseFromString(t);else e=(i=new DOMParser).parseFromString(t,"text/xml")}catch(t){e=null}if(e)if(this.xmlDoc=e,this.runtime.isIE&&!n)this.xmlDoc.setProperty("SelectionLanguage","XPath")},t.acts=new n,r.prototype.NumberValue=function(t,e){var i=this.xpath_eval(e,"one",XPathResult.NUMBER_TYPE);if(!i)t.set_int(0);else if(this.runtime.isIE)t.set_int(parseInt(i.nodeValue,10));else if(this.useXfPath)if(i[0]&&(i[0].data||i[0].childNodes)){var n=i[0].data;if(!n)if(i[0].childNodes)n=i[0].childNodes[0].data;else n=0;t.set_int(Number(n)||0)}else t.set_int(0);else t.set_int(i.numberValue||0)},r.prototype.StringValue=function(t,e){var i;if(/firefox/i.test(navigator.userAgent))if(!(i=this.xpath_eval(e,"one",XPathResult.ORDERED_NODE_SNAPSHOT_TYPE)))t.set_string("");else{var n,r,o="";for(n=0,r=i.snapshotLength;n<r;n++)o+=i.snapshotItem(n).textContent;t.set_string(o)}else if(!(i=this.xpath_eval(e,"one",XPathResult.STRING_TYPE)))t.set_string("");else if(this.runtime.isIE)t.set_string(i.nodeValue||i.nodeTypedValue||"");else if(this.useXfPath)if(i[0]&&(i[0].data||i[0].childNodes)){var s=i[0].data;if(!s)if(i[0].childNodes)s=i[0].childNodes[0].data;else s="";t.set_string(s||"")}else t.set_string("");else t.set_string(i.stringValue||"")},r.prototype.NodeCount=function(t,e){var i=this.xpath_eval(e,"many",XPathResult.UNORDERED_NODE_SNAPSHOT_TYPE);if(!i)t.set_int(0);else if(this.runtime.isIE)t.set_int(i.length||0);else if(this.useXfPath)t.set_int(i.length||0);else t.set_int(i.snapshotLength||0)},t.exps=new r}(),assert2(drama,"drama namespace not created"),assert2(drama.behaviors,"drama.behaviors not created"),drama.behaviors.Anchor=function(t){this.runtime=t},function(){var t=drama.behaviors.Anchor.prototype;t.Type=function(t,e){this.behavior=t,this.objtype=e,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t,e){this.type=t,this.behavior=t.behavior,this.inst=e,this.runtime=t.runtime};var e=t.Instance.prototype;function i(){}e.onCreate=function(){this.anch_left=this.properties[0],this.anch_top=this.properties[1],this.anch_right=this.properties[2],this.anch_bottom=this.properties[3],this.inst.update_bbox(),this.xleft=this.inst.bbox.left,this.ytop=this.inst.bbox.top,this.xright=this.runtime.original_width-this.inst.bbox.left,this.ybottom=this.runtime.original_height-this.inst.bbox.top,this.rdiff=this.runtime.original_width-this.inst.bbox.right,this.bdiff=this.runtime.original_height-this.inst.bbox.bottom,this.enabled=this.properties[4]},e.saveToJSON=function(){return{xleft:this.xleft,ytop:this.ytop,xright:this.xright,ybottom:this.ybottom,rdiff:this.rdiff,bdiff:this.bdiff,enabled:this.enabled}},e.loadFromJSON=function(t){this.xleft=t.xleft,this.ytop=t.ytop,this.xright=t.xright,this.ybottom=t.ybottom,this.rdiff=t.rdiff,this.bdiff=t.bdiff,this.enabled=t.enabled},e.tick=function(){if(this.enabled){var t,e=this.inst.layer,i=this.inst,n=this.inst.bbox;if(0===this.anch_left){if(i.update_bbox(),0!==(t=e.viewLeft+this.xleft-n.left))i.x+=t,i.set_bbox_changed()}else if(1===this.anch_left)if(i.update_bbox(),0!==(t=e.viewRight-this.xright-n.left))i.x+=t,i.set_bbox_changed();if(0===this.anch_top){if(i.update_bbox(),0!==(t=e.viewTop+this.ytop-n.top))i.y+=t,i.set_bbox_changed()}else if(1===this.anch_top)if(i.update_bbox(),0!==(t=e.viewBottom-this.ybottom-n.top))i.y+=t,i.set_bbox_changed();if(1===this.anch_right)if(i.update_bbox(),0!==(t=e.viewRight-this.rdiff-n.right)){if(i.width+=t,i.width<0)i.width=0;i.set_bbox_changed()}if(1===this.anch_bottom)if(i.update_bbox(),0!==(t=e.viewBottom-this.bdiff-n.bottom)){if(i.height+=t,i.height<0)i.height=0;i.set_bbox_changed()}}},t.cnds=new function(){},i.prototype.SetEnabled=function(t){if(this.enabled&&0===t)this.enabled=!1;else if(!this.enabled&&0!==t)this.inst.update_bbox(),this.xleft=this.inst.bbox.left,this.ytop=this.inst.bbox.top,this.xright=this.runtime.original_width-this.inst.bbox.left,this.ybottom=this.runtime.original_height-this.inst.bbox.top,this.rdiff=this.runtime.original_width-this.inst.bbox.right,this.bdiff=this.runtime.original_height-this.inst.bbox.bottom,this.enabled=!0},t.acts=new i,t.exps=new function(){}}(),assert2(drama,"drama namespace not created"),assert2(drama.behaviors,"drama.behaviors not created"),drama.behaviors.EightDir=function(t){this.runtime=t},function(){var g=xf.GameConst.DirectionEnum,t=drama.behaviors.EightDir.prototype;t.Type=function(t,e){this.behavior=t,this.objtype=e,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t,e){this.type=t,this.behavior=t.behavior,this.inst=e,this.runtime=t.runtime,this.upkey=!1,this.downkey=!1,this.leftkey=!1,this.rightkey=!1,this.ignoreInput=!1,this.simup=!1,this.simdown=!1,this.simleft=!1,this.simright=!1,this.lastuptick=-1,this.lastdowntick=-1,this.lastlefttick=-1,this.lastrighttick=-1,this.dx=0,this.dy=0};var e=t.Instance.prototype;function i(){}function n(){}function r(){}e.onCreate=function(){if(this.maxspeed=this.properties[0],this.acc=this.properties[1],this.dec=this.properties[2],this.directions=this.properties[3],this.angleMode=this.properties[4],this.controlType=this.properties[5],this.joystickName=this.properties[6],this.defaultControls=this.properties[7],this.enabled=this.properties[8],this.bindingAnim=this.properties[9],this.curDirection=g.NONE,this.defaultControls)if(xf.EventCenter.instance.addEventListener(xf.EventType.JOYSTICK_MOVE,this.onJoystickMove,this),xf.EventCenter.instance.addEventListener(xf.EventType.JOYSTICK_RESET,this.onJoystickReset,this),2!==this.controlType)this.keyDownHandle=this.onKeyDown.bind(this),this.keyUpHandle=this.onKeyUp.bind(this),document.addEventListener("keydown",this.keyDownHandle),document.addEventListener("keyup",this.keyUpHandle)},e.saveToJSON=function(){return{dx:this.dx,dy:this.dy,enabled:this.enabled,maxspeed:this.maxspeed,acc:this.acc,dec:this.dec,ignoreInput:this.ignoreInput,jsi:this.joystickName}},e.loadFromJSON=function(t){this.dx=t.dx,this.dy=t.dy,this.enabled=t.enabled,this.maxspeed=t.maxspeed,this.acc=t.acc,this.dec=t.dec,this.ignoreInput=t.ignoreInput,this.joystickName=t.jsi,this.curDirection=g.NONE,this.lastuptick=-1,this.lastdowntick=-1,this.lastlefttick=-1,this.lastrighttick=-1},e.onDestroy=function(){if(this.defaultControls)if(xf.EventCenter.instance.removeEventListener(xf.EventType.JOYSTICK_MOVE,this.onJoystickMove,this),xf.EventCenter.instance.removeEventListener(xf.EventType.JOYSTICK_RESET,this.onJoystickReset,this),2!==this.controlType)document.removeEventListener("keydown",this.keyDownHandle),document.removeEventListener("keyup",this.keyUpHandle)},e.onJoystickMove=function(t){var e=t.messageData;if(-1!==e.types.indexOf(this.inst.type.sid)||2===this.controlType&&e.name===this.joystickName)this.curDirection=e.direction},e.onJoystickReset=function(t){if(t.messageData.name==this.joystickName)this.curDirection=g.NONE},e.onKeyDown=function(t){if(1==this.controlType){if(37==t.which||38==t.which||39==t.which||40==t.which)return}else if(0==this.controlType)if(65==t.which||87==t.which||68==t.which||83==t.which)return;var e=this.runtime.tickcount;switch(t.which){case 37:case 65:if(t.preventDefault(),this.lastlefttick<e)this.curDirection|=g.LEFT;break;case 38:case 87:if(t.preventDefault(),this.lastuptick<e)this.curDirection|=g.UP;break;case 39:case 68:if(t.preventDefault(),this.lastrighttick<e)this.curDirection|=g.RIGHT;break;case 40:case 83:if(t.preventDefault(),this.lastdowntick<e)this.curDirection|=g.DOWN}},e.onKeyUp=function(t){if(1==this.controlType){if(37==t.which||38==t.which||39==t.which||40==t.which)return}else if(0==this.controlType)if(65==t.which||87==t.which||68==t.which||83==t.which)return;var e=this.runtime.tickcount;switch(t.which){case 37:case 65:t.preventDefault(),this.curDirection&=~g.LEFT,this.lastlefttick=e;break;case 38:case 87:t.preventDefault(),this.curDirection&=~g.UP,this.lastuptick=e;break;case 39:case 68:t.preventDefault(),this.curDirection&=~g.RIGHT,this.lastrighttick=e;break;case 40:case 83:t.preventDefault(),this.curDirection&=~g.DOWN,this.lastdowntick=e}},e.onWindowBlur=function(){this.curDirection=g.NONE},e.tick=function(){var t=this.runtime.getDt(this.inst);if(this.enabled){var e=this.runtime.testOverlapSolid(this.inst);if(e)if(this.runtime.registerCollision(this.inst,e),!this.runtime.pushOutSolidNearest(this.inst))return;if(this.ignoreInput)this.curDirection=g.NONE;if(0===this.directions)this.curDirection&=~g.LEFT,this.curDirection&=~g.RIGHT;else if(1===this.directions)this.curDirection&=~g.UP,this.curDirection&=~g.DOWN;if(2===this.directions&&((this.curDirection&g.UP)===g.UP||(this.curDirection&g.DOWN)===g.DOWN))this.curDirection&=~g.LEFT,this.curDirection&=~g.RIGHT;var i,n,r=0,o=0;if((this.curDirection&g.LEFT)==(this.curDirection&g.RIGHT)&&this.simleft===this.simright){if(this.dx<0){if(this.dx+=this.dec*t,0<this.dx)this.dx=0}else if(0<this.dx)if(this.dx-=this.dec*t,this.dx<0)this.dx=0}else if((this.curDirection&g.LEFT)===g.LEFT||this.simleft)if(0<this.dx)r=-(this.acc+this.dec);else r=-this.acc;else if(this.dx<0)r=this.acc+this.dec;else r=this.acc;if((this.curDirection&g.UP)==(this.curDirection&g.DOWN)&&this.simup===this.simdown){if(this.dy<0){if(this.dy+=this.dec*t,0<this.dy)this.dy=0}else if(0<this.dy)if(this.dy-=this.dec*t,this.dy<0)this.dy=0}else if((this.curDirection&g.UP)===g.UP||this.simup)if(0<this.dy)o=-(this.acc+this.dec);else o=-this.acc;else if(this.dy<0)o=this.acc+this.dec;else o=this.acc;if(this.simleft=!1,this.simright=!1,this.simup=!1,this.simdown=!1,this.dx+=r*t,this.dy+=o*t,0!==this.dx||0!==this.dy){var s=Math.sqrt(this.dx*this.dx+this.dy*this.dy),a=Math.atan2(this.dy,this.dx),l=this.maxspeed*Math.cos(a),c=this.maxspeed*Math.sin(a);if(s>this.maxspeed)this.dx=l,this.dy=c;l=Math.abs(l),c=Math.abs(c);var u=this.inst.x,h=this.inst.y,d=this.inst.angle;if(this.inst.x+=this.runtime.accelerate(this.dx,-l,l,r,t),this.inst.set_bbox_changed(),e=this.runtime.testOverlapSolid(this.inst)){if(!this.runtime.pushOutSolid(this.inst,this.dx<0?1:-1,0,Math.abs(Math.floor(this.dx*t))))this.inst.x=u,this.inst.set_bbox_changed();this.dx=0,this.runtime.registerCollision(this.inst,e)}if(this.inst.y+=this.runtime.accelerate(this.dy,-c,c,o,t),this.inst.set_bbox_changed(),e=this.runtime.testOverlapSolid(this.inst)){if(!this.runtime.pushOutSolid(this.inst,0,this.dy<0?1:-1,Math.abs(Math.floor(this.dy*t))))this.inst.y=h,this.inst.set_bbox_changed();this.dy=0,this.runtime.registerCollision(this.inst,e)}if(i=drama.round6dp(this.dx),n=drama.round6dp(this.dy),(0!==i||0!==n)&&this.inst.type.plugin.is_rotatable)if(1===this.angleMode)this.inst.angle=drama.to_clamped_radians(90*Math.round(drama.to_degrees(Math.atan2(n,i))/90));else if(2===this.angleMode)this.inst.angle=drama.to_clamped_radians(45*Math.round(drama.to_degrees(Math.atan2(n,i))/45));else if(3===this.angleMode)this.inst.angle=Math.atan2(n,i);if(this.inst.set_bbox_changed(),this.inst.angle!=d)if(e=this.runtime.testOverlapSolid(this.inst))this.inst.angle=d,this.inst.set_bbox_changed(),this.runtime.registerCollision(this.inst,e)}if(this.inst.type.plugin instanceof drama.plugins_.Sprite&&this.bindingAnim){var p=this.inst.cur_animation,f=p.name;if((this.curDirection&g.UP)===g.UP)if((this.curDirection&g.LEFT)===g.LEFT)f=this.properties[13];else if((this.curDirection&g.RIGHT)===g.RIGHT)f=this.properties[14];else f=this.properties[9];else if((this.curDirection&g.DOWN)===g.DOWN)if((this.curDirection&g.LEFT)===g.LEFT)f=this.properties[15];else if((this.curDirection&g.RIGHT)===g.RIGHT)f=this.properties[16];else f=this.properties[12];else if((this.curDirection&g.LEFT)===g.LEFT)f=this.properties[10];else if((this.curDirection&g.RIGHT)===g.RIGHT)f=this.properties[11];else{if(1e-10<Math.sqrt(this.dx*this.dx+this.dy*this.dy))return;var m=this.lastDirection;if((m&g.UP)===g.UP)if((m&g.LEFT)===g.LEFT)f=this.properties[21];else if((m&g.RIGHT)===g.RIGHT)f=this.properties[22];else f=this.properties[17];else if((m&g.DOWN)===g.DOWN)if((m&g.LEFT)===g.LEFT)f=this.properties[23];else if((m&g.RIGHT)===g.RIGHT)f=this.properties[24];else f=this.properties[20];else if((m&g.LEFT)===g.LEFT)f=this.properties[18];else if((m&g.RIGHT)===g.RIGHT)f=this.properties[19]}if(p.name!==f)this.inst.changeAnimName=f||"",this.inst.changeAnimFrom=0;this.lastDirection=this.curDirection}}},e.getDebuggerValues=function(t){t.push({title:this.type.name,properties:[{name:"Vector X",value:this.dx},{name:"Vector Y",value:this.dy},{name:"Overall speed",value:Math.sqrt(this.dx*this.dx+this.dy*this.dy)},{name:"Angle of motion",value:drama.to_degrees(Math.atan2(this.dy,this.dx)),readonly:!0},{name:"Max speed",value:this.maxspeed},{name:"Acceleration",value:this.acc},{name:"Deceleration",value:this.dec},{name:"Enabled",value:this.enabled}]})},e.onDebugValueEdited=function(t,e,i){var n;switch(e){case"Vector X":this.dx=i;break;case"Vector Y":this.dy=i;break;case"Overall speed":if(i<0)i=0;if(i>this.maxspeed)i=this.maxspeed;n=Math.atan2(this.dy,this.dx),this.dx=i*Math.cos(n),this.dy=i*Math.sin(n);break;case"Max speed":this.maxspeed=i;break;case"Acceleration":this.acc=i;break;case"Deceleration":this.dec=i;break;case"Enabled":this.enabled=i}},i.prototype.IsMoving=function(){return 1e-10<Math.sqrt(this.dx*this.dx+this.dy*this.dy)},i.prototype.CompareSpeed=function(t,e){var i=Math.sqrt(this.dx*this.dx+this.dy*this.dy);return drama.do_cmp(i,t,e)},t.cnds=new i,n.prototype.Stop=function(){this.dx=0,this.dy=0},n.prototype.Reverse=function(){this.dx*=-1,this.dy*=-1},n.prototype.SetIgnoreInput=function(t){this.ignoreInput=t},n.prototype.SetSportSpeed=function(t,e,i,n){if(t)this.dx=e;if(i)this.dy=n},n.prototype.SetSpeed=function(t){if(t<0)t=0;if(t>this.maxspeed)t=this.maxspeed;var e=Math.atan2(this.dy,this.dx);this.dx=t*Math.cos(e),this.dy=t*Math.sin(e)},n.prototype.SetSportParam=function(t,e,i,n,r){var o=!0,s=!0,a=!0,l=!0;if(r)o="true"===(r=r.split("|"))[0],s="true"===r[1],a="true"===r[2],l="true"===r[3];if(o)if(this.maxspeed=t,this.maxspeed<0)this.maxspeed=0;if(s)if(this.acc=e,this.acc<0)this.acc=0;if(a)if(this.dec=i,this.dec<0)this.dec=0;if(l)this.controlType=n},n.prototype.SetMaxSpeed=function(t){if(this.maxspeed=t,this.maxspeed<0)this.maxspeed=0},n.prototype.SetAcceleration=function(t){if(this.acc=t,this.acc<0)this.acc=0},n.prototype.SetDeceleration=function(t){if(this.dec=t,this.dec<0)this.dec=0},n.prototype.SimulateControl=function(t){switch(t){case 0:this.simleft=!0;break;case 1:this.simright=!0;break;case 2:this.simup=!0;break;case 3:this.simdown=!0}},n.prototype.SetEnabled=function(t){this.enabled=1===t},n.prototype.SetVectorX=function(t){this.dx=t},n.prototype.SetVectorY=function(t){this.dy=t},n.prototype.SetKeyBoardMode=function(t){this.controlType=t},t.acts=new n,r.prototype.Speed=function(t){t.set_float(Math.sqrt(this.dx*this.dx+this.dy*this.dy))},r.prototype.MaxSpeed=function(t){t.set_float(this.maxspeed)},r.prototype.Acceleration=function(t){t.set_float(this.acc)},r.prototype.Deceleration=function(t){t.set_float(this.dec)},r.prototype.MovingAngle=function(t){t.set_float(drama.to_degrees(Math.atan2(this.dy,this.dx)))},r.prototype.VectorX=function(t){t.set_float(this.dx)},r.prototype.VectorY=function(t){t.set_float(this.dy)},t.exps=new r}(),assert2(drama,"drama namespace not created"),assert2(drama.behaviors,"drama.behaviors not created"),drama.behaviors.bound=function(t){this.runtime=t},function(){var t=drama.behaviors.bound.prototype;t.Type=function(t,e){this.behavior=t,this.objtype=e,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t,e){this.type=t,this.behavior=t.behavior,this.inst=e,this.runtime=t.runtime,this.mode=0};var e=t.Instance.prototype;e.onCreate=function(){this.mode=this.properties[0]},e.tick=function(){},e.tick2=function(){this.inst.update_bbox();var t=this.inst.bbox,e=this.inst.layer.layout,i=!1;if(0===this.mode){if(this.inst.x<0)i=!(this.inst.x=0);if(this.inst.y<0)i=!(this.inst.y=0);if(this.inst.x>e.width)this.inst.x=e.width,i=!0;if(this.inst.y>e.height)this.inst.y=e.height,i=!0}else{if(t.left<0)this.inst.x-=t.left,i=!0;if(t.top<0)this.inst.y-=t.top,i=!0;if(t.right>e.width)this.inst.x-=t.right-e.width,i=!0;if(t.bottom>e.height)this.inst.y-=t.bottom-e.height,i=!0}if(i)this.inst.set_bbox_changed()}}(),assert2(drama,"drama namespace not created"),assert2(drama.behaviors,"drama.behaviors not created"),drama.behaviors.Bullet=function(t){this.runtime=t},function(){var t=drama.behaviors.Bullet.prototype;t.Type=function(t,e){this.behavior=t,this.objtype=e,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t,e){this.type=t,this.behavior=t.behavior,this.inst=e,this.runtime=t.runtime};var e=t.Instance.prototype;function i(){}function n(){}function r(){}e.onCreate=function(){var t=this.properties[0];this.acc=this.properties[1],this.g=this.properties[2],this.bounceOffSolid=this.properties[3],this.setAngle=this.properties[4],this.step=this.properties[5],this.stepSize=Math.abs(Math.min(this.inst.width,this.inst.height)/2),this.stopStepping=!1,this.dx=Math.cos(this.inst.angle)*t,this.dy=Math.sin(this.inst.angle)*t,this.lastx=this.inst.x,this.lasty=this.inst.y,this.lastKnownAngle=this.inst.angle,this.travelled=0,this.enabled=this.properties[6]},e.saveToJSON=function(){return{acc:this.acc,g:this.g,dx:this.dx,dy:this.dy,lx:this.lastx,ly:this.lasty,lka:this.lastKnownAngle,t:this.travelled,st:this.step,e:this.enabled}},e.loadFromJSON=function(t){this.acc=t.acc,this.g=t.g,this.dx=t.dx,this.dy=t.dy,this.lastx=t.lx,this.lasty=t.ly,this.lastKnownAngle=t.lka,this.travelled=t.t,this.step=!!t.st,this.enabled=t.e},e.tick=function(){if(this.enabled){var t,e,i,n,r=this.runtime.getDt(this.inst);if(this.inst.angle!==this.lastKnownAngle){if(this.setAngle)t=drama.distanceTo(0,0,this.dx,this.dy),this.dx=Math.cos(this.inst.angle)*t,this.dy=Math.sin(this.inst.angle)*t;this.lastKnownAngle=this.inst.angle}var o=0,s=0;if(0!==this.acc){if(t=drama.distanceTo(0,0,this.dx,this.dy),0===this.dx&&0===this.dy)e=this.inst.angle;else e=drama.angleTo(0,0,this.dx,this.dy);if(t+=this.acc*r,o=Math.cos(e)*this.acc,s=Math.sin(e)*this.acc,t<0)s=o=t=0;this.dx=Math.cos(e)*t,this.dy=Math.sin(e)*t}if(0!==this.g)this.dy+=this.g*r,s+=this.g;if(this.lastx=this.inst.x,this.lasty=this.inst.y,0!==this.dx||0!==this.dy){var a=this.runtime.accelerate(this.dx,-1/0,1/0,o,r),l=this.runtime.accelerate(this.dy,-1/0,1/0,s,r);if(this.moveBy(a,l),0===a&&0===l)return;if(this.travelled+=drama.distanceTo(this.lastx,this.lasty,this.inst.x,this.inst.y),this.setAngle)this.inst.angle=drama.angleTo(0,0,a,l),this.inst.set_bbox_changed(),this.lastKnownAngle=this.inst.angle;if(this.bounceOffSolid)if(i=this.runtime.testOverlapSolid(this.inst)){if(this.runtime.registerCollision(this.inst,i),t=drama.distanceTo(0,0,this.dx,this.dy),n=this.runtime.calculateSolidBounceAngle(this.inst,this.lastx,this.lasty),this.dx=Math.cos(n)*t,this.dy=Math.sin(n)*t,this.inst.x+=this.dx*r,this.inst.y+=this.dy*r,this.inst.set_bbox_changed(),this.setAngle)this.inst.angle=n,this.lastKnownAngle=n,this.inst.set_bbox_changed();if(!this.runtime.pushOutSolid(this.inst,this.dx/t,this.dy/t,Math.max(2.5*t*r,30)))this.runtime.pushOutSolidNearest(this.inst,100)}}}},e.moveBy=function(t,e){var i=drama.distanceTo(0,0,t,e);if(this.step&&!(i<=this.stepSize)){this.stopStepping=!1;for(var n=this.inst.x,r=this.inst.y,o=n+t,s=r+e,a=drama.angleTo(0,0,t,e),l=Math.cos(a)*this.stepSize,c=Math.sin(a)*this.stepSize,u=Math.floor(i/this.stepSize),h=1;h<=u;++h)if(this.inst.x=n+l*h,this.inst.y=r+c*h,this.inst.set_bbox_changed(),this.runtime.trigger(drama.behaviors.Bullet.prototype.cnds.OnStep,this.inst),this.inst.isDestroyed||this.stopStepping)return;this.inst.x=o,this.inst.y=s,this.inst.set_bbox_changed(),this.runtime.trigger(drama.behaviors.Bullet.prototype.cnds.OnStep,this.inst)}else if(this.inst.x+=t,this.inst.y+=e,this.inst.set_bbox_changed(),this.step)this.runtime.trigger(drama.behaviors.Bullet.prototype.cnds.OnStep,this.inst)},e.getDebuggerValues=function(t){t.push({title:this.type.name,properties:[{name:"Vector X",value:this.dx},{name:"Vector Y",value:this.dy},{name:"Overall speed",value:drama.distanceTo(0,0,this.dx,this.dy)},{name:"Angle of motion",value:drama.to_degrees(drama.angleTo(0,0,this.dx,this.dy))},{name:"Acceleration",value:this.acc},{name:"Gravity",value:this.g},{name:"Distance travelled",value:this.travelled,readonly:!0},{name:"Enabled",value:this.enabled}]})},e.onDebugValueEdited=function(t,e,i){var n,r;switch(e){case"Vector X":this.dx=i;break;case"Vector Y":this.dy=i;break;case"Overall speed":n=drama.angleTo(0,0,this.dx,this.dy),this.dx=Math.cos(n)*i,this.dy=Math.sin(n)*i;break;case"Angle of motion":n=drama.to_radians(i),r=drama.distanceTo(0,0,this.dx,this.dy),this.dx=Math.cos(n)*r,this.dy=Math.sin(n)*r;break;case"Acceleration":this.acc=i;break;case"Gravity":this.g=i;break;case"Enabled":this.enabled=i}},i.prototype.CompareSpeed=function(t,e){return drama.do_cmp(drama.distanceTo(0,0,this.dx,this.dy),t,e)},i.prototype.CompareTravelled=function(t,e){if(0===t||1===t)return drama.do_cmp(Math.floor(this.travelled),t,e);else return drama.do_cmp(this.travelled,t,e)},i.prototype.OnStep=function(){return!0},t.cnds=new i,n.prototype.SetSpeed=function(t){var e=drama.angleTo(0,0,this.dx,this.dy);e=e||this.inst.angle,this.dx=Math.cos(e)*t,this.dy=Math.sin(e)*t},n.prototype.SetAcceleration=function(t){this.acc=t},n.prototype.SetGravity=function(t){this.g=t},n.prototype.SetAngleOfMotion=function(t){t=drama.to_radians(t);var e=drama.distanceTo(0,0,this.dx,this.dy);this.dx=Math.cos(t)*e,this.dy=Math.sin(t)*e},n.prototype.Bounce=function(t){if(t){var e=t.getFirstPicked(this.inst);if(e){var i=this.runtime.getDt(this.inst),n=drama.distanceTo(0,0,this.dx,this.dy),r=this.runtime.calculateSolidBounceAngle(this.inst,this.lastx,this.lasty,e);if(this.dx=Math.cos(r)*n,this.dy=Math.sin(r)*n,this.inst.x+=this.dx*i,this.inst.y+=this.dy*i,this.inst.set_bbox_changed(),this.setAngle)this.inst.angle=r,this.lastKnownAngle=r,this.inst.set_bbox_changed();if(0!==n)if(this.bounceOffSolid){if(!this.runtime.pushOutSolid(this.inst,this.dx/n,this.dy/n,Math.max(2.5*n*i,30)))this.runtime.pushOutSolidNearest(this.inst,100)}else this.runtime.pushOut(this.inst,this.dx/n,this.dy/n,Math.max(2.5*n*i,30),e)}}},n.prototype.SetDistanceTravelled=function(t){this.travelled=t},n.prototype.SetEnabled=function(t){this.enabled=1===t},n.prototype.StopStepping=function(){this.stopStepping=!0},t.acts=new n,r.prototype.Speed=function(t){var e=drama.distanceTo(0,0,this.dx,this.dy);e=drama.round6dp(e),t.set_float(e)},r.prototype.Acceleration=function(t){t.set_float(this.acc)},r.prototype.AngleOfMotion=function(t){t.set_float(drama.to_degrees(drama.angleTo(0,0,this.dx,this.dy)))},r.prototype.DistanceTravelled=function(t){t.set_float(this.travelled)},r.prototype.Gravity=function(t){t.set_float(this.g)},t.exps=new r}(),assert2(drama,"drama namespace not created"),assert2(drama.behaviors,"drama.behaviors not created"),drama.behaviors.Car=function(t){this.runtime=t},function(){var t=drama.behaviors.Car.prototype;t.Type=function(t,e){this.behavior=t,this.objtype=e,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t,e){this.type=t,this.behavior=t.behavior,this.inst=e,this.runtime=t.runtime,this.upkey=!1,this.downkey=!1,this.leftkey=!1,this.rightkey=!1,this.ignoreInput=!1,this.simup=!1,this.simdown=!1,this.simleft=!1,this.simright=!1,this.s=0,this.a=this.inst.angle,this.m=this.inst.angle};var e=t.Instance.prototype;function i(){}function n(){}function r(){}e.onCreate=function(){this.maxspeed=this.properties[0],this.acc=this.properties[1],this.dec=this.properties[2],this.steerSpeed=drama.to_radians(this.properties[3]),this.driftRecover=drama.to_radians(this.properties[4]),this.friction=this.properties[5],this.setAngle=this.properties[6],this.defaultControls=this.properties[7],this.enabled=this.properties[8],this.lastx=this.inst.x,this.lasty=this.inst.y,this.lastAngle=this.inst.angle;var e=this;if(this.defaultControls)document.addEventListener("keydown",function(t){e.onKeyDown(t)}),document.addEventListener("keyup",function(t){e.onKeyUp(t)})},e.saveToJSON=function(){return{ignoreInput:this.ignoreInput,enabled:this.enabled,s:this.s,a:this.a,m:this.m,maxspeed:this.maxspeed,acc:this.acc,dec:this.dec,steerSpeed:this.steerSpeed,driftRecover:this.driftRecover,friction:this.friction,lastx:this.lastx,lasty:this.lasty,lastAngle:this.lastAngle}},e.loadFromJSON=function(t){this.ignoreInput=t.ignoreInput,this.enabled=t.enabled,this.s=t.s,this.a=t.a,this.m=t.m,this.maxspeed=t.maxspeed,this.acc=t.acc,this.dec=t.dec,this.steerSpeed=t.steerSpeed,this.driftRecover=t.driftRecover,this.friction=t.friction,this.lastx=t.lastx,this.lasty=t.lasty,this.lastAngle=t.lastAngle,this.upkey=!1,this.downkey=!1,this.leftkey=!1,this.rightkey=!1,this.simup=!1,this.simdown=!1,this.simleft=!1,this.simright=!1},e.onKeyDown=function(t){switch(t.which){case 37:t.preventDefault(),this.leftkey=!0;break;case 38:t.preventDefault(),this.upkey=!0;break;case 39:t.preventDefault(),this.rightkey=!0;break;case 40:t.preventDefault(),this.downkey=!0}},e.onKeyUp=function(t){switch(t.which){case 37:t.preventDefault(),this.leftkey=!1;break;case 38:t.preventDefault(),this.upkey=!1;break;case 39:t.preventDefault(),this.rightkey=!1;break;case 40:t.preventDefault(),this.downkey=!1}},e.onWindowBlur=function(){this.upkey=!1,this.downkey=!1,this.leftkey=!1,this.rightkey=!1},e.tick=function(){var t=this.runtime.getDt(this.inst),e=this.leftkey||this.simleft,i=this.rightkey||this.simright,n=this.upkey||this.simup,r=this.downkey||this.simdown;if(this.simleft=!1,this.simright=!1,this.simup=!1,this.simdown=!1,this.enabled){if(this.setAngle&&this.inst.angle!==this.lastAngle)this.a=this.inst.angle,this.m=this.inst.angle,this.lastAngle=this.inst.angle;var o=this.runtime.testOverlapSolid(this.inst);if(o)if(this.runtime.registerCollision(this.inst,o),!this.runtime.pushOutSolidNearest(this.inst))return;if(this.ignoreInput)r=n=i=e=!1;if(n&&!r)if(this.s+=this.acc*t,this.s>this.maxspeed)this.s=this.maxspeed;if(r&&!n)if(this.s-=this.dec*t,this.s<-this.maxspeed)this.s=-this.maxspeed;if(r===n)if(0<this.s){if(this.s-=this.dec*t*.1,this.s<0)this.s=0}else if(this.s<0)if(this.s+=this.dec*t*.1,0<this.s)this.s=0;if(this.s<0){var s=e;e=i,i=s}if(e&&!i)this.a=drama.clamp_angle(this.a-this.steerSpeed*t*(Math.abs(this.s)/this.maxspeed));if(i&&!e)this.a=drama.clamp_angle(this.a+this.steerSpeed*t*(Math.abs(this.s)/this.maxspeed));var a=this.driftRecover*t,l=drama.angleDiff(this.a,this.m);if(l>drama.to_radians(90))a+=l-drama.to_radians(90);if(l<=a)this.m=drama.clamp_angle(this.a);else if(drama.angleClockwise(this.a,this.m))this.m=drama.clamp_angle(this.m+a);else this.m=drama.clamp_angle(this.m-a);if(this.lastx=this.inst.x,this.lasty=this.inst.y,0!==this.s&&0!==t){if(this.inst.x+=Math.cos(this.m)*this.s*t,this.inst.y+=Math.sin(this.m)*this.s*t,this.setAngle)this.inst.angle=this.a,this.lastAngle=this.a;this.inst.set_bbox_changed();var c=this.runtime.testOverlapSolid(this.inst);if(c)if(this.runtime.registerCollision(this.inst,c),this.s=Math.abs(this.s),this.m=this.runtime.calculateSolidBounceAngle(this.inst,this.lastx,this.lasty),this.inst.x+=Math.cos(this.m)*this.s*t,this.inst.y+=Math.sin(this.m)*this.s*t,this.inst.set_bbox_changed(),this.s*=1-this.friction,!this.runtime.pushOutSolid(this.inst,Math.cos(this.m),Math.sin(this.m),Math.max(2.5*this.s*t,30)))this.runtime.pushOutSolidNearest(this.inst,100)}else if(this.setAngle&&this.inst.angle!==this.a)if(this.inst.angle=this.a,this.lastAngle=this.a,this.inst.set_bbox_changed(),this.runtime.testOverlapSolid(this.inst))this.runtime.pushOutSolidNearest(this.inst,100)}},e.getDebuggerValues=function(t){t.push({title:this.type.name,properties:[{name:"Speed",value:this.s},{name:"Angle of motion",value:drama.to_degrees(this.m)},{name:"Vector X",value:Math.cos(this.m)*this.s,readonly:!0},{name:"Vector Y",value:Math.sin(this.m)*this.s,readonly:!0},{name:"Max speed",value:this.maxspeed},{name:"Acceleration",value:this.acc},{name:"Deceleration",value:this.dec},{name:"Steer speed",value:drama.to_degrees(this.steerSpeed)},{name:"Drift recover",value:drama.to_degrees(this.driftRecover)},{name:"Friction",value:this.friction},{name:"Enabled",value:this.enabled}]})},e.onDebugValueEdited=function(t,e,i){switch(e){case"Speed":this.s=i;break;case"Angle of motion":this.m=drama.to_radians(i);break;case"Max speed":this.maxspeed=i;break;case"Acceleration":this.acc=i;break;case"Deceleration":this.dec=i;break;case"Steer speed":this.steerSpeed=drama.to_radians(i);break;case"Drift recover":this.driftRecover=drama.to_radians(i);break;case"Friction":this.friction=i;break;case"Enabled":this.enabled=i}},i.prototype.IsMoving=function(){return 0!==this.s},i.prototype.CompareSpeed=function(t,e){return drama.do_cmp(this.s,t,e)},t.cnds=new i,n.prototype.Stop=function(){this.s=0},n.prototype.SetIgnoreInput=function(t){this.ignoreInput=t},n.prototype.SetSpeed=function(t){if(t<-this.maxspeed)t=-this.maxspeed;if(t>this.maxspeed)t=this.maxspeed;this.s=t},n.prototype.SetFindParam=function(t,e,i,n,r,o,s){var a=!0,l=!0,c=!0,u=!0,h=!0,d=!0;if(s)a="true"===(s=s.split("|"))[0],l="true"===s[1],c="true"===s[2],u="true"===s[3],h="true"===s[4],d="true"===s[5];if(a)if(this.maxspeed=t,this.maxspeed<0)this.maxspeed=0;if(l)if(this.acc=e,this.acc<0)this.acc=0;if(c)if(this.dec=i,this.dec<0)this.dec=0;if(u)this.steerSpeed=drama.to_radians(n);if(h)this.driftRecover=drama.to_radians(r);if(d)this.friction=o},n.prototype.SetMaxSpeed=function(t){if(this.maxspeed=t,this.maxspeed<0)this.maxspeed=0},n.prototype.SetAcceleration=function(t){if(this.acc=t,this.acc<0)this.acc=0},n.prototype.SetDeceleration=function(t){if(this.dec=t,this.dec<0)this.dec=0},n.prototype.SimulateControl=function(t){switch(t){case 0:this.simleft=!0;break;case 1:this.simright=!0;break;case 2:this.simup=!0;break;case 3:this.simdown=!0}},n.prototype.SetEnabled=function(t){this.enabled=1===t},n.prototype.SetSteerSpeed=function(t){this.steerSpeed=drama.to_radians(t)},n.prototype.SetDriftRecover=function(t){this.driftRecover=drama.to_radians(t)},n.prototype.SetFriction=function(t){this.friction=t},t.acts=new n,r.prototype.Speed=function(t){t.set_float(this.s)},r.prototype.MaxSpeed=function(t){t.set_float(this.maxspeed)},r.prototype.Acceleration=function(t){t.set_float(this.acc)},r.prototype.Deceleration=function(t){t.set_float(this.dec)},r.prototype.MovingAngle=function(t){t.set_float(drama.to_degrees(this.m))},r.prototype.VectorX=function(t){t.set_float(Math.cos(this.m)*this.s)},r.prototype.VectorY=function(t){t.set_float(Math.sin(this.m)*this.s)},r.prototype.SteerSpeed=function(t){t.set_float(drama.to_degrees(this.steerSpeed))},r.prototype.DriftRecover=function(t){t.set_float(drama.to_degrees(this.driftRecover))},r.prototype.Friction=function(t){t.set_float(this.friction)},t.exps=new r}(),assert2(drama,"drama namespace not created"),assert2(drama.behaviors,"drama.behaviors not created"),drama.behaviors.custom=function(t){this.runtime=t},function(){var t=drama.behaviors.custom.prototype;t.Type=function(t,e){this.behavior=t,this.objtype=e,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t,e){this.type=t,this.behavior=t.behavior,this.inst=e,this.runtime=t.runtime,this.dx=0,this.dy=0,this.cancelStep=0};var e=t.Instance.prototype;function i(){}function n(){}function r(){}e.onCreate=function(){this.stepMode=this.properties[0],this.pxPerStep=this.properties[1],this.enabled=this.properties[2],this.resetOnStepStatus()},e.resetOnStepStatus=function(){this.isOnCMStep=!1,this.isOnCMHorizStep=!1,this.isOnCMVertStep=!1},e.saveToJSON=function(){return{dx:this.dx,dy:this.dy,cancelStep:this.cancelStep,enabled:this.enabled,stepMode:this.stepMode,pxPerStep:this.pxPerStep}},e.loadFromJSON=function(t){this.dx=t.dx,this.dy=t.dy,this.cancelStep=t.cancelStep,this.enabled=t.enabled,this.stepMode=t.stepMode,this.pxPerStep=t.pxPerStep},e.getSpeed=function(){return Math.sqrt(this.dx*this.dx+this.dy*this.dy)},e.getAngle=function(){return Math.atan2(this.dy,this.dx)},e.step=function(t,e,i){if(0!==t||0!==e){var n,r,o=this.inst.x,s=this.inst.y,a=Math.round(Math.sqrt(t*t+e*e)/this.pxPerStep);if(0===a)a=1;for(r=1;r<=a;r++)if(n=r/a,this.inst.x=o+t*n,this.inst.y=s+e*n,this.inst.set_bbox_changed(),this.runtime.trigger(i,this.inst),1===this.cancelStep)return n=--r/a,this.inst.x=o+t*n,this.inst.y=s+e*n,void this.inst.set_bbox_changed();else if(2===this.cancelStep)return}},e.tick=function(){var t=this.runtime.getDt(this.inst),e=this.dx*t,i=this.dy*t;if((0!==this.dx||0!==this.dy)&&this.enabled){if((this.cancelStep=0)===this.stepMode)this.inst.x+=e,this.inst.y+=i;else if(1===this.stepMode)this.step(e,i,drama.behaviors.custom.prototype.cnds.OnCMStep),this.isOnCMStep=!0,this.step(e,i,drama.behaviors.custom.prototype.cnds.OnCMStepByType),this.isOnCMStep=!1;else if(2===this.stepMode)this.isOnCMHorizStep=!0,this.step(e,0,drama.behaviors.custom.prototype.cnds.OnCMHorizStep),this.step(e,i,drama.behaviors.custom.prototype.cnds.OnCMStepByType),this.isOnCMHorizStep=!1,this.cancelStep=0,this.isOnCMVertStep=!0,this.step(0,i,drama.behaviors.custom.prototype.cnds.OnCMVertStep),this.step(e,i,drama.behaviors.custom.prototype.cnds.OnCMStepByType),this.isOnCMVertStep=!1;else if(3===this.stepMode)this.isOnCMVertStep=!0,this.step(0,i,drama.behaviors.custom.prototype.cnds.OnCMVertStep),this.step(e,i,drama.behaviors.custom.prototype.cnds.OnCMStepByType),this.isOnCMVertStep=!1,this.cancelStep=0,this.isOnCMHorizStep=!0,this.step(e,0,drama.behaviors.custom.prototype.cnds.OnCMHorizStep),this.step(e,i,drama.behaviors.custom.prototype.cnds.OnCMStepByType),this.isOnCMHorizStep=!1;this.inst.set_bbox_changed()}},e.getDebuggerValues=function(t){t.push({title:this.type.name,properties:[{name:"Vector X",value:this.dx},{name:"Vector Y",value:this.dy},{name:"Pixels per step",value:this.pxPerStep},{name:"Enabled",value:this.enabled}]})},e.onDebugValueEdited=function(t,e,i){switch(e){case"Vector X":this.dx=i;break;case"Vector Y":this.dy=i;break;case"Pixels per step":this.pxPerStep=i;break;case"Enabled":this.enabled=i}},i.prototype.IsMoving=function(){return 0!=this.dx||0!=this.dy},i.prototype.CompareSpeed=function(t,e,i){var n;switch(t){case 0:n=this.getSpeed();break;case 1:n=this.dx;break;case 2:n=this.dy}return drama.do_cmp(n,e,i)},i.prototype.OnCMStepByType=function(t){if(0==t&&this.isOnCMStep)return!0;else if(1==t&&this.isOnCMHorizStep)return!0;else if(2==t&&this.isOnCMVertStep)return!0;return!1},i.prototype.OnCMStep=function(){return!0},i.prototype.OnCMHorizStep=function(){return!0},i.prototype.OnCMVertStep=function(){return!0},t.cnds=new i,n.prototype.Stop=function(){this.dx=0,this.dy=0},n.prototype.Reverse=function(t){switch(t){case 0:this.dx*=-1,this.dy*=-1;break;case 1:this.dx*=-1;break;case 2:this.dy*=-1}},n.prototype.SetSpeed=function(t,e){var i;switch(t){case 0:i=this.getAngle(),this.dx=Math.cos(i)*e,this.dy=Math.sin(i)*e;break;case 1:this.dx=e;break;case 2:this.dy=e}},n.prototype.Accelerate=function(t,e){var i,n=e*this.runtime.getDt(this.inst);switch(t){case 0:i=this.getAngle(),this.dx+=Math.cos(i)*n,this.dy+=Math.sin(i)*n;break;case 1:this.dx+=n;break;case 2:this.dy+=n}},n.prototype.AccelerateAngle=function(t,e){var i=t*this.runtime.getDt(this.inst),n=drama.to_radians(e);this.dx+=Math.cos(n)*i,this.dy+=Math.sin(n)*i},n.prototype.AcceleratePos=function(t,e,i){var n=t*this.runtime.getDt(this.inst),r=Math.atan2(i-this.inst.y,e-this.inst.x);this.dx+=Math.cos(r)*n,this.dy+=Math.sin(r)*n},n.prototype.SetAngleOfMotion=function(t){var e=drama.to_radians(t),i=this.getSpeed();this.dx=Math.cos(e)*i,this.dy=Math.sin(e)*i},n.prototype.RotateAngleByType=function(t,e){var i;if(0==t)i=this.getAngle()+drama.to_radians(e);else i=this.getAngle()-drama.to_radians(e);var n=this.getSpeed();this.dx=Math.cos(i)*n,this.dy=Math.sin(i)*n},n.prototype.RotateAngleOfMotionClockwise=function(t){var e=this.getAngle()+drama.to_radians(t),i=this.getSpeed();this.dx=Math.cos(e)*i,this.dy=Math.sin(e)*i},n.prototype.RotateAngleOfMotionCounterClockwise=function(t){var e=this.getAngle()-drama.to_radians(t),i=this.getSpeed();this.dx=Math.cos(e)*i,this.dy=Math.sin(e)*i},n.prototype.StopStepping=function(t){this.cancelStep=t+1},n.prototype.PushOutSolid2=function(t,e){var i,n;switch(t){case 0:e=this.getAngle(),i=Math.cos(e),n=Math.sin(e),this.runtime.pushOutSolid(this.inst,-i,-n,Math.max(3*this.getSpeed(),100));break;case 1:this.runtime.pushOutSolidNearest(this.inst);break;case 2:this.runtime.pushOutSolid(this.inst,0,-1,Math.max(3*Math.abs(this.dy),100));break;case 3:this.runtime.pushOutSolid(this.inst,0,1,Math.max(3*Math.abs(this.dy),100));break;case 4:this.runtime.pushOutSolid(this.inst,-1,0,Math.max(3*Math.abs(this.dx),100));break;case 5:this.runtime.pushOutSolid(this.inst,1,0,Math.max(3*Math.abs(this.dx),100));break;case 6:e=drama.to_radians(e),i=Math.cos(e),n=Math.sin(e),this.runtime.pushOutSolid(this.inst,i,n,Math.max(3*this.getSpeed(),100))}},n.prototype.PushOutSolid=function(t){var e,i,n;switch(t){case 0:e=this.getAngle(),i=Math.cos(e),n=Math.sin(e),this.runtime.pushOutSolid(this.inst,-i,-n,Math.max(3*this.getSpeed(),100));break;case 1:this.runtime.pushOutSolidNearest(this.inst);break;case 2:this.runtime.pushOutSolid(this.inst,0,-1,Math.max(3*Math.abs(this.dy),100));break;case 3:this.runtime.pushOutSolid(this.inst,0,1,Math.max(3*Math.abs(this.dy),100));break;case 4:this.runtime.pushOutSolid(this.inst,-1,0,Math.max(3*Math.abs(this.dx),100));break;case 5:this.runtime.pushOutSolid(this.inst,1,0,Math.max(3*Math.abs(this.dx),100))}},n.prototype.PushOutSolidAngle=function(t){t=drama.to_radians(t);var e=Math.cos(t),i=Math.sin(t);this.runtime.pushOutSolid(this.inst,e,i,Math.max(3*this.getSpeed(),100))},n.prototype.SetEnabled=function(t){this.enabled=1===t},t.acts=new n,r.prototype.Speed=function(t){t.set_float(this.getSpeed())},r.prototype.MovingAngle=function(t){t.set_float(drama.to_degrees(this.getAngle()))},r.prototype.dx=function(t){t.set_float(this.dx)},r.prototype.dy=function(t){t.set_float(this.dy)},t.exps=new r}(),assert2(drama,"drama namespace not created"),assert2(drama.behaviors,"drama.behaviors not created"),drama.behaviors.destroy=function(t){this.runtime=t},function(){var t=drama.behaviors.destroy.prototype;t.Type=function(t,e){this.behavior=t,this.objtype=e,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t,e){this.type=t,this.behavior=t.behavior,this.inst=e,this.runtime=t.runtime};var e=t.Instance.prototype;e.onCreate=function(){},e.tick=function(){this.inst.update_bbox();var t=this.inst.bbox,e=this.inst.layer.layout;if(t.right<0||t.bottom<0||t.left>e.width||t.top>e.height)this.runtime.DestroyInstance(this.inst)}}(),assert2(drama,"drama namespace not created"),assert2(drama.behaviors,"drama.behaviors not created"),drama.behaviors.DragnDrop=function(t){this.runtime=t;var e=this;document.addEventListener("mousemove",function(t){e.onMouseMove(t)}),document.addEventListener("mousedown",function(t){e.onMouseDown(t)}),document.addEventListener("mouseup",function(t){e.onMouseUp(t)});var i=0<this.runtime.fullscreen_mode?document:this.runtime.canvas;if(this.runtime.isMinigame)i=this.runtime.canvas;if("undefined"!=typeof PointerEvent)i.addEventListener("pointerdown",function(t){e.onPointerStart(t)},!1),i.addEventListener("pointermove",function(t){e.onPointerMove(t)},!1),i.addEventListener("pointerup",function(t){e.onPointerEnd(t)},!1),i.addEventListener("pointercancel",function(t){e.onPointerEnd(t)},!1);else if(window.navigator.msPointerEnabled)i.addEventListener("MSPointerDown",function(t){e.onPointerStart(t)},!1),i.addEventListener("MSPointerMove",function(t){e.onPointerMove(t)},!1),i.addEventListener("MSPointerUp",function(t){e.onPointerEnd(t)},!1),i.addEventListener("MSPointerCancel",function(t){e.onPointerEnd(t)},!1);else i.addEventListener("touchstart",function(t){e.onTouchStart(t)},!1),i.addEventListener("touchmove",function(t){e.onTouchMove(t)},!1),i.addEventListener("touchend",function(t){e.onTouchEnd(t)},!1),i.addEventListener("touchcancel",function(t){e.onTouchEnd(t)},!1)},function(){var n=drama.behaviors.DragnDrop.prototype;function m(t){var e,i;for(e=0,i=t.behavior_insts.length;e<i;e++)if(t.behavior_insts[e]instanceof n.Instance)return t.behavior_insts[e];return null}n.onMouseDown=function(t){if(1===t.which)this.onInputDown("leftmouse",t.pageX,t.pageY)},n.onMouseMove=function(t){if(1===t.which)this.onInputMove("leftmouse",t.pageX,t.pageY)},n.onMouseUp=function(t){if(1===t.which)this.onInputUp("leftmouse")},n.onTouchStart=function(t){if(t.preventDefault&&drama.isCanvasInputEvent(t))t.preventDefault();var e,i,n,r;for(e=0,i=t.changedTouches.length;e<i;e++)r=(n=t.changedTouches[e]).identifier,this.onInputDown(r?r.toString():"<none>",n.pageX,n.pageY)},n.onTouchMove=function(t){if(t.preventDefault)t.preventDefault();var e,i,n,r;for(e=0,i=t.changedTouches.length;e<i;e++)r=(n=t.changedTouches[e]).identifier,this.onInputMove(r?r.toString():"<none>",n.pageX,n.pageY)},n.onTouchEnd=function(t){if(t.preventDefault&&drama.isCanvasInputEvent(t))t.preventDefault();var e,i,n;for(e=0,i=t.changedTouches.length;e<i;e++)n=t.changedTouches[e].identifier,this.onInputUp(n?n.toString():"<none>")},n.onPointerStart=function(t){if(t.pointerType!==t.MSPOINTER_TYPE_MOUSE&&"mouse"!==t.pointerType){if(t.preventDefault&&drama.isCanvasInputEvent(t))t.preventDefault();this.onInputDown(t.pointerId.toString(),t.pageX,t.pageY)}},n.onPointerMove=function(t){if(t.pointerType!==t.MSPOINTER_TYPE_MOUSE&&"mouse"!==t.pointerType){if(t.preventDefault)t.preventDefault();this.onInputMove(t.pointerId.toString(),t.pageX,t.pageY)}},n.onPointerEnd=function(t){if(t.pointerType!==t.MSPOINTER_TYPE_MOUSE&&"mouse"!==t.pointerType){if(t.preventDefault&&drama.isCanvasInputEvent(t))t.preventDefault();this.onInputUp(t.pointerId.toString())}},n.onInputDown=function(t,e,i){var n,r,o,s,a=this.runtime.canvas.offsetLeft,l=this.runtime.canvas.offsetTop,c=drama.convertPageXY(e,i),u=c.pageX-a,h=c.pageY-l,d=this.my_instances.valuesRef(),p=null;for(n=0,r=d.length;n<r;n++)if((o=m(s=d[n])).enabled&&!o.dragging)if(s.update_bbox(),xf.checkTouchable(s,u,h))if(p)if(!(s.layer.index>p.layer.index))if(!(s.layer.index===p.layer.index&&s.get_zindex()>p.get_zindex()));else p=s;else p=s;else p=s;if(p)m(p).onDown(t,u,h)},n.onInputMove=function(t,e,i){var n,r,o,s,a,l,c=this.runtime.canvas.offsetLeft,u=this.runtime.canvas.offsetTop,h=drama.convertPageXY(e,i),d=h.pageX-c,p=h.pageY-u,f=this.my_instances.valuesRef();for(o=0,s=f.length;o<s;o++)if((a=m(l=f[o])).enabled&&a.dragging&&(!a.dragging||a.dragsource===t))n=l.layer.canvasToLayer(d,p,!0),r=l.layer.canvasToLayer(d,p,!1),a.onMove(n,r)},n.onInputUp=function(t){var e,i,n,r=this.my_instances.valuesRef();for(e=0,i=r.length;e<i;e++)if((n=m(r[e])).dragging&&n.dragsource===t)n.onUp()},n.Type=function(t,e){this.behavior=t,this.objtype=e,this.runtime=t.runtime},n.Type.prototype.onCreate=function(){},n.Instance=function(t,e){this.type=t,this.behavior=t.behavior,this.inst=e,this.runtime=t.runtime};var t=n.Instance.prototype;function e(){}function i(){}t.onCreate=function(){this.dragging=!1,this.dragsource="<none>",this.axes=this.properties[0],this.enabled=this.properties[1],this.isDragStart=!1,this.isDrop=!1},t.saveToJSON=function(){return{enabled:this.enabled}},t.loadFromJSON=function(t){this.enabled=t.enabled,this.dragging=!1},t.onDown=function(t,e,i){var n=this.inst.layer.canvasToLayer(e,i,!0),r=this.inst.layer.canvasToLayer(e,i,!1);this.dx=n-this.inst.x,this.dy=r-this.inst.y,this.dragging=!0,this.dragsource=t,this.runtime.isInUserInputEvent=!0,this.runtime.trigger(drama.behaviors.DragnDrop.prototype.cnds.OnDragStart,this.inst),this.isDragStart=!0,this.isDrop=!1,this.runtime.trigger(drama.behaviors.DragnDrop.prototype.cnds.OnDragStatus,this.inst),this.runtime.isInUserInputEvent=!1},t.onMove=function(t,e){if(this.dragging){var i=t-this.dx,n=e-this.dy;if(0===this.axes){if(this.inst.x!==t||this.inst.y!==e)this.inst.x=i,this.inst.y=n,this.inst.set_bbox_changed()}else if(1===this.axes){if(this.inst.x!==t)this.inst.x=i,this.inst.set_bbox_changed()}else if(2===this.axes)if(this.inst.y!==e)this.inst.y=n,this.inst.set_bbox_changed()}},t.onUp=function(){this.dragging=!1,this.runtime.isInUserInputEvent=!0,this.runtime.trigger(drama.behaviors.DragnDrop.prototype.cnds.OnDrop,this.inst),this.isDragStart=!1,this.isDrop=!0,this.runtime.trigger(drama.behaviors.DragnDrop.prototype.cnds.OnDragStatus,this.inst),this.runtime.isInUserInputEvent=!1},t.tick=function(){},t.getDebuggerValues=function(t){t.push({title:this.type.name,properties:[{name:"Is dragging",value:this.dragging,readonly:!0},{name:"Enabled",value:!!this.enabled}]})},t.onDebugValueEdited=function(t,e,i){if("Enabled"===e)this.enabled=i},e.prototype.IsDragging=function(){return this.dragging},e.prototype.OnDragStatus=function(t){if(0==t&&this.isDragStart)return!0;else if(1==t&&this.isDrop)return!0},e.prototype.OnDragStart=function(){return!0},e.prototype.OnDrop=function(){return!0},e.prototype.IsEnabled=function(){return!!this.enabled},n.cnds=new e,i.prototype.SetEnabled=function(t){if(this.enabled=0!==t,!this.enabled)this.dragging=!1},i.prototype.Drop=function(){if(this.dragging)this.onUp()},n.acts=new i,n.exps=new function(){}}(),assert2(drama,"drama namespace not created"),assert2(drama.behaviors,"drama.behaviors not created"),drama.behaviors.dynamic=function(t){this.runtime=t},function(){var i=function(){function t(){}return t.START=0,t.PLAY=1,t.PAUSE=2,t.FINISH=3,t}(),r={"Linear.None":TWEEN.Easing.Linear.None,"Back.In":TWEEN.Easing.Back.In,"Back.InOut":TWEEN.Easing.Back.InOut,"Back.Out":TWEEN.Easing.Back.Out,"Bounce.In":TWEEN.Easing.Bounce.In,"Bounce.InOut":TWEEN.Easing.Bounce.InOut,"Bounce.Out":TWEEN.Easing.Bounce.Out,"Circular.In":TWEEN.Easing.Circular.In,"Circular.InOut":TWEEN.Easing.Circular.InOut,"Circular.Out":TWEEN.Easing.Circular.Out,"Cubic.In":TWEEN.Easing.Cubic.In,"Cubic.InOut":TWEEN.Easing.Cubic.InOut,"Cubic.Out":TWEEN.Easing.Cubic.Out,"Elastic.In":TWEEN.Easing.Elastic.In,"Elastic.InOut":TWEEN.Easing.Elastic.InOut,"Elastic.Out":TWEEN.Easing.Elastic.Out,"Exponential.In":TWEEN.Easing.Exponential.In,"Exponential.InOut":TWEEN.Easing.Exponential.InOut,"Exponential.Out":TWEEN.Easing.Exponential.Out,"Quadratic.In":TWEEN.Easing.Quadratic.In,"Quadratic.InOut":TWEEN.Easing.Quadratic.InOut,"Quadratic.Out":TWEEN.Easing.Quadratic.Out,"Quartic.In":TWEEN.Easing.Quartic.In,"Quartic.InOut":TWEEN.Easing.Quartic.InOut,"Quartic.Out":TWEEN.Easing.Quartic.Out,"Quintic.In":TWEEN.Easing.Quintic.In,"Quintic.InOut":TWEEN.Easing.Quintic.InOut,"Quintic.Out":TWEEN.Easing.Quintic.Out,"Sinusoidal.In":TWEEN.Easing.Back.In,"Sinusoidal.InOut":TWEEN.Easing.Back.InOut};function n(t,e){this.inst=t,this.group=e,this.tween=null,this.isPlay=!1,this.localProps={}}n.prototype.start=function(n,r){var o=this;if(n&&0<n.length){var s=!0;!function t(){if(0<n.length){var e=n.shift();if(s){var i=e.props;o.updateProps(i),s=!1}o.playFragment(e,t)}else o.isPlay=!1,r&&r()}(),this.isPlay=!0}else r&&r()},n.prototype.updateProps=function(t){if(t){if(!this.lastProps)this.lastProps={};var e=Reflect.ownKeys(t);if(0<e.length){var i=!0,n=!1,r=void 0;try{for(var o,s=e[Symbol.iterator]();!(i=(o=s.next()).done);i=!0){var a=o.value,l=Reflect.get(this.localProps,a)||0,c=Reflect.get(t,a);if("opacity"===a){var u=this.inst.opacity-l;this.inst.opacity=Math.min(1,Math.max(0,c)),Reflect.set(this.localProps,a,this.inst.opacity-u)}else if("scaleX"===a){var h=l?Math.round(this.inst.width/l):this.inst.width;this.inst.width=h*c,Reflect.set(this.localProps,a,c)}else if("scaleY"===a){var d=l?Math.round(this.inst.height/l):this.inst.height;this.inst.height=d*c,Reflect.set(this.localProps,a,c)}else if("angle"===a){var p=Math.round(drama.to_degrees(this.inst.angle)-l);this.inst.angle=drama.to_radians(p+c),Reflect.set(this.localProps,a,c)}else{var f=Reflect.get(this.inst,a)-l;Reflect.set(this.inst,a,f+c),Reflect.set(this.localProps,a,c)}}}catch(t){n=!0,r=t}finally{try{if(!i&&null!=s.return)s.return()}finally{if(n)throw r}}this.inst.set_bbox_changed()}}},n.prototype.stop=function(){this.isPlay=!1;var t=this.localProps;if(t){var e=Reflect.ownKeys(t);if(0<e.length){var i=!0,n=!1,r=void 0;try{for(var o,s=e[Symbol.iterator]();!(i=(o=s.next()).done);i=!0){var a=o.value,l=Reflect.get(t,a)||0;if("opacity"===a){var c=this.inst.opacity-l;this.inst.opacity=Math.min(1,Math.max(0,c))}else if("scaleX"===a){var u=l?Math.round(this.inst.width/l):this.inst.width;this.inst.width=u}else if("scaleY"===a){var h=l?Math.round(this.inst.height/l):this.inst.height;this.inst.height=h}else if("angle"===a){var d=Math.round(drama.to_degrees(this.inst.angle)-l);this.inst.angle=drama.to_radians(d)}else{var p=Reflect.get(this.inst,a)-l;Reflect.set(this.inst,a,p)}}}catch(t){n=!0,r=t}finally{try{if(!i&&null!=s.return)s.return()}finally{if(n)throw r}}this.inst.set_bbox_changed()}this.localProps={}}},n.prototype.playFragment=function(t,e){var i=this,n=new TWEEN.Tween(t.props,this.group);if((this.tween=n).to(t.to,t.duration).onUpdate(function(t){i.updateProps(t)}).onComplete(function(t){e&&e()}),t.easing)if("function"==typeof t.easing)n.easing(t.easing);else n.easing(r[t.easing]||TWEEN.Easing.Linear.None);n.start()},n.prototype.destroy=function(){this.isPlay=!1,this.props={},this.inst=null,this.group=null,this.tween=null};var t=drama.behaviors.dynamic.prototype;t.Type=function(t,e){this.behavior=t,this.objtype=e,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t,e){this.type=t,this.behavior=t.behavior,this.inst=e,this.runtime=t.runtime};var e=t.Instance.prototype;function o(){}function s(){}function a(){}e.onCreate=function(){var e=this;this.group=new TWEEN.Group,this.chain=new n(this.inst,this.group),this.propsMap={},this.quque=null,this.defaultQueue=[],this.autoPlayQueue=[],this.queueIndex=0,this.loopCount=0,this.loopNum=0;var t=this.properties;if(t)t.map(function(t){if(e.propsMap[t[13]]=t,e.defaultQueue.push(t[13]),t[0])e.autoPlayQueue.push(t[13])})},e.playChain=function(t,e){var i=this.propsMap[t];if(i){this.current_dynamic=t,this.runtime.trigger(drama.behaviors.dynamic.prototype.cnds.SwitchDynamic,this.inst),this.runtime.trigger(drama.behaviors.dynamic.prototype.cnds.AnyDynamic,this.inst);var n=null;switch(i[1]){case"dynamic_bounce":n=this.effectBounce(i);break;case"dynamic_flash":n=this.effectFlash(i);break;case"dynamic_pulse":n=this.effectPulse(i);break;case"dynamic_rubberband":n=this.effectRubberBand(i);break;case"dynamic_shake":n=this.effectShake(i);break;case"dynamic_swing":n=this.effectSwing(i);break;case"dynamic_tada":n=this.effectTada(i);break;case"dynamic_wobblet":n=this.effectWobble(i);break;case"dynamic_jello":n=this.effectJello(i);break;case"dynamic_heartbeat":n=this.effectHeartbeat(i);break;case"dynamic_bouncein":n=this.effectBounceIn(i);break;case"dynamic_bouncein_move":n=this.effectBounceInType(i);break;case"dynamic_bounceout":n=this.effectBounceOut(i);break;case"dynamic_bounceout_move":n=this.effectBounceOutType(i);break;case"dynamic_fadein":n=this.effectFadeIn(i);break;case"dynamic_fadein_move":n=this.effectFadeInType(i);break;case"dynamic_fadein_big_move":n=this.effectFadeInBigType(i);break;case"dynamic_fadeout":n=this.effectFadeOut(i);break;case"dynamic_fadeout_move":n=this.effectFadeOutType(i);break;case"dynamic_fadeout_big_move":n=this.effectFadeOutBigType(i);break;case"dynamic_hinge":n=this.effectHinge(i);break;case"dynamic_jackinthebox":n=this.effectJackInTheBox(i);break;case"dynamic_lightspeedin":n=this.effectLightSpeedIn(i);break;case"dynamic_lightspeedout":n=this.effectLightSpeedOut(i);break;case"dynamic_moveby":n=this.effectMoveByDistance(i);break;case"dynamic_moveto":n=this.effectMoveToPosition(i);break;case"dynamic_rollin":n=this.effectRollin(i);break;case"dynamic_rollout":n=this.effectRollOut(i);break;case"dynamic_rotatein":n=this.effectRotateIn(i);break;case"dynamic_rotatein_move":n=this.effectRotateInType(i);break;case"dynamic_rotateout":n=this.effectRotateOut(i);break;case"dynamic_rotateout_move":n=this.effectRotateOutType(i);break;case"dynamic_slidein_move":n=this.effectSlideInType(i);break;case"dynamic_slideout_move":n=this.effectSlideOutType(i);break;case"dynamic_zoomin":n=this.effectZoomIn(i);break;case"dynamic_zoomin_move":n=this.effectZoomInType(i);break;case"dynamic_zoomout":n=this.effectZoomOut(i);break;case"dynamic_zoomout_move":n=this.effectZoomOutType(i);break;default:console.log("dynamic_default")}this.chain.start(n,e)}else e&&e()},e.effectBounce=function(t){var e={x:0,y:0},i=[];return i.push({props:e,to:{x:0,y:-30},duration:400}),i.push({props:e,to:{x:0,y:0},duration:100}),i.push({props:e,to:{x:0,y:-15},duration:200}),i.push({props:e,to:{x:0,y:0},duration:100}),i.push({props:e,to:{x:0,y:-4},duration:100}),i.push({props:e,to:{x:0,y:0},duration:100}),i},e.effectFlash=function(t){var e={opacity:1},i=[];return i.push({props:e,to:{opacity:0},duration:250}),i.push({props:e,to:{opacity:1},duration:250}),i.push({props:e,to:{opacity:0},duration:250}),i.push({props:e,to:{opacity:1},duration:250}),i},e.effectPulse=function(t){var e={scaleX:1,scaleY:1},i=[];return i.push({props:e,to:{scaleX:1.1,scaleY:1.1},duration:500}),i.push({props:e,to:{scaleX:1,scaleY:1},duration:500}),i},e.effectRubberBand=function(t){var e={scaleX:1,scaleY:1},i=[];return i.push({props:e,to:{scaleX:1.25,scaleY:.75},duration:300}),i.push({props:e,to:{scaleX:.75,scaleY:1.25},duration:100}),i.push({props:e,to:{scaleX:1.15,scaleY:.85},duration:100}),i.push({props:e,to:{scaleX:.95,scaleY:1.05},duration:150}),i.push({props:e,to:{scaleX:1.05,scaleY:.95},duration:100}),i.push({props:e,to:{scaleX:1,scaleY:1},duration:250}),i},e.effectShake=function(t){var e={x:0},i=[];return i.push({props:e,to:{x:-10},duration:100}),i.push({props:e,to:{x:10},duration:100}),i.push({props:e,to:{x:-10},duration:100}),i.push({props:e,to:{x:10},duration:100}),i.push({props:e,to:{x:-10},duration:100}),i.push({props:e,to:{x:10},duration:100}),i.push({props:e,to:{x:-10},duration:100}),i.push({props:e,to:{x:10},duration:100}),i.push({props:e,to:{x:-10},duration:100}),i.push({props:e,to:{x:0},duration:100}),i},e.effectSwing=function(t){var e={angle:0},i=[];return i.push({props:e,to:{angle:-15},duration:200}),i.push({props:e,to:{angle:-10},duration:200}),i.push({props:e,to:{angle:5},duration:200}),i.push({props:e,to:{angle:-5},duration:200}),i.push({props:e,to:{angle:0},duration:200}),i},e.effectTada=function(t){var e={scaleX:1,scaleY:1,angle:0},i={scaleX:.9,scaleY:.9,angle:-3},n={scaleX:1.1,scaleY:1.1,angle:3},r={scaleX:1.1,scaleY:1.1,angle:-3},o=[];return o.push({props:e,to:i,duration:100}),o.push({props:e,to:i,duration:100}),o.push({props:e,to:n,duration:100}),o.push({props:e,to:r,duration:100}),o.push({props:e,to:n,duration:100}),o.push({props:e,to:r,duration:100}),o.push({props:e,to:n,duration:100}),o.push({props:e,to:r,duration:100}),o.push({props:e,to:n,duration:100}),o.push({props:e,to:{scaleX:1,scaleY:1,angle:0},duration:100}),o},e.effectWobble=function(t){var e={x:0,angle:0},i=this.inst.x,n=[];return n.push({props:e,to:{x:-.25*i,angle:-5},duration:150}),n.push({props:e,to:{x:.2*i,angle:3},duration:150}),n.push({props:e,to:{x:-.15*i,angle:-3},duration:150}),n.push({props:e,to:{x:.1*i,angle:2},duration:150}),n.push({props:e,to:{x:-.05*i,angle:-1},duration:150}),n.push({props:e,to:{x:0*i,angle:0},duration:250}),n},e.effectJello=function(t){var e={x:0,skewX:0,skewY:0},i=[];return i.push({props:e,to:e,duration:111}),i.push({props:e,to:{x:0,skewX:-12.5,skewY:-12.5},duration:111}),i.push({props:e,to:{x:0,skewX:6.25,skewY:6.25},duration:111}),i.push({props:e,to:{x:0,skewX:-3.125,skewY:-3.125},duration:111}),i.push({props:e,to:{x:0,skewX:1.5625,skewY:1.5625},duration:111}),i.push({props:e,to:{x:0,skewX:-.78125,skewY:-.78125},duration:111}),i.push({props:e,to:{x:0,skewX:.390625,skewY:.390625},duration:111}),i.push({props:e,to:{x:0,skewX:-.1953125,skewY:-.1953125},duration:111}),i.push({props:e,to:{x:0,skewX:0,skewY:0},duration:112}),i},e.effectHeartbeat=function(t){var e={scaleX:1,scaleY:1},i=TWEEN.Easing.Quadratic.InOut,n=[];return n.push({props:e,to:{scaleX:1.3,scaleY:1.3},duration:140,easing:i}),n.push({props:e,to:{scaleX:1,scaleY:1},duration:140,easing:i}),n.push({props:e,to:{scaleX:1.3,scaleY:1.3},duration:140,easing:i}),n.push({props:e,to:{scaleX:1,scaleY:1},duration:280,easing:i}),n},e.effectBounceIn=function(t){var e={scaleX:.3,scaleY:.3},i=TWEEN.Easing.Cubic.InOut,n=[];return n.push({props:e,to:{scaleX:1.1,scaleY:1.1},duration:200,easing:i}),n.push({props:e,to:{scaleX:.9,scaleY:.9},duration:200,easing:i}),n.push({props:e,to:{scaleX:1.03,scaleY:1.03,opacity:1},duration:200,easing:i}),n.push({props:e,to:{scaleX:.97,scaleY:.97},duration:200,easing:i}),n.push({props:e,to:{scaleX:1,scaleY:1},duration:200,easing:i}),n},e.effectBounceInType=function(t){var e,i=[];switch(t[10]){case 0:e={y:-3e3},i.push({props:e,to:{y:25},duration:600}),i.push({props:e,to:{y:-10},duration:150}),i.push({props:e,to:{y:5},duration:150}),i.push({props:e,to:{y:0},duration:100});break;case 1:e={y:3e3},i.push({props:e,to:{y:-25},duration:600}),i.push({props:e,to:{y:10},duration:150}),i.push({props:e,to:{y:-5},duration:150}),i.push({props:e,to:{y:0},duration:100});break;case 2:e={x:-3e3},i.push({props:e,to:{x:25},duration:600}),i.push({props:e,to:{x:-10},duration:150}),i.push({props:e,to:{x:5},duration:150}),i.push({props:e,to:{x:0},duration:100});break;case 3:e={x:3e3},i.push({props:e,to:{x:-25},duration:600}),i.push({props:e,to:{x:10},duration:150}),i.push({props:e,to:{x:-5},duration:150}),i.push({props:e,to:{x:0},duration:100})}return i},e.effectBounceOut=function(t){var e={opacity:1,scaleX:1,scaleY:1},i=[];return i.push({props:e,to:{scaleX:.9,scaleY:.9,opacity:1},duration:200}),i.push({props:e,to:{scaleX:1.1,scaleY:1.1,opacity:1},duration:300}),i.push({props:e,to:{scaleX:1.1,scaleY:1.1,opacity:1},duration:50}),i.push({props:e,to:{scaleX:.3,scaleY:.3,opacity:0},duration:450}),i},e.effectBounceOutType=function(t){var e=[],i={x:0,y:0},n={x:0,y:0,opacity:1},r={x:0,y:0,opacity:1},o={x:0,y:0,opacity:1};switch(t[10]){case 0:n.y=-10,r.y=-this.runtime.original_height,r.opacity=0,o.y=20,o.opacity=1;break;case 1:n.y=10,r.y=this.runtime.original_height,r.opacity=0,o.y=-20,o.opacity=1;break;case 2:n.x=20,n.opacity=1,r.x=-this.runtime.original_width,r.opacity=0;break;case 3:n.x=-20,n.opacity=1,r.x=this.runtime.original_width,r.opacity=0}if(e.push({props:i,to:n,duration:200}),0===t[10]||3===t[10])e.push({props:i,to:o,duration:200}),e.push({props:i,to:o,duration:50}),e.push({props:i,to:r,duration:550});else e.push({props:i,to:r,duration:800});return e},e.effectFadeIn=function(t){return[{props:{opacity:0},to:{opacity:1},duration:1e3}]},e.effectFadeInType=function(t){var e={x:0,y:0,scaleX:1,scaleY:1,angle:0,opacity:0},i={x:0,y:0,opacity:1},n=this.inst.width,r=this.inst.height;switch(t[10]){case 0:e.y=r,e.opacity=0,i.y=0,i.opacity=1;break;case 1:e.y=-r,e.opacity=0,i.y=0,i.opacity=1;break;case 2:e.x=-n,e.opacity=0,i.x=0,i.opacity=1;break;case 3:e.x=n,e.opacity=0,i.x=0,i.opacity=1}return[{props:e,to:i,duration:1e3}]},e.effectFadeInBigType=function(t){var e={x:0,y:0,scaleX:1,scaleY:1,angle:0,opacity:0},i={x:0,y:0,opacity:1};switch(t[10]){case 0:e.y=this.runtime.original_height,e.opacity=0,i.y=0,i.opacity=1;break;case 1:e.y=-this.runtime.original_height,e.opacity=0,i.y=0,i.opacity=1;break;case 2:e.x=-this.runtime.original_width,e.opacity=0,i.x=0,i.opacity=1;break;case 3:e.x=this.runtime.original_width,e.opacity=0,i.x=0,i.opacity=1}return[{props:e,to:i,duration:1e3}]},e.effectFadeOut=function(t){return[{props:{opacity:1},to:{opacity:0},duration:1e3}]},e.effectFadeOutType=function(t){var e={opacity:0},i=this.inst.width,n=this.inst.height;switch(t[10]){case 0:e.y=-n;break;case 1:e.y=n;break;case 2:e.x=-i;break;case 3:e.x=i}return[{props:{y:0,opacity:1},to:e,duration:1e3}]},e.effectFadeOutBigType=function(t){var e={x:0,y:0,opacity:0};switch(t[10]){case 0:e.y=-this.runtime.original_height;break;case 1:e.y=this.runtime.original_height;break;case 2:e.x=-this.runtime.original_width;break;case 3:e.x=this.runtime.original_width}return[{props:{x:0,y:0,opacity:1,scaleX:1,scaleY:1,angle:0},to:e,duration:1e3}]},e.effectLightSpeedIn=function(t){var e=this.inst.width,i={y:0,opacity:0,scaleX:1,scaleY:1,angle:0,skewX:-30,x:e},n={opacity:0,x:-e};switch(t[8]){case 0:i.x=-e;break;case 1:i.x=e}var r=[];return r.push({props:i,to:{opacity:1,skewX:20},duration:600}),r.push({props:i,to:{skewX:-5},duration:200}),r.push({props:i,to:n,duration:200}),r},e.effectLightSpeedOut=function(t){var e=this.inst.width,i={opacity:0,x:-e,skewX:30};switch(t[8]){case 0:i.x=-e;break;case 1:i.x=e}return[{props:{x:0,y:0,opacity:1,scaleX:1,scaleY:1,angle:0},to:i,duration:1e3}]},e.effectRotateIn=function(t){return[{props:{angle:-200,opacity:0},to:{angle:0,opacity:1},duration:1e3}]},e.effectRotateInType=function(t){var e={opacity:1};switch(t[11]){case 0:e.angle=45;break;case 1:e.angle=-45;break;case 2:e.angle=-90;break;case 3:e.angle=45}return[{props:{opacity:0},to:e,duration:1e3}]},e.effectRotateOut=function(t){return[{props:{x:0,y:0,opacity:1,scaleX:1,scaleY:1,angle:0},to:{angle:200,opacity:0},duration:1e3}]},e.effectRotateOutType=function(t){var e={opacity:0};switch(t[11]){case 0:e.angle=-45;break;case 1:e.angle=45;break;case 2:e.angle=90;break;case 3:e.angle=-45}return[{props:{opacity:1,angle:0},to:e,duration:1e3}]},e.effectSlideInType=function(t){var e={opacity:0},i={opacity:1},n=this.inst.width,r=this.inst.height;switch(t[10]){case 0:e.y=r,i.y=0;break;case 1:e.y=-r,i.y=0;break;case 2:e.x=-n,i.x=0;break;case 3:e.x=n,i.x=0}return[{props:e,to:i,duration:1e3}]},e.effectSlideOutType=function(t){var e={x:0,y:0,opacity:0},i=this.inst.width,n=this.inst.height;switch(t[10]){case 0:e.y=-n;break;case 1:e.y=n;break;case 2:e.x=-i;break;case 3:e.x=i}return[{props:{x:0,y:0,opacity:1},to:e,duration:1e3}]},e.effectZoomIn=function(t){return[{props:{scaleX:.3,scaleY:.3,opacity:0},to:{scaleX:1,scaleY:1,opacity:1},duration:500}]},e.effectZoomInType=function(t){var e={scaleX:.1,scaleY:.1,opacity:0,x:0},i={scaleX:.475,scaleY:.475,x:0,opacity:1};switch(t[10]){case 0:e.y=1e3,i.y=-60;break;case 1:e.y=-1e3,i.y=60;break;case 2:e.x=-1e3,i.x=10;break;case 3:e.x=1e3,i.x=-10}var n=[];return n.push({props:e,to:i,duration:600}),n.push({props:e,to:{scaleX:1,scaleY:1,opacity:1,x:0,y:0},duration:400}),n},e.effectZoomOut=function(t){return[{props:{x:0,opacity:1,scaleX:1,scaleY:1,angle:0},to:{opacity:0,scaleX:.3,scaleY:.3},duration:500}]},e.effectZoomOutType=function(t){var e={x:0,y:0,opacity:1,scaleX:1,scaleY:1},i={scaleX:.475,scaleY:.475,x:0,y:0,opacity:1},n={scaleX:.1,scaleY:.1,x:0,y:0,opacity:0};switch(t[10]){case 0:i.y=60,n.y=-this.runtime.original_height;break;case 1:i.x=42,n.x=-this.runtime.original_width;break;case 2:i.x=-42,n.x=this.runtime.original_width;break;case 3:i.y=-60,n.y=this.runtime.original_height}var r=[];return r.push({props:e,to:i,duration:400,easing:TWEEN.Easing.Cubic.InOut}),r.push({props:e,to:n,duration:600,easing:TWEEN.Easing.Cubic.InOut}),r},e.effectHinge=function(t){var e={x:0,y:0,opacity:1,scaleX:1,scaleY:1,angle:0},i=0,n=0;switch(t[8]){case 0:i=80,n=60;break;case 1:i=-80,n=-60}var r=[];return r.push({props:e,to:{angle:i,opacity:1,x:0,y:0},duration:400,easing:TWEEN.Easing.Cubic.InOut}),r.push({props:e,to:{angle:n,opacity:1,x:0,y:0},duration:400,easing:TWEEN.Easing.Cubic.InOut}),r.push({props:e,to:{angle:i,opacity:1,x:0,y:0},duration:400,easing:TWEEN.Easing.Cubic.InOut}),r.push({props:e,to:{angle:n,opacity:1,x:0,y:0},duration:400,easing:TWEEN.Easing.Cubic.InOut}),r.push({props:e,to:{opacity:0,y:this.runtime.original_height,angle:0},duration:400,easing:TWEEN.Easing.Cubic.InOut}),r},e.effectJackInTheBox=function(t){var e={angle:30,opacity:0,scaleX:.1,scaleY:.1,x:0,y:0},i=[];return i.push({props:e,to:{angle:-10,opacity:.5,scaleX:.5,scaleY:.5},duration:500}),i.push({props:e,to:{angle:3,opacity:.7,scaleX:.7,scaleY:.7},duration:200}),i.push({props:e,to:{angle:0,opacity:1,scaleX:1,scaleY:1},duration:300}),i},e.effectRollin=function(t){var e=this.inst.width,i={angle:-120,opacity:0,x:-e,y:0,scaleX:1,scaleY:1};switch(t[9]){case 0:i.x=-e;break;case 1:i.x=e}return[{props:i,to:{angle:0,opacity:1,x:0,y:0},duration:1e3}]},e.effectRollOut=function(t){var e=this.inst.width,i={angle:120,opacity:0,x:-e,y:0};switch(t[8]){case 0:i.x=-e;break;case 1:i.x=e}return[{props:{x:0,y:0,opacity:1,scaleX:1,scaleY:1,angle:0},to:i,duration:1e3}]},e.effectMoveToPosition=function(t){var e=this.stageList[this.stageUUID];if(e){var i=e.props.positionX,n=e.props.positionY,r=e.props.time||0,o=e.props.ease,s=e.props.isRotate;return[{props:{x:0,y:0,opacity:1,scaleX:1,scaleY:1,angle:0},to:{x:i-this.originX,y:n-this.originY},duration:1e3*r,easing:o,isRotate:s}]}},e.effectMoveByDistance=function(t){var e=this.stageList[this.stageUUID];if(e){var i=e.props.distance,n=e.props.directAngle,r=e.props.time||0,o=e.props.ease,s=e.props.isRotate;return n=drama.to_radians(n),[{props:{x:0,y:0,opacity:1,scaleX:1,scaleY:1,angle:0},to:{x:Math.cos(n)*i,y:Math.sin(n)*i},duration:1e3*r,easing:o,isRotate:s}]}},e.saveToJSON=function(){return{}},e.loadFromJSON=function(t){},e.onDestroy=function(){if(this.group)this.group.removeAll(),this.group=null;if(this.chain)this.chain.destroy(),this.chain=null;this.propsMap=null,this.quque=null,this.defaultQueue=null,this.queueIndex=0,this.loopCount=0,this.loopNum=0},e.getSpeed=function(){var t=drama.distanceTo(this.inst.x,this.inst.y,this.lastX,this.lastY);this.lastX=this.inst.x,this.lastY=this.inst.y,this.speed=Math.round(t/this.runtime.dt)},e.getAcc=function(){this.acc=this.speed-this.lastSpeed,this.lastSpeed=this.speed},e.tick=function(){if(void 0===this.state)this.startDynamic(this.autoPlayQueue,1);if(this.state===i.PLAY){if(this.group)this.group.update();this.getSpeed(),this.getAcc()}},e.playQueue=function(){this.resetDynamic(),this.runtime.trigger(drama.behaviors.dynamic.prototype.cnds.IsLoopState,this.inst),this.playTimeline()},e.playTimeline=function(){var e=this;this.state=i.PLAY,this.runtime.trigger(drama.behaviors.dynamic.prototype.cnds.CheckState,this.inst),this.playChain(this.queue[this.queueIndex],function(){var t=e.queue[e.queueIndex];if(!e.propsMap[t][2]){if(e.queueIndex++,e.queueIndex<e.queue.length)e.playTimeline();else if(e.runtime.trigger(drama.behaviors.dynamic.prototype.cnds.CheckState,e.inst),!e.chain.isPlay)if(e.loopNum++,e.state=i.FINISH,e.runtime.trigger(drama.behaviors.dynamic.prototype.cnds.IsLoopState,e.inst),e.loopNum<e.loopCount)e.resetDynamic(),e.runtime.trigger(drama.behaviors.dynamic.prototype.cnds.IsLoopState,e.inst),e.playTimeline()}else e.runtime.DestroyInstance(e.inst)})},e.startDynamic=function(t,e){if(t&&0<t.length)this.loopCount=e<=0?1/0:e,this.loopNum=0,this.queue=t,this.playQueue()},e.resetDynamic=function(){if(this.chain)this.chain.stop();this.group.removeAll(),this.state=i.START,this.queueIndex=0},o.prototype.SpecificDynamic=function(t){return this.state===i.PLAY&&t===this.current_dynamic},o.prototype.SwitchDynamic=function(t){return t===this.current_dynamic},o.prototype.AnyDynamic=function(){return!0},o.prototype.CheckState=function(t,e){if(0===e)return this.queue[this.queueIndex]===t;else return this.queue[this.queueIndex-1]===t},o.prototype.IsLoopState=function(t){if(0==t)return this.state===i.START;else return this.state===i.FINISH},o.prototype.IsStart=function(){return this.state===i.START},o.prototype.IsPlay=function(){return this.state===i.PLAY},o.prototype.IsPaused=function(){return this.state===i.PAUSE},o.prototype.IsFinish=function(){return this.state===i.FINISH},t.cnds=new o,s.prototype.CustomPlay=function(t,e){this.startDynamic(t.split(","),e)},s.prototype.OrderPlay=function(t){this.startDynamic(this.defaultQueue,t)},s.prototype.StopPlay=function(){this.resetDynamic(),this.loopNum=0},s.prototype.SetStatus=function(t){if(0===t)this.state=i.PAUSE;else this.state=i.PLAY},t.acts=new s,a.prototype.speed=function(t){t.set_float(this.speed)},a.prototype.accelerate=function(t){t.set_float(this.acc)},a.prototype.dynamic=function(t){t.set_string(this.current_dynamic)},t.exps=new a}(),assert2(drama,"drama namespace not created"),assert2(drama.behaviors,"drama.behaviors not created"),drama.behaviors.EffectAnimation=function(t){this.runtime=t,this.shakeMag=0,this.shakeStart=0,this.shakeEnd=0,this.shakeMode=0},function(){var t=drama.behaviors.EffectAnimation.prototype;t.Type=function(t,e){this.behavior=t,this.objtype=e,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t,e){this.type=t,this.behavior=t.behavior,this.inst=e,this.runtime=t.runtime};var e=t.Instance.prototype;function i(){}function n(){}e.onCreate=function(){this.enabled=this.properties[0],this.isLoop=this.properties[1],this.loopTotal=this.properties[2],this.animationList=this.properties[3]||[],this.isPause=!1,this.isDistance=!1,this.isLoopStart=!1,this.isSwitchStage=!1,this.loopTotalFlag=0,this.isAudioPlay=!1;var i=this;this.keyIndex={},this.animationList.map(function(t,e){i.keyIndex[t.name]=e}),this.currentAnimationIndex=0,this.currentSpeed=0,this.currentAcceleration=0,this.targetX=this.inst.x,this.targetY=this.inst.y,this.audioInst=xf.audioInstance(this.runtime),this.originX=this.inst.x,this.originY=this.inst.y,this.actVolume=0,this.isActVolume=!1,this.eventFlag={},this.eventFlag[this.type.name]={}},e.saveToJSON=function(){return{}},e.loadFromJSON=function(t){},e.remainDistance=function(){var t=this.targetX-this.inst.x,e=this.targetY-this.inst.y;return Math.sqrt(t*t+e*e)},e.handTick=function(){if(!(this.currentAnimationIndex>this.animationList.length)){var t=this.currentAnimationIndex;if(0!=this.animationList.length){var e=this.animationList[t];if(e){if(0==t&&!this.isLoopStart)this.eventFlag[this.type.name].isIsLoopStart=!0,this.runtime.trigger(drama.behaviors.EffectAnimation.prototype.cnds.IsLoopStart,this.inst),this.isLoopStartFlag=!0,this.runtime.trigger(drama.behaviors.EffectAnimation.prototype.cnds.IsLoopStartOrEnd,this.inst),this.isLoopStartFlag=!1,this.eventFlag[this.type.name].isIsLoopStart=!1,this.isLoopStart=!0;if(!this.isSwitchStage)this.runtime.trigger(drama.behaviors.EffectAnimation.prototype.cnds.SwitchStage,this.inst),this.eventFlag[this.type.name].isAnyStage=!0,this.runtime.trigger(drama.behaviors.EffectAnimation.prototype.cnds.AnyStage,this.inst),this.eventFlag[this.type.name].isAnyStage=!1,this.isSwitchStage=!0;var i=e.info,n=Number(i.beginSpeed),r=Number(i.maxSpeed);this.currentAcceleration=Number(i.addSpeed),this.currentSpeed+=this.currentAcceleration*(1/60);var o=n+this.currentSpeed;if(r*(1/60)<o)o=r*(1/60);if(i.sound&&i.hasSound&&!this.isAudioPlay){this.audioInst.Stop("effectanimation"),this.audioInst.Play([i.sound.split(".")[0]],0,0,"effectanimation");var s=i.volum/100;if(this.isActVolume)s=this.actVolume/100;this.audioInst.SetVolume(s),this.isAudioPlay=!0}if(1==e.type){var a=this.targetX-this.inst.x,l=this.targetY-this.inst.y;if(this.angle=Math.atan2(l,a),i.autoTurn)this.inst.angle=this.angle;if(this.targetX=i.targetPos.x,this.targetY=i.targetPos.y,this.remainDistance()>o)this.inst.x+=o*Math.cos(this.angle),this.inst.y+=o*Math.sin(this.angle);else this.inst.x=this.targetX,this.inst.y=this.targetY,this.currentSpeed=0,this.audioInst.Stop("effectanimation");if(this.inst.set_bbox_changed(),~~this.inst.x!=~~this.targetX||~~this.inst.y!=~~this.targetY)return}else if(2==e.type){if(this.angle=i.moveDir/180*Math.PI,i.autoTurn)this.inst.angle=this.angle;if(!this.isDistance)this.targetX=this.inst.x+i.moveDistance*Math.cos(this.angle),this.targetY=this.inst.y+i.moveDistance*Math.sin(this.angle),this.isDistance=!0;if(this.remainDistance()>o)this.inst.x+=o*Math.cos(this.angle),this.inst.y+=o*Math.sin(this.angle);else this.inst.x=this.targetX,this.inst.y=this.targetY,this.currentSpeed=0,this.audioInst.Stop("effectanimation");if(this.inst.set_bbox_changed(),~~this.inst.x!=~~this.targetX||~~this.inst.y!=~~this.targetY)return}if(this.isDistance=!1,this.currentAnimationIndex++,this.isAudioPlay=!1,this.isSwitchStage=!1,this.currentAnimationIndex==this.animationList.length)this.eventFlag[this.type.name].isIsLoopEnd=!0,this.runtime.trigger(drama.behaviors.EffectAnimation.prototype.cnds.IsLoopEnd,this.inst),this.isLoopEndFlag=!0,this.runtime.trigger(drama.behaviors.EffectAnimation.prototype.cnds.IsLoopStartOrEnd,this.inst),this.isLoopEndFlag=!1,this.eventFlag[this.type.name].isIsLoopEnd=!1;if(this.isLoop){if(this.currentAnimationIndex==this.animationList.length)this.currentAnimationIndex=0,this.inst.x=this.originX,this.inst.y=this.originY,this.isLoopStart=!1}else if(this.currentAnimationIndex==this.animationList.length)if(this.loopTotalFlag++,0<this.loopTotalFlag&&this.loopTotalFlag<this.loopTotal)this.currentAnimationIndex=0,this.inst.x=this.originX,this.inst.y=this.originY,this.isLoopStart=!1}}}},e.tick=function(){if(this.enabled&&!this.isPause)this.handTick()},i.prototype.SpecificStage=function(t){if(this.keyIndex[t]==this.currentAnimationIndex)return!0},i.prototype.SwitchStage=function(t){if(this.keyIndex[t]==this.currentAnimationIndex)return!0;else return!1},i.prototype.AnyStage=function(){if(this.eventFlag[this.type.name].isAnyStage)return!0;else return!1},i.prototype.IsEffectEnabled=function(t){return this.enabled!=t},i.prototype.IsEnabled=function(){return 0!=this.enabled},i.prototype.IsDisabled=function(){return 0==this.enabled},i.prototype.IsPaused=function(){return 1==this.isPause&&0!=this.enabled},i.prototype.IsLoopStartOrEnd=function(t){if(0==t&&this.isLoopStartFlag&&this.eventFlag[this.type.name].isIsLoopStart)return!0;else if(1==t&&this.isLoopEndFlag&&this.eventFlag[this.type.name].isIsLoopEnd)return!0;return!1},i.prototype.IsLoopStart=function(){if(this.eventFlag[this.type.name].isIsLoopStart)return!0;else return!1},i.prototype.IsLoopEnd=function(){if(this.eventFlag[this.type.name].isIsLoopEnd)return!0;else return!1},t.cnds=new i,n.prototype.SetEnabled=function(t){this.enabled=0!==t},n.prototype.SetStatus=function(t){if(0==t){if(this.isPause=!0,this.audioInst)this.audioInst.SetPaused("effectanimation",0)}else if(1==t){if(this.isPause=!1,this.audioInst)this.audioInst.SetPaused("effectanimation",1)}else if(this.isPause=!this.isPause,this.audioInst)this.audioInst.SetPaused("effectanimation",this.isPause?0:1)},n.prototype.Pause=function(){if(this.isPause=!0,this.audioInst)this.audioInst.SetPaused("effectanimation",0)},n.prototype.Continue=function(){if(this.isPause=!1,this.audioInst)this.audioInst.SetPaused("effectanimation",1)},n.prototype.SetVolume=function(t){if(this.actVolume=t,this.isActVolume=!0,this.audioInst)this.audioInst.SetVolume(t/100)},t.acts=new n}(),assert2(drama,"drama namespace not created"),assert2(drama.behaviors,"drama.behaviors not created"),drama.behaviors.Fade=function(t){this.runtime=t},function(){var t=drama.behaviors.Fade.prototype;t.Type=function(t,e){this.behavior=t,this.objtype=e,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t,e){this.type=t,this.behavior=t.behavior,this.inst=e,this.runtime=t.runtime};var e=t.Instance.prototype;e.onCreate=function(){if(this.fadeInTime=this.properties[0],this.waitTime=this.properties[1],this.fadeOutTime=this.properties[2],this.destroy=this.properties[3],this.activeAtStart=this.properties[4],this.setMaxOpacity=!1,this.stage=this.activeAtStart?0:3,this.recycled)this.stageTime.reset();else this.stageTime=new drama.KahanAdder;if(this.maxOpacity=this.inst.opacity?this.inst.opacity:1,this.activeAtStart)if(0===this.fadeInTime){if(this.stage=1,0===this.waitTime)this.stage=2}else this.inst.opacity=0,this.runtime.redraw=!0},e.saveToJSON=function(){return{fit:this.fadeInTime,wt:this.waitTime,fot:this.fadeOutTime,s:this.stage,st:this.stageTime.sum,mo:this.maxOpacity}},e.loadFromJSON=function(t){this.fadeInTime=t.fit,this.waitTime=t.wt,this.fadeOutTime=t.fot,this.stage=t.s,this.stageTime.reset(),this.stageTime.sum=t.st,this.maxOpacity=t.mo},e.tick=function(){if(this.stageTime.add(this.runtime.getDt(this.inst)),0===this.stage)if(this.inst.opacity=this.stageTime.sum/this.fadeInTime*this.maxOpacity,this.runtime.redraw=!0,this.inst.opacity>=this.maxOpacity)this.inst.opacity=this.maxOpacity,this.stage=1,this.stageTime.reset(),this.runtime.trigger(drama.behaviors.Fade.prototype.cnds.OnFadeInEnd,this.inst),this.isOnFadeInEnd=!0,this.runtime.trigger(drama.behaviors.Fade.prototype.cnds.OnFadeChange,this.inst),this.isOnFadeInEnd=!1;if(1===this.stage)if(this.stageTime.sum>=this.waitTime)this.stage=2,this.stageTime.reset(),this.runtime.trigger(drama.behaviors.Fade.prototype.cnds.OnWaitEnd,this.inst),this.isOnWaitEnd=!0,this.runtime.trigger(drama.behaviors.Fade.prototype.cnds.OnFadeChange,this.inst),this.isOnWaitEnd=!1;if(2===this.stage)if(0!==this.fadeOutTime)if(this.inst.opacity=this.maxOpacity-this.stageTime.sum/this.fadeOutTime*this.maxOpacity,this.runtime.redraw=!0,this.inst.opacity<0)if(this.inst.opacity=0,this.stage=3,this.stageTime.reset(),this.runtime.trigger(drama.behaviors.Fade.prototype.cnds.OnFadeOutEnd,this.inst),this.isOnFadeOutEnd=!0,this.runtime.trigger(drama.behaviors.Fade.prototype.cnds.OnFadeChange,this.inst),this.isOnFadeOutEnd=!1,this.destroy)this.runtime.DestroyInstance(this.inst)},e.doStart=function(){if(this.stage=0,this.stageTime.reset(),0===this.fadeInTime){if(this.stage=1,0===this.waitTime)this.stage=2}else this.inst.opacity=0,this.runtime.redraw=!0};var i=["fade-in","wait","fade-out","done"];function n(){}function r(){}function o(){}e.getDebuggerValues=function(t){t.push({title:this.type.name,properties:[{name:"Fade in time",value:this.fadeInTime},{name:"Wait time",value:this.waitTime},{name:"Fade out time",value:this.fadeOutTime},{name:"Stage",value:i[this.stage],readonly:!0}]})},e.onDebugValueEdited=function(t,e,i){switch(e){case"Fade in time":this.fadeInTime=i;break;case"Wait time":this.waitTime=i;break;case"Fade out time":this.fadeOutTime=i}},n.prototype.OnFadeOutEnd=function(){return!0},n.prototype.OnFadeInEnd=function(){return!0},n.prototype.OnWaitEnd=function(){return!0},n.prototype.OnFadeChange=function(t){if(0==t&&this.isOnFadeOutEnd)return!0;else if(1==t&&this.isOnFadeInEnd)return!0;else if(2==t&&this.isOnWaitEnd)return!0;return!1},t.cnds=new n,r.prototype.StartFade=function(){if(!this.activeAtStart&&!this.setMaxOpacity)this.maxOpacity=this.inst.opacity?this.inst.opacity:1,this.setMaxOpacity=!0;if(3===this.stage)this.doStart()},r.prototype.RestartFade=function(){this.doStart()},r.prototype.SetFadeInTime=function(t){if(t<0)t=0;this.fadeInTime=t},r.prototype.SetWaitTime=function(t){if(t<0)t=0;this.waitTime=t},r.prototype.SetFadeOutTime=function(t){if(t<0)t=0;this.fadeOutTime=t},r.prototype.SetFadeValue=function(t,e,i){if(i<0)i=0;if(e<0)e=0;if(t<0)t=0;this.fadeInTime=i,this.waitTime=e,this.fadeOutTime=t},t.acts=new r,o.prototype.FadeInTime=function(t){t.set_float(this.fadeInTime)},o.prototype.WaitTime=function(t){t.set_float(this.waitTime)},o.prototype.FadeOutTime=function(t){t.set_float(this.fadeOutTime)},t.exps=new o}(),assert2(drama,"drama namespace not created"),assert2(drama.behaviors,"drama.behaviors not created"),drama.behaviors.Flash=function(t){this.runtime=t},function(){var t=drama.behaviors.Flash.prototype;t.Type=function(t,e){this.behavior=t,this.objtype=e,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t,e){this.type=t,this.behavior=t.behavior,this.inst=e,this.runtime=t.runtime};var e=t.Instance.prototype;function i(){}function n(){}e.onCreate=function(){this.ontime=0,this.offtime=0,this.stage=0,this.stagetimeleft=0,this.timeleft=0},e.saveToJSON=function(){return{ontime:this.ontime,offtime:this.offtime,stage:this.stage,stagetimeleft:this.stagetimeleft,timeleft:this.timeleft}},e.loadFromJSON=function(t){if(this.ontime=t.ontime,this.offtime=t.offtime,this.stage=t.stage,this.stagetimeleft=t.stagetimeleft,this.timeleft=t.timeleft,null===this.timeleft)this.timeleft=1/0},e.tick=function(){if(!(this.timeleft<=0)){var t=this.runtime.getDt(this.inst);if(this.timeleft-=t,this.timeleft<=0)return this.timeleft=0,this.inst.opacity=1,this.runtime.redraw=!0,void this.runtime.trigger(drama.behaviors.Flash.prototype.cnds.OnFlashEnded,this.inst);if(this.stagetimeleft-=t,this.stagetimeleft<=0){if(0===this.stage)this.inst.opacity=0,this.stage=1,this.stagetimeleft+=this.offtime;else this.inst.opacity=1,this.stage=0,this.stagetimeleft+=this.ontime;this.runtime.redraw=!0}}},e.getDebuggerValues=function(t){t.push({title:this.type.name,properties:[{name:"'On' time",value:this.ontime},{name:"'Off' time",value:this.offtime},{name:"Is flashing",value:0<this.timeleft,readonly:!0},{name:"Time left",value:this.timeleft,readonly:!0}]})},e.onDebugValueEdited=function(t,e,i){switch(e){case"'On' time":this.ontime=i;break;case"'Off' time":this.offtime=i}},i.prototype.IsFlashing=function(){return 0<this.timeleft},i.prototype.OnFlashEnded=function(){return!0},t.cnds=new i,n.prototype.Flash=function(t,e,i){this.ontime=t,this.offtime=e,this.stage=1,this.stagetimeleft=e,this.timeleft=i,this.inst.opacity=0,this.runtime.redraw=!0},n.prototype.StopFlashing=function(){this.timeleft=0,this.inst.opacity=1,this.runtime.redraw=!0},t.acts=new n,t.exps=new function(){}}(),assert2(drama,"drama namespace not created"),assert2(drama.behaviors,"drama.behaviors not created"),drama.behaviors.Follow=function(t){this.runtime=t},function(){var t=drama.behaviors.Follow.prototype;t.Type=function(t,e){this.behavior=t,this.objtype=e,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t,e){this.type=t,this.behavior=t.behavior,this.inst=e,this.runtime=t.runtime};var e=t.Instance.prototype;e.onCreate=function(){this.direction=this.properties[0],this.speed=this.properties[1],this.mode=this.properties[2],this.enabled=this.properties[3],this.isTouchBegin=!1,this.isMoving=!1,this.isClick=!1;var t=0<this.runtime.fullscreen_mode?document:this.runtime.canvas,e=this;if(this.runtime.isMobile){if(xf.getSupportsPassive())t.addEventListener("touchstart",function(t){e.onTouchStart(t)},{passive:!0}),t.addEventListener("touchmove",function(t){e.onTouchMove(t)},{passive:!0});else t.addEventListener("touchstart",function(t){e.onTouchStart(t)}),t.addEventListener("touchmove",function(t){e.onTouchMove(t)});t.addEventListener("touchend",function(t){e.onTouchEnd(t)},!1),t.addEventListener("touchcancel",function(t){e.onTouchEnd(t)},!1)}else t.addEventListener("mousedown",function(t){if(1==t.which)e.onMouseDown(t)},!1),t.addEventListener("mouseup",function(t){e.onMouseUp(t)},!1),t.addEventListener("mousemove",function(t){e.onMouseMove(t)},!1),t.addEventListener("click",function(t){e.onClick(t)},!1)},e.handTouches=function(t){var e,i,n,r,o;for(e=0,i=t.changedTouches.length;e<i;e++){var s=(n=t.changedTouches[e]).pageX,a=n.pageY,l=drama.convertPageXY(s,a);r=l.pageX,o=l.pageY}return{pageX:r,pageY:o}},e.onTouchStart=function(t){var e=this.handTouches(t),i=this.runtime;this.isTouchBegin=!0,this.moveX=0,this.moveY=0,this.downStageX=Math.round((e.pageX-i.canvas.offsetLeft)/i.aspect_scale*i.draw_width/i.cssWidth),this.downStageY=Math.round((e.pageY-i.canvas.offsetTop)/i.aspect_scale*i.draw_height/i.cssHeight),this.moveStageX=this.downStageX,this.moveStageY=this.downStageY},e.onTouchMove=function(t){var e=this.handTouches(t),i=this.runtime;if(2==this.mode)this.isTouchBegin=!0,this.moveX=0,this.moveY=0,this.downStageX=Math.round((e.pageX-i.canvas.offsetLeft)/i.aspect_scale*i.draw_width/i.cssWidth),this.downStageY=Math.round((e.pageY-i.canvas.offsetTop)/i.aspect_scale*i.draw_height/i.cssHeight);if(this.isTouchBegin)this.isMoving=!0;this.moveStageX=Math.round((e.pageX-i.canvas.offsetLeft)/i.aspect_scale*i.draw_width/i.cssWidth),this.moveStageY=Math.round((e.pageY-i.canvas.offsetTop)/i.aspect_scale*i.draw_height/i.cssHeight)},e.onTouchEnd=function(){this.isTouchBegin=!1,this.isMoving=!1},e.onMouseDown=function(t){if(0!=this.mode){var e=this.runtime;this.isTouchBegin=!0,this.moveX=0,this.moveY=0,this.downStageX=Math.round((t.pageX-e.canvas.offsetLeft)/e.aspect_scale*e.draw_width/e.cssWidth),this.downStageY=Math.round((t.pageY-e.canvas.offsetTop)/e.aspect_scale*e.draw_height/e.cssHeight),this.moveStageX=this.downStageX,this.moveStageY=this.downStageY}},e.onMouseMove=function(t){if(0!=this.mode){var e=this.runtime;if(2==this.mode)this.isTouchBegin=!0,this.moveX=0,this.moveY=0,this.downStageX=Math.round((t.pageX-e.canvas.offsetLeft)/e.aspect_scale*e.draw_width/e.cssWidth),this.downStageY=Math.round((t.pageY-e.canvas.offsetTop)/e.aspect_scale*e.draw_height/e.cssHeight);if(this.isTouchBegin)this.isMoving=!0;this.moveStageX=Math.round((t.pageX-e.canvas.offsetLeft)/e.aspect_scale*e.draw_width/e.cssWidth),this.moveStageY=Math.round((t.pageY-e.canvas.offsetTop)/e.aspect_scale*e.draw_height/e.cssHeight)}},e.onMouseUp=function(){this.isTouchBegin=!1,this.isMoving=!1},e.onClick=function(){if(1!=this.mode&&2!=this.mode){this.isTouchBegin=!0,this.isClick=!0;var t=this.runtime;this.moveX=0,this.moveY=0,this.downStageX=Math.round((event.pageX-t.canvas.offsetLeft)/t.aspect_scale*t.draw_width/t.cssWidth),this.downStageY=Math.round((event.pageY-t.canvas.offsetTop)/t.aspect_scale*t.draw_height/t.cssHeight),this.moveStageX=this.downStageX,this.moveStageY=this.downStageY}},e.tick=function(){if(this.isTouchBegin&&this.enabled){if(60<this.speed)this.speed=60;if(this.moveX=this.moveStageX-this.downStageX,this.moveY=this.moveStageY-this.downStageY,0==this.mode){if(!this.isClick)return;switch(this.direction){case 0:if(~~(this.moveX+this.downStageX-this.inst.x)*this.speed/60==0&&~~(this.moveY+this.downStageY-this.inst.y)*this.speed/60==0)this.isClick=!1;break;case 1:if(~~(this.moveX+this.downStageX-this.inst.x)*this.speed/60==0)this.isClick=!1;break;case 2:if(~~(this.moveY+this.downStageY-this.inst.y)*this.speed/60==0)this.isClick=!1}}switch(this.direction){case 0:this.inst.x+=(this.moveX+this.downStageX-this.inst.x)*this.speed/60,this.inst.y+=(this.moveY+this.downStageY-this.inst.y)*this.speed/60;break;case 1:this.inst.x+=(this.moveX+this.downStageX-this.inst.x)*this.speed/60;break;case 2:this.inst.y+=(this.moveY+this.downStageY-this.inst.y)*this.speed/60}this.inst.set_bbox_changed()}}}(),assert2(drama,"drama namespace not created"),assert2(drama.behaviors,"drama.behaviors not created"),drama.behaviors.jumpthru=function(t){this.runtime=t},function(){var t=drama.behaviors.jumpthru.prototype;t.Type=function(t,e){this.behavior=t,this.objtype=e,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t,e){this.type=t,this.behavior=t.behavior,this.inst=e,this.runtime=t.runtime};var e=t.Instance.prototype;function i(){}function n(){}e.onCreate=function(){this.inst.extra.jumpthruEnabled=this.properties[0]},e.tick=function(){},e.getDebuggerValues=function(t){t.push({title:this.type.name,properties:[{name:"Enabled",value:this.inst.extra.jumpthruEnabled}]})},e.onDebugValueEdited=function(t,e,i){if("Enabled"===e)this.inst.extra.jumpthruEnabled=i},i.prototype.IsEnabled=function(){return this.inst.extra.jumpthruEnabled},t.cnds=new i,n.prototype.SetEnabled=function(t){this.inst.extra.jumpthruEnabled=!!t},t.acts=new n}(),assert2(drama,"drama namespace not created"),assert2(drama.behaviors,"drama.behaviors not created"),drama.behaviors.LinearPaths=function(t){this.runtime=t},function(){var t=drama.behaviors.LinearPaths.prototype;t.Type=function(t,e){this.behavior=t,this.objtype=e,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t,e){this.type=t,this.behavior=t.behavior,this.inst=e,this.runtime=t.runtime};var e=t.Instance.prototype;function i(){}function n(){}function r(){}e.onCreate=function(){this.maxspeed=this.properties[0],this.acc=this.properties[1],this.mode=this.properties[2],this.rotateEnabled=this.properties[3],this.flipEnabled=this.properties[4],this.enabled=this.properties[5],this.paths=this.properties[6].concat(),this.speed=0,this.localX=0,this.localY=0,this.startIndex=0,this.targetIndex=1,this.isReverse=!1,this.isMoving=!1,this.showPathPoint=!1},e.saveToJSON=function(){return{}},e.getIndex=function(t){var e=t,i=this.paths.length;if(this.isReverse)e=i-t-1;if(e<0)return 0;if(i<=e)return i-1;else return e},e.loadFromJSON=function(t){},e.tick=function(t){if(this.enabled){if(this.paths.length<2)return;var e=this.paths[this.targetIndex],i=e[0],n=e[1],r=this.runtime.getDt(this.inst),o=this.acc*r;if(this.speed+o<this.maxspeed)this.speed+=o;else this.speed=this.maxspeed;var s=this.speed*r,a=0,l=0,c=!1,u=!1,h=this.localX,d=this.localY;if(i===h)l=s;else if(n===d)a=s;else{var p=this.inst.x,f=this.inst.y,m=(p-h+i-p)/(f-d+n-f),g=Math.atan(m);a=Math.abs(s*Math.sin(g)),l=Math.abs(s*Math.cos(g))}if(i!==h)if(h<i)if(i<h+a)h=i;else h+=a;else if(h-a<i)h=i;else h-=a;if(n!==d)if(d<n)if(n<d+l)d=n;else d+=l;else if(d-l<n)d=n;else d-=l;if(h===i)c=!0;if(d===n)u=!0;var y=this.inst.x,v=this.inst.y,b=this.inst.angle,_=h-this.localX,w=d-this.localY;if(this.rotateEnabled)this.inst.angle=Math.atan2(w,_);if(0!==_)this.inst.x+=_;if(0!==w)this.inst.y+=w;if(this.inst.set_bbox_changed(),this.runtime.testOverlapSolid(this.inst))return this.inst.x=y,this.inst.y=v,this.inst.angle=b,this.inst.set_bbox_changed(),this.enabled=!1,void(this.isMoving=!1);if(this.localX=h,this.localY=d,c&&u)if(this.runtime.trigger(drama.behaviors.LinearPaths.prototype.cnds.IsArrivedPoint,this.inst),this.runtime.trigger(drama.behaviors.LinearPaths.prototype.cnds.IsArrivedAnyPoint,this.inst),this.targetIndex+1<this.paths.length)this.startIndex=this.targetIndex,this.targetIndex+=1;else if(0===this.mode){if(this.startIndex=0,this.targetIndex=1,this.isReverse=!this.isReverse,this.flipEnabled)this.inst.width*=-1;this.paths.reverse()}else if(1===this.mode)this.isMoving=!1;else this.startIndex=this.targetIndex,this.targetIndex=0;else this.isMoving=!0}},e.getDebuggerValues=function(t){t.push({title:this.type.name,properties:[{name:"是否移动中",value:this.enabled&&this.isMoving,readonly:!0},{name:"出发点编号",value:this.getIndex(this.startIndex),readonly:!0},{name:"目标点编号",value:this.getIndex(this.targetIndex)},{name:"目标点的总数",value:this.paths.length-1,readonly:!0},{name:"最大速度",value:this.maxspeed},{name:"加速度",value:this.acc},{name:"显示路径点(需在运动前开启)",value:this.showPathPoint}]})},e.onDebugValueEdited=function(t,e,i){if(t===this.type.name)if("最大速度"===e)this.maxspeed=i;else if("加速度"===e)this.acc=i;else if("目标点编号"===e)this.targetIndex=this.getIndex(i);else if("显示路径点(需在运动前开启)"===e)if(this.showPathPoint=i){if(!this.polyImage){var n=this.paths,r=0,o=0,s=0,a=0,l=!0,c=!1,u=void 0;try{for(var h,d=n[Symbol.iterator]();!(l=(h=d.next()).done);l=!0){var p=h.value;r=Math.min(r,p[0]),o=Math.max(o,p[0]),s=Math.min(s,p[1]),a=Math.max(a,p[1])}}catch(t){c=!0,u=t}finally{try{if(!l&&null!=d.return)d.return()}finally{if(c)throw u}}var f=o-r+10,m=a-s+10,g=new xf.xfImage;g.name="路径点调试图片",g.x=this.inst.x+r,g.y=this.inst.y+s,g.width=f,g.height=m,g.updateTransform(),this.polyImage=g;var y=xf.createCanvas(f,m),v=y.getContext("2d");v.save(),v.strokeStyle="red";for(var b=0,_=n.length;b<_;b++){var w=n[b],x=w[0]-r+5,S=w[1]-s+5;if(0===b)v.moveTo(x,S);else v.lineTo(x,S);v.fillStyle="red",v.fillRect(x-5,S-5,10,10),v.stroke()}v.restore(),this.polyImage.source=y}this.polyImage.addRenderList()}else if(this.polyImage)this.polyImage.removeRenderList()},i.prototype.IsMoving=function(){return this.isMoving&&this.enabled},i.prototype.IsStop=function(){return!this.isMoving||!this.enabled},i.prototype.IsArrivedPoint=function(t){var e=this.paths[this.getIndex(t)];if(e)return this.localX===e[0]&&this.localY===e[1];else return!1},i.prototype.IsArrivedAnyPoint=function(){return!0},i.prototype.IsBewteenPoints=function(t,e){var i=Math.min(t,e),n=Math.max(t,e),r=this.getIndex(this.startIndex),o=this.getIndex(this.targetIndex);return r!==o&&i<=r&&r<=n&&i<=o&&o<=n},t.cnds=new i,n.prototype.StartMove=function(){this.enabled=!0},n.prototype.StopMove=function(){this.enabled=!1},n.prototype.SetPoint=function(t){this.targetIndex=this.getIndex(t)},n.prototype.SetParams=function(t,e){this.maxspeed=t,this.acc=e},t.acts=new n,r.prototype.GetTargetPoint=function(t){t.set_float(this.getIndex(this.targetIndex))},r.prototype.GetTargetPointX=function(t,e){var i=this.paths[this.getIndex(e)];t.set_float(i[0])},r.prototype.GetTargetPointY=function(t,e){var i=this.paths[this.getIndex(e)];t.set_float(i[1])},r.prototype.GetTargetPointNumber=function(t){t.set_float(this.paths.length)},r.prototype.GetLastTargetPoint=function(t){t.set_float(this.getIndex(this.startIndex))},t.exps=new r}(),assert2(drama,"drama namespace not created"),assert2(drama.behaviors,"drama.behaviors not created"),drama.behaviors.LOS=function(t){this.runtime=t},function(){var t=drama.behaviors.LOS.prototype;t.Type=function(t,e){this.behavior=t,this.objtype=e,this.runtime=t.runtime};var e=t.Type.prototype;e.onCreate=function(){this.obstacleTypes=[]},e.findLosBehavior=function(t){var e,i,n;for(e=0,i=t.behavior_insts.length;e<i;++e)if((n=t.behavior_insts[e])instanceof drama.behaviors.LOS.prototype.Instance&&n.type===this)return n;return null},t.Instance=function(t,e){this.type=t,this.behavior=t.behavior,this.inst=e,this.runtime=t.runtime};var i=t.Instance.prototype;i.onCreate=function(){this.getLosInstances={},this.inLosTypeIndex=null,this.outLosTypeIndex=null,this.obstacleMode=this.properties[0],this.range=this.properties[1],this.cone=drama.to_radians(this.properties[2]),this.useCollisionCells=this.properties[3],this.startRadians=drama.to_radians(this.properties[4]||0)},i.onDestroy=function(){},i.saveToJSON=function(){var t,e,i={r:this.range,c:this.cone,t:[]};for(t=0,e=this.type.obstacleTypes.length;t<e;t++)i.t.push(this.type.obstacleTypes[t].sid);return i},i.loadFromJSON=function(t){var e,i,n;for(this.range=t.r,this.cone=t.c,drama.clearArray(this.type.obstacleTypes),e=0,i=t.t.length;e<i;e++)if(n=this.runtime.getObjectTypeBySid(t.t[e]))this.type.obstacleTypes.push(n)},i.tick=function(){},i.checkLos=function(){for(var t=this.runtime.types_by_index,e=0;e<t.length;e++){var i=t[e];if(i.default_instance)if(i.index!==this.inst.type.index){var n,r=this.checkLosInstances(i.instances),o=this.getLosInstances[i.index];if(r)for(n=0;n<r.length;n++)if(!o||-1===o.indexOf(r[n]))this.inLosTypeIndex=i.index,this.runtime.trigger(drama.behaviors.LOS.prototype.cnds.InLos,this.inst),this.inLosTypeIndex=null;if(o){for(n=0;n<o.length;n++)if(!r||-1===r.indexOf(o[n]))this.outLosTypeIndex=i.index,this.runtime.trigger(drama.behaviors.LOS.prototype.cnds.OutLos,this.inst),this.outLosTypeIndex=null;o.length=0}this.getLosInstances[i.index]=r}}},i.checkLosInstances=function(t){if(!t||t.length<=0)return null;for(var e=[],i=0;i<t.length;i++){var n=t[i];if(this.hasLOSto(n.x,n.y))e.push(n.uid)}return e};var u=[],h=new drama.rect(0,0,0,0);function n(){}i.hasLOSto=function(t,e){var i=this.inst.x,n=this.inst.y,r=this.inst.angle+this.startRadians+this.cone/2;if(this.inst.width<0)r+=Math.PI;if(drama.distanceTo(i,n,t,e)>this.range)return!1;var o,s,a,l,c=drama.angleTo(i,n,t,e);if(drama.angleDiff(r,c)>this.cone/2)return!1;if(h.set(i,n,t,e),h.normalize(),0===this.obstacleMode){if(this.useCollisionCells)this.runtime.getSolidCollisionCandidates(this.inst.layer,h,u);else if(l=this.runtime.getSolidBehavior())drama.appendArray(u,l.my_instances.valuesRef());for(o=0,s=u.length;o<s;++o)if((a=u[o]).extra.solidEnabled&&a!==this.inst)if(this.runtime.testSegmentOverlap(i,n,t,e,a))return drama.clearArray(u),!1}else{if(this.useCollisionCells)this.runtime.getTypesCollisionCandidates(this.inst.layer,this.type.obstacleTypes,h,u);else for(o=0,s=this.type.obstacleTypes.length;o<s;++o)drama.appendArray(u,this.type.obstacleTypes[o].instances);for(o=0,s=u.length;o<s;++o)if((a=u[o])!==this.inst)if(this.runtime.testSegmentOverlap(i,n,t,e,a))return drama.clearArray(u),!1}return drama.clearArray(u),!0},i.getDebuggerValues=function(t){t.push({title:this.type.name,properties:[{name:"Range",value:this.range},{name:"Cone of view",value:drama.to_degrees(this.cone)}]})},i.onDebugValueEdited=function(t,e,i){switch(e){case"Range":this.range=i;break;case"Cone of view":this.cone=drama.to_radians(i)}};var g=new drama.ObjectSet,y=new drama.ObjectSet;function r(){}function o(){}n.prototype.HasLOSToObject=function(t){if(!t)return!1;var e,i,n,r,o,s,a,l,c=this.runtime.getCurrentConditionObjectType().getCurrentSol(),u=t.getCurrentSol(),h=c.getObjects(),d=u.getObjects();if(c.select_all)drama.clearArray(c.else_instances);if(u.select_all)drama.clearArray(u.else_instances);var p=this.runtime.getCurrentCondition().inverted;for(e=0,n=h.length;e<n;++e){for(o=h[e],l=!1,assert2(s=this.findLosBehavior(o),"Can't find LOS behavior on instance"),i=0,r=d.length;i<r;++i)if(o!==(a=d[i])&&drama.xor(s.hasLOSto(a.x,a.y),p))l=!0,y.add(a);if(l)g.add(o)}var f=g.valuesRef(),m=y.valuesRef();return c.select_all=!1,u.select_all=!1,drama.shallowAssignArray(c.instances,f),drama.shallowAssignArray(u.instances,m),g.clear(),y.clear(),c.hasObjects()},n.prototype.HasLOSToPosition=function(t,e){return this.hasLOSto(t,e)},n.prototype.InLos=function(t){return t.index===this.inLosTypeIndex},n.prototype.OutLos=function(t){return t.index===this.outLosTypeIndex},t.cnds=new n,r.prototype.SetParam=function(t,e,i){var n=!0,r=!0;if(i)n="true"===(i=i.split("|"))[0],r="true"===i[1];if(n)this.cone=drama.to_radians(t);if(r)this.range=e},r.prototype.SetRange=function(t){this.range=t},r.prototype.SetCone=function(t){this.cone=drama.to_radians(t)},r.prototype.AddObstacle=function(t){var e=this.type.obstacleTypes;if(-1===e.indexOf(t)){var i,n,r;for(i=0,n=e.length;i<n;i++)if((r=e[i]).is_family&&-1!==r.members.indexOf(t))return;e.push(t)}},r.prototype.ClearObstacles=function(){drama.clearArray(this.type.obstacleTypes)},t.acts=new r,o.prototype.Range=function(t){t.set_float(this.range)},o.prototype.ConeOfView=function(t){t.set_float(drama.to_degrees(this.cone))},t.exps=new o}(),assert2(drama,"drama namespace not created"),assert2(drama.behaviors,"drama.behaviors not created"),drama.behaviors.MoveFollow=function(t){this.runtime=t},function(){var t=drama.behaviors.MoveFollow.prototype;t.Type=function(t,e){this.behavior=t,this.objtype=e,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t,e){this.type=t,this.behavior=t.behavior,this.inst=e,this.runtime=t.runtime};var e=t.Instance.prototype;function i(){}function n(){}e.onCreate=function(){this.enabled=this.properties[0],this.maxSpeed=this.properties[1],this.acceleration=this.properties[2],this.deceleration=this.properties[3],this.realTimeFollow=this.properties[4],this.targetX=this.inst.x,this.targetY=this.inst.y,this._sourceX=this.inst.x,this._sourceY=this.inst.y,this.speed=0,this._isMoving=!1,this._isMovingObject=!1,this.origiTargetX=0,this.origiTargetY=0,this.angle=0},e.saveToJSON=function(){return{}},e.loadFromJSON=function(t){},e.remainDistance=function(){var t=this.targetX-this.inst.x,e=this.targetY-this.inst.y;return Math.sqrt(t*t+e*e)},e.moveDistance=function(){var t=this.inst.x-this._sourceX,e=this.inst.y-this._sourceY;return Math.sqrt(t*t+e*e)},e.tick=function(){if(this._isMoving&&this.enabled){if(0==this.realTimeFollow&&this._isMovingObject)if(this.isObject)return;var t=this.runtime.timescale/60,e=!1;if(0!==this.deceleration){var i=this.speed;e=i*i/(2*this.deceleration*t)>=this.remainDistance()}var n=e?-this.deceleration:this.acceleration;if(0===this.acceleration&&0===this.deceleration&&this.speed<=0)this.speed=this.maxSpeed*t;else this.speed+=n*t;if(this.speed>this.maxSpeed*t)this.speed=this.maxSpeed*t;if(this.remainDistance()<this.speed)this.inst.x=this.targetX,this.inst.y=this.targetY,this._isMoving=!1,this._isMovingObject=!1,this._isObject=!1,this.runtime.trigger(drama.behaviors.MoveFollow.prototype.cnds.OnTarget,this.inst);else this.inst.x+=this.speed*Math.cos(this.angle),this.inst.y+=this.speed*Math.sin(this.angle);this.inst.set_bbox_changed()}},e.getAngle=function(){var t=this.targetX-this._sourceX,e=this.targetY-this._sourceY;this.angle=Math.atan2(e,t)},i.prototype.CompareStatus=function(t,e,i,n,r,o){return(6==t||drama.do_cmp(this.angle,t,e))&&(6==i||drama.do_cmp(this.speed,i,n))&&(6==r||drama.do_cmp(this.moveDistance(),r,o))},i.prototype.CompareAngle=function(t,e){return drama.do_cmp(this.angle,t,e)},i.prototype.CompareSpeed=function(t,e){return drama.do_cmp(this.speed,t,e)},i.prototype.CompareDistance=function(t,e){return drama.do_cmp(this.moveDistance(),t,e)},i.prototype.OnTarget=function(){return!0},i.prototype.IsMoving=function(){return!!this._isMoving},t.cnds=new i,n.prototype.MoveToObject=function(t){if(t=t.instances[0],parseInt(this.origiTargetX)!=parseInt(t.x)||parseInt(this.origiTargetY)!=parseInt(t.y))this.isObject=!0;else this.isObject=!1;if(this.origiTargetX=t.x,this.origiTargetY=t.y,parseInt(this.targetX)!==parseInt(t.x)||parseInt(this.targetY)!==parseInt(t.y))this.targetX=t.x,this.targetY=t.y,this._isMoving=!0,this.speed=0,this._isMovingObject=!0,this._sourceX=this.inst.x,this._sourceY=this.inst.y,this.getAngle()},n.prototype.MoveToPosition=function(t,e){this.targetX=t,this.targetY=e,this._isMoving=!0,this.speed=0,this._sourceX=this.inst.x,this._sourceY=this.inst.y,this.getAngle()},n.prototype.MoveToAngle=function(t,e){var i=Math.PI/180,n=Math.cos(i*t)*e,r=Math.sin(i*t)*e;this.targetX=this.inst.x+n,this.targetY=this.inst.y+r,this._isMoving=!0,this.speed=0,this._sourceX=this.inst.x,this._sourceY=this.inst.y,this.getAngle()},n.prototype.Stop=function(){this._isMoving=!1},n.prototype.SetParameters=function(t,e,i,n,r){var o=!0,s=!0,a=!0,l=!0;if(r)o="true"===(r=r.split("|"))[0],s="true"===r[1],a="true"===r[2],l="true"===r[3];if(o)this.acceleration=t;if(s)this.deceleration=e;if(a)this.maxSpeed=i;if(l)this.speed=n/60},t.acts=new n}(),assert2(drama,"drama namespace not created"),assert2(drama.behaviors,"drama.behaviors not created"),drama.behaviors.NoSave=function(t){this.runtime=t},function(){var t=drama.behaviors.NoSave.prototype;t.Type=function(t,e){this.behavior=t,this.objtype=e,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t,e){this.type=t,this.behavior=t.behavior,this.inst=e,this.runtime=t.runtime};var e=t.Instance.prototype;e.onCreate=function(){this.myProperty=this.properties[0]},e.onDestroy=function(){},e.tick=function(){},t.cnds=new function(){},t.acts=new function(){},t.exps=new function(){}}(),assert2(drama,"drama namespace not created"),assert2(drama.behaviors,"drama.behaviors not created"),drama.behaviors.OrBit=function(t){this.runtime=t},function(){var t=drama.behaviors.OrBit.prototype;t.Type=function(t,e){this.behavior=t,this.objtype=e,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t,e){this.type=t,this.behavior=t.behavior,this.inst=e,this.runtime=t.runtime};var e=t.Instance.prototype;function i(){}function n(){}function r(){}e.onCreate=function(){this.circularSpeed=drama.to_radians(this.properties[0]),this.circularAcceleration=drama.to_radians(this.properties[1]),this.xRadius=this.properties[2],this.yRadius=this.properties[3],this.offsetCirclarAngle=drama.to_radians(this.properties[4]),this.isRotation=this.properties[5],this.isEnabled=this.properties[6],this.targetObject=null,this.setInitial(),this._rotation=this.inst.angle},e.setInitial=function(){this.targetX=this.inst.x,this.targetY=this.inst.y},e.saveToJSON=function(){return{s:this.circularSpeed,a:this.circularAcceleration,r:this._rotation,e:this.isEnabled,a1:this.xRadius,a2:this.yRadius,oa:this.offsetCirclarAngle,mr:this.isRotation,tx:this.targetX,ty:this.targetY}},e.loadFromJSON=function(t){this.circularSpeed=t.s,this.circularAcceleration=t.a,this._rotation=t.r,this.isEnabled=t.e,this.xRadius=t.a1,this.yRadius=t.a2,this.offsetCirclarAngle=t.oa,this.isRotation=t.mr,this.targetX=t.tx,this.targetY=t.ty},e.updateTarget=function(){if(this.targetObject)this.targetX=this.targetObject.x,this.targetY=this.targetObject.y},e.tick=function(){},e.tick2=function(){if(!this.isEnabled)return!1;var t=Math.sin,e=Math.cos,i=this.runtime.getDt(this.inst);if(this.circularSpeed+=this.circularAcceleration*i,0!=this.circularSpeed){this._rotation=drama.clamp_angle(this._rotation+this.circularSpeed*i);var n=this.xRadius*e(this._rotation),r=this.yRadius*t(this._rotation),o=e(this.offsetCirclarAngle),s=t(this.offsetCirclarAngle);if(this.updateTarget(),this.inst.x=this.targetX+(n*o-r*s),this.inst.y=this.targetY+(n*s+r*o),this.isRotation)this.inst.angle=this._rotation+this.offsetCirclarAngle+.5*Math.PI;this.inst.set_bbox_changed()}},e.getDebuggerValues=function(t){t.push({title:this.type.name,properties:[]})},e.onDebugValueEdited=function(t,e,i){},i.prototype.IsEnabled=function(){return this.isEnabled},t.cnds=new i,n.prototype.SetTargetCenter=function(t){if(t){var e=t.getFirstPicked(this.inst);if(e)this.targetObject=e}},n.prototype.CancelSetTargetCenter=function(){this.targetObject=null},n.prototype.SetSpeedParams=function(t,e,i,n,r,o){this.circularSpeed=drama.to_radians(t),this.circularAcceleration=drama.to_radians(e),this.xRadius=i,this.yRadius=n,this.offsetCirclarAngle=drama.to_radians(r),this.isRotation=o},n.prototype.SetEnabled=function(t){this.isEnabled=1===t},n.prototype.setInitialAngle=function(t){this._rotation=drama.to_radians(t)},n.prototype.SetCenter=function(t,e){this.targetObject=null,this.targetX=t,this.targetY=e},t.acts=new n,r.prototype.Acceleration=function(t){t.set_float(drama.to_degrees(this.circularAcceleration))},r.prototype.OffsetAngle=function(t){t.set_float(drama.to_degrees(this.offsetCirclarAngle))},r.prototype.XRadius=function(t){t.set_float(this.xRadius)},r.prototype.YRadius=function(t){t.set_float(this.yRadius)},r.prototype.Speed=function(t){t.set_float(drama.to_degrees(this.circularSpeed))},r.prototype.DistanceToTarget=function(t){var e=this.xRadius*Math.cos(this._rotation),i=this.yRadius*Math.sin(this._rotation);t.set_float(Math.sqrt(e*e+i*i))},r.prototype.Rotation=function(t){t.set_float(drama.to_degrees(this._rotation))},r.prototype.TargetX=function(t){t.set_float(this.targetX)},r.prototype.TargetY=function(t){t.set_float(this.targetY)},t.exps=new r}(),assert2(drama,"drama namespace not created"),assert2(drama.behaviors,"drama.behaviors not created"),drama.behaviors.Pathfinding=function(t){this.runtime=t},function(){var i={},t=drama.behaviors.Pathfinding.prototype;t.onBeforeLayoutChange=function(){var t,e;for(t in i)if(i.hasOwnProperty(t))(e=i[t]).pathfinder.unsetReady(),e.regenerate=!0},t.Type=function(t,e){this.behavior=t,this.objtype=e,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){this.obstacleTypes=[],this.costTypes=[]},t.Instance=function(t,e){this.type=t,this.behavior=t.behavior,this.inst=e,this.runtime=t.runtime};var e=t.Instance.prototype;e.onCreate=function(){if(this.cellSize=this.properties[0],this.cellSize<3)this.cellSize=3;this.cellBorder=this.properties[1],this.obstacles=this.properties[2],this.maxSpeed=this.properties[3],this.acc=this.properties[4],this.dec=this.properties[5],this.av=drama.to_radians(this.properties[6]),this.rotateEnabled=this.properties[7],this.diagonalsEnabled=this.properties[8],this.enabled=this.properties[9],this.isMoving=!1,this.movingFromStopped=!1,this.firstTickMovingWhileMoving=!1,this.hasPath=!1,this.moveNode=0,this.a=this.inst.angle,this.lastKnownAngle=this.inst.angle,this.s=0,this.rabbitX=0,this.rabbitY=0,this.rabbitA=0,this.startX=0,this.endX=0,this.startY=0,this.endY=0,this.myPath=[],this.delayFindPath=!1,this.delayPathX=0,this.delayPathY=0,this.is_destroyed=!1,this.isCalculating=!1,this.calcPathX=0,this.calcPathY=0,this.firstRun=!0;var t=this;if(this.isSuccess=!1,this.isFail=!1,!this.recycled)this.pathSuccessFn=function(){if(!t.is_destroyed)t.isCalculating=!1,t.copyResultPath(),t.hasPath=0<t.myPath.length,t.moveNode=0,t.runtime.trigger(drama.behaviors.Pathfinding.prototype.cnds.OnPathFound,t.inst),t.isSuccess=!0,t.runtime.trigger(drama.behaviors.Pathfinding.prototype.cnds.OnPathFoundStatus,t.inst),t.isSuccess=!1,t.doDelayFindPath()},this.pathFailFn=function(){if(!t.is_destroyed)t.isCalculating=!1,t.clearResultPath(),t.hasPath=!1,t.isMoving=!1,t.moveNode=0,t.runtime.trigger(drama.behaviors.Pathfinding.prototype.cnds.OnFailedToFindPath,t.inst),t.isFail=!0,t.runtime.trigger(drama.behaviors.Pathfinding.prototype.cnds.OnPathFoundStatus,t.inst),t.isFail=!1,t.doDelayFindPath()}},e.onDestroy=function(){this.is_destroyed=!0,this.delayFindPath=!1,this.isSuccess=!1},e.saveToJSON=function(){var t,e,i={cs:this.cellSize,cb:this.cellBorder,ms:this.maxSpeed,acc:this.acc,dec:this.dec,av:this.av,re:this.rotateEnabled,de:this.diagonalsEnabled,im:this.isMoving,mfs:this.movingFromStopped,ftmwm:this.firstTickMovingWhileMoving,hp:this.hasPath,mn:this.moveNode,a:this.a,lka:this.lastKnownAngle,s:this.s,rx:this.rabbitX,ry:this.rabbitY,ra:this.rabbitA,sx:this.startX,ex:this.endX,sy:this.startY,ey:this.endY,path:this.myPath,en:this.enabled,fr:this.firstRun,obs:[],costs:[]};if(this.isCalculating)i.dfp=!0,i.dpx=this.calcPathX,i.dpy=this.calcPathY;else i.dfp=this.delayFindPath,i.dpx=this.delayPathX,i.dpy=this.delayPathY;for(t=0,e=this.type.obstacleTypes.length;t<e;t++)i.obs.push(this.type.obstacleTypes[t].sid);for(t=0,e=this.type.costTypes.length;t<e;t++)i.costs.push({sid:this.type.costTypes[t].obj.sid,cost:this.type.costTypes[t].cost});return i},e.loadFromJSON=function(t){this.cellSize=t.cs,this.cellBorder=t.cb,this.maxSpeed=t.ms,this.acc=t.acc,this.dec=t.dec,this.av=t.av,this.rotateEnabled=t.re,this.diagonalsEnabled=t.de,this.isMoving=t.im,this.movingFromStopped=t.mfs,this.firstTickMovingWhileMoving=t.ftmwm,this.hasPath=t.hp,this.moveNode=t.mn,this.a=t.a,this.lastKnownAngle=t.lka,this.s=t.s,this.rabbitX=t.rx,this.rabbitY=t.ry,this.rabbitA=t.ra,this.startX=t.sx||0,this.endX=t.ex||t.myhc,this.startY=t.sy||0,this.endY=t.ey||t.myvc,this.myPath=t.path,this.enabled=t.en,this.firstRun=t.fr,this.delayFindPath=t.dfp,this.delayPathX=t.dpx,this.delayPathY=t.dpy,drama.clearArray(this.type.obstacleTypes);var e,i,n,r=t.obs;for(e=0,i=r.length;e<i;e++)if(n=this.runtime.getObjectTypeBySid(r[e]))this.type.obstacleTypes.push(n);drama.clearArray(this.type.costTypes);var o=t.costs;for(e=0,i=o.length;e<i;e++)if(n=this.runtime.getObjectTypeBySid(o[e].sid))this.type.costTypes.push({obj:n,cost:o[e].cost});this.getMyInfo().pathfinder.setDiagonals(this.diagonalsEnabled)},e.afterLoad=function(){this.getMyInfo().regenerate=!0},e.tick=function(){if(this.enabled&&this.isMoving){if(this.rotateEnabled&&this.inst.angle!==this.lastKnownAngle)this.a=this.inst.angle;var t,e,i,n,r,o,s=this.runtime.getDt(this.inst),a=this.inst,l=Math.min(.4*this.maxSpeed,2*Math.abs(this.inst.width)),c=Math.max(1.5*this.s,30);if(this.moveNode<this.myPath.length){if(i=this.myPath[this.moveNode].x,n=this.myPath[this.moveNode].y,drama.distanceTo(this.rabbitX,this.rabbitY,i,n)<3*c*s)if(this.moveNode++,this.rabbitX=i,this.rabbitY=n,this.moveNode<this.myPath.length)i=this.myPath[this.moveNode].x,n=this.myPath[this.moveNode].y}else i=this.myPath[this.myPath.length-1].x,n=this.myPath[this.myPath.length-1].y;this.rabbitA=drama.angleTo(this.rabbitX,this.rabbitY,i,n);var u=drama.distanceTo(a.x,a.y,this.rabbitX,this.rabbitY);if(u<l&&this.moveNode<this.myPath.length){var h;if(this.firstTickMovingWhileMoving)h=l,this.firstTickMovingWhileMoving=!1;else h=c*s;this.rabbitX+=Math.cos(this.rabbitA)*h,this.rabbitY+=Math.sin(this.rabbitA)*h}t=drama.angleTo(a.x,a.y,this.rabbitX,this.rabbitY),e=drama.angleDiff(this.a,t);var d=drama.distanceTo(a.x,a.y,this.myPath[this.myPath.length-1].x,this.myPath[this.myPath.length-1].y),p=this.maxSpeed*this.maxSpeed/(2*this.dec);if(1<u){if(this.a=drama.angleRotate(this.a,t,this.av*s),drama.to_degrees(e)<=.5)o=this.maxSpeed;else if(120<=drama.to_degrees(e)||this.movingFromStopped&&0===this.moveNode)o=0,this.movingFromStopped=!0;else{if(r=e/this.av,(o=drama.distanceTo(a.x,a.y,this.rabbitX,this.rabbitY)/(2*Math.sin(e))*e/r)<0)o=0;if(o>this.maxSpeed)o=this.maxSpeed}if(d<p)o=Math.min(o,d/p*this.maxSpeed+this.maxSpeed/40);if(this.s+=this.acc*s,this.s>o)this.s=o}if(a.x+=Math.cos(this.a)*this.s*s,a.y+=Math.sin(this.a)*this.s*s,this.rotateEnabled)a.angle=this.a,this.lastKnownAngle=this.a;if(a.set_bbox_changed(),this.moveNode===this.myPath.length&&drama.distanceTo(a.x,a.y,i,n)<Math.max(3*this.s*s,10))this.isMoving=!1,this.hasPath=!1,this.moveNode=0,this.s=0,this.runtime.trigger(drama.behaviors.Pathfinding.prototype.cnds.OnArrived,a)}},e.tick2=function(){if(this.enabled)this.generateMap(),this.doDelayFindPath()},e.doDelayFindPath=function(){if(this.delayFindPath&&!this.is_destroyed)this.delayFindPath=!1,this.doFindPath(this.inst.x,this.inst.y,this.delayPathX,this.delayPathY)},e.getMyInfo=function(){var t=this.cellSize+","+this.cellBorder;if(!i.hasOwnProperty(t))i[t]={pathfinder:new window.Pathfinder,cells:null,regenerate:!1,regenerateRegions:[]};return i[t]},e.generateMap=function(){var t=this.getMyInfo(),e=!t.pathfinder.isReady()||t.regenerate,i=!!t.regenerateRegions.length;if(e||i){var n,r,o;if(e){var s=this.getBoaderParams(),a=s.minX,l=s.maxX,c=s.minY,u=s.maxY,h=function(t){if(t<0)return Math.floor(t);else return Math.ceil(t)};for(this.startX=h(a/this.cellSize)-1,this.endX=h(l/this.cellSize)+1,this.startY=h(c/this.cellSize)-1,this.endY=h(u/this.cellSize)+1,n=[],r=this.startX;r<this.endX;++r)for(n[r]=[],o=this.startY;o<this.endY;++o)n[r][o]=this.queryCellCollision(r,o);t.cells=n,t.pathfinder.init(n,this.diagonalsEnabled),t.regenerate=!1,drama.clearArray(t.regenerateRegions)}else if(i){var d,p,f,m,g,y,v,b;for(d=0,p=t.regenerateRegions.length;d<p;++d){for(m=(f=t.regenerateRegions[d])[0],g=f[1],y=f[2],v=f[3],n=[],r=m;r<y;++r)for(n[r]=[],o=g;o<v;++o)b=this.queryCellCollision(m+r,g+o),n[r][o]=b,t.cells[m+r][g+o]=b;t.pathfinder.updateRegion(m,g,y,v,n)}drama.clearArray(t.regenerateRegions)}}},e.getBoaderParams=function(){var t,e,i,n,r,o,s=this.runtime.running_layout.layers,a=new drama.rect(0,0,0,0),l=0,c=this.runtime.running_layout.width,u=0,h=this.runtime.running_layout.height;for(i=0,n=s.length;i<n;++i)for(r=0,o=(t=s[i].instances).length;r<o;++r)e=t[r],a.set(e.x,e.y,e.x+e.width,e.y+e.height),a.offset(-e.hotspotX*e.width,-e.hotspotY*e.height),l=Math.min(l,a.left),c=Math.max(c,a.right),u=Math.min(u,a.top),h=Math.max(h,a.bottom);return{minX:l,maxX:c,minY:u,maxY:h}},e.clearResultPath=function(){var t,e;for(t=0,e=this.myPath.length;t<e;t++)window.freeResultNode(this.myPath[t]);drama.clearArray(this.myPath)},e.copyResultPath=function(){var t,e,i,n,r=this.getMyInfo().pathfinder.pathList;for(this.clearResultPath(),t=0,e=r.length;t<e;t++)i=r[t],(n=window.allocResultNode()).x=(i.x+.5)*this.cellSize,n.y=(i.y+.5)*this.cellSize,this.myPath.push(n)};var c=[],u=new drama.rect;function n(){}function r(){}function o(){}e.queryCellCollision=function(t,e){var i,n,r,o,s,a,l=0;if(u.left=t*this.cellSize-this.cellBorder,u.top=e*this.cellSize-this.cellBorder,u.right=(t+1)*this.cellSize+this.cellBorder,u.bottom=(e+1)*this.cellSize+this.cellBorder,0===this.obstacles){if(this.runtime.testRectOverlapSolid(u))return window.PF_OBSTACLE}else{for(this.runtime.getTypesCollisionCandidates(this.inst.layer,this.type.obstacleTypes,u,c),i=0,n=c.length;i<n;++i)if(this.runtime.testRectOverlap(u,c[i]))return drama.clearArray(c),window.PF_OBSTACLE;c.length=0}for(i=0,n=this.type.costTypes.length;i<n;i++){for(r=this.type.costTypes[i].obj,a=this.type.costTypes[i].cost,this.runtime.getCollisionCandidates(this.inst.layer,r,u,c),o=0,s=c.length;o<s;++o)if(this.runtime.testRectOverlap(u,c[o]))l+=a;drama.clearArray(c)}return l},e.doFindPath=function(t,e,i,n){var r=this.getMyInfo().pathfinder;if(!r.isReady())return!1;this.isCalculating=!0,this.calcPathX=i,this.calcPathY=n;var o,s,a,l,c,u,h,d,p=Math.floor(t/this.cellSize),f=Math.floor(e/this.cellSize),m=Math.floor(i/this.cellSize),g=Math.floor(n/this.cellSize);if(r.at(m,g)===window.PF_OBSTACLE){for(o=1e6,a=s=0,l=this.startX;l<this.endX;l++)for(c=this.startY;c<this.endY;c++)if(r.at(l,c)!==window.PF_OBSTACLE)if((d=(u=m-l)*u+(h=g-c)*h)<o)o=d,s=l,a=c;m=s,g=a}r.findPath(p,f,m,g,this.pathSuccessFn,this.pathFailFn)},e.getDebuggerValues=function(t){t.push({title:this.type.name,properties:[{name:"Has path",value:this.hasPath,readonly:!0},{name:"Calculating path",value:this.isCalculating,readonly:!0},{name:"Is moving",value:this.isMoving,readonly:!0},{name:"Speed",value:this.isMoving?this.s:0},{name:"Angle of motion",value:~~drama.to_degrees(this.a)},{name:"Max speed",value:this.maxSpeed},{name:"Acceleration",value:this.acc},{name:"Deceleration",value:this.dec},{name:"Rotate speed",value:~~drama.to_degrees(this.av)},{name:"Enabled",value:this.enabled}]})},e.onDebugValueEdited=function(t,e,i){switch(e){case"Speed":this.s=i;break;case"Angle of motion":this.a=drama.to_radians(i);break;case"Max speed":this.maxSpeed=i;break;case"Acceleration":this.acc=i;break;case"Deceleration":this.dec=i;break;case"Rotate speed":this.av=drama.to_radians(this.av);break;case"Enabled":this.enabled=i}},n.prototype.OnPathFoundStatus=function(t){if(0==t&&this.isSuccess)return!0;else if(1==t&&this.isFail)return!0;return!1},n.prototype.OnPathFound=function(){return!0},n.prototype.OnFailedToFindPath=function(){return!0},n.prototype.IsCellObstacle=function(t,e){return this.getMyInfo().pathfinder.at(t,e)===window.PF_OBSTACLE},n.prototype.IsCalculatingPath=function(){return this.isCalculating},n.prototype.IsMoving=function(){return this.isMoving},n.prototype.OnArrived=function(){return!0},n.prototype.CompareSpeed=function(t,e){return drama.do_cmp(this.isMoving?this.s:0,t,e)},n.prototype.DiagonalsEnabled=function(t,e){return this.diagonalsEnabled},t.cnds=new n,r.prototype.FindPath=function(t,e){if(this.enabled)if(this.isCalculating||!this.getMyInfo().pathfinder.isReady())this.delayFindPath=!0,this.delayPathX=t,this.delayPathY=e;else this.doFindPath(this.inst.x,this.inst.y,t,e)},r.prototype.StartMoving=function(){if(this.hasPath){if(this.isMoving)this.firstTickMovingWhileMoving=!0;this.movingFromStopped=!this.isMoving,this.isMoving=!0,this.rabbitX=this.inst.x,this.rabbitY=this.inst.y,this.rabbitA=this.inst.angle}},r.prototype.Stop=function(){this.isMoving=!1},r.prototype.SetEnabled=function(t){this.enabled=0!==t},r.prototype.RegenerateMap=function(){this.getMyInfo().regenerate=!0},r.prototype.AddObstacle=function(t){var e=this.type.obstacleTypes;if(-1===e.indexOf(t)){var i,n,r;for(i=0,n=e.length;i<n;i++)if((r=e[i]).is_family&&-1!==r.members.indexOf(t))return;e.push(t)}},r.prototype.ClearObstacles=function(){drama.clearArray(this.type.obstacleTypes)},r.prototype.AddCost=function(t,e,i){var n=!0,r=!0;if(i)n="true"===(i=i.split("|"))[0],r="true"===i[1];if(n&&r){var o,s,a,l=this.type.costTypes;for(o=0,s=l.length;o<s;o++){if((a=l[o].obj)===t)return;if(a.is_family&&-1!==a.members.indexOf(t))return}l.push({obj:t,cost:e})}},r.prototype.ClearCost=function(){drama.clearArray(this.type.costTypes)},r.prototype.SetFindParam=function(t,e,i,n,r){var o=!0,s=!0,a=!0,l=!0;if(r)o="true"===(r=r.split("|"))[0],s="true"===r[1],a="true"===r[2],l="true"===r[3];if(o)this.maxSpeed=t;if(s)this.acc=e;if(a)this.dec=i;if(l)this.av=drama.to_radians(n)},r.prototype.SetMaxSpeed=function(t){this.maxSpeed=t},r.prototype.SetSpeed=function(t){if(t<0)t=0;if(t>this.maxSpeed)t=this.maxSpeed;this.s=t},r.prototype.SetAcc=function(t){this.acc=t},r.prototype.SetDec=function(t){this.dec=t},r.prototype.SetRotateSpeed=function(t){this.av=drama.to_radians(t)},r.prototype.SetDiagonalsEnabled=function(t){this.diagonalsEnabled=0!==t,this.getMyInfo().pathfinder.setDiagonals(this.diagonalsEnabled)},r.prototype.RegenerateRegion=function(t,e,i,n){this.doRegenerateRegion(t,e,i,n)},r.prototype.RegenerateObjectRegion=function(t,e){if("false"!==e)if(t){var i,n,r,o=t.getCurrentSol().getObjects();for(i=0,n=o.length;i<n;++i)if((r=o[i]).update_bbox)r.update_bbox(),this.doRegenerateRegion(r.bbox.left,r.bbox.top,r.bbox.right,r.bbox.bottom)}},e.doRegenerateRegion=function(t,e,i,n){var r=Math.min(t,i)-this.cellBorder,o=Math.min(e,n)-this.cellBorder,s=Math.max(t,i)+this.cellBorder,a=Math.max(e,n)+this.cellBorder,l=Math.max(Math.floor(r/this.cellSize),this.startX),c=Math.max(Math.floor(o/this.cellSize),this.startY),u=Math.min(Math.ceil(s/this.cellSize),this.endX),h=Math.min(Math.ceil(a/this.cellSize),this.endY);if(!(u<=l||h<=c))this.getMyInfo().regenerateRegions.push([l,c,u,h])},t.acts=new r,o.prototype.NodeCount=function(t){t.set_int(this.myPath.length)},o.prototype.NodeXAt=function(t,e){if((e=Math.floor(e))<0||e>=this.myPath.length)t.set_float(0);else t.set_float(this.myPath[e].x)},o.prototype.NodeYAt=function(t,e){if((e=Math.floor(e))<0||e>=this.myPath.length)t.set_float(0);else t.set_float(this.myPath[e].y)},o.prototype.CellSize=function(t){t.set_int(this.cellSize)},o.prototype.RabbitX=function(t){t.set_float(this.rabbitX)},o.prototype.RabbitY=function(t){t.set_float(this.rabbitY)},o.prototype.MaxSpeed=function(t){t.set_float(this.maxSpeed)},o.prototype.Acceleration=function(t){t.set_float(this.acc)},o.prototype.Deceleration=function(t){t.set_float(this.dec)},o.prototype.RotateSpeed=function(t){t.set_float(drama.to_degrees(this.av))},o.prototype.MovingAngle=function(t){t.set_float(drama.to_degrees(this.a))},o.prototype.CurrentNode=function(t){t.set_int(this.moveNode)},o.prototype.Speed=function(t){t.set_float(this.isMoving?this.s:0)},t.exps=new o}(),assert2(drama,"drama namespace not created"),assert2(drama.behaviors,"drama.behaviors not created"),drama.behaviors.Persist=function(t){this.runtime=t},function(){var t=drama.behaviors.Persist.prototype;t.Type=function(t,e){this.behavior=t,this.objtype=e,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t,e){this.type=t,this.behavior=t.behavior,this.inst=e,this.runtime=t.runtime};var e=t.Instance.prototype;e.onCreate=function(){this.myProperty=this.properties[0]},e.onDestroy=function(){},e.tick=function(){},t.cnds=new function(){},t.acts=new function(){},t.exps=new function(){}}();var Box2D=window.Box2DFn(),b2Vec2=Box2D.b2Vec2;function createPolygonShape(t){assert2(3<=t.length&&t.length<=8,"碰撞多边形的顶点必须在3~8之间");for(var e=new Box2D.b2PolygonShape,i=Box2D._malloc(8*t.length),n=0,r=0;r<t.length;r++)Box2D.HEAPF32[i+n>>2]=t[r].get_x(),Box2D.HEAPF32[i+(n+4)>>2]=t[r].get_y(),n+=8;var o=Box2D.wrapPointer(i,Box2D.b2Vec2);return e.Set(o,t.length),Box2D._free(i),e}b2Vec2._freeCache=[],b2Vec2.Get=function(t,e){var i;if(b2Vec2._freeCache.length)return(i=b2Vec2._freeCache.pop()).set_x(t),i.set_y(e),i;else return new b2Vec2(t,e)},b2Vec2.Free=function(t){b2Vec2._freeCache.push(t)};var tmpvec2a=b2Vec2.Get(0,0),tmpvec2b=b2Vec2.Get(0,0);function getTempVec2a(t,e){return tmpvec2a.set_x(t),tmpvec2a.set_y(e),tmpvec2a}function getTempVec2b(t,e){return tmpvec2b.set_x(t),tmpvec2b.set_y(e),tmpvec2b}drama.b2Separator=function(){},drama.b2Separator.det=function(t,e,i,n,r,o){return t*n+i*o+r*e-e*i-n*r-o*t},drama.b2Separator.hitRay=function(t,e,i,n,r,o,s,a){var l=i-t,c=n-e,u=s-r,h=a-o,d=(u*(o-e)-h*(r-t))/(c*u-l*h),p=t+d*l,f=e+d*c,m=drama.b2Separator.isOnSegment(i,n,t,e,p,f),g=drama.b2Separator.isOnSegment(p,f,r,o,s,a);if(m&&g)return b2Vec2.Get(p,f);else return null},drama.b2Separator.isOnSegment=function(t,e,i,n,r,o){return(t<=i+.1&&r-.1<=t||i-.1<=t&&t<=r+.1)&&(e<=n+.1&&o-.1<=e||n-.1<=e&&e<=o+.1)&&drama.b2Separator.isOnLine(t,e,i,n,r,o)},drama.b2Separator.isOnLine=function(t,e,i,n,r,o){if(.1<Math.abs(r-i)){var s=(o-n)/(r-i)*(t-i)+n;return Math.abs(s-e)<.1}return Math.abs(t-i)<.1},drama.b2Separator.pointsMatch=function(t,e,i,n){return Math.abs(i-t)<.1&&Math.abs(n-e)<.1},drama.b2Separator.Separate=function(t,e){var i,n,r,o,s,a,l,c,u,h=drama.b2Separator.calcShapes(t),d=[];for(s=0,a=h.length;s<a;s++){for(n=h[s],(i=[]).length=n.length,l=u=0,c=n.length;l<c;l++)r=n[l],o=n[(l+1)%c],u+=r.get_x()*o.get_y()-r.get_y()*o.get_x(),i[l]=b2Vec2.Get(r.get_x(),r.get_y());if(.001*e<=(u=Math.abs(u/2)))d.push(i);else for(l=0,c=i.length;l<c;l++)b2Vec2.Free(i[l])}return assert2(d.length,"Physics polygon separation resulted in no polys.  Make sure all your collision masks for objects with the Physics behavior are valid and don't have any overlapping lines."),d},drama.b2Separator.calcShapes=function(t){var e,i,n,r,o,s,a,l=[],c=0,u=0,h=0,d=0,p=0,f=0,m=0,g=0,y=0,v=0,b=0,_=0,w=0,x=0,S=[],I=[],T=!1,C=[],O=[],P=!1;for(O.push(t);O.length;){for(u=(l=O[0]).length,T=!0,c=0;c<u;c++)if(y=(g=c)<u-1?c+1:c+1-u,v=c<u-2?c+2:c+2-u,e=l[g],i=l[y],n=l[v],drama.b2Separator.det(e.get_x(),e.get_y(),i.get_x(),i.get_y(),n.get_x(),n.get_y())<0){for(T=!1,m=1e9,h=0;h<u;h++)if(h!==g&&h!==y)if(_=(b=h)<u-1?h+1:0,r=l[b],o=l[_],s=drama.b2Separator.hitRay(e.get_x(),e.get_y(),i.get_x(),i.get_y(),r.get_x(),r.get_y(),o.get_x(),o.get_y()))if((d=(p=i.get_x()-s.get_x())*p+(f=i.get_y()-s.get_y())*f)<m)x=b,w=_,a=s,m=d;else b2Vec2.Free(s);if(1e9===m)return[];if(S=[],I=[],_=w,r=l[b=x],o=l[_],P=!1,!drama.b2Separator.pointsMatch(a.get_x(),a.get_y(),o.get_x(),o.get_y()))S.push(a),P=!0;if(!drama.b2Separator.pointsMatch(a.get_x(),a.get_y(),r.get_x(),r.get_y()))I.push(a),P=!0;if(!P)b2Vec2.Free(a);for(x=-1,w=g;;){if(w!==_)S.push(l[w]);else{if(x<0||u<=x)return[];if(!drama.b2Separator.isOnSegment(o.get_x(),o.get_y(),l[x].get_x(),l[x].get_y(),e.get_x(),e.get_y()))S.push(l[w]);break}if((x=w)-1<0)w=u-1;else w--}for(S.reverse(),x=-1,w=y;;){if(w!==b)I.push(l[w]);else{if(x<0||u<=x)return[];if(w===b&&!drama.b2Separator.isOnSegment(r.get_x(),r.get_y(),l[x].get_x(),l[x].get_y(),i.get_x(),i.get_y()))I.push(l[w]);break}if(u-1<(x=w)+1)w=0;else w++}O.push(S,I),O.shift();break}if(T)C.push(O.shift())}return C},assert2(drama,"drama namespace not created"),assert2(drama.behaviors,"drama.behaviors not created"),drama.behaviors.Physics=function(r){this.runtime=r,this.world=new Box2D.b2World(getTempVec2a(0,10),!0),this.worldG=10,this.lastUpdateTick=-1;var t=new Box2D.JSContactListener;t.BeginContact=function(t){var e=Box2D.wrapPointer(t,Box2D.b2Contact),i=e.GetFixtureA().GetBody().c2userdata,n=e.GetFixtureB().GetBody().c2userdata;r.registerCollision(i.inst,n.inst)},t.EndContact=function(){},t.PreSolve=function(){},t.PostSolve=function(){},this.world.SetContactListener(t);var e=new Box2D.JSContactFilter,a=this;e.ShouldCollide=function(t,e){if(a.allCollisionsEnabled)return!0;var i=Box2D.wrapPointer(t,Box2D.b2Fixture),n=Box2D.wrapPointer(e,Box2D.b2Fixture),r=i.GetBody().c2userdata.inst.type,o=n.GetBody().c2userdata.inst.type,s=r.extra.Physics_DisabledCollisions;if(s&&s.contains(o))return!1;if((s=o.extra.Physics_DisabledCollisions)&&s.contains(r))return!1;else return!0},this.world.SetContactFilter(e),this.steppingMode=0,this.velocityIterations=8,this.positionIterations=3,this.allCollisionsEnabled=!0,drama.physics_cpu_time=new drama.KahanAdder},function(){var P=Box2D.b2BodyDef,E=Box2D.b2FixtureDef,A=Box2D.b2PolygonShape,k=Box2D.b2CircleShape,p=Box2D.b2DistanceJointDef,l=Box2D.b2RevoluteJointDef,t=drama.behaviors.Physics.prototype;t.Type=function(t,e){this.behavior=t,this.objtype=e,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t,e){this.type=t,this.behavior=t.behavior,this.inst=e,this.runtime=t.runtime,this.world=this.behavior.world};var e=t.Instance.prototype;e.onCreate=function(){if(this.immovable=this.properties[0],this.collisionmask=this.properties[1],this.preventRotation=this.properties[2],this.density=this.properties[3],this.friction=this.properties[4],this.restitution=this.properties[5],this.linearDamping=this.properties[6],this.angularDamping=this.properties[7],this.bullet=this.properties[8],this.enabled=this.properties[9],this.body=null,this.fixture=null,this.inst.update_bbox(),this.lastKnownX=this.inst.x,this.lastKnownY=this.inst.y,this.lastKnownAngle=this.inst.angle,this.lastWidth=0,this.lastHeight=0,this.lastTickOverride=!1,this.recreateBody=!1,this.lastAnimation=null,this.lastAnimationFrame=-1,this.myJoints)drama.clearArray(this.myJoints),drama.clearArray(this.myCreatedJoints),this.joiningMe.clear();else this.myJoints=[],this.myCreatedJoints=[],this.joiningMe=new drama.ObjectSet;var e=this;if(!this.recycled)this.myDestroyCallback=function(t){e.onInstanceDestroyed(t)};this.runtime.addDestroyCallback(this.myDestroyCallback)},e.postCreate=function(){this.inst.update_bbox(),this.createBody(),this.lastAnimation=this.inst.cur_animation,this.lastAnimationFrame=this.inst.cur_frame},e.onDestroy=function(){this.destroyBody(),drama.clearArray(this.myCreatedJoints),this.joiningMe.clear(),this.runtime.removeDestroyCallback(this.myDestroyCallback)},e.saveToJSON=function(){var t={e:this.enabled,im:this.immovable,pr:this.preventRotation,d:this.density,fr:this.friction,re:this.restitution,ld:this.linearDamping,ad:this.angularDamping,b:this.bullet,mcj:this.myCreatedJoints};if(this.enabled){var e=this.body.GetLinearVelocity();t.vx=e.get_x(),t.vy=e.get_y(),t.om=this.body.GetAngularVelocity()}return t},e.loadFromJSON=function(t){if(this.destroyBody(),drama.clearArray(this.myCreatedJoints),this.joiningMe.clear(),this.enabled=t.e,this.immovable=t.im,this.preventRotation=t.pr,this.density=t.d,this.friction=t.fr,this.restitution=t.re,this.linearDamping=t.ld,this.angularDamping=t.ad,this.bullet=t.b,this.lastKnownX=this.inst.x,this.lastKnownY=this.inst.y,this.lastKnownAngle=this.inst.angle,this.lastWidth=this.inst.width,this.lastHeight=this.inst.height,this.enabled){if(this.createBody(),this.body.SetLinearVelocity(getTempVec2a(t.vx,t.vy)),this.body.SetAngularVelocity(t.om),0!==t.vx||0!==t.vy||0!==t.om)this.body.SetAwake(!0);this.myCreatedJoints=t.mcj}},e.afterLoad=function(){if(this.enabled)this.recreateMyJoints()},e.onInstanceDestroyed=function(t){var e,i,n,r=t.uid;for(n=e=0,i=this.myCreatedJoints.length;e<i;e++){if(this.myCreatedJoints[n]=this.myCreatedJoints[e],n<this.myJoints.length)this.myJoints[n]=this.myJoints[e];if(this.myCreatedJoints[e].params[1]==r){if(e<this.myJoints.length)this.world.DestroyJoint(this.myJoints[e])}else n++}if((this.myCreatedJoints.length=n)<this.myJoints.length)this.myJoints.length=n;this.joiningMe.remove(t)},e.destroyMyJoints=function(){var t,e;for(t=0,e=this.myJoints.length;t<e;t++)this.world.DestroyJoint(this.myJoints[t]);drama.clearArray(this.myJoints)},e.recreateMyJoints=function(){var t,e,i;for(t=0,e=this.myCreatedJoints.length;t<e;t++)switch((i=this.myCreatedJoints[t]).type){case 0:this.doCreateDistanceJoint(i.params[0],i.params[1],i.params[2],i.params[3],i.params[4]);break;case 1:this.doCreateRevoluteJoint(i.params[0],i.params[1]);break;case 2:this.doCreateLimitedRevoluteJoint(i.params[0],i.params[1],i.params[2],i.params[3]);break;default:assert2(!1,"Unknown physics joint type to re-create")}},e.destroyBody=function(){if(this.body){if(this.destroyMyJoints(),this.fixture)this.body.DestroyFixture(this.fixture),this.fixture=null;this.world.DestroyBody(this.body),this.body=null,this.inst.extra.box2dbody=null}};var M=[];function i(){}function n(){}function r(t,e,i){var n;if(i){if(n=t.extra.Physics_DisabledCollisions)n.remove(e);if(n=e.extra.Physics_DisabledCollisions)n.remove(t)}else{if(!t.extra.Physics_DisabledCollisions)t.extra.Physics_DisabledCollisions=new drama.ObjectSet;if(t.extra.Physics_DisabledCollisions.add(e),!e.extra.Physics_DisabledCollisions)e.extra.Physics_DisabledCollisions=new drama.ObjectSet;e.extra.Physics_DisabledCollisions.add(t)}}function o(){}e.createBody=function(){if(this.enabled){var t,e,i,n,r,o,s,a,l,c,u,h,d,p,f,m,g,y=this.inst;if(y.update_bbox(),!this.body){var v=new P;v.set_type(this.immovable?0:2),v.set_position(getTempVec2b(.02*y.bquad.midX(),.02*y.bquad.midY())),v.set_angle(y.angle),v.set_fixedRotation(this.preventRotation),v.set_linearDamping(this.linearDamping),v.set_angularDamping(this.angularDamping),v.set_bullet(this.bullet),this.body=this.world.CreateBody(v),this.body.c2userdata=this,y.extra.box2dbody=this.body,Box2D.destroy(v)}if(this.fixture)this.body.DestroyFixture(this.fixture),this.fixture=null;var b=new E;b.set_density(this.density),b.set_friction(this.friction),b.set_restitution(this.restitution);var _=this.inst.collision_poly&&!this.inst.collision_poly.is_empty(),w=this.collisionmask;if(!_&&!this.inst.tilemap_exists&&0===this.collisionmask)w=1;var x,S=Math.max(Math.abs(y.width),1),I=Math.max(Math.abs(y.height),1),T=y.width<0,C=y.height<0;if(0===w)if(y.tilemap_exists)for(f=y.bquad.midX()-y.x,m=y.bquad.midY()-y.y,y.getAllCollisionRects(M),a=[],t=0,e=M.length;t<e;++t){if(c=(l=M[t]).rc,l.poly){if(!l.poly.convexpolys){for(u=l.poly.pts_cache,h=l.poly.pts_count,i=0;i<h;++i)a.push(b2Vec2.Get(u[2*i],u[2*i+1]));var O=3758096384&l.id;if(-2147483648===O||1073741824===O||536870912===O||-2147483648&O&&1073741824&O&&536870912&O)a.reverse();for(l.poly.convexpolys=drama.b2Separator.Separate(a,(c.right-c.left)*(c.bottom-c.top)),i=0,n=a.length;i<n;++i)b2Vec2.Free(a[i]);drama.clearArray(a)}for(i=0,n=l.poly.convexpolys.length;i<n;++i){for(assert2(3<=(p=l.poly.convexpolys[i]).length,"Invalid convex poly for tile physics collision mask"),r=0,o=p.length;r<o;++r)a.push(b2Vec2.Get(.02*(c.left+p[r].get_x()-f),.02*(c.top+p[r].get_y()-m)));for(x=createPolygonShape(a),b.set_shape(x),this.fixture=this.body.CreateFixture(b),Box2D.destroy(x),r=0,o=a.length;r<o;++r)b2Vec2.Free(a[r]);drama.clearArray(a)}}else a.push(b2Vec2.Get(.02*(c.left-f),.02*(c.top-m))),a.push(b2Vec2.Get(.02*(c.right-f),.02*(c.top-m))),a.push(b2Vec2.Get(.02*(c.right-f),.02*(c.bottom-m))),a.push(b2Vec2.Get(.02*(c.left-f),.02*(c.bottom-m))),x=createPolygonShape(a),b.set_shape(x),this.fixture=this.body.CreateFixture(b),Box2D.destroy(x);for(i=0,n=a.length;i<n;++i)b2Vec2.Free(a[i]);drama.clearArray(a)}else{for(g=y.angle,y.angle=0,y.set_bbox_changed(),y.update_bbox(),f=y.bquad.midX()-y.x,m=y.bquad.midY()-y.y,y.angle=g,y.set_bbox_changed(),y.collision_poly.cache_poly(T?-S:S,C?-I:I,0),u=y.collision_poly.pts_cache,h=y.collision_poly.pts_count,(a=[]).length=h,t=0;t<h;t++)a[t]=b2Vec2.Get(u[2*t]-f,u[2*t+1]-m);if(T!==C)a.reverse();for(d=drama.b2Separator.Separate(a,S*I),t=0;t<h;t++)b2Vec2.Free(a[t]);if(d.length)for(t=0,e=d.length;t<e;t++){for(assert2(3<=(a=d[t]).length,"Invalid convex poly for physics collision mask"),i=0,n=a.length;i<n;i++)(s=a[i]).set_x(.02*s.get_x()),s.set_y(.02*s.get_y());for(x=createPolygonShape(a),b.set_shape(x),this.fixture=this.body.CreateFixture(b),Box2D.destroy(x),i=0,n=a.length;i<n;i++)b2Vec2.Free(a[i])}else(x=new A).SetAsBox(.02*S*.5,.02*I*.5),b.set_shape(x),this.fixture=this.body.CreateFixture(b),Box2D.destroy(x)}else if(1===w)(x=new A).SetAsBox(.02*S*.5,.02*I*.5),b.set_shape(x),this.fixture=this.body.CreateFixture(b),Box2D.destroy(x);else(x=new k).set_m_radius(.02*Math.min(S,I)*.5),b.set_shape(x),this.fixture=this.body.CreateFixture(b),Box2D.destroy(x);this.lastWidth=y.width,this.lastHeight=y.height,Box2D.destroy(b),drama.clearArray(M)}},e.tick=function(){if(this.enabled){var t,e=this.inst;if(0===this.behavior.steppingMode)t=this.runtime.timescale/60;else if(1/30<(t=this.runtime.getDt(this.inst)))t=1/30;if(this.runtime.tickcount_nosave>this.behavior.lastUpdateTick&&0<this.runtime.timescale){var i=drama.performance_now();if(0!==t)this.world.Step(t,this.behavior.velocityIterations,this.behavior.positionIterations);this.world.ClearForces(),drama.physics_cpu_time.add(drama.performance_now()-i),this.behavior.lastUpdateTick=this.runtime.tickcount_nosave}if(this.recreateBody||e.width!==this.lastWidth||e.height!==this.lastHeight||e.cur_animation!==this.lastAnimation||e.cur_frame!==this.lastAnimationFrame||e.tilemap_exists&&e.physics_changed)if(this.createBody(),this.recreateBody=!1,this.lastAnimation=e.cur_animation,this.lastAnimationFrame=e.cur_frame,e.tilemap_exists&&e.physics_changed)e.physics_changed=!1;var n=e.x!==this.lastKnownX||e.y!==this.lastKnownY,r=e.angle!==this.lastKnownAngle;if(n){e.update_bbox();var o=e.bquad.midX(),s=e.bquad.midY(),a=o-this.lastKnownX,l=s-this.lastKnownY;if(r)this.body.SetTransform(getTempVec2a(.02*o,.02*s),e.angle);else this.body.SetTransform(getTempVec2a(.02*o,.02*s),this.body.GetAngle());this.body.SetLinearVelocity(getTempVec2a(a,l)),this.lastTickOverride=!0,this.body.SetAwake(!0)}else if(this.lastTickOverride)this.lastTickOverride=!1,this.body.SetLinearVelocity(getTempVec2a(0,0)),this.body.SetTransform(getTempVec2a(.02*e.bquad.midX(),.02*e.bquad.midY()),this.body.GetAngle());if(!n&&r)this.body.SetTransform(this.body.GetPosition(),e.angle),this.body.SetAwake(!0);var c=this.body.GetPosition(),u=c.get_x()/.02,h=c.get_y()/.02,d=this.body.GetAngle();if(u!==e.x||h!==e.y||d!==e.angle){e.x=u,e.y=h,e.angle=d,e.set_bbox_changed(),e.update_bbox();var p=e.bquad.midX()-e.x,f=e.bquad.midY()-e.y;if(0!==p||0!==f)e.x-=p,e.y-=f,e.set_bbox_changed()}this.lastKnownX=e.x,this.lastKnownY=e.y,this.lastKnownAngle=e.angle}},e.getInstImgPointX=function(t){if(-1===t||!this.inst.getImagePoint)return this.inst.x;if(0===t&&this.body)return(this.body.GetPosition().get_x()+this.body.GetLocalCenter().get_x())/.02;else return this.inst.getImagePoint(t,!0)},e.getInstImgPointY=function(t){if(-1===t||!this.inst.getImagePoint)return this.inst.y;if(0===t&&this.body)return(this.body.GetPosition().get_y()+this.body.GetLocalCenter().get_y())/.02;else return this.inst.getImagePoint(t,!1)},e.getDebuggerValues=function(t){var e=[{name:"Enabled",value:this.enabled},{name:"Immovable",value:this.immovable},{name:"Density",value:this.density},{name:"Friction",value:this.friction},{name:"Elasticity",value:this.restitution},{name:"Linear damping",value:this.linearDamping},{name:"Angular damping",value:this.angularDamping}];if(this.enabled)e.push({name:"Sleeping",value:!this.body.IsAwake(),readonly:!0}),e.push({name:"Velocity X",value:this.body.GetLinearVelocity().get_x()/.02}),e.push({name:"Velocity Y",value:this.body.GetLinearVelocity().get_y()/.02}),e.push({name:"Angular velocity",value:drama.to_degrees(this.body.GetAngularVelocity())}),e.push({name:"Mass",value:this.body.GetMass()/.02,readonly:!0});t.push({title:this.type.name,properties:e})},e.onDebugValueEdited=function(t,e,i){switch(e){case"Immovable":if(this.immovable=i,this.enabled)this.body.SetType(this.immovable?0:2),this.body.SetAwake(!0);break;case"Density":this.density=i,this.recreateBody=!0;break;case"Friction":this.friction=i,this.recreateBody=!0;break;case"Elasticity":this.restitution=i,this.recreateBody=!0;break;case"Linear damping":if(this.linearDamping=i,this.enabled)this.body.SetLinearDamping(this.linearDamping);break;case"Angular damping":if(this.angularDamping=i,this.enabled)this.body.SetAngularDamping(this.angularDamping);break;case"Velocity X":if(this.enabled)this.body.SetLinearVelocity(getTempVec2a(.02*i,this.body.GetLinearVelocity().get_y())),this.body.SetAwake(!0);break;case"Velocity Y":if(this.enabled)this.body.SetLinearVelocity(getTempVec2a(this.body.GetLinearVelocity().get_x(),.02*i)),this.body.SetAwake(!0);break;case"Angular velocity":if(this.enabled)this.body.SetAngularVelocity(drama.to_radians(i)),this.body.SetAwake(!0);break;case"Enabled":if(this.enabled&&!i)this.destroyBody(),this.enabled=!1;else if(!this.enabled&&i)this.enabled=!0,this.createBody()}},i.prototype.IsSleeping=function(){if(!this.enabled)return!1;else return!this.body.IsAwake()},i.prototype.CompareVelocity=function(t,e,i){if(!this.enabled)return!1;var n,r,o,s=this.body.GetLinearVelocity();if(0===t)n=s.get_x()/.02;else if(1===t)n=s.get_y()/.02;else r=s.get_x()/.02,o=s.get_y()/.02,n=drama.distanceTo(0,0,r,o);return drama.do_cmp(n,e,i)},i.prototype.CompareAngularVelocity=function(t,e){if(!this.enabled)return!1;var i=drama.to_degrees(this.body.GetAngularVelocity());return drama.do_cmp(i,t,e)},i.prototype.CompareMass=function(t,e){if(!this.enabled)return!1;var i=this.body.GetMass()/.02;return drama.do_cmp(i,t,e)},i.prototype.IsEnabled=function(){return this.enabled},t.cnds=new i,n.prototype.ApplyForce=function(t,e,i){if(this.enabled){var n=this.getInstImgPointX(i),r=this.getInstImgPointY(i);this.body.ApplyForce(getTempVec2a(t,e),getTempVec2b(.02*n,.02*r),!0)}},n.prototype.ApplyForceToward=function(t,e,i,n){if(this.enabled){var r=this.getInstImgPointX(n),o=this.getInstImgPointY(n),s=drama.angleTo(r,o,e,i);this.body.ApplyForce(getTempVec2a(Math.cos(s)*t,Math.sin(s)*t),getTempVec2b(.02*r,.02*o),!0)}},n.prototype.ApplyForceAtAngle=function(t,e,i){if(this.enabled){e=drama.to_radians(e);var n=this.getInstImgPointX(i),r=this.getInstImgPointY(i);this.body.ApplyForce(getTempVec2a(Math.cos(e)*t,Math.sin(e)*t),getTempVec2b(.02*n,.02*r),!0)}},n.prototype.ApplyImpulse=function(t,e,i){if(this.enabled){var n=this.getInstImgPointX(i),r=this.getInstImgPointY(i);this.body.ApplyLinearImpulse(getTempVec2a(t,e),getTempVec2b(.02*n,.02*r),!0),this.lastTickOverride=!1,this.lastKnownX=this.inst.x,this.lastKnownY=this.inst.y}},n.prototype.ApplyImpulseToward=function(t,e,i,n){if(this.enabled){var r=this.getInstImgPointX(n),o=this.getInstImgPointY(n),s=drama.angleTo(r,o,e,i);this.body.ApplyLinearImpulse(getTempVec2a(Math.cos(s)*t,Math.sin(s)*t),getTempVec2b(.02*r,.02*o),!0),this.lastTickOverride=!1,this.lastKnownX=this.inst.x,this.lastKnownY=this.inst.y}},n.prototype.ApplyImpulseAtAngle=function(t,e,i){if(this.enabled){e=drama.to_radians(e);var n=this.getInstImgPointX(i),r=this.getInstImgPointY(i);this.body.ApplyLinearImpulse(getTempVec2a(Math.cos(e)*t,Math.sin(e)*t),getTempVec2b(.02*n,.02*r),!0),this.lastTickOverride=!1,this.lastKnownX=this.inst.x,this.lastKnownY=this.inst.y}},n.prototype.ApplyTorque=function(t){if(this.enabled)this.body.ApplyTorque(drama.to_radians(t),!0)},n.prototype.ApplyTorqueToAngle=function(t,e){if(this.enabled)if(t=drama.to_radians(t),e=drama.to_radians(e),drama.angleClockwise(this.inst.angle,e))this.body.ApplyTorque(-t,!0);else this.body.ApplyTorque(t,!0)},n.prototype.ApplyTorqueToPosition=function(t,e,i){if(this.enabled){t=drama.to_radians(t);var n=drama.angleTo(this.inst.x,this.inst.y,e,i);if(drama.angleClockwise(this.inst.angle,n))this.body.ApplyTorque(-t,!0);else this.body.ApplyTorque(t,!0)}},n.prototype.SetAngularVelocity=function(t){if(this.enabled)this.body.SetAngularVelocity(drama.to_radians(t)),this.body.SetAwake(!0)},n.prototype.CreateDistanceJoint=function(t,e,i,n,r){if(e&&this.enabled){var o=e.getFirstPicked(this.inst);if(o&&o!=this.inst)if(o.extra.box2dbody)this.myCreatedJoints.push({type:0,params:[t,o.uid,i,n,r]}),this.doCreateDistanceJoint(t,o.uid,i,n,r)}},e.doCreateDistanceJoint=function(t,e,i,n,r){if(this.enabled){var o=this.runtime.getObjectByUID(e);if(o&&o!=this.inst&&o.extra.box2dbody){o.extra.box2dbody.c2userdata.joiningMe.add(this.inst);var s,a,l=this.getInstImgPointX(t),c=this.getInstImgPointY(t);if(o.getImagePoint)s=o.getImagePoint(i,!0),a=o.getImagePoint(i,!1);else s=o.x,a=o.y;var u=l-s,h=c-a,d=new p;d.Initialize(this.body,o.extra.box2dbody,getTempVec2a(.02*l,.02*c),getTempVec2b(.02*s,.02*a)),d.set_length(.02*Math.sqrt(u*u+h*h)),d.set_dampingRatio(n),d.set_frequencyHz(r),this.myJoints.push(this.world.CreateJoint(d)),Box2D.destroy(d)}}},n.prototype.CreateRevoluteJoint=function(t,e){if(e&&this.enabled){var i=e.getFirstPicked(this.inst);if(i&&i!=this.inst)if(i.extra.box2dbody)this.myCreatedJoints.push({type:1,params:[t,i.uid]}),this.doCreateRevoluteJoint(t,i.uid)}},e.doCreateRevoluteJoint=function(t,e){if(this.enabled){var i=this.runtime.getObjectByUID(e);if(i&&i!=this.inst&&i.extra.box2dbody){i.extra.box2dbody.c2userdata.joiningMe.add(this.inst);var n=this.getInstImgPointX(t),r=this.getInstImgPointY(t),o=new l;o.Initialize(this.body,i.extra.box2dbody,getTempVec2a(.02*n,.02*r)),this.myJoints.push(this.world.CreateJoint(o)),Box2D.destroy(o)}}},n.prototype.CreateLimitedRevoluteJoint=function(t,e,i,n){if(e&&this.enabled){var r=e.getFirstPicked(this.inst);if(r&&r!=this.inst)if(r.extra.box2dbody)this.myCreatedJoints.push({type:2,params:[t,r.uid,i,n]}),this.doCreateLimitedRevoluteJoint(t,r.uid,i,n)}},e.doCreateLimitedRevoluteJoint=function(t,e,i,n){if(this.enabled){var r=this.runtime.getObjectByUID(e);if(r&&r!=this.inst&&r.extra.box2dbody){r.extra.box2dbody.c2userdata.joiningMe.add(this.inst);var o=this.getInstImgPointX(t),s=this.getInstImgPointY(t),a=new l;a.Initialize(this.body,r.extra.box2dbody,getTempVec2a(.02*o,.02*s)),a.set_enableLimit(!0),a.set_lowerAngle(drama.to_radians(i)),a.set_upperAngle(drama.to_radians(n)),this.myJoints.push(this.world.CreateJoint(a)),Box2D.destroy(a)}}},n.prototype.SetWorldGravity=function(t){if(t!==this.behavior.worldG){var e,i;this.world.SetGravity(getTempVec2a(0,t)),this.behavior.worldG=t;var n=this.behavior.my_instances.valuesRef();for(e=0,i=n.length;e<i;e++)if(n[e].extra.box2dbody)n[e].extra.box2dbody.SetAwake(!0)}},n.prototype.SetSteppingMode=function(t){this.behavior.steppingMode=t},n.prototype.SetIterations=function(t,e){if(t<1)t=1;if(e<1)e=1;this.behavior.velocityIterations=t,this.behavior.positionIterations=e},n.prototype.SetVelocity=function(t,e){if(this.enabled)this.body.SetLinearVelocity(getTempVec2a(.02*t,.02*e)),this.body.SetAwake(!0),this.lastTickOverride=!1,this.lastKnownX=this.inst.x,this.lastKnownY=this.inst.y},n.prototype.SetPhysicsParam=function(t,e,i,n,r,o){var s=!0,a=!0,l=!0,c=!0,u=!0;if(o)s="true"===(o=o.split("|"))[0],a="true"===o[1],l="true"===o[2],c="true"===o[3],u="true"===o[4];if(this.enabled){if(this.density!==t&&s)this.density=t,this.fixture.SetDensity(t),this.body.ResetMassData();if(this.friction!==e&&a){var h,d;for(this.friction=e,this.fixture.SetFriction(e),h=this.body.GetContactList();Box2D.getPointer(h);h=h.get_next())if(d=h.get_contact())d.ResetFriction()}if(this.restitution!==i&&l)this.restitution=i,this.fixture.SetRestitution(i);if(this.linearDamping!==n&&c)this.linearDamping=n,this.body.SetLinearDamping(n);if(this.angularDamping!==r&&u)this.angularDamping=r,this.body.SetAngularDamping(r)}},n.prototype.SetDensity=function(t){if(this.enabled)if(this.density!==t)this.density=t,this.fixture.SetDensity(t),this.body.ResetMassData()},n.prototype.SetFriction=function(t){if(this.enabled)if(this.friction!==t){var e,i;for(this.friction=t,this.fixture.SetFriction(t),e=this.body.GetContactList();Box2D.getPointer(e);e=e.get_next())if(i=e.get_contact())i.ResetFriction()}},n.prototype.SetElasticity=function(t){if(this.enabled)if(this.restitution!==t)this.restitution=t,this.fixture.SetRestitution(t)},n.prototype.SetLinearDamping=function(t){if(this.enabled)if(this.linearDamping!==t)this.linearDamping=t,this.body.SetLinearDamping(t)},n.prototype.SetAngularDamping=function(t){if(this.enabled)if(this.angularDamping!==t)this.angularDamping=t,this.body.SetAngularDamping(t)},n.prototype.SetImmovable=function(t){if(this.enabled)if(this.immovable!==(0!==t))this.immovable=0!==t,this.body.SetType(this.immovable?0:2),this.body.SetAwake(!0)},n.prototype.EnableCollisions=function(t,e){if(t&&this.enabled){var i,n;if(t.is_family)for(i=0,n=t.members.length;i<n;i++)r(this.inst.type,t.members[i],0==e);else r(this.inst.type,t,0==e);this.behavior.allCollisionsEnabled=!1}},n.prototype.SetPreventRotate=function(t){if(this.enabled)if(this.preventRotation!==(0!==t))this.preventRotation=0!==t,this.body.SetFixedRotation(this.preventRotation),this.body.SetAngularVelocity(0),this.body.SetAwake(!0)},n.prototype.SetBullet=function(t){if(this.enabled)if(this.bullet!==(0!==t))this.bullet=0!==t,this.body.SetBullet(this.bullet),this.body.SetAwake(!0)},n.prototype.RemoveJoints=function(){if(this.enabled)this.destroyMyJoints(),drama.clearArray(this.myCreatedJoints),this.joiningMe.clear()},n.prototype.SetEnabled=function(t){if(this.enabled&&0===t)this.destroyBody(),this.enabled=!1;else if(!this.enabled&&1===t)this.enabled=!0,this.createBody()},t.acts=new n,o.prototype.VelocityX=function(t){t.set_float(this.enabled?this.body.GetLinearVelocity().get_x()/.02:0)},o.prototype.VelocityY=function(t){t.set_float(this.enabled?this.body.GetLinearVelocity().get_y()/.02:0)},o.prototype.AngularVelocity=function(t){t.set_float(this.enabled?drama.to_degrees(this.body.GetAngularVelocity()):0)},o.prototype.Mass=function(t){t.set_float(this.enabled?this.body.GetMass()/.02:0)},o.prototype.CenterOfMassX=function(t){t.set_float(this.enabled?(this.body.GetPosition().get_x()+this.body.GetLocalCenter().get_x())/.02:0)},o.prototype.CenterOfMassY=function(t){t.set_float(this.enabled?(this.body.GetPosition().get_y()+this.body.GetLocalCenter().get_y())/.02:0)},o.prototype.Density=function(t){t.set_float(this.enabled?this.density:0)},o.prototype.Friction=function(t){t.set_float(this.enabled?this.friction:0)},o.prototype.Elasticity=function(t){t.set_float(this.enabled?this.restitution:0)},o.prototype.LinearDamping=function(t){t.set_float(this.enabled?this.linearDamping:0)},o.prototype.AngularDamping=function(t){t.set_float(this.enabled?this.angularDamping:0)},t.exps=new o}(),assert2(drama,"drama namespace not created"),assert2(drama.behaviors,"drama.behaviors not created"),drama.behaviors.Pin=function(t){this.runtime=t},function(){var t=drama.behaviors.Pin.prototype;t.Type=function(t,e){this.behavior=t,this.objtype=e,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t,e){this.type=t,this.behavior=t.behavior,this.inst=e,this.runtime=t.runtime};var e=t.Instance.prototype;function i(){}function n(){}function r(){}e.onCreate=function(){this.bbox_changed_callback=this.tick2.bind(this),this.bindObj(null),this.pinObjectUid=-1,this.pinAngle=0,this.pinDist=0,this.myStartAngle=0,this.theirStartAngle=0,this.lastKnownAngle=0,this.mode=0,this.bindPoint1=0,this.bindPoint2=0;var e=this;if(!this.recycled)this.myDestroyCallback=function(t){e.onInstanceDestroyed(t)};this.runtime.addDestroyCallback(this.myDestroyCallback)},e.saveToJSON=function(){return{uid:this.pinObject?this.pinObject.uid:-1,pa:this.pinAngle,pd:this.pinDist,msa:this.myStartAngle,tsa:this.theirStartAngle,lka:this.lastKnownAngle,m:this.mode}},e.loadFromJSON=function(t){this.pinObjectUid=t.uid,this.pinAngle=t.pa,this.pinDist=t.pd,this.myStartAngle=t.msa,this.theirStartAngle=t.tsa,this.lastKnownAngle=t.lka,this.mode=t.m},e.afterLoad=function(){if(-1===this.pinObjectUid)this.bindObj(null);else this.bindObj(this.runtime.getObjectByUID(this.pinObjectUid)),assert2(this.pinObject,"Failed to find pin object by UID");this.pinObjectUid=-1},e.onInstanceDestroyed=function(t){if(this.pinObject==t)this.bindObj(null)},e.onDestroy=function(){this.bindObj(null),this.runtime.removeDestroyCallback(this.myDestroyCallback)},e.tick=function(){},e.tick2=function(){if(this.pinObject){if(this.lastKnownAngle!==this.inst.angle)this.myStartAngle=drama.clamp_angle(this.myStartAngle+(this.inst.angle-this.lastKnownAngle));var t=this.inst.x,e=this.inst.y;if(3===this.mode||4===this.mode){var i=drama.distanceTo(this.inst.x,this.inst.y,this.pinObject.x,this.pinObject.y);if(i>this.pinDist||4===this.mode&&i<this.pinDist){var n=drama.angleTo(this.pinObject.x,this.pinObject.y,this.inst.x,this.inst.y);t=this.pinObject.x+Math.cos(n)*this.pinDist,e=this.pinObject.y+Math.sin(n)*this.pinDist}}else t=this.pinObject.x+Math.cos(this.pinObject.angle+this.pinAngle)*this.pinDist,e=this.pinObject.y+Math.sin(this.pinObject.angle+this.pinAngle)*this.pinDist;var r=drama.clamp_angle(this.myStartAngle+(this.pinObject.angle-this.theirStartAngle));if(this.lastKnownAngle=r,!(0!==this.mode&&1!==this.mode&&3!==this.mode&&4!==this.mode||this.inst.x===t&&this.inst.y===e))this.inst.x=t,this.inst.y=e,this.inst.set_bbox_changed();if((0===this.mode||2===this.mode)&&this.inst.angle!==r)this.inst.angle=r,this.inst.set_bbox_changed()}},e.getImagePointIndex=function(t,e){var i=0;if(drama.is_string(e))i=t.getImagePointIndexByName(e)+1;else i=e;if((i=drama.floor(i))<0||i>=t.curFrame.image_points.length+1)i=0;return i},e.bindObj=function(t){if(this.pinObject)this.pinObject.remove_bbox_changed_callback(this.bbox_changed_callback);if(this.pinObject=t,this.pinObject)this.pinObject.add_bbox_changed_callback(this.bbox_changed_callback)},e.getDebuggerValues=function(t){t.push({title:this.type.name,properties:[{name:"Is pinned",value:!!this.pinObject,readonly:!0},{name:"Pinned UID",value:this.pinObject?this.pinObject.uid:0,readonly:!0},{name:"绑定点1",value:this.bindPoint1,readonly:!0},{name:"绑定点2",value:this.bindPoint2,readonly:!0}]})},i.prototype.IsPinned=function(){return!!this.pinObject},i.prototype.IsUnPinned=function(){return!this.pinObject},t.cnds=new i,n.prototype.Pin=function(t,e,i,n){if(t){var r=t.getFirstPicked(this.inst);if(r){this.bindObj(r);var o=this.inst.x,s=this.inst.y,a=r.x,l=r.y;if(this.bindPoint1=0,this.bindPoint2=0,drama.plugins_.Sprite&&this.inst.type.plugin instanceof drama.plugins_.Sprite)this.bindPoint1=this.getImagePointIndex(this.inst,i),o=this.inst.getImagePoint(this.bindPoint1,!0),s=this.inst.getImagePoint(this.bindPoint1,!1);if(drama.plugins_.Sprite&&r.type.plugin instanceof drama.plugins_.Sprite)this.bindPoint2=this.getImagePointIndex(r,n),a=r.getImagePoint(this.bindPoint2,!0),l=r.getImagePoint(this.bindPoint2,!1);this.pinAngle=drama.angleTo(a,l,o,s)-r.angle,this.pinDist=drama.distanceTo(a,l,o,s),this.myStartAngle=this.inst.angle,this.lastKnownAngle=this.inst.angle,this.theirStartAngle=r.angle,this.mode=e}}},n.prototype.Unpin=function(){this.bindObj(null)},t.acts=new n,r.prototype.PinnedUID=function(t){t.set_int(this.pinObject?this.pinObject.uid:-1)},t.exps=new r}(),assert2(drama,"drama namespace not created"),assert2(drama.behaviors,"drama.behaviors not created"),drama.behaviors.Platform=function(t){this.runtime=t},function(){var t=drama.behaviors.Platform.prototype,o=xf.GameConst.DirectionEnum;t.Type=function(t,e){this.behavior=t,this.objtype=e,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){};t.Instance=function(t,e){this.type=t,this.behavior=t.behavior,this.inst=e,this.runtime=t.runtime,this.leftkey=!1,this.rightkey=!1,this.jumpkey=!1,this.jumped=!1,this.doubleJumped=!1,this.canDoubleJump=!1,this.ignoreInput=!1,this.simleft=!1,this.simright=!1,this.simjump=!1,this.lastFloorObject=null,this.loadFloorObject=-1,this.lastFloorX=0,this.lastFloorY=0,this.floorIsJumpthru=!1,this.animMode=0,this.fallthrough=0,this.firstTick=!0,this.dx=0,this.dy=0};var e=t.Instance.prototype;e.updateGravity=function(){if(this.downx=Math.cos(this.ga),this.downy=Math.sin(this.ga),this.rightx=Math.cos(this.ga-Math.PI/2),this.righty=Math.sin(this.ga-Math.PI/2),this.downx=drama.round6dp(this.downx),this.downy=drama.round6dp(this.downy),this.rightx=drama.round6dp(this.rightx),this.righty=drama.round6dp(this.righty),this.g1=this.g,this.g<0)this.downx*=-1,this.downy*=-1,this.g=Math.abs(this.g)},e.onCreate=function(){if(this.maxspeed=this.properties[0],this.acc=this.properties[1],this.dec=this.properties[2],this.jumpStrength=this.properties[3],this.g=this.properties[4],this.g1=this.g,this.maxFall=this.properties[5],this.enableDoubleJump=this.properties[6],this.jumpSustain=this.properties[7]/1e3,this.defaultControls=this.properties[8],this.controlType=this.properties[9],this.jumpBtnName=this.properties[10],this.joystickName=this.properties[11],this.turnMirror=this.properties[12],this.faceDirection=this.properties[13],this.enabled=this.properties[14],this.bindingAnim=this.properties[15],this.wasOnFloor=!1,this.wasOverJumpthru=this.runtime.testOverlapJumpThru(this.inst),this.loadOverJumpthru=-1,this.sustainTime=0,this.isOnJump=!1,this.isOnFall=!1,this.isOnLand=!1,this.isOnStop=!1,this.isOnMove=!1,this.ga=drama.to_radians(90),this.updateGravity(),this.defaultControls)if(xf.EventCenter.instance.addEventListener(xf.EventType.JOYSTICK_MOVE,this.onJoystickMove,this),xf.EventCenter.instance.addEventListener(xf.EventType.JOYSTICK_RESET,this.onJoystickReset,this),xf.EventCenter.instance.addEventListener(xf.EventType.BUTTON_CLICKED,this.onJumpBtnClick,this),2!==this.controlType)this.onKeyDownEvent=this.onKeyDown.bind(this),this.onKeyUpEvent=this.onKeyUp.bind(this),document.addEventListener("keydown",this.onKeyDownEvent),document.addEventListener("keyup",this.onKeyUpEvent);if(!this.recycled){var e=this;this.myDestroyCallback=function(t){e.onInstanceDestroyed(t)}}if(this.runtime.addDestroyCallback(this.myDestroyCallback),this.inst.extra.isPlatformBehavior=!0,0!=this.faceDirection)this.inst.width*=-1},e.saveToJSON=function(){return{ii:this.ignoreInput,lfx:this.lastFloorX,lfy:this.lastFloorY,lfo:this.lastFloorObject?this.lastFloorObject.uid:-1,am:this.animMode,en:this.enabled,fall:this.fallthrough,ft:this.firstTick,dx:this.dx,dy:this.dy,ms:this.maxspeed,acc:this.acc,dec:this.dec,js:this.jumpStrength,g:this.g,g1:this.g1,mf:this.maxFall,wof:this.wasOnFloor,woj:this.wasOverJumpthru?this.wasOverJumpthru.uid:-1,ga:this.ga,edj:this.enableDoubleJump,cdj:this.canDoubleJump,dj:this.doubleJumped,sus:this.jumpSustain,fm:this.turnMirror,fd:this.faceDirection,ct:this.controlType,jsi:this.joystickName,jbi:this.jumpBtnName}},e.loadFromJSON=function(t){this.ignoreInput=t.ii,this.lastFloorX=t.lfx,this.lastFloorY=t.lfy,this.loadFloorObject=t.lfo,this.animMode=t.am,this.enabled=t.en,this.fallthrough=t.fall,this.firstTick=t.ft,this.dx=t.dx,this.dy=t.dy,this.maxspeed=t.ms,this.acc=t.acc,this.dec=t.dec,this.jumpStrength=t.js,this.g=t.g,this.g1=t.g1,this.maxFall=t.mf,this.wasOnFloor=t.wof,this.loadOverJumpthru=t.woj,this.ga=t.ga,this.enableDoubleJump=t.edj,this.canDoubleJump=t.cdj,this.doubleJumped=t.dj,this.jumpSustain=t.sus,this.turnMirror=t.fm,this.faceDirection=t.fd,this.controlType=t.ct,this.joystickName=t.jsi,this.jumpBtnName=t.jbi,this.leftkey=!1,this.rightkey=!1,this.jumpkey=!1,this.jumped=!1,this.simleft=!1,this.simright=!1,this.simjump=!1,this.sustainTime=0,this.updateGravity()},e.afterLoad=function(){if(-1===this.loadFloorObject)this.lastFloorObject=null;else this.lastFloorObject=this.runtime.getObjectByUID(this.loadFloorObject);if(-1===this.loadOverJumpthru)this.wasOverJumpthru=null;else this.wasOverJumpthru=this.runtime.getObjectByUID(this.loadOverJumpthru)},e.onInstanceDestroyed=function(t){if(this.lastFloorObject==t)this.lastFloorObject=null},e.onDestroy=function(){if(this.defaultControls)if(xf.EventCenter.instance.removeEventListener(xf.EventType.JOYSTICK_MOVE,this.onJoystickMove,this),xf.EventCenter.instance.removeEventListener(xf.EventType.JOYSTICK_RESET,this.onJoystickReset,this),xf.EventCenter.instance.removeEventListener(xf.EventType.SPRITE_CLICKED,this.onJumpBtnClick,this),2!==this.controlType)document.removeEventListener("keydown",this.onKeyDownEvent),document.removeEventListener("keyup",this.onKeyUpEvent);this.lastFloorObject=null,this.runtime.removeDestroyCallback(this.myDestroyCallback)},e.onJoystickMove=function(t){var e=t.messageData;if(-1!==e.types.indexOf(this.inst.type.sid)||2===this.controlType&&e.name===this.joystickName){var i=e.direction,n=i==o.LEFT||i==o.LEFTUP||i==o.LEFTDOWN,r=i==o.RIGHT||i==o.RIGHTUP||i==o.RIGHTDOWN;this.leftkey=n,this.rightkey=r}},e.onJoystickReset=function(t){if(t.messageData.name==this.joystickName)this.leftkey=!1,this.rightkey=!1},e.onJumpBtnClick=function(t){if(t.messageData.name==this.jumpBtnName)this.simjump=!0},e.onKeyDown=function(t){if(0==this.controlType)switch(t.which){case 38:t.preventDefault(),this.jumpkey=!0;break;case 37:t.preventDefault(),this.leftkey=!0;break;case 39:t.preventDefault(),this.rightkey=!0}else switch(t.which){case 87:t.preventDefault(),this.jumpkey=!0;break;case 65:t.preventDefault(),this.leftkey=!0;break;case 68:t.preventDefault(),this.rightkey=!0}},e.onKeyUp=function(t){if(0==this.controlType)switch(t.which){case 38:t.preventDefault(),this.jumpkey=!1,this.jumped=!1;break;case 37:t.preventDefault(),this.leftkey=!1;break;case 39:t.preventDefault(),this.rightkey=!1}else switch(t.which){case 87:t.preventDefault(),this.jumpkey=!1,this.jumped=!1;break;case 65:t.preventDefault(),this.leftkey=!1;break;case 68:t.preventDefault(),this.rightkey=!1}},e.onWindowBlur=function(){this.leftkey=!1,this.rightkey=!1,this.jumpkey=!1},e.getGDir=function(){if(this.g<0)return-1;else return 1},e.isOnFloor=function(){var t,e,i,n=null,r=null,o=this.inst.x,s=this.inst.y;if(this.inst.x+=this.downx,this.inst.y+=this.downy,this.inst.set_bbox_changed(),this.lastFloorObject&&this.runtime.testOverlap(this.inst,this.lastFloorObject)&&(!this.runtime.typeHasBehavior(this.lastFloorObject.type,drama.behaviors.solid)||this.lastFloorObject.extra.solidEnabled))return this.inst.x=o,this.inst.y=s,this.inst.set_bbox_changed(),this.lastFloorObject;else{if(!(n=this.runtime.testOverlapSolid(this.inst))&&0===this.fallthrough)r=this.runtime.testOverlapJumpThru(this.inst,!0);if(this.inst.x=o,this.inst.y=s,this.inst.set_bbox_changed(),n)if(this.runtime.testOverlap(this.inst,n))return null;else return this.floorIsJumpthru=!1,n;if(r&&r.length){for(i=t=0,e=r.length;t<e;t++)if(r[i]=r[t],!this.runtime.testOverlap(this.inst,r[t]))i++;if(1<=i)return this.floorIsJumpthru=!0,r[0]}return null}},e.tick=function(){},e.posttick=function(){this.isOnJump=!1,this.isOnFall=!1,this.isOnLand=!1,this.isOnStop=!1,this.isOnMove=!1;var t,e,i,n,r,o,s,a,l,c,u=this.runtime.getDt(this.inst);if(!this.jumpkey&&!this.simjump)this.jumped=!1;var h=this.leftkey||this.simleft,d=this.rightkey||this.simright,p=this.jumpkey||this.simjump,f=p&&!this.jumped;if(this.simleft=!1,this.simright=!1,this.simjump=!1,this.enabled){if(this.ignoreInput)f=p=d=h=!1;if(!p)this.sustainTime=0;var m=this.lastFloorObject,g=!1;if(this.firstTick){if(this.runtime.testOverlapSolid(this.inst)||this.runtime.testOverlapJumpThru(this.inst))this.runtime.pushOutSolid(this.inst,-this.downx,-this.downy,4,!0);this.firstTick=!1}if(m&&0===this.dy&&(m.y!==this.lastFloorY||m.x!==this.lastFloorX))if(t=m.x-this.lastFloorX,e=m.y-this.lastFloorY,this.inst.x+=t,this.inst.y+=e,this.inst.set_bbox_changed(),this.lastFloorX=m.x,this.lastFloorY=m.y,g=!0,this.runtime.testOverlapSolid(this.inst))this.runtime.pushOutSolid(this.inst,-t,-e,2.5*Math.sqrt(t*t+e*e));var y=this.isOnFloor(),v=this.runtime.testOverlapSolid(this.inst);if(v)if(this.inst.extra.inputPredicted)this.runtime.pushOutSolid(this.inst,-this.downx,-this.downy,10,!1);else if(this.runtime.pushOutSolidNearest(this.inst,Math.max(this.inst.width,this.inst.height)/2))this.runtime.registerCollision(this.inst,v);else return;if(y){if(this.doubleJumped=!1,this.canDoubleJump=!1,0<this.dy)this.dy=0;if(m!=y)this.lastFloorObject=y,this.lastFloorX=y.x,this.lastFloorY=y.y,this.runtime.registerCollision(this.inst,y);else if(g)if(v=this.runtime.testOverlapSolid(this.inst)){if(this.runtime.registerCollision(this.inst,v),0!==t)if(0<t)this.runtime.pushOutSolid(this.inst,-this.rightx,-this.righty);else this.runtime.pushOutSolid(this.inst,this.rightx,this.righty);this.runtime.pushOutSolid(this.inst,-this.downx,-this.downy)}}else if(!p)this.canDoubleJump=!0;if(y&&f||!y&&this.enableDoubleJump&&p&&this.canDoubleJump&&!this.doubleJumped){if(l=this.inst.x,c=this.inst.y,this.inst.x-=this.downx,this.inst.y-=this.downy,this.inst.set_bbox_changed(),!this.runtime.testOverlapSolid(this.inst))if(this.sustainTime=this.jumpSustain,this.isOnJump=!0,this.runtime.trigger(drama.behaviors.Platform.prototype.cnds.OnJump,this.inst),this.runtime.trigger(drama.behaviors.Platform.prototype.cnds.OnPlatformChange,this.inst),this.animMode=2,this.dy=-this.jumpStrength,f=!0,y)this.jumped=!0;else this.doubleJumped=!0;else f=!1;this.inst.x=l,this.inst.y=c,this.inst.set_bbox_changed()}if(!y){if(p&&0<this.sustainTime)this.dy=-this.jumpStrength,this.sustainTime-=u;else if(this.lastFloorObject=null,this.dy+=this.g*u,this.dy>this.maxFall)this.dy=this.maxFall;if(f)this.jumped=!0}this.wasOnFloor=!!y;var b=this.inst.width;if(h==d)if(this.dx<0){if(this.dx+=this.dec*u,0<this.dx)this.dx=0}else if(0<this.dx)if(this.dx-=this.dec*u,this.dx<0)this.dx=0;var _=0;if(h&&!d){if(0<this.dx)_=-(this.acc+this.dec);else _=-this.acc;if(0<b&&this.turnMirror)b*=-1}if(d&&!h){if(this.dx<0)_=this.acc+this.dec;else _=this.acc;if(b<0&&this.turnMirror)b*=-1}if(this.inst.width!=b)this.inst.width=b;if(this.dx+=_*u,this.dx>this.maxspeed)this.dx=this.maxspeed;else if(this.dx<-this.maxspeed)this.dx=-this.maxspeed;var w=!1;if(0!==this.dx){l=this.inst.x,c=this.inst.y,t=this.runtime.accelerate(this.dx,-this.maxspeed,this.maxspeed,_,u)*this.rightx,e=this.runtime.accelerate(this.dx,-this.maxspeed,this.maxspeed,_,u)*this.righty,this.inst.x+=this.rightx*(1<this.dx?1:-1)-this.downx,this.inst.y+=this.righty*(1<this.dx?1:-1)-this.downy,this.inst.set_bbox_changed();var x=!1,S=this.runtime.testOverlapSolid(this.inst);if(this.inst.x=l+t,this.inst.y=c+e,this.inst.set_bbox_changed(),!(i=this.runtime.testOverlapSolid(this.inst))&&y)if(i=this.runtime.testOverlapJumpThru(this.inst)){if(this.inst.x=l,this.inst.y=c,this.inst.set_bbox_changed(),this.runtime.testOverlap(this.inst,i))i=null,x=!1;else x=!0;this.inst.x=l+t,this.inst.y=c+e,this.inst.set_bbox_changed()}if(i){var I=Math.abs(this.dx*u)+2;if(S||!this.runtime.pushOutSolid(this.inst,-this.downx,-this.downy,I,x,i)){if(this.runtime.registerCollision(this.inst,i),I=Math.max(Math.abs(this.dx*u*2.5),30),!this.runtime.pushOutSolid(this.inst,this.rightx*(this.dx<0?1:-1),this.righty*(this.dx<0?1:-1),I,!1))this.inst.x=l,this.inst.y=c,this.inst.set_bbox_changed();else if(y&&!x&&!this.floorIsJumpthru)if(l=this.inst.x,c=this.inst.y,this.inst.x+=this.downx,this.inst.y+=this.downy,this.runtime.testOverlapSolid(this.inst)){if(!this.runtime.pushOutSolid(this.inst,-this.downx,-this.downy,3,!1))this.inst.x=l,this.inst.y=c,this.inst.set_bbox_changed()}else this.inst.x=l,this.inst.y=c,this.inst.set_bbox_changed();if(!x)this.dx=0}else if(!S&&!f&&Math.abs(this.dy)<Math.abs(this.jumpStrength/4))if(this.dy=0,!y)w=!0}else{var T=this.isOnFloor();if(y&&!T)if(n=Math.ceil(Math.abs(this.dx*u))+2,l=this.inst.x,c=this.inst.y,this.inst.x+=this.downx*n,this.inst.y+=this.downy*n,this.inst.set_bbox_changed(),this.runtime.testOverlapSolid(this.inst)||this.runtime.testOverlapJumpThru(this.inst))this.runtime.pushOutSolid(this.inst,-this.downx,-this.downy,n+2,!0);else this.inst.x=l,this.inst.y=c,this.inst.set_bbox_changed();else if(T&&0===this.dy)this.runtime.pushInFractional(this.inst,-this.downx,-this.downy,T,16)}}if(0!==this.dy){l=this.inst.x,c=this.inst.y,this.inst.x+=this.runtime.accelerate(this.dy,-1/0,this.maxFall,this.g,u)*this.downx,this.inst.y+=this.runtime.accelerate(this.dy,-1/0,this.maxFall,this.g,u)*this.downy;var C=this.inst.x,O=this.inst.y;this.inst.set_bbox_changed();var P=!1;if(!(v=this.runtime.testOverlapSolid(this.inst))&&0<this.dy&&!y){if((r=0<this.fallthrough?null:this.runtime.testOverlapJumpThru(this.inst,!0))&&r.length){if(this.wasOverJumpthru){for(this.inst.x=l,this.inst.y=c,this.inst.set_bbox_changed(),a=o=0,s=r.length;o<s;o++)if(r[a]=r[o],!this.runtime.testOverlap(this.inst,r[o]))a++;r.length=a,this.inst.x=C,this.inst.y=O,this.inst.set_bbox_changed()}if(1<=r.length)v=r[0]}P=!!v}if(v){this.runtime.registerCollision(this.inst,v),this.sustainTime=0;I=P?Math.abs(this.dy*u*2.5+10):Math.max(Math.abs(this.dy*u*2.5+10),30);if(!this.runtime.pushOutSolid(this.inst,this.downx*(this.dy<0?1:-1),this.downy*(this.dy<0?1:-1),I,P,v)){if(this.inst.x=l,this.inst.y=c,this.inst.set_bbox_changed(),this.wasOnFloor=!0,!P)this.dy=0}else{if(this.lastFloorObject=v,this.lastFloorX=v.x,this.lastFloorY=v.y,this.floorIsJumpthru=P)w=!0;this.dy=0}}}if(3!==this.animMode&&0<this.dy&&!y)this.isOnFall=!0,this.runtime.trigger(drama.behaviors.Platform.prototype.cnds.OnFall,this.inst),this.runtime.trigger(drama.behaviors.Platform.prototype.cnds.OnPlatformChange,this.inst),this.animMode=3;if(y||w)if(3===this.animMode||w||f&&0===this.dy)if(this.isOnLand=!0,this.runtime.trigger(drama.behaviors.Platform.prototype.cnds.OnLand,this.inst),this.runtime.trigger(drama.behaviors.Platform.prototype.cnds.OnPlatformChange,this.inst),0===this.dx&&0===this.dy)this.animMode=0;else this.animMode=1;else{if(0!==this.animMode&&0===this.dx&&0===this.dy)this.isOnStop=!0,this.runtime.trigger(drama.behaviors.Platform.prototype.cnds.OnStop,this.inst),this.runtime.trigger(drama.behaviors.Platform.prototype.cnds.OnPlatformChange,this.inst),this.animMode=0;if(1!==this.animMode&&(0!==this.dx||0!==this.dy)&&!f)this.isOnMove=!0,this.runtime.trigger(drama.behaviors.Platform.prototype.cnds.OnMove,this.inst),this.runtime.trigger(drama.behaviors.Platform.prototype.cnds.OnPlatformChange,this.inst),this.animMode=1}if(this.inst.type.plugin instanceof drama.plugins_.Sprite&&this.bindingAnim){var E=this.inst.cur_animation,A=E.name;switch(this.animMode){case 1:A=this.properties[14];break;case 0:A=this.properties[15];break;case 2:A=this.properties[16];break;case 3:A=this.properties[17]}if(E.name!==A)this.inst.changeAnimName=A||"",this.inst.changeAnimFrom=0}if(0<this.fallthrough)this.fallthrough--;this.wasOverJumpthru=this.runtime.testOverlapJumpThru(this.inst)}};var i=["stopped","moving","jumping","falling"];function n(){}function r(){}function s(){}e.getDebuggerValues=function(t){t.push({title:this.type.name,properties:[{name:"Vector X",value:this.dx},{name:"Vector Y",value:this.dy},{name:"Max speed",value:this.maxspeed},{name:"Acceleration",value:this.acc},{name:"Deceleration",value:this.dec},{name:"Jump strength",value:this.jumpStrength},{name:"Gravity",value:this.g},{name:"Gravity angle",value:drama.to_degrees(this.ga)},{name:"Max fall speed",value:this.maxFall},{name:"Animation mode",value:i[this.animMode],readonly:!0},{name:"Enabled",value:this.enabled}]})},e.onDebugValueEdited=function(t,e,i){switch(e){case"Vector X":this.dx=i;break;case"Vector Y":this.dy=i;break;case"Max speed":this.maxspeed=i;break;case"Acceleration":this.acc=i;break;case"Deceleration":this.dec=i;break;case"Jump strength":this.jumpStrength=i;break;case"Gravity":this.g=i;break;case"Gravity angle":this.ga=drama.to_radians(i);break;case"Max fall speed":this.maxFall=i;break;case"Enabled":this.enabled=i}this.updateGravity()},n.prototype.IsPlatformStatus=function(t){if(0==t)return 0!==this.dx||0!==this.dy;if(1==t){if(0!==this.dy)return!1;var e,i,n,r,o=null,s=this.inst.x,a=this.inst.y;if(this.inst.x+=this.downx,this.inst.y+=this.downy,this.inst.set_bbox_changed(),!(e=this.runtime.testOverlapSolid(this.inst))&&0===this.fallthrough)o=this.runtime.testOverlapJumpThru(this.inst,!0);if(this.inst.x=s,this.inst.y=a,this.inst.set_bbox_changed(),e)return!this.runtime.testOverlap(this.inst,e);if(o&&o.length){for(r=i=0,n=o.length;i<n;i++)if(o[r]=o[i],!this.runtime.testOverlap(this.inst,o[i]))r++;if(1<=r)return!0}return!1}if(2==t)return this.dy<0;if(3==t)return 0<this.dy;else return!1},n.prototype.IsMoving=function(){return 0!==this.dx||0!==this.dy},n.prototype.CompareSpeed=function(t,e){var i=Math.sqrt(this.dx*this.dx+this.dy*this.dy);return drama.do_cmp(i,t,e)},n.prototype.IsOnFloor=function(){if(0!==this.dy)return!1;var t,e,i,n,r=null,o=this.inst.x,s=this.inst.y;if(this.inst.x+=this.downx,this.inst.y+=this.downy,this.inst.set_bbox_changed(),!(t=this.runtime.testOverlapSolid(this.inst))&&0===this.fallthrough)r=this.runtime.testOverlapJumpThru(this.inst,!0);if(this.inst.x=o,this.inst.y=s,this.inst.set_bbox_changed(),t)return!this.runtime.testOverlap(this.inst,t);if(r&&r.length){for(n=e=0,i=r.length;e<i;e++)if(r[n]=r[e],!this.runtime.testOverlap(this.inst,r[e]))n++;if(1<=n)return!0}return!1},n.prototype.IsByWall=function(t){var e,i=this.inst.x,n=this.inst.y;if(0===t)this.inst.x-=2*this.rightx,this.inst.y-=2*this.righty;else this.inst.x+=2*this.rightx,this.inst.y+=2*this.righty;if(this.inst.set_bbox_changed(),!this.runtime.testOverlapSolid(this.inst))return this.inst.x=i,this.inst.y=n,this.inst.set_bbox_changed(),!1;else return this.inst.x-=3*this.downx,this.inst.y-=3*this.downy,this.inst.set_bbox_changed(),e=this.runtime.testOverlapSolid(this.inst),this.inst.x=i,this.inst.y=n,this.inst.set_bbox_changed(),e},n.prototype.IsJumping=function(){return this.dy<0},n.prototype.IsFalling=function(){return 0<this.dy},n.prototype.OnPlatformChange=function(t){if(0==t&&this.isOnJump)return!0;else if(1==t&&this.isOnFall)return!0;else if(2==t&&this.isOnStop)return!0;else if(3==t&&this.isOnMove)return!0;else if(4==t&&this.isOnLand)return!0;return!1},n.prototype.OnJump=function(){return!0},n.prototype.OnFall=function(){return!0},n.prototype.OnStop=function(){return!0},n.prototype.OnMove=function(){return!0},n.prototype.OnLand=function(){return!0},n.prototype.IsDoubleJumpEnabled=function(){return this.enableDoubleJump},t.cnds=new n,r.prototype.SetIgnoreInput=function(t){this.ignoreInput=t},r.prototype.SetMaxSpeed=function(t){if(this.maxspeed=t,this.maxspeed<0)this.maxspeed=0},r.prototype.SetPlatformParam=function(t,e,i,n,r,o,s,a,l){var c=!0,u=!0,h=!0,d=!0,p=!0,f=!0,m=!0,g=!0;if(l)c="true"===(l=l.split("|"))[0],u="true"===l[1],h="true"===l[2],d="true"===l[3],p="true"===l[4],f="true"===l[5],m="true"===l[6],g="true"===l[7];if(c)if(this.maxspeed=t,this.maxspeed<0)this.maxspeed=0;if(u)if(this.acc=e,this.acc<0)this.acc=0;if(h)if(this.dec=i,this.dec<0)this.dec=0;if(d)if(this.jumpStrength=n,this.jumpStrength<0)this.jumpStrength=0;if(this.g1!==r&&p){if(this.g=r,this.updateGravity(),this.runtime.testOverlapSolid(this.inst))this.runtime.pushOutSolid(this.inst,this.downx,this.downy,10),this.inst.x+=2*this.downx,this.inst.y+=2*this.downy,this.inst.set_bbox_changed();this.lastFloorObject=null}if(f)if(this.maxFall=o,this.maxFall<0)this.maxFall=0;if(s=drama.to_radians(s),s=drama.clamp_angle(s),this.ga!==s&&m)this.ga=s,this.updateGravity(),this.lastFloorObject=null;if(g)this.jumpSustain=a/1e3},r.prototype.SetAcceleration=function(t){if(this.acc=t,this.acc<0)this.acc=0},r.prototype.SetDeceleration=function(t){if(this.dec=t,this.dec<0)this.dec=0},r.prototype.SetJumpStrength=function(t){if(this.jumpStrength=t,this.jumpStrength<0)this.jumpStrength=0},r.prototype.SetGravity=function(t){if(this.g1!==t){if(this.g=t,this.updateGravity(),this.runtime.testOverlapSolid(this.inst))this.runtime.pushOutSolid(this.inst,this.downx,this.downy,10),this.inst.x+=2*this.downx,this.inst.y+=2*this.downy,this.inst.set_bbox_changed();this.lastFloorObject=null}},r.prototype.SetMaxFallSpeed=function(t){if(this.maxFall=t,this.maxFall<0)this.maxFall=0},r.prototype.SimulateControl=function(t){switch(t){case 0:this.simleft=!0;break;case 1:this.simright=!0;break;case 2:this.simjump=!0}},r.prototype.SetVectorXY=function(t,e,i,n){if(1==t)this.dx=e;if(1==i)this.dy=n},r.prototype.SetVectorX=function(t){this.dx=t},r.prototype.SetVectorY=function(t){this.dy=t},r.prototype.SetGravityAngle=function(t){if(t=drama.to_radians(t),t=drama.clamp_angle(t),this.ga!==t)this.ga=t,this.updateGravity(),this.lastFloorObject=null},r.prototype.SetEnabled=function(t){if(this.enabled!==(1===t))if(this.enabled=1===t,!this.enabled)this.lastFloorObject=null},r.prototype.FallThrough=function(){var t=this.inst.x,e=this.inst.y;this.inst.x+=this.downx,this.inst.y+=this.downy,this.inst.set_bbox_changed();var i=this.runtime.testOverlapJumpThru(this.inst,!1);if(this.inst.x=t,this.inst.y=e,this.inst.set_bbox_changed(),i)this.fallthrough=3,this.lastFloorObject=null},r.prototype.SetDoubleJumpEnabled=function(t){this.enableDoubleJump=0!==t},r.prototype.SetJumpSustain=function(t){this.jumpSustain=t/1e3},t.acts=new r,s.prototype.Speed=function(t){t.set_float(Math.sqrt(this.dx*this.dx+this.dy*this.dy))},s.prototype.MaxSpeed=function(t){t.set_float(this.maxspeed)},s.prototype.Acceleration=function(t){t.set_float(this.acc)},s.prototype.Deceleration=function(t){t.set_float(this.dec)},s.prototype.JumpStrength=function(t){t.set_float(this.jumpStrength)},s.prototype.Gravity=function(t){t.set_float(this.g)},s.prototype.GravityAngle=function(t){t.set_float(drama.to_degrees(this.ga))},s.prototype.MaxFallSpeed=function(t){t.set_float(this.maxFall)},s.prototype.MovingAngle=function(t){t.set_float(drama.to_degrees(Math.atan2(this.dy,this.dx)))},s.prototype.VectorX=function(t){t.set_float(this.dx)},s.prototype.VectorY=function(t){t.set_float(this.dy)},s.prototype.JumpSustain=function(t){t.set_float(1e3*this.jumpSustain)},t.exps=new s}(),assert2(drama,"drama namespace not created"),assert2(drama.behaviors,"drama.behaviors not created"),drama.behaviors.Rotate=function(t){this.runtime=t},function(){var t=drama.behaviors.Rotate.prototype;t.Type=function(t,e){this.behavior=t,this.objtype=e,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t,e){this.type=t,this.behavior=t.behavior,this.inst=e,this.runtime=t.runtime};var e=t.Instance.prototype;function i(){}function n(){}e.onCreate=function(){this.speed=drama.to_radians(this.properties[0]),this.acc=drama.to_radians(this.properties[1]),this.enabled=this.properties[2]},e.saveToJSON=function(){return{speed:this.speed,acc:this.acc,e:this.enabled}},e.loadFromJSON=function(t){if(this.speed=t.speed,this.acc=t.acc,t.hasOwnProperty("e"))this.enabled=t.e;else this.enabled=!0},e.tick=function(){if(this.enabled){var t=this.runtime.getDt(this.inst);if(0!==t){if(0!==this.acc)this.speed+=this.acc*t;if(0!==this.speed)this.inst.angle=drama.clamp_angle(this.inst.angle+this.speed*t),this.inst.set_bbox_changed()}}},e.getDebuggerValues=function(t){t.push({title:this.type.name,properties:[{name:"Speed",value:drama.to_degrees(this.speed)},{name:"Acceleration",value:drama.to_degrees(this.acc)},{name:"Enabled",value:this.enabled}]})},e.onDebugValueEdited=function(t,e,i){switch(e){case"Speed":this.speed=drama.to_radians(i);break;case"Acceleration":this.acc=drama.to_radians(i);break;case"Enabled":this.enabled=i}},t.cnds=new function(){},i.prototype.SetSpeed=function(t){this.speed=drama.to_radians(t)},i.prototype.SetAcceleration=function(t){this.acc=drama.to_radians(t)},i.prototype.SetEnabled=function(t){this.enabled=1===t},t.acts=new i,n.prototype.Speed=function(t){t.set_float(drama.to_degrees(this.speed))},n.prototype.Acceleration=function(t){t.set_float(drama.to_degrees(this.acc))},t.exps=new n}(),assert2(drama,"drama namespace not created"),assert2(drama.behaviors,"drama.behaviors not created"),drama.behaviors.Scroll=function(t){this.runtime=t},function(){var a=function(){function t(){}return t.scrollUp=0,t.scrollDown=1,t.scrollLeft=2,t.scrollRight=3,t}(),t=drama.behaviors.Scroll.prototype;t.Type=function(t,e){this.behavior=t,this.objtype=e,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t,e){this.type=t,this.behavior=t.behavior,this.inst=e,this.inst.scrollType=t,this.runtime=t.runtime};var e=t.Instance.prototype;function i(){}e.onCreate=function(){if(this.direction=this.properties[0],this.speed=this.properties[1],this.enabled=this.properties[2],this.startTime=0,!this.inst.isClone)this.cloneInst()},e.cloneInst=function(){this.inst.isClone=!0;var t=this.inst,e=this.runtime.createInstance(t.type,t.layer,void 0,void 0,!0);e.scrollIndex=this.inst.scrollIndex,this.copyInst=e,this.setCopyPos()},e.setCopyPos=function(){var t=this.inst.type.default_instance[0][0],e=this.inst.type.default_instance[0][1];if(this.copyInst)switch(this.inst.x=t,this.inst.y=e,this.direction){case a.scrollUp:this.copyInst.x=this.inst.x,this.copyInst.y=this.inst.y+this.inst.height;break;case a.scrollDown:this.copyInst.x=this.inst.x,this.copyInst.y=this.inst.y-this.inst.height;break;case a.scrollLeft:this.copyInst.x=this.inst.x+this.inst.width,this.copyInst.y=this.inst.y;break;case a.scrollRight:this.copyInst.x=this.inst.x-this.inst.width,this.copyInst.y=this.inst.y}},e.saveToJSON=function(){return{}},e.loadFromJSON=function(t){},e.tick=function(){if(this.enabled){var t=this.speed,e=this.inst;if(e){var i=t/60;switch(this.direction){case a.scrollUp:e.y-=i;var n=Math.round(e.height*e.hotspotY-e.height);if(e.y<n)e.y+=2*e.height;break;case a.scrollDown:e.y+=i;var r=Math.round(e.height+e.height*e.hotspotY);if(e.y>r)e.y-=2*e.height;break;case a.scrollLeft:e.x-=i;var o=Math.round(e.width*e.hotspotX-e.width);if(e.x<o)e.x+=2*e.width;break;case a.scrollRight:e.x+=i;var s=Math.round(e.width+e.width*e.hotspotX);if(e.x>s)e.x+=-2*e.width}e.set_bbox_changed()}}},i.prototype.SetEnabled=function(n){this.behavior.my_instances.s.forEach(function(t,e,i){t.behavior_insts.map(function(t){t.enabled=0!==n})}),this.enabled=0!==n},i.prototype.SetScrollParam=function(t,e,i){var n=!0,r=!0;if(i)n="true"===(i=i.split("|"))[0],r="true"===i[1];if(n)this.speed=t||100;if(this.direction!=e&&r)this.direction=e||0,this.setCopyPos()},i.prototype.SetDirection=function(t){if(this.direction!=t)this.direction=t||0,this.setCopyPos()},i.prototype.SetSpeed=function(t){this.speed=Math.max(0,t)},t.acts=new i}(),assert2(drama,"drama namespace not created"),assert2(drama.behaviors,"drama.behaviors not created"),drama.behaviors.scrollto=function(t){this.runtime=t,this.shakeMag=0,this.shakeStart=0,this.shakeEnd=0,this.shakeMode=0},function(){var t=drama.behaviors.scrollto.prototype;t.Type=function(t,e){this.behavior=t,this.objtype=e,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t,e){this.type=t,this.behavior=t.behavior,this.inst=e,this.runtime=t.runtime};var e=t.Instance.prototype;function f(t){var e,i,n;for(e=0,i=t.behavior_insts.length;e<i;++e)if((n=t.behavior_insts[e]).behavior instanceof drama.behaviors.scrollto)return n;return null}function i(){}e.onCreate=function(){this.enabled=this.properties[0],this.smoothScroll=this.properties[1]},e.saveToJSON=function(){return{smg:this.behavior.shakeMag,ss:this.behavior.shakeStart,se:this.behavior.shakeEnd,smd:this.behavior.shakeMode}},e.loadFromJSON=function(t){this.behavior.shakeMag=t.smg,this.behavior.shakeStart=t.ss,this.behavior.shakeEnd=t.se,this.behavior.shakeMode=t.smd},e.tick=function(){},e.tick2=function(){if(this.enabled){var t,e,i,n=this.behavior.my_instances.valuesRef(),r=0,o=0,s=0,a=this.inst.layer.layout;for(t=0,e=n.length;t<e;t++)if((i=f(n[t]))&&i.enabled)r+=n[t].x,o+=n[t].y,++s;var l=this.runtime.kahanTime.sum,c=0,u=0;if(l>=this.behavior.shakeStart&&l<this.behavior.shakeEnd){var h=this.behavior.shakeMag*Math.min(this.runtime.timescale,1);if(0===this.behavior.shakeMode)h*=1-(l-this.behavior.shakeStart)/(this.behavior.shakeEnd-this.behavior.shakeStart);var d=Math.random()*Math.PI*2,p=Math.random()*h;c=Math.cos(d)*p,u=Math.sin(d)*p}a.scrollToX(r/s+c,this.smoothScroll),a.scrollToY(o/s+u,this.smoothScroll)}},i.prototype.Shake=function(t,e,i){this.behavior.shakeMag=t,this.behavior.shakeStart=this.runtime.kahanTime.sum,this.behavior.shakeEnd=this.behavior.shakeStart+e,this.behavior.shakeMode=i},i.prototype.SetEnabled=function(t){this.enabled=0!==t},t.acts=new i}(),assert2(drama,"drama namespace not created"),assert2(drama.behaviors,"drama.behaviors not created"),drama.behaviors.shadowcaster=function(t){this.runtime=t,this.myTypes=[]},function(){var t=drama.behaviors.shadowcaster.prototype;t.Type=function(t,e){if(this.behavior=t,this.objtype=e,this.runtime=t.runtime,-1===this.behavior.myTypes.indexOf(e))this.behavior.myTypes.push(e)},t.Type.prototype.onCreate=function(){},t.Instance=function(t,e){this.type=t,this.behavior=t.behavior,this.inst=e,this.runtime=t.runtime};var e=t.Instance.prototype;function i(){}function n(){}function r(){}e.onCreate=function(){this.inst.extra.shadowcasterHeight=this.properties[0],this.inst.extra.shadowcasterTag=this.properties[1],this.inst.extra.shadowcasterEnabled=this.properties[2]},e.tick=function(){},e.getDebuggerValues=function(t){t.push({title:this.type.name,properties:[{name:"Enabled",value:this.inst.extra.shadowcasterEnabled},{name:"Height",value:this.inst.extra.shadowcasterHeight},{name:"Tag",value:this.inst.extra.shadowcasterTag}]})},e.onDebugValueEdited=function(t,e,i){if("Enabled"===e)this.inst.extra.shadowcasterEnabled=i;else if("Height"===e)this.inst.extra.shadowcasterHeight=i;else if("Tag"===e)this.inst.extra.shadowcasterTag=i},i.prototype.IsEnabled=function(){return this.inst.extra.shadowcasterEnabled},i.prototype.CompareHeight=function(t,e){var i=this.inst.extra.shadowcasterHeight;return drama.do_cmp(i,t,e)},t.cnds=new i,n.prototype.SetEnabled=function(t){this.inst.extra.shadowcasterEnabled=!!t},n.prototype.SetHeight=function(t){if(this.inst.extra.shadowcasterHeight!==t)this.inst.extra.shadowcasterHeight=t,this.runtime.redraw=!0},n.prototype.SetTag=function(t){if(this.inst.extra.shadowcasterTag!==t)this.inst.extra.shadowcasterTag=t,this.runtime.redraw=!0},t.acts=new n,r.prototype.Height=function(t){t.set_float(this.inst.extra.shadowcasterHeight)},r.prototype.Tag=function(t){t.set_string(this.inst.extra.shadowcasterTag)},t.exps=new r}(),assert2(drama,"drama namespace not created"),assert2(drama.behaviors,"drama.behaviors not created"),drama.behaviors.Sin=function(t){this.runtime=t},function(){var t=drama.behaviors.Sin.prototype;t.Type=function(t,e){this.behavior=t,this.objtype=e,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t,e){this.type=t,this.behavior=t.behavior,this.inst=e,this.runtime=t.runtime,this.i=0};var e=t.Instance.prototype,d=2*Math.PI,i=Math.PI/2,n=3*Math.PI/2,p=[0,1,8,3,4,2,5,6,7];function r(){}function o(){}function s(){}e.onCreate=function(){if(this.movement=p[this.properties[0]],this.wave=this.properties[1],this.period=this.properties[2],this.period+=Math.random()*this.properties[3],0===this.period)this.i=0;else this.i=this.properties[4]/this.period*d,this.i+=Math.random()*this.properties[5]/this.period*d;this.setMag(this.properties[6]+Math.random()*this.properties[7]),this.active=this.properties[8],this.initialValue=0,this.initialValue2=0,this.ratio=0,this.init()},e.saveToJSON=function(){return{i:this.i,a:this.active,mv:this.movement,w:this.wave,p:this.period,mag:this.mag,iv:this.initialValue,iv2:this.initialValue2,r:this.ratio,lkv:this.lastKnownValue,lkv2:this.lastKnownValue2}},e.loadFromJSON=function(t){this.i=t.i,this.active=t.a,this.movement=t.mv,this.wave=t.w,this.period=t.p,this.mag=t.mag,this.initialValue=t.iv,this.initialValue2=t.iv2||0,this.ratio=t.r,this.lastKnownValue=t.lkv,this.lastKnownValue2=t.lkv2||0},e.init=function(){switch(this.movement){case 0:this.initialValue=this.inst.x;break;case 1:this.initialValue=this.inst.y;break;case 2:this.initialValue=this.inst.width,this.ratio=this.inst.height/this.inst.width;break;case 3:this.initialValue=this.inst.width;break;case 4:this.initialValue=this.inst.height;break;case 5:this.initialValue=this.inst.angle;break;case 6:this.initialValue=this.inst.opacity;break;case 7:this.initialValue=0;break;case 8:this.initialValue=this.inst.x,this.initialValue2=this.inst.y;break;default:assert2(!1,"Invalid sin movement type")}this.lastKnownValue=this.initialValue,this.lastKnownValue2=this.initialValue2},e.waveFunc=function(t){switch(t%=d,this.wave){case 0:return Math.sin(t);case 1:if(t<=i)return t/i;else if(t<=n)return 1-2*(t-i)/Math.PI;else return(t-n)/i-1;case 2:return 2*t/d-1;case 3:return-2*t/d+1;case 4:return t<Math.PI?-1:1}return 0},e.tick=function(){var t=this.runtime.getDt(this.inst);if(this.active&&0!==t){if(0===this.period)this.i=0;else this.i+=t/this.period*d,this.i=this.i%d;this.updateFromPhase()}},e.updateFromPhase=function(){switch(this.movement){case 0:if(this.inst.x!==this.lastKnownValue)this.initialValue+=this.inst.x-this.lastKnownValue;this.inst.x=this.initialValue+this.waveFunc(this.i)*this.mag,this.lastKnownValue=this.inst.x;break;case 1:if(this.inst.y!==this.lastKnownValue)this.initialValue+=this.inst.y-this.lastKnownValue;this.inst.y=this.initialValue+this.waveFunc(this.i)*this.mag,this.lastKnownValue=this.inst.y;break;case 2:this.inst.width=this.initialValue+this.waveFunc(this.i)*this.mag,this.inst.height=this.inst.width*this.ratio;break;case 3:this.inst.width=this.initialValue+this.waveFunc(this.i)*this.mag;break;case 4:this.inst.height=this.initialValue+this.waveFunc(this.i)*this.mag;break;case 5:if(this.inst.angle!==this.lastKnownValue)this.initialValue=drama.clamp_angle(this.initialValue+(this.inst.angle-this.lastKnownValue));this.inst.angle=drama.clamp_angle(this.initialValue+this.waveFunc(this.i)*this.mag),this.lastKnownValue=this.inst.angle;break;case 6:if(this.inst.opacity=this.initialValue+this.waveFunc(this.i)*this.mag/100,this.inst.opacity<0)this.inst.opacity=0;else if(1<this.inst.opacity)this.inst.opacity=1;break;case 8:if(this.inst.x!==this.lastKnownValue)this.initialValue+=this.inst.x-this.lastKnownValue;if(this.inst.y!==this.lastKnownValue2)this.initialValue2+=this.inst.y-this.lastKnownValue2;this.inst.x=this.initialValue+Math.cos(this.inst.angle)*this.waveFunc(this.i)*this.mag,this.inst.y=this.initialValue2+Math.sin(this.inst.angle)*this.waveFunc(this.i)*this.mag,this.lastKnownValue=this.inst.x,this.lastKnownValue2=this.inst.y}this.inst.set_bbox_changed()},e.onSpriteFrameChanged=function(t,e){switch(this.movement){case 2:this.initialValue*=e.width/t.width,this.ratio=e.height/e.width;break;case 3:this.initialValue*=e.width/t.width;break;case 4:this.initialValue*=e.height/t.height}},e.setMag=function(t){if(this.mag=t,5===this.movement)this.mag=drama.to_radians(this.mag)},e.getRealMag=function(){if(5===this.movement)return drama.to_degrees(this.mag);else return this.mag},e.getDebuggerValues=function(t){t.push({title:this.type.name,properties:[{name:"Active",value:this.active},{name:"Period",value:this.period},{name:"Magnitude",value:this.mag},{name:"Value",value:this.waveFunc(this.i)*this.mag,readonly:!0}]})},e.onDebugValueEdited=function(t,e,i){switch(e){case"Active":this.active=i;break;case"Period":this.period=i;break;case"Magnitude":this.mag=i}},r.prototype.IsActive=function(){return this.active},r.prototype.compareSinParam=function(t,e,i,n,r,o,s){return("none"==t||this.movement===t)&&(6==e||drama.do_cmp(this.period,e,i))&&(6==n||drama.do_cmp(this.getRealMag(),n,r))&&(6==o||this.wave===s)},r.prototype.CompareMovement=function(t){return this.movement===t},r.prototype.ComparePeriod=function(t,e){return drama.do_cmp(this.period,t,e)},r.prototype.CompareMagnitude=function(t,e){return drama.do_cmp(this.getRealMag(),t,e)},r.prototype.CompareWave=function(t){return this.wave===t},t.cnds=new r,o.prototype.SetActive=function(t){this.active=1===t},o.prototype.SetSinParam=function(t,e,i,n,r,o){var s=!0,a=!0,l=!0,c=!0,u=!0;if(o)s="true"===(o=o.split("|"))[0],a="true"===o[1],l="true"===o[2],c="true"===o[3],u="true"===o[4];if(s)this.period=t;var h=this.getRealMag();if(a)h=e;if(l)this.movement=p[i];if(c)this.wave=n;if(u)this.i=r*d%d;this.setMag(h),this.init(),this.updateFromPhase()},o.prototype.SetPeriod=function(t){this.period=t},o.prototype.SetMagnitude=function(t){this.setMag(t)},o.prototype.SetMovement=function(t){var e=this.getRealMag();this.movement=p[t],this.setMag(e),this.init()},o.prototype.SetWave=function(t){this.wave=t},o.prototype.SetPhase=function(t){this.i=t*d%d,this.updateFromPhase()},o.prototype.UpdateInitialState=function(){this.init()},t.acts=new o,s.prototype.CyclePosition=function(t){t.set_float(this.i/d)},s.prototype.Period=function(t){t.set_float(this.period)},s.prototype.Magnitude=function(t){t.set_float(this.getRealMag())},s.prototype.Value=function(t){t.set_float(this.waveFunc(this.i)*this.mag)},t.exps=new s}(),assert2(drama,"drama namespace not created"),assert2(drama.behaviors,"drama.behaviors not created"),drama.behaviors.solid=function(t){this.runtime=t},function(){var t=drama.behaviors.solid.prototype;t.Type=function(t,e){this.behavior=t,this.objtype=e,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t,e){this.type=t,this.behavior=t.behavior,this.inst=e,this.runtime=t.runtime};var e=t.Instance.prototype;function i(){}function n(){}e.onCreate=function(){this.inst.extra.solidEnabled=this.properties[0]},e.tick=function(){},e.getDebuggerValues=function(t){t.push({title:this.type.name,properties:[{name:"Enabled",value:this.inst.extra.solidEnabled}]})},e.onDebugValueEdited=function(t,e,i){if("Enabled"===e)this.inst.extra.solidEnabled=i},i.prototype.IsEnabled=function(){return this.inst.extra.solidEnabled},t.cnds=new i,n.prototype.SetEnabled=function(t){this.inst.extra.solidEnabled=!!t},t.acts=new n}(),assert2(drama,"drama namespace not created"),assert2(drama.behaviors,"drama.behaviors not created"),drama.behaviors.TileMove=function(t){this.runtime=t},function(){var t=drama.behaviors.TileMove.prototype;t.Type=function(t,e){this.behavior=t,this.objtype=e,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t,e){this.type=t,this.behavior=t.behavior,this.inst=e,this.runtime=t.runtime,this._upKey=!1,this._downKey=!1,this._leftKey=!1,this._rightKey=!1,this._ignoreInput=!1,this._simUp=!1,this._simDown=!1,this._simLeft=!1,this._simRight=!1,this._targetX=0,this._targetY=0,this._targetGridX=0,this._targetGridY=0,this._collisionRect=new drama.rect(0,0,0,0)};var e=t.Instance.prototype;function i(){}function n(){}function r(){}e.onCreate=function(){if(this._gridWidth=this.properties[3],this._gridHeight=this.properties[4],this._gridOffsetX=this.properties[5],this._gridOffsetY=this.properties[6],this._speedX=this.properties[7],this._speedY=this.properties[8],this._isEnabled=this.properties[0],this._defaultControl=this.properties[1],this._iso=!1,0==this._defaultControl||1==this._defaultControl)this._BindEvents();this._ResetTarget(),this.isFirstMoveX=!0,this.isMove=!1},e.onDestroy=function(){this._UnBindEvents()},e._BindEvents=function(){var e=this;this.keyDownHandle=function(t){e._OnKeyDown(t)},document.addEventListener("keydown",this.keyDownHandle),this.keyUpHandle=function(t){e._OnKeyUp(t)},document.addEventListener("keyup",this.keyUpHandle),this.blurHandle=function(t){e._OnWindowBlur(t)},document.addEventListener("blur",this.blurHandle)},e._UnBindEvents=function(){document.removeEventListener("keydown",this.keyDownHandle),document.removeEventListener("keyup",this.keyUpHandle),document.removeEventListener("blur",this.blurHandle)},e._GridX=function(t,e){if(this._iso)return this._IsoGridX(t,e);else return t-=this._gridOffsetX,t/=this._gridWidth,Math.round(t)},e._GridY=function(t,e){if(this._iso)return this._IsoGridY(t,e);else return e-=this._gridOffsetY,e/=this._gridHeight,Math.round(e)},e._IsoGridX=function(t,e){t-=this._gridOffsetX,e-=this._gridOffsetY;var i=((t/=this._gridWidth/2)+(e/=this._gridHeight/2))/2;return Math.round(i)},e._IsoGridY=function(t,e){t-=this._gridOffsetX,e-=this._gridOffsetY,t/=this._gridWidth/2;var i=((e/=this._gridHeight/2)-t)/2;return Math.round(i)},e._GridPosition=function(t,e){var i=Math.round;if(this._iso)return this._IsoGridPosition(t,e);else{t-=this._gridOffsetX,e-=this._gridOffsetY;var n=t/this._gridWidth,r=e/this._gridHeight;return[i(n),i(r)]}},e._WorldPosition=function(t,e){if(this._iso)return this._IsoWorldPosition(t,e);else{var i=t*this._gridWidth,n=e*this._gridHeight;return[i+=this._gridOffsetX,n+=this._gridOffsetY]}},e._IsoGridPosition=function(t,e){var i=Math.round;t-=this._gridOffsetX,e-=this._gridOffsetY,t/=this._gridWidth/2;var n=((e/=this._gridHeight/2)-t)/2;return[i((t+e)/2),i(n)]},e._IsoWorldPosition=function(t,e){var i=t-e,n=t+e;return i*=this._gridWidth/2,n*=this._gridHeight/2,[i+=this._gridOffsetX,n+=this._gridOffsetY]},e._UpdateTarget=function(t,e){var i=this.inst.x,n=this.inst.y,r=this._WorldPosition(t,e);this.inst.x=r[0],this.inst.y=r[1],this.inst.set_bbox_changed();var o=this._TestCollision();if(this.inst.x=i,this.inst.y=n,this.inst.set_bbox_changed(),!o)this._targetGridX=t,this._targetGridY=e,this._targetX=r[0],this._targetY=r[1],this.isLocked=!1;else if(!this.isActionUpdateTarget)this.runtime.trigger(drama.behaviors.TileMove.prototype.cnds.Locked,this.inst);return!!o},e._MoveToTarget=function(){this.inst.x=this._targetX,this.inst.y=this._targetY,this.inst.set_bbox_changed()},e._TargetCurrentPosition=function(){if(0!=this._gridWidth&&0!=this._gridHeight){var t=this._GridPosition(this.inst.x,this.inst.y),e=this._WorldPosition(t[0],t[1]);this._targetGridX=t[0],this._targetGridY=t[1],this._targetX=e[0],this._targetY=e[1]}},e._ResetTarget=function(){this._TargetCurrentPosition(),this._MoveToTarget()},e._TestCollision=function(){return this.runtime.testOverlapSolid(this.inst)},e._MaybePushOut=function(){var t=this._gridWidth/2,e=this._gridHeight/2,i=this._TestCollision();if(!i)return null;this.isMove=!1;var n=this.inst.x,r=this.inst.y;if(this.isMoveX)if(this.originInstX<n)this.inst.x+=-t;else this.inst.x+=t;else if(this.originInstY<r)this.inst.y+=-e;else this.inst.y+=e;if(this.inst.set_bbox_changed(),this._TestCollision())this.inst.x=n,this.inst.y=r,this.inst.set_bbox_changed();if(this.runtime.trigger(drama.behaviors.TileMove.prototype.cnds.Locked,this.inst),i)if(this.runtime.registerCollision(this.inst,i),!this.runtime.pushOutSolidNearest(this.inst))return;return this._TargetCurrentPosition(),i},e._SetEnabled=function(t){if(this._isEnabled=!t,!this._isEnabled)this._simLeft=!1,this._simRight=!1,this._simUp=!1,this._simDown=!1},e._OnKeyDown=function(t){if(0==this._defaultControl)switch(t.key){case"ArrowLeft":this._leftKey=!0;break;case"ArrowUp":this._upKey=!0;break;case"ArrowRight":this._rightKey=!0;break;case"ArrowDown":this._downKey=!0}else if(1==this._defaultControl)switch(t.which){case 65:this._leftKey=!0;break;case 87:this._upKey=!0;break;case 68:this._rightKey=!0;break;case 83:this._downKey=!0}},e._OnKeyUp=function(t){if(0==this._defaultControl)switch(t.key){case"ArrowLeft":this._leftKey=!1;break;case"ArrowUp":this._upKey=!1;break;case"ArrowRight":this._rightKey=!1;break;case"ArrowDown":this._downKey=!1}else if(1==this._defaultControl)switch(t.which){case 65:this._leftKey=!1;break;case 87:this._upKey=!1;break;case 68:this._rightKey=!1;break;case 83:this._downKey=!1}},e._OnWindowBlur=function(){this._upKey=!1,this._downKey=!1,this._leftKey=!1,this._rightKey=!1},e.saveToJSON=function(){return{gw:this._gridWidth,gh:this._gridHeight,ox:this._gridOffsetX,oy:this._gridOffsetY,sx:this._speedX,sy:this._speedY,x:this._targetX,y:this._targetY,gx:this._targetGridX,gy:this._targetGridY,e:this._isEnabled,i:this._ignoreInput,c:this._defaultControl}},e.loadFromJSON=function(t){if(this._gridWidth=t.gw,this._gridHeight=t.gh,this._gridOffsetX=t.ox,this._gridOffsetY=t.oy,this._speedX=t.sx,this._speedY=t.sy,this._targetX=t.x,this._targetY=t.y,this._targetGridX=t.gx,this._targetGridY=t.gy,this._isEnabled=!!t.e,this._ignoreInput=!!t.i,this._defaultControl=t.c,this._isEnabled)this._simUp=!1,this._simDown=!1,this._simLeft=!1,this._simRight=!1;if(0==this._defaultControl||1==this._defaultControl)this._BindEvents();else this._UnBindEvents()},e.tick=function(){var t=Math.sign,e=Math.abs,i=this.runtime.getDt(this.inst),n=this._leftKey||this._simLeft,r=this._rightKey||this._simRight,o=this._upKey||this._simUp,s=this._downKey||this._simDown;if(this._ignoreInput)n=r=o=s=!1;if(o||s)n=r=!1;if(0!=this._speedX&&0!=this._speedY)if(0!=this._gridWidth&&0!=this._gridHeight)if(this._simLeft=!1,this._simRight=!1,this._simUp=!1,this._simDown=!1,this._isEnabled)if(!this._MaybePushOut()){var a=this.inst.x,l=this.inst.y;this.originInstX=a,this.originInstY=l;var c=i*this._speedX,u=i*this._speedY,h=this._targetGridX,d=this._targetGridY,p=this._targetX-a,f=this._targetY-l,m=e(p),g=e(f),y=0,v=0;if(0<m){var b=t(p),_=b<0&&n&&!r,w=0<b&&r&&!n;if(_||w)if(!(!(m<c)||w&&this._UpdateTarget(++h,d)||_&&this._UpdateTarget(--h,d)))m=e(p=this._targetX-a);y=b*drama.clamp(m,0,c)}if(0<g){var x=t(f),S=0<x&&s&&!o,I=x<0&&o&&!s;if(S||I)if(!(!(g<u)||S&&this._UpdateTarget(h,++d)||I&&this._UpdateTarget(h,--d)))g=e(f=this._targetY-l);v=x*drama.clamp(g,0,u)}if(0!=y||0!=v){if(this.isFirstMoveX&&0!=y)this.inst.x+=y,this.isMoveX=!0,this.isMoveY=!1;else if(this.isFirstMoveX&&0==y)this.inst.y+=v,this.isMoveY=!0,this.isMoveX=!1;if(!this.isFirstMoveX&&0!=v)this.inst.y+=v;else if(!this.isFirstMoveX&&0==v)this.inst.x+=y;this.inst.set_bbox_changed()}else{if(n&&!r)this._UpdateTarget(h-1,d);else if(r&&!n)this._UpdateTarget(h+1,d);else if(o&&!s)this._UpdateTarget(h,d-1);else if(s&&!o)this._UpdateTarget(h,d+1);if(!(n||r||o||s)&&this.isMove)this.runtime.trigger(drama.behaviors.TileMove.prototype.cnds.Complete,this.inst),this.isMove=!1}}},e.getDebuggerValues=function(t){t.push({title:this.type.name,properties:[]})},e.onDebugValueEdited=function(t,e,i){},i.prototype.IsEnabled=function(){return this._isEnabled},i.prototype.IsMoving=function(){var t=Math.abs,e=this.inst,i=t(this._targetX-e.x),n=t(this._targetY-e.y);if(this._isEnabled&&(0<i&&0!==this._speedX||0<n&&0!=this._speedY)&&!this._TestCollision())return!0},i.prototype.Locked=function(){if(!this.isLocked)return this.isLocked=!0;else this.isLocked=!1},i.prototype.Complete=function(){var t=Math.abs,e=this.inst,i=t(this._targetX-e.x),n=t(this._targetY-e.y);if(0==i&&0!==this._speedX||0<n&&0!=this._speedY)return!0},i.prototype.CanMoveTo=function(t,e){var i=this.inst.x,n=this.inst.y,r=this._WorldPosition(t,e);this.inst.x=r[0],this.inst.y=r[1],this.inst.set_bbox_changed();var o=this._TestCollision();return this.inst.x=i,this.inst.y=n,this.inst.set_bbox_changed(),!o},t.cnds=new i,n.prototype.SetEnabled=function(t){this._SetEnabled(t)},n.prototype.SetGridDimensions=function(t,e,i,n){this._gridWidth=t,this._gridHeight=e,this._gridOffsetX=i,this._gridOffsetY=n,this._TargetCurrentPosition()},n.prototype.SetGridPosition=function(t,e,i){if(this._isEnabled){this.isFirstMoveX=!0,this.isActionUpdateTarget=!0;var n=!this._UpdateTarget(t,e);if(this.isActionUpdateTarget=!1,n)this.isMove=!0;if(n&&1==i)this._MoveToTarget(),this.runtime.trigger(drama.behaviors.TileMove.prototype.cnds.Complete,this.inst),this.isMove=!1}},n.prototype.SetIgnoreInput=function(t){this._ignoreInput=!t},n.prototype.setSpeed=function(t,e){this._speedX=t,this._speedY=e},n.prototype.SimulateControl=function(t){if(this._isEnabled)if(0===t)this._simLeft=!0;else if(1===t)this._simRight=!0;else if(2===t)this._simUp=!0;else if(3===t)this._simDown=!0},t.acts=new n,r.prototype.GridX=function(t){t.set_float(this._GridX(this.inst.x,this.inst.y))},r.prototype.GridY=function(t){t.set_float(this._GridY(this.inst.x,this.inst.y))},r.prototype.SpeedX=function(t){t.set_float(this._speedX)},r.prototype.SpeedY=function(t){t.set_float(this._speedY)},r.prototype.TargetX=function(t){t.set_float(this._targetX)},r.prototype.TargetY=function(t){t.set_float(this._targetY)},r.prototype.GridTargetX=function(t){t.set_float(this._targetGridX)},r.prototype.GridTargetY=function(t){t.set_float(this._targetGridY)},t.exps=new r}(),assert2(drama,"drama namespace not created"),assert2(drama.behaviors,"drama.behaviors not created"),drama.behaviors.Timer=function(t){this.runtime=t},function(){var t=drama.behaviors.Timer.prototype;t.Type=function(t,e){this.behavior=t,this.objtype=e,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t,e){this.type=t,this.behavior=t.behavior,this.inst=e,this.runtime=t.runtime};var e=t.Instance.prototype;function i(){}function n(){}function r(){}e.onCreate=function(){this.timers={}},e.onDestroy=function(){drama.wipe(this.timers)},e.saveToJSON=function(){var t,e,i={};for(t in this.timers)if(this.timers.hasOwnProperty(t))e=this.timers[t],i[t]={c:e.current.sum,t:e.total.sum,d:e.duration,r:e.regular,s:e.status};return i},e.loadFromJSON=function(t){var e;for(e in this.timers={},t)if(t.hasOwnProperty(e))this.timers[e]={current:new drama.KahanAdder,total:new drama.KahanAdder,duration:t[e].d,regular:t[e].r,status:t[e].s},this.timers[e].current.sum=t[e].c,this.timers[e].total.sum=t[e].t},e.tick=function(){var t,e,i=this.runtime.getDt(this.inst);for(t in this.timers)if(this.timers.hasOwnProperty(t))if(1==(e=this.timers[t]).status)e.current.add(i),e.total.add(i)},e.tick2=function(){var t,e;for(t in this.timers)if(this.timers.hasOwnProperty(t))if((e=this.timers[t]).current.sum>=e.duration&&1==e.status)if(e.regular)e.current.sum-=e.duration;else delete this.timers[t]},e.getDebuggerValues=function(t){var e,i,n=[];for(e in this.timers)if(this.timers.hasOwnProperty(e))i=this.timers[e],n.push({name:e,value:Math.round(100*i.current.sum)/100+" s / "+Math.round(100*i.duration)/100+" s",readonly:!0});if(n.length)t.push({title:this.type.name,properties:n})},i.prototype.OnTimer=function(t){t=t.toLowerCase();var e=this.timers[t];if(!e)return!1;else return e.current.sum>=e.duration},i.prototype.IsTimerRunning=function(t){return this.timers.hasOwnProperty(t.toLowerCase())},i.prototype.IsTimerPause=function(t){var e=!1;if(this.timers.hasOwnProperty(t.toLowerCase()))if(0==this.timers[t].status)e=!0;return e},t.cnds=new i,n.prototype.StartTimer=function(t,e,i){this.timers[i.toLowerCase()]={current:new drama.KahanAdder,total:new drama.KahanAdder,duration:t,status:1,regular:1===e}},n.prototype.StopTimer=function(t){if(t=t.toLowerCase(),this.timers.hasOwnProperty(t))delete this.timers[t]},n.prototype.PauseTimer=function(t){if(t=t.toLowerCase(),this.timers.hasOwnProperty(t))this.timers[t].status=0},n.prototype.continueTimer=function(t){if(t=t.toLowerCase(),this.timers.hasOwnProperty(t))this.timers[t].status=1},t.acts=new n,r.prototype.CurrentTime=function(t,e){var i=this.timers[e.toLowerCase()];t.set_float(i?i.current.sum:0)},r.prototype.TotalTime=function(t,e){var i=this.timers[e.toLowerCase()];t.set_float(i?i.total.sum:0)},r.prototype.Duration=function(t,e){var i=this.timers[e.toLowerCase()];t.set_float(i?i.duration:0)},t.exps=new r}(),assert2(drama,"drama namespace not created"),assert2(drama.behaviors,"drama.behaviors not created"),drama.behaviors.Turret=function(t){this.runtime=t},function(){var t=drama.behaviors.Turret.prototype;t.Type=function(t,e){this.behavior=t,this.objtype=e,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){this.targetTypes=[]},t.Instance=function(t,e){this.type=t,this.behavior=t.behavior,this.inst=e,this.runtime=t.runtime};var e=t.Instance.prototype;e.onCreate=function(){this.range=this.properties[0],this.rateOfFire=this.properties[1],this.rotateEnabled=this.properties[2],this.rotateSpeed=drama.to_radians(this.properties[3]),this.targetMode=this.properties[4],this.predictiveAim=this.properties[5],this.projectileSpeed=this.properties[6],this.useCollisionCells=this.properties[7],this.enabled=this.properties[8],this.lastCheckTime=0,this.fireTimeCount=this.rateOfFire,this.currentTarget=null,this.loadTargetUid=-1,this.oldTargetX=0,this.oldTargetY=0,this.lastSpeeds=[0,0,0,0],this.speedsCount=0,this.firstTickWithTarget=!0;var e=this;if(!this.recycled)this.myDestroyCallback=function(t){e.onInstanceDestroyed(t)};this.runtime.addDestroyCallback(this.myDestroyCallback)},e.saveToJSON=function(){var t,e,i={r:this.range,rof:this.rateOfFire,re:this.rotateEnabled,rs:this.rotateSpeed,tm:this.targetMode,pa:this.predictiveAim,ps:this.projectileSpeed,en:this.enabled,lct:this.lastCheckTime,ftc:this.fireTimeCount,target:this.currentTarget?this.currentTarget.uid:-1,ox:this.oldTargetX,oy:this.oldTargetY,ls:this.lastSpeeds,sc:this.speedsCount,targs:[]};for(t=0,e=this.type.targetTypes.length;t<e;t++)i.targs.push(this.type.targetTypes[t].sid);return i},e.loadFromJSON=function(t){var e,i,n;for(this.range=t.r,this.rateOfFire=t.rof,this.rotateEnabled=t.re,this.rotateSpeed=t.rs,this.targetMode=t.tm,this.predictiveAim=t.pa,this.projectileSpeed=t.ps,this.enabled=t.en,this.lastCheckTime=t.lct,this.fireTimeCount=t.ftc||0,this.loadTargetUid=t.target,this.oldTargetX=t.ox,this.oldTargetY=t.oy,this.lastSpeeds=t.ls,this.speedsCount=t.sc,drama.clearArray(this.type.targetTypes),e=0,i=t.targs.length;e<i;e++)if(n=this.runtime.getObjectTypeBySid(t.targs[e]))this.type.targetTypes.push(n)},e.afterLoad=function(){if(-1===this.loadTargetUid)this.currentTarget=null;else this.currentTarget=this.runtime.getObjectByUID(this.loadTargetUid)},e.onInstanceDestroyed=function(t){if(this.currentTarget==t)this.currentTarget=null},e.onDestroy=function(){this.currentTarget=null,this.runtime.removeDestroyCallback(this.myDestroyCallback)},e.addSpeed=function(t){if(this.speedsCount<4)this.lastSpeeds[this.speedsCount]=t,this.speedsCount++;else this.lastSpeeds.shift(),this.lastSpeeds.push(t)},e.getSpeed=function(){for(var t=0,e=0;e<this.speedsCount;e++)t+=this.lastSpeeds[e];return t/this.speedsCount},e.isInRange=function(t){var e=this.inst,i=t.x-e.x,n=t.y-e.y;return i*i+n*n<=this.range*this.range};var c=new drama.rect(0,0,0,0),u=[];function i(){}function n(){}function r(){}e.lookForFirstTarget=function(){var t,e,i;if(c.left=this.inst.x-this.range,c.top=this.inst.y-this.range,c.right=this.inst.x+this.range,c.bottom=this.inst.y+this.range,this.useCollisionCells)this.runtime.getTypesCollisionCandidates(null,this.type.targetTypes,c,u);else for(t=0,e=this.type.targetTypes.length;t<e;++t)drama.appendArray(u,this.type.targetTypes[t].instances);for(t=0,e=u.length;t<e;++t)if(i=u[t],this.isInRange(i))return this.currentTarget=i,void drama.clearArray(u);drama.clearArray(u)},e.lookForNearestTarget=function(){var t,e,i,n,r,o,s=this.inst.x,a=this.inst.y,l=this.range*this.range;if(this.currentTarget=null,c.left=s-this.range,c.top=a-this.range,c.right=s+this.range,c.bottom=a+this.range,this.useCollisionCells)this.runtime.getTypesCollisionCandidates(null,this.type.targetTypes,c,u);else for(t=0,e=this.type.targetTypes.length;t<e;++t)drama.appendArray(u,this.type.targetTypes[t].instances);for(t=0,e=u.length;t<e;++t)if((n=(r=s-(i=u[t]).x)*r+(o=a-i.y)*o)<l)this.currentTarget=i,l=n;u.length=0},e.tick=function(){var t=this.runtime.getDt(this.inst),e=this.runtime.kahanTime.sum,i=this.inst;if(this.enabled){if(this.currentTarget&&!this.isInRange(this.currentTarget))this.currentTarget=null,this.speedsCount=0,this.firstTickWithTarget=!0;if(e>=this.lastCheckTime+.1)if(this.lastCheckTime=e,0===this.targetMode&&!this.currentTarget){if(this.lookForFirstTarget(),this.currentTarget)this.speedsCount=0,this.firstTickWithTarget=!0,this.oldTargetX=this.currentTarget.x,this.oldTargetY=this.currentTarget.y,this.runtime.trigger(drama.behaviors.Turret.prototype.cnds.OnTargetAcquired,this.inst)}else if(1===this.targetMode){var n=this.currentTarget;if(this.lookForNearestTarget(),this.currentTarget&&this.currentTarget!==n)this.speedsCount=0,this.firstTickWithTarget=!0,this.oldTargetX=this.currentTarget.x,this.oldTargetY=this.currentTarget.y,this.runtime.trigger(drama.behaviors.Turret.prototype.cnds.OnTargetAcquired,this.inst)}if(this.fireTimeCount+=t,this.currentTarget){var r=drama.angleTo(i.x,i.y,this.currentTarget.x,this.currentTarget.y);if(this.predictiveAim){var o=i.x,s=i.y,a=this.currentTarget.x,l=this.currentTarget.y,c=drama.angleTo(a,l,this.oldTargetX,this.oldTargetY);if(!this.firstTickWithTarget)this.addSpeed(drama.distanceTo(a,l,this.oldTargetX,this.oldTargetY)/t);var u=this.getSpeed(),h=l-s,d=a-o,p=(u*Math.sin(c)*(o-a)-u*Math.cos(c)*(s-l))/this.projectileSpeed,f=Math.asin(p/Math.sqrt(h*h+d*d))-Math.atan2(h,-d)+Math.PI;if(!isNaN(f))r=f}if(this.rotateEnabled)i.angle=drama.angleRotate(i.angle,r,this.rotateSpeed*t),i.set_bbox_changed();if(this.fireTimeCount>=this.rateOfFire&&(!this.rotateEnabled||drama.to_degrees(drama.angleDiff(i.angle,r))<=.1)&&(!this.predictiveAim||4<=this.speedsCount)){if(this.fireTimeCount-=this.rateOfFire,this.fireTimeCount>=this.rateOfFire)this.fireTimeCount=0;this.runtime.trigger(drama.behaviors.Turret.prototype.cnds.OnShoot,this.inst)}if(this.currentTarget)this.oldTargetX=this.currentTarget.x,this.oldTargetY=this.currentTarget.y;this.firstTickWithTarget=!1}if(this.fireTimeCount>this.rateOfFire)this.fireTimeCount=this.rateOfFire}},e.getDebuggerValues=function(t){t.push({title:this.type.name,properties:[{name:"Range",value:this.range},{name:"Rate of fire",value:this.rateOfFire},{name:"Rotate speed",value:drama.to_degrees(this.rotateSpeed)},{name:"Predictive aiming",value:this.predictiveAim},{name:"Projectile speed",value:this.projectileSpeed},{name:"Has target",value:!!this.currentTarget,readonly:!0},{name:"Target UID",value:this.currentTarget?this.currentTarget.uid:0,readonly:!0},{name:"Enabled",value:this.enabled}]})},e.onDebugValueEdited=function(t,e,i){switch(e){case"Range":this.range=i;break;case"Rate of fire":this.rateOfFire=i;break;case"Rotate speed":this.rotateSpeed=drama.to_radians(i);break;case"Predictive aiming":this.predictiveAim=i;break;case"Projectile speed":this.projectileSpeed=i;break;case"Enabled":this.enabled=i}},i.prototype.HasTarget=function(){return!!this.currentTarget},i.prototype.OnShoot=function(){return!0},i.prototype.OnTargetAcquired=function(){return!0},t.cnds=new i,n.prototype.ControlTarget=function(t,e,i){if("false"!==i)if(e)if(1!=t){var n,r,o,s=e.getCurrentSol().getObjects();for(n=0,r=s.length;n<r;++n)if(o=s[n],this.currentTarget!==o&&this.isInRange(o)){this.currentTarget=o,this.speedsCount=0,this.firstTickWithTarget=!0,this.oldTargetX=this.currentTarget.x,this.oldTargetY=this.currentTarget.y,this.runtime.trigger(drama.behaviors.Turret.prototype.cnds.OnTargetAcquired,this.inst);break}}else{var a,l,c,u=this.type.targetTypes;if(-1!==u.indexOf(e))return;for(a=0,l=u.length;a<l;a++)if((c=u[a]).is_family&&-1!==c.members.indexOf(e))return;u.push(e)}},n.prototype.AcquireTarget=function(t){if(t){var e,i,n,r=t.getCurrentSol().getObjects();for(e=0,i=r.length;e<i;++e)if(n=r[e],this.currentTarget!==n&&this.isInRange(n)){this.currentTarget=n,this.speedsCount=0,this.firstTickWithTarget=!0,this.oldTargetX=this.currentTarget.x,this.oldTargetY=this.currentTarget.y,this.runtime.trigger(drama.behaviors.Turret.prototype.cnds.OnTargetAcquired,this.inst);break}}},n.prototype.AddTarget=function(t){var e=this.type.targetTypes;if(-1===e.indexOf(t)){var i,n,r;for(i=0,n=e.length;i<n;i++)if((r=e[i]).is_family&&-1!==r.members.indexOf(t))return;e.push(t)}},n.prototype.ClearTargets=function(){drama.clearArray(this.type.targetTypes),this.currentTarget=null,this.speedsCount=0,this.firstTickWithTarget=!0},n.prototype.UnacquireTarget=function(){this.currentTarget=null,this.speedsCount=0,this.firstTickWithTarget=!0},n.prototype.SetEnabled=function(t){this.enabled=0!==t},n.prototype.SetTurretParam=function(t,e,i,n,r,o,s,a){var l=!0,c=!0,u=!0,h=!0,d=!0,p=!0,f=!0;if(a)l="true"===(a=a.split("|"))[0],c="true"===a[1],u="true"===a[2],h="true"===a[3],d="true"===a[4],p="true"===a[5],f="true"===a[6];if(l)this.range=t;if(c)this.rateOfFire=e;if(u)this.rotateEnabled=0!==i;if(h)this.rotateSpeed=drama.to_radians(n);if(d)this.targetMode=r;if(p)this.predictiveAim=0!==o;if(f)this.projectileSpeed=s},n.prototype.SetRange=function(t){this.range=t},n.prototype.SetRateOfFire=function(t){this.rateOfFire=t},n.prototype.SetRotate=function(t){this.rotateEnabled=0!==t},n.prototype.SetRotateSpeed=function(t){this.rotateSpeed=drama.to_radians(t)},n.prototype.SetTargetMode=function(t){this.targetMode=t},n.prototype.SetPredictiveAim=function(t){this.predictiveAim=0!==t},n.prototype.SetProjectileSpeed=function(t){this.projectileSpeed=t},t.acts=new n,r.prototype.TargetUID=function(t){t.set_int(this.currentTarget?this.currentTarget.uid:0)},r.prototype.Range=function(t){t.set_float(this.range)},r.prototype.RateOfFire=function(t){t.set_float(this.rateOfFire)},r.prototype.RotateSpeed=function(t){t.set_float(drama.to_degrees(this.rotateSpeed))},t.exps=new r}(),assert2(drama,"drama namespace not created"),assert2(drama.behaviors,"drama.behaviors not created"),drama.behaviors.wrap=function(t){this.runtime=t},function(){var t=drama.behaviors.wrap.prototype;t.Type=function(t,e){this.behavior=t,this.objtype=e,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t,e){this.type=t,this.behavior=t.behavior,this.inst=e,this.runtime=t.runtime};var e=t.Instance.prototype;e.onCreate=function(){this.mode=this.properties[0]},e.tick=function(){var t=this.inst;t.update_bbox();var e=t.bbox,i=t.layer,n=i.layout,r=0,o=0,s=0,a=0;if(0===this.mode)o=n.width,a=n.height;else r=i.viewLeft,o=i.viewRight,s=i.viewTop,a=i.viewBottom;if(e.right<r)t.x=o-1+(t.x-e.left),t.set_bbox_changed();else if(e.left>o)t.x=r+1-(e.right-t.x),t.set_bbox_changed();else if(e.bottom<s)t.y=a-1+(t.y-e.top),t.set_bbox_changed();else if(e.top>a)t.y=s+1-(e.bottom-t.y),t.set_bbox_changed()}}(),assert2(drama,"drama namespace not created"),assert2(drama.behaviors,"drama.behaviors not created"),drama.behaviors.xfCopy=function(t){this.runtime=t},function(){var t=drama.behaviors.xfCopy.prototype;t.Type=function(t,e){this.behavior=t,this.objtype=e,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){this.runtime.canvas.setAttribute("class","xfCanvas")},t.Instance=function(t,e){this.type=t,this.behavior=t.behavior,this.inst=e,this.runtime=t.runtime};var e=t.Instance.prototype;function i(){}function n(){}function r(){}e.onCreate=function(){this.copyDom=document.createElement("button"),this.copyDom.setAttribute("class","xf_copy_dom_".concat(this.inst.uid)),this.copyDom.style.opacity=0,this.copyDom.innerText="按钮",document.body.appendChild(this.copyDom),this.lastLeft=0,this.lastTop=0,this.lastRight=0,this.lastBottom=0,this.lastWinWidth=0,this.lastWinHeight=0,this.element_hidden=!1,this.updatePosition(!0),this.runtime.tickMe(this)},e.onDestroy=function(){document.body.removeChild(this.copyDom),this.copyDom=null},e.saveToJSON=function(){},e.loadFromJSON=function(t){},e.tick=function(){this.updatePosition()},e.updatePosition=function(t){var e=this.inst,i=e.layer.layerToCanvas(e.x,e.y,!0),n=e.layer.layerToCanvas(e.x,e.y,!1),r=e.layer.layerToCanvas(e.x+e.width,e.y+e.height,!0),o=e.layer.layerToCanvas(e.x+e.width,e.y+e.height,!1),s=e.runtime.width/e.runtime.devicePixelRatio,a=e.runtime.height/e.runtime.devicePixelRatio;if(!(!e.visible||!e.layer.visible||r<=0||o<=0||s<=i||a<=n)){if(i<1)i=1;if(n<1)n=1;if(s<=r)r=s-1;if(a<=o)o=a-1;var l=window.innerWidth,c=window.innerHeight;if(t||this.lastLeft!==i||this.lastTop!==n||this.lastRight!==r||this.lastBottom!==o||this.lastWinWidth!==l||this.lastWinHeight!==c){if(this.lastLeft=i,this.lastTop=n,this.lastRight=r,this.lastBottom=o,this.lastWinWidth=l,this.lastWinHeight=c,this.element_hidden)this.copyDom.style.display="",this.element_hidden=!1;var u=Math.round(i)+e.runtime.canvas.offsetLeft,h=Math.round(n)+e.runtime.canvas.offsetTop;if(this.copyDom.style.position="absolute",this.copyDom.style.left=u-e.hotspotX*Math.round(r-i)+"px",this.copyDom.style.top=h-e.hotspotY*Math.round(o-n)+"px",this.copyDom.style.width=Math.round(r-i)+"px",this.copyDom.style.height=Math.round(o-n)+"px",e.autoFontSize)this.copyDom.style.fontSize=e.layer.getScale(!0)/e.runtime.devicePixelRatio-.2+"em"}else if(this.element_hidden)this.copyDom.style.display="",this.element_hidden=!1}else{if(!this.element_hidden)this.copyDom.style.display="none";this.element_hidden=!0}},i.prototype.OnCopySuccess=function(t){return!0},i.prototype.OnCopyFaild=function(t){return!0},t.cnds=new i,n.prototype.setCopyText=function(t){var e=this;if(this.copyText=t,this.clipboard)this.clipboard.destroy();this.clipboard=new ClipboardJS(".xf_copy_dom_".concat(this.inst.uid),{text:function(){return t}}),this.clipboard.on("success",function(t){e.runtime.trigger(drama.behaviors.xfCopy.prototype.cnds.OnCopySuccess,e.inst),t.clearSelection()}),this.clipboard.on("error",function(t){e.runtime.trigger(drama.behaviors.xfCopy.prototype.cnds.OnCopyFaild,e.inst)})},t.acts=new n,r.prototype.lastCopyText=function(t,e){t.set_string(this.copyText)},t.exps=new r}(),assert2(drama,"drama namespace not created"),assert2(drama.behaviors,"drama.behaviors not created"),drama.behaviors.xfTrade=function(t){this.runtime=t},function(){var s=drama.behaviors.xfTrade.prototype;s.Type=function(t,e){this.behavior=t,this.objtype=e,this.runtime=t.runtime},s.Type.prototype.onCreate=function(){},s.Instance=function(t,e){this.type=t,this.behavior=t.behavior,this.inst=e,this.runtime=t.runtime};var t=s.Instance.prototype;function E(t,e,i){var n=e-t.runtime.canvas.offsetLeft,r=i-t.runtime.canvas.offsetTop,o=drama.convertPageXY(n,r),s=t.layer,a=s.canvasToLayer(o.pageX,o.pageY,!0,!1),l=s.canvasToLayer(o.pageX,o.pageY,!1,!1);if(xf.Rect.create(t.x-t.width*t.hotspotX,t.y-t.height*t.hotspotY,t.width,t.height).contains(a,l))return!0;else return!1}function A(i){var n=this;if(this.runtime.isCordova)if(!s.Instance.buying)s.Instance.buying=!0,xf.webApi.createOrder({payType:xf.PayType.AliPay,amount:i.price,goodsId:i.goodsId,goodsName:i.goodsName,goodsDesc:i.goodsDesc||"",goodsNum:1}).then(function(t){console.log("游戏币下单结果："+JSON.stringify(t)),n.orderId=t.orderId;var e={buyNum:1,coinNum:xf.gameInfo.wallet||0,extension:"",money:i.price,centPrice:String(i.price),productId:i.goodsId,productName:i.goodsName||"",productDesc:i.goodsDesc||"",gameName:window.xfruntime.name||"",roleId:xf.gameInfo.characterId,roleLevel:0,roleName:xf.gameInfo.characterName,serverId:1,serverName:"evkworld",vip:"1",gameOrderID:t.orderId,payNotifyUrl:t.callbackUrl,ratio:1,currency:i.currencyType};if(xfConfig.tradeKeyMap&&xfConfig.tradeKeyMap[i.goodsId])e.productId=xfConfig.tradeKeyMap[i.goodsId];cordova.plugins.SeiyaSdk.pay(e)},function(t){if(s.Instance.buying=!1,console.log("订单创建失败"+JSON.stringify(t)),n.isShowFaildToast)xf.xfToast.instance.setContext("".concat(i.goodsName,"购买失败"));n.runtime.trigger(drama.behaviors.xfTrade.prototype.cnds.OnPurchaseFail,n.inst)});else console.log("有其它商品正在购买，请稍候再次尝试！");else if(this.isShowFaildToast)xf.xfToast.instance.setContext("当前环境不支持购买此物品")}function k(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,i=xf.gameInfo.wallet,n=t.price*e,r=this.runtime.tradeInfo.currency;if(i<n){if(this.isShowBalanceUnsufficientToast)xf.xfToast.instance.setContext("".concat(r.currencyName,"余额不足"));return this.runtime.trigger(drama.behaviors.xfTrade.prototype.cnds.OnBalanceUnsufficient,this.inst),void this.runtime.trigger(drama.behaviors.xfTrade.prototype.cnds.OnPurchaseFail,this.inst)}xf.gameInfo.characterBuyGood({goods_id:t.goodsId,buy_num:e}).then(function(e){var i=this;xf.serverApi.syncCharacterGoods().then(function(t){if(s.Instance.buying=!1,i.isShowSuccessToast)xf.xfToast.instance.setContext("".concat(e.goodsName,"购买成功"));xf.gameInfo.syncCharacterInfo().then(function(t){xf.gameInfo.recentlyUpdatedResource.isUpdated=!0,xf.gameInfo.recentlyUpdatedResource.goodsId=e.goodsId,i.runtime.trigger(drama.behaviors.xfTrade.prototype.cnds.OnPurchaseSucceed,i.inst)})})}.bind(this,t)).catch(function(t,e){if(s.Instance.buying=!1,console.error(e),this.isShowFaildToast)xf.xfToast.instance.setContext("".concat(t.goodsName,"购买失败"));this.runtime.trigger(drama.behaviors.xfTrade.prototype.cnds.OnPurchaseFail,this.inst)}.bind(this,t))}function e(e,i,n){var r=0;i=i||1,n=n||0,function t(){if(!(i<=r))e(++r,i).then(function(){setTimeout(function(){t()},n)}).catch(function(){})}()}function i(){}function n(){}function r(){}t.onCreate=function(){if(this.goodsType=this.properties[0],this.goodsID=this.properties[1],this.isShowSelectNum=this.properties[2],this.isShowBuyConfirm=this.properties[3],this.isShowBalanceUnsufficientToast=this.properties[4],this.isShowSuccessToast=this.properties[5],this.isShowFaildToast=this.properties[6],this.event=xf.XfEvent.create(this.runtime),this.clickCb=function(t){var e=!1;if(this.runtime.isMobile){var i=t.changedTouches,n=!0,r=!1,o=void 0;try{for(var s,a=i[Symbol.iterator]();!(n=(s=a.next()).done);n=!0){var l=s.value;if(E(this.inst,l.pageX,l.pageY)){e=!0;break}}}catch(t){r=!0,o=t}finally{try{if(!n&&null!=a.return)a.return()}finally{if(r)throw o}}}else if(E(this.inst,t.pageX,t.pageY))e=!0;if(e){var c=this.runtime.tradeInfo,u=c.currency,h=c.list.gameGoods,d=null,p=!0,f=!1,m=void 0;try{for(var g,y=h[Symbol.iterator]();!(p=(g=y.next()).done);p=!0){var v=g.value;if(v.dictValue===this.goodsType){d=v;break}}}catch(t){f=!0,m=t}finally{try{if(!p&&null!=y.return)y.return()}finally{if(f)throw m}}if(d){var b=d.list,_=null,w=!0,x=!1,S=void 0;try{for(var I,T=b[Symbol.iterator]();!(w=(I=T.next()).done);w=!0){var C=I.value;if(C.goodsId==this.goodsID){_=C;break}}}catch(t){x=!0,S=t}finally{try{if(!w&&null!=T.return)T.return()}finally{if(x)throw S}}if(_){var O=function(i){return{callback:function(t,e){if(t===xf.MessageBox.Action.CONFIRM)i(e)}}},P={1:{message:"".concat(window.trFunc("确认支付￥")).concat(_.price/100).concat(window.trFunc("购买")).concat(_.goodsName,"?"),callback:A.bind(this,_)},2:{message:"".concat(window.trFunc("确认使用")).concat(_.price/100).concat(u.currencyName).concat(window.trFunc("购买")).concat(_.goodsName,"?"),callback:k.bind(this,_)},3:{message:"".concat(window.trFunc("确认支付￥")).concat(_.price/100).concat(window.trFunc("购买")).concat(_.goodsName,"?"),callback:A.bind(this,_)}}[this.goodsType];if(this.isCoin=!1,"1"===this.goodsType)this.isCoin=!0;if(this.isShowSelectNum)xf.xfGoodsNumSelecter.instance.show(_,O(P.callback));else if(this.isShowBuyConfirm)xf.MessageBox.confirm(P.message,O(P.callback));else P.callback()}}}}.bind(this),this.runtime.isMobile)this.event.addEventListener("touchstart",this.clickCb,this.inst);else this.event.addEventListener("mousedown",this.clickCb,this.inst);var e=this;document.addEventListener("onPayOrderSuccess",function(t){if(console.log("==============onPayOrderSuccess"+t),e.orderId)e.startQueryOrder(e.orderId),e.orderId=null},!1),document.addEventListener("onPayOrderFail",function(t){if(console.log("==============onPayOrderFail"+t),e.orderId)e.orderId=null,s.Instance.buying=!1,e.runtime.trigger(drama.behaviors.xfTrade.prototype.cnds.OnPurchaseFail,e.inst)},!1)},t.startQueryOrder=function(t){var o=this;e(function(n,r){return new Promise(function(e,i){xf.webApi.queryOrder(t).then(function(t){if(2===t.orderStatus||3===t.orderStatus)s.Instance.buying=!1,o.processSuccessOrder(),i();else{if(n==r)console.log("订单支付超时！");e()}}).catch(function(t){console.error("订单查询失败: ",t),e()})})},15,1e3)},t.syncPurchasedResources=function(){var l=this;e(function(s,a){return new Promise(function(r,o){return xf.webApi.getPlayerPurchasedResources().then(function(t){var e=t.list;xf.gameInfo.purchasedResources=e,console.log("syncPurchasedResources: ",t);for(var i=!0,n=0;n<e.length;n++){if(e[n].goodsId==l.goodsID){i=!1,xf.gameInfo.recentlyUpdatedResource.isUpdated=!0,xf.gameInfo.recentlyUpdatedResource.goodsId=l.goodsID,xf.webApi.queryAccount().then(function(t){xf.gameInfo.isPaid=t.isPaid,xf.gameInfo.payCount=t.payCount,l.runtime.trigger(drama.behaviors.xfTrade.prototype.cnds.OnPurchaseSucceed,l.inst)});break}}if(i){if(s==a)console.error("非消耗型商品发货超时!"),l.runtime.trigger(drama.behaviors.xfTrade.prototype.cnds.OnPurchaseFail,l.inst);r()}else o()},o)})},10,1e3)},t.processSuccessOrder=function(){var e=this;if(!e.isCoin)e.syncPurchasedResources();else xf.webApi.queryAccount().then(function(t){xf.gameInfo.isPaid=t.isPaid,xf.gameInfo.payCount=t.payCount,xf.gameInfo.syncCharacterInfo().then(function(t){e.runtime.trigger(drama.behaviors.xfTrade.prototype.cnds.OnPurchaseSucceed,e.inst)})})},t.onDestroy=function(){if(this.runtime.isMobile)this.event.removeEventListener("touchend",this.inst);else this.event.removeEventListener("mouseup",this.inst)},t.tick=function(t){},t.getDebuggerValues=function(t){},i.prototype.OnBalanceUnsufficient=function(){return!0},i.prototype.OnPurchaseSucceed=function(){return!0},i.prototype.OnPurchaseFail=function(){return!0},s.cnds=new i,n.prototype.buyItem=function(t){if("number"==typeof t){var e=this.runtime.tradeInfo.list.gameGoods,i=null,n=!0,r=!1,o=void 0;try{for(var s,a=e[Symbol.iterator]();!(n=(s=a.next()).done);n=!0){var l=s.value;if(l.dictValue===this.goodsType){i=l;break}}}catch(t){r=!0,o=t}finally{try{if(!n&&null!=a.return)a.return()}finally{if(r)throw o}}if(i){var c=i.list,u=null,h=!0,d=!1,p=void 0;try{for(var f,m=c[Symbol.iterator]();!(h=(f=m.next()).done);h=!0){var g=f.value;if(g.goodsId==this.goodsID){u=g;break}}}catch(t){d=!0,p=t}finally{try{if(!h&&null!=m.return)m.return()}finally{if(d)throw p}}if(u)k.call(this,u,t);else console.warn("购买失败，未指定消耗型商品.")}else console.warn("购买失败，获取商品类型异常.")}else console.warn("购买失败，商品数量异常.")},s.acts=new n,r.prototype.getPayStatus=function(t){if(xf.gameInfo.isPaid)t.set_int(1);else t.set_int(0)},r.prototype.getPaytime=function(t){if(xf.gameInfo.payCount)t.set_int(xf.gameInfo.payCount);else t.set_int(0)},s.exps=new r}(),assert2(drama,"drama namespace not created"),function(){var d=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame||window.oRequestAnimationFrame,t=new Audio,J={"audio/webm; codecs=opus":!!t.canPlayType("audio/webm; codecs=opus"),"audio/ogg; codecs=opus":!!t.canPlayType("audio/ogg; codecs=opus"),"audio/webm; codecs=vorbis":!!t.canPlayType("audio/webm; codecs=vorbis"),"audio/ogg; codecs=vorbis":!!t.canPlayType("audio/ogg; codecs=vorbis"),"audio/mp4":!!t.canPlayType("audio/mp4"),"audio/mpeg":!!t.canPlayType("audio/mpeg")};function e(t){var e;if(this.isMinigame="minigame"===xfConfig.exportType,this.isWeixin="weChat"===xfConfig.channel,this.isByte="byteDance"===xfConfig.channel,this.isBilibili="bilibili"===xfConfig.channel,!this.isMinigame)e=t.canvas;else this.isFirstLayOut=!1,e=canvas;var i=t.projectDataUrl;if(!e&&!this.isMinigame){var n=document.getElementById("xf-root");if(!n)n=document.getElementById("fb-root");e=document.createElement("canvas"),n.appendChild(e)}if(e&&e.getContext)if(!this.isMinigame||canvas&&canvas.getContext){if(window.xfruntime=this,window.xfcanvas=e,this.exportType=t.exportType,this.isPreview="preview"===this.exportType,this.isRemotePreview=!!t.isRemotePreview,this.xfLoader=new xf.XfLoader,this.xfPreloadGroup=this.xfLoader.createGroup("xfPreloadGroup"),this.isCrosswalk=/crosswalk/i.test(navigator.userAgent)||/xwalk/i.test(navigator.userAgent)||!(void 0===window.c2isCrosswalk||!window.c2isCrosswalk),this.isCordova="cordova"===this.exportType,this.isPhoneGap=this.isCordova,this.isMicrosoftEdge=/edge\//i.test(navigator.userAgent),this.isMicroMessenger=/MicroMessenger/i.test(navigator.userAgent),this.isIE=(/msie/i.test(navigator.userAgent)||/trident/i.test(navigator.userAgent)||/iemobile/i.test(navigator.userAgent))&&!this.isMicrosoftEdge,this.isTizen=/tizen/i.test(navigator.userAgent),this.isAndroid=/android/i.test(navigator.userAgent)&&!this.isTizen&&!this.isIE&&!this.isMicrosoftEdge,this.isiPhone=(/iphone/i.test(navigator.userAgent)||/ipod/i.test(navigator.userAgent))&&!this.isIE&&!this.isMicrosoftEdge,this.isiPad=xf.isIpad(),this.isiOS=this.isiPhone||this.isiPad,this.isChrome=(/chrome/i.test(navigator.userAgent)||/chromium/i.test(navigator.userAgent))&&!this.isIE&&!this.isMicrosoftEdge,this.isAmazonWebApp=/amazonwebappplatform/i.test(navigator.userAgent),this.isFirefox=/firefox/i.test(navigator.userAgent),this.isSafari=/safari/i.test(navigator.userAgent)&&!this.isChrome&&!this.isIE&&!this.isMicrosoftEdge,this.isWindows=/windows/i.test(navigator.userAgent),this.isNWjs="nwjs"===this.exportType||/nodewebkit/i.test(navigator.userAgent)||/nwjs/i.test(navigator.userAgent),this.isElectron="electron"===this.exportType||/electron/i.test(navigator.userAgent),this.isNodeWebkit=this.isNWjs,this.isArcade="scirra-arcade"===this.exportType,this.isWindows8App=!(void 0===window.c2isWindows8||!window.c2isWindows8),this.isWindowsPhone8=!(void 0===window.c2isWindowsPhone8||!window.c2isWindowsPhone8),this.isWindowsPhone81=!(void 0===window.c2isWindowsPhone81||!window.c2isWindowsPhone81),this.isWindows10="windows-uwp"===this.exportType,this.isWinJS=this.isWindows8App||this.isWindowsPhone81||this.isWindows10,this.isBlackberry10=!(void 0===window.c2isBlackberry10||!window.c2isBlackberry10),this.isAndroidStockBrowser=this.isAndroid&&!this.isChrome&&!this.isCrosswalk&&!this.isFirefox&&!this.isAmazonWebApp,this.devicePixelRatio=1,this.isOSX=/Mac OS X/.test(navigator.userAgent)||/Mac/i.test(navigator.userAgent)||/OS X/.test(navigator.userAgent),this.isMiniGame="minigame"===this.exportType||/minigame/i.test(navigator.userAgent),this.isBrowser="h5"==this.exportType||"preview"==this.exportType,this.channel=xf.queryString("es_e_channelCode",!1)||"",this.isMobile=this.isCordova||this.isCrosswalk||this.isAndroid||this.isiOS||this.isWindowsPhone8||this.isWindowsPhone81||this.isBlackberry10||this.isTizen,!this.isMobile)this.isMobile=/(blackberry|bb10|playbook|palm|symbian|nokia|windows\s+ce|phone|mobile|tablet|kindle|silk)/i.test(navigator.userAgent);if(this.isWKWebView=!(!this.isiOS||!this.isCordova),this.isPreview&&!this.isNWjs&&("?nw"===window.location.search||/nodewebkit/i.test(navigator.userAgent)||/nwjs/i.test(navigator.userAgent)))this.isNWjs=!0;if(this.isDebug=this.isPreview&&-1<window.location.search.indexOf("debug"),this.useFbInstant="undefined"!=typeof FBInstant&&!this.isPreview&&!this.isCordova,this.hasInitialized=!1,this.canvas=e,this.gl=null,this.glwrap=null,this.glUnmaskedRenderer="(unavailable)",this.enableFrontToBack=!1,this.earlyz_index=0,this.ctx=null,this.firstInFullscreen=!1,this.oldWidth=0,this.oldHeight=0,this.canvas&&this.canvas.style)this.canvas.style.position="absolute",this.canvas.style.left=0,this.canvas.style.top=0;if(this.canvas.oncontextmenu=function(t){if(t.preventDefault)t.preventDefault();return!1},this.canvas.onselectstart=function(t){if(t.preventDefault)t.preventDefault();return!1},this.canvas.ontouchstart=function(t){if(t.preventDefault)t.preventDefault();return!1},this.isNWjs)if(window.ondragover=function(t){return t.preventDefault(),!1},window.ondrop=function(t){return t.preventDefault(),!1},window.nwgui&&window.nwgui.App.clearCache)window.nwgui.App.clearCache();if(this.projectDataUrl=i||"",this.width=e.width,this.height=e.height,this.draw_width=this.width,this.draw_height=this.height,this.cssWidth=this.width,this.cssHeight=this.height,this.lastWindowWidth=window.innerWidth,this.lastWindowHeight=window.innerHeight,this.forceCanvasAlpha=!1,this.redraw=!0,this.drawlist=[],this.isSuspended=!1,this.is_catch_event=!0,!Date.now)Date.now=function(){return+new Date};if(this.plugins=[],this.types={},this.types_lowercase={},this.types_by_index=[],this.behaviors=[],this.layouts={},this.layouts_by_index=[],this.eventsheets={},this.eventsheets_by_index=[],this.triggers_to_postinit=[],this.all_global_vars=[],this.all_global_varsMap={},this.all_origin_global_vars={},this.all_local_vars=[],this.solidBehavior=null,this.jumpthruBehavior=null,this.shadowcasterBehavior=null,this.deathRow={},this.hasPendingInstances=!1,this.isInClearDeathRow=!1,this.isInOnDestroy=0,this.isRunningEvents=!1,this.isEndingLayout=!1,this.createRow=[],this.isLoadingState=!1,this.saveToSlot="",this.loadFromSlot="",this.loadFromJson=null,this.lastSaveJson="",this.signalledContinuousPreview=!1,this.suspendDrawing=!1,this.fireOnCreateAfterLoad=[],this.isOnLayoutStart=!1,this.isOnLayoutEnd=!1,this.dt=0,this.dt1=0,this.minimumFramerate=30,this.logictime=0,this.cpuutilisation=0,this.rendertime=0,this.rendercpu=0,this.eventstime=0,this.eventscpu=0,this.timescale=1,this.kahanTime=new drama.KahanAdder,this.wallTime=new drama.KahanAdder,this.last_tick_time=0,this.fps=0,this.last_fps_time=0,this.tickcount=0,this.tickcount_nosave=0,this.execcount=0,this.framecount=0,this.objectcount=0,this.gpuTimeStartFrame=0,this.gpuTimeEndFrame=0,this.gpuCurUtilisation=-1,this.gpuLastUtilisation=0,this.collisioncheck_count=0,this.collisioncheck_sec=0,this.polycheck_count=0,this.polycheck_sec=0,this.movedcell_count=0,this.movedcell_sec=0,this.movedrendercell_count=0,this.movedrendercell_sec=0,this.physics_cpu=0,this.hit_breakpoint=!1,this.step_break=!1,this.resuming_breakpoint=!1,this.breakpoint_event=null,this.breakpoint_action=null,this.breakpoint_condition=null,this.changelayout=null,this.destroycallbacks=[],this.event_stack=[],this.event_stack_index=-1,this.localvar_stack=[[]],this.localvar_stack_index=0,this.trigger_depth=0,this.pushEventStack(null),this.loop_stack=[],this.loop_stack_index=-1,this.next_uid=0,this.next_puid=0,this.layout_first_tick=!0,this.family_count=0,this.suspend_events=[],this.raf_id=-1,this.timeout_id=-1,this.isloading=!0,this.loadingprogress=0,this.isNodeFullscreen=!1,this.stackLocalCount=0,this.audioInstance=null,this.had_a_click=!1,this.isInUserInputEvent=!1,this.objects_to_pretick=new drama.ObjectSet,this.objects_to_tick=new drama.ObjectSet,this.objects_to_tick2=new drama.ObjectSet,this.registered_collisions=[],this.temp_poly=new drama.CollisionPoly([]),this.temp_poly2=new drama.CollisionPoly([]),this.allGroups=[],this.groups_by_name={},this.cndsBySid={},this.actsBySid={},this.varsBySid={},this.varsByName={},this.varsByLowerName={},this.xfReport=new drama.XfReportVariable(this),this.blocksBySid={},this.running_layout=null,this.layer_canvas=null,this.layer_ctx=null,this.layer_tex=null,this.layout_tex=null,this.layout_canvas=null,this.layout_ctx=null,this.is_WebGL_context_lost=!1,this.uses_background_blending=!1,this.fx_tex=[null,null],this.fullscreen_scaling=0,this.files_subfolder="",this.objectsByUid={},this.webFontNames=null,this.enhancedAccelerationPrecision=!0,this.snapshotCanvas=null,this.snapshotData="",this.objectRefTable=[],this.deviceOrientation="",this.groupCollisionMap={},"html5"===this.exportType&&"file"===location.protocol.substr(0,4))alert("Exported games won't work until you upload them. (When running on the file: protocol, browsers block many features from working for security reasons.)");this.objectBankInstancMap={},this.initLoader(),this.layoutFlag={}}}t=null,e.prototype.requestProjectData=function(){var e=this;if(!this.hasInitialized){this.hasInitialized=!0;var t=window.$bootConfig&&window.$bootConfig.remaps||{},i="data.json",n="n2h.json";if(this.isMiniGame)i="drama/".concat(i),n="drama/".concat(n);i=t[i]||i,n=t[n]||n;var r=new xf.XfLoader;r.loadResGroup([i,n],"xf_load_project").then(function(t){if(e.manifest=t[n]||null,t[i])e.loadProject(t[i]);else console.error("Error fetching data.json");r=null}).catch(function(t){r=null,console.error("Error fetching data.json",t)})}},e.prototype.initLoader=function(){var e=this,t=window.$bootConfig&&window.$bootConfig.remaps||{},i=new xf.XfLoader;this.loaderBGURL="assets/splash-images/background.png",this.loaderBGURL=t[this.loaderBGURL]||this.loaderBGURL,this.loaderIconURL="assets/icons/loading-logo.png",this.loaderRunURL="assets/common-images/run.png",i.loadResGroup([this.loaderBGURL,this.loaderIconURL,this.loaderRunURL],"loader").then(function(t){if(e.useFbInstant)FBInstant.initializeAsync().then(function(){this.requestProjectData()}).catch(function(t){console.warn("[Instant Games] Unable to load: ",t),this.requestProjectData()}),window.setTimeout(function(){if(!this.hasInitialized)console.warn("[Instant Games] Initialization timed out after 4 seconds. Continuing with Instant Games disabled."),this.useFbInstant=!1,this.requestProjectData()},4e3);else e.requestProjectData();i=null}).catch(function(t){i=null,console.error("Error fetching data.json",t)})},e.prototype.createLoadingCanvas=function(){if(!this.overlay_canvas)this.canvas.hidden=!0,this.overlay_canvas=document.createElement("canvas"),this.canvas.parentNode.appendChild(this.overlay_canvas),this.overlay_canvas.oncontextmenu=function(t){return!1},this.overlay_canvas.onselectstart=function(t){return!1},this.overlay_canvas.width=Math.round(this.cssWidth*this.devicePixelRatio),this.overlay_canvas.height=Math.round(this.cssHeight*this.devicePixelRatio),this.overlay_canvas.style.width=this.cssWidth+"px",this.overlay_canvas.style.height=this.cssHeight+"px",this.overlay_canvas.style.position="absolute",this.overlay_canvas.style.top="0px",this.overlay_canvas.style.left="0px",this.overlay_canvas.style.zIndex=100,this.overlay_ctx=this.overlay_canvas.getContext("2d"),this.setSize(window.innerWidth,window.innerHeight,!0)},e.prototype.initRendererAndLoader=function(){var t,e,i,n,r,o,s,a,l,c,u,h=this;if(this.isRetina=this.useHighDpi&&!this.isAndroidStockBrowser,0===this.fullscreen_mode&&this.isiOS)this.isRetina=!1;if(this.devicePixelRatio=this.isRetina?window.devicePixelRatio||window.webkitDevicePixelRatio||window.mozDevicePixelRatio||window.msDevicePixelRatio||1:1,this.ClearDeathRow(),0<this.fullscreen_mode)this.setSize(window.innerWidth,window.innerHeight,!0);if(this.enableWebGL){u={alpha:!0,depth:!1,antialias:!1,failIfMajorPerformanceCaveat:!0,preserveDrawingBuffer:!0};try{if(this.gl=this.canvas.getContext("webgl",u)||this.canvas.getContext("experimental-webgl",u),!this.gl)this.gl=this.canvas.getContext("webgl2",u)}catch(t){console.log("browser does not support WebGL")}}if(this.gl){var d=0===this.gl.getParameter(this.gl.VERSION).indexOf("WebGL 2"),p=this.gl.getExtension("WEBGL_debug_renderer_info");if(p){var f=this.gl.getParameter(p.UNMASKED_VENDOR_WEBGL),m=this.gl.getParameter(p.UNMASKED_RENDERER_WEBGL);this.glUnmaskedRenderer=m+" ["+f+"]"}if(this.enableFrontToBack)this.glUnmaskedRenderer+=" [front-to-back enabled]";if(log("Using WebGL "+(d?"2 ":"")+"renderer: "+this.glUnmaskedRenderer),this.createLoadingCanvas(),this.glwrap=new drama.GLWrap(this.gl,this.isMobile,this.enableFrontToBack),this.glwrap.setSize(this.canvas.width,this.canvas.height),this.glwrap.enable_mipmaps=0!==this.downscalingQuality,this.ctx=null,this.canvas.addEventListener("webglcontextlost",function(t){t.preventDefault(),h.onContextLost(),window.cr_setSuspended(!0)},!1),this.canvas.addEventListener("webglcontextrestored",function(t){h.glwrap.initState(),h.glwrap.setSize(h.glwrap.width,h.glwrap.height,!0),h.layer_tex=null,h.layout_tex=null,h.fx_tex[0]=null,h.fx_tex[1]=null,h.onContextRestored(),h.redraw=!0,window.cr_setSuspended(!1)},!1),!this.glwrap.supportsGpuProfiling())this.gpuLastUtilisation=NaN;for(t=0,e=this.types_by_index.length;t<e;t++)for(i=0,n=(s=this.types_by_index[t]).effect_types.length;i<n;i++)(a=s.effect_types[i]).shaderindex=this.glwrap.getShaderIndex(a.id),a.preservesOpaqueness=this.glwrap.programPreservesOpaqueness(a.shaderindex),this.uses_background_blending=this.uses_background_blending||this.glwrap.programUsesDest(a.shaderindex);for(t=0,e=this.layouts_by_index.length;t<e;t++){for(i=0,n=(l=this.layouts_by_index[t]).effect_types.length;i<n;i++)(a=l.effect_types[i]).shaderindex=this.glwrap.getShaderIndex(a.id),a.preservesOpaqueness=this.glwrap.programPreservesOpaqueness(a.shaderindex);for(l.updateActiveEffects(),i=0,n=l.layers.length;i<n;i++){for(r=0,o=(c=l.layers[i]).effect_types.length;r<o;r++)(a=c.effect_types[r]).shaderindex=this.glwrap.getShaderIndex(a.id),a.preservesOpaqueness=this.glwrap.programPreservesOpaqueness(a.shaderindex),this.uses_background_blending=this.uses_background_blending||this.glwrap.programUsesDest(a.shaderindex);c.updateActiveEffects()}}}else{if(log("Using Canvas 2D renderer"),u={alpha:!0},this.ctx=this.canvas.getContext("2d",u),this.ctx)this.ctx.imageSmoothingEnabled=this.linearSampling;this.overlay_canvas=null,this.overlay_ctx=null,this.gpuLastUtilisation=NaN}if(this.tickFunc=function(t){h.tick(!1,t)},window!=window.top&&!this.isWinJS&&!this.isWindowsPhone8)document.addEventListener("mousedown",function(){window.focus()},!0),document.addEventListener("touchstart",function(){window.focus()},!0);if(this.isPreview){if(-1<window.location.search.indexOf("continuous"))drama.logexport("Reloading for continuous preview"),this.loadFromSlot="__xf_continuouspreview",this.suspendDrawing=!0;if(this.pauseOnBlur&&!this.isMobile)window.addEventListener("focus",function(){h.setSuspended(!1)}),window.addEventListener("blur",function(){})}window.addEventListener("blur",function(){h.onWindowBlur()});var g=function(t){if("mousedown"===t.type&&1===t.button)t.preventDefault();if(drama.isCanvasInputEvent(t)&&document.activeElement&&document.activeElement!==document.getElementsByTagName("body")[0]&&document.activeElement.blur);};if("undefined"!=typeof PointerEvent)document.addEventListener("pointerdown",g);else if(window.navigator.msPointerEnabled)document.addEventListener("MSPointerDown",g);else document.addEventListener("touchstart",g);if(document.addEventListener("mousedown",g),0===this.fullscreen_mode&&this.isRetina&&1<this.devicePixelRatio)this.setSize(this.original_width,this.original_height,!0);else this.setSize(window.innerWidth,window.innerHeight,!0);this.tryLockOrientation(),this.startSplashGo(function(){if(h.useFbInstant)FBInstant.startGameAsync().then(function(){h.go_loading_finished()});else h.go_loading_finished()}),this.extra={},drama.seal(this)},e.prototype.getOrientation=function(){if(this.isBrowser&&this.isMobile)if(0==this.orientations){var t=this.original_width/this.original_height<=1;this.isForcePortrait="landscape"==this.deviceOrientation&&t,this.isForceLandScape="portrait"==this.deviceOrientation&&!t}else if(1==this.orientations)this.isForcePortrait="landscape"==this.deviceOrientation;else if(2==this.orientations)this.isForceLandScape="portrait"==this.deviceOrientation},e.prototype.setSize=function(t,e,i){var n=xf.checkOrientation();if(this.deviceOrientation!==n||this.lastWindowWidth!==t||this.lastWindowHeight!==e||i){if(this.isMobile&&!this.isMiniGame){if(/INPUT|TEXTAREA/.test(document.activeElement.tagName)&&this.deviceOrientation!==n)return void document.activeElement.blur();if(/INPUT|TEXTAREA/.test(document.activeElement.tagName)&&!i)return;if(n==this.deviceOrientation&&this.lastWindowWidth===t&&this.lastWindowHeight-e>this.lastWindowHeight/2)return}if(this.overlay_canvas)this.overlay_canvas.style.left="0px",this.overlay_canvas.style.top="0px",this.overlay_canvas.style.transform="rotate(0deg)";this.canvas.style.left="0px",this.canvas.style.top="0px",this.canvas.style.transform="rotate(0deg)";var r=document.getElementById("domContainer");if(r)r.style.left="0px",r.style.top="0px",r.style.transform="rotate(0deg)";var o=this.isForceLandScape;if(this.deviceOrientation=n,this.getOrientation(),this.isForceLandScape&&!o)xf.createLandscapeGuide();else if(!this.isForceLandScape&&o)xf.removeLandscapeGuide(null,!1);xf.appBannerTransform(),this.lastWindowWidth=t,this.lastWindowHeight=e;var s,a,l=this.fullscreen_mode,c=0,u=0,h=0,d=0,p=0,f=(document.mozFullScreen||document.webkitIsFullScreen||!!document.msFullscreenElement||document.fullScreen||this.isNodeFullscreen)&&!this.isCordova;if(f||0!==this.fullscreen_mode||i){if(f&&0<this.fullscreen_scaling)l=this.fullscreen_scaling;var m,g=this.devicePixelRatio;if(this.isForceLandScape&&t<e)m=e,e=t,t=m;else if(this.isForcePortrait&&e<t)m=t,t=e,e=m;if(4<=l)if((s=this.original_width/this.original_height)<(a=t/e))if(h=e*s,5===l){if(1<(p=h*g/this.original_width))p=Math.floor(p);else if(p<1)p=1/Math.ceil(1/p);c=(t-(h=this.original_width*p/g))/2,u=(e-(d=this.original_height*p/g))/2,t=h,e=d}else c=(t-h)/2,t=h;else if(d=t/s,5===l){if(1<(p=d*g/this.original_height))p=Math.floor(p);else if(p<1)p=1/Math.ceil(1/p);c=(t-(h=this.original_width*p/g))/2,u=(e-(d=this.original_height*p/g))/2,t=h,e=d}else u=(e-d)/2,e=d;else if(this.isNWjs&&this.isNodeFullscreen&&0===this.fullscreen_mode_set)c=Math.floor((t-this.original_width)/2),u=Math.floor((e-this.original_height)/2),t=this.original_width,e=this.original_height;if(l<2)this.aspect_scale=g;if(this.cssWidth=Math.round(t),this.cssHeight=Math.round(e),this.width=Math.round(t*g),this.height=Math.round(e*g),this.redraw=!0,this.wantFullscreenScalingQuality)this.draw_width=this.width,this.draw_height=this.height,this.fullscreenScalingQuality=!0;else if(this.width<this.original_width&&this.height<this.original_height||1===l)this.draw_width=this.width,this.draw_height=this.height,this.fullscreenScalingQuality=!0;else if(this.draw_width=this.original_width,this.draw_height=this.original_height,this.fullscreenScalingQuality=!1,2===l){if(s=this.original_width/this.original_height,(a=this.lastWindowWidth/this.lastWindowHeight)<s)this.draw_width=this.draw_height*a;else if(s<a)this.draw_height=this.draw_width/a}else if(3===l)if((s=this.original_width/this.original_height)<(a=this.lastWindowWidth/this.lastWindowHeight))this.draw_width=this.draw_height*a;else if(a<s)this.draw_height=this.draw_width/a;if(this.canvas){if(this.canvas.width=Math.round(t*g),this.canvas.height=Math.round(e*g),this.isRetina)this.canvas.style.width=Math.round(t)+"px",this.canvas.style.height=Math.round(e)+"px";this.canvas.style.marginLeft=Math.floor(c)+"px",this.canvas.style.marginTop=Math.floor(u)+"px"}if(this.overlay_canvas){if(this.overlay_canvas.width=Math.round(t*g),this.overlay_canvas.height=Math.round(e*g),this.isRetina)this.overlay_canvas.style.width=Math.round(t)+"px",this.overlay_canvas.style.height=Math.round(e)+"px";this.overlay_canvas.style.marginLeft=Math.floor(c)+"px",this.overlay_canvas.style.marginTop=Math.floor(u)+"px"}var y=this.glwrap;if(y){if(y.setSize(this.width,this.height,!0),y.resetModelView(),this.isMinigame)y.scale(1,1);else y.scale(this.aspect_scale,this.aspect_scale);if(y.rotateZ(0),y.translate(this.width/-2,this.height/-2),y.updateModelView(),et)y.deleteTexture(et),et=null}if(this.ctx)this.ctx.imageSmoothingEnabled=this.linearSampling;if(this.tryLockOrientation(),this.isiPhone&&!this.isCordova&&!this.isMiniGame)window.scrollTo(0,0);var v=(e-t)/2,b=0,_=0,w=0;if(this.isForceLandScape)b=90;else if(this.isForcePortrait)b=-90;if(r)if(r.width=Math.round(t*g),r.height=Math.round(e*g),this.isRetina)r.style.width=Math.round(t)+"px",r.style.height=Math.round(e)+"px";if(this.isForcePortrait||this.isForceLandScape){if(_=c,w=u,this.canvas.style.transform="rotate("+b+"deg)",this.canvas.style.top=-v+"px",this.canvas.style.left=v+"px",this.canvas.style.marginTop=_+"px",this.canvas.style.marginLeft=w+"px",this.overlay_canvas)this.overlay_canvas.style.transform="rotate("+b+"deg)",this.overlay_canvas.style.top=-v+"px",this.overlay_canvas.style.left=v+"px",this.overlay_canvas.style.marginTop=_+"px",this.overlay_canvas.style.marginLeft=w+"px";if(r)r.style.transform="rotate("+b+"deg)",r.style.top=-v+"px",r.style.left=v+"px",r.style.marginTop=_+"px",r.style.marginLeft=w+"px"}else if(r)r.style.marginTop=Math.floor(u)+"px",r.style.marginLeft=Math.floor(c)+"px";if(xf.EventCenter.instance.sendEvent(new xf.EventData(xf.EventType.SCENE_RESIZE,this.canvas)),!window.xfruntime.isMobile&&"h5"===xfConfig.exportType)xf.pcWhiteSpace.instance.windowSizeChange()}}},e.prototype.tryLockOrientation=function(){if(this.autoLockOrientation&&0!==this.orientations){var t="portrait";if(2===this.orientations)t="landscape";if(!this.isMiniGame)try{var e=screen.orientation||screen.mozOrientation||screen.msOrientation;if(e&&e.lock)e.lock(t).catch(function(t){console.log(t.message)});else screen.orientationLock(t)}catch(t){if(console&&console.warn)console.warn("Failed to lock orientation: ",t.message)}}},e.prototype.onContextLost=function(){var t,e,i;for(this.glwrap.contextLost(),this.is_WebGL_context_lost=!0,t=0,e=this.types_by_index.length;t<e;t++)if((i=this.types_by_index[t]).onLostWebGLContext)i.onLostWebGLContext()},e.prototype.onContextRestored=function(){var t,e,i;for(this.is_WebGL_context_lost=!1,t=0,e=this.types_by_index.length;t<e;t++)if((i=this.types_by_index[t]).onRestoreWebGLContext)i.onRestoreWebGLContext()};var s=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame||window.oCancelAnimationFrame;function Z(t,e,i,n,r,o){var s=Math.PI;t.beginPath(),t.arc(e+o,i+o,o,-s,-s/2),t.arc(e+n-o,i+o,o,-s/2,0),t.arc(e+n-o,i+r-o,o,0,s/2),t.arc(e+o,i+r-o,o,s/2,s),t.closePath()}function tt(t,e,i,n,r,o){var s=Math.PI;t.beginPath(),t.moveTo(e,i),t.lineTo(e+n,i),t.arc(e+n,i+.5*r,o,.5*-s,.5*s),t.moveTo(e+n,i+r),t.lineTo(e,i+r),t.lineTo(e,i),t.closePath()}e.prototype.setSuspended=function(t){var e,i;if(t&&!this.isSuspended){if(this.isSuspended=!0,-1!==this.raf_id)s(this.raf_id);if(-1!==this.timeout_id)clearTimeout(this.timeout_id);for(e=0,i=this.suspend_events.length;e<i;e++)this.suspend_events[e](!0);if(this.trigger(drama.system_object.prototype.cnds.OnSuspend,null),this.isOnSuspend=!0,this.trigger(drama.system_object.prototype.cnds.OnChangeSuspend,null),this.isOnSuspend=!1,this.isDebug){var n="";if(this.breakpoint_event)if(n=this.breakpoint_event.sheet.name+", event "+this.breakpoint_event.display_number,this.breakpoint_condition)n+=", condition "+(this.breakpoint_condition.index+1);else if(this.breakpoint_action)n+=", action "+(this.breakpoint_action.index+1);DebuggerSuspended(!0,this.hit_breakpoint,n)}}else if(!t&&this.isSuspended){for(this.isSuspended=!1,this.last_tick_time=drama.performance_now(),this.last_fps_time=drama.performance_now(),this.framecount=0,e=this.logictime=0,i=this.suspend_events.length;e<i;e++)this.suspend_events[e](!1);if(this.trigger(drama.system_object.prototype.cnds.OnResume,null),this.isOnResume=!0,this.trigger(drama.system_object.prototype.cnds.OnChangeSuspend,null),this.isOnResume=!1,this.isDebug)DebuggerSuspended(!1,!1,"");this.tick(!1)}},e.prototype.addSuspendCallback=function(t){this.suspend_events.push(t)},e.prototype.GetObjectReference=function(t){return assert2(0<=t&&t<this.objectRefTable.length,"Object reference index out of range"),this.objectRefTable[t]},e.prototype.loadProject=function(t){var e=this;if(!this.isMiniGame)try{var i=document.getElementById("init_loading_div");i.style.opacity="0",document.body.removeChild(i)}catch(t){}if(assert2(t&&t.project,"Project model unavailable"),!t||!t.project)drama.logerror("Project model unavailable");var n=t.project;if(this.name=n[0],this.backgroundColor=n[38],this.backgroundColor)this.backGroundColorStr=xf.hexaDecimal(this.backgroundColor),document.body&&document.body.style&&(document.body.style.backgroundColor=this.backGroundColorStr),document.documentElement&&document.documentElement.style&&(document.documentElement.style.backgroundColor=this.backGroundColorStr);if(xfConfig.isLogin=1==n[36],xfConfig.outline)xfConfig.isLogin=!1;if(this.tradeInfo=n[33],!this.isMiniGame)document.title=this.name;if(this.first_layout=n[1],this.fullscreen_mode=n[12],this.fullscreen_mode_set=n[12],this.original_width=n[10],this.original_height=n[11],this.scalex=this.width/this.original_width,this.scaley=this.height/this.original_height,this.canvasScaleX=this.scalex*window.devicePixelRatio,this.canvasScaleY=this.scaley*window.devicePixelRatio,this.versionstr=n[16],this.parallax_x_origin=this.original_width/2,this.parallax_y_origin=this.original_height/2,this.uses_loader_layout=n[18],this.isLoadBySection=n[34],this.loaderstyle=n[19],this.iconsFolder=n[28],this.spineDataMap={},n[39]&&n[39][0]){var r=[];n[39][0].map(function(t){e.spineDataMap[t[0]]={json:t[1],atlas:t[2]},r.push(t[1]),r.push(t[2])}),this.xfPreloadGroup.push(r)}var o,s,a,l,c,u,h,d,p,f,m,g,y,v,b,_=n[29],w=n[32],x=[];for(_.map(function(t){x.push(w+t[1])}),this.xfPreloadGroup.push(x),this.next_uid=n[21],this.objectRefTable=drama.getObjectRefTable(),this.system=new drama.system_object(this),o=0,s=n[2].length;o<s;o++){if(h=n[2][o],assert2(m=this.GetObjectReference(h[0]),"A plugin is missing.  Check the plugin IDs match in edittime and runtime scripts.  Note this can also occur when there is an error in a plugin script that prevents the browser from loading the script - check the error console."),drama.add_common_aces(h,m.prototype),(y=new m(this)).singleglobal=h[1],y.is_world=h[2],y.is_rotatable=h[5],y.must_predraw=h[9],y.is_slide=h[10],y.onCreate)y.onCreate();if(drama.plugins_.xfInput&&y instanceof drama.plugins_.xfInput)this.renderDomContainer();drama.seal(y),this.plugins.push(y)}for(this.objectRefTable=drama.getObjectRefTable(),o=0,s=n[3].length;o<s;o++){for(h=n[3][o],assert2(v=this.GetObjectReference(h[1]),"No plugin ctor provided for object type"),y=null,a=0,l=this.plugins.length;a<l;a++)if(this.plugins[a]instanceof v){y=this.plugins[a];break}assert2(y,"Cannot find plugin for object type"),assert2(y.Type,"Plugin does not have a Type class");var S=new y.Type(y);if(assert2(S.plugin,"Plugin's Type object must save this.plugin, runtime depends on it"),S.name=h[0],S.is_family=h[2],S.instvar_sids=h[3].slice(0),S.vars_count=h[3].length,S.behs_count=h[4],S.fx_count=h[5],S.sid=h[11],S.touch_pass=h[12],S.is_family)S.members=[],S.family_index=this.family_count++,S.families=null;else S.members=null,S.family_index=-1,S.families=[];if(S.family_var_map=null,S.family_beh_map=null,S.family_fx_map=null,S.is_contained=!1,S.container=null,h[6])S.isTexture=!0,S.texture_file=h[6][0],S.texture_filesize=h[6][1],S.texture_pixelformat=h[6][2],S.texture_data=h[6];else S.texture_file=null,S.texture_filesize=0,S.texture_pixelformat=0,S.texture_data=null;if(h[7])S.animations=h[7],S.isAnimations=!0;else S.animations=null;for(S.index=o,S.instances=[],S.deadCache=[],S.solstack=[new drama.selection(S)],S.cur_sol=0,S.default_instance=null,S.default_layerindex=0,S.stale_iids=!0,S.updateIIDs=drama.type_updateIIDs,S.getFirstPicked=drama.type_getFirstPicked,S.getPairedInstance=drama.type_getPairedInstance,S.getCurrentSol=drama.type_getCurrentSol,S.pushCleanSol=drama.type_pushCleanSol,S.pushCopySol=drama.type_pushCopySol,S.popSol=drama.type_popSol,S.getBehaviorByName=drama.type_getBehaviorByName,S.getBehaviorIndexByName=drama.type_getBehaviorIndexByName,S.getEffectIndexByName=drama.type_getEffectIndexByName,S.applySolToContainer=drama.type_applySolToContainer,S.getInstanceByIID=drama.type_getInstanceByIID,S.collision_grid=new drama.SparseGrid(this.original_width,this.original_height),S.any_cell_changed=!0,S.any_instance_parallaxed=!1,S.extra={},S.toString=drama.type_toString,S.collectAnimationsImg=drama.collect_animations_img,S.collectTextureImg=drama.collect_texture_img,S.loadAnimationsImg=drama.load_animations_img,S.loadTextureImg=drama.load_texture_img,S.dynamicRelease=drama.dynamicRelease,S.behaviors=[],a=0,l=h[8].length;a<l;a++){d=h[8][a];var I=this.GetObjectReference(d[1]),T=null;for(c=0,u=this.behaviors.length;c<u;c++)if(this.behaviors[c]instanceof I){T=this.behaviors[c];break}if(!T){if((T=new I(this)).my_types=[],T.my_instances=new drama.ObjectSet,T.onCreate)T.onCreate();if(drama.seal(T),this.behaviors.push(T),drama.behaviors.solid&&T instanceof drama.behaviors.solid)this.solidBehavior=T;if(drama.behaviors.jumpthru&&T instanceof drama.behaviors.jumpthru)this.jumpthruBehavior=T;if(drama.behaviors.shadowcaster&&T instanceof drama.behaviors.shadowcaster)this.shadowcasterBehavior=T}if(-1===T.my_types.indexOf(S))T.my_types.push(S);var C=new T.Type(T,S);C.name=d[0],C.sid=d[2],C.onCreate(),drama.seal(C),S.behaviors.push(C)}for(S.global=h[9],S.isOnLoaderLayout=h[10],S.effect_types=[],a=0,l=h[13].length;a<l;a++)S.effect_types.push({id:h[13][a][0],name:h[13][a][1],shaderindex:-1,preservesOpaqueness:!1,active:!0,index:a});if(S.tilemap_data=h[14],S.preloadResource=h[17],S.loadingprogress=0,!this.isLoadBySection&&!this.uses_loader_layout&&S.preloadResource||S.is_family||!this.isLoadBySection&&S.isOnLoaderLayout&&S.preloadResource||!y.is_world)S.onCreate(),drama.seal(S);if(S.name)this.types[S.name]=S,this.types_lowercase[S.name.toLowerCase()]=S;if(this.types_by_index.push(S),y.singleglobal){var O=new y.Instance(S);O.uid=this.next_uid++,O.puid=this.next_puid++,O.iid=0,O.get_iid=drama.inst_get_iid,O.toString=drama.inst_toString,O.properties=h[15],O.instanceId=h[16]||O.uid,O.onCreate(),drama.seal(O),S.instances.push(O),this.objectsByUid[O.uid.toString()]=O}}for(o=0,s=n[4].length;o<s;o++){var P,E=n[4][o],A=this.types_by_index[E[0]];for(a=1,l=E.length;a<l;a++)(P=this.types_by_index[E[a]]).families.push(A),A.members.push(P)}for(o=0,s=n[27].length;o<s;o++){var k=n[27][o],M=[];for(a=0,l=k.length;a<l;a++)M.push(this.types_by_index[k[a]]);for(a=0,l=M.length;a<l;a++)M[a].is_contained=!0,M[a].container=M}if(0<this.family_count)for(o=0,s=this.types_by_index.length;o<s;o++)if(!(p=this.types_by_index[o]).is_family&&p.families.length){p.family_var_map=new Array(this.family_count),p.family_beh_map=new Array(this.family_count),p.family_fx_map=new Array(this.family_count);var R=[],L=0,D=0,N=0;for(a=0,l=p.families.length;a<l;a++)for(f=p.families[a],p.family_var_map[f.family_index]=L,L+=f.vars_count,p.family_beh_map[f.family_index]=D,D+=f.behs_count,p.family_fx_map[f.family_index]=N,N+=f.fx_count,c=0,u=f.effect_types.length;c<u;c++)R.push(drama.shallowCopy({},f.effect_types[c]));for(p.effect_types=R.concat(p.effect_types),a=0,l=p.effect_types.length;a<l;a++)p.effect_types[a].index=a}for(o=0,s=n[5].length;o<s;o++){h=n[5][o];var B=new drama.layout(this,h);drama.seal(B),this.layouts[B.name]=B,this.layouts_by_index.push(B)}if(this.layoutToSectionMap={},this.loadSections={},this.loadSections_by_index=[],n[35])for(o=0,s=n[35].length;o<s;o++)h=n[35][o],b=new drama.loadSection(this,h),drama.seal(b),this.loadSections[b.name]=b,this.loadSections_by_index.push(b);if(this.isLoadBySection){var F=this.layouts_by_index;a=0;for(var j=F.length;a<j;a++)if(F[a].name&&!this.layoutToSectionMap[F[a].name])b=new drama.loadSection(this,[Date.now()+String(F[a].name),[F[a].name]]),drama.seal(b),this.loadSections[b.name]=b,this.loadSections_by_index.push(b);var G=this.layoutToSectionMap[this.first_layout],V=this.loadSections[G].layouts;for(this.loadSections[G].isCommon=!0,this.loadSections[G].isLoad=!0,this.loadLastSection=this.loadSections[G],o=0,s=V.length;o<s;o++){a=0;for(var U=(F=V[o]).initial_types.length;a<U;a++)if(!(S=F.initial_types[a]).isLoad&&S.preloadResource)S.onCreate(),S.isLoad=!0,S.isCommon=!0,drama.seal(S)}}for(o=0,s=n[6].length;o<s;o++){h=n[6][o];var W=new drama.eventsheet(this,h);drama.seal(W),this.eventsheets[W.name]=W,this.eventsheets_by_index.push(W)}for(o=0,s=this.eventsheets_by_index.length;o<s;o++)this.eventsheets_by_index[o].postInit();for(o=0,s=this.eventsheets_by_index.length;o<s;o++)this.eventsheets_by_index[o].updateDeepIncludes();for(o=0,s=this.triggers_to_postinit.length;o<s;o++)this.triggers_to_postinit[o].postInit();for(drama.clearArray(this.triggers_to_postinit),this.audio_files_info=n[7],this.audio_files_map={},o=0,s=this.audio_files_info.length;o<s;++o){if(g=this.audio_files_info[o],this.isiOS)g[2]=!1;this.audio_files_map[g[0]]=g[1]}this.files_subfolder=n[8],this.pixel_rounding=n[9],this.aspect_scale=1,this.enableWebGL=n[13],this.linearSampling=n[14],this.clearBackground=n[15],this.useHighDpi=n[17],this.orientations=n[20],this.autoLockOrientation=0<this.orientations,this.pauseOnBlur=n[22],this.wantFullscreenScalingQuality=n[23],this.fullscreenScalingQuality=this.wantFullscreenScalingQuality,this.downscalingQuality=n[24],this.enableFrontToBack=n[26]&&!this.isIE,this.enhancedAccelerationPrecision=n[30],this.start_time=Date.now(),drama.clearArray(this.objectRefTable),this.preloadSounds=n[25];var $=n[40][6];this.projectOwner=n[41]||"";var H=new Image;if(H.crossOrigin="anonymous",H.src=n[42]||"assets/common-images/default_head.png",this.headImage=H,$.forEach(function(t){t[14].forEach(function(t){e.objectBankInstancMap[e.types_by_index[t[1]].name]=t})}),!this.preloadSounds&&!J["audio/webm; codecs=opus"]&&window.OpusDecoder)window.OpusDecoder.Initialise();this.getready(),this.xfStartLoad(),this.initRendererAndLoader()},e.prototype.renderDomContainer=function(){var t=document.createElement("div");t.id="domContainer",t.style.position="absolute",t.style.overflow="hidden",document.body.appendChild(t)},e.prototype.loadingLayOut=function(t,e){var i=this;if(this.overlay_canvas.style.marginTop=this.canvas.style.marginTop,this.overlay_canvas.style.marginLeft=this.canvas.style.marginLeft,this.canvas.style.display="none",e)this.startSplashGo(function(){i.isloading=!1,i.canvas.style.display="block"});else this.startSplashGo(function(){if(i.loading=!1,i.layoutFlag[t.name]=!1,i.canvas.style.display="block",i.useFbInstant)FBInstant.startGameAsync().then(function(){i.doChangeLayout(t)});else i.doChangeLayout(t)})},e.prototype.sectionAlert=function(t){var e,i,n=this.running_layout.name||"当前场景";t=t||"";var r=[];r.push(t),r.push("实例生成失败。因"),r.push(n),r.push("场景中的"),r.push(t),r.push("对象未加载成功。请将该对象添加到当前场景中，或添加到第一个加载分段的场景中。");var o=r.join("");if(window.alert&&alert(o),-1!==this.raf_id)s(this.raf_id);if(-1!==this.timeout_id)clearTimeout(this.timeout_id);for(e=0,i=this.suspend_events.length;e<i;e++)this.suspend_events[e](!0)},e.prototype.collectSectionCaches=function(){for(var t=this.loadLastSection.layouts,e=0,i=t.length;e<i;e++)for(var n=t[e],r=0,o=n.initial_types.length;r<o;r++){var s=n.initial_types[r];if(!s.isCommon){if(s.isAnimations)s.collectAnimationsImg();if(s.isTexture)s.collectTextureImg()}}this.loadLastSection.isLoad=!1,this.loadLastSection.isLoading=!1},e.prototype.loadingSection=function(t){var e=this.layoutToSectionMap[t.name];if(!this.loadSections[e].isLoading){if(this.loadSections[e].isLoading=!0,!this.loadLastSection.isCommon)this.collectSectionCaches();if(this.loadSections[e].isLoad){var i=this.layoutToSectionMap[this.first_layout];this.loadLastSection=this.loadSections[i],this.isloading=!1}else{this.createLoadingCanvas(),this.isloading=!0;var n=this.loadSections[e].layouts;this.loadSections[e].isLoad=!0,this.loadLastSection=this.loadSections[e];for(var r=0,o=n.length;r<o;r++)for(var s=n[r],a=0,l=s.initial_types.length;a<l;a++){var c=s.initial_types[a];if(!c.isLoad&&c.preloadResource)c.onCreate(),c.isLoad=!0,drama.seal(c);if(c.isCollect){if(c.isCollect=!1,c.isAnimations)c.loadAnimationsImg();if(c.isTexture)c.loadTextureImg()}}this.xfStartLoad()}}},e.prototype.xfStartLoad=function(){var n=this;console.log(this.xfPreloadGroup.getSource()),this.isXfLoading=!0,this.xfPreloadGroup.startLoad({onProgress:function(t,e,i){n.progress=e/t*100,n.completedsize=e,n.totalsize=t,console.log("当前加载进度：".concat(n.progress))}}).then(function(t){n.progress=100,n.isXfLoading=!1,console.log("加载完成")}).catch(function(t){var e="\n";if(t.itemList.forEach(function(t){e+=t.url+"\n"}),n.isPreview)xf.XfLoginCanvas.showAlert("文件加载失败：".concat(e),{cancelCallback:function(){window.location.reload()},showConfirmButton:!1,cancelButtonText:"重试"});else xf.XfLoginCanvas.showAlert("网络链接中断, 请重试",{cancelCallback:function(){window.location.reload()},showConfirmButton:!1,cancelButtonText:"重试"});console.log("加载失败:".concat(e))})},e.prototype.requestTypeAnimations=function(n,r,o){var e=this,t=r.length,s=0;if([].slice.call(r).forEach(function(t,e){var i=window.xfHost.get({url:t});if(i)(n.all_frames[e].texture_img=i).cr_src=t,i.cr_filesize=o[e],s++,r.splice(e,1),o.splice(e,1)}),n.loadingprogress=s/n.all_frames.length*100,s==t)return this.dynamicType=n,this.trigger(drama.system_object.prototype.cnds.IsResourceLoadComplete,null),this.dynamicType=null,void(n.isLoadAll=!0);n.isDynamicLoading=!0;var a=new xf.XfLoader;a.loadResGroup(r,"xf_dynamic_load"+n.name,{onProgress:function(t,e){n.loadingprogress=e/t*100}}).then(function(i){n.all_frames.map(function(t){var e=r.indexOf(t.texture_file);if(!t.texture_img&&-1<e)t.texture_img=i[r[e]],t.texture_img.cr_src=r[e],t.texture_img.cr_filesize=o[e],t.texture_img.c2webGL_texture=null}),e.dynamicType=n,e.trigger(drama.system_object.prototype.cnds.IsResourceLoadComplete,null),e.dynamicType=null,a=null,n.isDynamicLoading=!1}).catch(function(t){a=null,e.dynamicType=n,e.trigger(drama.system_object.prototype.cnds.IsResourceLoadFail,null),e.dynamicType=null,n.isDynamicLoading=!1,console.error("Error fetching dynamic images",t)})},e.prototype.xfLoadC2Image=function(n,r,o,t){var e=window.xfHost.get({url:r}),i=!t?n:t,s=t?0:1;if(e)e.cr_src=r,e.cr_filesize=o,i.texture_img=e;else{if(!s)t.xf_src=r,t.xf_filesize=o;this.xfPreloadGroup.push(r,function(i){if(s)n.texture_img=i[r],n.texture_img.cr_src=r,n.texture_img.cr_filesize=o,n.texture_img.c2webGL_texture=null,n.loadingprogress=100;else n.all_frames.map(function(t,e){if(!t.texture_img||t.xf_src==r&&t.xf_filesize==o)t.texture_img=i[r],t.texture_img.cr_src=r,t.texture_img.cr_filesize=o,t.texture_img.c2webGL_texture=null;n.loadingprogress=(e+1)/n.all_frames.length*100})})}},e.prototype.getready=function(){if(this.audioInstance&&this.preloadSounds){var t,e,i,n,r,o,s=[];for(this.audio_files_info_map={},t=0,e=this.audio_files_info.length;t<e;++t)if(i=this.audio_files_info[t],this.audio_files_info_map[i[0]]=i[2],n=i[0],o=i[2],(r=this.getPreferredAudioFile(n))&&!o)s.push({filename:n+r[1],size:r[2],type:r[0]});if(this.audioInstance.setPreloadList(s),this.preloadSounds&&this.audioInstance)this.audioInstance.startPreloads()}},e.prototype.areAllTexturesAndSoundsLoaded=function(){return!this.isXfLoading},e.prototype.startSplashGo=function(t){if(this.splashEndCb=t,!this.isSplashing)this.splashGo()};var et=null,it=!(e.prototype.splashGo=function(){if(this.ctx||this.glwrap){var t=this.ctx||this.overlay_ctx;if(0<this.fullscreen_mode){var e=window.innerWidth,i=window.innerHeight;this.setSize(e,i)}if(this.isSplashing=!0,this.areAllTexturesAndSoundsLoaded()&&100<=this.progress){if("function"==typeof this.splashEndCb)this.splashEndCb();if(this.overlay_canvas)this.canvas.hidden=!1,this.overlay_canvas.parentNode.removeChild(this.overlay_canvas),this.overlay_canvas=null,this.overlay_ctx=null;this.redraw=!0,this.isSplashing=!1}else{if(this.isDebug)DebuggerLoadingProgress(this.progress);if(this.useFbInstant)FBInstant.setLoadingProgress(100*this.progress);var n=this;if(t){if(this.draw_loader(t,this.glwrap),d)d(function(){n.splashGo()});else setTimeout(function(){n.splashGo()},16);return}d(function(){n.splashGo()})}}}),nt={index:0,lastUpdate:0,delay:62,width:179,height:76,frameCOunt:26,row:13,col:2};function w(t,e){var i,n,r,o,s=[];for(i=0,n=e.sub_groups.length;i<n;++i)(o=e.sub_groups[i]).profile_last=o.profile_sum,o.profile_sum=0,w(r={name:o.group_name,profile:o.profile_last},o),s.push(r);if(s.length)t.sub_entries=s}e.prototype.draw_loader=function(t,e){var i=Math.ceil(this.width/2);Math.floor(this.height/2);if(!it)if(it=!0,e){if(e.resetModelView(),this.isMinigame)e.scale(1,1);else e.scale(this.aspect_scale,this.aspect_scale);e.rotateZ(0),e.translate(this.width/-2,this.height/-2),e.updateModelView()}try{t.clearRect(0,0,this.width,this.height);var n,r,o,s,a=window.xfHost.get({url:this.loaderBGURL}),l=window.xfHost.get({url:this.loaderIconURL}),c=window.xfHost.get({url:this.loaderRunURL});if(!a.complete||0===a.width||0===a.height)return;switch(t.globalAlpha=1,window.xfConfig.loaderStyle){case 2:n="#FFFFFF",r="#59BFCE",o="#BFB698",s="#AEB0BF";break;default:n="#242740",r="#59BFCE",o="#BFB698",s="#585966"}var u=(1===this.orientations||0===this.orientations&&"portrait"===this.deviceOrientation)&&this.width<this.height,h=u?this.width/a.width:this.height/a.height,d=u?a.width:this.width/h,p=u?this.height/h:a.height;if(u){t.drawImage(a,0,(a.height*h-this.height)/h*.5,d,p,0,0,this.width,this.height);var f=300*h,m=212*h;t.save(),t.shadowColor="#C9F4F1",t.shadowBlur=26,t.shadowOffsetY=6,t.fillStyle="white",Z(t,i-m/2,f,m,m,m/5),t.fill(),t.restore(),t.save(),Z(t,i-m/2,f,m,m,m/5),t.clip(),t.drawImage(l,i-m/2,f,m,m),t.restore(),t.font="bold ".concat(44*h,"px arial"),t.fillStyle=n,t.textBaseLine="middle";var g=this.name,y=t.measureText(g).width;t.fillText(g,i-y/2,588*h);var v=this.projectOwner,b=t.measureText(v).width;if(0<this.headImage.width)t.fillStyle=o,t.save(),t.beginPath(),t.arc(i-b/2,650*h,14*h,0,2*Math.PI),t.stroke(),t.clip(),t.drawImage(this.headImage,i-b/2-14*h,636*h,28*h,28*h),t.restore();t.font="bold ".concat(28*h,"px arial"),t.fillStyle=r,t.textBaseLine="middle",t.fillText(v,i-b/2+20*h,658*h);var _=20*h,w=this.height-100*h;t.fillStyle="#454545",t.fillRect(0,w,this.width,_);var x=this.completedsize/this.totalsize||0;tt(t,0,w,x*(this.width-10*h),_,.5*_),t.fillStyle="#59BFCE",t.fill(),t.font="".concat(24*h,"px arial");var S="正在加载...                                   ";S+=parseInt(100*x)+"%";var I=t.measureText(S).width,T=w+60*h;t.fillStyle=n,t.fillText(S,i-I/2,T);var C=34*h;t.font="".concat(20*h,"px arial");var O=t.measureText("抵制不良游戏，拒绝盗版游戏。注意自我保护，谨防受骗上当。").width,P=.5*(this.width-O),E=this.height-300*h;t.fillStyle=s,t.fillText("抵制不良游戏，拒绝盗版游戏。注意自我保护，谨防受骗上当。",P,E+C),t.fillText("适度游戏益脑，沉迷游戏伤身。合理安排时间，享受健康生活。",P,E+2*C);var A=nt.index/2<<0,k=nt.index%2;t.drawImage(c,nt.width*k,nt.height*A,nt.width,nt.height,x*(this.width-65)-110+.95*(nt.width-nt.width*h),w-nt.height+10+.85*(nt.height-nt.height*h),nt.width*h,nt.height*h);var M=Date.now();if(M-nt.lastUpdate>nt.delay)if(nt.lastUpdate=M,nt.index<25)nt.index++;else nt.index=0}else{if(a.width>=d)t.drawImage(a,(a.width*h-this.width)/h*.5,0,d,p,0,0,this.width,this.height);else t.drawImage(a,0,0,d,p,i-a.width*h/2,0,this.width,this.height);var R=150*h,L=160*h;t.save(),t.shadowColor="#C9F4F1",t.shadowBlur=26,t.shadowOffsetY=6,t.fillStyle="white",Z(t,i-L/2,R,L,L,L/5),t.fill(),t.restore(),t.save(),Z(t,i-L/2,R,L,L,L/5),t.clip(),t.drawImage(l,i-L/2,R,L,L),t.restore(),t.font="bold ".concat(35*h,"px arial"),t.fillStyle=n,t.textBaseLine="middle";var D=this.name,N=t.measureText(D).width;t.fillText(D,i-N/2,360*h);var B=this.projectOwner,F=t.measureText(B).width,j=410*h;if(0<this.headImage.width)t.fillStyle=o,t.save(),t.beginPath(),t.arc(i-F/2,j-10*h,17*h,0,2*Math.PI),t.stroke(),t.clip(),t.drawImage(this.headImage,i-F/2-17*h,j-27*h,34*h,34*h),t.restore();t.font="bold ".concat(32*h,"px arial"),t.fillStyle=r,t.textBaseLine="middle",t.fillText(B,i-F/2+30*h,j);var G=20*h,V=this.height-100*h;t.fillStyle="#454545",t.fillRect(0,V,this.width,G);var U=this.completedsize/this.totalsize||0;tt(t,0,V,U*(this.width-10*h),G,.5*G),t.fillStyle="#59BFCE",t.fill();var W="正在加载...                                                             ";t.font="".concat(30*h,"px arial");var $=V+60*h;W+=parseInt(100*U)+"%";var H=t.measureText(W).width;t.fillStyle=n,t.fillText(W,i-H/2,$);var J=40*h;t.font="".concat(26*h,"px arial");var K=t.measureText("抵制不良游戏，拒绝盗版游戏。注意自我保护，谨防受骗上当。"),q=(this.width-K.width)/2,z=this.height-250*h;t.fillStyle=s,t.fillText("抵制不良游戏，拒绝盗版游戏。注意自我保护，谨防受骗上当。",q,z+J),t.fillText("适度游戏益脑，沉迷游戏伤身。合理安排时间，享受健康生活。",q,z+2*J);var X=nt.index/2<<0,Y=nt.index%2;t.drawImage(c,nt.width*Y,nt.height*X,nt.width,nt.height,U*(this.width-65)-110+.98*(nt.width-nt.width*h),V-nt.height+15*h+(nt.height-nt.height*h),nt.width*h,nt.height*h);var Q=Date.now();if(Q-nt.lastUpdate>nt.delay)if(nt.lastUpdate=Q,nt.index<25)nt.index++;else nt.index=0}if(e){if(!et)et=e.createEmptyTexture(t.canvas.width,t.canvas.height,this.linearSampling,!1);e.clear(0,0,0,1),e.videoToTexture(t.canvas,et,!1),xf.drawGLImage(e,et,1,xf.Quad.createByRect(0,0,this.width,this.height)),e.present()}}catch(t){console.error(t)}},e.prototype.go_loading_finished=function(){this.start_first_layout()},e.prototype.start_first_layout=function(){if(this.start_time=Date.now(),this.last_fps_time=drama.performance_now(),this.isDebug)DebuggerInit(this);var t,e,i;if(this.isLoadBySection)this.isloading=!1;else if(this.uses_loader_layout&&!this.isLoadBySection){for(t=0,e=this.types_by_index.length;t<e;t++)if(!(i=this.types_by_index[t]).is_family&&!i.isOnLoaderLayout&&i.plugin.is_world&&i.preloadResource)i.onCreate(),drama.seal(i);this.xfStartLoad()}else this.isloading=!1;for(t=0,e=this.layouts_by_index.length;t<e;t++)this.layouts_by_index[t].createGlobalNonWorlds();if(2<=this.fullscreen_mode){var n=this.original_width/this.original_height,r=this.width/this.height;if(2!==this.fullscreen_mode&&n<r||2===this.fullscreen_mode&&r<n)this.aspect_scale=this.height/this.original_height;else this.aspect_scale=this.width/this.original_width}for(t=0,e=this.types_by_index.length;t<e;t++)if((i=this.types_by_index[t]).onBeforeAppBegin)i.onBeforeAppBegin();if(this.first_layout)this.layouts[this.first_layout].startRunning();else this.layouts_by_index[0].startRunning();if(assert2(this.running_layout,"Could not find first layout to start running"),!this.uses_loader_layout)if(this.loadingprogress=1,this.trigger(drama.system_object.prototype.cnds.OnLoadFinished,null),window.C3_RegisterSW)window.C3_RegisterSW();if(navigator.splashscreen&&navigator.splashscreen.hide)navigator.splashscreen.hide();for(t=0,e=this.types_by_index.length;t<e;t++)if((i=this.types_by_index[t]).onAppBegin)i.onAppBegin();var o=function(){if(document.hidden||document.webkitHidden||document.mozHidden||document.msHidden)window.cr_setSuspended(!0);else window.cr_setSuspended(!1)};if(document.addEventListener("visibilitychange",o,!1),document.addEventListener("mozvisibilitychange",o,!1),document.addEventListener("webkitvisibilitychange",o,!1),document.addEventListener("msvisibilitychange",o,!1),this.isCordova)document.addEventListener("pause",function(){window.cr_setSuspended(!0)}),document.addEventListener("resume",function(){window.cr_setSuspended(!1)});if(document.hidden||document.webkitHidden||document.mozHidden||document.msHidden)window.cr_setSuspended(!0);else this.tick(!1);if(this.isMinigame)this.isFirstLayOut=!0;t=0;for(var s=this.types_by_index.length;t<s;t++){var a=this.types_by_index[t];if(a.plugin.singleglobal&&a.instances&&0<a.instances.length&&a.instances[0].trigger)a.instances[0].trigger()}},e.prototype.tick=function(t,e,i){if(this.xfReport.report(),this.running_layout){if(window.TWEEN)TWEEN.update();var n=drama.performance_now(),r=n;if(i||!this.isSuspended||t){if(!t)if(d)this.raf_id=d(this.tickFunc);else this.timeout_id=setTimeout(this.tickFunc,this.isMobile?1:16);var o=e||n;if(!this.resuming_breakpoint){var s=this.fullscreen_mode,a=(document.mozFullScreen||document.webkitIsFullScreen||document.fullScreen||!!document.msFullscreenElement)&&!this.isCordova;if((a||this.isNodeFullscreen)&&0<this.fullscreen_scaling)s=this.fullscreen_scaling;if(0<s){var l=window.innerWidth,c=window.innerHeight;this.setSize(l,c)}if(a){if(!this.firstInFullscreen)this.firstInFullscreen=!0}else if(this.firstInFullscreen){if(this.firstInFullscreen=!1,0===this.fullscreen_mode)this.setSize(Math.round(this.oldWidth/this.devicePixelRatio),Math.round(this.oldHeight/this.devicePixelRatio),!0)}else this.oldWidth=this.width,this.oldHeight=this.height;if(this.isloading){var u=this.areAllTexturesAndSoundsLoaded();if(this.loadingprogress=this.progress,u)if(this.isloading=!1,this.trigger(drama.system_object.prototype.cnds.OnLoadFinished,null),window.C3_RegisterSW)window.C3_RegisterSW()}}if(this.logic(o),this.redraw&&!this.is_WebGL_context_lost&&!this.suspendDrawing&&!t){this.redraw=!1;var h=drama.performance_now();if(this.glwrap)this.drawGL();else this.draw();if(this.rendertime+=drama.performance_now()-h,this.snapshotCanvas){if(this.canvas&&this.canvas.toDataURL){if(this.snapshotData=this.canvas.toDataURL(this.snapshotCanvas[0],this.snapshotCanvas[1]),window.cr_onSnapshot)window.cr_onSnapshot(this.snapshotData);this.trigger(drama.system_object.prototype.cnds.OnCanvasSnapshot,null)}this.snapshotCanvas=null}}if(!this.hit_breakpoint)this.tickcount++,this.tickcount_nosave++,this.execcount++,this.framecount++;this.logictime+=drama.performance_now()-r}}},e.prototype.logic=function(t){var e,i,n,r,o,s,a,l,c;if(!this.resuming_breakpoint){if(1e3<=t-this.last_fps_time){if(this.last_fps_time+=1e3,1e3<=t-this.last_fps_time)this.last_fps_time=t;if(this.fps=this.framecount,this.framecount=0,this.cpuutilisation=Math.min(this.logictime,1e3),this.logictime=0,this.glwrap)if(0===this.gpuTimeEndFrame)this.gpuTimeEndFrame=this.glwrap.getFrameNumber(),this.gpuCurUtilisation=-1;if(this.isDebug){if(this.rendercpu=this.rendertime,this.rendertime=0,this.eventscpu=this.eventstime,this.eventstime=0,this.collisioncheck_sec=this.collisioncheck_count,this.collisioncheck_count=0,this.polycheck_sec=this.polycheck_count,this.polycheck_count=0,this.movedcell_sec=this.movedcell_count,this.movedcell_count=0,this.movedrendercell_sec=this.movedrendercell_count,this.movedrendercell_count=0,this.physics_cpu=drama.physics_cpu_time?drama.physics_cpu_time.sum:0,drama.physics_cpu_time)drama.physics_cpu_time.reset();var u,h,d=[];if(IsDebuggerProfiling())for(e=0,i=this.eventsheets_by_index.length;e<i;++e)if((u=this.eventsheets_by_index[e]).profile_last=u.profile_sum,(u.profile_sum=0)<u.profile_last)w(h={name:u.name,profile:u.profile_last},u),d.push(h);DebuggerPerfStats(this.fps,this.cpuutilisation,this.gpuLastUtilisation,this.glwrap?this.glwrap.estimateVRAM():-1,this.glwrap?"webgl":"canvas2d",this.objectcount,this.rendercpu,this.eventscpu,this.physics_cpu,d)}}if(this.glwrap&&-1===this.gpuCurUtilisation&&this.glwrap.supportsGpuProfiling())if(this.gpuCurUtilisation=this.glwrap.getFrameRangeTimerResults(this.gpuTimeStartFrame,this.gpuTimeEndFrame),-1!==this.gpuCurUtilisation)this.glwrap.deleteTimerResultsToFrame(this.gpuTimeEndFrame),this.gpuLastUtilisation=Math.min(this.gpuCurUtilisation,1),this.gpuTimeStartFrame=this.gpuTimeEndFrame,this.gpuTimeEndFrame=0;if(0!==this.last_tick_time){var p=t-this.last_tick_time;if(p<0)p=0;if(this.dt1=p/1e3,.5<this.dt1)this.dt1=0;else if(this.dt1>1/this.minimumFramerate)this.dt1=1/this.minimumFramerate}this.last_tick_time=t,this.dt=this.dt1*this.timescale,this.kahanTime.add(this.dt),this.wallTime.add(this.dt1);var f=(document.mozFullScreen||document.webkitIsFullScreen||document.fullScreen||!!document.msFullscreenElement||this.isNodeFullscreen)&&!this.isCordova;if(2<=this.fullscreen_mode||f&&0<this.fullscreen_scaling){var m=this.original_width/this.original_height,g=this.width/this.height,y=this.fullscreen_mode;if(f&&0<this.fullscreen_scaling)y=this.fullscreen_scaling;if(2!==y&&m<g||2===y&&g<m)this.aspect_scale=this.height/this.original_height;else this.aspect_scale=this.width/this.original_width;if(this.running_layout)this.running_layout.scrollToX(this.running_layout.scrollX),this.running_layout.scrollToY(this.running_layout.scrollY)}else this.aspect_scale=this.isRetina?this.devicePixelRatio:1;this.ClearDeathRow(),this.isInOnDestroy++,this.system.runWaits(),this.isInOnDestroy--,this.ClearDeathRow(),this.isInOnDestroy++;var v=this.objects_to_pretick.valuesRef();for(e=0,i=v.length;e<i;e++)v[e].pretick();for(e=0,i=this.types_by_index.length;e<i;e++)if(!(a=this.types_by_index[e]).is_family&&(a.behaviors.length||a.families.length))for(n=0,r=a.instances.length;n<r;n++)for(o=0,s=(l=a.instances[n]).behavior_insts.length;o<s;o++)l.behavior_insts[o].tick();for(e=0,i=this.types_by_index.length;e<i;e++)if(!(a=this.types_by_index[e]).is_family&&(a.behaviors.length||a.families.length))for(n=0,r=a.instances.length;n<r;n++)for(o=0,s=(l=a.instances[n]).behavior_insts.length;o<s;o++)if((c=l.behavior_insts[o]).posttick)c.posttick();for(e=0,i=(v=this.objects_to_tick.valuesRef()).length;e<i;e++){var b=v[e].slideType;if(b)switch(b){case"toPosition":v[e].slide_to_position();break;case"toInstance":v[e].slide_to_instance();break;case"toDistance":v[e].slide_to_distance();break;case"toDirection":v[e].slide_to_direction()}v[e].tick&&v[e].tick()}if(this.isInOnDestroy--,1==xf.gameInfo.gameType)this.handleSaveLoad();for(e=0;this.changelayout&&e++<10;)this.doChangeLayout(this.changelayout);for(e=0,i=this.eventsheets_by_index.length;e<i;e++)this.eventsheets_by_index[e].hasRun=!1;var _=drama.performance_now()}if(this.running_layout.event_sheet)this.running_layout.event_sheet.run();if(!this.hit_breakpoint){for(this.eventstime+=drama.performance_now()-_,drama.clearArray(this.registered_collisions),this.layout_first_tick=!1,this.isInOnDestroy++,e=0,i=this.types_by_index.length;e<i;e++)if(!(a=this.types_by_index[e]).is_family&&(a.behaviors.length||a.families.length))for(n=0,r=a.instances.length;n<r;n++)for(o=0,s=(l=a.instances[n]).behavior_insts.length;o<s;o++)if((c=l.behavior_insts[o]).tick2)c.tick2();for(e=0,i=(v=this.objects_to_tick2.valuesRef()).length;e<i;e++)v[e].tick2();this.isInOnDestroy--}},e.prototype.onWindowBlur=function(){var t,e,i,n,r,o,s,a,l;for(t=0,e=this.types_by_index.length;t<e;t++)if(!(s=this.types_by_index[t]).is_family)for(i=0,n=s.instances.length;i<n;i++){if((a=s.instances[i]).onWindowBlur)a.onWindowBlur();if(a.behavior_insts)for(r=0,o=a.behavior_insts.length;r<o;r++)if((l=a.behavior_insts[r]).onWindowBlur)l.onWindowBlur()}},e.prototype.doChangeLayout=function(t){var e,i,n,r=this.running_layout;if(this.running_layout.stopRunning(),this.glwrap)for(e=0,i=this.types_by_index.length;e<i;e++)if(!(n=this.types_by_index[e]).is_family)if(n.unloadTextures&&(!n.global||0===n.instances.length)&&-1===t.initial_types.indexOf(n))n.unloadTextures();if(r==t)drama.clearArray(this.system.waits);drama.clearArray(this.registered_collisions),this.runLayoutChangeMethods(!0),t.startRunning(),this.runLayoutChangeMethods(!1),e=0;for(var o=this.types_by_index.length;e<o;e++){var s=this.types_by_index[e];if(s.plugin.singleglobal&&s.instances&&0<s.instances.length&&s.instances[0].trigger)s.instances[0].trigger()}this.redraw=!0,this.layout_first_tick=!0,this.ClearDeathRow()},e.prototype.runLayoutChangeMethods=function(t){var e,i,n,r,o,s,a,l,c,u;for(e=0,i=this.behaviors.length;e<i;e++)if(n=this.behaviors[e],t){if(n.onBeforeLayoutChange)n.onBeforeLayoutChange()}else if(n.onLayoutChange)n.onLayoutChange();for(e=0,i=this.types_by_index.length;e<i;e++)if((r=this.types_by_index[e]).global||r.plugin.singleglobal)for(o=0,s=r.instances.length;o<s;o++){if(a=r.instances[o],t){if(a.onBeforeLayoutChange)a.onBeforeLayoutChange()}else if(a.onLayoutChange)a.onLayoutChange();if(a.behavior_insts)for(l=0,c=a.behavior_insts.length;l<c;l++)if(u=a.behavior_insts[l],t){if(u.onBeforeLayoutChange)u.onBeforeLayoutChange()}else if(u.onLayoutChange)u.onLayoutChange()}},e.prototype.pretickMe=function(t){this.objects_to_pretick.add(t)},e.prototype.unpretickMe=function(t){this.objects_to_pretick.remove(t)},e.prototype.tickMe=function(t){this.objects_to_tick.add(t)},e.prototype.untickMe=function(t){this.objects_to_tick.remove(t)},e.prototype.tick2Me=function(t){this.objects_to_tick2.add(t)},e.prototype.untick2Me=function(t){this.objects_to_tick2.remove(t)},e.prototype.getDt=function(t){if(!t||-1===t.my_timescale)return this.dt;else return this.dt1*t.my_timescale},e.prototype.draw=function(){if(!this.isMinigame||!this.isloading){this.running_layout.draw(this.ctx);var t=this.drawlist;if(t)for(var e=0,i=t.length;e<i;e++)t[e].draw(this.ctx,this);DebuggerShowInspectInstance()}},e.prototype.drawGL=function(){if(!this.isMinigame||!this.isloading){var t=this.glwrap;if(this.enableFrontToBack)this.earlyz_index=1,this.running_layout.drawGL_earlyZPass(t);this.running_layout.drawGL(t),t.resetModelView(),t.switchProgram(0),t.translate(this.width/-2,this.height/-2),t.scale(this.aspect_scale,this.aspect_scale),t.updateModelView();var e=this.drawlist;if(e)for(var i=0,n=e.length;i<n;i++)e[i].drawGL(t,this);DebuggerShowInspectInstance(),t.present()}},e.prototype.addDestroyCallback=function(t){if(t)this.destroycallbacks.push(t)},e.prototype.removeDestroyCallback=function(t){drama.arrayFindRemove(this.destroycallbacks,t)},e.prototype.getObjectByUID=function(t){assert2(!this.isLoadingState,"Do not call getObjectByUID in loadFromJSON: wait until afterLoad() to look up");var e=t.toString();if(this.objectsByUid.hasOwnProperty(e))return this.objectsByUid[e];else return null};var p=[];e.prototype.DestroyInstance=function(t){var e,i,n=t.type.name,r=null;if(this.deathRow.hasOwnProperty(n)){if((r=this.deathRow[n]).contains(t))return}else r=function(){if(p.length)return p.pop();else return new drama.ObjectSet}(),this.deathRow[n]=r;if(t.slideStopMove=!0,t.isDestroyed=!0,t.isClone=!1,r.add(t),this.hasPendingInstances=!0,t.is_contained)for(e=0,i=t.siblings.length;e<i;e++)this.DestroyInstance(t.siblings[e]);if(this.isInClearDeathRow)r.values_cache.push(t);if(!this.isEndingLayout)this.isInOnDestroy++,this.trigger(Object.getPrototypeOf(t.type.plugin).cnds.OnDestroyed,t),this.isInOnDestroy--},e.prototype.ClearDeathRow=function(){if(this.hasPendingInstances){var t,e,i,n,r,o;for(this.isInClearDeathRow=!0,i=0,r=this.createRow.length;i<r;++i)for((e=(t=this.createRow[i]).type).instances.push(t),n=0,o=e.families.length;n<o;++n)e.families[n].instances.push(t),e.families[n].stale_iids=!0;drama.clearArray(this.createRow),this.IterateDeathRow(),drama.wipe(this.deathRow),this.isInClearDeathRow=!1,this.hasPendingInstances=!1}},e.prototype.IterateDeathRow=function(){for(var t in this.deathRow)if(this.deathRow.hasOwnProperty(t))this.ClearDeathRowForType(this.deathRow[t])},e.prototype.ClearDeathRowForType=function(t){var e=t.valuesRef();assert2(e.length,"empty object list to destroy");var i,n,r,o,s,a,l,c,u=e[0].type;if(assert2(u,"missing type when destroying objects"),assert2(t,"missing object set"),drama.arrayRemoveAllFromObjectSet(u.instances,t),u.stale_iids=!0,0===u.instances.length)u.any_instance_parallaxed=!1;for(i=0,n=u.families.length;i<n;++i)a=u.families[i],drama.arrayRemoveAllFromObjectSet(a.instances,t),a.stale_iids=!0;for(i=0,n=this.system.waits.length;i<n;++i){if((s=this.system.waits[i]).sols.hasOwnProperty(u.index))drama.arrayRemoveAllFromObjectSet(s.sols[u.index].insts,t);if(!u.is_family)for(r=0,o=u.families.length;r<o;++r)if(a=u.families[r],s.sols.hasOwnProperty(a.index))drama.arrayRemoveAllFromObjectSet(s.sols[a.index].insts,t)}var h,d=e[0].layer;if(d){if(d.useRenderCells)for(i=0,n=(l=d.instances).length;i<n;++i)if(c=l[i],t.contains(c))c.update_bbox(),d.render_grid.update(c,c.rendercells,null),c.rendercells.set(0,0,-1,-1);drama.arrayRemoveAllFromObjectSet(d.instances,t),d.setZIndicesStaleFrom(0)}for(i=0;i<e.length;++i)this.ClearDeathRowForSingleInstance(e[i],u);(h=t).clear(),p.push(h),this.redraw=!0},e.prototype.ClearDeathRowForSingleInstance=function(t,e){var i,n,r;for(i=0,n=this.destroycallbacks.length;i<n;++i)this.destroycallbacks[i](t);if(t.collcells)e.collision_grid.update(t,t.collcells,null);var o=t.layer;if(o)o.removeFromInstanceList(t,!0);if(t.behavior_insts)for(i=0,n=t.behavior_insts.length;i<n;++i){if((r=t.behavior_insts[i]).onDestroy)r.onDestroy();r.behavior.my_instances.remove(t)}if(this.objects_to_pretick.remove(t),this.objects_to_tick.remove(t),this.objects_to_tick2.remove(t),t.onDestroy)t.onDestroy();if(this.objectsByUid.hasOwnProperty(t.uid.toString()))delete this.objectsByUid[t.uid.toString()];if(this.objectcount--,e.deadCache.length<100)e.deadCache.push(t);if(this.isDebug)DebuggerInstanceDestroyed(t)},e.prototype.createInstance=function(t,e,i,n,r,o){if(t.is_family){var s=drama.floor(Math.random()*t.members.length);return this.createInstance(t.members[s],e,i,n,o)}if(!t.default_instance){var a=this.getObjectBankDefaultInstance(t);if(!a)return alert(t.name+"': 对象至少需要一个实例"),null;else t.default_instance=a}return this.createInstanceFromInit(t.default_instance,e,!1,i,n,!1,r,o)},e.prototype.getObjectBankDefaultInstance=function(t){return this.objectBankInstancMap[t.name]};var S=[];e.prototype.createInstanceFromInit=function(t,e,i,n,r,o,s,a){var l,c,u,h,d;if(!t)return null;var p=this.types_by_index[t[1]];if(a||p.preloadResource){assert2(p,"Cannot find object type '"+t[1]+"'"),assert2(!p.is_family,"Cannot directly create an instance from a family type");var f=p.plugin.is_world;if(assert2(!f||e,"Creating world instance without specifying layer"),this.isloading&&f&&!p.isOnLoaderLayout)return null;if(f&&!this.glwrap&&11===t[0][11])return null;var m,g=e;if(!f)e=null;if(p.deadCache.length)(m=p.deadCache.pop()).recycled=!0,p.plugin.Instance.call(m,p);else(m=new p.plugin.Instance(p)).recycled=!1;if(i&&!o&&!this.objectsByUid.hasOwnProperty(t[2].toString()))m.uid=t[2];else m.uid=this.next_uid++;for((this.objectsByUid[m.uid.toString()]=m).puid=this.next_puid++,m.iid=p.instances.length,l=0,c=this.createRow.length;l<c;++l)if(this.createRow[l].type===p)m.iid++;m.get_iid=drama.inst_get_iid,m.toString=drama.inst_toString,m.isDestroyed=!1;var y,v,b=t[3];if(m.recycled)drama.wipe(m.extra);else{for(m.extra={},m.instance_var_names=[],m.instance_var_names.length=b.length,l=0,c=b.length;l<c;l++)m.instance_var_names[l]=b[l][1];m.instance_vars=[],m.instance_vars.length=b.length,m.instance_initial_vars=[],m.instance_initial_vars.length=b.length}for(l=0,c=b.length;l<c;l++)m.instance_vars[l]=b[l][0],m.instance_initial_vars[l]=b[l][0];if(f){var _=t[0];if(assert2(_,"World instance info missing"),m.x=drama.is_undefined(n)?_[0]:n,m.y=drama.is_undefined(r)?_[1]:r,m.z=_[2],m.width=_[3],m.height=_[4],m.depth=_[5],m.angle=_[6],m.opacity=_[7],m.hotspotX=_[8],m.hotspotY=_[9],m.blend_mode=_[10],d=_[11],m.solidStop=_[14],!this.glwrap&&p.effect_types.length)m.blend_mode=d;if(m.compositeOp=drama.effectToCompositeOp(m.blend_mode),this.gl)drama.setGLBlend(m,m.blend_mode,this.gl);if(m.recycled){for(l=0,c=_[12].length;l<c;l++)for(u=0,h=_[12][l].length;u<h;u++)if(m.effect_params[l][u]=_[12][l][u],Array.isArray(m.effect_params[l][u]))m.effect_params[l][u]=m.effect_params[l][u].slice(0);m.bbox.set(0,0,0,0),m.collcells.set(0,0,-1,-1),m.rendercells.set(0,0,-1,-1),m.bquad.set_from_rect(m.bbox),drama.clearArray(m.bbox_changed_callbacks)}else{for(m.effect_params=_[12].slice(0),l=0,c=m.effect_params.length;l<c;l++)for(m.effect_params[l]=_[12][l].slice(0),u=0,h=m.effect_params[l].length;u<h;++u)if(Array.isArray(m.effect_params[l][u]))m.effect_params[l][u]=m.effect_params[l][u].slice(0);m.active_effect_types=[],m.active_effect_flags=[],m.active_effect_flags.length=p.effect_types.length,m.bbox=new drama.rect(0,0,0,0),m.collcells=new drama.rect(0,0,-1,-1),m.rendercells=new drama.rect(0,0,-1,-1),m.bquad=new drama.quad,m.bbox_changed_callbacks=[],m.set_bbox_changed=drama.set_bbox_changed,m.add_bbox_changed_callback=drama.add_bbox_changed_callback,m.remove_bbox_changed_callback=drama.remove_bbox_changed_callback,m.contains_pt=drama.inst_contains_pt,m.update_bbox=drama.update_bbox,m.update_render_cell=drama.update_render_cell,m.update_collision_cell=drama.update_collision_cell,m.get_zindex=drama.inst_get_zindex,m.slide_to_position=drama.slide_to_position,m.slide_to_instance=drama.slide_to_instance,m.slide_to_distance=drama.slide_to_distance,m.slide_to_direction=drama.slide_to_direction,m.slide_to_target=drama.slide_to_target,m.move_with_acceleration=drama.move_with_acceleration,m.test_overlap_solid=drama.test_overlap_solid}for(l=0,c=p.effect_types.length;l<c;l++)m.active_effect_flags[l]=!0;if(m.shaders_preserve_opaqueness=!0,m.updateActiveEffects=drama.inst_updateActiveEffects,m.updateActiveEffects(),m.uses_shaders=!!m.active_effect_types.length,m.bbox_changed=!0,m.cell_changed=!0,p.any_cell_changed=!0,m.visible=!0,m.my_timescale=-1,m.layer=e,m.zindex=e.instances.length,void(m.earlyz_index=0)===m.collision_poly)m.collision_poly=null;m.collisionsEnabled=!0,this.redraw=!0}if(p.plugin.is_slide)m.slideSpeed=0,m.slideAcceleration=0,m.slideAngle=0,m.slideDistance=0,m.slideSourceX=m.x,m.slideSourceY=m.y,m.slideTargetX=0,m.slideTargetY=0,m.isDistance=!1,m.isReached=!1,m.remainDistance=drama.inst_get_remain_distance,m.moveDistance=drama.inst_move_distance;if(s)m.isClone=!0;for(m.scrollIndex=t[6],drama.clearArray(S),l=0,c=p.families.length;l<c;l++)S.push.apply(S,p.families[l].behaviors);if(S.push.apply(S,p.behaviors),y=t[5],m.recycled)for(l=0,c=y.length;l<c;l++)m.properties[l]=y[l];else m.properties=y.slice(0);if(this.createRow.push(m),this.hasPendingInstances=!0,e)if(assert2(f,"Adding non-world instance to layer"),e.appendToInstanceList(m,!0),1!==e.parallaxX||1!==e.parallaxY)p.any_instance_parallaxed=!0;if(this.objectcount++,p.is_contained){if(m.is_contained=!0,m.recycled)drama.clearArray(m.siblings);else m.siblings=[];if(!i&&!o){for(l=0,c=p.container.length;l<c;l++)if(p.container[l]!==p){if(!p.container[l].default_instance)return alert("Cannot create an instance of the object type '"+p.container[l].name+"': there are no instances of this object anywhere in the project.  Construct 3 needs at least one instance to know which properties to assign to the object.  To resolve this, add at least one instance of the object to the project, on an unused layout if necessary."),null;m.siblings.push(this.createInstanceFromInit(p.container[l].default_instance,g,!1,f?m.x:n,f?m.y:r,!0))}for(l=0,c=m.siblings.length;l<c;l++)for(m.siblings[l].siblings.push(m),u=0;u<c;u++)if(l!==u)m.siblings[l].siblings.push(m.siblings[u])}}else m.is_contained=!1,m.siblings=null;if(m.onCreate(),m.recycled)for(l=0,c=S.length;l<c;l++){var w=S[l];for((v=m.behavior_insts[l]).recycled=!0,w.behavior.Instance.call(v,w,m),u=0,h=(y=t[4][l]).length;u<h;u++)v.properties[u]=y[u];v.onCreate(),w.behavior.my_instances.add(m)}else{m.behavior_insts=[];var x=[];for(l=0,c=S.length;l<c;l++)if((v=new(w=S[l]).behavior.Instance(w,m)).recycled=!1,v.properties=t[4][l].slice(0),v.onCreate(),drama.seal(v),drama.behaviors.Scroll&&v.behavior instanceof drama.behaviors.Scroll)x.push({binst:v,btype:w});else m.behavior_insts.push(v),w.behavior.my_instances.add(m);for(l=0,c=x.length;l<c;l++)if(v=x[l].binst,w=x[l].btype,!m.scrollIndex||l==m.scrollIndex)m.behavior_insts.push(v),w.behavior.my_instances.add(m)}if(!m.recycled)drama.seal(m);for(l=0,c=m.behavior_insts.length;l<c;l++)if(m.behavior_insts[l].postCreate)m.behavior_insts[l].postCreate();if(this.isDebug)DebuggerInstanceCreated(m);return m}},e.prototype.getLayerByName=function(t){var e,i;for(e=0,i=this.running_layout.layers.length;e<i;e++){var n=this.running_layout.layers[e];if(drama.equals_nocase(n.name,t))return n}return null},e.prototype.getLayerByNumber=function(t){if((t=drama.floor(t))<0)t=0;if(t>=this.running_layout.layers.length)t=this.running_layout.layers.length-1;return this.running_layout.layers[t]},e.prototype.getLayer=function(t){if(drama.is_number(t))return this.getLayerByNumber(t);else return this.getLayerByName(t.toString())},e.prototype.clearSol=function(t){var e,i;for(e=0,i=t.length;e<i;e++)t[e].getCurrentSol().select_all=!0},e.prototype.pushCleanSol=function(t){var e,i;for(e=0,i=t.length;e<i;e++)t[e].pushCleanSol()},e.prototype.pushCopySol=function(t){var e,i;for(e=0,i=t.length;e<i;e++)t[e].pushCopySol()},e.prototype.popSol=function(t){var e,i;for(e=0,i=t.length;e<i;e++)t[e].popSol()},e.prototype.updateAllCells=function(t){if(t.any_cell_changed){var e,i,n=t.instances;for(e=0,i=n.length;e<i;++e)if(n[e]&&n[e].update_collision_cell)n[e].update_collision_cell();var r=this.createRow;for(e=0,i=r.length;e<i;++e)if(r[e]&&r[e].update_collision_cell&&r[e].type===t)r[e].update_collision_cell();t.any_cell_changed=!1}},e.prototype.getCollisionCandidates=function(t,e,i,n){var r,o,s,a=t?1!==t.parallaxX||1!==t.parallaxY:!1;if(e.is_family)for(r=0,o=e.members.length;r<o;++r)if(s=e.members[r],a||s.any_instance_parallaxed)drama.appendArray(n,s.instances);else this.updateAllCells(s),s.collision_grid.queryRange(i,n);else if(a||e.any_instance_parallaxed)drama.appendArray(n,e.instances);else this.updateAllCells(e),e.collision_grid.queryRange(i,n)},e.prototype.getTypesCollisionCandidates=function(t,e,i,n){var r,o;for(r=0,o=e.length;r<o;++r)this.getCollisionCandidates(t,e[r],i,n)},e.prototype.getSolidCollisionCandidates=function(t,e,i){var n=this.getSolidBehavior();if(!n)return null;this.getTypesCollisionCandidates(t,n.my_types,e,i)},e.prototype.getJumpthruCollisionCandidates=function(t,e,i){var n=this.getJumpthruBehavior();if(!n)return null;this.getTypesCollisionCandidates(t,n.my_types,e,i)},e.prototype.testAndSelectCanvasPointOverlap=function(t,e,i,n){var r,o,s,a,l,c=t.getCurrentSol(),u=this.getCurrentEventStack().current_event.orblock;if(c.select_all){if(!n)c.select_all=!1,drama.clearArray(c.instances);for(r=0,a=t.instances.length;r<a;r++)if((s=t.instances[r]).update_bbox(),xf.checkTouchable(s,e,i))if(n)return!1;else c.instances.push(s);else if(u)c.else_instances.push(s)}else{for(r=o=0,a=(l=u?c.else_instances:c.instances).length;r<a;r++)if((s=l[r]).update_bbox(),xf.checkTouchable(s,e,i))if(n)return!1;else if(u)c.instances.push(s);else c.instances[o]=c.instances[r],o++;if(!n)l.length=o}if(t.applySolToContainer(),n)return!0;else return c.hasObjects()},e.prototype.testOverlap=function(t,e){if(!(t&&e&&t.visible&&e.visible&&t!==e&&t.collisionsEnabled&&e.collisionsEnabled))return!1;var i=t.layer.collisionIndex+""+e.layer.collisionIndex,n=this.groupCollisionMap[this.running_layout.name];if(!n||n[i]){this.collisioncheck_count++,t.update_bbox(),e.update_bbox();var r=t.layer,o=e.layer;if(!(r!==o&&(r.parallaxX!==o.parallaxX||r.parallaxY!==o.parallaxY||r.scale!==o.scale||r.angle!==o.angle||r.zoomRate!==o.zoomRate)))return this.testOverlapSameLayer(t,e);else return this.testOverlapDifferentLayer(t,e)}},e.prototype.testOverlapSameLayer=function(t,e){var i,n,r,o;if(t.tilemap_exists&&e.tilemap_exists)return!1;if(t.collision_circle)t.collision_circle.cache_circle(t.width,t.height,t.angle);if(e.collision_circle)e.collision_circle.cache_circle(e.width,e.height,e.angle);if(t.collision_circle&&e.collision_circle)return t.collision_circle.intersects_circle(e.collision_circle,e.x-t.x,e.y-t.y);else if(t.collision_circle){if(t.setCircleRectQuad&&t.setCircleRectQuad(),!t.circleBox.intersects_rect(e.bbox))return!1;if(this.polycheck_count++,!t.circleQuad.intersects_quad(e.bquad))return!1}else if(e.collision_circle){if(e.setCircleRectQuad&&e.setCircleRectQuad(),!t.bbox.intersects_rect(e.circleBox))return!1;if(this.polycheck_count++,!t.bquad.intersects_quad(e.circleQuad))return!1}else{if(!t.bbox.intersects_rect(e.bbox))return!1;if(this.polycheck_count++,!t.bquad.intersects_quad(e.bquad))return!1}if(i=t.collision_poly&&!t.collision_poly.is_empty(),n=e.collision_poly&&!e.collision_poly.is_empty(),!t.collision_circle)if(i)t.collision_poly.cache_poly(t.width,t.height,t.angle),r=t.collision_poly;else this.temp_poly.set_from_quad(t.bquad,t.x,t.y,t.width,t.height),r=this.temp_poly;if(!e.collision_circle)if(n)e.collision_poly.cache_poly(e.width,e.height,e.angle),o=e.collision_poly;else this.temp_poly.set_from_quad(e.bquad,e.x,e.y,e.width,e.height),o=this.temp_poly;if(t.tilemap_exists)return this.testTilemapOverlap(t,e);if(e.tilemap_exists)return this.testTilemapOverlap(e,t);if(t.collision_circle||e.collision_circle){if(t.collision_circle)return o.intersects_poly_circle(t.collision_circle,t.x-e.x,t.y-e.y);if(e.collision_circle)return r.intersects_poly_circle(e.collision_circle,e.x-t.x,e.y-t.y)}else if(!i&&!n)return!0;else return r.intersects_poly(o,e.x-t.x,e.y-t.y)},e.prototype.testOverlapDifferentLayer=function(t,e){var i,n,r,o,s,a,l,c,u,h,d=t.layer,p=e.layer;if(l=t.collision_poly&&!t.collision_poly.is_empty(),c=e.collision_poly&&!e.collision_poly.is_empty(),!t.collision_circle){if(l)t.collision_poly.cache_poly(t.width,t.height,t.angle),this.temp_poly.set_from_poly(t.collision_poly);else this.temp_poly.set_from_quad(t.bquad,t.x,t.y,t.width,t.height);u=this.temp_poly}if(!e.collision_circle){if(c)e.collision_poly.cache_poly(e.width,e.height,e.angle),this.temp_poly2.set_from_poly(e.collision_poly);else this.temp_poly2.set_from_quad(e.bquad,e.x,e.y,e.width,e.height);h=this.temp_poly2}if(u&&h){for(i=0,n=u.pts_count;i<n;i++)o=(r=2*i)+1,s=u.pts_cache[r],a=u.pts_cache[o],u.pts_cache[r]=d.layerToCanvas(s+t.x,a+t.y,!0),u.pts_cache[o]=d.layerToCanvas(s+t.x,a+t.y,!1);for(u.update_bbox(),i=0,n=h.pts_count;i<n;i++)o=(r=2*i)+1,s=h.pts_cache[r],a=h.pts_cache[o],h.pts_cache[r]=p.layerToCanvas(s+e.x,a+e.y,!0),h.pts_cache[o]=p.layerToCanvas(s+e.x,a+e.y,!1);if(h.update_bbox(),this.polycheck_count++,t.collision_circle)t.collision_circle.cache_circle(t.width,t.height,t.angle),s=t.collision_circle.pts_cache[0],a=t.collision_circle.pts_cache[1],t.collision_circle.pts_cache[0]=d.layerToCanvas(s+t.x,a+t.y,!0),t.collision_circle.pts_cache[1]=d.layerToCanvas(a+t.x,a+t.y,!1);if(e.collision_circle)e.collision_circle.cache_circle(e.width,e.height,e.angle),s=e.collision_circle.pts_cache[0],a=e.collision_circle.pts_cache[1],e.collision_circle.pts_cache[0]=d.layerToCanvas(s+e.x,a+e.y,!0),e.collision_circle.pts_cache[1]=d.layerToCanvas(s+e.x,a+e.y,!1);if(t.collision_circle&&e.collision_circle)return t.collision_circle.intersects_circle(e.collision_circle,0,0);if(t.collision_circle||e.collision_circle){if(t.collision_circle)return h.intersects_poly_circle(t.collision_circle,0,0);if(e.collision_circle)return u.intersects_poly_circle(e.collision_circle,0,0)}return u.intersects_poly(h,0,0)}};var f=new drama.quad,m=new drama.rect(0,0,0,0),g=[];e.prototype.testTilemapOverlap=function(t,e){var i=e.bbox;t.clipCollisionPoly();var n=e.collision_poly&&!e.collision_poly.is_empty(),r=t.collision_polys&&0<t.collision_polys.length;if(e.collision_circle&&r)for(var o=t.collision_polys,s=0,a=o.length;s<a;s++){if(o[s].intersects_poly_circle(e.collision_circle,e.x-t.x,e.y-t.y))return!0}else if(n&&r)if(i.intersects_rect_off(t.bbox,0,0)){e.collision_poly.cache_poly(e.width,e.height,e.angle);for(var l=t.collision_polys,c=0,u=l.length;c<u;c++){if(l[c].intersects_poly(e.collision_poly,e.x-t.x,e.y-t.y))return!0}}return!1},e.prototype.testRectOverlap=function(t,e){if(!e||!e.collisionsEnabled)return!1;if(this.collisioncheck_count++,e.update_bbox(),!e.bbox.intersects_rect(t))return!1;if(e.tilemap_exists){e.getCollisionRectCandidates(t,g);var i,n,r,o,s=g,a=e.x,l=e.y;for(i=0,n=s.length;i<n;++i)if(o=(r=s[i]).rc,this.collisioncheck_count++,t.intersects_rect_off(o,a,l))if(r.poly){if(this.polycheck_count++,this.temp_poly.set_from_rect(t,0,0),r.poly.intersects_poly(this.temp_poly,-(a+o.left),-(l+o.top)))return drama.clearArray(g),!0}else return drama.clearArray(g),!0;return drama.clearArray(g),!1}else{if(this.polycheck_count++,f.set_from_rect(t),!e.bquad.intersects_quad(f))return!1;if(!(e.collision_poly&&!e.collision_poly.is_empty()))return!0;else return e.collision_poly.cache_poly(e.width,e.height,e.angle),f.offset(-t.left,-t.top),this.temp_poly.set_from_quad(f,0,0,1,1),e.collision_poly.intersects_poly(this.temp_poly,t.left-e.x,t.top-e.y)}},e.prototype.testSegmentOverlap=function(t,e,i,n,r){if(!r||!r.collisionsEnabled)return!1;if(this.collisioncheck_count++,r.update_bbox(),m.set(drama.min(t,i),drama.min(e,n),drama.max(t,i),drama.max(e,n)),!r.bbox.intersects_rect(m))return!1;if(r.tilemap_exists){r.getCollisionRectCandidates(m,g);var o,s,a,l,c=g,u=r.x,h=r.y;for(o=0,s=c.length;o<s;++o)if(l=(a=c[o]).rc,this.collisioncheck_count++,m.intersects_rect_off(l,u,h))if(this.polycheck_count++,f.set_from_rect(l),f.offset(u,h),f.intersects_segment(t,e,i,n))if(a.poly){if(a.poly.intersects_segment(u+l.left,h+l.top,t,e,i,n))return drama.clearArray(g),!0}else return drama.clearArray(g),!0;return drama.clearArray(g),!1}else{if(this.polycheck_count++,!r.bquad.intersects_segment(t,e,i,n))return!1;if(!(r.collision_poly&&!r.collision_poly.is_empty()))return!0;else return r.collision_poly.cache_poly(r.width,r.height,r.angle),r.collision_poly.intersects_segment(r.x,r.y,t,e,i,n)}},e.prototype.typeHasBehavior=function(t,e){if(!e)return!1;var i,n,r,o,s;for(i=0,n=t.behaviors.length;i<n;i++)if(t.behaviors[i].behavior instanceof e)return!0;if(!t.is_family)for(i=0,n=t.families.length;i<n;i++)for(r=0,o=(s=t.families[i]).behaviors.length;r<o;r++)if(s.behaviors[r].behavior instanceof e)return!0;return!1},e.prototype.typeHasNoSaveBehavior=function(t){return this.typeHasBehavior(t,drama.behaviors.NoSave)},e.prototype.typeHasPersistBehavior=function(t){return this.typeHasBehavior(t,drama.behaviors.Persist)},e.prototype.getSolidBehavior=function(){return this.solidBehavior},e.prototype.getJumpthruBehavior=function(){return this.jumpthruBehavior};var a=[];e.prototype.testOverlapSolid=function(t){var e,i,n;if(!t.solidStop)return null;for(t.update_bbox(),this.getSolidCollisionCandidates(t.layer,t.bbox,a),e=0,i=a.length;e<i;++e)if((n=a[e]).extra.solidEnabled)if(this.testOverlap(t,n))return drama.clearArray(a),n;return drama.clearArray(a),null},e.prototype.testRectOverlapSolid=function(t){var e,i,n;for(this.getSolidCollisionCandidates(null,t,a),e=0,i=a.length;e<i;++e)if((n=a[e]).extra.solidEnabled)if(this.testRectOverlap(t,n))return drama.clearArray(a),n;return drama.clearArray(a),null};var l=[];e.prototype.testOverlapJumpThru=function(t,e){var i,n,r,o=null;if(e)o=l,drama.clearArray(o);for(t.update_bbox(),this.getJumpthruCollisionCandidates(t.layer,t.bbox,a),i=0,n=a.length;i<n;++i)if((r=a[i]).extra.jumpthruEnabled)if(this.testOverlap(t,r))if(e)o.push(r);else return drama.clearArray(a),r;return drama.clearArray(a),o},e.prototype.pushOutSolid=function(t,e,i,n,r,o){var s,a=n||50,l=t.x,c=t.y,u=null,h=null;for(s=0;s<a;s++)if(t.x=l+e*s,t.y=c+i*s,t.set_bbox_changed(),!this.testOverlap(t,u)){if(u=this.testOverlapSolid(t))h=u;if(!u){if(r){if(o)u=this.testOverlap(t,o)?o:null;else u=this.testOverlapJumpThru(t);if(u)h=u}if(!u){if(h)this.pushInFractional(t,e,i,h,16);return!0}}}return t.x=l,t.y=c,t.set_bbox_changed(),!1},e.prototype.pushOutSolidAxis=function(t,e,i,n){n=n||50;var r,o,s,a=t.x,l=t.y,c=null,u=null;for(r=0;r<n;++r)for(o=0;o<2;++o)if(s=2*o-1,t.x=a+e*r*s,t.y=l+i*r*s,t.set_bbox_changed(),!this.testOverlap(t,c))if(c=this.testOverlapSolid(t))u=c;else{if(u)this.pushInFractional(t,e*s,i*s,u,16);return!0}return t.x=a,t.y=l,t.set_bbox_changed(),!1},e.prototype.pushOut=function(t,e,i,n,r){var o,s=n||50,a=t.x,l=t.y;for(o=0;o<s;o++)if(t.x=a+e*o,t.y=l+i*o,t.set_bbox_changed(),!this.testOverlap(t,r))return!0;return t.x=a,t.y=l,t.set_bbox_changed(),!1},e.prototype.pushInFractional=function(t,e,i,n,r){for(var o,s=2,a=!1,l=!1,c=t.x,u=t.y;s<=r;)if(o=1/s,s*=2,t.x+=e*o*(a?1:-1),t.y+=i*o*(a?1:-1),t.set_bbox_changed(),this.testOverlap(t,n))l=a=!0;else l=a=!1,c=t.x,u=t.y;if(l)t.x=c,t.y=u,t.set_bbox_changed()},e.prototype.pushOutSolidNearest=function(t,e){var i=drama.is_undefined(e)?100:Math.abs(e),n=0,r=t.x,o=t.y,s=0,a=0,l=0,c=this.testOverlapSolid(t);if(!c)return!0;for(;n<=i;){switch(s){case 0:a=0,l=-1,n++;break;case 1:l=-(a=1);break;case 2:a=1,l=0;break;case 3:l=a=1;break;case 4:a=0,l=1;break;case 5:a=-1,l=1;break;case 6:a=-1,l=0;break;case 7:l=a=-1}if(s=(s+1)%8,t.x=drama.floor(r+a*n),t.y=drama.floor(o+l*n),t.set_bbox_changed(),!this.testOverlap(t,c))if(!(c=this.testOverlapSolid(t)))return!0}return t.x=r,t.y=o,t.set_bbox_changed(),!1},e.prototype.registerCollision=function(t,e){if(t.collisionsEnabled&&e.collisionsEnabled)this.registered_collisions.push([t,e])},e.prototype.addRegisteredCollisionCandidates=function(t,e,i){var n,r,o,s;for(n=0,r=this.registered_collisions.length;n<r;++n){if(s=null,(o=this.registered_collisions[n])[0]===t)s=o[1];else if(o[1]===t)s=o[0];else continue;if(e.is_family){if(-1===e.members.indexOf(e))continue}else if(s.type!==e)continue;if(-1===i.indexOf(s))i.push(s)}},e.prototype.checkRegisteredCollision=function(t,e){var i,n,r;for(i=0,n=this.registered_collisions.length;i<n;i++)if((r=this.registered_collisions[i])[0]===t&&r[1]===e||r[0]===e&&r[1]===t)return!0;return!1},e.prototype.calculateSolidBounceAngle=function(t,e,i,n){var r=t.x,o=t.y,s=drama.max(10,drama.distanceTo(e,i,r,o)),a=drama.angleTo(e,i,r,o),l=n||this.testOverlapSolid(t);if(!l)return drama.clamp_angle(a+drama.PI);var c,u,h,d,p=l,f=drama.to_radians(5);for(c=1;c<36;c++)if(u=a-c*f,t.x=e+Math.cos(u)*s,t.y=i+Math.sin(u)*s,t.set_bbox_changed(),!this.testOverlap(t,p))if(!(p=n?null:this.testOverlapSolid(t))){h=u;break}if(36===c)h=drama.clamp_angle(a+drama.PI);for(p=l,c=1;c<36;c++)if(u=a+c*f,t.x=e+Math.cos(u)*s,t.y=i+Math.sin(u)*s,t.set_bbox_changed(),!this.testOverlap(t,p))if(!(p=n?null:this.testOverlapSolid(t))){d=u;break}if(36===c)d=drama.clamp_angle(a+drama.PI);if(t.x=r,t.y=o,t.set_bbox_changed(),d===h)return d;var m,g=drama.angleDiff(d,h)/2;if(drama.angleClockwise(d,h))m=drama.clamp_angle(h+g+drama.PI);else m=drama.clamp_angle(d+g);assert2(!isNaN(m),"Bounce normal computed as NaN");var y=Math.cos(a),v=Math.sin(a),b=Math.cos(m),_=Math.sin(m),w=y*b+v*_,x=y-2*w*b,S=v-2*w*_;return drama.angleTo(0,0,x,S)};var y=-1;function c(){if(drama.logexport("Reloading for continuous preview"),-1<window.location.search.indexOf("continuous"))window.location.reload(!0);else window.location=window.location+"?continuous"}function v(t){var e,i={};for(e in t)if(t.hasOwnProperty(e)){if(t[e]instanceof drama.ObjectSet)continue;if(t[e]&&void 0!==t[e].c2userdata)continue;if("spriteCreatedDestroyCallback"===e)continue;i[e]=t[e]}return i}e.prototype.trigger=function(t,e,i){if(assert2(!drama.is_string(t),"trigger() no longer accepts a string argument as of r51"),!this.running_layout)return!1;var n=this.running_layout.event_sheet;if(!n)return!1;var r,o,s,a=!1;y++;var l=n.deep_includes;for(o=0,s=l.length;o<s;++o)r=this.triggerOnSheet(t,e,l[o],i),a=a||r;return r=this.triggerOnSheet(t,e,n,i),y--,a=a||r},e.prototype.triggerOnSheet=function(t,e,i,n){var r,o,s,a,l=!1;if(!e)s=this.triggerOnSheetForTypeName(t,e,"system",i,n),l=l||s;else for(s=this.triggerOnSheetForTypeName(t,e,e.type.name,i,n),l=l||s,r=0,o=(a=e.type.families).length;r<o;++r)s=this.triggerOnSheetForTypeName(t,e,a[r].name,i,n),l=l||s;return l},e.prototype.triggerOnSheetForTypeName=function(t,e,i,n,r){var o,s,a,l,c=!1,u=!1,h=void 0!==r,d=(h?n.fasttriggers:n.triggers)[i];if(!d)return c;var p,f=null;for(o=0,s=d.length;o<s;++o)if(d[o].method==t){f=d[o].evs;break}if(!f)return c;if(h)p=f[r];else p=f;if(!p)return null;for(o=0,s=p.length;o<s;o++)a=p[o][0],l=p[o][1],u=this.executeSingleTrigger(e,i,a,l),c=c||u;return c},e.prototype.executeSingleTrigger=function(t,e,i,n){var r,o,s=!1;this.trigger_depth++;var a=this.getCurrentEventStack().current_event;if(a)this.pushCleanSol(a.solModifiersIncludingParents);var l=1<this.trigger_depth;if(this.pushCleanSol(i.solModifiersIncludingParents),l)this.pushLocalVarStack();var c=this.pushEventStack(i);if(c.current_event=i,t){var u=this.types[e].getCurrentSol();u.select_all=!1,drama.clearArray(u.instances),u.instances[0]=t,this.types[e].applySolToContainer()}var h=!0;if(i.parent){for(var d=c.temp_parents_arr,p=i.parent;p;)d.push(p),p=p.parent;for(d.reverse(),r=0,o=d.length;r<o;r++)if(!d[r].run_pretrigger()){h=!1;break}}if(h){if(this.execcount++,i.orblock)i.run_orblocktrigger(n);else i.run();s=s||c.last_event_true}if(this.popEventStack(),l)this.popLocalVarStack();if(this.popSol(i.solModifiersIncludingParents),a)this.popSol(a.solModifiersIncludingParents);if(this.hasPendingInstances&&0===this.isInOnDestroy&&0===y&&!this.isRunningEvents)this.ClearDeathRow();return this.trigger_depth--,s},e.prototype.getCurrentCondition=function(){var t=this.getCurrentEventStack();return t.current_event.conditions[t.cndindex]},e.prototype.getCurrentConditionObjectType=function(){return this.getCurrentCondition().type},e.prototype.isCurrentConditionFirst=function(){return 0===this.getCurrentEventStack().cndindex},e.prototype.getCurrentAction=function(){var t=this.getCurrentEventStack();return t.current_event.actions[t.actindex]},e.prototype.pushLocalVarStack=function(){if(this.localvar_stack_index++,this.localvar_stack_index>=this.localvar_stack.length)this.localvar_stack.push([])},e.prototype.popLocalVarStack=function(){assert2(0<this.localvar_stack_index,"Popping last local var stack - check pushLocalVarStack/popLocalVarStack pairs"),this.localvar_stack_index--},e.prototype.getCurrentLocalVarStack=function(){return this.localvar_stack[this.localvar_stack_index]},e.prototype.pushEventStack=function(t){if(this.event_stack_index++,this.event_stack_index>=this.event_stack.length)this.event_stack.push(new drama.eventStackFrame);var e=this.getCurrentEventStack();return e.reset(t),e},e.prototype.popEventStack=function(){assert2(0<this.event_stack_index,"Popping last event stack frame - check pushEventStack/popEventStack pairs"),this.event_stack_index--},e.prototype.getCurrentEventStack=function(){return this.event_stack[this.event_stack_index]},e.prototype.pushLoopStack=function(t){if(this.loop_stack_index++,this.loop_stack_index>=this.loop_stack.length)this.loop_stack.push(drama.seal({name:t,index:0,stopped:!1}));var e=this.getCurrentLoop();return e.name=t,e.index=0,e.stopped=!1,e},e.prototype.popLoopStack=function(){assert2(0<=this.loop_stack_index,"Popping loop stack when empty, check pushLoopStack/popLoopStack pairs"),this.loop_stack_index--},e.prototype.getCurrentLoop=function(){return this.loop_stack[this.loop_stack_index]},e.prototype.getEventVariableByName=function(t,e){for(var i,n,r,o,s,a;e;){for(i=0,n=e.subevents.length;i<n;i++)if((a=e.subevents[i])instanceof drama.eventvariable&&drama.equals_nocase(t,a.name))return a;e=e.parent}for(i=0,n=this.eventsheets_by_index.length;i<n;i++)for(r=0,o=(s=this.eventsheets_by_index[i]).events.length;r<o;r++)if((a=s.events[r])instanceof drama.eventvariable&&drama.equals_nocase(t,a.name))return a;return null},e.prototype.getLayoutBySid=function(t){var e,i;for(e=0,i=this.layouts_by_index.length;e<i;e++)if(this.layouts_by_index[e].sid===t)return this.layouts_by_index[e];return null},e.prototype.getObjectTypeBySid=function(t){var e,i;for(e=0,i=this.types_by_index.length;e<i;e++)if(this.types_by_index[e].sid===t)return this.types_by_index[e];return null},e.prototype.getGroupBySid=function(t){var e,i;for(e=0,i=this.allGroups.length;e<i;e++)if(this.allGroups[e].sid===t)return this.allGroups[e];return null},e.prototype.doCanvasSnapshot=function(t,e){this.snapshotCanvas=[t,e],this.redraw=!0},e.prototype.debugBreak=function(){this.hit_breakpoint=!0,this.step_break=!1,this.resuming_breakpoint=!1,this.setSuspended(!0);var t={eventSheet:this.breakpoint_event.sheet.name,eventNumber:this.breakpoint_event.display_number,condition:this.breakpoint_condition?this.breakpoint_condition.index:-1,action:this.breakpoint_action?this.breakpoint_action.index:-1};setTimeout(function(){DebuggerOnHitBreakpoint(t)},50)},e.prototype.debugResume=function(){DebuggerOnResume(),this.hit_breakpoint=!1,this.resuming_breakpoint=!0,this.setSuspended(!1)},e.prototype.signalContinuousPreview=function(){this.signalledContinuousPreview=!0},e.prototype.stepIfPausedInDebugger=function(){if(this.isSuspended&&this.isDebug)this.last_tick_time=drama.performance_now(),this.tick(!1)},e.prototype.handleSaveLoad=function(){this.isSaveSuccess=!1,this.isSaveFail=!1,this.isLoadSuccess=!1,this.isLoadFail=!1;var i=this,n=this.saveToSlot,r=this.lastSaveJson,e=this.loadFromSlot,t=!1,o="",s="";if(this.signalledContinuousPreview)t=!0,n="__xf_continuouspreview",this.signalledContinuousPreview=!1;if(n.length){if(o=Date.now(),this.ClearDeathRow(),r=this.saveToJSONString(),xf.archiveSDK.IsIndexedDBAvailable())xf.archiveSDK.IndexedDB_WriteSlot(n,r,function(){if(s=Date.now(),drama.logexport("Saved state to IndexedDB storage ("+r.length+" bytes)"),i.lastSaveJson=r,i.trigger(drama.system_object.prototype.cnds.OnSaveComplete,null),i.isSaveSuccess=!0,i.isSaveFail=!1,i.trigger(drama.system_object.prototype.cnds.OnSystemSaveComplete,null),i.lastSaveJson="",xf.cloudLadderSDK.doReportEvent("system_save",{condition:"",slot:n,saveresult:"s",firesize:r.length,savetime:s-o}),t)c()},function(e){try{if(xf.archiveSDK.LocalStorage_WriteSlot(n,r),drama.logexport("Saved state to WebStorage ("+r.length+" bytes)"),s=Date.now(),i.lastSaveJson=r,i.isSaveSuccess=!0,i.isSaveFail=!1,i.trigger(drama.system_object.prototype.cnds.OnSaveComplete,null),i.trigger(drama.system_object.prototype.cnds.OnSystemSaveComplete,null),xf.cloudLadderSDK.doReportEvent("system_save",{condition:"",slot:n,saveresult:"s",firesize:r.length,savetime:s-o}),i.lastSaveJson="",t)c()}catch(t){s=Date.now(),drama.logexport("Failed to save game state: "+e+"; "+t),i.trigger(drama.system_object.prototype.cnds.OnSaveFailed,null),i.isSaveSuccess=!1,i.isSaveFail=!0,i.trigger(drama.system_object.prototype.cnds.OnSystemSaveComplete,null),xf.cloudLadderSDK.doReportEvent("system_save",{condition:"",slot:n,saveresult:"f",firesize:r.length,savetime:s-o})}});else{o=Date.now();try{if(xf.archiveSDK.LocalStorage_WriteSlot(n,r),drama.logexport("Saved state to WebStorage ("+r.length+" bytes)"),i.lastSaveJson=r,i.isSaveSuccess=!0,i.isSaveFail=!1,i.trigger(drama.system_object.prototype.cnds.OnSaveComplete,null),i.trigger(drama.system_object.prototype.cnds.OnSystemSaveComplete,null),s=Date.now(),xf.cloudLadderSDK.doReportEvent("system_save",{condition:"",slot:n,saveresult:"s",firesize:r.length,savetime:s-o}),i.lastSaveJson="",t)c()}catch(t){s=Date.now(),drama.logexport("Error saving to WebStorage: "+t),i.trigger(drama.system_object.prototype.cnds.OnSaveFailed,null),i.isSaveSuccess=!1,i.isSaveFail=!0,i.trigger(drama.system_object.prototype.cnds.OnSystemSaveComplete,null),xf.cloudLadderSDK.doReportEvent("system_save",{condition:"",slot:n,saveresult:"f",firesize:r.length,savetime:s-o})}}this.saveToSlot="",this.loadFromSlot="",this.loadFromJson=null}if(e.length){if(i.loadSlot=e,i.loadStartTime=Date.now(),o=Date.now(),xf.archiveSDK.IsIndexedDBAvailable())xf.archiveSDK.IndexedDB_ReadSlot(e,function(t){if(t)i.loadFromJson=t,drama.logexport("Loaded state from IndexedDB storage ("+i.loadFromJson.length+" bytes)");else i.loadFromJson=xf.archiveSDK.LocalStorage_ReadSlot(e),drama.logexport("Loaded state from WebStorage ("+i.loadFromJson.length+" bytes)");if(i.suspendDrawing=!1,!i.loadFromJson)i.loadFromJson=null,s=Date.now(),i.trigger(drama.system_object.prototype.cnds.OnLoadFailed,null),i.isLoadSuccess=!1,i.isLoadFail=!0,i.trigger(drama.system_object.prototype.cnds.OnSystemLoadComplete,null),xf.cloudLadderSDK.doReportEvent("system_load",{condition:"",slot:e,loadresult:"f",firesize:0,loadtime:s-o});i.stepIfPausedInDebugger()},function(t){if(i.loadFromJson=xf.archiveSDK.LocalStorage_ReadSlot(e),drama.logexport("Loaded state from WebStorage ("+i.loadFromJson.length+" bytes)"),i.suspendDrawing=!1,!i.loadFromJson)s=Date.now(),i.loadFromJson=null,i.trigger(drama.system_object.prototype.cnds.OnLoadFailed,null),i.isLoadSuccess=!1,i.isLoadFail=!0,i.trigger(drama.system_object.prototype.cnds.OnSystemLoadComplete,null),xf.cloudLadderSDK.doReportEvent("system_load",{condition:"",slot:e,loadresult:"f",firesize:0,loadtime:s-o});i.stepIfPausedInDebugger()});else{try{this.loadFromJson=xf.archiveSDK.LocalStorage_ReadSlot(e),drama.logexport("Loaded state from WebStorage ("+this.loadFromJson.length+" bytes)")}catch(t){this.loadFromJson=null}if(this.suspendDrawing=!1,!i.loadFromJson)s=Date.now(),i.loadFromJson=null,i.trigger(drama.system_object.prototype.cnds.OnLoadFailed,null),i.isLoadSuccess=!1,i.isLoadFail=!0,i.trigger(drama.system_object.prototype.cnds.OnSystemLoadComplete,null),xf.cloudLadderSDK.doReportEvent("system_load",{condition:"",slot:e,loadresult:"f",firesize:0,loadtime:s-o})}this.loadFromSlot="",this.saveToSlot=""}if(null!==this.loadFromJson){this.ClearDeathRow(),this.originLayoutSid="";var a=this.loadFromJSONString(this.loadFromJson);if(this.isloading)return;if(a)this.lastSaveJson=this.loadFromJson,this.trigger(drama.system_object.prototype.cnds.OnLoadComplete,null),this.isLoadSuccess=!0,this.isLoadFail=!1,this.trigger(drama.system_object.prototype.cnds.OnSystemLoadComplete,null),xf.cloudLadderSDK.doReportEvent("system_load",{condition:"",slot:i.loadSlot,loadresult:"s",firesize:i.loadFromJson.length,loadtime:Date.now()-i.loadStartTime}),i.loadSlot="",this.lastSaveJson="";else i.trigger(drama.system_object.prototype.cnds.OnLoadFailed,null),this.isLoadSuccess=!1,this.isLoadFail=!0,this.trigger(drama.system_object.prototype.cnds.OnSystemLoadComplete,null),xf.cloudLadderSDK.doReportEvent("system_load",{condition:"",slot:e,loadresult:"f",firesize:0,loadtime:Date.now()-i.loadStartTime});this.loadFromJson=null}},e.prototype.saveToJSONString=function(){var t,e,i,n,r,o,s,a,l,c,u,h,d={xfsave:!0,version:1,rt:{time:this.kahanTime.sum,walltime:this.wallTime.sum,timescale:this.timescale,tickcount:this.tickcount,execcount:this.execcount,next_uid:this.next_uid,running_layout:this.running_layout.sid,start_time_offset:Date.now()-this.start_time},types:{},layouts:{},events:{groups:{},cnds:{},acts:{},vars:{}}};for(t=0,e=this.types_by_index.length;t<e;t++)if(!(r=this.types_by_index[t]).is_family&&!this.typeHasNoSaveBehavior(r)){if(s={instances:[]},drama.hasAnyOwnProperty(r.extra))s.ex=v(r.extra);for(i=0,n=r.instances.length;i<n;i++)s.instances.push(this.saveInstanceToJSON(r.instances[i]));d.types[r.sid.toString()]=s}for(t=0,e=this.layouts_by_index.length;t<e;t++)o=this.layouts_by_index[t],d.layouts[o.sid.toString()]=o.saveToJSON();var p=d.events.groups;for(t=0,e=this.allGroups.length;t<e;t++)p[(a=this.allGroups[t]).sid.toString()]=this.groups_by_name[a.group_name].group_active;var f=d.events.cnds;for(h in this.cndsBySid)if(this.cndsBySid.hasOwnProperty(h))if(l=this.cndsBySid[h],drama.hasAnyOwnProperty(l.extra))f[h]={ex:v(l.extra)};var m=d.events.acts;for(h in this.actsBySid)if(this.actsBySid.hasOwnProperty(h))if(c=this.actsBySid[h],drama.hasAnyOwnProperty(c.extra))m[h]={ex:v(c.extra)};var g=d.events.vars;for(h in this.varsBySid)if(this.varsBySid.hasOwnProperty(h))if(!(u=this.varsBySid[h]).is_constant&&(!u.parent||u.is_static))g[h]=u.data;return d.system=this.system.saveToJSON(),JSON.stringify(d)},e.prototype.refreshUidMap=function(){var t,e,i,n,r,o;for(this.objectsByUid={},t=0,e=this.types_by_index.length;t<e;t++)if(!(i=this.types_by_index[t]).is_family)for(n=0,r=i.instances.length;n<r;n++)o=i.instances[n],this.objectsByUid[o.uid.toString()]=o},e.prototype.loadFromJSONString=function(t){var e;try{e=JSON.parse(t)}catch(t){return!1}if(e.c2save)e.xfsave=e.c2save;if(!e.xfsave)return!1;if(1<e.version)return!1;this.isLoadingState=!0;var i=e.rt;this.kahanTime.reset(),this.kahanTime.sum=i.time,this.wallTime.reset(),this.wallTime.sum=i.walltime||0,this.timescale=i.timescale,this.tickcount=i.tickcount,this.execcount=i.execcount,this.start_time=Date.now()-i.start_time_offset;var n,r,o,s,a,l,c,u,h,d,p,f,m,g,y,v,b,_=i.running_layout;if(_!==this.running_layout.sid){var w=this.getLayoutBySid(_);if(this.originLayoutSid!=_&&this.isLoadBySection)this.originLayoutSid=_,this.loadingSection(w);if(this.isloading&&this.isLoadBySection)return void this.loadingLayOut(w,!0);if(w)this.doChangeLayout(w);else return}var x=e.types;for(c in x)if(x.hasOwnProperty(c)){if(!(u=this.getObjectTypeBySid(parseInt(c,10)))||u.is_family||this.typeHasNoSaveBehavior(u))continue;if(x[c].ex)u.extra=x[c].ex;else drama.wipe(u.extra);for(h=u.instances,d=x[c].instances,n=0,r=drama.min(h.length,d.length);n<r;n++)this.loadInstanceFromJSON(h[n],d[n]);for(n=d.length,r=h.length;n<r;n++)this.DestroyInstance(h[n]);for(n=h.length,r=d.length;n<r;n++){if(g=null,u.plugin.is_world)if(!(g=this.running_layout.getLayerBySid(d[n].w.l)))continue;var S=this.getObjectBankDefaultInstance(u)||u.default_instance;p=this.createInstanceFromInit(S,g,!1,0,0,!0),this.loadInstanceFromJSON(p,d[n])}u.stale_iids=!0}this.ClearDeathRow(),this.refreshUidMap();var I=e.layouts;for(c in I)if(I.hasOwnProperty(c)){if(!(m=this.getLayoutBySid(parseInt(c,10))))continue;m.loadFromJSON(I[c])}var T=e.events.groups;for(c in T)if(T.hasOwnProperty(c))if((y=this.getGroupBySid(parseInt(c,10)))&&this.groups_by_name[y.group_name])this.groups_by_name[y.group_name].setGroupActive(T[c]);var C=e.events.cnds;for(c in this.cndsBySid)if(this.cndsBySid.hasOwnProperty(c))if(C.hasOwnProperty(c))this.cndsBySid[c].extra=C[c].ex;else this.cndsBySid[c].extra={};var O=e.events.acts;for(c in this.actsBySid)if(this.actsBySid.hasOwnProperty(c))if(O.hasOwnProperty(c))this.actsBySid[c].extra=O[c].ex;else this.actsBySid[c].extra={};var P=e.events.vars;for(c in P)if(P.hasOwnProperty(c)&&this.varsBySid.hasOwnProperty(c))this.varsBySid[c].data=P[c];for(this.next_uid=i.next_uid,this.isLoadingState=!1,n=0,r=this.fireOnCreateAfterLoad.length;n<r;++n)p=this.fireOnCreateAfterLoad[n],this.trigger(Object.getPrototypeOf(p.type.plugin).cnds.OnCreated,p);for(drama.clearArray(this.fireOnCreateAfterLoad),this.system.loadFromJSON(e.system),n=0,r=this.types_by_index.length;n<r;n++)if(!(u=this.types_by_index[n]).is_family&&!this.typeHasNoSaveBehavior(u))for(o=0,s=u.instances.length;o<s;o++){if(p=u.instances[o],u.is_contained)for(v=p.get_iid(),drama.clearArray(p.siblings),a=0,l=u.container.length;a<l;a++)if(u!==(b=u.container[a]))assert2(b.instances.length>v,"Missing sibling instance when linking containers after load"),p.siblings.push(b.instances[v]);if(p.afterLoad)p.afterLoad();if(p.behavior_insts)for(a=0,l=p.behavior_insts.length;a<l;a++)if((f=p.behavior_insts[a]).afterLoad)f.afterLoad()}return this.redraw=!0},e.prototype.saveInstanceToJSON=function(t,e){var i,n,r,o,s,a=t.type,l=a.plugin,c={};if(e)c.state_only=!0;else c.uid=t.uid;if(drama.hasAnyOwnProperty(t.extra))c.ex=v(t.extra);if(t.instance_vars&&t.instance_vars.length)for(c.ivs={},i=0,n=t.instance_vars.length;i<n;i++)c.ivs[t.type.instvar_sids[i].toString()]=t.instance_vars[i];if(l.is_world){if(r={x:t.x,y:t.y,w:t.width,h:t.height,l:t.layer.sid,zi:t.get_zindex()},0!==t.angle)r.a=t.angle;if(1!==t.opacity)r.o=t.opacity;if(.5!==t.hotspotX)r.hX=t.hotspotX;if(.5!==t.hotspotY)r.hY=t.hotspotY;if(0!==t.blend_mode)r.bm=t.blend_mode;if(!t.visible)r.v=t.visible;if(!t.collisionsEnabled)r.ce=t.collisionsEnabled;if(-1!==t.my_timescale)r.mts=t.my_timescale;if(a.effect_types.length)for(r.fx=[],i=0,n=a.effect_types.length;i<n;i++)s=a.effect_types[i],r.fx.push({name:s.name,active:t.active_effect_flags[s.index],params:t.effect_params[s.index]});c.w=r}if(t.behavior_insts&&t.behavior_insts.length)for(c.behs={},i=0,n=t.behavior_insts.length;i<n;i++)if((o=t.behavior_insts[i]).saveToJSON)c.behs[o.type.sid.toString()]=o.saveToJSON();if(t.saveToJSON)c.data=t.saveToJSON();return c},e.prototype.getInstanceVarIndexBySid=function(t,e){var i,n;for(i=0,n=t.instvar_sids.length;i<n;i++)if(t.instvar_sids[i]===e)return i;return-1},e.prototype.getBehaviorIndexBySid=function(t,e){var i,n;for(i=0,n=t.behavior_insts.length;i<n;i++)if(t.behavior_insts[i].type.sid===e)return i;return-1},e.prototype.loadInstanceFromJSON=function(t,e,i){var n,r,o,s,a,l,c,u,h,d,p;if(null!=t){var f=t.type,m=f.plugin;if(i){if(!e.state_only)return}else t.uid=e.uid;if(e.ex)t.extra=e.ex;else drama.wipe(t.extra);if(a=e.ivs)for(n in a)if(a.hasOwnProperty(n)){if((s=this.getInstanceVarIndexBySid(f,parseInt(n,10)))<0||s>=t.instance_vars.length)continue;if(null===(d=a[n]))d=NaN;t.instance_vars[s]=d}if(m.is_world){if(l=e.w,t.layer.sid!==l.l)if(p=t.layer,t.layer=this.running_layout.getLayerBySid(l.l),t.layer)p.removeFromInstanceList(t,!0),t.layer.appendToInstanceList(t,!0),t.set_bbox_changed(),t.layer.setZIndicesStaleFrom(0);else if(t.layer=p,!i)this.DestroyInstance(t);if(t.x=l.x,t.y=l.y,t.width=l.w,t.height=l.h,t.zindex=l.zi,t.angle=l.hasOwnProperty("a")?l.a:0,t.opacity=l.hasOwnProperty("o")?l.o:1,t.hotspotX=l.hasOwnProperty("hX")?l.hX:.5,t.hotspotY=l.hasOwnProperty("hY")?l.hY:.5,t.visible=l.hasOwnProperty("v")?l.v:!0,t.collisionsEnabled=l.hasOwnProperty("ce")?l.ce:!0,t.my_timescale=l.hasOwnProperty("mts")?l.mts:-1,t.blend_mode=l.hasOwnProperty("bm")?l.bm:0,t.compositeOp=drama.effectToCompositeOp(t.blend_mode),this.gl)drama.setGLBlend(t,t.blend_mode,this.gl);if(t.set_bbox_changed(),l.hasOwnProperty("fx"))for(r=0,o=l.fx.length;r<o;r++)if(!((c=f.getEffectIndexByName(l.fx[r].name))<0))t.active_effect_flags[c]=l.fx[r].active,t.effect_params[c]=l.fx[r].params;t.updateActiveEffects()}if(u=e.behs)for(n in u)if(u.hasOwnProperty(n)){if((h=this.getBehaviorIndexBySid(t,parseInt(n,10)))<0)continue;t.behavior_insts[h].loadFromJSON(u[n])}if(e.data)t.loadFromJSON(e.data)}},e.prototype.getProjectFileUrl=function(t){return this.files_subfolder+t},e.prototype.getProjectFileBlob=function(t){if(this.isPreview)if(!window.cr_previewProjectFileBlobs||!window.cr_previewProjectFiles.hasOwnProperty(t.toLowerCase()))return null;else return window.cr_previewProjectFileBlobs[t.toLowerCase()];else return null},e.prototype.getLocalFileUrl=function(t){if(this.isPreview)if(!window.cr_previewProjectFiles||!window.cr_previewProjectFiles.hasOwnProperty(t.toLowerCase()))return t;else return window.cr_previewProjectFiles[t.toLowerCase()];else return t},e.prototype.fetchLocalFileViaCordova=function(t,e,i){var n=window.cordova.file.applicationDirectory+"www/"+t;window.resolveLocalFileSystemURL(n,function(t){t.file(e,i)},i)},e.prototype.fetchLocalFileViaCordovaAsText=function(t,i,n){this.fetchLocalFileViaCordova(t,function(t){var e=new FileReader;e.onload=function(t){i(t.target.result)},e.onerror=n,e.readAsText(t)},n)};var r=[],o=0;e.prototype.maybeStartNextArrayBufferRead=function(){if(r.length)if(!(8<=o)){o++;var t=r.shift();this.doFetchLocalFileViaCordovaAsArrayBuffer(t.filename,t.successCallback,t.errorCallback)}},e.prototype.fetchLocalFileViaCordovaAsArrayBuffer=function(t,e,i){var n=this;r.push({filename:t,successCallback:function(t){o--,n.maybeStartNextArrayBufferRead(),e(t)},errorCallback:function(t){o--,n.maybeStartNextArrayBufferRead(),i(t)}}),this.maybeStartNextArrayBufferRead()},e.prototype.doFetchLocalFileViaCordovaAsArrayBuffer=function(t,i,e){this.fetchLocalFileViaCordova(t,function(t){var e=new FileReader;e.onload=function(t){i(t.target.result)},e.readAsArrayBuffer(t)},e)},e.prototype.fetchLocalFileViaCordovaAsURL=function(t,n,e){var r="",i=t.toLowerCase(),o=i.substr(i.length-4),s=i.substr(i.length-5);if(".mp4"===o)r="video/mp4";else if(".webm"===s)r="video/webm";else if(".m4a"===o)r="audio/mp4";else if(".mp3"===o)r="audio/mpeg";this.fetchLocalFileViaCordovaAsArrayBuffer(t,function(t){var e=new Blob([t],{type:r}),i=URL.createObjectURL(e);n(i)},e)},e.prototype.isAbsoluteUrl=function(t){return/^(?:[a-z]+:)?\/\//.test(t)||"data:"===t.substr(0,5)||"blob:"===t.substr(0,5)},e.prototype.setImageSrc=function(e,t){if(this.isWKWebView&&!this.isAbsoluteUrl(t))this.fetchLocalFileViaCordovaAsURL(t,function(t){e.src=t},function(t){alert("Failed to load image: "+t)});else if(this.isPreview&&!this.isAbsoluteUrl(t))e.src=this.getLocalFileUrl(t);else{if(!this.isAbsoluteUrl(t))t=t.toLowerCase();e.src=t}},e.prototype.cacheMiniGameImgs=function(t){var e=this.wxfileUtil(),i=wx.getFileSystemManager(),n=e.path;if(e.path.isRemotePath(t))if(this.isWeixin){var r=n.dirname(t);e.fs.mkdirsSync(r.split("assets/")[1]);var o=n.getWxUserPath(t.split("assets/")[1]);wx.downloadFile({url:t,filePath:o,success:function(t){if(400<=t.statusCode)try{i.accessSync(o),i.unlinkSync(o)}catch(t){}}})}else if(this.isByte);},e.prototype.wxfileUtil=function(){var u=wx.getFileSystemManager(),o=wx.env.USER_DATA_PATH+"/";var s={},a={remove:function(t){if(a.existsSync(t)){var e=o+t;!function t(e,i){var n=u.readdirSync(e),r=!0,o=!1,s=void 0;try{for(var a,l=n[Symbol.iterator]();!(r=(a=l.next()).done);r=!0){var c=e+"/"+a.value;if(u.statSync(c).isDirectory())t(c,i);else i(c)}}catch(t){o=!0,s=t}finally{try{if(!r&&null!=l.return)l.return()}finally{if(o)throw s}}}(e,function(t){u.unlinkSync(t);var e=t.replace(o,"");if(e=l.normailze(e),s[e])s[e]=0}),function t(e,i){var n=u.readdirSync(e),r=!0,o=!1,s=void 0;try{for(var a,l=n[Symbol.iterator]();!(r=(a=l.next()).done);r=!0){var c=e+"/"+a.value;if(u.statSync(c).isDirectory())t(c,i),i(c)}}catch(t){o=!0,s=t}finally{try{if(!r&&null!=l.return)l.return()}finally{if(o)throw s}}}(e,function(t){u.rmdirSync(t);var e=t.replace(o,"");if(e=l.normailze(e),s[e])s[e]=0})}},existsSync:function(e){var t=s[e];if(0==t)return!1;else if(1==t)return!0;else try{if(u.accessSync(o+e),e=l.normailze(e))s[e]=1;return!0}catch(t){return e=l.normailze(e),s[e]=0,!1}},writeSync:function(t,e){t=l.normailze(t),s[t]=1,u.writeFileSync(o+t,e)},readSync:function(t,e){return e=e||"utf-8",u.readFileSync(o+t,e)},mkdirsSync:function(t){if(!a.existsSync(t))for(var e=t.split("/"),i="",n=0;n<e.length;n++){if(i+=e[n]+"/",!a.existsSync(i)){var r=l.normailze(i);s[r]=1,u.mkdirSync(o+i)}}},unzip:function(i,n){return i=o+i,n=o+n,new Promise(function(t,e){a.unzip({zipFilePath:i,targetPath:n,success:function(){t()},fail:function(t){e(t)}})})},setFsCache:function(t,e){s[t]=e}},l={dirname:function(t){var e=t.split("/");return e.pop(),e.join("/")},isRemotePath:function(t){return 0==t.indexOf("http://")||0==t.indexOf("https://")},normailze:function(t){var e=t.split("/"),i=t.split("/"),n=!0,r=!1,o=void 0;try{for(var s,a=e[Symbol.iterator]();!(n=(s=a.next()).done);n=!0){var l=s.value;if(""==l||null==l){var c=i.indexOf(l);i.splice(c,1)}}}catch(t){r=!0,o=t}finally{try{if(!n&&null!=a.return)a.return()}finally{if(r)throw o}}if(0<i.length)return i.join("/")},getLocalFilePath:function(t){for(var e in l.localFileMap)if(0<=t.indexOf(e))return t=t.replace(e,l.localFileMap[e]),l.normailze(t);if(0<=t.indexOf(":")||0<=t.indexOf("#")||0<=t.indexOf("?"))t=t.replace(/[^a-z0-9.]/gi,"/");return l.normailze(t)},getWxUserPath:function(t){return o+t},localFileMap:{}};return{fs:a,path:l}},e.prototype.getPreferredAudioFile=function(t){var e=t.toLowerCase();if(!this.audio_files_map.hasOwnProperty(e))return null;var i,n,r,o,s=this.audio_files_map[e],a=null;for(i=0,n=s.length;i<n;++i){if(o=(r=s[i])[0],!a&&"audio/webm; codecs=opus"===o)a=r;if(J[o])return r}return a},e.prototype.getProjectAudioFileUrl=function(t){var e=t.toLowerCase(),i=this.getPreferredAudioFile(t);if(!i)return null;var n=e+i[1];return{url:this.getProjectFileUrl(n),type:i[0]}},e.prototype.getStatusInfo=function(){return{fps:this.fps,cpu:this.cpuutilisation/1e3,gpu:this.gpuLastUtilisation,layout:this.running_layout?this.running_layout.name:"",renderer:this.glUnmaskedRenderer}},e.prototype.accelerate=function(t,e,i,n,r){if(this.enhancedAccelerationPrecision){var o=e*r,s=i*r;return drama.clamp(t*r+.5*n*r*r,o,s)}else return t*r},drama.runtime=e,drama.createRuntime=function(t){return new e(t)},window.cr_createRuntime=drama.createRuntime}(),window.cr_getSnapshot=function(t,e){var i=window.xfruntime;if(i)i.doCanvasSnapshot(t,e)},window.cr_sizeCanvas=function(t,e){if(0!==t&&0!==e){var i=window.xfruntime;if(i)i.setSize(t,e)}},window.cr_setSuspended=function(t){var e=window.xfruntime;if(e)e.setSuspended(t)},assert2(drama,"drama namespace not created"),function(){function t(t,e){this.runtime=t,this.name=e[0],this.layouts=[],this.generateSection(e[1])}t.prototype.generateSection=function(t){for(var e=0,i=t.length;e<i;e++)this.runtime.layoutToSectionMap[t[e]]=this.name,this.layouts.push(this.runtime.layouts[t[e]])},drama.loadSection=t}(),assert2(drama,"drama namespace not created"),function(){function t(t,e){this.runtime=t,this.event_sheet=null,this.scrollX=this.runtime.original_width/2,this.scrollY=this.runtime.original_height/2,this.scale=1,this.angle=0,this.first_visit=!0,this.scrollSpeedX=0,this.scrollSpeedY=0,this.scrollTargetX,this.scrollTargetY,this.name=e[0],this.originalWidth=e[1],this.originalHeight=e[2],this.width=e[1],this.height=e[2],this.unbounded_scrolling=e[3],this.sheetname=e[4],this.sid=e[5];var i,n,r=e[6];for(this.layers=[],this.initial_types=[],i=0,n=r.length;i<n;i++){var o=new drama.layer(this,r[i]);o.number=i,drama.seal(o),this.layers.push(o)}var s=e[7];for(this.initial_nonworld=[],i=0,n=s.length;i<n;i++){var a=s[i],l=this.runtime.types_by_index[a[1]];if(assert2(l,"Could not find nonworld object type: "+a.type_name),!l.default_instance)l.default_instance=a;if(this.initial_nonworld.push(a),-1===this.initial_types.indexOf(l))this.initial_types.push(l)}for(this.effect_types=[],this.active_effect_types=[],this.shaders_preserve_opaqueness=!0,this.effect_params=[],i=0,n=e[8].length;i<n;i++)this.effect_types.push({id:e[8][i][0],name:e[8][i][1],shaderindex:-1,preservesOpaqueness:!1,active:!0,index:i}),this.effect_params.push(e[8][i][2].slice(0));this.show_collision_polys=e[9],this.updateActiveEffects(),this.rcTexBounce=new drama.rect(0,0,1,1),this.rcTexDest=new drama.rect(0,0,1,1),this.rcTexOrigin=new drama.rect(0,0,1,1),this.viewRect=new drama.rect(0,0,0,0),this.persist_data={},this.collisionGroup=e[10],this.setCollisionGroup()}t.prototype.setCollisionGroup=function(){var n=this,t=this.collisionGroup,r=this.runtime.groupCollisionMap;r[this.name]={"00":!0},t.map(function(t,i){t.map(function(t,e){r[n.name][i+""+e]=t})})},t.prototype.saveObjectToPersist=function(t){var e=t.type.sid.toString();if(!this.persist_data.hasOwnProperty(e))this.persist_data[e]=[];this.persist_data[e].push(this.runtime.saveInstanceToJSON(t))},t.prototype.hasOpaqueBottomLayer=function(){var t=this.layers[0];return!t.transparent&&1===t.opacity&&!t.forceOwnTexture&&t.visible},t.prototype.updateActiveEffects=function(){var t,e,i;for(drama.clearArray(this.active_effect_types),this.shaders_preserve_opaqueness=!0,t=0,e=this.effect_types.length;t<e;t++)if((i=this.effect_types[t]).active)if(this.active_effect_types.push(i),!i.preservesOpaqueness)this.shaders_preserve_opaqueness=!1},t.prototype.getEffectByName=function(t){var e,i,n;for(e=0,i=this.effect_types.length;e<i;e++)if((n=this.effect_types[e]).name===t)return n;return null};var g=[];function y(t,e){return t.zindex-e.zindex}var v=!0;t.prototype.startRunning=function(){if(xf.EventCenter.instance.sendEvent(new xf.EventData(xf.EventType.CHANGE_SCREEN,{name:this.name,sid:this.sid+"",type:1})),this.sheetname)this.event_sheet=this.runtime.eventsheets[this.sheetname],assert2(this.event_sheet,"Cannot find event sheet: "+this.sheetname),this.event_sheet.updateDeepIncludes();var t,e,i,n,r,o,s,a,l,c,u,h,d,p;for((this.runtime.running_layout=this).width=this.originalWidth,this.height=this.originalHeight,this.scrollX=this.runtime.original_width/2,this.scrollY=this.runtime.original_height/2,t=0,i=this.runtime.types_by_index.length;t<i;t++)if(!(r=this.runtime.types_by_index[t]).is_family)for(e=0,n=(o=r.instances).length;e<n;e++)if((a=o[e]).layer){var f=a.layer.number;if(f>=this.layers.length)f=this.layers.length-1;if(a.layer=this.layers[f],-1===a.layer.instances.indexOf(a))a.layer.instances.push(a);a.layer.zindices_stale=!0}if(!v)for(t=0,i=this.layers.length;t<i;++t)this.layers[t].instances.sort(y);for(drama.clearArray(g),this.boundScrolling(),t=0,i=this.layers.length;t<i;t++)(p=this.layers[t]).createInitialInstances(g),p.updateViewport(null);var m=!1;if(!this.first_visit){for(h in this.persist_data)if(this.persist_data.hasOwnProperty(h)){if(!(r=this.runtime.getObjectTypeBySid(parseInt(h,10)))||r.is_family||!this.runtime.typeHasPersistBehavior(r))continue;for(t=0,i=(d=this.persist_data[h]).length;t<i;t++){if(p=null,r.plugin.is_world)if(!(p=this.getLayerBySid(d[t].w.l)))continue;a=this.runtime.createInstanceFromInit(r.default_instance,p,!1,0,0,!0),this.runtime.loadInstanceFromJSON(a,d[t]),m=!0,g.push(a)}drama.clearArray(d)}for(t=0,i=this.layers.length;t<i;t++)this.layers[t].instances.sort(y),this.layers[t].zindices_stale=!0}if(m)this.runtime.ClearDeathRow(),this.runtime.refreshUidMap();for(t=0;t<g.length;t++)if((a=g[t]).type.is_contained)for(l=a.get_iid(),e=0,n=a.type.container.length;e<n;e++)if(c=a.type.container[e],a.type!==c)if(c.instances.length>l)a.siblings.push(c.instances[l]);else if(!c.default_instance)alert(c.name+"': 对象至少需要一个实例");else u=this.runtime.createInstanceFromInit(c.default_instance,a.layer,!0,a.x,a.y,!0),this.runtime.ClearDeathRow(),c.updateIIDs(),a.siblings.push(u),g.push(u);for(t=0,i=this.initial_nonworld.length;t<i;t++){if(s=this.initial_nonworld[t],!(r=this.runtime.types_by_index[s[1]]).is_contained)a=this.runtime.createInstanceFromInit(this.initial_nonworld[t],null,!0);assert2(!a.type.global,"Global non-world instance still in layout's initial non-world list")}if(this.runtime.changelayout=null,this.runtime.ClearDeathRow(),this.runtime.ctx)for(t=0,i=this.runtime.types_by_index.length;t<i;t++)if(!(c=this.runtime.types_by_index[t]).is_family&&c.instances.length&&c.preloadCanvas2D)c.preloadCanvas2D(this.runtime.ctx);if(this.runtime.isLoadingState)drama.shallowAssignArray(this.runtime.fireOnCreateAfterLoad,g);else for(t=0,i=g.length;t<i;t++)a=g[t],this.runtime.trigger(Object.getPrototypeOf(a.type.plugin).cnds.OnCreated,a);if(drama.clearArray(g),!this.runtime.isLoadingState)this.runtime.trigger(drama.system_object.prototype.cnds.OnLayoutStart,null),this.runtime.isOnLayoutStart=!0,this.runtime.trigger(drama.system_object.prototype.cnds.OnLayoutChange,null),this.runtime.isOnLayoutStart=!1;this.first_visit=!1},t.prototype.createGlobalNonWorlds=function(){var t,e,i,n,r;for(e=t=0,i=this.initial_nonworld.length;t<i;t++)if(n=this.initial_nonworld[t],(r=this.runtime.types_by_index[n[1]]).global){if(!r.is_contained)this.runtime.createInstanceFromInit(n,null,!0)}else this.initial_nonworld[e]=n,e++;drama.truncateArray(this.initial_nonworld,e)},t.prototype.stopRunning=function(){if(assert2(this.runtime.running_layout==this,"Calling stopRunning() on a layout that is not running"),xf.EventCenter.instance.sendEvent(new xf.EventData(xf.EventType.CHANGE_SCREEN,{name:this.name,sid:this.sid+"",type:2})),!this.runtime.isLoadingState)this.runtime.trigger(drama.system_object.prototype.cnds.OnLayoutEnd,null),this.runtime.isOnLayoutEnd=!0,this.runtime.trigger(drama.system_object.prototype.cnds.OnLayoutChange,null),this.runtime.isOnLayoutEnd=!1;var t,e,i,n,r,o,s;if(this.runtime.isEndingLayout=!0,drama.clearArray(this.runtime.system.waits),!this.first_visit)for(t=0,e=this.layers.length;t<e;t++)for(this.layers[t].updateZIndices(),i=0,n=(r=this.layers[t].instances).length;i<n;i++)if(!(o=r[i]).type.global)if(this.runtime.typeHasPersistBehavior(o.type))this.saveObjectToPersist(o);for(t=0,e=this.layers.length;t<e;t++){for(i=0,n=(r=this.layers[t].instances).length;i<n;i++)if(!(o=r[i]).type.global)this.runtime.DestroyInstance(o);this.runtime.ClearDeathRow(),drama.clearArray(r),this.layers[t].zindices_stale=!0}for(t=0,e=this.runtime.types_by_index.length;t<e;t++)if(!((s=this.runtime.types_by_index[t]).global||s.plugin.is_world||s.plugin.singleglobal||s.is_family)){for(i=0,n=s.instances.length;i<n;i++)this.runtime.DestroyInstance(s.instances[i]);this.runtime.ClearDeathRow()}v=!1,this.runtime.isEndingLayout=!1};var a=new drama.rect(0,0,0,0);t.prototype.recreateInitialObjects=function(t,e,i,n,r){var o,s;for(a.set(e,i,n,r),o=0,s=this.layers.length;o<s;o++)this.layers[o].recreateInitialObjects(t,a)},t.prototype.draw=function(t){var e;this.lerpScrollX(),this.lerpScrollY();var i,n,r,o=t,s=!1,a=!this.runtime.fullscreenScalingQuality;if(a){if(!this.runtime.layout_canvas)this.runtime.layout_canvas=document.createElement("canvas"),(e=this.runtime.layout_canvas).width=this.runtime.draw_width,e.height=this.runtime.draw_height,this.runtime.layout_ctx=e.getContext("2d"),s=!0;if(e=this.runtime.layout_canvas,o=this.runtime.layout_ctx,e.width!==this.runtime.draw_width)e.width=this.runtime.draw_width,s=!0;if(e.height!==this.runtime.draw_height)e.height=this.runtime.draw_height,s=!0;if(s)o.imageSmoothingEnabled=this.runtime.linearSampling}if(o.globalAlpha=1,o.globalCompositeOperation="source-over",this.runtime.clearBackground&&!this.hasOpaqueBottomLayer())if(o.clearRect(0,0,this.runtime.draw_width,this.runtime.draw_height),this.runtime.backGroundColorStr)o.fillStyle=this.runtime.backGroundColorStr,o.fillRect(0,0,this.runtime.draw_width,this.runtime.draw_height);for(i=0,n=this.layers.length;i<n;i++)if((r=this.layers[i]).visible&&0<r.opacity&&11!==r.blend_mode&&(r.instances.length||!r.transparent))r.draw(o);else r.updateViewport(null);if(a)t.drawImage(e,0,0,this.runtime.width,this.runtime.height)},t.prototype.drawGL_earlyZPass=function(t){if(t.setEarlyZPass(!0),!this.runtime.layout_tex)this.runtime.layout_tex=t.createEmptyTexture(this.runtime.draw_width,this.runtime.draw_height,this.runtime.linearSampling);if(this.runtime.layout_tex.c2width!==this.runtime.draw_width||this.runtime.layout_tex.c2height!==this.runtime.draw_height)t.deleteTexture(this.runtime.layout_tex),this.runtime.layout_tex=t.createEmptyTexture(this.runtime.draw_width,this.runtime.draw_height,this.runtime.linearSampling);if(t.setRenderingToTexture(this.runtime.layout_tex),!this.runtime.fullscreenScalingQuality)t.setSize(this.runtime.draw_width,this.runtime.draw_height);var e,i;for(e=this.layers.length-1;0<=e;--e)if((i=this.layers[e]).visible&&1===i.opacity&&i.shaders_preserve_opaqueness&&0===i.blend_mode&&(i.instances.length||!i.transparent))i.drawGL_earlyZPass(t);else i.updateViewport(null);t.setEarlyZPass(!1)},t.prototype.drawGL=function(t){this.lerpScrollX(),this.lerpScrollY();var e,i,n,r=0<this.active_effect_types.length||this.runtime.uses_background_blending||!this.runtime.fullscreenScalingQuality||this.runtime.enableFrontToBack;if(r){if(!this.runtime.layout_tex)this.runtime.layout_tex=t.createEmptyTexture(this.runtime.draw_width,this.runtime.draw_height,this.runtime.linearSampling);if(this.runtime.layout_tex.c2width!==this.runtime.draw_width||this.runtime.layout_tex.c2height!==this.runtime.draw_height)t.deleteTexture(this.runtime.layout_tex),this.runtime.layout_tex=t.createEmptyTexture(this.runtime.draw_width,this.runtime.draw_height,this.runtime.linearSampling);if(t.setRenderingToTexture(this.runtime.layout_tex),!this.runtime.fullscreenScalingQuality)t.setSize(this.runtime.draw_width,this.runtime.draw_height)}else if(this.runtime.layout_tex)t.setRenderingToTexture(null),t.deleteTexture(this.runtime.layout_tex),this.runtime.layout_tex=null;if(this.runtime.clearBackground&&!this.hasOpaqueBottomLayer()){var o=this.runtime.backgroundColor;t.clear(o[0],o[1],o[2],100*o[3])}for(e=0,i=this.layers.length;e<i;e++)if((n=this.layers[e]).visible&&0<n.opacity&&(n.instances.length||!n.transparent))n.drawGL(t);else n.updateViewport(null);if(r)if(0===this.active_effect_types.length||1===this.active_effect_types.length&&this.runtime.fullscreenScalingQuality){if(1===this.active_effect_types.length){var s=this.active_effect_types[0].index,a=this.calculateViewRect();if(t.switchProgram(this.active_effect_types[0].shaderindex),t.setProgramParameters(null,1/this.runtime.draw_width,1/this.runtime.draw_height,0,0,1,1,0,0,1,1,a.left,a.top,a.right,a.bottom,0,0,1,1,this.scale,this.angle,this.runtime.kahanTime.sum,this.effect_params[s]),t.programIsAnimated(this.active_effect_types[0].shaderindex))this.runtime.redraw=!0}else t.switchProgram(0);if(!this.runtime.fullscreenScalingQuality)t.setSize(this.runtime.width,this.runtime.height);t.setRenderingToTexture(null),t.setDepthTestEnabled(!1),t.setOpacity(1),t.setTexture(this.runtime.layout_tex),t.setAlphaBlend(),t.resetModelView(),t.updateModelView();var l=this.runtime.width/2,c=this.runtime.height/2;t.quad(-l,c,l,c,l,-c,-l,-c),t.setTexture(null),t.setDepthTestEnabled(!0)}else this.renderEffectChain(t,null,null,null)},t.prototype.getRenderTarget=function(){if(0<this.active_effect_types.length||this.runtime.uses_background_blending||!this.runtime.fullscreenScalingQuality||this.runtime.enableFrontToBack)return this.runtime.layout_tex;else return null},t.prototype.getMinLayerScale=function(){var t,e,i,n,r;for(i=0,n=this.layers.length;i<n;i++)if(t=(r=this.layers[i]).getScale(),!isNaN(e)){if(0!==r.parallaxX||0!==r.parallaxY)e=Math.max(t,e)}else e=t;return e},t.prototype.lerpScrollX=function(){if(Math.round(this.scrollX)!==Math.round(this.scrollTargetX)&&void 0!==this.scrollTargetX&&0!==this.scrollSpeedX){var t=this.runtime.dt*this.scrollSpeedX;if(this.scrollX=drama.lerp(this.scrollX,this.scrollTargetX,1<t?1:t),xf.EventCenter.instance.sendEvent(new xf.EventData(xf.EventType.SCROLL_LAYOUT_X,this.scrollX)),this.runtime.redraw=!0,Math.round(this.scrollX)===Math.round(this.scrollTargetX))this.scrollSpeedX=0,this.scrollX=this.scrollTargetX}else this.scrollSpeedX=0},t.prototype.lerpScrollY=function(){if(Math.round(this.scrollY)!==Math.round(this.scrollTargetY)&&void 0!==this.scrollTargetY&&0!==this.scrollSpeedY){var t=drama.lerp(this.scrollY,this.scrollTargetY,this.runtime.dt*this.scrollSpeedY);if(this.scrollTargetY>this.scrollY)this.scrollY=Math.abs(t)>Math.abs(this.scrollTargetY)?this.scrollTargetY:t;else this.scrollY=Math.abs(t)<Math.abs(this.scrollTargetY)?this.scrollTargetY:t;if(xf.EventCenter.instance.sendEvent(new xf.EventData(xf.EventType.SCROLL_LAYOUT_Y,this.scrollY)),this.runtime.redraw=!0,Math.round(this.scrollY)===Math.round(this.scrollTargetY))this.scrollSpeedY=0,this.scrollY=this.scrollTargetY}else this.scrollSpeedY=0},t.prototype.scrollToX=function(t,e){if(!(e<=0)){if(!this.unbounded_scrolling){var i=this.runtime.draw_width*(1/this.getMinLayerScale())/2;if(t>this.width-i)t=this.width-i;if(t<i)t=i}if(this.scrollX!==t){if(e<60)this.scrollSpeedX=e,this.scrollTargetX=t;else this.scrollSpeedX=0,this.scrollX=t;this.runtime.redraw=!0}}},t.prototype.scrollToY=function(t,e){if(!(e<=0)){if(!this.unbounded_scrolling){var i=this.runtime.draw_height*(1/this.getMinLayerScale())/2;if(t>this.height-i)t=this.height-i;if(t<i)t=i}if(this.scrollY!==t){if(e<60)this.scrollSpeedY=e,this.scrollTargetY=t;else this.scrollSpeedY=0,this.scrollY=t;this.runtime.redraw=!0}}},t.prototype.boundScrolling=function(){this.scrollToX(this.scrollX),this.scrollToY(this.scrollY),xf.EventCenter.instance.sendEvent(new xf.EventData(xf.EventType.SCROLL_LAYOUT_X,this.scrollX)),xf.EventCenter.instance.sendEvent(new xf.EventData(xf.EventType.SCROLL_LAYOUT_Y,this.scrollY))},t.prototype.calculateViewRect=function(){var t=this.scrollX,e=this.scrollY,i=1/(this.scale*this.runtime.aspect_scale);return t-=this.runtime.width*i/2,e-=this.runtime.height*i/2,this.viewRect.set(t,e,t+this.runtime.draw_width*i,e+this.runtime.draw_height*i),this.viewRect},t.prototype.renderEffectChain=function(t,e,i,n){var r=i?i.active_effect_types:e?e.active_effect_types:this.active_effect_types,o=1,s=0,a=0,l=0,c=this.runtime.draw_width,u=this.runtime.draw_height;if(i)o=i.layer.getScale(),s=i.layer.getAngle(),a=i.layer.viewLeft,l=i.layer.viewTop,c=i.layer.viewRight,u=i.layer.viewBottom;else if(e)o=e.getScale(),s=e.getAngle(),a=e.viewLeft,l=e.viewTop,c=e.viewRight,u=e.viewBottom;else{o=this.scale,s=this.angle;var h=this.calculateViewRect();a=h.left,l=h.top,c=h.right,u=h.bottom}var d,p,f,m,g,y,v=this.runtime.fx_tex,b=0,_=1,w=this.runtime.draw_width,x=this.runtime.draw_height,S=w/2,I=x/2,T=e?e.rcTexBounce:this.rcTexBounce,C=e?e.rcTexDest:this.rcTexDest,O=e?e.rcTexOrigin:this.rcTexOrigin,P=0,E=0,A=0,k=0,M=w,R=w,L=x,D=x,N=0,B=0,F=i?i.layer.getAngle():0;if(i){for(d=0,p=r.length;d<p;d++)N+=t.getProgramBoxExtendHorizontal(r[d].shaderindex),B+=t.getProgramBoxExtendVertical(r[d].shaderindex);var j=i.bbox;if(P=e.layerToCanvas(j.left,j.top,!0,!0),A=e.layerToCanvas(j.left,j.top,!1,!0),M=e.layerToCanvas(j.right,j.bottom,!0,!0),L=e.layerToCanvas(j.right,j.bottom,!1,!0),0!==F){var G=e.layerToCanvas(j.right,j.top,!0,!0),V=e.layerToCanvas(j.right,j.top,!1,!0),U=e.layerToCanvas(j.left,j.bottom,!0,!0),W=e.layerToCanvas(j.left,j.bottom,!1,!0);m=Math.min(P,M,G,U),M=Math.max(P,M,G,U),P=m,m=Math.min(A,L,V,W),L=Math.max(A,L,V,W),A=m}if(O.left=P/w,O.top=1-A/x,O.right=M/w,O.bottom=1-L/x,P-=N,A-=B,M+=N,L+=B,C.left=P/w,C.top=1-A/x,C.right=M/w,C.bottom=1-L/x,E=P=drama.floor(P),k=A=drama.floor(A),R=M=drama.ceil(M),D=L=drama.ceil(L),P<0)P=0;if(A<0)A=0;if(w<M)M=w;if(x<L)L=x;if((E-=N)<0)E=0;if((k-=B)<0)k=0;if(w<(R+=N))R=w;if(x<(D+=B))D=x;T.left=P/w,T.top=1-A/x,T.right=M/w,T.bottom=1-L/x}else T.left=C.left=O.left=0,T.top=C.top=O.top=0,T.right=C.right=O.right=1,T.bottom=C.bottom=C.bottom=1;var $=i&&(t.programUsesDest(r[0].shaderindex)||0!==N||0!==B||1!==i.opacity||i.type.plugin.must_predraw)||e&&!i&&1!==e.opacity;if(t.setAlphaBlend(),$){if(!v[b])v[b]=t.createEmptyTexture(w,x,this.runtime.linearSampling);if(v[b].c2width!==w||v[b].c2height!==x)t.deleteTexture(v[b]),v[b]=t.createEmptyTexture(w,x,this.runtime.linearSampling);if(t.switchProgram(0),t.setRenderingToTexture(v[b]),g=x-k-(y=D-k),t.clearRect(E,g,R-E,y),i)i.drawGL(t);else t.setTexture(this.runtime.layer_tex),t.setOpacity(e.opacity),t.resetModelView(),t.translate(-S,-I),t.updateModelView(),t.quadTex(P,L,M,L,M,A,P,A,T);if(C.left=C.top=0,C.right=C.bottom=1,i)m=T.top,T.top=T.bottom,T.bottom=m;b=1,_=0}t.setOpacity(1),f=r.length-1;var H=t.programUsesCrossSampling(r[f].shaderindex)||!e&&!i&&!this.runtime.fullscreenScalingQuality,J=0;for(d=0,p=r.length;d<p;d++){if(!v[b])v[b]=t.createEmptyTexture(w,x,this.runtime.linearSampling);if(v[b].c2width!==w||v[b].c2height!==x)t.deleteTexture(v[b]),v[b]=t.createEmptyTexture(w,x,this.runtime.linearSampling);if(t.switchProgram(r[d].shaderindex),J=r[d].index,t.programIsAnimated(r[d].shaderindex))this.runtime.redraw=!0;if(0==d&&!$){if(t.setRenderingToTexture(v[b]),g=x-k-(y=D-k),t.clearRect(E,g,R-E,y),i){var K=0,q=0,z=1,X=1,Y=1/i.width,Q=1/i.height;if(i.curFrame&&i.curFrame.sheetTex)if(K=i.curFrame.sheetTex.left,q=i.curFrame.sheetTex.top,z=i.curFrame.sheetTex.right,X=i.curFrame.sheetTex.bottom,i.curFrame.texture_img)Y=1/i.curFrame.texture_img.width,Q=1/i.curFrame.texture_img.height;t.setProgramParameters(n,Y,Q,K,q,z,X,K,q,z,X,i.bbox.left,i.bbox.top,i.bbox.right,i.bbox.bottom,C.left,C.top,C.right,C.bottom,o,s,this.runtime.kahanTime.sum,i.effect_params[J]),i.drawGL(t)}else t.setProgramParameters(n,1/w,1/x,0,0,1,1,0,0,1,1,a,l,c,u,0,0,1,1,o,s,this.runtime.kahanTime.sum,e?e.effect_params[J]:this.effect_params[J]),t.setTexture(e?this.runtime.layer_tex:this.runtime.layout_tex),t.resetModelView(),t.translate(-S,-I),t.updateModelView(),t.quadTex(P,L,M,L,M,A,P,A,T);if(C.left=C.top=0,C.right=C.bottom=1,i&&!H)m=L,L=A,A=m}else{if(t.setProgramParameters(n,1/w,1/x,0,0,1,1,O.left,O.top,O.right,O.bottom,a,l,c,u,C.left,C.top,C.right,C.bottom,o,s,this.runtime.kahanTime.sum,i?i.effect_params[J]:e?e.effect_params[J]:this.effect_params[J]),t.setTexture(null),d===f&&!H){if(i)t.setBlend(i.srcBlend,i.destBlend);else if(e)t.setBlend(e.srcBlend,e.destBlend);t.setRenderingToTexture(n)}else t.setRenderingToTexture(v[b]),g=x-k-(y=D-k),t.clearRect(E,g,R-E,y);if(t.setTexture(v[_]),t.resetModelView(),t.translate(-S,-I),t.updateModelView(),t.quadTex(P,L,M,L,M,A,P,A,T),d===f&&!H)t.setTexture(null)}_=0===(b=0===b?1:0)?1:0}if(H){if(t.switchProgram(0),i)t.setBlend(i.srcBlend,i.destBlend);else if(e)t.setBlend(e.srcBlend,e.destBlend);else if(!this.runtime.fullscreenScalingQuality)t.setSize(this.runtime.width,this.runtime.height),S=this.runtime.width/2,I=this.runtime.height/2,A=P=0,M=this.runtime.width,L=this.runtime.height;if(t.setRenderingToTexture(n),t.setTexture(v[_]),t.resetModelView(),t.translate(-S,-I),t.updateModelView(),i&&1===r.length&&!$)t.quadTex(P,A,M,A,M,L,P,L,T);else t.quadTex(P,L,M,L,M,A,P,A,T);t.setTexture(null)}},t.prototype.getLayerBySid=function(t){var e,i;for(e=0,i=this.layers.length;e<i;e++)if(this.layers[e].sid===t)return this.layers[e];return null},t.prototype.saveToJSON=function(){var t,e,i,n,r={sx:this.scrollX,sy:this.scrollY,s:this.scale,a:this.angle,w:this.width,h:this.height,fv:this.first_visit,persist:this.persist_data,fx:[],layers:{}};for(t=0,e=this.effect_types.length;t<e;t++)n=this.effect_types[t],r.fx.push({name:n.name,active:n.active,params:this.effect_params[n.index]});for(t=0,e=this.layers.length;t<e;t++)i=this.layers[t],r.layers[i.sid.toString()]=i.saveToJSON();return r},t.prototype.loadFromJSON=function(t){var e,i,n,r,o;if(this.scrollX=t.sx,this.scrollY=t.sy,this.scale=t.s,this.angle=t.a,this.width=t.w,this.height=t.h,this.persist_data=t.persist,void 0!==t.fv)this.first_visit=t.fv;var s=t.fx;for(e=0,i=s.length;e<i;e++)if(n=this.getEffectByName(s[e].name))n.active=s[e].active,this.effect_params[n.index]=s[e].params;this.updateActiveEffects();var a=t.layers;for(r in a)if(a.hasOwnProperty(r)){if(!(o=this.getLayerBySid(parseInt(r,10))))continue;o.loadFromJSON(a[r])}},drama.layout=t}(),assert2(drama,"drama namespace not created"),function(){function a(t,e){return t.zindex-e.zindex}function p(i){return function(t,e){if(t.y===e.y&&t.x===e.x)return t.uid-e.uid;else if(1===i)return t.y!==e.y?t.y-e.y:t.x-e.x;else if(2===i)return t.y!==e.y?e.y-t.y:t.x-e.x;else if(3===i)return t.y!==e.y?t.y-e.y:e.x-t.x;else if(4===i)return t.y!==e.y?e.y-t.y:e.x-t.x}}function t(t,e){if(this.layout=t,this.runtime=t.runtime,this.instances=[],this.scale=1,this.angle=0,this.disableAngle=!1,this.tmprect=new drama.rect(0,0,0,0),this.tmpquad=new drama.quad,this.viewLeft=0,this.viewRight=0,this.viewTop=0,this.viewBottom=0,this.zindices_stale=!1,this.zindices_stale_from=-1,this.clear_earlyz_index=0,this.name=e[0],this.index=e[1],this.initial_index=e[1],this.sid=e[2],this.visible=e[3],this.background_color=e[4],this.transparent=e[5],this.parallaxX=e[6],this.parallaxY=e[7],this.opacity=e[8],this.forceOwnTexture=e[9],this.useRenderCells=e[10],this.zoomRate=e[11],this.blend_mode=e[12],this.effect_fallback=e[13],this.compositeOp="source-over",this.srcBlend=0,this.destBlend=0,this.render_grid=null,this.last_render_list=l(),this.render_list_stale=!0,this.last_render_cells=new drama.rect(0,0,-1,-1),this.cur_render_cells=new drama.rect(0,0,-1,-1),this.useRenderCells)this.render_grid=new drama.RenderGrid(this.runtime.original_width,this.runtime.original_height);this.render_offscreen=!1;var i,n,r=e[14];for(this.startup_initial_instances=[],this.initial_instances=[],this.created_globals=[],i=0,n=r.length;i<n;i++){var o=r[i],s=this.runtime.types_by_index[o[1]];if(assert2(s,"Could not find object type: "+o.type_name),!s.default_instance)s.default_instance=o,s.default_layerindex=this.index;if(this.initial_instances.push(o),-1===this.layout.initial_types.indexOf(s))this.layout.initial_types.push(s)}for(drama.shallowAssignArray(this.startup_initial_instances,this.initial_instances),this.effect_types=[],this.active_effect_types=[],this.shaders_preserve_opaqueness=!0,this.effect_params=[],i=0,n=e[15].length;i<n;i++)this.effect_types.push({id:e[15][i][0],name:e[15][i][1],shaderindex:-1,preservesOpaqueness:!1,active:!0,index:i}),this.effect_params.push(e[15][i][2].slice(0));this.isAutoSortZIndex=e[16],this.sortZIndexRule=e[17],this.updateActiveEffects(),this.rcTexBounce=new drama.rect(0,0,1,1),this.rcTexDest=new drama.rect(0,0,1,1),this.rcTexOrigin=new drama.rect(0,0,1,1),this.collisionIndex=e[18]||0}t.prototype.updateActiveEffects=function(){var t,e,i;for(drama.clearArray(this.active_effect_types),this.shaders_preserve_opaqueness=!0,t=0,e=this.effect_types.length;t<e;t++)if((i=this.effect_types[t]).active)if(this.active_effect_types.push(i),!i.preservesOpaqueness)this.shaders_preserve_opaqueness=!1},t.prototype.getEffectByName=function(t){var e,i,n;for(e=0,i=this.effect_types.length;e<i;e++)if((n=this.effect_types[e]).name===t)return n;return null},t.prototype.createInitialInstances=function(t){var e,i,n,r,o,s,a;for(i=e=0,n=this.initial_instances.length;e<n;e++){o=this.initial_instances[e];for(var l=0,c=0,u=(s=this.runtime.types_by_index[o[1]]).behaviors.length;c<u;c++)if(drama.behaviors.Scroll&&s.behaviors[c].behavior instanceof drama.behaviors.Scroll)l++;if(assert2(s,"Null type in initial instance"),a=!0,!this.runtime.typeHasPersistBehavior(s)||this.layout.first_visit){if(o[6]=0,!(r=this.runtime.createInstanceFromInit(o,this,!0)))continue;if(t.push(r),1<l)for(var h=1;h<l;h++)o[6]=h,r=this.runtime.createInstanceFromInit(o,this,!0),t.push(r);if(r.type.global)a=!1,this.created_globals.push(r.uid)}if(a)this.initial_instances[i]=this.initial_instances[e],i++}if(this.initial_instances.length=i,this.runtime.ClearDeathRow(),!this.runtime.glwrap&&this.effect_types.length)this.blend_mode=this.effect_fallback;if(this.compositeOp=drama.effectToCompositeOp(this.blend_mode),this.runtime.gl)drama.setGLBlend(this,this.blend_mode,this.runtime.gl);this.render_list_stale=!0},t.prototype.recreateInitialObjects=function(t,e){var i,n,r,o,s,a,l,c,u,h,d,p=this.runtime.types_by_index,f=t.is_family,m=t.members;for(i=0,n=this.initial_instances.length;i<n;++i)if(a=(s=(r=this.initial_instances[i])[0])[0],l=s[1],e.contains_pt(a,l)){if((o=p[r[1]])!==t)if(f){if(m.indexOf(o)<0)continue}else continue;if(c=this.runtime.createInstanceFromInit(r,this,!1),this.runtime.isInOnDestroy++,this.runtime.trigger(Object.getPrototypeOf(o.plugin).cnds.OnCreated,c),c.is_contained)for(u=0,h=c.siblings.length;u<h;u++)d=c.siblings[i],this.runtime.trigger(Object.getPrototypeOf(d.type.plugin).cnds.OnCreated,d);this.runtime.isInOnDestroy--}},t.prototype.removeFromInstanceList=function(t,e){var i=drama.fastIndexOf(this.instances,t);if(!(i<0)){if(e&&this.useRenderCells&&t.rendercells&&t.rendercells.right>=t.rendercells.left)t.update_bbox(),this.render_grid.update(t,t.rendercells,null),t.rendercells.set(0,0,-1,-1);if(i===this.instances.length-1)this.instances.pop();else drama.arrayRemove(this.instances,i),this.setZIndicesStaleFrom(i);this.render_list_stale=!0}},t.prototype.appendToInstanceList=function(t,e){if(assert2(t.layer===this,"Adding instance to wrong layer"),t.zindex=this.instances.length,this.instances.push(t),e&&this.useRenderCells&&t.rendercells)t.set_bbox_changed();this.render_list_stale=!0},t.prototype.prependToInstanceList=function(t,e){if(assert2(t.layer===this,"Adding instance to wrong layer"),this.instances.unshift(t),this.setZIndicesStaleFrom(0),e&&this.useRenderCells&&t.rendercells)t.set_bbox_changed()},t.prototype.moveInstanceAdjacent=function(t,e,i){assert2(t.layer===this&&e.layer===this,"Can't arrange Z order unless both objects on this layer");var n=t.get_zindex(),r=e.get_zindex();if(drama.arrayRemove(this.instances,n),n<r)r--;if(i)r++;if(r===this.instances.length)this.instances.push(t);else this.instances.splice(r,0,t);this.setZIndicesStaleFrom(n<r?n:r)},t.prototype.setZIndicesStaleFrom=function(t){if(-1===this.zindices_stale_from)this.zindices_stale_from=t;else if(t<this.zindices_stale_from)this.zindices_stale_from=t;this.zindices_stale=!0,this.render_list_stale=!0},t.prototype.updateZIndices=function(){if(this.zindices_stale){if(-1===this.zindices_stale_from)this.zindices_stale_from=0;var t,e,i;if(this.useRenderCells)for(t=this.zindices_stale_from,e=this.instances.length;t<e;++t)(i=this.instances[t]).zindex=t,this.render_grid.markRangeChanged(i.rendercells);else for(t=this.zindices_stale_from,e=this.instances.length;t<e;++t)this.instances[t].zindex=t;this.zindices_stale=!1,this.zindices_stale_from=-1}},t.prototype.getScale=function(t){return this.getNormalScale()*(this.runtime.fullscreenScalingQuality||t?this.runtime.aspect_scale:1)},t.prototype.getNormalScale=function(){return(this.scale*this.layout.scale-1)*this.zoomRate+1},t.prototype.getAngle=function(){if(this.disableAngle)return 0;else return drama.clamp_angle(this.layout.angle+this.angle)};var e=[];function l(){if(e.length)return e.pop();else return[]}function f(t){drama.clearArray(t),e.push(t)}function c(t,e,i){var n,r,o=0,s=0,a=0,l=t.length,c=e.length;for(i.length=l+c;o<l&&s<c;++a)if(n=t[o],r=e[s],n.zindex<r.zindex)i[a]=n,++o;else i[a]=r,++s;for(;o<l;++o,++a)i[a]=t[o];for(;s<c;++s,++a)i[a]=e[s]}var u=[];function i(t,e){var i,n,r,o,s;for(i=0,n=t.length;i<n-1;i+=2){if(c(r=t[i],o=t[i+1],s=l()),!e)f(r),f(o);u.push(s)}if(n%2==1)if(e)r=l(),drama.shallowAssignArray(r,t[n-1]),u.push(r);else u.push(t[n-1]);drama.shallowAssignArray(t,u),drama.clearArray(u)}var n=[];t.prototype.getRenderCellInstancesToDraw=function(){if(assert2(this.useRenderCells,"Cannot call getRenderCellInstancesToDraw when not using render cells"),this.updateZIndices(),this.render_grid.queryRange(this.viewLeft,this.viewTop,this.viewRight,this.viewBottom,n),!n.length)return l();if(1===n.length){var t=l();return drama.shallowAssignArray(t,n[0]),drama.clearArray(n),t}var e=function(t){for(var e=!0;1<t.length;)i(t,e),e=!1;return t[0]}(n);return drama.clearArray(n),e},t.prototype.draw=function(t){this.render_offscreen=this.forceOwnTexture||1!==this.opacity||0!==this.blend_mode;var e=this.runtime.canvas,i=t,n=!1;if(this.render_offscreen){if(!this.runtime.layer_canvas)this.runtime.layer_canvas=document.createElement("canvas"),assert2(this.runtime.layer_canvas,"Could not create layer canvas - render-to-texture won't work!"),(e=this.runtime.layer_canvas).width=this.runtime.draw_width,e.height=this.runtime.draw_height,this.runtime.layer_ctx=e.getContext("2d"),assert2(this.runtime.layer_ctx,"Could not get layer 2D context - render-to-texture won't work!"),n=!0;if(e=this.runtime.layer_canvas,i=this.runtime.layer_ctx,e.width!==this.runtime.draw_width)e.width=this.runtime.draw_width,n=!0;if(e.height!==this.runtime.draw_height)e.height=this.runtime.draw_height,n=!0;if(n)i.imageSmoothingEnabled=this.runtime.linearSampling;if(this.transparent)i.clearRect(0,0,this.runtime.draw_width,this.runtime.draw_height)}if(i.globalAlpha=1,i.globalCompositeOperation="source-over",!this.transparent)i.fillStyle="rgb("+this.background_color[0]+","+this.background_color[1]+","+this.background_color[2]+")",i.fillRect(0,0,this.runtime.draw_width,this.runtime.draw_height);i.save(),this.disableAngle=!0;var r=this.canvasToLayer(0,0,!0,!0),o=this.canvasToLayer(0,0,!1,!0);if(this.disableAngle=!1,this.runtime.pixel_rounding)r=Math.round(r),o=Math.round(o);this.rotateViewport(r,o,i);var s,a,l,c,u=this.getScale();if(i.scale(u,u),i.translate(-r,-o),this.useRenderCells)if(this.cur_render_cells.left=this.render_grid.XToCell(this.viewLeft),this.cur_render_cells.top=this.render_grid.YToCell(this.viewTop),this.cur_render_cells.right=this.render_grid.XToCell(this.viewRight),this.cur_render_cells.bottom=this.render_grid.YToCell(this.viewBottom),this.render_list_stale||!this.cur_render_cells.equals(this.last_render_cells))f(this.last_render_list),s=this.getRenderCellInstancesToDraw(),this.render_list_stale=!1,this.last_render_cells.copy(this.cur_render_cells);else s=this.last_render_list;else s=this.instances;if(this.isAutoSortZIndex)s.sort(p(this.sortZIndexRule)),this.render_list_stale=!0;var h=null;for(a=0,l=s.length;a<l;++a)if((c=s[a])!==h)this.drawInstance(c,i),h=c;if(this.useRenderCells)this.last_render_list=s;if(i.restore(),this.render_offscreen)t.globalCompositeOperation=this.compositeOp,t.globalAlpha=this.opacity,t.drawImage(e,0,0)},t.prototype.drawInstance=function(t,e){if(t.visible&&0!==t.width&&0!==t.height){t.update_bbox();var i=t.bbox;if(!(i.right<this.viewLeft||i.bottom<this.viewTop||i.left>this.viewRight||i.top>this.viewBottom))e.globalCompositeOperation=t.compositeOp,t.draw(e)}},t.prototype.updateViewport=function(t){this.disableAngle=!0;var e=this.canvasToLayer(0,0,!0,!0),i=this.canvasToLayer(0,0,!1,!0);if(this.disableAngle=!1,this.runtime.pixel_rounding)e=Math.round(e),i=Math.round(i);this.rotateViewport(e,i,t)},t.prototype.rotateViewport=function(t,e,i){var n=this.getScale();this.viewLeft=t,this.viewTop=e,this.viewRight=t+this.runtime.draw_width*(1/n),this.viewBottom=e+this.runtime.draw_height*(1/n);var r=this.getAngle();if(0!==r){if(i)i.translate(this.runtime.draw_width/2,this.runtime.draw_height/2),i.rotate(-r),i.translate(this.runtime.draw_width/-2,this.runtime.draw_height/-2);this.tmprect.set(this.viewLeft,this.viewTop,this.viewRight,this.viewBottom),this.tmprect.offset((this.viewLeft+this.viewRight)/-2,(this.viewTop+this.viewBottom)/-2),this.tmpquad.set_from_rotated_rect(this.tmprect,r),this.tmpquad.bounding_box(this.tmprect),this.tmprect.offset((this.viewLeft+this.viewRight)/2,(this.viewTop+this.viewBottom)/2),this.viewLeft=this.tmprect.left,this.viewTop=this.tmprect.top,this.viewRight=this.tmprect.right,this.viewBottom=this.tmprect.bottom}},t.prototype.drawGL_earlyZPass=function(t){if(this.render_offscreen=this.forceOwnTexture,this.render_offscreen){if(!this.runtime.layer_tex)this.runtime.layer_tex=t.createEmptyTexture(this.runtime.draw_width,this.runtime.draw_height,this.runtime.linearSampling);if(this.runtime.layer_tex.c2width!==this.runtime.draw_width||this.runtime.layer_tex.c2height!==this.runtime.draw_height)t.deleteTexture(this.runtime.layer_tex),this.runtime.layer_tex=t.createEmptyTexture(this.runtime.draw_width,this.runtime.draw_height,this.runtime.linearSampling);t.setRenderingToTexture(this.runtime.layer_tex)}this.disableAngle=!0;var e=this.canvasToLayer(0,0,!0,!0),i=this.canvasToLayer(0,0,!1,!0);if(this.disableAngle=!1,this.runtime.pixel_rounding)e=Math.round(e),i=Math.round(i);this.rotateViewport(e,i,null);var n,r,o,s=this.getScale();if(t.resetModelView(),t.scale(s,s),t.rotateZ(-this.getAngle()),t.translate((this.viewLeft+this.viewRight)/-2,(this.viewTop+this.viewBottom)/-2),t.updateModelView(),this.useRenderCells)if(this.cur_render_cells.left=this.render_grid.XToCell(this.viewLeft),this.cur_render_cells.top=this.render_grid.YToCell(this.viewTop),this.cur_render_cells.right=this.render_grid.XToCell(this.viewRight),this.cur_render_cells.bottom=this.render_grid.YToCell(this.viewBottom),this.render_list_stale||!this.cur_render_cells.equals(this.last_render_cells))f(this.last_render_list),n=this.getRenderCellInstancesToDraw(),this.render_list_stale=!1,this.last_render_cells.copy(this.cur_render_cells);else n=this.last_render_list;else n=this.instances;var a=null;for(r=n.length-1;0<=r;--r)if((o=n[r])!==a)this.drawInstanceGL_earlyZPass(n[r],t),a=o;if(this.useRenderCells)this.last_render_list=n;if(!this.transparent)this.clear_earlyz_index=this.runtime.earlyz_index++,t.setEarlyZIndex(this.clear_earlyz_index),t.setColorFillMode(1,1,1,1),t.fullscreenQuad(),t.restoreEarlyZMode()},t.prototype.drawGL=function(t){var e=0,i=0;if(this.render_offscreen=this.forceOwnTexture||1!==this.opacity||0<this.active_effect_types.length||0!==this.blend_mode,this.render_offscreen){if(!this.runtime.layer_tex)this.runtime.layer_tex=t.createEmptyTexture(this.runtime.draw_width,this.runtime.draw_height,this.runtime.linearSampling);if(this.runtime.layer_tex.c2width!==this.runtime.draw_width||this.runtime.layer_tex.c2height!==this.runtime.draw_height)t.deleteTexture(this.runtime.layer_tex),this.runtime.layer_tex=t.createEmptyTexture(this.runtime.draw_width,this.runtime.draw_height,this.runtime.linearSampling);if(t.setRenderingToTexture(this.runtime.layer_tex),this.transparent)t.clear(0,0,0,0)}if(!this.transparent)if(this.runtime.enableFrontToBack)t.setEarlyZIndex(this.clear_earlyz_index),t.setColorFillMode(this.background_color[0]/255,this.background_color[1]/255,this.background_color[2]/255,1),t.fullscreenQuad(),t.setTextureFillMode();else t.clear(this.background_color[0]/255,this.background_color[1]/255,this.background_color[2]/255,1);this.disableAngle=!0;var n=this.canvasToLayer(0,0,!0,!0),r=this.canvasToLayer(0,0,!1,!0);if(this.disableAngle=!1,this.runtime.pixel_rounding)n=Math.round(n),r=Math.round(r);this.rotateViewport(n,r,null);var o,s,a,l,c=this.getScale();if(t.resetModelView(),t.scale(c,c),t.rotateZ(-this.getAngle()),t.translate((this.viewLeft+this.viewRight)/-2,(this.viewTop+this.viewBottom)/-2),t.updateModelView(),this.useRenderCells)if(this.cur_render_cells.left=this.render_grid.XToCell(this.viewLeft),this.cur_render_cells.top=this.render_grid.YToCell(this.viewTop),this.cur_render_cells.right=this.render_grid.XToCell(this.viewRight),this.cur_render_cells.bottom=this.render_grid.YToCell(this.viewBottom),this.render_list_stale||!this.cur_render_cells.equals(this.last_render_cells))f(this.last_render_list),o=this.getRenderCellInstancesToDraw(),this.render_list_stale=!1,this.last_render_cells.copy(this.cur_render_cells);else o=this.last_render_list;else o=this.instances;if(this.isAutoSortZIndex)o.sort(p(this.sortZIndexRule)),this.render_list_stale=!0;var u=null;for(s=0,a=o.length;s<a;++s)if((l=o[s])!==u)this.drawInstanceGL(o[s],t),u=l;if(this.useRenderCells)this.last_render_list=o;if(this.render_offscreen)if(e=this.active_effect_types.length?this.active_effect_types[0].shaderindex:0,i=this.active_effect_types.length?this.active_effect_types[0].index:0,0===this.active_effect_types.length||1===this.active_effect_types.length&&!t.programUsesCrossSampling(e)&&1===this.opacity){if(1===this.active_effect_types.length){if(t.switchProgram(e),t.setProgramParameters(this.layout.getRenderTarget(),1/this.runtime.draw_width,1/this.runtime.draw_height,0,0,1,1,0,0,1,1,this.viewLeft,this.viewTop,this.viewRight,this.viewBottom,0,0,1,1,c,this.getAngle(),this.runtime.kahanTime.sum,this.effect_params[i]),t.programIsAnimated(e))this.runtime.redraw=!0}else t.switchProgram(0);t.setRenderingToTexture(this.layout.getRenderTarget()),t.setOpacity(this.opacity),t.setTexture(this.runtime.layer_tex),t.setBlend(this.srcBlend,this.destBlend),t.resetModelView(),t.updateModelView();var h=this.runtime.draw_width/2,d=this.runtime.draw_height/2;t.quad(-h,d,h,d,h,-d,-h,-d),t.setTexture(null)}else this.layout.renderEffectChain(t,this,null,this.layout.getRenderTarget())},t.prototype.drawInstanceGL=function(t,e){if(assert2(t.layer===this,"Drawing instance on wrong layer"),t.visible&&0!==t.width&&0!==t.height){t.update_bbox();var i=t.bbox;if(!(i.right<this.viewLeft||i.bottom<this.viewTop||i.left>this.viewRight||i.top>this.viewBottom))if(e.setEarlyZIndex(t.earlyz_index),t.uses_shaders)this.drawInstanceWithShadersGL(t,e);else e.switchProgram(0),e.setBlend(t.srcBlend,t.destBlend),t.drawGL(e)}},t.prototype.drawInstanceGL_earlyZPass=function(t,e){if(assert2(t.layer===this,"Drawing instance on wrong layer"),t.visible&&0!==t.width&&0!==t.height){t.update_bbox();var i=t.bbox;if(!(i.right<this.viewLeft||i.bottom<this.viewTop||i.left>this.viewRight||i.top>this.viewBottom))if(t.earlyz_index=this.runtime.earlyz_index++,0===t.blend_mode&&1===t.opacity&&t.shaders_preserve_opaqueness&&t.drawGL_earlyZPass)e.setEarlyZIndex(t.earlyz_index),t.drawGL_earlyZPass(e)}},t.prototype.drawInstanceWithShadersGL=function(t,e){var i=t.active_effect_types[0].shaderindex,n=t.active_effect_types[0].index,r=this.getScale();if(!(1!==t.active_effect_types.length||e.programUsesCrossSampling(i)||e.programExtendsBox(i)||(t.angle||t.layer.getAngle())&&e.programUsesDest(i)||1!==t.opacity||t.type.plugin.must_predraw)){if(e.switchProgram(i),e.setBlend(t.srcBlend,t.destBlend),e.programIsAnimated(i))this.runtime.redraw=!0;var o=0,s=0,a=0,l=0;if(e.programUsesDest(i)){var c=t.bbox,u=this.layerToCanvas(c.left,c.top,!0,!0),h=this.layerToCanvas(c.left,c.top,!1,!0),d=this.layerToCanvas(c.right,c.bottom,!0,!0),p=this.layerToCanvas(c.right,c.bottom,!1,!0),f=window.innerWidth,m=window.innerHeight;o=u/f,s=1-h/m,a=d/f,l=1-p/m}var g=0,y=0,v=1,b=1,_=1/t.width,w=1/t.height;if(t.curFrame&&t.curFrame.sheetTex)if(g=t.curFrame.sheetTex.left,y=t.curFrame.sheetTex.top,v=t.curFrame.sheetTex.right,b=t.curFrame.sheetTex.bottom,t.curFrame.texture_img)_=1/t.curFrame.texture_img.width,w=1/t.curFrame.texture_img.height;e.setProgramParameters(this.render_offscreen?this.runtime.layer_tex:this.layout.getRenderTarget(),_,w,g,y,v,b,g,y,v,b,t.bbox.left,t.bbox.top,t.bbox.right,t.bbox.bottom,o,s,a,l,r,this.getAngle(),this.runtime.kahanTime.sum,t.effect_params[n]),t.drawGL(e)}else this.layout.renderEffectChain(e,this,t,this.render_offscreen?this.runtime.layer_tex:this.layout.getRenderTarget()),e.resetModelView(),e.scale(r,r),e.rotateZ(-this.getAngle()),e.translate((this.viewLeft+this.viewRight)/-2,(this.viewTop+this.viewBottom)/-2),e.updateModelView()},t.prototype.getFirstTouch=function(t,e){if(!this.visible)return null;var i,n=this.instances;t=this.canvasToLayer(t,e,!0,!1),e=this.canvasToLayer(t,e,!1,!1);for(var r=n.length;0<r;r--)if((i=n[r-1]).visible)if(!i.type.touch_pass)if(i.contains_pt(t,e))return i;return null},t.prototype.checkTouchable=function(t,e,i){if(!this.visible)return null;var n=this.instances;e=this.canvasToLayer(e,i,!0,!1),i=this.canvasToLayer(e,i,!1,!1);for(var r=n.length;0<r;r--){var o=n[r-1];if(o.contains_pt(e,i))if(o.uid!==t.uid){if(o.visible&&!o.type.touch_pass)return!1}else if(o.visible)return!0}return!1},t.prototype.canvasToLayer=function(t,e,i,n){var r=this.runtime.devicePixelRatio;if(this.runtime.isRetina)t*=r,e*=r;var o=this.runtime.parallax_x_origin,s=this.runtime.parallax_y_origin,a=(this.layout.scrollX-o)*this.parallaxX+o,l=(this.layout.scrollY-s)*this.parallaxY+s,c=a,u=l,h=1/this.getScale(!n);if(n)c-=this.runtime.draw_width*h/2,u-=this.runtime.draw_height*h/2;else c-=this.runtime.width*h/2,u-=this.runtime.height*h/2;c+=t*h,u+=e*h;var d=this.getAngle();if(0!==d){c-=a,u-=l;var p=Math.cos(d),f=Math.sin(d),m=c*p-u*f;u=u*p+c*f,c=m,c+=a,u+=l}return i?c:u},t.prototype.layerToCanvas=function(t,e,i,n){var r=this.runtime.parallax_x_origin,o=this.runtime.parallax_y_origin,s=(this.layout.scrollX-r)*this.parallaxX+r,a=(this.layout.scrollY-o)*this.parallaxY+o,l=s,c=a,u=this.getAngle();if(0!==u){t-=s,e-=a;var h=Math.cos(-u),d=Math.sin(-u),p=t*h-e*d;e=e*h+t*d,t=p,t+=s,e+=a}var f=1/this.getScale(!n);if(n)l-=this.runtime.draw_width*f/2,c-=this.runtime.draw_height*f/2;else l-=this.runtime.width*f/2,c-=this.runtime.height*f/2;l=(t-l)/f,c=(e-c)/f;var m=this.runtime.devicePixelRatio;if(this.runtime.isRetina&&!n)l/=m,c/=m;return i?l:c},t.prototype.rotatePt=function(t,e,i){if(0===this.getAngle())return i?t:e;var n=this.layerToCanvas(t,e,!0),r=this.layerToCanvas(t,e,!1);this.disableAngle=!0;var o=this.canvasToLayer(n,r,!0),s=this.canvasToLayer(n,r,!0);return this.disableAngle=!1,i?o:s},t.prototype.saveToJSON=function(){var t,e,i,n={s:this.scale,a:this.angle,vl:this.viewLeft,vt:this.viewTop,vr:this.viewRight,vb:this.viewBottom,v:this.visible,bc:this.background_color,t:this.transparent,px:this.parallaxX,py:this.parallaxY,o:this.opacity,zr:this.zoomRate,fx:[],cg:this.created_globals,instances:[]};for(t=0,e=this.effect_types.length;t<e;t++)i=this.effect_types[t],n.fx.push({name:i.name,active:i.active,params:this.effect_params[i.index]});return n},t.prototype.loadFromJSON=function(t){var e,i,n,r;this.scale=t.s,this.angle=t.a,this.viewLeft=t.vl,this.viewTop=t.vt,this.viewRight=t.vr,this.viewBottom=t.vb,this.visible=t.v,this.background_color=t.bc,this.transparent=t.t,this.parallaxX=t.px,this.parallaxY=t.py,this.opacity=t.o,this.zoomRate=t.zr,this.created_globals=t.cg||[],drama.shallowAssignArray(this.initial_instances,this.startup_initial_instances);var o=new drama.ObjectSet;for(e=0,n=this.created_globals.length;e<n;++e)o.add(this.created_globals[e]);for(i=e=0,n=this.initial_instances.length;e<n;++e)if(!o.contains(this.initial_instances[e][2]))this.initial_instances[i]=this.initial_instances[e],++i;drama.truncateArray(this.initial_instances,i);var s=t.fx;for(e=0,n=s.length;e<n;e++)if(r=this.getEffectByName(s[e].name))r.active=s[e].active,this.effect_params[r.index]=s[e].params;this.updateActiveEffects(),this.instances.sort(a),this.zindices_stale=!0},drama.layer=t}(),assert2(drama,"drama namespace not created"),function(){var s=[];function a(t,e){var i,n=t.length;switch(n){case 0:return!0;case 1:return t[0]===e[0];case 2:return t[0]===e[0]&&t[1]===e[1];default:for(i=0;i<n;i++)if(t[i]!==e[i])return!1;return!0}}function l(t,e){return t.index-e.index}function o(t){var e,i,n,r,o;if(2===t.length){if(t[0].index>t[1].index)r=t[0],t[0]=t[1],t[1]=r}else if(2<t.length)t.sort(l);if(t.length>=s.length)s.length=t.length+1;if(!s[t.length])s[t.length]=[];for(e=0,i=(o=s[t.length]).length;e<i;e++)if(a(t,n=o[e]))return n;return o.push(t),t}function t(t,e){this.runtime=t,this.triggers={},this.fasttriggers={},this.hasRun=!1,this.includes=new drama.ObjectSet,this.deep_includes=[],this.already_included_sheets=[],this.name=e[0];var i,n,r=e[1];for(this.profile_sum=0,this.profile_last=0,this.sub_groups=[],this.next_event_number=1,this.events_by_number=[null],this.events=[],i=0,n=r.length;i<n;i++)this.init_event(r[i],null,this.events)}function e(t){this.type=t,this.instances=[],this.else_instances=[],this.select_all=!0}function i(t,e,i){if(this.sheet=t,this.parent=e,this.runtime=t.runtime,this.solModifiers=[],this.solModifiersIncludingParents=[],this.solWriterAfterCnds=!1,this.group=!1,this.initially_activated=!1,this.toplevelevent=!1,this.toplevelgroup=!1,this.has_else_block=!1,assert2(0===i[0],"Constructing event block for non-block event type"),this.conditions=[],this.actions=[],this.subevents=[],this.sub_groups=[],this.group_name="",this.group=!1,this.initially_activated=!1,this.group_active=!1,this.contained_includes=null,this.profile_sum=0,this.profile_last=0,i[1]){this.group_name=i[1][1].toLowerCase(),this.group=!0,this.initially_activated=!!i[1][0],this.contained_includes=[],this.group_active=this.initially_activated,this.runtime.allGroups.push(this);for(var n=(this.runtime.groups_by_name[this.group_name]=this).parent;n&&!n.group;)n=n.parent;if(n)n.sub_groups.push(this);else this.sheet.sub_groups.push(this)}if(this.orblock=i[2],this.sid=i[4],!this.group)this.runtime.blocksBySid[this.sid.toString()]=this;var r,o,s=i[5];for(r=0,o=s.length;r<o;r++){var a=new drama.condition(this,s[r]);a.index=r,drama.seal(a),this.conditions.push(a),this.addSolModifier(a.type)}var l=i[6];for(r=0,o=l.length;r<o;r++){var c=new drama.action(this,l[r]);c.index=r,drama.seal(c),this.actions.push(c)}if(8===i.length){var u=i[7];for(r=0,o=u.length;r<o;r++)this.sheet.init_event(u[r],this,this.subevents)}if(this.is_else_block=!1,this.conditions.length)this.is_else_block=null==this.conditions[0].type&&this.conditions[0].func==drama.system_object.prototype.cnds.Else}function n(t,e){var i,n,r;if(t){if(-1===e.indexOf(t))e.push(t);if(t.is_contained)for(i=0,n=t.container.length;i<n;i++)if(t!==(r=t.container[i]))if(-1===e.indexOf(r))e.push(r)}}function r(t,e){if(this.block=t,this.sheet=t.sheet,this.runtime=t.runtime,this.parameters=[],this.results=[],this.extra={},this.index=-1,this.anyParamVariesPerInstance=!1,this.func=this.runtime.GetObjectReference(e[1]),assert2(this.func,"Condition method appears to be missing, check ACE table names match script names"),this.trigger=0<e[3],this.fasttrigger=2===e[3],this.looping=e[4],this.inverted=e[5],this.isstatic=e[6],this.sid=e[7],this.is_breakpoint=this.runtime.isDebug&&e[8],this.runtime.cndsBySid[this.sid.toString()]=this,-1===e[0])this.type=null,this.run=this.run_system,this.behaviortype=null,this.beh_index=-1;else{if(this.type=this.runtime.types_by_index[e[0]],assert2(this.type,"Cannot find object type for condition '"+e[0]+"'"),this.isstatic)this.run=this.run_static;else this.run=this.run_object;if(e[2])this.behaviortype=this.type.getBehaviorByName(e[2]),assert2(this.behaviortype,"Cannot find behavior '"+e[2]+"' for '"+e[0]+"'"),this.beh_index=this.type.getBehaviorIndexByName(e[2]),assert2(-1<this.beh_index,"Could not find behavior index by name");else this.behaviortype=null,this.beh_index=-1;if(this.block.parent)this.block.parent.setSolWriterAfterCnds()}if(this.fasttrigger)this.run=this.run_true;if(10===e.length){var i,n,r=e[9];for(i=0,n=r.length;i<n;i++){var o=new drama.parameter(this,r[i]);drama.seal(o),this.parameters.push(o)}this.results.length=r.length}}function c(t,e){if(this.block=t,this.sheet=t.sheet,this.runtime=t.runtime,this.parameters=[],this.results=[],this.extra={},this.index=-1,this.anyParamVariesPerInstance=!1,this.func=this.runtime.GetObjectReference(e[1]),assert2(this.func,"Action method appears to be missing, check ACE table names match script names"),-1===e[0])this.type=null,this.run=this.run_system,this.behaviortype=null,this.beh_index=-1;else if(this.type=this.runtime.types_by_index[e[0]],assert2(this.type,"Cannot find type for action '"+e[0]+"'"),this.run=this.run_object,e[2])this.behaviortype=this.type.getBehaviorByName(e[2]),assert2(this.behaviortype,"Cannot find behavior type '"+e[2]+"'"),this.beh_index=this.type.getBehaviorIndexByName(e[2]),assert2(-1<this.beh_index,"Could not find behavior by name");else this.behaviortype=null,this.beh_index=-1;if(this.sid=e[3],this.is_breakpoint=this.runtime.isDebug&&e[4],this.runtime.actsBySid[this.sid.toString()]=this,6===e.length){var i,n,r=e[5];for(i=0,n=r.length;i<n;i++){var o=new drama.parameter(this,r[i]);drama.seal(o),this.parameters.push(o)}this.results.length=r.length}}t.prototype.toString=function(){return this.name},t.prototype.init_event=function(t,e,i){switch(t[0]){case 0:var n=new drama.eventblock(this,e,t);if(drama.seal(n),n.orblock){var r,o;for(i.push(n),r=0,o=n.conditions.length;r<o;r++)if(n.conditions[r].trigger)this.init_trigger(n,r)}else if(n.is_trigger())this.init_trigger(n,0);else i.push(n);break;case 1:var s=new drama.eventvariable(this,e,t);drama.seal(s),i.push(s);break;case 2:var a=new drama.eventinclude(this,e,t);drama.seal(a),i.push(a);break;default:assert2(!1,"Event has unknown type: "+t[0])}},t.prototype.postInit=function(){var t,e;for(t=0,e=this.events.length;t<e;t++)this.events[t].postInit(t<e-1&&this.events[t+1].is_else_block)},t.prototype.updateDeepIncludes=function(){drama.clearArray(this.deep_includes),drama.clearArray(this.already_included_sheets),this.addDeepIncludes(this),drama.clearArray(this.already_included_sheets)},t.prototype.addDeepIncludes=function(t){var e,i,n,r,o=t.deep_includes,s=t.already_included_sheets,a=this.includes.valuesRef();for(e=0,i=a.length;e<i;++e)if(r=(n=a[e]).include_sheet,n.isActive()&&t!==r&&!(-1<s.indexOf(r)))s.push(r),r.addDeepIncludes(t),o.push(r)},t.prototype.run=function(t){var e,i,n=drama.performance_now();if(!this.runtime.resuming_breakpoint)if(this.hasRun=!0,!t)this.runtime.isRunningEvents=!0;for(e=0,i=this.events.length;e<i;e++){var r=this.events[e];if(r.run(),this.runtime.hit_breakpoint)return void(this.hasRun=!1);if(!this.runtime.resuming_breakpoint)if(this.runtime.clearSol(r.solModifiers),this.runtime.hasPendingInstances)this.runtime.ClearDeathRow()}if(!this.runtime.resuming_breakpoint)if(!t)this.runtime.isRunningEvents=!1;this.profile_sum+=drama.performance_now()-n},t.prototype.init_trigger=function(t,e){if(!t.orblock)this.runtime.triggers_to_postinit.push(t);var i,n,r,o=t.conditions[e];if(o.type)r=o.type.name;else r="system";var s=o.fasttrigger,a=s?this.fasttriggers:this.triggers;if(!a[r])a[r]=[];var l=a[r],c=o.func;if(s){if(!o.parameters.length)return;var u,h=o.parameters[0];if(1!==h.type||2!==h.expression.type)return;var d=h.expression.value.toLowerCase();for(i=0,n=l.length;i<n;i++)if(l[i].method==c){if(!(u=l[i].evs)[d])u[d]=[[t,e]];else u[d].push([t,e]);return}(u={})[d]=[[t,e]],l.push({method:c,evs:u})}else{for(i=0,n=l.length;i<n;i++)if(l[i].method==c)return void l[i].evs.push([t,e]);if(function(t){if(drama.plugins_.Sprite&&t===drama.plugins_.Sprite.prototype.cnds.OnFrameChanged)return!0;else return!1}(c))l.unshift({method:c,evs:[[t,e]]});else l.push({method:c,evs:[[t,e]]})}},drama.eventsheet=t,e.prototype.hasObjects=function(){if(this.select_all)return this.type.instances.length;else return this.instances.length},e.prototype.getObjects=function(){if(this.select_all)return this.type.instances;else return this.instances},e.prototype.pick_one=function(t){if(t)if(t.runtime.getCurrentEventStack().current_event.orblock){if(this.select_all)drama.clearArray(this.instances),drama.shallowAssignArray(this.else_instances,t.type.instances),this.select_all=!1;var e=this.else_instances.indexOf(t);if(-1!==e)this.instances.push(this.else_instances[e]),this.else_instances.splice(e,1)}else this.select_all=!1,drama.clearArray(this.instances),this.instances[0]=t},drama.selection=e,i.prototype.postInit=function(t){var e,i,n=this.parent;if(this.group)for(this.toplevelgroup=!0;n;){if(!n.group){this.toplevelgroup=!1;break}n=n.parent}this.toplevelevent=!this.is_trigger()&&(!this.parent||this.parent.group&&this.parent.toplevelgroup),this.has_else_block=!!t;var r=this.runtime.types_by_index;if(this.solModifiers===r)this.solModifiersIncludingParents=r;else{for(this.solModifiersIncludingParents=this.solModifiers.slice(0),n=this.parent;n;){for(e=0,i=n.solModifiers.length;e<i;e++)this.addParentSolModifier(n.solModifiers[e]);n=n.parent}this.solModifiers=o(this.solModifiers),this.solModifiersIncludingParents=o(this.solModifiersIncludingParents)}for(e=0,i=this.conditions.length;e<i;e++)this.conditions[e].postInit();for(e=0,i=this.actions.length;e<i;e++)this.actions[e].postInit();for(e=0,i=this.subevents.length;e<i;e++)this.subevents[e].postInit(e<i-1&&this.subevents[e+1].is_else_block)},i.prototype.setGroupActive=function(t){if(this.group_active!==!!t){var e,i;for(this.group_active=!!t,e=0,i=this.contained_includes.length;e<i;++e)this.contained_includes[e].updateActive();if(0<i&&this.runtime.running_layout.event_sheet)this.runtime.running_layout.event_sheet.updateDeepIncludes()}},i.prototype.addSolModifier=function(t){n(t,this.solModifiers)},i.prototype.addParentSolModifier=function(t){n(t,this.solModifiersIncludingParents)},i.prototype.setAllSolModifiers=function(){this.solModifiers=this.runtime.types_by_index},i.prototype.setSolWriterAfterCnds=function(){if(this.solWriterAfterCnds=!0,this.parent)this.parent.setSolWriterAfterCnds()},i.prototype.is_trigger=function(){if(!this.conditions.length)return!1;else return this.conditions[0].trigger},i.prototype.run=function(){var t,e,i,n,r=!1,o=this.runtime,s=this.runtime.getCurrentEventStack(),a=(s.current_event=this).conditions,l=!1;if(o.resuming_breakpoint)if(this==o.breakpoint_event)if(o.breakpoint_condition)l=!0;else if(o.breakpoint_action)return this.resume_actions_and_subevents(),void this.end_run(s);else o.resuming_breakpoint=!1,o.breakpoint_event=null;else{if(this.run_subevents(),!o.resuming_breakpoint)this.end_run(s);return}else if((this.is_breakpoint||o.step_break)&&this.is_breakable&&0===o.trigger_depth)return o.breakpoint_event=this,o.breakpoint_condition=null,o.breakpoint_action=null,void o.debugBreak();if(this.group)n=drama.performance_now();if(!l)if(!this.is_else_block)s.else_branch_ran=!1;if(this.orblock){if(0===a.length)r=!0;if(l)r=s.any_true_state;else s.cndindex=0;for(t=a.length;s.cndindex<t;s.cndindex++)if(!(e=a[s.cndindex]).trigger){if(i=e.run(),o.hit_breakpoint)return void(s.any_true_state=r);if(i)r=!0}if(s.last_event_true=r)this.run_actions_and_subevents()}else{if(!l)s.cndindex=0;for(t=a.length;s.cndindex<t;s.cndindex++){if(i=a[s.cndindex].run(),o.hit_breakpoint)return;if(!i){if(s.last_event_true=!1,this.toplevelevent&&o.hasPendingInstances)o.ClearDeathRow();if(this.group)this.profile_sum+=drama.performance_now()-n;return}}s.last_event_true=!0,this.run_actions_and_subevents()}if(!o.hit_breakpoint)if(this.end_run(s),this.group)this.profile_sum+=drama.performance_now()-n},i.prototype.end_run=function(t){if(t.last_event_true&&this.has_else_block)t.else_branch_ran=!0;if(this.toplevelevent&&this.runtime.hasPendingInstances)this.runtime.ClearDeathRow()},i.prototype.run_orblocktrigger=function(t){if((this.runtime.getCurrentEventStack().current_event=this).conditions[t].run())this.run_actions_and_subevents(),this.runtime.getCurrentEventStack().last_event_true=!0},i.prototype.run_actions_and_subevents=function(){var t,e=this.runtime.getCurrentEventStack();for(e.actindex=0,t=this.actions.length;e.actindex<t;e.actindex++)if(this.actions[e.actindex].run())return;this.run_subevents()},i.prototype.resume_actions_and_subevents=function(){var t,e=this.runtime.getCurrentEventStack();for(t=this.actions.length;e.actindex<t;e.actindex++)if(this.actions[e.actindex].run())return;this.run_subevents()},i.prototype.run_subevents=function(){if(this.subevents.length){var t,e,i,n,r=this.subevents.length-1;if(!this.runtime.resuming_breakpoint)this.runtime.pushEventStack(this);if(this.solWriterAfterCnds)for(t=0,e=this.subevents.length;t<e;t++){if(i=this.subevents[t],!this.runtime.resuming_breakpoint)if(n=!this.toplevelgroup||!this.group&&t<r)this.runtime.pushCopySol(i.solModifiers);if(i.run(),this.runtime.hit_breakpoint)return;if(!this.runtime.resuming_breakpoint)if(n)this.runtime.popSol(i.solModifiers);else this.runtime.clearSol(i.solModifiers)}else for(t=0,e=this.subevents.length;t<e;t++)if(this.subevents[t].run(),this.runtime.hit_breakpoint)return;if(!this.runtime.resuming_breakpoint)this.runtime.popEventStack()}},i.prototype.run_pretrigger=function(){var t=this.runtime.getCurrentEventStack();t.current_event=this;var e,i=!1;for(t.cndindex=0,e=this.conditions.length;t.cndindex<e;t.cndindex++)if(assert2(!this.conditions[t.cndindex].looping,"Trigger found as subevent to a loop - this is not allowed, IDE will prevent this setup in future"),this.conditions[t.cndindex].run())i=!0;else if(!this.orblock)return!1;return this.orblock?i:!0},i.prototype.retrigger=function(){this.runtime.execcount++;var t,e=this.runtime.getCurrentEventStack().cndindex,i=this.runtime.pushEventStack(this);if(!this.orblock)for(i.cndindex=e+1,t=this.conditions.length;i.cndindex<t;i.cndindex++)if(!this.conditions[i.cndindex].run())return this.runtime.popEventStack(),!1;return this.run_actions_and_subevents(),this.runtime.popEventStack(),!0},i.prototype.isFirstConditionOfType=function(t){var e=t.index;if(0===e)return!0;for(--e;0<=e;--e)if(this.conditions[e].type===t.type)return!1;return!0},drama.eventblock=i,r.prototype.postInit=function(){var t,e,i;for(t=0,e=this.parameters.length;t<e;t++)if((i=this.parameters[t]).postInit(),i.variesPerInstance)this.anyParamVariesPerInstance=!0},r.prototype.run_true=function(){return!0},r.prototype.run_system=function(){if(this.runtime.resuming_breakpoint){if(this==this.runtime.breakpoint_condition)this.runtime.resuming_breakpoint=!1,this.runtime.breakpoint_event=null,this.runtime.breakpoint_condition=null,this.runtime.breakpoint_action=null}else if((this.is_breakpoint||this.runtime.step_break)&&this.block.is_breakable&&!this.block.group&&0===this.runtime.trigger_depth)return this.runtime.breakpoint_event=this.runtime.getCurrentEventStack().current_event,(this.runtime.breakpoint_condition=this).runtime.breakpoint_action=null,this.runtime.debugBreak(),!1;var t,e;for(t=0,e=this.parameters.length;t<e;t++)this.results[t]=this.parameters[t].get();return drama.xor(this.func.apply(this.runtime.system,this.results),this.inverted)},r.prototype.run_static=function(){if(this.runtime.resuming_breakpoint){if(this==this.runtime.breakpoint_condition)this.runtime.resuming_breakpoint=!1,this.runtime.breakpoint_event=null,this.runtime.breakpoint_condition=null,this.runtime.breakpoint_action=null}else if((this.is_breakpoint||this.runtime.step_break)&&this.block.is_breakable&&0===this.runtime.trigger_depth)return this.runtime.breakpoint_event=this.runtime.getCurrentEventStack().current_event,(this.runtime.breakpoint_condition=this).runtime.breakpoint_action=null,this.runtime.debugBreak(),!1;var t,e;for(t=0,e=this.parameters.length;t<e;t++)this.results[t]=this.parameters[t].get();var i=this.func.apply(this.behaviortype?this.behaviortype:this.type,this.results);return this.type.applySolToContainer(),i},r.prototype.run_object=function(){var t,e,i,n,r,o,s,a,l,c,u=this.runtime;if(u.resuming_breakpoint){if(this==u.breakpoint_condition)u.resuming_breakpoint=!1,u.breakpoint_event=null,u.breakpoint_condition=null,u.breakpoint_action=null}else if((this.is_breakpoint||u.step_break)&&this.block.is_breakable&&0===u.trigger_depth)return u.breakpoint_event=u.getCurrentEventStack().current_event,u.breakpoint_condition=this,u.breakpoint_action=null,u.debugBreak(),!1;var h,d,p=this.type,f=p.getCurrentSol(),m=this.block.orblock&&!this.trigger,g=0,y=p.is_contained,v=p.is_family,b=p.family_index,_=this.beh_index,w=-1<_,x=this.anyParamVariesPerInstance,S=this.parameters,I=this.results,T=this.inverted,C=this.func;if(x){for(e=0,r=S.length;e<r;++e)if(!(o=S[e]).variesPerInstance)I[e]=o.get(0)}else for(e=0,r=S.length;e<r;++e)I[e]=S[e].get(0);if(f.select_all){for(drama.clearArray(f.instances),drama.clearArray(f.else_instances),t=0,n=(h=p.instances).length;t<n;++t){if(assert2(a=h[t],"Invalid instance tested in condition (1)"),x)for(e=0,r=S.length;e<r;++e)if((o=S[e]).variesPerInstance)I[e]=o.get(t);if(w){if(g=0,v)g=a.type.family_beh_map[b];s=C.apply(a.behavior_insts[_+g],I)}else s=C.apply(a,I);if(drama.xor(s,T))f.instances.push(a);else if(m)f.else_instances.push(a)}if(p.finish)p.finish(!0);return f.select_all=!1,p.applySolToContainer(),f.hasObjects()}else{i=0;var O=m&&!this.block.isFirstConditionOfType(this),P=!1;for(t=0,n=(h=O?f.else_instances:f.instances).length;t<n;++t){if(assert2(a=h[t],"Invalid instance tested in condition (2)"),x)for(e=0,r=S.length;e<r;++e)if((o=S[e]).variesPerInstance)I[e]=o.get(t);if(w){if(g=0,v)g=a.type.family_beh_map[b];s=C.apply(a.behavior_insts[_+g],I)}else s=C.apply(a,I);if(drama.xor(s,T))if(P=!0,O){if(f.instances.push(a),y)for(e=0,r=a.siblings.length;e<r;e++)(l=a.siblings[e]).type.getCurrentSol().instances.push(l)}else{if(h[i]=a,y)for(e=0,r=a.siblings.length;e<r;e++)(l=a.siblings[e]).type.getCurrentSol().instances[i]=l;i++}else if(O){if(h[i]=a,y)for(e=0,r=a.siblings.length;e<r;e++)(l=a.siblings[e]).type.getCurrentSol().else_instances[i]=l;i++}else if(m)if(f.else_instances.push(a),y)for(e=0,r=a.siblings.length;e<r;e++)(l=a.siblings[e]).type.getCurrentSol().else_instances.push(l)}if(drama.truncateArray(h,i),y)for(t=0,n=(d=p.container).length;t<n;t++)if(c=d[t].getCurrentSol(),O)drama.truncateArray(c.else_instances,i);else drama.truncateArray(c.instances,i);var E=P;if(O&&!P)for(t=0,n=f.instances.length;t<n;t++){if(a=f.instances[t],x)for(e=0,r=S.length;e<r;e++)if((o=S[e]).variesPerInstance)I[e]=o.get(t);if(w)s=C.apply(a.behavior_insts[_],I);else s=C.apply(a,I);if(drama.xor(s,T)){P=!0;break}}if(p.finish)p.finish(E||m);return m?P:f.hasObjects()}},drama.condition=r,c.prototype.postInit=function(){var t,e,i;for(t=0,e=this.parameters.length;t<e;t++)if((i=this.parameters[t]).postInit(),i.variesPerInstance)this.anyParamVariesPerInstance=!0},c.prototype.run_system=function(){var t,e,i=this.runtime;if(i.resuming_breakpoint)if(this==i.breakpoint_action)i.resuming_breakpoint=!1,i.breakpoint_event=null,i.breakpoint_condition=null,i.breakpoint_action=null;else return!1;else if((this.is_breakpoint||i.step_break)&&this.block.is_breakable&&0===i.trigger_depth)return i.breakpoint_event=i.getCurrentEventStack().current_event,i.breakpoint_condition=null,i.breakpoint_action=this,i.debugBreak(),!0;var n=this.parameters,r=this.results;for(t=0,e=n.length;t<e;++t)r[t]=n[t].get();return this.func.apply(i.system,r)},c.prototype.run_object=function(){var t=this.runtime;if(t.resuming_breakpoint)if(this==t.breakpoint_action)t.resuming_breakpoint=!1,t.breakpoint_event=null,t.breakpoint_condition=null,t.breakpoint_action=null;else return!1;else if((this.is_breakpoint||t.step_break)&&this.block.is_breakable&&0===t.trigger_depth)return t.breakpoint_event=t.getCurrentEventStack().current_event,t.breakpoint_condition=null,t.breakpoint_action=this,t.debugBreak(),!0;var e,i,n,r,o,s,a,l=this.type,c=this.beh_index,u=l.family_index,h=this.anyParamVariesPerInstance,d=this.parameters,p=this.results,f=this.func,m=l.getCurrentSol().getObjects(),g=l.is_family,y=-1<c;if(h){for(i=0,r=d.length;i<r;++i)if(!(o=d[i]).variesPerInstance)p[i]=o.get(0)}else for(i=0,r=d.length;i<r;++i)p[i]=d[i].get(0);for(e=0,n=m.length;e<n;++e){if(s=m[e],h)for(i=0,r=d.length;i<r;++i)if((o=d[i]).variesPerInstance)p[i]=o.get(e);if(y){if(a=0,g)a=s.type.family_beh_map[u];f.apply(s.behavior_insts[c+a],p)}else f.apply(s,p)}return!1},drama.action=c;var u=[],h=-1;function d(){if(h++,u.length===h)u.push(new drama.expvalue);return u[h]}function p(){h--}function f(t,e){var i,n,r;switch(this.owner=t,this.block=t.block,this.sheet=t.sheet,this.runtime=t.runtime,this.type=e[0],this.expression=null,this.solindex=0,this.get=null,this.combosel=0,this.layout=null,this.key=0,this.object=null,this.index=0,this.varname=null,this.eventvar=null,this.fileinfo=null,this.subparams=null,this.variadicret=null,this.subparams=null,this.variadicret=null,this.variesPerInstance=!1,this.type){case 0:case 7:this.expression=new drama.expNode(this,e[1]),this.solindex=0,this.get=this.get_exp;break;case 1:case 14:if(this.expression=new drama.expNode(this,e[1]),this.solindex=0,this.get=this.get_exp_str,14===this.type)if(this.block.setAllSolModifiers(),this.owner instanceof drama.action)this.block.setSolWriterAfterCnds();break;case 5:this.expression=new drama.expNode(this,e[1]),this.solindex=0,this.get=this.get_layer;break;case 3:case 8:this.combosel=e[1],this.get=this.get_combosel;break;case 16:this.combosel=e[1]?1:0,this.get=this.get_boolean;break;case 6:this.layout=this.runtime.layouts[e[1]],assert2(this.layout,"Can't find layout for layout parameter: "+e[1]),this.get=this.get_layout;break;case 9:this.key=e[1],this.get=this.get_key;break;case 4:if(this.object=this.runtime.types_by_index[e[1]],assert2(this.object,"Can't find object type for object parameter: "+e[1]),this.get=this.get_object,this.block.addSolModifier(this.object),this.owner instanceof drama.action)this.block.setSolWriterAfterCnds();else if(this.block.parent)this.block.parent.setSolWriterAfterCnds();break;case 10:if(this.index=e[1],t.type&&t.type.is_family)this.get=this.get_familyvar,this.variesPerInstance=!0;else this.get=this.get_instvar;break;case 11:this.varname=e[1],this.eventvar=null,this.get=this.get_eventvar;break;case 2:case 12:this.fileinfo=e[1],this.get=this.get_audiofile;break;case 13:for(this.get=this.get_variadic,this.subparams=[],this.variadicret=[],i=1,n=e.length;i<n;i++)r=new drama.parameter(this.owner,e[i]),drama.seal(r),this.subparams.push(r),this.variadicret.push(0);break;default:assert2(!1,"Unknown parameter type: "+this.type)}}function m(t){this.time=Date.now(),this.runtime=t,this.changeVars=[],this.lastVars={},this.reportVarsObj={}}function g(t,e,i){if(this.sheet=t,this.parent=e,this.runtime=t.runtime,this.solModifiers=[],this.name=i[1],this.vartype=i[2],this.initial=i[3],2==this.vartype)this.initial=!!i[3];if(this.is_static=!!i[4],this.is_constant=!!i[5],this.sid=i[6],this.is_upload=i[8],this.is_breakpoint=this.runtime.isDebug&&i[7],(this.runtime.varsBySid[this.sid.toString()]=this).name)(this.runtime.varsByName[this.name]=this).runtime.varsByLowerName[this.name.toLowerCase()]=this;if(this.data=this.initial,this.is_upload)this.runtime.xfReport.lastVars[this.sid.toString()]={data:this.data,name:this.name,sid:this.sid};if(this.parent){if(this.is_static||this.is_constant)this.localIndex=-1;else this.localIndex=this.runtime.stackLocalCount++;this.runtime.all_local_vars.push(this)}else if(this.localIndex=-1,this.runtime.all_global_vars.push(this),(this.runtime.all_global_varsMap[this.name]=this).is_upload)this.runtime.all_origin_global_vars[this.sid]=this.data}function y(t,e,i){this.sheet=t,this.parent=e,this.runtime=t.runtime,this.solModifiers=[],this.include_sheet=null,this.include_sheet_name=i[1],this.active=!0,this.is_breakpoint=this.runtime.isDebug&&i[2]}function v(){this.temp_parents_arr=[],this.reset(null),drama.seal(this)}f.prototype.postInit=function(){var t,e;if(11===this.type)this.eventvar=this.runtime.getEventVariableByName(this.varname,this.block.parent),assert2(this.eventvar,"Cannot find event variable '"+this.varname+"'");else if(13===this.type)for(t=0,e=this.subparams.length;t<e;t++)this.subparams[t].postInit();if(this.expression)this.expression.postInit()},f.prototype.maybeVaryForType=function(t){if(!this.variesPerInstance)if(t)if(!t.plugin.singleglobal)this.variesPerInstance=!0},f.prototype.setVaries=function(){this.variesPerInstance=!0},f.prototype.get_exp=function(t){this.solindex=t||0;var e=d();return this.expression.get(e),p(),e.data},f.prototype.get_exp_str=function(t){this.solindex=t||0;var e=d();if(this.expression.get(e),p(),drama.is_string(e.data))return e.data;else return""},f.prototype.get_object=function(){return this.object},f.prototype.get_combosel=function(){return this.combosel},f.prototype.get_boolean=function(){return!!this.combosel},f.prototype.get_layer=function(t){this.solindex=t||0;var e=d();if(this.expression.get(e),p(),e.is_number())return this.runtime.getLayerByNumber(e.data);else return this.runtime.getLayerByName(e.data)},f.prototype.get_layout=function(){return this.layout},f.prototype.get_key=function(){return this.key},f.prototype.get_instvar=function(){return this.index},f.prototype.get_familyvar=function(t){var e=t||0,i=this.owner.type,n=null,r=i.getCurrentSol(),o=r.getObjects();if(o.length)n=o[e%o.length].type;else if(r.else_instances.length)n=r.else_instances[e%r.else_instances.length].type;else if(i.instances.length)n=i.instances[e%i.instances.length].type;else return 0;return this.index+n.family_var_map[i.family_index]},f.prototype.get_eventvar=function(){return this.eventvar},f.prototype.get_audiofile=function(){return this.fileinfo},f.prototype.get_variadic=function(){var t,e;for(t=0,e=this.subparams.length;t<e;t++)this.variadicret[t]=this.subparams[t].get();return this.variadicret},drama.parameter=f,m.prototype.setValue=function(e,t,i){var n=this.data;if(e.data=t,!i){if(n!=t){xf.EventCenter.instance.sendEvent(new xf.EventData(xf.EventType.REPORT_GLOBAL_VARS,this));var r=this.changeVars.findIndex(function(t){return t.sid==e.sid});if(-1<r)this.changeVars[r]=e;else this.changeVars.push(e);this.report()}}else this.lastVars[e.sid.toString()].data=t},m.prototype.diff=function(){var e=this,i=[],n=[];if(this.changeVars.forEach(function(t){if(t.data!=e.lastVars[t.sid].data)i.push(t),e.reportVarsObj[t.sid]=t.data;else n.push(t)}),this.changeVars=n,i.length)return!0;else return!(this.reportVarsObj={})},m.prototype.report=function(){if(1!=xf.gameInfo.gameType)if(xf.gameInfo.characterId){var t=Date.now();if(t-this.time<3e3)return!1;if(!this.diff()||!xf.gameInfo.characterId)return!1;this.time=t;var n=this;xf.serverApi.updateCharacter({cid:xf.gameInfo.characterId,gid:xf.gameInfo.gameId,cname:xf.gameInfo.characterName,glov:this.reportVarsObj,gver:xf.gameInfo.version}).then(function(t){for(var e in n.lastVars){var i=n.lastVars[e].sid;n.lastVars[e].data=n.reportVarsObj[i],n.reportVarsObj={}}})}},drama.XfReportVariable=m,g.prototype.postInit=function(){this.solModifiers=o(this.solModifiers)},g.prototype.setValue=function(t,e){assert2(!this.is_constant,"Calling setValue on constant event variable");var i=this.runtime.getCurrentLocalVarStack();if(!this.parent||this.is_static||!i)if(!this.is_upload)this.data=t;else this.runtime.xfReport.setValue(this,t,e);else{if(this.localIndex>=i.length)i.length=this.localIndex+1;i[this.localIndex]=t}},g.prototype.getValue=function(){var t=this.runtime.getCurrentLocalVarStack();if(!this.parent||this.is_static||!t||this.is_constant)return this.data;else{if(this.localIndex>=t.length)return this.initial;if(void 0===t[this.localIndex])return this.initial;else return t[this.localIndex]}},g.prototype.run=function(){if(!this.runtime.resuming_breakpoint)if(this.parent&&!this.is_static&&!this.is_constant)this.setValue(this.initial)},drama.eventvariable=g,y.prototype.toString=function(){return"include:"+this.include_sheet.toString()},y.prototype.postInit=function(){this.include_sheet=this.runtime.eventsheets[this.include_sheet_name],assert2(this.include_sheet,"Cannot find event sheet '"+this.include_sheet_name+"' for include"),assert2(this.include_sheet!=this.sheet,"Event sheet include includes its own sheet"),this.sheet.includes.add(this),this.solModifiers=o(this.solModifiers);for(var t=this.parent;t;){if(t.group)t.contained_includes.push(this);t=t.parent}this.updateActive()},y.prototype.run=function(){if(!this.runtime.resuming_breakpoint)if(this.parent)this.runtime.pushCleanSol(this.runtime.types_by_index);if(!this.include_sheet.hasRun)this.include_sheet.run(!0);if(!this.runtime.hit_breakpoint)if(!this.runtime.resuming_breakpoint)if(this.parent)this.runtime.popSol(this.runtime.types_by_index)},y.prototype.updateActive=function(){for(var t=this.parent;t;){if(t.group&&!t.group_active)return void(this.active=!1);t=t.parent}this.active=!0},y.prototype.isActive=function(){return this.active},drama.eventinclude=y,v.prototype.reset=function(t){this.current_event=t,this.cndindex=0,this.actindex=0,drama.clearArray(this.temp_parents_arr),this.last_event_true=!1,this.else_branch_ran=!1,this.any_true_state=!1},v.prototype.isModifierAfterCnds=function(){if(this.current_event.solWriterAfterCnds)return!0;if(this.cndindex<this.current_event.conditions.length-1)return!!this.current_event.solModifiers.length;else return!1},drama.eventStackFrame=v}(),function(){function t(t,e){this.owner=t,this.runtime=t.runtime,this.type=e[0],assert2(0<=this.type&&this.type<=23,"Invalid ExpNode type: "+this.type),this.get=[this.eval_int,this.eval_float,this.eval_string,this.eval_unaryminus,this.eval_add,this.eval_subtract,this.eval_multiply,this.eval_divide,this.eval_mod,this.eval_power,this.eval_and,this.eval_or,this.eval_equal,this.eval_notequal,this.eval_less,this.eval_lessequal,this.eval_greater,this.eval_greaterequal,this.eval_conditional,this.eval_system_exp,this.eval_object_exp,this.eval_instvar_exp,this.eval_behavior_exp,this.eval_eventvar_exp][this.type];var i=null;switch(this.value=null,this.first=null,this.second=null,this.third=null,this.func=null,this.results=null,this.parameters=null,this.object_type=null,this.beh_index=-1,this.instance_expr=null,this.varindex=-1,this.behavior_type=null,this.varname=null,this.eventvar=null,this.return_string=!1,this.type){case 0:case 1:case 2:this.value=e[1];break;case 3:this.first=new drama.expNode(t,e[1]);break;case 18:this.first=new drama.expNode(t,e[1]),this.second=new drama.expNode(t,e[2]),this.third=new drama.expNode(t,e[3]);break;case 19:if(this.func=this.runtime.GetObjectReference(e[1]),assert2(this.func,"Cannot find system expression"),this.func===drama.system_object.prototype.exps.random||this.func===drama.system_object.prototype.exps.choose)this.owner.setVaries();if(this.results=[],this.parameters=[],3===e.length)i=e[2],this.results.length=i.length+1;else this.results.length=1;break;case 20:if(this.object_type=this.runtime.types_by_index[e[1]],assert2(this.object_type,"Cannot find object type: "+e[1]),this.beh_index=-1,this.func=this.runtime.GetObjectReference(e[2]),this.return_string=e[3],drama.plugins_.Function&&this.func===drama.plugins_.Function.prototype.exps.Call)this.owner.setVaries();if(e[4])this.instance_expr=new drama.expNode(t,e[4]);else this.instance_expr=null;if(this.results=[],this.parameters=[],6===e.length)i=e[5],this.results.length=i.length+1;else this.results.length=1;break;case 21:if(this.object_type=this.runtime.types_by_index[e[1]],assert2(this.object_type,"Cannot find object type: "+e[1]),this.return_string=e[2],e[3])this.instance_expr=new drama.expNode(t,e[3]);else this.instance_expr=null;this.varindex=e[4];break;case 22:if(this.object_type=this.runtime.types_by_index[e[1]],assert2(this.object_type,"Cannot find object type: "+e[1]),this.behavior_type=this.object_type.getBehaviorByName(e[2]),assert2(this.behavior_type,"Cannot find behavior type: "+e[2]),this.beh_index=this.object_type.getBehaviorIndexByName(e[2]),this.func=this.runtime.GetObjectReference(e[3]),this.return_string=e[4],e[5])this.instance_expr=new drama.expNode(t,e[5]);else this.instance_expr=null;if(this.results=[],this.parameters=[],7===e.length)i=e[6],this.results.length=i.length+1;else this.results.length=1;break;case 23:this.varname=e[1],this.eventvar=null}if(this.owner.maybeVaryForType(this.object_type),4<=this.type&&this.type<=17)this.first=new drama.expNode(t,e[1]),this.second=new drama.expNode(t,e[2]);if(i){var n,r;for(n=0,r=i.length;n<r;n++)this.parameters.push(new drama.expNode(t,i[n]))}drama.seal(this)}t.prototype.postInit=function(){if(23===this.type)this.eventvar=this.owner.runtime.getEventVariableByName(this.varname,this.owner.block.parent),assert2(this.eventvar,"Cannot find event variable '"+this.varname+"'");if(this.first)this.first.postInit();if(this.second)this.second.postInit();if(this.third)this.third.postInit();if(this.instance_expr)this.instance_expr.postInit();if(this.parameters){var t,e;for(t=0,e=this.parameters.length;t<e;t++)this.parameters[t].postInit()}};var e=[],i=-1;function f(){if(++i,e.length===i)e.push(new drama.expvalue);return e[i]}function m(){--i}function g(t,e,i){var n,r;for(n=0,r=t.length;n<r;++n)t[n].get(i),e[n+1]=i.data}function n(t,e){if(this.type=t||drama.exptype.Integer,this.data=e||0,this.object_class=null,assert2(!this.is_int()||drama.is_number(this.data),"Constructing integer expvalue without number data"),assert2(!this.is_float()||drama.is_number(this.data),"Constructing float expvalue without number data"),assert2(!this.is_string()||drama.is_string(this.data),"Constructing string expvalue without string data"),this.type==drama.exptype.Integer)this.data=Math.floor(this.data);drama.seal(this)}t.prototype.eval_system_exp=function(t){var e=this.parameters,i=this.results;i[0]=t,g(e,i,f()),m(),this.func.apply(this.runtime.system,i)},t.prototype.eval_object_exp=function(t){var e=this.object_type,i=this.results,n=this.parameters,r=this.instance_expr,o=this.func,s=this.owner.solindex,a=e.getCurrentSol(),l=a.getObjects();if(!l.length)if(a.else_instances.length)l=a.else_instances;else{if(this.return_string)t.set_string("");else t.set_int(0);return}(i[0]=t).object_class=e;var c=f();if(g(n,i,c),r)if(r.get(c),c.is_number())s=c.data,l=e.instances;m();var u=l.length;if(u<=s||s<=-u)s%=u;if(s<0)s+=u;assert2(!o.apply(l[s],i),"Plugin mistake: Don't return values from the expression method - call ret.set_int/set_float/set_string instead")},t.prototype.eval_behavior_exp=function(t){var e=this.object_type,i=this.results,n=this.parameters,r=this.instance_expr,o=this.beh_index,s=this.func,a=this.owner.solindex,l=e.getCurrentSol(),c=l.getObjects();if(!c.length)if(l.else_instances.length)c=l.else_instances;else{if(this.return_string)t.set_string("");else t.set_int(0);return}(i[0]=t).object_class=e;var u=f();if(g(n,i,u),r)if(r.get(u),u.is_number())a=u.data,c=e.instances;m();var h=c.length;if(h<=a||a<=-h)a%=h;if(a<0)a+=h;var d=c[a],p=0;if(e.is_family)p=d.type.family_beh_map[e.family_index];assert2(!s.apply(d.behavior_insts[o+p],i),"Plugin mistake: Don't return values from the expression method - call ret.set_int/set_float/set_string instead")},t.prototype.eval_instvar_exp=function(t){var e,i=this.instance_expr,n=this.object_type,r=this.varindex,o=this.owner.solindex,s=n.getCurrentSol(),a=s.getObjects();if(!a.length)if(s.else_instances.length)a=s.else_instances;else{if(this.return_string)t.set_string("");else t.set_int(0);return}if(i){var l=f();if(i.get(l),l.is_number()){o=l.data;var c=n.instances;if(0!==c.length)if((o%=c.length)<0)o+=c.length;var u=(e=n.getInstanceByIID(o)).instance_vars[r];if(drama.is_string(u))t.set_string(u);else t.set_float(u);return void m()}m()}var h=a.length;if(h<=o||o<=-h)o%=h;if(o<0)o+=h;e=a[o];var d=0;if(n.is_family)d=e.type.family_var_map[n.family_index];if(u=e.instance_vars[r+d],drama.is_string(u))t.set_string(u);else t.set_float(u)},t.prototype.eval_int=function(t){t.type=drama.exptype.Integer,t.data=this.value},t.prototype.eval_float=function(t){t.type=drama.exptype.Float,t.data=this.value},t.prototype.eval_string=function(t){t.type=drama.exptype.String,t.data=this.value},t.prototype.eval_unaryminus=function(t){if(this.first.get(t),t.is_number())t.data=-t.data},t.prototype.eval_add=function(t){this.first.get(t);var e=f();if(this.second.get(e),t.is_number()&&e.is_number())if(t.data+=e.data,e.is_float())t.make_float();m()},t.prototype.eval_subtract=function(t){this.first.get(t);var e=f();if(this.second.get(e),t.is_number()&&e.is_number())if(t.data-=e.data,e.is_float())t.make_float();m()},t.prototype.eval_multiply=function(t){this.first.get(t);var e=f();if(this.second.get(e),t.is_number()&&e.is_number())if(t.data*=e.data,e.is_float())t.make_float();m()},t.prototype.eval_divide=function(t){this.first.get(t);var e=f();if(this.second.get(e),t.is_number()&&e.is_number())t.data/=e.data,t.make_float();m()},t.prototype.eval_mod=function(t){this.first.get(t);var e=f();if(this.second.get(e),t.is_number()&&e.is_number())if(t.data%=e.data,e.is_float())t.make_float();m()},t.prototype.eval_power=function(t){this.first.get(t);var e=f();if(this.second.get(e),t.is_number()&&e.is_number())if(t.data=Math.pow(t.data,e.data),e.is_float())t.make_float();m()},t.prototype.eval_and=function(t){this.first.get(t);var e=f();if(this.second.get(e),e.is_string()||t.is_string())this.eval_and_stringconcat(t,e);else this.eval_and_logical(t,e);m()},t.prototype.eval_and_stringconcat=function(t,e){if(t.is_string()&&e.is_string())this.eval_and_stringconcat_str_str(t,e);else this.eval_and_stringconcat_num(t,e)},t.prototype.eval_and_stringconcat_str_str=function(t,e){t.data+=e.data},t.prototype.eval_and_stringconcat_num=function(t,e){if(t.is_string())t.data+=(Math.round(1e10*e.data)/1e10).toString();else t.set_string(t.data.toString()+e.data)},t.prototype.eval_and_logical=function(t,e){t.set_int(t.data&&e.data?1:0)},t.prototype.eval_or=function(t){this.first.get(t);var e=f();if(this.second.get(e),t.is_number()&&e.is_number())if(t.data||e.data)t.set_int(1);else t.set_int(0);m()},t.prototype.eval_conditional=function(t){if(this.first.get(t),t.data)this.second.get(t);else this.third.get(t)},t.prototype.eval_equal=function(t){this.first.get(t);var e=f();this.second.get(e),t.set_int(t.data===e.data?1:0),m()},t.prototype.eval_notequal=function(t){this.first.get(t);var e=f();this.second.get(e),t.set_int(t.data!==e.data?1:0),m()},t.prototype.eval_less=function(t){this.first.get(t);var e=f();this.second.get(e),t.set_int(t.data<e.data?1:0),m()},t.prototype.eval_lessequal=function(t){this.first.get(t);var e=f();this.second.get(e),t.set_int(t.data<=e.data?1:0),m()},t.prototype.eval_greater=function(t){this.first.get(t);var e=f();this.second.get(e),t.set_int(t.data>e.data?1:0),m()},t.prototype.eval_greaterequal=function(t){this.first.get(t);var e=f();this.second.get(e),t.set_int(t.data>=e.data?1:0),m()},t.prototype.eval_eventvar_exp=function(t){var e=this.eventvar.getValue();if("number"==typeof e)t.set_float(e);else if("boolean"==typeof e)t.set_int(e?1:0);else t.set_string(e)},drama.expNode=t,n.prototype.is_int=function(){return this.type===drama.exptype.Integer},n.prototype.is_float=function(){return this.type===drama.exptype.Float},n.prototype.is_number=function(){return this.type===drama.exptype.Integer||this.type===drama.exptype.Float},n.prototype.is_string=function(){return this.type===drama.exptype.String},n.prototype.make_int=function(){if(!this.is_int()){if(this.is_float())this.data=Math.floor(this.data);else if(this.is_string())this.data=parseInt(this.data,10);this.type=drama.exptype.Integer}},n.prototype.make_float=function(){if(!this.is_float()){if(this.is_string())this.data=parseFloat(this.data);this.type=drama.exptype.Float}},n.prototype.make_string=function(){if(!this.is_string())this.data=this.data.toString(),this.type=drama.exptype.String},n.prototype.set_int=function(t){assert2(drama.is_number(t),"Calling expvalue.set_int without number type"),this.type=drama.exptype.Integer,this.data=Math.floor(t)},n.prototype.set_float=function(t){assert2(drama.is_number(t),"Calling expvalue.set_float without number type"),this.type=drama.exptype.Float,this.data=t},n.prototype.set_string=function(t){assert2(drama.is_string(t),"Calling expvalue.set_string without string type"),this.type=drama.exptype.String,this.data=t},n.prototype.set_any=function(t){if(drama.is_number(t))this.type=drama.exptype.Float,this.data=t;else if(drama.is_string(t))this.type=drama.exptype.String,this.data=t.toString();else this.type=drama.exptype.Integer,this.data=0},drama.expvalue=n,drama.exptype={Integer:0,Float:1,String:2}}(),assert2(drama,"drama namespace not created"),function(){drama.add_common_aces=function(t,e){var i=t[1],n=t[3],r=t[4],o=t[5],s=t[6],a=t[7],l=t[8],c=t[10];if(!e.cnds)e.cnds={};if(!e.acts)e.acts={};if(!e.exps)e.exps={};var u=e.cnds,h=e.acts,d=e.exps;if(n)u.CompareXY=function(t,e,i,n){if(6!==t&&6!==i)return drama.do_cmp(this.x,t,e)&&drama.do_cmp(this.y,i,n);if(6!==t)return drama.do_cmp(this.x,t,e);if(6!==i)return drama.do_cmp(this.y,i,n);else return!0},u.CompareX=function(t,e){return drama.do_cmp(this.x,t,e)},u.CompareY=function(t,e){return drama.do_cmp(this.y,t,e)},u.IsOnScreen=function(){var t=this.layer;this.update_bbox();var e=this.bbox;return!(e.right<t.viewLeft||e.bottom<t.viewTop||e.left>t.viewRight||e.top>t.viewBottom)},u.IsOutsideLayout=function(){this.update_bbox();var t=this.bbox,e=this.runtime.running_layout;return t.right<0||t.bottom<0||t.left>e.width||t.top>e.height},u.PickDistance=function(t,e,i){var n=this.getCurrentSol(),r=n.getObjects();if(!r.length)return!1;var o,s,a,l=r[0],c=l,u=drama.distanceTo(l.x,l.y,e,i);for(o=1,s=r.length;o<s;o++)if(l=r[o],a=drama.distanceTo(l.x,l.y,e,i),0===t&&a<u||1===t&&u<a)u=a,c=l;return n.pick_one(c),!0},h.SetPos2=function(t,e,i,n){if(1==t)h.SetX.apply(this,[e]);if(1==i)h.SetY.apply(this,[n])},h.SetX=function(t){if(this.x!==t)this.x=t,this.set_bbox_changed()},h.SetY=function(t){if(this.y!==t)this.y=t,this.set_bbox_changed()},h.SetPos=function(t,e){if(this.x!==t||this.y!==e)this.x=t,this.y=e,this.set_bbox_changed()},h.SetPosToObject=function(t,e){var i=t.getPairedInstance(this);if(i){var n,r;if(i.getImagePoint)n=i.getImagePoint(e,!0),r=i.getImagePoint(e,!1);else n=i.x,r=i.y;if(this.x!==n||this.y!==r)this.x=n,this.y=r,this.set_bbox_changed()}},h.MoveForward=function(t){if(0!==t)this.x+=Math.cos(this.angle)*t,this.y+=Math.sin(this.angle)*t,this.set_bbox_changed()},h.MoveAtAngle=function(t,e){if(0!==e)this.x+=Math.cos(drama.to_radians(t))*e,this.y+=Math.sin(drama.to_radians(t))*e,this.set_bbox_changed()},d.X=function(t){t.set_float(this.x)},d.Y=function(t){t.set_float(this.y)},d.dt=function(t){t.set_float(this.runtime.getDt(this))};if(r)u.CompareSize=function(t,e,i,n){if(6!==t&&6!==i)return drama.do_cmp(this.width,t,e)&&drama.do_cmp(this.height,i,n);if(6!==t)return drama.do_cmp(this.width,t,e);if(6!==i)return drama.do_cmp(this.height,i,n);else return!0},u.CompareWidth=function(t,e){return drama.do_cmp(this.width,t,e)},u.CompareHeight=function(t,e){return drama.do_cmp(this.height,t,e)},h.SetSize2=function(t,e,i,n){if(1==t&&this.width!==e)this.width=e,this.set_bbox_changed();if(1==i&&this.height!==n)this.height=n,this.set_bbox_changed()},h.SetWidth=function(t){if(this.width!==t)this.width=t,this.set_bbox_changed()},h.SetHeight=function(t){if(this.height!==t)this.height=t,this.set_bbox_changed()},h.SetSize=function(t,e){if(this.width!==t||this.height!==e)this.width=t,this.height=e,this.set_bbox_changed()},d.Width=function(t){t.set_float(this.width)},d.Height=function(t){t.set_float(this.height)},d.BBoxLeft=function(t){this.update_bbox(),t.set_float(this.bbox.left)},d.BBoxTop=function(t){this.update_bbox(),t.set_float(this.bbox.top)},d.BBoxRight=function(t){this.update_bbox(),t.set_float(this.bbox.right)},d.BBoxBottom=function(t){this.update_bbox(),t.set_float(this.bbox.bottom)};if(o)u.AngleWithin=function(t,e){return drama.angleDiff(this.angle,drama.to_radians(e))<=drama.to_radians(t)},u.IsClockwiseFrom=function(t){return drama.angleClockwise(this.angle,drama.to_radians(t))},u.IsBetweenAngles=function(t,e){var i=drama.to_clamped_radians(t),n=drama.to_clamped_radians(e),r=drama.clamp_angle(this.angle);if(!drama.angleClockwise(n,i))return!(!drama.angleClockwise(r,i)&&drama.angleClockwise(r,n));else return drama.angleClockwise(r,i)&&!drama.angleClockwise(r,n)},h.SetAngle=function(t){var e=drama.to_radians(drama.clamp_angle_degrees(t));if(!isNaN(e))if(this.angle!==e)this.angle=e,this.set_bbox_changed()},h.SetRotate=function(t,e){if(0!==e&&!isNaN(e)){if(0==t)this.angle+=drama.to_radians(e);else this.angle-=drama.to_radians(e);this.set_bbox_changed()}},h.RotateClockwise=function(t){if(0!==t&&!isNaN(t))this.angle+=drama.to_radians(t),this.angle=drama.clamp_angle(this.angle),this.set_bbox_changed()},h.RotateCounterclockwise=function(t){if(0!==t&&!isNaN(t))this.angle-=drama.to_radians(t),this.angle=drama.clamp_angle(this.angle),this.set_bbox_changed()},h.RotateTowardAngle=function(t,e){var i=drama.angleRotate(this.angle,drama.to_radians(e),drama.to_radians(t));if(!isNaN(i))if(this.angle!==i)this.angle=i,this.set_bbox_changed()},h.RotateTowardPosition=function(t,e,i){var n=e-this.x,r=i-this.y,o=Math.atan2(r,n),s=drama.angleRotate(this.angle,o,drama.to_radians(t));if(!isNaN(s))if(this.angle!==s)this.angle=s,this.set_bbox_changed()},h.SetTowardPosition=function(t,e){var i=t-this.x,n=e-this.y,r=Math.atan2(n,i);if(!isNaN(r))if(this.angle!==r)this.angle=r,this.set_bbox_changed()},d.Angle=function(t){t.set_float(drama.to_clamped_degrees(this.angle))};if(!i){if(u.CompareCustomInstanceVar=function(t,e,i,n,r,o){if(2==t)return drama.do_cmp(this.instance_vars[e],i,o);else if(1==t)return drama.do_cmp(this.instance_vars[e],i,r);else return drama.do_cmp(this.instance_vars[e],i,n)},u.CustomInstanceVarChange=function(t,e){if("number"!=typeof e)return!1;else return this.instance_iv===e},u.CompareInstanceVar=function(t,e,i){return drama.do_cmp(this.instance_vars[t],e,i)},u.IsBoolInstanceVarSet=function(t){return this.instance_vars[t]},u.PickInstVarHiLow=function(t,e){var i=this.getCurrentSol(),n=i.getObjects();if(!n.length)return!1;var r,o,s,a=n[0],l=a,c=a.instance_vars[e];for(r=1,o=n.length;r<o;r++)if(s=(a=n[r]).instance_vars[e],0===t&&s<c||1===t&&c<s)c=s,l=a;return i.pick_one(l),!0},u.PickByUID=function(t){var e,i,n,r,o,s,a;if(this.runtime.getCurrentCondition().inverted)if((a=this.getCurrentSol()).select_all){for(a.select_all=!1,drama.clearArray(a.instances),drama.clearArray(a.else_instances),e=0,i=(s=this.instances).length;e<i;e++)if((r=s[e]).uid===t)a.else_instances.push(r);else a.instances.push(r);return this.applySolToContainer(),!!a.instances.length}else{for(n=e=0,i=a.instances.length;e<i;e++)if(r=a.instances[e],(a.instances[n]=r).uid===t)a.else_instances.push(r);else n++;return drama.truncateArray(a.instances,n),this.applySolToContainer(),!!a.instances.length}else{if(!(r=this.runtime.getObjectByUID(t)))return!1;if(!(a=this.getCurrentSol()).select_all&&-1===a.instances.indexOf(r))return!1;if(this.is_family){for(e=0,i=(o=r.type.families).length;e<i;e++)if(o[e]===this)return a.pick_one(r),this.applySolToContainer(),!0}else if(r.type===this)return a.pick_one(r),this.applySolToContainer(),!0;return!1}},u.OnCreated=function(){return!0},u.OnDestroyed=function(){return!0},h.SetCustomInstanceVar=function(t,e,i){var n=this.instance_vars,r=n[e];if(drama.is_number(n[e]))if(drama.is_number(i))n[e]=i;else n[e]=parseFloat(i);else if(drama.is_string(n[e]))if(drama.is_string(i))n[e]=i;else n[e]=i.toString();else this.instance_vars[e]=i?1:0;if(r!=n[e]){var o=this.instance_iv;this.instance_iv=e,this.runtime.trigger(u.CustomInstanceVarChange,this),this.instance_iv=o}},h.SetInstanceVar=function(t,e){var i=this.instance_vars,n=i[t];if(drama.is_number(i[t]))if(drama.is_number(e))i[t]=e;else i[t]=parseFloat(e);else if(drama.is_string(i[t]))if(drama.is_string(e))i[t]=e;else i[t]=e.toString();else this.instance_vars[t]=e?1:0;if(n!=i[t]){var r=this.instance_iv;this.instance_iv=t,this.runtime.trigger(u.CustomInstanceVarChange,this),this.instance_iv=r}},h.AddInstanceVar=function(t,e){var i=this.instance_vars,n=i[t];if(drama.is_number(i[t]))if(drama.is_number(e))i[t]+=e;else i[t]+=parseFloat(e);else if(drama.is_string(i[t]))if(drama.is_string(e))i[t]+=e;else i[t]+=e.toString();else assert2(!1,"Invalid instance variable type when adding");if(n!=i[t]){var r=this.instance_iv;this.instance_iv=t,this.runtime.trigger(u.CustomInstanceVarChange,this),this.instance_iv=r}},h.SubInstanceVar=function(t,e){var i=this.instance_vars,n=i[t];if(drama.is_number(i[t]))if(drama.is_number(e))i[t]-=e;else i[t]-=parseFloat(e);else assert2(!1,"Invalid instance variable type when subtracting");if(n!=i[t]){var r=this.instance_iv;this.instance_iv=t,this.runtime.trigger(u.CustomInstanceVarChange,this),this.instance_iv=r}},h.SetBoolInstanceVar=function(t,e){var i=this.instance_vars[t];if(this.instance_vars[t]=e?1:0,i!=this.instance_vars[t]){var n=this.instance_iv;this.instance_iv=t,this.runtime.trigger(u.CustomInstanceVarChange,this),this.instance_iv=n}},h.ToggleBoolInstanceVar=function(t){this.instance_vars[t]=1-this.instance_vars[t];var e=this.instance_iv;this.instance_iv=t,this.runtime.trigger(u.CustomInstanceVarChange,this),this.instance_iv=e},h.ResetInstanceVar=function(t){var e,i,n=t.split("|"),r=this.instance_vars,o=this.instance_initial_vars,s=this.instance_var_names;if(""==t)for(e=0,i=r.length;e<i;e++)r[e]=o[e];else for(e=0,i=n.length;e<i;e++){var a=s.indexOf(n[e]);if(-1<a)r[a]=o[a]}},h.Destroy=function(){this.runtime.DestroyInstance(this)},!h.LoadFromJsonString)h.LoadFromJsonString=function(t){var e,i,n,r;try{e=JSON.parse(t)}catch(t){return}if(this.runtime.loadInstanceFromJSON(this,e,!0),this.afterLoad)this.afterLoad();if(this.behavior_insts)for(i=0,n=this.behavior_insts.length;i<n;++i)if((r=this.behavior_insts[i]).afterLoad)r.afterLoad()};if(d.Count=function(t){var e,i,n,r=t.object_class.instances.length;for(e=0,i=this.runtime.createRow.length;e<i;e++)if(n=this.runtime.createRow[e],t.object_class.is_family){if(0<=n.type.families.indexOf(t.object_class))r++}else if(n.type===t.object_class)r++;t.set_int(r)},d.PickedCount=function(t){t.set_int(t.object_class.getCurrentSol().getObjects().length)},d.UID=function(t){t.set_int(this.uid)},d.IID=function(t){t.set_int(this.get_iid())},!d.AsJSON)d.AsJSON=function(t){t.set_string(JSON.stringify(this.runtime.saveInstanceToJSON(this,!0)))}}if(s)u.IsVisible=function(){return this.visible},h.SetVisible=function(t){if(!t!=!this.visible)this.visible=!!t,this.runtime.redraw=!0},u.CompareOpacity=function(t,e){return drama.do_cmp(drama.round6dp(100*this.opacity),t,e)},h.SetOpacity=function(t){var e=t/100;if(e<0)e=0;else if(1<e)e=1;if(e!==this.opacity)this.opacity=e,this.runtime.redraw=!0},d.Opacity=function(t){t.set_float(drama.round6dp(100*this.opacity))};if(a)u.IsOnLayer=function(t){if(!t)return!1;else return this.layer===t},u.PickTopBottom=function(t){var e=this.getCurrentSol(),i=e.getObjects();if(!i.length)return!1;var n,r,o=i[0],s=o;for(n=1,r=i.length;n<r;n++)if(o=i[n],0===t){if(o.layer.index>s.layer.index||o.layer.index===s.layer.index&&o.get_zindex()>s.get_zindex())s=o}else if(o.layer.index<s.layer.index||o.layer.index===s.layer.index&&o.get_zindex()<s.get_zindex())s=o;return e.pick_one(s),!0},h.MoveToTopOrBottom=function(t){if(!this.layer.isAutoSortZIndex){var e=this.layer,i=e.instances;if(0==t){if(i.length&&i[i.length-1]===this)return;e.removeFromInstanceList(this,!1),e.appendToInstanceList(this,!1)}else{if(i.length&&i[0]===this)return;e.removeFromInstanceList(this,!1),e.prependToInstanceList(this,!1)}this.runtime.redraw=!0}},h.MoveToTop=function(){if(!this.layer.isAutoSortZIndex){var t=this.layer,e=t.instances;if(!e.length||e[e.length-1]!==this)t.removeFromInstanceList(this,!1),t.appendToInstanceList(this,!1),this.runtime.redraw=!0}},h.MoveToBottom=function(){if(!this.layer.isAutoSortZIndex){var t=this.layer,e=t.instances;if(!e.length||e[0]!==this)t.removeFromInstanceList(this,!1),t.prependToInstanceList(this,!1),this.runtime.redraw=!0}},h.MoveToLayer=function(t){if(t&&t!=this.layer)this.layer.removeFromInstanceList(this,!0),(this.layer=t).appendToInstanceList(this,!0),this.runtime.redraw=!0},h.ZMoveToObject=function(t,e){if(!this.layer.isAutoSortZIndex){var i=0===t;if(e){var n=e.getFirstPicked(this);if(n&&n.uid!==this.uid){if(this.layer.index!==n.layer.index)this.layer.removeFromInstanceList(this,!0),this.layer=n.layer,n.layer.appendToInstanceList(this,!0);this.layer.moveInstanceAdjacent(this,n,i),this.runtime.redraw=!0}}}},d.LayerNumber=function(t){t.set_int(this.layer.number)},d.LayerName=function(t){t.set_string(this.layer.name)},d.ZIndex=function(t){t.set_int(this.get_zindex())};if(l)h.SetEffectEnabled=function(t,e){if(this.runtime.glwrap){var i=this.type.getEffectIndexByName(e);if(!(i<0)){var n=1===t;if(this.active_effect_flags[i]!==n)this.active_effect_flags[i]=n,this.updateActiveEffects(),this.runtime.redraw=!0}}},h.SetEffectParam=function(t,e,i){if(this.runtime.glwrap){var n=this.type.getEffectIndexByName(t);if(!(n<0)){var r,o,s,a=this.type.effect_types[n],l=this.effect_params[n];if(!((e=Math.floor(e))<0||e>=l.length)){var c=this.runtime.glwrap.getProgramParameterType(a.shaderindex,e);if(1===c)i/=100;if(2===c){if("string"==typeof i)i=parseInt(i.match(/[a-fA-F0-9]+$/g),16);r=drama.GetRValue(i),o=drama.GetGValue(i),s=drama.GetBValue(i);var u=l[e];if(u[0]===r&&u[1]===o&&u[2]===s||isNaN(r)||isNaN(o)||isNaN(s))return;if(u[0]=r,u[1]=o,u[2]=s,a.active)this.runtime.redraw=!0}else{if(l[e]===i)return;if(l[e]=i,a.active)this.runtime.redraw=!0}}}}};if(c)u.CompareSlideSpeed=function(t,e){return drama.do_cmp(this.speed,t,e/60)},u.CompareSlideDirection=function(t,e){return drama.do_cmp(this.slideAngle,t,e)},u.CompareDistanceSlided=function(t,e){return drama.do_cmp(this.moveDistance(),t,e)},u.OnDestinationReached=function(){return this.isReached},u.OnTargetMoving=function(){return this.isSlideMoving},u.OnOverLapSolid=function(){return!0},h.SlideToPosition=function(t,e,i,n,r){if(this.slideStopMove=!1,0==i&&0==n)return!1;if(t==this.x&&e==this.y)return!1;this.isSlideMoving=!0,this.slideTargetX=t,this.slideTargetY=e,this.speed=i+n;var o=this.slideTargetX-this.x,s=this.slideTargetY-this.y,a=Math.atan2(s,o);if(this.slideAngle=~~(180*a/Math.PI),this.acceleration=n,this.slideType="toPosition",this.dx=this.speed*Math.cos(a),this.dy=this.speed*Math.sin(a),r)this.angle=a;this.runtime.tickMe(this)},h.SlideToInstance=function(t,e,i,n){if(this.slideStopMove=!1,this.isSlideMoving=!0,0==e&&0==i)return!1;if(t){var r=t.getCurrentSol();if(r){var o;if(r.select_all)o=t.instances[0];else o=r.instances[0];if(o){this.slideTargetX=o.x,this.slideTargetY=o.y,this.acceleration=i,this.speed=e+i;var s=this.slideTargetX-this.x,a=this.slideTargetY-this.y,l=Math.atan2(a,s);if(this.slideAngle=~~(180*l/Math.PI),this.slideType="toInstance",this.dx=this.speed*Math.cos(l),this.dy=this.speed*Math.sin(l),n)this.angle=l;this.runtime.tickMe(this)}}}},h.SlideADistance=function(t,e,i,n,r){if(this.slideStopMove=!1,this.isSlideMoving=!0,0==i&&0==n)return!1;this.distance=t,this.speed=i+n,this.acceleration=n;var o=(this.slideAngle=e)/180*Math.PI;if(r)this.angle=o;this.dx=this.speed*Math.cos(o),this.dy=this.speed*Math.sin(o),this.slideType="toDistance",this.runtime.tickMe(this)},h.SlideTowardDirection=function(t,e,i,n){if(this.slideStopMove=!1,this.isSlideMoving=!0,0==e&&0==i)return!1;this.speed=e+i,this.acceleration=i;var r=(this.slideAngle=t)/180*Math.PI;if(n)this.angle=r;this.dx=this.speed*Math.cos(r),this.dy=this.speed*Math.sin(r),this.slideType="toDirection",this.runtime.tickMe(this)},h.SlideStopMove=function(){this.slideStopMove=!0,this.isSlideMoving=!1},d.SlideSpeed=function(t){t.set_float(this.speed?this.speed:0)},d.SlideAcceleration=function(t){t.set_float(this.slideAcceleration)},d.SlideDistance=function(t){t.set_float(this.moveDistance())},d.SlideAngle=function(t){t.set_float(this.slideAngle)},d.MovingTargetX=function(t){t.set_float(this.slideTargetX)},d.MovingTargetY=function(t){t.set_float(this.slideTargetY)}},drama.set_bbox_changed=function(){var t,e;this.bbox_changed=!0,this.cell_changed=!0,this.type.any_cell_changed=!0,this.runtime.redraw=!0;var i=this.bbox_changed_callbacks;for(t=0,e=i.length;t<e;++t)i[t](this);if(this.layer.useRenderCells)this.update_bbox()},drama.add_bbox_changed_callback=function(t){if(t)this.bbox_changed_callbacks.push(t)},drama.remove_bbox_changed_callback=function(t){if(t&&this.bbox_changed_callbacks&&0<this.bbox_changed_callbacks.length){var e=this.bbox_changed_callbacks.indexOf(t);-1!=e&&this.bbox_changed_callbacks.splice(e,1)}},drama.update_bbox=function(){if(this.bbox_changed){var t=this.bbox,e=this.bquad;if(t.set(this.x,this.y,this.x+this.width,this.y+this.height),t.offset(-this.hotspotX*this.width,-this.hotspotY*this.height),!this.angle)e.set_from_rect(t);else t.offset(-this.x,-this.y),e.set_from_rotated_rect(t,this.angle),e.offset(this.x,this.y),e.bounding_box(t);t.normalize(),this.bbox_changed=!1,this.update_render_cell()}};var i=new drama.rect(0,0,0,0);drama.update_render_cell=function(){if(this.layer.useRenderCells){var t=this.layer.render_grid,e=this.bbox;if(i.set(t.XToCell(e.left),t.YToCell(e.top),t.XToCell(e.right),t.YToCell(e.bottom)),!this.rendercells.equals(i)){if(this.rendercells.right<this.rendercells.left)t.update(this,null,i);else t.update(this,this.rendercells,i);this.rendercells.copy(i),this.layer.render_list_stale=!0,this.runtime.movedrendercell_count++}}},drama.update_collision_cell=function(){if(this.cell_changed&&this.collisionsEnabled){this.update_bbox();var t=this.type.collision_grid,e=this.bbox;if(i.set(t.XToCell(e.left),t.YToCell(e.top),t.XToCell(e.right),t.YToCell(e.bottom)),!this.collcells.equals(i)){if(this.collcells.right<this.collcells.left)t.update(this,null,i);else t.update(this,this.collcells,i);this.collcells.copy(i),this.runtime.movedcell_count++,this.cell_changed=!1}}},drama.inst_contains_pt=function(t,e){if(this.runtime.collisioncheck_count++,!this.bbox.contains_pt(t,e))return!1;if(this.runtime.polycheck_count++,!this.bquad.contains_pt(t,e))return!1;if(this.tilemap_exists)return this.testPointOverlapTile(t,e);if(this.collision_poly&&!this.collision_poly.is_empty())return this.collision_poly.cache_poly(this.width,this.height,this.angle),this.collision_poly.contains_pt(t-this.x,e-this.y);else return!0},drama.slide_to_target=function(){this.isSlideMoving=!1,this.x=this.slideTargetX,this.y=this.slideTargetY,this.slideType="";var t=Object.getPrototypeOf(this.type.plugin).cnds;this.isReached=!0,this.runtime.trigger(t.OnDestinationReached,this),this.isReached=!1},drama.slide_to_position=function(){if(!this.slideStopMove){if(this.remainDistance()>this.speed*this.runtime.dt)this.move_with_acceleration();else this.slide_to_target();this.set_bbox_changed()}},drama.slide_to_instance=function(){if(!this.slideStopMove){if(this.remainDistance()>this.speed*this.runtime.dt)this.move_with_acceleration();else this.slide_to_target();this.set_bbox_changed()}},drama.slide_to_distance=function(){if(!this.slideStopMove){if(!this.isDistance)this.accDistance=0,this.isDistance=!0;var t=this.move_with_acceleration(this.distance-this.accDistance),e=Math.sqrt(Math.abs(t.mx)*Math.abs(t.mx)+Math.abs(t.my)*Math.abs(t.my));if(this.accDistance+=e,t.isReached)this.isDistance=!1,this.slideTargetX=this.x,this.slideTargetY=this.y,this.slide_to_target();this.set_bbox_changed()}},drama.slide_to_direction=function(){if(!this.slideStopMove)this.move_with_acceleration(),this.set_bbox_changed()},drama.test_overlap_solid=function(){if(this.runtime.testOverlapSolid(this))return!0;else return!1},drama.move_with_acceleration=function(t){if(this.test_overlap_solid()){this.isSlideMoving=!1;var e=Object.getPrototypeOf(this.type.plugin).cnds;return this.runtime.trigger(e.OnOverLapSolid,this),{mx:0,my:0}}var i=0,n=0,r=!(this.isSlideMoving=!0),o=this.runtime.getDt(this),d=this;if(0!==this.acceleration){var s=drama.distanceTo(0,0,this.dx,this.dy),a=this.angle;if(0!==this.dx||0!==this.dy)a=drama.angleTo(0,0,this.dx,this.dy);if(s+=this.acceleration*o,this.speed=s,i=Math.cos(a)*this.acceleration,n=Math.sin(a)*this.acceleration,s<0)n=i=s=0;this.dx=Math.cos(a)*s,this.dy=Math.sin(a)*s}if(0!==this.dx||0!==this.dy){var l=this.runtime.accelerate(this.dx,-1/0,1/0,i,o),c=this.runtime.accelerate(this.dy,-1/0,1/0,n,o);if(this.runtime.testOverlapSolid(this))c=l=0;else{if(t){var u=Math.sqrt(Math.abs(l)*Math.abs(l)+Math.abs(c)*Math.abs(c));if(t<u){var h=(u-t)/u;l-=l*h,c-=c*h}r=t<=u}if(function(t,e){var i=drama.distanceTo(0,0,t,e);if(d.step&&!(i<=d.stepSize)){d.stopStepping=!1;for(var n=d.x,r=d.y,o=n+t,s=r+e,a=drama.angleTo(0,0,t,e),l=Math.cos(a)*d.stepSize,c=Math.sin(a)*d.stepSize,u=Math.floor(i/d.stepSize),h=1;h<=u;++h)if(d.x=n+l*h,d.y=r+c*h,d.set_bbox_changed(),d.runtime.trigger(drama.behaviors.Bullet.prototype.cnds.OnStep,d),d.isDestroyed||d.stopStepping)return;d.x=o,d.y=s,d.set_bbox_changed(),d.runtime.trigger(drama.behaviors.Bullet.prototype.cnds.OnStep,d)}else if(d.x+=t,d.y+=e,d.set_bbox_changed(),d.step)d.runtime.trigger(drama.behaviors.Bullet.prototype.cnds.OnStep,d)}(l,c),this.travelled+=drama.distanceTo(this.lastx,this.lasty,this.x,this.y),this.setAngle)this.angle=drama.angleTo(0,0,l,c),this.set_bbox_changed(),this.lastKnownAngle=this.angle}return{mx:l,my:c,isReached:r}}else return{mx:0,my:0,isReached:r}},drama.inst_get_iid=function(){return this.type.updateIIDs(),this.iid},drama.inst_get_zindex=function(){return this.layer.updateZIndices(),this.zindex},drama.inst_get_remain_distance=function(){var t=this.slideTargetX-this.x,e=this.slideTargetY-this.y;return Math.sqrt(t*t+e*e)},drama.inst_move_distance=function(){var t=this.x-this.slideSourceX,e=this.y-this.slideSourceY;return Math.sqrt(t*t+e*e)},drama.inst_updateActiveEffects=function(){var t,e,i;drama.clearArray(this.active_effect_types);var n=!0;for(t=0,e=this.active_effect_flags.length;t<e;t++)if(this.active_effect_flags[t])if(i=this.type.effect_types[t],this.active_effect_types.push(i),!i.preservesOpaqueness)n=!1;this.uses_shaders=!!this.active_effect_types.length,this.shaders_preserve_opaqueness=n},drama.inst_toString=function(){return"Inst"+this.puid},drama.type_getFirstPicked=function(t){if(t&&t.is_contained&&t.type!=this){var e,i,n;for(e=0,i=t.siblings.length;e<i;e++)if((n=t.siblings[e]).type==this)return n}var r=this.getCurrentSol().getObjects();if(r.length)return r[0];else return null},drama.type_getPairedInstance=function(t){var e=this.getCurrentSol().getObjects();if(e.length)return e[t.get_iid()%e.length];else return null},drama.type_updateIIDs=function(){if(this.stale_iids&&!this.is_family){var t,e;for(t=0,e=this.instances.length;t<e;t++)this.instances[t].iid=t;var i=t,n=this.runtime.createRow;for(t=0,e=n.length;t<e;++t)if(n[t].type===this)n[t].iid=i++;this.stale_iids=!1}},drama.type_getInstanceByIID=function(t){if(t<this.instances.length)return this.instances[t];t-=this.instances.length;var e,i,n=this.runtime.createRow;for(e=0,i=n.length;e<i;++e)if(n[e].type===this){if(0===t)return n[e];--t}return assert2(!1,"Unable to find instance by IID"),null},drama.type_getCurrentSol=function(){return this.solstack[this.cur_sol]},drama.type_pushCleanSol=function(){if(this.cur_sol++,this.cur_sol===this.solstack.length)this.solstack.push(new drama.selection(this));else this.solstack[this.cur_sol].select_all=!0,drama.clearArray(this.solstack[this.cur_sol].else_instances)},drama.type_pushCopySol=function(){if(this.cur_sol++,this.cur_sol===this.solstack.length)this.solstack.push(new drama.selection(this));var t=this.solstack[this.cur_sol],e=this.solstack[this.cur_sol-1];if(e.select_all)t.select_all=!0,drama.clearArray(t.else_instances);else t.select_all=!1,drama.shallowAssignArray(t.instances,e.instances),drama.shallowAssignArray(t.else_instances,e.else_instances)},drama.type_popSol=function(){assert2(0<this.cur_sol,"Popping SOL but already at bottom of SOL stack"),this.cur_sol--},drama.type_getBehaviorByName=function(t){var e,i,n,r,o,s=0;if(!this.is_family)for(e=0,i=this.families.length;e<i;e++)for(n=0,r=(o=this.families[e]).behaviors.length;n<r;n++){if(t===o.behaviors[n].name)return this.extra.lastBehIndex=s,o.behaviors[n];s++}for(e=0,i=this.behaviors.length;e<i;e++){if(t===this.behaviors[e].name)return this.extra.lastBehIndex=s,this.behaviors[e];s++}return null},drama.type_getBehaviorIndexByName=function(t){if(this.getBehaviorByName(t))return this.extra.lastBehIndex;else return-1},drama.type_getEffectIndexByName=function(t){var e,i;for(e=0,i=this.effect_types.length;e<i;e++)if(this.effect_types[e].name===t)return e;return-1},drama.type_applySolToContainer=function(){if(this.is_contained&&!this.is_family){var t,e,i,n,r,o,s;this.updateIIDs();var a=(o=this.getCurrentSol()).select_all,l=this.runtime.getCurrentEventStack(),c=l&&l.current_event&&l.current_event.orblock;for(t=0,e=this.container.length;t<e;t++)if((r=this.container[t])!==this)if(r.updateIIDs(),!((s=r.getCurrentSol()).select_all=a)){for(drama.clearArray(s.instances),i=0,n=o.instances.length;i<n;++i)s.instances[i]=r.getInstanceByIID(o.instances[i].iid);if(c)for(drama.clearArray(s.else_instances),i=0,n=o.else_instances.length;i<n;++i)s.else_instances[i]=r.getInstanceByIID(o.else_instances[i].iid)}}},drama.type_toString=function(){return"Type"+this.sid},drama.do_cmp=function(t,e,i){if(void 0===t||void 0===i)return!1;switch(e){case 0:return t===i;case 1:return t!==i;case 2:return t<i;case 3:return t<=i;case 4:return i<t;case 5:return i<=t;default:return assert2(!1,"Invalid comparison value: "+e),!1}},drama.collect_animations_img=function(){this.isCollect=!0,this.all_frames.map(function(t){var e=window.xfHost.cache();for(var i in e){var n=e[i];if(t.texture_img&&n.cr_src==t.texture_img.cr_src)window.xfHost.remove({url:n.cr_src})}t.texture_img=null}),this.loadingprogress=0},drama.load_animations_img=function(){var t,e,i;for(t=0,e=this.all_frames.length;t<e;t++){var n=(i=this.all_frames[t]).texture_file,r=i.texture_filesize;this.runtime.xfLoadC2Image(this,n,r,i)}},drama.collect_texture_img=function(){this.isCollect=!0;var t=window.xfHost.cache();for(var e in t){var i=t[e];if(this.texture_img&&i.cr_src==this.texture_img.cr_src)window.xfHost.remove({url:i.cr_src})}this.texture_img=null,this.loadingprogress=0},drama.load_texture_img=function(){this.runtime.xfLoadC2Image(this,this.texture_file,this.texture_filesize)},drama.dynamicRelease=function(){if(this.isDynamicRelease=!0,this.isTexture){var t=window.xfHost.cache();for(var e in t){var i=t[e];if(this.texture_img&&i.cr_src==this.texture_img.cr_src)window.xfHost.remove({url:i.cr_src})}this.texture_img=null}else if(this.isAnimations&&this.all_frames)this.all_frames.map(function(t){var e=window.xfHost.cache();for(var i in e){var n=e[i];if(t.texture_img&&n.cr_src==t.texture_img.cr_src)window.xfHost.remove({url:n.cr_src})}t.texture_img=null});this.loadingprogress=0}}(),function(){var t;function e(){if(!t)t=window.cr_createRuntime({projectDataUrl:window.cr_previewProjectDataUrl,exportType:window.xfConfig.exportType||"preview"})}function i(){xf.EvkLogin.start(function(){e();var t=xf.queryString("es_e_channelCode",!1)||"";if(xf.gameInfo.gameExportType==xf.gameExportType.Game&&(0==xf.gameInfo.isCommercialized||1==xf.gameInfo.isCommercialized&&t==xf.gameInfo.channelCode)&&xfConfig.isEvkBanner&&!window.xfruntime.isMinigame&&!window.xfruntime.isElectron&&!window.xfruntime.isCordova)xf.createBanner()})}function n(){xf.EvkLogin.Permission.Shared().requestGamePermission().then(function(t){xf.EvkLogin.start(function(){if(/android/i.test(navigator.userAgent))window.AndroidFullScreen&&window.AndroidFullScreen.immersiveMode();e()})})}if(window.cordova)document.addEventListener("deviceready",function(){if("hykb"==window.xfConfig.channel){var t=new window.Hykb(window.xfConfig.hykbId);(window.hykb=t).checkAppInstall().then(function(t){if(t)n()}).catch(function(t){console.warn(t)})}else n();if(window.Bugly)window.Bugly.initSDK(function(){console.log("bugly init successed")},function(t){console.warn("bugly init failed",t)},{})},!1);else if("loading"===document.readyState)document.addEventListener("DOMContentLoaded",i);else i()}();